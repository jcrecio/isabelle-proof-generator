{"file_name": "/home/qj213/afp-2021-10-22/thys/Hoare_Time/Nielson_Hoare.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Hoare_Time", "problem_names": ["lemma support_and: \"support (\\<lambda>l s. P l s \\<and> Q l s) \\<subseteq> support P \\<union> support Q\"", "lemma support_impl: \"support (\\<lambda>l s. P s \\<longrightarrow> Q l s) \\<subseteq> support Q\"", "lemma support_exist: \"support (\\<lambda>l s. \\<exists> z::nat. Q z l s) \\<subseteq> (UN n. support (Q n))\"", "lemma support_all: \"support (\\<lambda>l s. \\<forall>z. Q z l s) \\<subseteq> (UN n. support (Q n))\"", "lemma support_single: \"support (\\<lambda>l s. P (l a) s) \\<subseteq> {a}\"", "lemma support_inv: \"\\<And>P. support (\\<lambda>l s. P s) = {}\"", "lemma assn2_lupd: \"x \\<notin> support Q \\<Longrightarrow> Q (l(x:=n)) = Q l\"", "lemma conseq_old: \"\\<lbrakk>\\<exists>k>0. \\<forall>l s. P' l s \\<longrightarrow> (P l s \\<and> ( e' s \\<le>  k * (e s))); \\<turnstile>\\<^sub>1 {P}c{ e' \\<Down>  Q}; \\<forall>l s. Q l s \\<longrightarrow> Q' l s  \\<rbrakk> \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {P'}c{e \\<Down> Q'}\"", "lemma If2: \"\\<lbrakk> \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s} c\\<^sub>1 { e \\<Down> Q}; \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s} c\\<^sub>2 { e \\<Down> Q};\n        \\<And>l s. P l s \\<Longrightarrow> e s + 1 = e' s \\<rbrakk>\n  \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} IF b THEN c\\<^sub>1 ELSE c\\<^sub>2 { e' \\<Down> Q}\"", "lemma strengthen_pre:\n  \"\\<lbrakk> \\<forall>l s. P' l s \\<longrightarrow> P l s ;  \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q} \\<rbrakk> \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P'} c { e \\<Down> Q}\"", "lemma weaken_post:\n  \"\\<lbrakk> \\<turnstile>\\<^sub>1 {P} c {e \\<Down> Q};  \\<forall>l s. Q l s \\<longrightarrow> Q' l s \\<rbrakk> \\<Longrightarrow>  \\<turnstile>\\<^sub>1 {P} c {e \\<Down> Q'}\"", "lemma ub_cost:\n  \"\\<lbrakk> (\\<exists>k>0. \\<forall>l s. P l s \\<longrightarrow> e' s \\<le> k * (e s));  \\<turnstile>\\<^sub>1 {P} c {e' \\<Down> Q} \\<rbrakk> \\<Longrightarrow>  \\<turnstile>\\<^sub>1 {P} c {e \\<Down> Q}\"", "lemma Assign': \"\\<forall>l s. P l s \\<longrightarrow> Q l (s[a/x]) \\<Longrightarrow> (\\<turnstile>\\<^sub>1 {P} x ::= a { (%s. 1) \\<Down> Q})\"", "theorem hoare1_sound: \"\\<turnstile>\\<^sub>1 {P}c{e \\<Down> Q}  \\<Longrightarrow>  \\<Turnstile>\\<^sub>1 {P}c{e \\<Down> Q}\"", "lemma support_wpt: \"support (wp\\<^sub>1 c Q) \\<subseteq> support Q\"", "lemma wp1_terminates: \"wp\\<^sub>1 c Q l s \\<Longrightarrow> \\<down> (c, s)\"", "lemma wp1_SKIP[simp]: \"wp\\<^sub>1 SKIP Q = Q\"", "lemma wp1_Assign[simp]: \"wp\\<^sub>1 (x ::= e) Q = (\\<lambda>l s. Q l (s(x := aval e s)))\"", "lemma wp1_Seq[simp]: \"wp\\<^sub>1 (c\\<^sub>1;;c\\<^sub>2) Q = wp\\<^sub>1 c\\<^sub>1 (wp\\<^sub>1 c\\<^sub>2 Q)\"", "lemma wp1_If[simp]: \"wp\\<^sub>1 (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2) Q = (\\<lambda>l s. wp\\<^sub>1 (if bval b s then c\\<^sub>1 else c\\<^sub>2) Q l s)\"", "lemma wp1_prec_Seq_correct: \"wp\\<^sub>1 (c1;;c2) Q l s \\<Longrightarrow> \\<down>\\<^sub>t (c1, s) + prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s \\<le> \\<down>\\<^sub>t (c1;; c2, s)\"", "lemma bigstep_det: \"(c1, s) \\<Rightarrow> p1 \\<Down> t1 \\<Longrightarrow> (c1, s) \\<Rightarrow> p \\<Down> t \\<Longrightarrow> p1=p \\<and> t1=t\"", "lemma bigstepT_the_cost: \"(c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow> (THE n. \\<exists>a. (c, s) \\<Rightarrow> n \\<Down> a) = P\"", "lemma bigstepT_the_state: \"(c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow> (THE a. \\<exists>n. (c, s) \\<Rightarrow> n \\<Down> a) = T\"", "lemma assumes b: \"bval b s\"\n  shows wp1WhileTrue': \"wp\\<^sub>1 (WHILE b DO c) Q l s = wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\"", "lemma assumes b: \"~ bval b s\"\n  shows wp1WhileFalse': \"wp\\<^sub>1 (WHILE b DO c) Q l s =  Q l s\"", "lemma wp1While: \"wp\\<^sub>1 (WHILE b DO c) Q l s = (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s else Q l s)\"", "lemma wp1_prec2: fixes e::tbd\n    shows \"(wp\\<^sub>1 c1 Q l s \\<and>\n           l x = prec c1 e s) = wp\\<^sub>1 c1 (\\<lambda>l s. Q l s \\<and> e s = l x) l s\"", "lemma wp1_prec: fixes e::tbd\n    shows \"wp\\<^sub>1 c1 Q l s \\<Longrightarrow>\n           l x = prec c1 e s \\<Longrightarrow> wp\\<^sub>1 c1 (\\<lambda>l s. Q l s \\<and> e s = l x) l s\"", "lemma wp1_is_pre: \"finite (support Q) \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q}\"", "lemma valid_wp: \"\\<Turnstile>\\<^sub>1 {P}c{p \\<Down> Q} \\<longleftrightarrow> (\\<exists>k>0. (\\<forall>l s. P l s \\<longrightarrow> (wp\\<^sub>1 c Q l s \\<and> ((THE n. (\\<exists> t. ((c,s) \\<Rightarrow> n \\<Down> t)))) \\<le> k * p s)))\"", "theorem hoare1_complete: \"finite (support Q) \\<Longrightarrow> \\<Turnstile>\\<^sub>1 {P}c{p \\<Down> Q} \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P}c{p \\<Down> Q}\""], "translations": [["", "lemma support_and: \"support (\\<lambda>l s. P l s \\<and> Q l s) \\<subseteq> support P \\<union> support Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. support (\\<lambda>l s. P l s \\<and> Q l s)\n    \\<subseteq> support P \\<union> support Q", "unfolding support_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<exists>l1 l2 s.\n           (\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y) \\<and>\n           (P l1 s \\<and> Q l1 s) \\<noteq> (P l2 s \\<and> Q l2 s)}\n    \\<subseteq> {x. \\<exists>l1 l2 s.\n                       (\\<forall>y.\n                           y \\<noteq> x \\<longrightarrow>\n                           l1 y = l2 y) \\<and>\n                       P l1 s \\<noteq> P l2 s} \\<union>\n                {x. \\<exists>l1 l2 s.\n                       (\\<forall>y.\n                           y \\<noteq> x \\<longrightarrow>\n                           l1 y = l2 y) \\<and>\n                       Q l1 s \\<noteq> Q l2 s}", "by blast"], ["", "lemma support_impl: \"support (\\<lambda>l s. P s \\<longrightarrow> Q l s) \\<subseteq> support Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. support (\\<lambda>l s. P s \\<longrightarrow> Q l s)\n    \\<subseteq> support Q", "unfolding support_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<exists>l1 l2 s.\n           (\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y) \\<and>\n           (P s \\<longrightarrow> Q l1 s) \\<noteq>\n           (P s \\<longrightarrow> Q l2 s)}\n    \\<subseteq> {x. \\<exists>l1 l2 s.\n                       (\\<forall>y.\n                           y \\<noteq> x \\<longrightarrow>\n                           l1 y = l2 y) \\<and>\n                       Q l1 s \\<noteq> Q l2 s}", "by blast"], ["", "lemma support_exist: \"support (\\<lambda>l s. \\<exists> z::nat. Q z l s) \\<subseteq> (UN n. support (Q n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. support (\\<lambda>l s. \\<exists>z. Q z l s)\n    \\<subseteq> (\\<Union>n. support (Q n))", "unfolding support_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<exists>l1 l2 s.\n           (\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y) \\<and>\n           (\\<exists>z. Q z l1 s) \\<noteq> (\\<exists>z. Q z l2 s)}\n    \\<subseteq> (\\<Union>n.\n                    {x. \\<exists>l1 l2 s.\n                           (\\<forall>y.\n                               y \\<noteq> x \\<longrightarrow>\n                               l1 y = l2 y) \\<and>\n                           Q n l1 s \\<noteq> Q n l2 s})", "apply(auto)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x l1 l2 s z.\n       \\<lbrakk>\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y;\n        \\<forall>z. \\<not> Q z l2 s; Q z l1 s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa l1 l2.\n                            (\\<forall>y.\n                                y \\<noteq> x \\<longrightarrow>\n                                l1 y = l2 y) \\<and>\n                            (\\<exists>s. Q xa l1 s = (\\<not> Q xa l2 s))\n 2. \\<And>x l1 l2 s z.\n       \\<lbrakk>\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y;\n        \\<forall>z. \\<not> Q z l1 s;\n        \\<forall>xa l1 l2.\n           (\\<exists>y. y \\<noteq> x \\<and> l1 y \\<noteq> l2 y) \\<or>\n           (\\<forall>s. Q xa l1 s = Q xa l2 s);\n        Q z l2 s\\<rbrakk>\n       \\<Longrightarrow> False", "by blast+"], ["", "lemma support_all: \"support (\\<lambda>l s. \\<forall>z. Q z l s) \\<subseteq> (UN n. support (Q n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. support (\\<lambda>l s. \\<forall>z. Q z l s)\n    \\<subseteq> (\\<Union>n. support (Q n))", "unfolding support_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<exists>l1 l2 s.\n           (\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y) \\<and>\n           (\\<forall>z. Q z l1 s) \\<noteq> (\\<forall>z. Q z l2 s)}\n    \\<subseteq> (\\<Union>n.\n                    {x. \\<exists>l1 l2 s.\n                           (\\<forall>y.\n                               y \\<noteq> x \\<longrightarrow>\n                               l1 y = l2 y) \\<and>\n                           Q n l1 s \\<noteq> Q n l2 s})", "apply(auto)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x l1 l2 s z.\n       \\<lbrakk>\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y;\n        \\<forall>z. Q z l1 s; \\<not> Q z l2 s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa l1 l2.\n                            (\\<forall>y.\n                                y \\<noteq> x \\<longrightarrow>\n                                l1 y = l2 y) \\<and>\n                            (\\<exists>s. Q xa l1 s = (\\<not> Q xa l2 s))\n 2. \\<And>x l1 l2 s z.\n       \\<lbrakk>\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y;\n        \\<forall>z. Q z l2 s;\n        \\<forall>xa l1 l2.\n           (\\<exists>y. y \\<noteq> x \\<and> l1 y \\<noteq> l2 y) \\<or>\n           (\\<forall>s. Q xa l1 s = Q xa l2 s)\\<rbrakk>\n       \\<Longrightarrow> Q z l1 s", "by blast+"], ["", "lemma support_single: \"support (\\<lambda>l s. P (l a) s) \\<subseteq> {a}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. support (\\<lambda>l. P (l a)) \\<subseteq> {a}", "unfolding support_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<exists>l1 l2 s.\n           (\\<forall>y. y \\<noteq> x \\<longrightarrow> l1 y = l2 y) \\<and>\n           P (l1 a) s \\<noteq> P (l2 a) s}\n    \\<subseteq> {a}", "by fastforce"], ["", "lemma support_inv: \"\\<And>P. support (\\<lambda>l s. P s) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P. support (\\<lambda>l. P) = {}", "unfolding support_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P.\n       {x. \\<exists>l1 l2 s.\n              (\\<forall>y.\n                  y \\<noteq> x \\<longrightarrow> l1 y = l2 y) \\<and>\n              P s \\<noteq> P s} =\n       {}", "by blast"], ["", "lemma assn2_lupd: \"x \\<notin> support Q \\<Longrightarrow> Q (l(x:=n)) = Q l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<notin> support Q \\<Longrightarrow> Q (l(x := n)) = Q l", "by(simp add: support_def fun_upd_other fun_eq_iff)\n  (metis (no_types, lifting) fun_upd_def)"], ["", "subsection \"Validity\""], ["", "abbreviation state_subst :: \"state \\<Rightarrow> aexp \\<Rightarrow> vname \\<Rightarrow> state\"\n  (\"_[_'/_]\" [1000,0,0] 999)\nwhere \"s[a/x] == s(x := aval a s)\""], ["", "definition hoare1_valid :: \"assn2 \\<Rightarrow> com \\<Rightarrow> tbd \\<Rightarrow> assn2 \\<Rightarrow> bool\"\n  (\"\\<Turnstile>\\<^sub>1 {(1_)}/ (_)/ { _ \\<Down>(1_)}\" 50) where\n\"\\<Turnstile>\\<^sub>1 {P} c {q \\<Down> Q}  \\<longleftrightarrow>  (\\<exists>k>0. (\\<forall>l s. P l s \\<longrightarrow> (\\<exists>t p. ((c,s) \\<Rightarrow> p \\<Down> t) \\<and>  p \\<le> k * (q s) \\<and> Q l t)))\""], ["", "subsection \"Hoare rules\""], ["", "inductive\n  hoare1 :: \"assn2 \\<Rightarrow> com \\<Rightarrow> tbd \\<Rightarrow> assn2 \\<Rightarrow> bool\" (\"\\<turnstile>\\<^sub>1 ({(1_)}/ (_)/ { _ \\<Down> (1_)})\" 50)\nwhere\n\nSkip:  \"\\<turnstile>\\<^sub>1 {P} SKIP { (%s. Suc 0) \\<Down> P}\"  |\n\nAssign:  \"\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l (s[a/x])} x::=a {  (%s. Suc 0) \\<Down> P}\"  |\n\nIf: \"\\<lbrakk> \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s} c\\<^sub>1 { e1 \\<Down> Q};\n       \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s} c\\<^sub>2 { e1 \\<Down> Q} \\<rbrakk>\n  \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} IF b THEN c\\<^sub>1 ELSE c\\<^sub>2 { (\\<lambda>s. e1 s + Suc 0 ) \\<Down> Q}\"  |\n\nSeq: \"\\<lbrakk> \\<turnstile>\\<^sub>1 { (%l s. P\\<^sub>1 l s \\<and> l x = e2' s ) } c\\<^sub>1 { e1 \\<Down> (%l s. P\\<^sub>2 l s \\<and>  e2 s \\<le> l x )};\n         \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3}; x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n         \\<And>l s. P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n          \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P\\<^sub>1} c\\<^sub>1;;c\\<^sub>2 { e \\<Down> P\\<^sub>3}\"  |\n\nWhile:\n  \"\\<lbrakk> \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s \\<and> e' s = l y} c {  e'' \\<Down> \\<lambda>l s. P l s \\<and> e s \\<le> l y};\n       \\<forall>l s. bval b s \\<and> P l s \\<longrightarrow>  e s \\<ge> 1  +  e' s + e'' s  ; \n     \\<forall>l s. ~ bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n     y \\<notin> support P  \\<rbrakk>\n   \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} WHILE b DO c { e \\<Down> \\<lambda>l s. P l s \\<and> \\<not> bval b s}\" |\n\nconseq: \"\\<lbrakk> \\<exists>k>0. \\<forall>l s. P' l s \\<longrightarrow> ( e s \\<le> k * (e' s) \\<and>(\\<forall>t. \\<exists>l'. P l' s \\<and> ( Q l' t \\<longrightarrow> Q' l t) ));\n           \\<turnstile>\\<^sub>1 {P}c{ e \\<Down> Q}   \\<rbrakk> \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {P'}c{e' \\<Down> Q'}\""], ["", "text\\<open>Derived Rules:\\<close>"], ["", "lemma conseq_old: \"\\<lbrakk>\\<exists>k>0. \\<forall>l s. P' l s \\<longrightarrow> (P l s \\<and> ( e' s \\<le>  k * (e s))); \\<turnstile>\\<^sub>1 {P}c{ e' \\<Down>  Q}; \\<forall>l s. Q l s \\<longrightarrow> Q' l s  \\<rbrakk> \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {P'}c{e \\<Down> Q'}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<exists>k>0.\n                \\<forall>l s.\n                   P' l s \\<longrightarrow> P l s \\<and> e' s \\<le> k * e s;\n     \\<turnstile>\\<^sub>1 {P} c { e' \\<Down> Q};\n     \\<forall>l s. Q l s \\<longrightarrow> Q' l s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P'} c { e \\<Down> Q'}", "using conseq"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<exists>k>0.\n              \\<forall>l s.\n                 ?P' l s \\<longrightarrow>\n                 ?e s \\<le> k * ?e' s \\<and>\n                 (\\<forall>t.\n                     \\<exists>l'.\n                        ?P l' s \\<and> (?Q l' t \\<longrightarrow> ?Q' l t));\n   \\<turnstile>\\<^sub>1 {?P} ?c { ?e \\<Down> ?Q}\\<rbrakk>\n  \\<Longrightarrow> \\<turnstile>\\<^sub>1 {?P'} ?c { ?e' \\<Down> ?Q'}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<exists>k>0.\n                \\<forall>l s.\n                   P' l s \\<longrightarrow> P l s \\<and> e' s \\<le> k * e s;\n     \\<turnstile>\\<^sub>1 {P} c { e' \\<Down> Q};\n     \\<forall>l s. Q l s \\<longrightarrow> Q' l s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P'} c { e \\<Down> Q'}", "apply(metis)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma If2: \"\\<lbrakk> \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s} c\\<^sub>1 { e \\<Down> Q}; \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s} c\\<^sub>2 { e \\<Down> Q};\n        \\<And>l s. P l s \\<Longrightarrow> e s + 1 = e' s \\<rbrakk>\n  \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} IF b THEN c\\<^sub>1 ELSE c\\<^sub>2 { e' \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                  c\\<^sub>1 { e \\<Down> Q};\n     \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                          c\\<^sub>2 { e \\<Down> Q};\n     \\<And>l s. P l s \\<Longrightarrow> e s + 1 = e' s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P}\n     IF b THEN c\\<^sub>1 ELSE c\\<^sub>2 { e' \\<Down> Q}", "apply(rule conseq[OF _ If, where P=P and P'=P])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                  c\\<^sub>1 { e \\<Down> Q};\n     \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                          c\\<^sub>2 { e \\<Down> Q};\n     \\<And>l s. P l s \\<Longrightarrow> e s + 1 = e' s\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k>0.\n                         \\<forall>l s.\n                            P l s \\<longrightarrow>\n                            ?e1.1 s + Suc 0 \\<le> k * e' s \\<and>\n                            (\\<forall>t.\n                                \\<exists>l'.\n                                   P l' s \\<and>\n                                   (?Q l' t \\<longrightarrow> Q l t))\n 2. \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                  c\\<^sub>1 { e \\<Down> Q};\n     \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                          c\\<^sub>2 { e \\<Down> Q};\n     \\<And>l s. P l s \\<Longrightarrow> e s + 1 = e' s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n         P l s \\<and> bval b s}\n     c\\<^sub>1 { ?e1.1 \\<Down> ?Q}\n 3. \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                  c\\<^sub>1 { e \\<Down> Q};\n     \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                          c\\<^sub>2 { e \\<Down> Q};\n     \\<And>l s. P l s \\<Longrightarrow> e s + 1 = e' s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n         P l s \\<and> \\<not> bval b s}\n     c\\<^sub>2 { ?e1.1 \\<Down> ?Q}", "by(auto)"], ["", "lemma strengthen_pre:\n  \"\\<lbrakk> \\<forall>l s. P' l s \\<longrightarrow> P l s ;  \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q} \\<rbrakk> \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P'} c { e \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l s. P' l s \\<longrightarrow> P l s;\n     \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P'} c { e \\<Down> Q}", "apply(rule conseq_old[where e'=e and Q=Q and P=P])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>l s. P' l s \\<longrightarrow> P l s;\n     \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k>0.\n                         \\<forall>l s.\n                            P' l s \\<longrightarrow>\n                            P l s \\<and> e s \\<le> k * e s\n 2. \\<lbrakk>\\<forall>l s. P' l s \\<longrightarrow> P l s;\n     \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}\n 3. \\<lbrakk>\\<forall>l s. P' l s \\<longrightarrow> P l s;\n     \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l s. Q l s \\<longrightarrow> Q l s", "by(auto)"], ["", "lemma weaken_post:\n  \"\\<lbrakk> \\<turnstile>\\<^sub>1 {P} c {e \\<Down> Q};  \\<forall>l s. Q l s \\<longrightarrow> Q' l s \\<rbrakk> \\<Longrightarrow>  \\<turnstile>\\<^sub>1 {P} c {e \\<Down> Q'}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n     \\<forall>l s. Q l s \\<longrightarrow> Q' l s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q'}", "apply(rule conseq_old[where   e'=e and Q=Q and P=P])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n     \\<forall>l s. Q l s \\<longrightarrow> Q' l s\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k>0.\n                         \\<forall>l s.\n                            P l s \\<longrightarrow>\n                            P l s \\<and> e s \\<le> k * e s\n 2. \\<lbrakk>\\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n     \\<forall>l s. Q l s \\<longrightarrow> Q' l s\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}\n 3. \\<lbrakk>\\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n     \\<forall>l s. Q l s \\<longrightarrow> Q' l s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l s. Q l s \\<longrightarrow> Q' l s", "by(auto)"], ["", "lemma ub_cost:\n  \"\\<lbrakk> (\\<exists>k>0. \\<forall>l s. P l s \\<longrightarrow> e' s \\<le> k * (e s));  \\<turnstile>\\<^sub>1 {P} c {e' \\<Down> Q} \\<rbrakk> \\<Longrightarrow>  \\<turnstile>\\<^sub>1 {P} c {e \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<exists>k>0.\n                \\<forall>l s. P l s \\<longrightarrow> e' s \\<le> k * e s;\n     \\<turnstile>\\<^sub>1 {P} c { e' \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}", "apply(rule conseq_old[where e'=e' and Q=Q and P=P])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<exists>k>0.\n                \\<forall>l s. P l s \\<longrightarrow> e' s \\<le> k * e s;\n     \\<turnstile>\\<^sub>1 {P} c { e' \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k>0.\n                         \\<forall>l s.\n                            P l s \\<longrightarrow>\n                            P l s \\<and> e' s \\<le> k * e s\n 2. \\<lbrakk>\\<exists>k>0.\n                \\<forall>l s. P l s \\<longrightarrow> e' s \\<le> k * e s;\n     \\<turnstile>\\<^sub>1 {P} c { e' \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} c { e' \\<Down> Q}\n 3. \\<lbrakk>\\<exists>k>0.\n                \\<forall>l s. P l s \\<longrightarrow> e' s \\<le> k * e s;\n     \\<turnstile>\\<^sub>1 {P} c { e' \\<Down> Q}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l s. Q l s \\<longrightarrow> Q l s", "by(auto)"], ["", "lemma Assign': \"\\<forall>l s. P l s \\<longrightarrow> Q l (s[a/x]) \\<Longrightarrow> (\\<turnstile>\\<^sub>1 {P} x ::= a { (%s. 1) \\<Down> Q})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l s. P l s \\<longrightarrow> Q l (s[a/x]) \\<Longrightarrow>\n    \\<turnstile>\\<^sub>1 {P} x ::= a { \\<lambda>s. 1 \\<Down> Q}", "using strengthen_pre[OF _ Assign]"], ["proof (prove)\nusing this:\n  \\<forall>l s.\n     ?P' l s \\<longrightarrow> ?Q l (s[?a1/?x1]) \\<Longrightarrow>\n  \\<turnstile>\\<^sub>1 {?P'} ?x1 ::= ?a1 { \\<lambda>s. Suc 0 \\<Down> ?Q}\n\ngoal (1 subgoal):\n 1. \\<forall>l s. P l s \\<longrightarrow> Q l (s[a/x]) \\<Longrightarrow>\n    \\<turnstile>\\<^sub>1 {P} x ::= a { \\<lambda>s. 1 \\<Down> Q}", "by (simp )"], ["", "subsection \"Soundness\""], ["", "text\\<open>The soundness theorem:\\<close>"], ["", "theorem hoare1_sound: \"\\<turnstile>\\<^sub>1 {P}c{e \\<Down> Q}  \\<Longrightarrow>  \\<Turnstile>\\<^sub>1 {P}c{e \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q} \\<Longrightarrow>\n    \\<Turnstile>\\<^sub>1 {P} c { e \\<Down>Q}", "apply(unfold hoare1_valid_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q} \\<Longrightarrow>\n    \\<exists>k>0.\n       \\<forall>l s.\n          P l s \\<longrightarrow>\n          (\\<exists>t p.\n              (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n              p \\<le> k * e s \\<and> Q l t)", "proof(  induction  rule: hoare1.induct)"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>P.\n       \\<exists>k>0.\n          \\<forall>l s.\n             P l s \\<longrightarrow>\n             (\\<exists>t p.\n                 (SKIP, s) \\<Rightarrow> p \\<Down> t \\<and>\n                 p \\<le> k * Suc 0 \\<and> P l t)\n 2. \\<And>P a x.\n       \\<exists>k>0.\n          \\<forall>l s.\n             P l (s[a/x]) \\<longrightarrow>\n             (\\<exists>t p.\n                 (x ::= a, s) \\<Rightarrow> p \\<Down> t \\<and>\n                 p \\<le> k * Suc 0 \\<and> P l t)\n 3. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 4. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 5. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 6. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "case (Skip P)"], ["proof (state)\nthis:\n  \n\ngoal (6 subgoals):\n 1. \\<And>P.\n       \\<exists>k>0.\n          \\<forall>l s.\n             P l s \\<longrightarrow>\n             (\\<exists>t p.\n                 (SKIP, s) \\<Rightarrow> p \\<Down> t \\<and>\n                 p \\<le> k * Suc 0 \\<and> P l t)\n 2. \\<And>P a x.\n       \\<exists>k>0.\n          \\<forall>l s.\n             P l (s[a/x]) \\<longrightarrow>\n             (\\<exists>t p.\n                 (x ::= a, s) \\<Rightarrow> p \\<Down> t \\<and>\n                 p \\<le> k * Suc 0 \\<and> P l t)\n 3. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 4. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 5. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 6. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          P l s \\<longrightarrow>\n          (\\<exists>t p.\n              (SKIP, s) \\<Rightarrow> p \\<Down> t \\<and>\n              p \\<le> k * Suc 0 \\<and> P l t)", "by fastforce"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t p.\n            (SKIP, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * Suc 0 \\<and> P l t)\n\ngoal (5 subgoals):\n 1. \\<And>P a x.\n       \\<exists>k>0.\n          \\<forall>l s.\n             P l (s[a/x]) \\<longrightarrow>\n             (\\<exists>t p.\n                 (x ::= a, s) \\<Rightarrow> p \\<Down> t \\<and>\n                 p \\<le> k * Suc 0 \\<and> P l t)\n 2. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 3. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 4. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 5. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>P a x.\n       \\<exists>k>0.\n          \\<forall>l s.\n             P l (s[a/x]) \\<longrightarrow>\n             (\\<exists>t p.\n                 (x ::= a, s) \\<Rightarrow> p \\<Down> t \\<and>\n                 p \\<le> k * Suc 0 \\<and> P l t)\n 2. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 3. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 4. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 5. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "case (Assign P a x)"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. \\<And>P a x.\n       \\<exists>k>0.\n          \\<forall>l s.\n             P l (s[a/x]) \\<longrightarrow>\n             (\\<exists>t p.\n                 (x ::= a, s) \\<Rightarrow> p \\<Down> t \\<and>\n                 p \\<le> k * Suc 0 \\<and> P l t)\n 2. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 3. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 4. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 5. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          P l (s[a/x]) \\<longrightarrow>\n          (\\<exists>t p.\n              (x ::= a, s) \\<Rightarrow> p \\<Down> t \\<and>\n              p \\<le> k * Suc 0 \\<and> P l t)", "by fastforce"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l (s[a/x]) \\<longrightarrow>\n        (\\<exists>t p.\n            (x ::= a, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * Suc 0 \\<and> P l t)\n\ngoal (4 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 3. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 4. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 3. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 4. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "case (Seq P1 x e2' c1 e1 P2 e2 c2 P3 e)"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {\\<lambda>l s. P1 l s \\<and> l x = e2' s} c1\n                       { e1 \\<Down> \\<lambda>l s.\n P2 l s \\<and> e2 s \\<le> l x}\n  \\<turnstile>\\<^sub>1 {P2} c2 { e2 \\<Down> P3}\n  x \\<notin> support P1\n  x \\<notin> support P2\n  P1 ?l ?s \\<Longrightarrow> e1 ?s + e2' ?s \\<le> e ?s\n  \\<exists>k>0.\n     \\<forall>l s.\n        P1 l s \\<and> l x = e2' s \\<longrightarrow>\n        (\\<exists>t p.\n            (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e1 s \\<and> P2 l t \\<and> e2 t \\<le> l x)\n  \\<exists>k>0.\n     \\<forall>l s.\n        P2 l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e2 s \\<and> P3 l t)\n\ngoal (4 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 3. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 4. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "from Seq(6)"], ["proof (chain)\npicking this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P1 l s \\<and> l x = e2' s \\<longrightarrow>\n        (\\<exists>t p.\n            (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e1 s \\<and> P2 l t \\<and> e2 t \\<le> l x)", "obtain k where k: \"k>0\" and  S6: \"\\<forall>l s. P1 l s \\<and> l x = e2' s \\<longrightarrow> (\\<exists>t p. (c1, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k * e1 s \\<and> P2 l t \\<and> e2 t \\<le> l x)\""], ["proof (prove)\nusing this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P1 l s \\<and> l x = e2' s \\<longrightarrow>\n        (\\<exists>t p.\n            (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e1 s \\<and> P2 l t \\<and> e2 t \\<le> l x)\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>0 < k;\n         \\<forall>l s.\n            P1 l s \\<and> l x = e2' s \\<longrightarrow>\n            (\\<exists>t p.\n                (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                p \\<le> k * e1 s \\<and>\n                P2 l t \\<and> e2 t \\<le> l x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k\n  \\<forall>l s.\n     P1 l s \\<and> l x = e2' s \\<longrightarrow>\n     (\\<exists>t p.\n         (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k * e1 s \\<and> P2 l t \\<and> e2 t \\<le> l x)\n\ngoal (4 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 3. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 4. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "from Seq(7)"], ["proof (chain)\npicking this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P2 l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e2 s \\<and> P3 l t)", "obtain k' where k': \"k'>0\" and  S7:  \"\\<forall>l s. P2 l s \\<longrightarrow> (\\<exists>t p. (c2, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k' * e2 s \\<and> P3 l t)\""], ["proof (prove)\nusing this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P2 l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e2 s \\<and> P3 l t)\n\ngoal (1 subgoal):\n 1. (\\<And>k'.\n        \\<lbrakk>0 < k';\n         \\<forall>l s.\n            P2 l s \\<longrightarrow>\n            (\\<exists>t p.\n                (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                p \\<le> k' * e2 s \\<and> P3 l t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k'\n  \\<forall>l s.\n     P2 l s \\<longrightarrow>\n     (\\<exists>t p.\n         (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k' * e2 s \\<and> P3 l t)\n\ngoal (4 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 3. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 4. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "from k k'"], ["proof (chain)\npicking this:\n  0 < k\n  0 < k'", "have \"0 < max k k'\""], ["proof (prove)\nusing this:\n  0 < k\n  0 < k'\n\ngoal (1 subgoal):\n 1. 0 < max k k'", "by auto"], ["proof (state)\nthis:\n  0 < max k k'\n\ngoal (4 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P\\<^sub>1 x e2' c\\<^sub>1 e1 P\\<^sub>2 e2 c\\<^sub>2 P\\<^sub>3 e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P\\<^sub>1 l s \\<and> l x = e2' s}\n                                     c\\<^sub>1\n                                     { e1 \\<Down> \\<lambda>l s.\n               P\\<^sub>2 l s \\<and> e2 s \\<le> l x};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>1 l s \\<and> l x = e2' s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and>\n                  P\\<^sub>2 l t \\<and> e2 t \\<le> l x);\n        \\<turnstile>\\<^sub>1 {P\\<^sub>2} c\\<^sub>2 { e2 \\<Down> P\\<^sub>3};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P\\<^sub>2 l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e2 s \\<and> P\\<^sub>3 l t);\n        x \\<notin> support P\\<^sub>1; x \\<notin> support P\\<^sub>2;\n        \\<And>l s.\n           P\\<^sub>1 l s \\<Longrightarrow> e1 s + e2' s \\<le> e s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P\\<^sub>1 l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c\\<^sub>1;; c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and> P\\<^sub>3 l t)\n 3. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 4. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          P1 l s \\<longrightarrow>\n          (\\<exists>t p.\n              (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n              p \\<le> k * e s \\<and> P3 l t)", "proof (rule exI[where x=\"max k k'\"], safe)"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "fix l s"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "have x_supp: \"x \\<notin> support P1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<notin> support P1", "by fact"], ["proof (state)\nthis:\n  x \\<notin> support P1\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "have x_supp2: \"x \\<notin> support P2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<notin> support P2", "by fact"], ["proof (state)\nthis:\n  x \\<notin> support P2\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "from S6"], ["proof (chain)\npicking this:\n  \\<forall>l s.\n     P1 l s \\<and> l x = e2' s \\<longrightarrow>\n     (\\<exists>t p.\n         (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k * e1 s \\<and> P2 l t \\<and> e2 t \\<le> l x)", "have S: \"P1 (l(x := e2' s)) s \\<and> (l(x := e2' s)) x = e2' s \\<longrightarrow> (\\<exists>t p. (c1, s) \\<Rightarrow> p \\<Down> t \\<and>  p \\<le> k * e1 s \\<and> P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x) \""], ["proof (prove)\nusing this:\n  \\<forall>l s.\n     P1 l s \\<and> l x = e2' s \\<longrightarrow>\n     (\\<exists>t p.\n         (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k * e1 s \\<and> P2 l t \\<and> e2 t \\<le> l x)\n\ngoal (1 subgoal):\n 1. P1 (l(x := e2' s)) s \\<and> (l(x := e2' s)) x = e2' s \\<longrightarrow>\n    (\\<exists>t p.\n        (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n        p \\<le> k * e1 s \\<and>\n        P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x)", "by blast"], ["proof (state)\nthis:\n  P1 (l(x := e2' s)) s \\<and> (l(x := e2' s)) x = e2' s \\<longrightarrow>\n  (\\<exists>t p.\n      (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n      p \\<le> k * e1 s \\<and>\n      P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x)\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "assume a: \"P1 l s\""], ["proof (state)\nthis:\n  P1 l s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "with Seq(5)"], ["proof (chain)\npicking this:\n  P1 ?l ?s \\<Longrightarrow> e1 ?s + e2' ?s \\<le> e ?s\n  P1 l s", "have 1: \" e1 s + e2' s \\<le>   e s\""], ["proof (prove)\nusing this:\n  P1 ?l ?s \\<Longrightarrow> e1 ?s + e2' ?s \\<le> e ?s\n  P1 l s\n\ngoal (1 subgoal):\n 1. e1 s + e2' s \\<le> e s", "by simp"], ["proof (state)\nthis:\n  e1 s + e2' s \\<le> e s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "with a S assn2_lupd[OF x_supp]"], ["proof (chain)\npicking this:\n  P1 l s\n  P1 (l(x := e2' s)) s \\<and> (l(x := e2' s)) x = e2' s \\<longrightarrow>\n  (\\<exists>t p.\n      (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n      p \\<le> k * e1 s \\<and>\n      P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x)\n  P1 (?l(x := ?n)) = P1 ?l\n  e1 s + e2' s \\<le> e s", "have \"(\\<exists>t p. (c1, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k * e1 s \\<and> P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x)\""], ["proof (prove)\nusing this:\n  P1 l s\n  P1 (l(x := e2' s)) s \\<and> (l(x := e2' s)) x = e2' s \\<longrightarrow>\n  (\\<exists>t p.\n      (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n      p \\<le> k * e1 s \\<and>\n      P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x)\n  P1 (?l(x := ?n)) = P1 ?l\n  e1 s + e2' s \\<le> e s\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> k * e1 s \\<and>\n       P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x", "by simp"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k * e1 s \\<and>\n     P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "then"], ["proof (chain)\npicking this:\n  \\<exists>t p.\n     (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k * e1 s \\<and>\n     P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x", "obtain t p where c1: \"(c1, s) \\<Rightarrow> p \\<Down> t\" and cost1: \" p \\<le> k * e1 s\" and P2': \"P2 (l(x := e2' s)) t\" and 31: \"e2 t \\<le> (l(x := e2' s)) x\""], ["proof (prove)\nusing this:\n  \\<exists>t p.\n     (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k * e1 s \\<and>\n     P2 (l(x := e2' s)) t \\<and> e2 t \\<le> (l(x := e2' s)) x\n\ngoal (1 subgoal):\n 1. (\\<And>p t.\n        \\<lbrakk>(c1, s) \\<Rightarrow> p \\<Down> t; p \\<le> k * e1 s;\n         P2 (l(x := e2' s)) t; e2 t \\<le> (l(x := e2' s)) x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k * e1 s\n  P2 (l(x := e2' s)) t\n  e2 t \\<le> (l(x := e2' s)) x\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "from P2' assn2_lupd[OF x_supp2]"], ["proof (chain)\npicking this:\n  P2 (l(x := e2' s)) t\n  P2 (?l(x := ?n)) = P2 ?l", "have P2: \"P2 l t\""], ["proof (prove)\nusing this:\n  P2 (l(x := e2' s)) t\n  P2 (?l(x := ?n)) = P2 ?l\n\ngoal (1 subgoal):\n 1. P2 l t", "by auto"], ["proof (state)\nthis:\n  P2 l t\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "from 31"], ["proof (chain)\npicking this:\n  e2 t \\<le> (l(x := e2' s)) x", "have 3: \"e2 t \\<le> e2' s\""], ["proof (prove)\nusing this:\n  e2 t \\<le> (l(x := e2' s)) x\n\ngoal (1 subgoal):\n 1. e2 t \\<le> e2' s", "by simp"], ["proof (state)\nthis:\n  e2 t \\<le> e2' s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "from S7 P2"], ["proof (chain)\npicking this:\n  \\<forall>l s.\n     P2 l s \\<longrightarrow>\n     (\\<exists>t p.\n         (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k' * e2 s \\<and> P3 l t)\n  P2 l t", "have \"(\\<exists>t' p'. ((c2, t) \\<Rightarrow> p' \\<Down> t') \\<and>   p' \\<le> k' * e2 t \\<and> P3 l t')\""], ["proof (prove)\nusing this:\n  \\<forall>l s.\n     P2 l s \\<longrightarrow>\n     (\\<exists>t p.\n         (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k' * e2 s \\<and> P3 l t)\n  P2 l t\n\ngoal (1 subgoal):\n 1. \\<exists>t' p'.\n       (c2, t) \\<Rightarrow> p' \\<Down> t' \\<and>\n       p' \\<le> k' * e2 t \\<and> P3 l t'", "by blast"], ["proof (state)\nthis:\n  \\<exists>t' p'.\n     (c2, t) \\<Rightarrow> p' \\<Down> t' \\<and>\n     p' \\<le> k' * e2 t \\<and> P3 l t'\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "then"], ["proof (chain)\npicking this:\n  \\<exists>t' p'.\n     (c2, t) \\<Rightarrow> p' \\<Down> t' \\<and>\n     p' \\<le> k' * e2 t \\<and> P3 l t'", "obtain t' p'  where c2: \"(c2, t) \\<Rightarrow> p' \\<Down> t'\" and cost2: \" p' \\<le> k' * (e2 t)\" and P3: \"P3 l t'\""], ["proof (prove)\nusing this:\n  \\<exists>t' p'.\n     (c2, t) \\<Rightarrow> p' \\<Down> t' \\<and>\n     p' \\<le> k' * e2 t \\<and> P3 l t'\n\ngoal (1 subgoal):\n 1. (\\<And>p' t'.\n        \\<lbrakk>(c2, t) \\<Rightarrow> p' \\<Down> t'; p' \\<le> k' * e2 t;\n         P3 l t'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c2, t) \\<Rightarrow> p' \\<Down> t'\n  p' \\<le> k' * e2 t\n  P3 l t'\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "from c1 c2"], ["proof (chain)\npicking this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  (c2, t) \\<Rightarrow> p' \\<Down> t'", "have weg: \"(c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t'\""], ["proof (prove)\nusing this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  (c2, t) \\<Rightarrow> p' \\<Down> t'\n\ngoal (1 subgoal):\n 1. (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t'", "apply (rule Big_StepT.Seq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. p + p' = p + p'", "by simp"], ["proof (state)\nthis:\n  (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t'\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "from cost1 cost2 3"], ["proof (chain)\npicking this:\n  p \\<le> k * e1 s\n  p' \\<le> k' * e2 t\n  e2 t \\<le> e2' s", "have \" (p+p') \\<le> k * (e1 s) + k' * (e2' s)\""], ["proof (prove)\nusing this:\n  p \\<le> k * e1 s\n  p' \\<le> k' * e2 t\n  e2 t \\<le> e2' s\n\ngoal (1 subgoal):\n 1. p + p' \\<le> k * e1 s + k' * e2' s", "by (meson add_mono mult_le_mono2 order_subst1)"], ["proof (state)\nthis:\n  p + p' \\<le> k * e1 s + k' * e2' s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "also"], ["proof (state)\nthis:\n  p + p' \\<le> k * e1 s + k' * e2' s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "have \"\\<dots> \\<le> (max k k') * (e1 s) + (max k k') * (e2' s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k * e1 s + k' * e2' s \\<le> max k k' * e1 s + max k k' * e2' s", "by (simp add: add_mono)"], ["proof (state)\nthis:\n  k * e1 s + k' * e2' s \\<le> max k k' * e1 s + max k k' * e2' s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "also"], ["proof (state)\nthis:\n  k * e1 s + k' * e2' s \\<le> max k k' * e1 s + max k k' * e2' s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "have \"\\<dots> \\<le> (max k k') * (e1 s + e2' s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. max k k' * e1 s + max k k' * e2' s \\<le> max k k' * (e1 s + e2' s)", "by (simp add: add_mult_distrib2)"], ["proof (state)\nthis:\n  max k k' * e1 s + max k k' * e2' s \\<le> max k k' * (e1 s + e2' s)\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "also"], ["proof (state)\nthis:\n  max k k' * e1 s + max k k' * e2' s \\<le> max k k' * (e1 s + e2' s)\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "have \"\\<dots> \\<le> (max k k') * (e s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. max k k' * (e1 s + e2' s) \\<le> max k k' * e s", "using 1"], ["proof (prove)\nusing this:\n  e1 s + e2' s \\<le> e s\n\ngoal (1 subgoal):\n 1. max k k' * (e1 s + e2' s) \\<le> max k k' * e s", "by simp"], ["proof (state)\nthis:\n  max k k' * (e1 s + e2' s) \\<le> max k k' * e s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "finally"], ["proof (chain)\npicking this:\n  p + p' \\<le> max k k' * e s", "have cost: \" (p + p') \\<le> (max k k') * (e s)\""], ["proof (prove)\nusing this:\n  p + p' \\<le> max k k' * e s\n\ngoal (1 subgoal):\n 1. p + p' \\<le> max k k' * e s", "."], ["proof (state)\nthis:\n  p + p' \\<le> max k k' * e s\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "from weg cost P3"], ["proof (chain)\npicking this:\n  (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t'\n  p + p' \\<le> max k k' * e s\n  P3 l t'", "have \"(c1;; c2, s) \\<Rightarrow> p+p' \\<Down> t' \\<and>   (p+p') \\<le> (max k k') * (e s) \\<and> P3 l t'\""], ["proof (prove)\nusing this:\n  (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t'\n  p + p' \\<le> max k k' * e s\n  P3 l t'\n\ngoal (1 subgoal):\n 1. (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t' \\<and>\n    p + p' \\<le> max k k' * e s \\<and> P3 l t'", "by blast"], ["proof (state)\nthis:\n  (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t' \\<and>\n  p + p' \\<le> max k k' * e s \\<and> P3 l t'\n\ngoal (2 subgoals):\n 1. 0 < max k k'\n 2. \\<And>l s.\n       P1 l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max k k' * e s \\<and> P3 l t", "then"], ["proof (chain)\npicking this:\n  (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t' \\<and>\n  p + p' \\<le> max k k' * e s \\<and> P3 l t'", "show \"(\\<exists>t p. (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>  p \\<le> (max k k') * (e s) \\<and> P3 l t)\""], ["proof (prove)\nusing this:\n  (c1;; c2, s) \\<Rightarrow> p + p' \\<Down> t' \\<and>\n  p + p' \\<le> max k k' * e s \\<and> P3 l t'\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max k k' * e s \\<and> P3 l t", "by metis"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> max k k' * e s \\<and> P3 l t\n\ngoal (1 subgoal):\n 1. 0 < max k k'", "qed fact"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P1 l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> P3 l t)\n\ngoal (3 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 3. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 3. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "case (If P b c1 e Q c2)"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s} c1\n                       { e \\<Down> Q}\n  \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s} c2\n                       { e \\<Down> Q}\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<and> bval b s \\<longrightarrow>\n        (\\<exists>t p.\n            (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<and> \\<not> bval b s \\<longrightarrow>\n        (\\<exists>t p.\n            (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)\n\ngoal (3 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 3. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "from If(3)"], ["proof (chain)\npicking this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<and> bval b s \\<longrightarrow>\n        (\\<exists>t p.\n            (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)", "obtain k1 where k1: \"k1>0\" and If1: \"\\<forall>l s. P l s \\<and> bval b s \\<longrightarrow> (\\<exists>t p. (c1, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k1 * e s \\<and> Q l t)\""], ["proof (prove)\nusing this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<and> bval b s \\<longrightarrow>\n        (\\<exists>t p.\n            (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)\n\ngoal (1 subgoal):\n 1. (\\<And>k1.\n        \\<lbrakk>0 < k1;\n         \\<forall>l s.\n            P l s \\<and> bval b s \\<longrightarrow>\n            (\\<exists>t p.\n                (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                p \\<le> k1 * e s \\<and> Q l t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k1\n  \\<forall>l s.\n     P l s \\<and> bval b s \\<longrightarrow>\n     (\\<exists>t p.\n         (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k1 * e s \\<and> Q l t)\n\ngoal (3 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 3. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "from If(4)"], ["proof (chain)\npicking this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<and> \\<not> bval b s \\<longrightarrow>\n        (\\<exists>t p.\n            (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)", "obtain k2 where  k2: \"k2>0\" and If2: \"\\<forall>l s. P l s \\<and> \\<not> bval b s \\<longrightarrow> (\\<exists>t p. (c2, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k2 * e s \\<and> Q l t)\""], ["proof (prove)\nusing this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<and> \\<not> bval b s \\<longrightarrow>\n        (\\<exists>t p.\n            (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)\n\ngoal (1 subgoal):\n 1. (\\<And>k2.\n        \\<lbrakk>0 < k2;\n         \\<forall>l s.\n            P l s \\<and> \\<not> bval b s \\<longrightarrow>\n            (\\<exists>t p.\n                (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                p \\<le> k2 * e s \\<and> Q l t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k2\n  \\<forall>l s.\n     P l s \\<and> \\<not> bval b s \\<longrightarrow>\n     (\\<exists>t p.\n         (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k2 * e s \\<and> Q l t)\n\ngoal (3 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 3. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "let ?k' = \"max (k1+1) (k2+1)\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 3. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "have \"?k'>0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < max (k1 + 1) (k2 + 1)", "by auto"], ["proof (state)\nthis:\n  0 < max (k1 + 1) (k2 + 1)\n\ngoal (3 subgoals):\n 1. \\<And>P b c\\<^sub>1 e1 Q c\\<^sub>2.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> bval b s}\n                                     c\\<^sub>1 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t);\n        \\<turnstile>\\<^sub>1 {\\<lambda>l s. P l s \\<and> \\<not> bval b s}\n                             c\\<^sub>2 { e1 \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> \\<not> bval b s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c\\<^sub>2, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e1 s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * (e1 s + Suc 0) \\<and> Q l t)\n 2. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 3. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          P l s \\<longrightarrow>\n          (\\<exists>t p.\n              (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n              p \\<le> k * (e s + Suc 0) \\<and> Q l t)", "proof (rule exI[where x=\"?k'\"], safe)"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < max (k1 + 1) (k2 + 1)\n 2. \\<And>l s.\n       P l s \\<Longrightarrow>\n       \\<exists>t p.\n          (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "fix l s"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < max (k1 + 1) (k2 + 1)\n 2. \\<And>l s.\n       P l s \\<Longrightarrow>\n       \\<exists>t p.\n          (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "assume P1: \"P l s\""], ["proof (state)\nthis:\n  P l s\n\ngoal (2 subgoals):\n 1. 0 < max (k1 + 1) (k2 + 1)\n 2. \\<And>l s.\n       P l s \\<Longrightarrow>\n       \\<exists>t p.\n          (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "show \"\\<exists>t p. (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>  p \\<le> ?k' * (e s + Suc 0) \\<and> Q l t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "proof (cases \"bval b s\")"], ["proof (state)\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "case True"], ["proof (state)\nthis:\n  bval b s\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "with If1 P1"], ["proof (chain)\npicking this:\n  \\<forall>l s.\n     P l s \\<and> bval b s \\<longrightarrow>\n     (\\<exists>t p.\n         (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k1 * e s \\<and> Q l t)\n  P l s\n  bval b s", "obtain t p where \"(c1, s) \\<Rightarrow> p \\<Down> t\" \"p \\<le> k1 * (e s)\" \"Q l t\""], ["proof (prove)\nusing this:\n  \\<forall>l s.\n     P l s \\<and> bval b s \\<longrightarrow>\n     (\\<exists>t p.\n         (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k1 * e s \\<and> Q l t)\n  P l s\n  bval b s\n\ngoal (1 subgoal):\n 1. (\\<And>p t.\n        \\<lbrakk>(c1, s) \\<Rightarrow> p \\<Down> t; p \\<le> k1 * e s;\n         Q l t\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k1 * e s\n  Q l t\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "with True"], ["proof (chain)\npicking this:\n  bval b s\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k1 * e s\n  Q l t", "have 1: \"(IF b THEN c1 ELSE c2, s) \\<Rightarrow> p+1 \\<Down> t\" \"(p + 1) \\<le> (k1+1) * (e s  + Suc 0)\"\n          \"Q l t\""], ["proof (prove)\nusing this:\n  bval b s\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k1 * e s\n  Q l t\n\ngoal (1 subgoal):\n 1. (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t &&&\n    p + 1 \\<le> (k1 + 1) * (e s + Suc 0) &&& Q l t", "by auto"], ["proof (state)\nthis:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k1 + 1) * (e s + Suc 0)\n  Q l t\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "have \"(k1+1) * (e s  + Suc 0) \\<le> ?k' * (e s  + Suc 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (k1 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "by (simp add: nat_mult_max_left)"], ["proof (state)\nthis:\n  (k1 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "with 1"], ["proof (chain)\npicking this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k1 + 1) * (e s + Suc 0)\n  Q l t\n  (k1 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "have 2: \"p+1   \\<le> ?k' * (e s  + Suc 0)\""], ["proof (prove)\nusing this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k1 + 1) * (e s + Suc 0)\n  Q l t\n  (k1 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (1 subgoal):\n 1. p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "by linarith"], ["proof (state)\nthis:\n  p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "from 1 2"], ["proof (chain)\npicking this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k1 + 1) * (e s + Suc 0)\n  Q l t\n  p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "show \"\\<exists>t p. (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> ?k' * (e s + Suc 0) \\<and> Q l t\""], ["proof (prove)\nusing this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k1 + 1) * (e s + Suc 0)\n  Q l t\n  p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "by metis"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "case False"], ["proof (state)\nthis:\n  \\<not> bval b s\n\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "with If2 P1"], ["proof (chain)\npicking this:\n  \\<forall>l s.\n     P l s \\<and> \\<not> bval b s \\<longrightarrow>\n     (\\<exists>t p.\n         (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k2 * e s \\<and> Q l t)\n  P l s\n  \\<not> bval b s", "obtain t p where \"(c2, s) \\<Rightarrow> p \\<Down> t\" \"p \\<le> k2 * (e s)\" \"Q l t\""], ["proof (prove)\nusing this:\n  \\<forall>l s.\n     P l s \\<and> \\<not> bval b s \\<longrightarrow>\n     (\\<exists>t p.\n         (c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k2 * e s \\<and> Q l t)\n  P l s\n  \\<not> bval b s\n\ngoal (1 subgoal):\n 1. (\\<And>p t.\n        \\<lbrakk>(c2, s) \\<Rightarrow> p \\<Down> t; p \\<le> k2 * e s;\n         Q l t\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c2, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k2 * e s\n  Q l t\n\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "with False"], ["proof (chain)\npicking this:\n  \\<not> bval b s\n  (c2, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k2 * e s\n  Q l t", "have 1: \"(IF b THEN c1 ELSE c2, s) \\<Rightarrow> p+1 \\<Down> t\" \"(p + 1) \\<le> (k2+1) * ( e s  + Suc 0)\"\n          \"Q l t\""], ["proof (prove)\nusing this:\n  \\<not> bval b s\n  (c2, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k2 * e s\n  Q l t\n\ngoal (1 subgoal):\n 1. (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t &&&\n    p + 1 \\<le> (k2 + 1) * (e s + Suc 0) &&& Q l t", "by auto"], ["proof (state)\nthis:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k2 + 1) * (e s + Suc 0)\n  Q l t\n\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "have \"(k2+1) * (e s  + Suc 0) \\<le> ?k' * (e s  + Suc 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (k2 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "by (simp add: nat_mult_max_left)"], ["proof (state)\nthis:\n  (k2 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "with 1"], ["proof (chain)\npicking this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k2 + 1) * (e s + Suc 0)\n  Q l t\n  (k2 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "have 2: \"p+1   \\<le> ?k' * (e s  + Suc 0)\""], ["proof (prove)\nusing this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k2 + 1) * (e s + Suc 0)\n  Q l t\n  (k2 + 1) * (e s + Suc 0) \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (1 subgoal):\n 1. p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "by linarith"], ["proof (state)\nthis:\n  p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "from 1 2"], ["proof (chain)\npicking this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k2 + 1) * (e s + Suc 0)\n  Q l t\n  p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)", "show \"\\<exists>t p. (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>  p \\<le> ?k' * (e s + Suc 0) \\<and> Q l t\""], ["proof (prove)\nusing this:\n  (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p + 1 \\<Down> t\n  p + 1 \\<le> (k2 + 1) * (e s + Suc 0)\n  Q l t\n  p + 1 \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0)\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t", "by metis"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> max (k1 + 1) (k2 + 1) * (e s + Suc 0) \\<and> Q l t\n\ngoal (1 subgoal):\n 1. 0 < max (k1 + 1) (k2 + 1)", "qed fact"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t p.\n            (IF b THEN c1 ELSE c2, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * (e s + Suc 0) \\<and> Q l t)\n\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "case (conseq P' e e' P Q Q' c)"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P' l s \\<longrightarrow>\n        e s \\<le> k * e' s \\<and>\n        (\\<forall>t.\n            \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))\n  \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q}\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)\n\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "from conseq(1)"], ["proof (chain)\npicking this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P' l s \\<longrightarrow>\n        e s \\<le> k * e' s \\<and>\n        (\\<forall>t.\n            \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))", "obtain k1 where k1: \"k1>0\" and c1: \"\\<forall>l s. P' l s \\<longrightarrow> e s \\<le> k1 * e' s \\<and> (\\<forall>t. \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))\""], ["proof (prove)\nusing this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P' l s \\<longrightarrow>\n        e s \\<le> k * e' s \\<and>\n        (\\<forall>t.\n            \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))\n\ngoal (1 subgoal):\n 1. (\\<And>k1.\n        \\<lbrakk>0 < k1;\n         \\<forall>l s.\n            P' l s \\<longrightarrow>\n            e s \\<le> k1 * e' s \\<and>\n            (\\<forall>t.\n                \\<exists>l'.\n                   P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k1\n  \\<forall>l s.\n     P' l s \\<longrightarrow>\n     e s \\<le> k1 * e' s \\<and>\n     (\\<forall>t.\n         \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))\n\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "then"], ["proof (chain)\npicking this:\n  0 < k1\n  \\<forall>l s.\n     P' l s \\<longrightarrow>\n     e s \\<le> k1 * e' s \\<and>\n     (\\<forall>t.\n         \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))", "have c1': \"\\<And>l s. P' l s \\<Longrightarrow> e s \\<le> k1 * e' s \\<and> (\\<forall>t. \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))\""], ["proof (prove)\nusing this:\n  0 < k1\n  \\<forall>l s.\n     P' l s \\<longrightarrow>\n     e s \\<le> k1 * e' s \\<and>\n     (\\<forall>t.\n         \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))\n\ngoal (1 subgoal):\n 1. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       e s \\<le> k1 * e' s \\<and>\n       (\\<forall>t.\n           \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))", "by auto"], ["proof (state)\nthis:\n  P' ?l ?s \\<Longrightarrow>\n  e ?s \\<le> k1 * e' ?s \\<and>\n  (\\<forall>t.\n      \\<exists>l'. P l' ?s \\<and> (Q l' t \\<longrightarrow> Q' ?l t))\n\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "from conseq(3)"], ["proof (chain)\npicking this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)", "obtain k2 where k2: \"k2>0\" and c2: \"\\<forall>l s. P l s \\<longrightarrow> (\\<exists>t p. (c, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k2 * e s \\<and> Q l t)\""], ["proof (prove)\nusing this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> Q l t)\n\ngoal (1 subgoal):\n 1. (\\<And>k2.\n        \\<lbrakk>0 < k2;\n         \\<forall>l s.\n            P l s \\<longrightarrow>\n            (\\<exists>t p.\n                (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                p \\<le> k2 * e s \\<and> Q l t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 < k2\n  \\<forall>l s.\n     P l s \\<longrightarrow>\n     (\\<exists>t p.\n         (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k2 * e s \\<and> Q l t)\n\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "then"], ["proof (chain)\npicking this:\n  0 < k2\n  \\<forall>l s.\n     P l s \\<longrightarrow>\n     (\\<exists>t p.\n         (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k2 * e s \\<and> Q l t)", "have c2': \"\\<And>l s.  P l s \\<Longrightarrow> (\\<exists>t p. (c, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k2 * e s \\<and> Q l t)\""], ["proof (prove)\nusing this:\n  0 < k2\n  \\<forall>l s.\n     P l s \\<longrightarrow>\n     (\\<exists>t p.\n         (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k2 * e s \\<and> Q l t)\n\ngoal (1 subgoal):\n 1. \\<And>l s.\n       P l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * e s \\<and> Q l t", "by auto"], ["proof (state)\nthis:\n  P ?l ?s \\<Longrightarrow>\n  \\<exists>t p.\n     (c, ?s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k2 * e ?s \\<and> Q ?l t\n\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "have \"k2*k1 > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < k2 * k1", "using k1 k2"], ["proof (prove)\nusing this:\n  0 < k1\n  0 < k2\n\ngoal (1 subgoal):\n 1. 0 < k2 * k1", "by auto"], ["proof (state)\nthis:\n  0 < k2 * k1\n\ngoal (2 subgoals):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)\n 2. \\<And>P' e e' P Q Q' c.\n       \\<lbrakk>\\<exists>k>0.\n                   \\<forall>l s.\n                      P' l s \\<longrightarrow>\n                      e s \\<le> k * e' s \\<and>\n                      (\\<forall>t.\n                          \\<exists>l'.\n                             P l' s \\<and>\n                             (Q l' t \\<longrightarrow> Q' l t));\n        \\<turnstile>\\<^sub>1 {P} c { e \\<Down> Q};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P' l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e' s \\<and> Q' l t)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          P' l s \\<longrightarrow>\n          (\\<exists>t p.\n              (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n              p \\<le> k * e' s \\<and> Q' l t)", "proof (rule exI[where x=\"k2*k1\"], safe)"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "fix l s"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "assume \"P' l s\""], ["proof (state)\nthis:\n  P' l s\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "with c1'"], ["proof (chain)\npicking this:\n  P' ?l ?s \\<Longrightarrow>\n  e ?s \\<le> k1 * e' ?s \\<and>\n  (\\<forall>t.\n      \\<exists>l'. P l' ?s \\<and> (Q l' t \\<longrightarrow> Q' ?l t))\n  P' l s", "have A: \"e s \\<le> k1 * e' s\" and \"\\<And>t. \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t)\""], ["proof (prove)\nusing this:\n  P' ?l ?s \\<Longrightarrow>\n  e ?s \\<le> k1 * e' ?s \\<and>\n  (\\<forall>t.\n      \\<exists>l'. P l' ?s \\<and> (Q l' t \\<longrightarrow> Q' ?l t))\n  P' l s\n\ngoal (1 subgoal):\n 1. e s \\<le> k1 * e' s &&&\n    (\\<And>t. \\<exists>l'. P l' s \\<and> (Q l' t \\<longrightarrow> Q' l t))", "by auto"], ["proof (state)\nthis:\n  e s \\<le> k1 * e' s\n  \\<exists>l'. P l' s \\<and> (Q l' ?t \\<longrightarrow> Q' l ?t)\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "then"], ["proof (chain)\npicking this:\n  e s \\<le> k1 * e' s\n  \\<exists>l'. P l' s \\<and> (Q l' ?t \\<longrightarrow> Q' l ?t)", "obtain fl where \"\\<And>t. P (fl t) s\" and B: \"\\<And>t. Q (fl t) t \\<longrightarrow> Q' l t\""], ["proof (prove)\nusing this:\n  e s \\<le> k1 * e' s\n  \\<exists>l'. P l' s \\<and> (Q l' ?t \\<longrightarrow> Q' l ?t)\n\ngoal (1 subgoal):\n 1. (\\<And>fl.\n        \\<lbrakk>\\<And>t. P (fl t) s;\n         \\<And>t. Q (fl t) t \\<longrightarrow> Q' l t\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  P (fl ?t) s\n  Q (fl ?t) ?t \\<longrightarrow> Q' l ?t\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "with c2'"], ["proof (chain)\npicking this:\n  P ?l ?s \\<Longrightarrow>\n  \\<exists>t p.\n     (c, ?s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k2 * e ?s \\<and> Q ?l t\n  P (fl ?t) s\n  Q (fl ?t) ?t \\<longrightarrow> Q' l ?t", "obtain ft fp where i: \"\\<And>t. (c, s) \\<Rightarrow> (fp t) \\<Down> (ft t)\" and ii: \"\\<And>t. (fp t) \\<le> k2 * e s\"\n        and iii: \"\\<And>t. Q (fl t) (ft t)\""], ["proof (prove)\nusing this:\n  P ?l ?s \\<Longrightarrow>\n  \\<exists>t p.\n     (c, ?s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k2 * e ?s \\<and> Q ?l t\n  P (fl ?t) s\n  Q (fl ?t) ?t \\<longrightarrow> Q' l ?t\n\ngoal (1 subgoal):\n 1. (\\<And>fp ft.\n        \\<lbrakk>\\<And>t. (c, s) \\<Rightarrow> fp t \\<Down> ft t;\n         \\<And>t. fp t \\<le> k2 * e s; \\<And>t. Q (fl t) (ft t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by meson"], ["proof (state)\nthis:\n  (c, s) \\<Rightarrow> fp ?t \\<Down> ft ?t\n  fp ?t \\<le> k2 * e s\n  Q (fl ?t) (ft ?t)\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "from i"], ["proof (chain)\npicking this:\n  (c, s) \\<Rightarrow> fp ?t \\<Down> ft ?t", "obtain t p where tt: \"\\<And>x. ft x = t\" \"\\<And>x. fp x = p\""], ["proof (prove)\nusing this:\n  (c, s) \\<Rightarrow> fp ?t \\<Down> ft ?t\n\ngoal (1 subgoal):\n 1. (\\<And>t p.\n        \\<lbrakk>\\<And>x. ft x = t; \\<And>x. fp x = p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using big_step_t_determ2"], ["proof (prove)\nusing this:\n  (c, s) \\<Rightarrow> fp ?t \\<Down> ft ?t\n  \\<lbrakk>(?c, ?s) \\<Rightarrow> ?p \\<Down> ?t;\n   (?c, ?s) \\<Rightarrow> ?q \\<Down> ?u\\<rbrakk>\n  \\<Longrightarrow> ?u = ?t \\<and> ?p = ?q\n\ngoal (1 subgoal):\n 1. (\\<And>t p.\n        \\<lbrakk>\\<And>x. ft x = t; \\<And>x. fp x = p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by meson"], ["proof (state)\nthis:\n  ft ?x = t\n  fp ?x = p\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "with i"], ["proof (chain)\npicking this:\n  (c, s) \\<Rightarrow> fp ?t \\<Down> ft ?t\n  ft ?x = t\n  fp ?x = p", "have c: \"(c, s) \\<Rightarrow> p \\<Down> t\""], ["proof (prove)\nusing this:\n  (c, s) \\<Rightarrow> fp ?t \\<Down> ft ?t\n  ft ?x = t\n  fp ?x = p\n\ngoal (1 subgoal):\n 1. (c, s) \\<Rightarrow> p \\<Down> t", "by simp"], ["proof (state)\nthis:\n  (c, s) \\<Rightarrow> p \\<Down> t\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "from tt ii iii"], ["proof (chain)\npicking this:\n  ft ?x = t\n  fp ?x = p\n  fp ?t \\<le> k2 * e s\n  Q (fl ?t) (ft ?t)", "have p: \"p \\<le> k2 * e s\" and Q: \"\\<And>x. Q (fl x) t\""], ["proof (prove)\nusing this:\n  ft ?x = t\n  fp ?x = p\n  fp ?t \\<le> k2 * e s\n  Q (fl ?t) (ft ?t)\n\ngoal (1 subgoal):\n 1. p \\<le> k2 * e s &&& (\\<And>x. Q (fl x) t)", "by auto"], ["proof (state)\nthis:\n  p \\<le> k2 * e s\n  Q (fl ?x) t\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "have p: \"p \\<le> k2 * k1 * e' s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<le> k2 * k1 * e' s", "using p A"], ["proof (prove)\nusing this:\n  p \\<le> k2 * e s\n  e s \\<le> k1 * e' s\n\ngoal (1 subgoal):\n 1. p \\<le> k2 * k1 * e' s", "by (metis le_trans mult.assoc mult_le_mono2)"], ["proof (state)\nthis:\n  p \\<le> k2 * k1 * e' s\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "from B Q"], ["proof (chain)\npicking this:\n  Q (fl ?t) ?t \\<longrightarrow> Q' l ?t\n  Q (fl ?x) t", "have q: \"Q' l t\""], ["proof (prove)\nusing this:\n  Q (fl ?t) ?t \\<longrightarrow> Q' l ?t\n  Q (fl ?x) t\n\ngoal (1 subgoal):\n 1. Q' l t", "by fast"], ["proof (state)\nthis:\n  Q' l t\n\ngoal (2 subgoals):\n 1. 0 < k2 * k1\n 2. \\<And>l s.\n       P' l s \\<Longrightarrow>\n       \\<exists>t p.\n          (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> k2 * k1 * e' s \\<and> Q' l t", "from c p q"], ["proof (chain)\npicking this:\n  (c, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k2 * k1 * e' s\n  Q' l t", "show \"\\<exists>t p. (c, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le>  k2 *k1 * e' s \\<and> Q' l t\""], ["proof (prove)\nusing this:\n  (c, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k2 * k1 * e' s\n  Q' l t\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> k2 * k1 * e' s \\<and> Q' l t", "by blast"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k2 * k1 * e' s \\<and> Q' l t\n\ngoal (1 subgoal):\n 1. 0 < k2 * k1", "qed fact"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        P' l s \\<longrightarrow>\n        (\\<exists>t p.\n            (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e' s \\<and> Q' l t)\n\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "case (While INV b e' y c e'' e)"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                           INV l s \\<and> bval b s \\<and> e' s = l y}\n                       c { e'' \\<Down> \\<lambda>l s.\n    INV l s \\<and> e s \\<le> l y}\n  \\<forall>l s.\n     bval b s \\<and> INV l s \\<longrightarrow> 1 + e' s + e'' s \\<le> e s\n  \\<forall>l s. \\<not> bval b s \\<and> INV l s \\<longrightarrow> 1 \\<le> e s\n  y \\<notin> support INV\n  \\<exists>k>0.\n     \\<forall>l s.\n        INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n        (\\<exists>t p.\n            (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e'' s \\<and> INV l t \\<and> e t \\<le> l y)\n\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "from While(5)"], ["proof (chain)\npicking this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n        (\\<exists>t p.\n            (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e'' s \\<and> INV l t \\<and> e t \\<le> l y)", "obtain k where W6: \"\\<forall>l s. INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow> (\\<exists>t p. (c, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> k * e'' s \\<and> INV l t \\<and> e t \\<le> l y)\""], ["proof (prove)\nusing this:\n  \\<exists>k>0.\n     \\<forall>l s.\n        INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n        (\\<exists>t p.\n            (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e'' s \\<and> INV l t \\<and> e t \\<le> l y)\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<forall>l s.\n           INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n           (\\<exists>t p.\n               (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n               p \\<le> k * e'' s \\<and>\n               INV l t \\<and> e t \\<le> l y) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  \\<forall>l s.\n     INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n     (\\<exists>t p.\n         (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k * e'' s \\<and> INV l t \\<and> e t \\<le> l y)\n\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "let ?k' = \"k+1\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "fix n l s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "have \"\\<lbrakk> e s = n; INV l s \\<rbrakk> \\<Longrightarrow> \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> ?k' * e s \\<and> INV l t \\<and> \\<not> bval b t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>e s = n; INV l s\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t p.\n                         (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                         p \\<le> (k + 1) * e s \\<and>\n                         INV l t \\<and> \\<not> bval b t", "proof(induction \"n\" arbitrary: l s rule: less_induct)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x l s.\n       \\<lbrakk>\\<And>y l s.\n                   \\<lbrakk>y < x; e s = y; INV l s\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t p.\n  (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n  p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t;\n        e s = x; INV l s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t p.\n                            (WHILE b DO c,\n                             s) \\<Rightarrow> p \\<Down> t \\<and>\n                            p \\<le> (k + 1) * e s \\<and>\n                            INV l t \\<and> \\<not> bval b t", "case (less x)"], ["proof (state)\nthis:\n  \\<lbrakk>?y < x; e ?s = ?y; INV ?l ?s\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t p.\n                       (WHILE b DO c, ?s) \\<Rightarrow> p \\<Down> t \\<and>\n                       p \\<le> (k + 1) * e ?s \\<and>\n                       INV ?l t \\<and> \\<not> bval b t\n  e s = x\n  INV l s\n\ngoal (1 subgoal):\n 1. \\<And>x l s.\n       \\<lbrakk>\\<And>y l s.\n                   \\<lbrakk>y < x; e s = y; INV l s\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t p.\n  (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n  p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t;\n        e s = x; INV l s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t p.\n                            (WHILE b DO c,\n                             s) \\<Rightarrow> p \\<Down> t \\<and>\n                            p \\<le> (k + 1) * e s \\<and>\n                            INV l t \\<and> \\<not> bval b t", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "proof (cases \"bval b s\")"], ["proof (state)\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "case False"], ["proof (state)\nthis:\n  \\<not> bval b s\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "with less(2,3) While(3)"], ["proof (chain)\npicking this:\n  e s = x\n  INV l s\n  \\<forall>l s. \\<not> bval b s \\<and> INV l s \\<longrightarrow> 1 \\<le> e s\n  \\<not> bval b s", "have  b: \"1 \\<le> e s\""], ["proof (prove)\nusing this:\n  e s = x\n  INV l s\n  \\<forall>l s. \\<not> bval b s \\<and> INV l s \\<longrightarrow> 1 \\<le> e s\n  \\<not> bval b s\n\ngoal (1 subgoal):\n 1. 1 \\<le> e s", "by auto"], ["proof (state)\nthis:\n  1 \\<le> e s\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t\n 2. \\<not> bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "apply(rule exI[where x=s])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> s \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l s \\<and> \\<not> bval b s", "apply(rule exI[where x=1])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (WHILE b DO c, s) \\<Rightarrow> 1 \\<Down> s \\<and>\n    1 \\<le> (k + 1) * e s \\<and> INV l s \\<and> \\<not> bval b s", "apply safe"], ["proof (prove)\ngoal (4 subgoals):\n 1. (WHILE b DO c, s) \\<Rightarrow> 1 \\<Down> s\n 2. 1 \\<le> (k + 1) * e s\n 3. INV l s\n 4. bval b s \\<Longrightarrow> False", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (WHILE b DO c, s) \\<Rightarrow> 1 \\<Down> s", "using  WhileFalse[OF False]"], ["proof (prove)\nusing this:\n  (WHILE b DO ?c, s) \\<Rightarrow> Suc 0 \\<Down> s\n\ngoal (1 subgoal):\n 1. (WHILE b DO c, s) \\<Rightarrow> 1 \\<Down> s", "by simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. 1 \\<le> (k + 1) * e s\n 2. INV l s\n 3. bval b s \\<Longrightarrow> False", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> (k + 1) * e s", "using b"], ["proof (prove)\nusing this:\n  1 \\<le> e s\n\ngoal (1 subgoal):\n 1. 1 \\<le> (k + 1) * e s", "by auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. INV l s\n 2. bval b s \\<Longrightarrow> False", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. INV l s", "using less"], ["proof (prove)\nusing this:\n  \\<lbrakk>?y < x; e ?s = ?y; INV ?l ?s\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t p.\n                       (WHILE b DO c, ?s) \\<Rightarrow> p \\<Down> t \\<and>\n                       p \\<le> (k + 1) * e ?s \\<and>\n                       INV ?l t \\<and> \\<not> bval b t\n  e s = x\n  INV l s\n\ngoal (1 subgoal):\n 1. INV l s", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow> False", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow> False", "using False"], ["proof (prove)\nusing this:\n  \\<not> bval b s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow> False", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "case True"], ["proof (state)\nthis:\n  bval b s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "with less(2,3) While(2)"], ["proof (chain)\npicking this:\n  e s = x\n  INV l s\n  \\<forall>l s.\n     bval b s \\<and> INV l s \\<longrightarrow> 1 + e' s + e'' s \\<le> e s\n  bval b s", "have bT: \"bval b s\" and cost1: \"  1 + e' s + e'' s \\<le> e s\""], ["proof (prove)\nusing this:\n  e s = x\n  INV l s\n  \\<forall>l s.\n     bval b s \\<and> INV l s \\<longrightarrow> 1 + e' s + e'' s \\<le> e s\n  bval b s\n\ngoal (1 subgoal):\n 1. bval b s &&& 1 + e' s + e'' s \\<le> e s", "by auto"], ["proof (state)\nthis:\n  bval b s\n  1 + e' s + e'' s \\<le> e s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "let ?l' = \"l(y := e' s)\""], ["proof (state)\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have y_supp: \"y \\<notin> support INV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<notin> support INV", "by fact"], ["proof (state)\nthis:\n  y \\<notin> support INV\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "from cost1"], ["proof (chain)\npicking this:\n  1 + e' s + e'' s \\<le> e s", "have Z: \"e' s < x\""], ["proof (prove)\nusing this:\n  1 + e' s + e'' s \\<le> e s\n\ngoal (1 subgoal):\n 1. e' s < x", "using less(2)"], ["proof (prove)\nusing this:\n  1 + e' s + e'' s \\<le> e s\n  e s = x\n\ngoal (1 subgoal):\n 1. e' s < x", "by auto"], ["proof (state)\nthis:\n  e' s < x\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "from W6"], ["proof (chain)\npicking this:\n  \\<forall>l s.\n     INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n     (\\<exists>t p.\n         (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k * e'' s \\<and> INV l t \\<and> e t \\<le> l y)", "have \"INV ?l' s \\<and> bval b s \\<and> e' s = ?l' y\n            \\<longrightarrow> (\\<exists>t p. (c, s) \\<Rightarrow> p \\<Down> t \\<and>   p \\<le> k * e'' s  \\<and> INV ?l' t \\<and> e t \\<le> ?l' y)\""], ["proof (prove)\nusing this:\n  \\<forall>l s.\n     INV l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n     (\\<exists>t p.\n         (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n         p \\<le> k * e'' s \\<and> INV l t \\<and> e t \\<le> l y)\n\ngoal (1 subgoal):\n 1. INV (l(y := e' s)) s \\<and>\n    bval b s \\<and> e' s = (l(y := e' s)) y \\<longrightarrow>\n    (\\<exists>t p.\n        (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n        p \\<le> k * e'' s \\<and>\n        INV (l(y := e' s)) t \\<and> e t \\<le> (l(y := e' s)) y)", "by blast"], ["proof (state)\nthis:\n  INV (l(y := e' s)) s \\<and>\n  bval b s \\<and> e' s = (l(y := e' s)) y \\<longrightarrow>\n  (\\<exists>t p.\n      (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n      p \\<le> k * e'' s \\<and>\n      INV (l(y := e' s)) t \\<and> e t \\<le> (l(y := e' s)) y)\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "with less(3) bT"], ["proof (chain)\npicking this:\n  INV l s\n  bval b s\n  INV (l(y := e' s)) s \\<and>\n  bval b s \\<and> e' s = (l(y := e' s)) y \\<longrightarrow>\n  (\\<exists>t p.\n      (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n      p \\<le> k * e'' s \\<and>\n      INV (l(y := e' s)) t \\<and> e t \\<le> (l(y := e' s)) y)", "have \"(\\<exists>t p. ((c, s) \\<Rightarrow> p \\<Down> t) \\<and>   p \\<le> k * e'' s  \\<and> INV ?l' t \\<and> e t \\<le> e' s)\""], ["proof (prove)\nusing this:\n  INV l s\n  bval b s\n  INV (l(y := e' s)) s \\<and>\n  bval b s \\<and> e' s = (l(y := e' s)) y \\<longrightarrow>\n  (\\<exists>t p.\n      (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n      p \\<le> k * e'' s \\<and>\n      INV (l(y := e' s)) t \\<and> e t \\<le> (l(y := e' s)) y)\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> k * e'' s \\<and> INV (l(y := e' s)) t \\<and> e t \\<le> e' s", "using   assn2_lupd[OF y_supp]"], ["proof (prove)\nusing this:\n  INV l s\n  bval b s\n  INV (l(y := e' s)) s \\<and>\n  bval b s \\<and> e' s = (l(y := e' s)) y \\<longrightarrow>\n  (\\<exists>t p.\n      (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n      p \\<le> k * e'' s \\<and>\n      INV (l(y := e' s)) t \\<and> e t \\<le> (l(y := e' s)) y)\n  INV (?l(y := ?n)) = INV ?l\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> k * e'' s \\<and> INV (l(y := e' s)) t \\<and> e t \\<le> e' s", "by(auto)"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k * e'' s \\<and> INV (l(y := e' s)) t \\<and> e t \\<le> e' s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "then"], ["proof (chain)\npicking this:\n  \\<exists>t p.\n     (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k * e'' s \\<and> INV (l(y := e' s)) t \\<and> e t \\<le> e' s", "obtain t p   where ceff: \"(c, s) \\<Rightarrow> p \\<Down> t\" and cost2: \" p \\<le>  k * e'' s\" \n                    and INVz': \"INV ?l' t\" and cost3: \"  e t \\<le>   e' s\""], ["proof (prove)\nusing this:\n  \\<exists>t p.\n     (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> k * e'' s \\<and> INV (l(y := e' s)) t \\<and> e t \\<le> e' s\n\ngoal (1 subgoal):\n 1. (\\<And>p t.\n        \\<lbrakk>(c, s) \\<Rightarrow> p \\<Down> t; p \\<le> k * e'' s;\n         INV (l(y := e' s)) t; e t \\<le> e' s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c, s) \\<Rightarrow> p \\<Down> t\n  p \\<le> k * e'' s\n  INV (l(y := e' s)) t\n  e t \\<le> e' s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "from INVz'"], ["proof (chain)\npicking this:\n  INV (l(y := e' s)) t", "have INVz: \"INV l t\""], ["proof (prove)\nusing this:\n  INV (l(y := e' s)) t\n\ngoal (1 subgoal):\n 1. INV l t", "using assn2_lupd[OF y_supp]"], ["proof (prove)\nusing this:\n  INV (l(y := e' s)) t\n  INV (?l(y := ?n)) = INV ?l\n\ngoal (1 subgoal):\n 1. INV l t", "by auto"], ["proof (state)\nthis:\n  INV l t\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have \"e t < x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e t < x", "using Z cost3"], ["proof (prove)\nusing this:\n  e' s < x\n  e t \\<le> e' s\n\ngoal (1 subgoal):\n 1. e t < x", "by auto"], ["proof (state)\nthis:\n  e t < x\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "with less(1)[OF _ _ INVz, of \"e t\"]"], ["proof (chain)\npicking this:\n  \\<lbrakk>e t < x; e t = e t\\<rbrakk>\n  \\<Longrightarrow> \\<exists>ta p.\n                       (WHILE b DO c, t) \\<Rightarrow> p \\<Down> ta \\<and>\n                       p \\<le> (k + 1) * e t \\<and>\n                       INV l ta \\<and> \\<not> bval b ta\n  e t < x", "obtain t' p' \n        where weff: \"(WHILE b DO c, t) \\<Rightarrow> p' \\<Down> t'\" and cost4: \" p' \\<le> ?k' *  e t\" and INV0: \"INV l t'\"\n            and nb: \"\\<not> bval b t'\""], ["proof (prove)\nusing this:\n  \\<lbrakk>e t < x; e t = e t\\<rbrakk>\n  \\<Longrightarrow> \\<exists>ta p.\n                       (WHILE b DO c, t) \\<Rightarrow> p \\<Down> ta \\<and>\n                       p \\<le> (k + 1) * e t \\<and>\n                       INV l ta \\<and> \\<not> bval b ta\n  e t < x\n\ngoal (1 subgoal):\n 1. (\\<And>p' t'.\n        \\<lbrakk>(WHILE b DO c, t) \\<Rightarrow> p' \\<Down> t';\n         p' \\<le> (k + 1) * e t; INV l t'; \\<not> bval b t'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  (WHILE b DO c, t) \\<Rightarrow> p' \\<Down> t'\n  p' \\<le> (k + 1) * e t\n  INV l t'\n  \\<not> bval b t'\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have \"(WHILE b DO c, s) \\<Rightarrow> 1 + p + p'  \\<Down> t'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (WHILE b DO c, s) \\<Rightarrow> 1 + p + p' \\<Down> t'", "apply(rule WhileTrue)"], ["proof (prove)\ngoal (4 subgoals):\n 1. bval b s\n 2. (c, s) \\<Rightarrow> ?x \\<Down> ?s2.0\n 3. (WHILE b DO c, ?s2.0) \\<Rightarrow> ?y \\<Down> t'\n 4. 1 + ?x + ?y = 1 + p + p'", "apply fact"], ["proof (prove)\ngoal (3 subgoals):\n 1. (c, s) \\<Rightarrow> ?x \\<Down> ?s2.0\n 2. (WHILE b DO c, ?s2.0) \\<Rightarrow> ?y \\<Down> t'\n 3. 1 + ?x + ?y = 1 + p + p'", "apply (fact ceff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (WHILE b DO c, t) \\<Rightarrow> ?y \\<Down> t'\n 2. 1 + p + ?y = 1 + p + p'", "apply (fact weff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + p + p' = 1 + p + p'", "by simp"], ["proof (state)\nthis:\n  (WHILE b DO c, s) \\<Rightarrow> 1 + p + p' \\<Down> t'\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "moreover"], ["proof (state)\nthis:\n  (WHILE b DO c, s) \\<Rightarrow> 1 + p + p' \\<Down> t'\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "note INV0 nb"], ["proof (state)\nthis:\n  INV l t'\n  \\<not> bval b t'\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "moreover"], ["proof (state)\nthis:\n  INV l t'\n  \\<not> bval b t'\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "{"], ["proof (state)\nthis:\n  INV l t'\n  \\<not> bval b t'\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have \"(1 + p + p') \\<le> 1 + k * e'' s + ?k' * e t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + p + p' \\<le> 1 + k * e'' s + (k + 1) * e t", "using cost2 cost4"], ["proof (prove)\nusing this:\n  p \\<le> k * e'' s\n  p' \\<le> (k + 1) * e t\n\ngoal (1 subgoal):\n 1. 1 + p + p' \\<le> 1 + k * e'' s + (k + 1) * e t", "by linarith"], ["proof (state)\nthis:\n  1 + p + p' \\<le> 1 + k * e'' s + (k + 1) * e t\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "also"], ["proof (state)\nthis:\n  1 + p + p' \\<le> 1 + k * e'' s + (k + 1) * e t\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have \"\\<dots> \\<le>  1 + k * e'' s + ?k' * e' s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + k * e'' s + (k + 1) * e t \\<le> 1 + k * e'' s + (k + 1) * e' s", "using cost3"], ["proof (prove)\nusing this:\n  e t \\<le> e' s\n\ngoal (1 subgoal):\n 1. 1 + k * e'' s + (k + 1) * e t \\<le> 1 + k * e'' s + (k + 1) * e' s", "using add_left_mono mult_le_mono2"], ["proof (prove)\nusing this:\n  e t \\<le> e' s\n  ?a \\<le> ?b \\<Longrightarrow> ?c + ?a \\<le> ?c + ?b\n  ?i \\<le> ?j \\<Longrightarrow> ?k * ?i \\<le> ?k * ?j\n\ngoal (1 subgoal):\n 1. 1 + k * e'' s + (k + 1) * e t \\<le> 1 + k * e'' s + (k + 1) * e' s", "by blast"], ["proof (state)\nthis:\n  1 + k * e'' s + (k + 1) * e t \\<le> 1 + k * e'' s + (k + 1) * e' s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "also"], ["proof (state)\nthis:\n  1 + k * e'' s + (k + 1) * e t \\<le> 1 + k * e'' s + (k + 1) * e' s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have \"\\<dots> \\<le> ?k'*1 + ?k'* e'' s + ?k' * e' s \""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + k * e'' s + (k + 1) * e' s\n    \\<le> (k + 1) * 1 + (k + 1) * e'' s + (k + 1) * e' s", "by force"], ["proof (state)\nthis:\n  1 + k * e'' s + (k + 1) * e' s\n  \\<le> (k + 1) * 1 + (k + 1) * e'' s + (k + 1) * e' s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "also"], ["proof (state)\nthis:\n  1 + k * e'' s + (k + 1) * e' s\n  \\<le> (k + 1) * 1 + (k + 1) * e'' s + (k + 1) * e' s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have \"\\<dots> = ?k' * (1+ e' s + e'' s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (k + 1) * 1 + (k + 1) * e'' s + (k + 1) * e' s =\n    (k + 1) * (1 + e' s + e'' s)", "by algebra"], ["proof (state)\nthis:\n  (k + 1) * 1 + (k + 1) * e'' s + (k + 1) * e' s =\n  (k + 1) * (1 + e' s + e'' s)\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "also"], ["proof (state)\nthis:\n  (k + 1) * 1 + (k + 1) * e'' s + (k + 1) * e' s =\n  (k + 1) * (1 + e' s + e'' s)\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "have \"\\<dots> \\<le> ?k' * e s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (k + 1) * (1 + e' s + e'' s) \\<le> (k + 1) * e s", "using cost1"], ["proof (prove)\nusing this:\n  1 + e' s + e'' s \\<le> e s\n\ngoal (1 subgoal):\n 1. (k + 1) * (1 + e' s + e'' s) \\<le> (k + 1) * e s", "using mult_le_mono2"], ["proof (prove)\nusing this:\n  1 + e' s + e'' s \\<le> e s\n  ?i \\<le> ?j \\<Longrightarrow> ?k * ?i \\<le> ?k * ?j\n\ngoal (1 subgoal):\n 1. (k + 1) * (1 + e' s + e'' s) \\<le> (k + 1) * e s", "by blast"], ["proof (state)\nthis:\n  (k + 1) * (1 + e' s + e'' s) \\<le> (k + 1) * e s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "finally"], ["proof (chain)\npicking this:\n  1 + p + p' \\<le> (k + 1) * e s", "have \" (1 + p + p') \\<le> ?k' * e s\""], ["proof (prove)\nusing this:\n  1 + p + p' \\<le> (k + 1) * e s\n\ngoal (1 subgoal):\n 1. 1 + p + p' \\<le> (k + 1) * e s", "."], ["proof (state)\nthis:\n  1 + p + p' \\<le> (k + 1) * e s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "}"], ["proof (state)\nthis:\n  1 + p + p' \\<le> (k + 1) * e s\n\ngoal (1 subgoal):\n 1. bval b s \\<Longrightarrow>\n    \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "ultimately"], ["proof (chain)\npicking this:\n  (WHILE b DO c, s) \\<Rightarrow> 1 + p + p' \\<Down> t'\n  INV l t'\n  \\<not> bval b t'\n  1 + p + p' \\<le> (k + 1) * e s", "show ?thesis"], ["proof (prove)\nusing this:\n  (WHILE b DO c, s) \\<Rightarrow> 1 + p + p' \\<Down> t'\n  INV l t'\n  \\<not> bval b t'\n  1 + p + p' \\<le> (k + 1) * e s\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "by metis"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>t p.\n     (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>e s = n; INV l s\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t p.\n                       (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                       p \\<le> (k + 1) * e s \\<and>\n                       INV l t \\<and> \\<not> bval b t\n\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>e ?s2 = ?n2; INV ?l2 ?s2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t p.\n                       (WHILE b DO c, ?s2) \\<Rightarrow> p \\<Down> t \\<and>\n                       p \\<le> (k + 1) * e ?s2 \\<and>\n                       INV ?l2 t \\<and> \\<not> bval b t\n\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>e ?s2 = ?n2; INV ?l2 ?s2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t p.\n                       (WHILE b DO c, ?s2) \\<Rightarrow> p \\<Down> t \\<and>\n                       p \\<le> (k + 1) * e ?s2 \\<and>\n                       INV ?l2 t \\<and> \\<not> bval b t", "have erg: \"\\<And>l s. INV l s \\<Longrightarrow> \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t\""], ["proof (prove)\nusing this:\n  \\<lbrakk>e ?s2 = ?n2; INV ?l2 ?s2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t p.\n                       (WHILE b DO c, ?s2) \\<Rightarrow> p \\<Down> t \\<and>\n                       p \\<le> (k + 1) * e ?s2 \\<and>\n                       INV ?l2 t \\<and> \\<not> bval b t\n\ngoal (1 subgoal):\n 1. \\<And>l s.\n       INV l s \\<Longrightarrow>\n       \\<exists>t p.\n          (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n          p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t", "by auto"], ["proof (state)\nthis:\n  INV ?l ?s \\<Longrightarrow>\n  \\<exists>t p.\n     (WHILE b DO c, ?s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> (k + 1) * e ?s \\<and> INV ?l t \\<and> \\<not> bval b t\n\ngoal (1 subgoal):\n 1. \\<And>P b e' y c e'' e.\n       \\<lbrakk>\\<turnstile>\\<^sub>1 {\\<lambda>l s.\n   P l s \\<and> bval b s \\<and> e' s = l y}\n                                     c { e'' \\<Down> \\<lambda>l s.\n                  P l s \\<and> e s \\<le> l y};\n        \\<exists>k>0.\n           \\<forall>l s.\n              P l s \\<and> bval b s \\<and> e' s = l y \\<longrightarrow>\n              (\\<exists>t p.\n                  (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n                  p \\<le> k * e'' s \\<and> P l t \\<and> e t \\<le> l y);\n        \\<forall>l s.\n           bval b s \\<and> P l s \\<longrightarrow>\n           1 + e' s + e'' s \\<le> e s;\n        \\<forall>l s.\n           \\<not> bval b s \\<and> P l s \\<longrightarrow> 1 \\<le> e s;\n        y \\<notin> support P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t p.\n                                   (WHILE b DO c,\n                                    s) \\<Rightarrow> p \\<Down> t \\<and>\n                                   p \\<le> k * e s \\<and>\n                                   P l t \\<and> \\<not> bval b t)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          INV l s \\<longrightarrow>\n          (\\<exists>t p.\n              (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n              p \\<le> k * e s \\<and> INV l t \\<and> \\<not> bval b t)", "apply(rule exI[where x=\"?k'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < k + 1 \\<and>\n    (\\<forall>l s.\n        INV l s \\<longrightarrow>\n        (\\<exists>t p.\n            (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t))", "using erg"], ["proof (prove)\nusing this:\n  INV ?l ?s \\<Longrightarrow>\n  \\<exists>t p.\n     (WHILE b DO c, ?s) \\<Rightarrow> p \\<Down> t \\<and>\n     p \\<le> (k + 1) * e ?s \\<and> INV ?l t \\<and> \\<not> bval b t\n\ngoal (1 subgoal):\n 1. 0 < k + 1 \\<and>\n    (\\<forall>l s.\n        INV l s \\<longrightarrow>\n        (\\<exists>t p.\n            (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> (k + 1) * e s \\<and> INV l t \\<and> \\<not> bval b t))", "by fastforce"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        INV l s \\<longrightarrow>\n        (\\<exists>t p.\n            (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and>\n            p \\<le> k * e s \\<and> INV l t \\<and> \\<not> bval b t)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \"Completeness\""], ["", "definition wp1 :: \"com \\<Rightarrow> assn2 \\<Rightarrow> assn2\" (\"wp\\<^sub>1\") where\n\"wp\\<^sub>1 c Q  =  (\\<lambda>l s. \\<exists>t p. (c,s) \\<Rightarrow> p \\<Down> t \\<and> Q l t)\""], ["", "lemma support_wpt: \"support (wp\\<^sub>1 c Q) \\<subseteq> support Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. support (wp\\<^sub>1 c Q) \\<subseteq> support Q", "by(simp add: support_def wp1_def) blast"], ["", "lemma wp1_terminates: \"wp\\<^sub>1 c Q l s \\<Longrightarrow> \\<down> (c, s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 c Q l s \\<Longrightarrow> \\<down> (c, s)", "unfolding wp1_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t \\<Longrightarrow>\n    \\<down> (c, s)", "by auto"], ["", "lemma wp1_SKIP[simp]: \"wp\\<^sub>1 SKIP Q = Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 SKIP Q = Q", "by(auto intro!: ext simp: wp1_def)"], ["", "lemma wp1_Assign[simp]: \"wp\\<^sub>1 (x ::= e) Q = (\\<lambda>l s. Q l (s(x := aval e s)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (x ::= e) Q = (\\<lambda>l s. Q l (s[e/x]))", "by(auto intro!: ext simp: wp1_def)"], ["", "lemma wp1_Seq[simp]: \"wp\\<^sub>1 (c\\<^sub>1;;c\\<^sub>2) Q = wp\\<^sub>1 c\\<^sub>1 (wp\\<^sub>1 c\\<^sub>2 Q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c\\<^sub>1;; c\\<^sub>2) Q =\n    wp\\<^sub>1 c\\<^sub>1 (wp\\<^sub>1 c\\<^sub>2 Q)", "by (auto simp: wp1_def fun_eq_iff)"], ["", "lemma wp1_If[simp]: \"wp\\<^sub>1 (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2) Q = (\\<lambda>l s. wp\\<^sub>1 (if bval b s then c\\<^sub>1 else c\\<^sub>2) Q l s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (IF b THEN c\\<^sub>1 ELSE c\\<^sub>2) Q =\n    (\\<lambda>l s.\n        wp\\<^sub>1 (if bval b s then c\\<^sub>1 else c\\<^sub>2) Q l s)", "by (auto simp: wp1_def fun_eq_iff)"], ["", "definition \"prec c E == %s. E (THE t. (\\<exists>p. (c,s) \\<Rightarrow> p \\<Down> t))\""], ["", "lemma wp1_prec_Seq_correct: \"wp\\<^sub>1 (c1;;c2) Q l s \\<Longrightarrow> \\<down>\\<^sub>t (c1, s) + prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s \\<le> \\<down>\\<^sub>t (c1;; c2, s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "assume \"wp\\<^sub>1 (c1;;c2) Q l s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 (c1;; c2) Q l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "then"], ["proof (chain)\npicking this:\n  wp\\<^sub>1 (c1;; c2) Q l s", "have wp: \"wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q) l s\""], ["proof (prove)\nusing this:\n  wp\\<^sub>1 (c1;; c2) Q l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q) l s", "by simp"], ["proof (state)\nthis:\n  wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q) l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "then"], ["proof (chain)\npicking this:\n  wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q) l s", "obtain t p where c1_term: \"(c1, s) \\<Rightarrow> p \\<Down> t\" and \"(\\<exists>ta p. (c2, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta)\""], ["proof (prove)\nusing this:\n  wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q) l s\n\ngoal (1 subgoal):\n 1. (\\<And>p t.\n        \\<lbrakk>(c1, s) \\<Rightarrow> p \\<Down> t;\n         \\<exists>ta p.\n            (c2, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding wp1_def"], ["proof (prove)\nusing this:\n  \\<exists>t p.\n     (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n     (\\<exists>ta p. (c2, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta)\n\ngoal (1 subgoal):\n 1. (\\<And>p t.\n        \\<lbrakk>(c1, s) \\<Rightarrow> p \\<Down> t;\n         \\<exists>ta p.\n            (c2, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  \\<exists>ta p. (c2, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "then"], ["proof (chain)\npicking this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  \\<exists>ta p. (c2, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta", "obtain t' p' where c2_term: \"(c2, t) \\<Rightarrow> p' \\<Down> t'\" and  \"Q l t'\""], ["proof (prove)\nusing this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  \\<exists>ta p. (c2, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta\n\ngoal (1 subgoal):\n 1. (\\<And>p' t'.\n        \\<lbrakk>(c2, t) \\<Rightarrow> p' \\<Down> t'; Q l t'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c2, t) \\<Rightarrow> p' \\<Down> t'\n  Q l t'\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have p: \"\\<down>\\<^sub>t (c1, s) = p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c1, s) = p", "using c1_term bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  (?c, ?s) \\<Rightarrow> ?t \\<Down> ?s' \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?t\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c1, s) = p", "by simp"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (c1, s) = p\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have \"\\<down>\\<^sub>t (c2, t) = p'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c2, t) = p'", "using c2_term bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (c2, t) \\<Rightarrow> p' \\<Down> t'\n  (?c, ?s) \\<Rightarrow> ?t \\<Down> ?s' \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?t\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c2, t) = p'", "by simp"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (c2, t) = p'\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have f: \"(THE t. \\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t) = t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>s (c1, s) = t", "using c1_term bigstepT_the_state"], ["proof (prove)\nusing this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  (?c, ?s) \\<Rightarrow> ?t \\<Down> ?s' \\<Longrightarrow>\n  \\<down>\\<^sub>s (?c, ?s) = ?s'\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>s (c1, s) = t", "by simp"], ["proof (state)\nthis:\n  \\<down>\\<^sub>s (c1, s) = t\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have \" prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'", "unfolding prec_def f"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c2, t) = p'", "using c2_term bigstep_det"], ["proof (prove)\nusing this:\n  (c2, t) \\<Rightarrow> p' \\<Down> t'\n  \\<lbrakk>(?c1.0, ?s) \\<Rightarrow> ?p1.0 \\<Down> ?t1.0;\n   (?c1.0, ?s) \\<Rightarrow> ?p \\<Down> ?t\\<rbrakk>\n  \\<Longrightarrow> ?p1.0 = ?p \\<and> ?t1.0 = ?t\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c2, t) = p'", "by blast"], ["proof (state)\nthis:\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "then"], ["proof (chain)\npicking this:\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'", "have p': \" prec c1 (\\<lambda>s.  (THE n. \\<exists>a. (c2, s) \\<Rightarrow> n \\<Down> a)) s\n        =  p'\""], ["proof (prove)\nusing this:\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'\n\ngoal (1 subgoal):\n 1. prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'", "unfolding prec_def"], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (c2, \\<down>\\<^sub>s (c1, s)) = p'\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c2, \\<down>\\<^sub>s (c1, s)) = p'", "by blast"], ["proof (state)\nthis:\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "from wp"], ["proof (chain)\npicking this:\n  wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q) l s", "have \"wp\\<^sub>1 (c1;;c2) Q l s\""], ["proof (prove)\nusing this:\n  wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q) l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s", "by simp"], ["proof (state)\nthis:\n  wp\\<^sub>1 (c1;; c2) Q l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "then"], ["proof (chain)\npicking this:\n  wp\\<^sub>1 (c1;; c2) Q l s", "obtain T P where c12_term: \"(c1;;c2, s) \\<Rightarrow> P \\<Down> T\" and \"Q l T\""], ["proof (prove)\nusing this:\n  wp\\<^sub>1 (c1;; c2) Q l s\n\ngoal (1 subgoal):\n 1. (\\<And>P T.\n        \\<lbrakk>(c1;; c2, s) \\<Rightarrow> P \\<Down> T; Q l T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding wp1_def"], ["proof (prove)\nusing this:\n  \\<exists>t p. (c1;; c2, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t\n\ngoal (1 subgoal):\n 1. (\\<And>P T.\n        \\<lbrakk>(c1;; c2, s) \\<Rightarrow> P \\<Down> T; Q l T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c1;; c2, s) \\<Rightarrow> P \\<Down> T\n  Q l T\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have P: \"(THE n. (\\<exists>a. (c1;;c2, s) \\<Rightarrow> n \\<Down> a)) = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c1;; c2, s) = P", "using c12_term bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (c1;; c2, s) \\<Rightarrow> P \\<Down> T\n  (?c, ?s) \\<Rightarrow> ?t \\<Down> ?s' \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?t\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c1;; c2, s) = P", "by simp"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (c1;; c2, s) = P\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "from c12_term"], ["proof (chain)\npicking this:\n  (c1;; c2, s) \\<Rightarrow> P \\<Down> T", "have Ppp': \"P = p + p'\""], ["proof (prove)\nusing this:\n  (c1;; c2, s) \\<Rightarrow> P \\<Down> T\n\ngoal (1 subgoal):\n 1. P = p + p'", "apply(elim Seq_tE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x s2 y.\n       \\<lbrakk>P = x + y; (c1, s) \\<Rightarrow> x \\<Down> s2;\n        (c2, s2) \\<Rightarrow> y \\<Down> T\\<rbrakk>\n       \\<Longrightarrow> P = p + p'", "using c1_term bigstep_det c2_term"], ["proof (prove)\nusing this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n  \\<lbrakk>(?c1.0, ?s) \\<Rightarrow> ?p1.0 \\<Down> ?t1.0;\n   (?c1.0, ?s) \\<Rightarrow> ?p \\<Down> ?t\\<rbrakk>\n  \\<Longrightarrow> ?p1.0 = ?p \\<and> ?t1.0 = ?t\n  (c2, t) \\<Rightarrow> p' \\<Down> t'\n\ngoal (1 subgoal):\n 1. \\<And>x s2 y.\n       \\<lbrakk>P = x + y; (c1, s) \\<Rightarrow> x \\<Down> s2;\n        (c2, s2) \\<Rightarrow> y \\<Down> T\\<rbrakk>\n       \\<Longrightarrow> P = p + p'", "by blast"], ["proof (state)\nthis:\n  P = p + p'\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have \" (THE n. \\<exists>a. (c1, s) \\<Rightarrow> n \\<Down> a) + prec c1 (\\<lambda>s.  (THE n. \\<exists>a. (c2, s) \\<Rightarrow> n \\<Down> a)) s\n        =  p +  p'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s =\n    p + p'", "using p p'"], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (c1, s) = p\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s = p'\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s =\n    p + p'", "by auto"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (c1, s) +\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s =\n  p + p'\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "also"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (c1, s) +\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s =\n  p + p'\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have \"\\<dots> =  P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p + p' = P", "using Ppp'"], ["proof (prove)\nusing this:\n  P = p + p'\n\ngoal (1 subgoal):\n 1. p + p' = P", "by auto"], ["proof (state)\nthis:\n  p + p' = P\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "also"], ["proof (state)\nthis:\n  p + p' = P\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "have \"\\<dots> =  (THE n. (\\<exists>a. (c1;;c2, s) \\<Rightarrow> n \\<Down> a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P = \\<down>\\<^sub>t (c1;; c2, s)", "using P"], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (c1;; c2, s) = P\n\ngoal (1 subgoal):\n 1. P = \\<down>\\<^sub>t (c1;; c2, s)", "by auto"], ["proof (state)\nthis:\n  P = \\<down>\\<^sub>t (c1;; c2, s)\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n    \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "finally"], ["proof (chain)\npicking this:\n  \\<down>\\<^sub>t (c1, s) +\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s =\n  \\<down>\\<^sub>t (c1;; c2, s)", "show \"\\<down>\\<^sub>t (c1, s) + prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s \\<le> \\<down>\\<^sub>t (c1;; c2, s)\""], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (c1, s) +\n  prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s =\n  \\<down>\\<^sub>t (c1;; c2, s)\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c1, s) +\n    prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n    \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "by simp"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (c1, s) + prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n  \\<le> \\<down>\\<^sub>t (c1;; c2, s)\n\ngoal:\nNo subgoals!", "qed"], ["", "abbreviation \"new Q \\<equiv> SOME x. x \\<notin> support Q\""], ["", "lemma bigstep_det: \"(c1, s) \\<Rightarrow> p1 \\<Down> t1 \\<Longrightarrow> (c1, s) \\<Rightarrow> p \\<Down> t \\<Longrightarrow> p1=p \\<and> t1=t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(c1, s) \\<Rightarrow> p1 \\<Down> t1;\n     (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n    \\<Longrightarrow> p1 = p \\<and> t1 = t", "using big_step_t_determ2"], ["proof (prove)\nusing this:\n  \\<lbrakk>(?c, ?s) \\<Rightarrow> ?p \\<Down> ?t;\n   (?c, ?s) \\<Rightarrow> ?q \\<Down> ?u\\<rbrakk>\n  \\<Longrightarrow> ?u = ?t \\<and> ?p = ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(c1, s) \\<Rightarrow> p1 \\<Down> t1;\n     (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n    \\<Longrightarrow> p1 = p \\<and> t1 = t", "by simp"], ["", "lemma bigstepT_the_cost: \"(c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow> (THE n. \\<exists>a. (c, s) \\<Rightarrow> n \\<Down> a) = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow>\n    \\<down>\\<^sub>t (c, s) = P", "using bigstep_det"], ["proof (prove)\nusing this:\n  \\<lbrakk>(?c1.0, ?s) \\<Rightarrow> ?p1.0 \\<Down> ?t1.0;\n   (?c1.0, ?s) \\<Rightarrow> ?p \\<Down> ?t\\<rbrakk>\n  \\<Longrightarrow> ?p1.0 = ?p \\<and> ?t1.0 = ?t\n\ngoal (1 subgoal):\n 1. (c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow>\n    \\<down>\\<^sub>t (c, s) = P", "by blast"], ["", "lemma bigstepT_the_state: \"(c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow> (THE a. \\<exists>n. (c, s) \\<Rightarrow> n \\<Down> a) = T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow>\n    \\<down>\\<^sub>s (c, s) = T", "using bigstep_det"], ["proof (prove)\nusing this:\n  \\<lbrakk>(?c1.0, ?s) \\<Rightarrow> ?p1.0 \\<Down> ?t1.0;\n   (?c1.0, ?s) \\<Rightarrow> ?p \\<Down> ?t\\<rbrakk>\n  \\<Longrightarrow> ?p1.0 = ?p \\<and> ?t1.0 = ?t\n\ngoal (1 subgoal):\n 1. (c, s) \\<Rightarrow> P \\<Down> T \\<Longrightarrow>\n    \\<down>\\<^sub>s (c, s) = T", "by blast"], ["", "lemma assumes b: \"bval b s\"\n  shows wp1WhileTrue': \"wp\\<^sub>1 (WHILE b DO c) Q l s = wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s =\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n 2. wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s", "assume \"wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n 2. wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s", "from this[unfolded wp1_def]"], ["proof (chain)\npicking this:\n  \\<exists>t p.\n     (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     (\\<exists>ta p.\n         (WHILE b DO c, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta)", "obtain t s' t' s'' where \"(c, s) \\<Rightarrow> t \\<Down> s'\" \"(WHILE b DO c, s') \\<Rightarrow> t' \\<Down> s''\" and Q: \"Q l s''\""], ["proof (prove)\nusing this:\n  \\<exists>t p.\n     (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n     (\\<exists>ta p.\n         (WHILE b DO c, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta)\n\ngoal (1 subgoal):\n 1. (\\<And>t s' t' s''.\n        \\<lbrakk>(c, s) \\<Rightarrow> t \\<Down> s';\n         (WHILE b DO c, s') \\<Rightarrow> t' \\<Down> s''; Q l s''\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (c, s) \\<Rightarrow> t \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t' \\<Down> s''\n  Q l s''\n\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n 2. wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s", "with b"], ["proof (chain)\npicking this:\n  bval b s\n  (c, s) \\<Rightarrow> t \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t' \\<Down> s''\n  Q l s''", "have \"(WHILE b DO c, s) \\<Rightarrow> 1+t+t' \\<Down> s''\""], ["proof (prove)\nusing this:\n  bval b s\n  (c, s) \\<Rightarrow> t \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t' \\<Down> s''\n  Q l s''\n\ngoal (1 subgoal):\n 1. (WHILE b DO c, s) \\<Rightarrow> 1 + t + t' \\<Down> s''", "by auto"], ["proof (state)\nthis:\n  (WHILE b DO c, s) \\<Rightarrow> 1 + t + t' \\<Down> s''\n\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n 2. wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s", "with Q"], ["proof (chain)\npicking this:\n  Q l s''\n  (WHILE b DO c, s) \\<Rightarrow> 1 + t + t' \\<Down> s''", "show \"wp\\<^sub>1 (WHILE b DO c) Q l s\""], ["proof (prove)\nusing this:\n  Q l s''\n  (WHILE b DO c, s) \\<Rightarrow> 1 + t + t' \\<Down> s''\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s", "unfolding wp1_def"], ["proof (prove)\nusing this:\n  Q l s''\n  (WHILE b DO c, s) \\<Rightarrow> 1 + t + t' \\<Down> s''\n\ngoal (1 subgoal):\n 1. \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t", "by auto"], ["proof (state)\nthis:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s", "assume \"wp\\<^sub>1 (WHILE b DO c) Q l s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s", "from this[unfolded wp1_def]"], ["proof (chain)\npicking this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t", "obtain t s'' where \"(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\" and Q: \"Q l s''\""], ["proof (prove)\nusing this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t\n\ngoal (1 subgoal):\n 1. (\\<And>t s''.\n        \\<lbrakk>(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'';\n         Q l s''\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s", "with b"], ["proof (chain)\npicking this:\n  bval b s\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''", "obtain t1 t2 s' where \"(c, s) \\<Rightarrow> t1 \\<Down> s'\" \"(WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\""], ["proof (prove)\nusing this:\n  bval b s\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''\n\ngoal (1 subgoal):\n 1. (\\<And>t1 s' t2.\n        \\<lbrakk>(c, s) \\<Rightarrow> t1 \\<Down> s';\n         (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  (c, s) \\<Rightarrow> t1 \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow>\n    wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s", "with Q"], ["proof (chain)\npicking this:\n  Q l s''\n  (c, s) \\<Rightarrow> t1 \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''", "show \"wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s \""], ["proof (prove)\nusing this:\n  Q l s''\n  (c, s) \\<Rightarrow> t1 \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s", "unfolding wp1_def"], ["proof (prove)\nusing this:\n  Q l s''\n  (c, s) \\<Rightarrow> t1 \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\n\ngoal (1 subgoal):\n 1. \\<exists>t p.\n       (c, s) \\<Rightarrow> p \\<Down> t \\<and>\n       (\\<exists>ta p.\n           (WHILE b DO c, t) \\<Rightarrow> p \\<Down> ta \\<and> Q l ta)", "by auto"], ["proof (state)\nthis:\n  wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma assumes b: \"~ bval b s\"\n  shows wp1WhileFalse': \"wp\\<^sub>1 (WHILE b DO c) Q l s =  Q l s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s = Q l s", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow> Q l s\n 2. Q l s \\<Longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s", "assume \"wp\\<^sub>1 (WHILE b DO c) Q l s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow> Q l s\n 2. Q l s \\<Longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s", "from this[unfolded wp1_def]"], ["proof (chain)\npicking this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t", "obtain t s' where \"(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\" and Q: \"Q l s'\""], ["proof (prove)\nusing this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t\n\ngoal (1 subgoal):\n 1. (\\<And>t s'.\n        \\<lbrakk>(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s';\n         Q l s'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  Q l s'\n\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow> Q l s\n 2. Q l s \\<Longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s", "with b"], ["proof (chain)\npicking this:\n  \\<not> bval b s\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  Q l s'", "have \"s=s'\""], ["proof (prove)\nusing this:\n  \\<not> bval b s\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  Q l s'\n\ngoal (1 subgoal):\n 1. s = s'", "by auto"], ["proof (state)\nthis:\n  s = s'\n\ngoal (2 subgoals):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s \\<Longrightarrow> Q l s\n 2. Q l s \\<Longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s", "with Q"], ["proof (chain)\npicking this:\n  Q l s'\n  s = s'", "show \"Q l s\""], ["proof (prove)\nusing this:\n  Q l s'\n  s = s'\n\ngoal (1 subgoal):\n 1. Q l s", "by auto"], ["proof (state)\nthis:\n  Q l s\n\ngoal (1 subgoal):\n 1. Q l s \\<Longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. Q l s \\<Longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s", "assume \"Q l s\""], ["proof (state)\nthis:\n  Q l s\n\ngoal (1 subgoal):\n 1. Q l s \\<Longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s", "with b"], ["proof (chain)\npicking this:\n  \\<not> bval b s\n  Q l s", "show  \"wp\\<^sub>1 (WHILE b DO c) Q l s\""], ["proof (prove)\nusing this:\n  \\<not> bval b s\n  Q l s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s", "unfolding wp1_def"], ["proof (prove)\nusing this:\n  \\<not> bval b s\n  Q l s\n\ngoal (1 subgoal):\n 1. \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t", "by auto"], ["proof (state)\nthis:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wp1While: \"wp\\<^sub>1 (WHILE b DO c) Q l s = (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s else Q l s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp\\<^sub>1 (WHILE b DO c) Q l s =\n    (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n     else Q l s)", "apply(cases \"bval b s\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s =\n    (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n     else Q l s)\n 2. \\<not> bval b s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s =\n    (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n     else Q l s)", "using wp1WhileTrue'"], ["proof (prove)\nusing this:\n  bval ?b ?s \\<Longrightarrow>\n  wp\\<^sub>1 (WHILE ?b DO ?c) ?Q ?l ?s =\n  wp\\<^sub>1 ?c (wp\\<^sub>1 (WHILE ?b DO ?c) ?Q) ?l ?s\n\ngoal (2 subgoals):\n 1. bval b s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s =\n    (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n     else Q l s)\n 2. \\<not> bval b s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s =\n    (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n     else Q l s)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s =\n    (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n     else Q l s)", "using wp1WhileFalse'"], ["proof (prove)\nusing this:\n  \\<not> bval ?b ?s \\<Longrightarrow>\n  wp\\<^sub>1 (WHILE ?b DO ?c) ?Q ?l ?s = ?Q ?l ?s\n\ngoal (1 subgoal):\n 1. \\<not> bval b s \\<Longrightarrow>\n    wp\\<^sub>1 (WHILE b DO c) Q l s =\n    (if bval b s then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n     else Q l s)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma wp1_prec2: fixes e::tbd\n    shows \"(wp\\<^sub>1 c1 Q l s \\<and>\n           l x = prec c1 e s) = wp\\<^sub>1 c1 (\\<lambda>l s. Q l s \\<and> e s = l x) l s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wp\\<^sub>1 c1 Q l s \\<and> l x = prec c1 e s) =\n    wp\\<^sub>1 c1 (\\<lambda>l s. Q l s \\<and> e s = l x) l s", "by (metis (mono_tags, lifting) Big_StepT.bigstepT_the_state prec_def wp1_def)"], ["", "lemma wp1_prec: fixes e::tbd\n    shows \"wp\\<^sub>1 c1 Q l s \\<Longrightarrow>\n           l x = prec c1 e s \\<Longrightarrow> wp\\<^sub>1 c1 (\\<lambda>l s. Q l s \\<and> e s = l x) l s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>wp\\<^sub>1 c1 Q l s; l x = prec c1 e s\\<rbrakk>\n    \\<Longrightarrow> wp\\<^sub>1 c1 (\\<lambda>l s. Q l s \\<and> e s = l x) l\n                       s", "unfolding wp1_def prec_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<exists>t p. (c1, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t;\n     l x = e (\\<down>\\<^sub>s (c1, s))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>t p.\n                         (c1, s) \\<Rightarrow> p \\<Down> t \\<and>\n                         Q l t \\<and> e t = l x", "apply(auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t p.\n       \\<lbrakk>l x = e (\\<down>\\<^sub>s (c1, s)); Q l t;\n        (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            (\\<exists>p.\n                                (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                            Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t p.\n       \\<lbrakk>l x = e (\\<down>\\<^sub>s (c1, s)); Q l t;\n        (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            (\\<exists>p.\n                                (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                            Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "fix p t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t p.\n       \\<lbrakk>l x = e (\\<down>\\<^sub>s (c1, s)); Q l t;\n        (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            (\\<exists>p.\n                                (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                            Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "assume \"l x = e (THE t. \\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t)\""], ["proof (state)\nthis:\n  l x = e (\\<down>\\<^sub>s (c1, s))\n\ngoal (1 subgoal):\n 1. \\<And>t p.\n       \\<lbrakk>l x = e (\\<down>\\<^sub>s (c1, s)); Q l t;\n        (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            (\\<exists>p.\n                                (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                            Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "assume 2: \"Q l t\""], ["proof (state)\nthis:\n  Q l t\n\ngoal (1 subgoal):\n 1. \\<And>t p.\n       \\<lbrakk>l x = e (\\<down>\\<^sub>s (c1, s)); Q l t;\n        (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            (\\<exists>p.\n                                (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                            Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "assume 1: \"(c1, s) \\<Rightarrow> p \\<Down> t \""], ["proof (state)\nthis:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n\ngoal (1 subgoal):\n 1. \\<And>t p.\n       \\<lbrakk>l x = e (\\<down>\\<^sub>s (c1, s)); Q l t;\n        (c1, s) \\<Rightarrow> p \\<Down> t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            (\\<exists>p.\n                                (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                            Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "show \"\\<exists>t. (\\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t) \\<and> Q l t \\<and> e t = e (THE t. \\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t) \""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t.\n       (\\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n       Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "apply(rule exI[where x=t])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n    Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))", "apply(safe)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t\n 2. Q l t\n 3. e t = e (\\<down>\\<^sub>s (c1, s))", "apply(rule exI[where x=p])"], ["proof (prove)\ngoal (3 subgoals):\n 1. (c1, s) \\<Rightarrow> p \\<Down> t\n 2. Q l t\n 3. e t = e (\\<down>\\<^sub>s (c1, s))", "using 1"], ["proof (prove)\nusing this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n\ngoal (3 subgoals):\n 1. (c1, s) \\<Rightarrow> p \\<Down> t\n 2. Q l t\n 3. e t = e (\\<down>\\<^sub>s (c1, s))", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. Q l t\n 2. e t = e (\\<down>\\<^sub>s (c1, s))", "apply(fact)"], ["proof (prove)\ngoal (1 subgoal):\n 1. e t = e (\\<down>\\<^sub>s (c1, s))", "using 1"], ["proof (prove)\nusing this:\n  (c1, s) \\<Rightarrow> p \\<Down> t\n\ngoal (1 subgoal):\n 1. e t = e (\\<down>\\<^sub>s (c1, s))", "by(simp add: bigstepT_the_state)"], ["proof (state)\nthis:\n  \\<exists>t.\n     (\\<exists>p. (c1, s) \\<Rightarrow> p \\<Down> t) \\<and>\n     Q l t \\<and> e t = e (\\<down>\\<^sub>s (c1, s))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wp1_is_pre: \"finite (support Q) \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (support Q) \\<Longrightarrow>\n    \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n                         { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q}", "proof (induction c arbitrary: Q)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 SKIP Q} SKIP\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (SKIP, s) \\<Down> Q}\n 2. \\<And>x1 x2 Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1 ::= x2) Q} x1 ::= x2\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (x1 ::= x2, s) \\<Down> Q}\n 3. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 4. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 5. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "case SKIP"], ["proof (state)\nthis:\n  finite (support Q)\n\ngoal (5 subgoals):\n 1. \\<And>Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 SKIP Q} SKIP\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (SKIP, s) \\<Down> Q}\n 2. \\<And>x1 x2 Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1 ::= x2) Q} x1 ::= x2\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (x1 ::= x2, s) \\<Down> Q}\n 3. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 4. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 5. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "have ff: \"\\<And>s n. (\\<exists>a. (SKIP, s) \\<Rightarrow> n \\<Down> a) = (n=Suc 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s n.\n       (\\<exists>a. (SKIP, s) \\<Rightarrow> n \\<Down> a) = (n = Suc 0)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>a. (SKIP, ?s) \\<Rightarrow> ?n \\<Down> a) = (?n = Suc 0)\n\ngoal (5 subgoals):\n 1. \\<And>Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 SKIP Q} SKIP\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (SKIP, s) \\<Down> Q}\n 2. \\<And>x1 x2 Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1 ::= x2) Q} x1 ::= x2\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (x1 ::= x2, s) \\<Down> Q}\n 3. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 4. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 5. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {wp\\<^sub>1 SKIP Q} SKIP\n                         { \\<lambda>s. \\<down>\\<^sub>t (SKIP, s) \\<Down> Q}", "apply (auto intro:hoare1.Skip simp add: ff)"], ["proof (prove)\ngoal:\nNo subgoals!", "using ff"], ["proof (prove)\nusing this:\n  (\\<exists>a. (SKIP, ?s) \\<Rightarrow> ?n \\<Down> a) = (?n = Suc 0)\n\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 SKIP Q} SKIP\n                       { \\<lambda>s. \\<down>\\<^sub>t (SKIP, s) \\<Down> Q}\n\ngoal (4 subgoals):\n 1. \\<And>x1 x2 Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1 ::= x2) Q} x1 ::= x2\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (x1 ::= x2, s) \\<Down> Q}\n 2. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 3. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 4. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x1 x2 Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1 ::= x2) Q} x1 ::= x2\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (x1 ::= x2, s) \\<Down> Q}\n 2. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 3. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 4. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "have gg: \"\\<And>x1 x2 s n. (\\<exists>a. (x1 ::= x2, s) \\<Rightarrow> n \\<Down> a) = (n=Suc 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x1 x2 s n.\n       (\\<exists>a. (x1 ::= x2, s) \\<Rightarrow> n \\<Down> a) = (n = Suc 0)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>a. (?x1.0 ::= ?x2.0, ?s) \\<Rightarrow> ?n \\<Down> a) =\n  (?n = Suc 0)\n\ngoal (4 subgoals):\n 1. \\<And>x1 x2 Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1 ::= x2) Q} x1 ::= x2\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (x1 ::= x2, s) \\<Down> Q}\n 2. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 3. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 4. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "case Assign"], ["proof (state)\nthis:\n  finite (support Q)\n\ngoal (4 subgoals):\n 1. \\<And>x1 x2 Q.\n       finite (support Q) \\<Longrightarrow>\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1 ::= x2) Q} x1 ::= x2\n                            { \\<lambda>s.\n                                 \\<down>\\<^sub>t (x1 ::= x2, s) \\<Down> Q}\n 2. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 3. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 4. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1_ ::= x2_) Q} x1_ ::= x2_\n                         { \\<lambda>s.\n                              \\<down>\\<^sub>t (x1_ ::= x2_, s) \\<Down> Q}", "apply (auto intro:hoare1.Assign simp add: gg)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (x1_ ::= x2_) Q} x1_ ::= x2_\n                       { \\<lambda>s.\n                            \\<down>\\<^sub>t (x1_ ::= x2_, s) \\<Down> Q}\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "case (Seq c1 c2)  \n  \\<comment> \\<open>choose a fresh logical variable x\\<close>"], ["proof (state)\nthis:\n  finite (support ?Q) \\<Longrightarrow>\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 ?Q} c1\n                       { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> ?Q}\n  finite (support ?Q) \\<Longrightarrow>\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 ?Q} c2\n                       { \\<lambda>s. \\<down>\\<^sub>t (c2, s) \\<Down> ?Q}\n  finite (support Q)\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "let ?x = \"new Q\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "have \"\\<exists>x. x \\<notin> support Q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x. x \\<notin> support Q", "using Seq.prems infinite_UNIV_listI"], ["proof (prove)\nusing this:\n  finite (support Q)\n  infinite UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>x. x \\<notin> support Q", "using ex_new_if_finite"], ["proof (prove)\nusing this:\n  finite (support Q)\n  infinite UNIV\n  \\<lbrakk>infinite UNIV; finite ?A\\<rbrakk>\n  \\<Longrightarrow> \\<exists>a. a \\<notin> ?A\n\ngoal (1 subgoal):\n 1. \\<exists>x. x \\<notin> support Q", "by blast"], ["proof (state)\nthis:\n  \\<exists>x. x \\<notin> support Q\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "hence  \"?x \\<notin> support Q\""], ["proof (prove)\nusing this:\n  \\<exists>x. x \\<notin> support Q\n\ngoal (1 subgoal):\n 1. new Q \\<notin> support Q", "by (rule someI_ex)"], ["proof (state)\nthis:\n  new Q \\<notin> support Q\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "then"], ["proof (chain)\npicking this:\n  new Q \\<notin> support Q", "have x2: \"?x \\<notin> support (wp\\<^sub>1 c2 Q)\""], ["proof (prove)\nusing this:\n  new Q \\<notin> support Q\n\ngoal (1 subgoal):\n 1. new Q \\<notin> support (wp\\<^sub>1 c2 Q)", "using support_wpt"], ["proof (prove)\nusing this:\n  new Q \\<notin> support Q\n  support (wp\\<^sub>1 ?c ?Q) \\<subseteq> support ?Q\n\ngoal (1 subgoal):\n 1. new Q \\<notin> support (wp\\<^sub>1 c2 Q)", "by (fast)"], ["proof (state)\nthis:\n  new Q \\<notin> support (wp\\<^sub>1 c2 Q)\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "then"], ["proof (chain)\npicking this:\n  new Q \\<notin> support (wp\\<^sub>1 c2 Q)", "have x12: \"?x \\<notin> support (wp\\<^sub>1 (c1;;c2) Q)\""], ["proof (prove)\nusing this:\n  new Q \\<notin> support (wp\\<^sub>1 c2 Q)\n\ngoal (1 subgoal):\n 1. new Q \\<notin> support (wp\\<^sub>1 (c1;; c2) Q)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. new Q \\<notin> support (wp\\<^sub>1 c2 Q) \\<Longrightarrow>\n    new Q \\<notin> support (wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q))", "using support_wpt"], ["proof (prove)\nusing this:\n  support (wp\\<^sub>1 ?c ?Q) \\<subseteq> support ?Q\n\ngoal (1 subgoal):\n 1. new Q \\<notin> support (wp\\<^sub>1 c2 Q) \\<Longrightarrow>\n    new Q \\<notin> support (wp\\<^sub>1 c1 (wp\\<^sub>1 c2 Q))", "by fast\n\n  \\<comment> \\<open>assemble a postcondition Q1 that ensures the weakest precondition of Q before c2\n        and saves the running time of c2 into the logical variable x\\<close>"], ["proof (state)\nthis:\n  new Q \\<notin> support (wp\\<^sub>1 (c1;; c2) Q)\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "let ?Q1 = \"(\\<lambda>l s. (wp\\<^sub>1 c2 Q) l s \\<and>  \\<down>\\<^sub>t (c2, s) = l ?x)\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "have \"finite (support ?Q1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     (support\n       (\\<lambda>l s.\n           wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) = l (new Q)))", "apply(rule rev_finite_subset[OF _ support_and])"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     (support (wp\\<^sub>1 c2 Q) \\<union>\n      support (\\<lambda>l s. \\<down>\\<^sub>t (c2, s) = l (new Q)))", "apply(rule finite_UnI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite (support (wp\\<^sub>1 c2 Q))\n 2. finite (support (\\<lambda>l s. \\<down>\\<^sub>t (c2, s) = l (new Q)))", "apply(rule rev_finite_subset[OF _ support_wpt])"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite (support Q)\n 2. finite (support (\\<lambda>l s. \\<down>\\<^sub>t (c2, s) = l (new Q)))", "apply(fact)"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (support (\\<lambda>l s. \\<down>\\<^sub>t (c2, s) = l (new Q)))", "apply(rule rev_finite_subset[OF _ support_single])"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {new Q}", "by simp\n  \\<comment> \\<open>we can now specify this Q1 in the first Induction Hypothesis\\<close>"], ["proof (state)\nthis:\n  finite\n   (support\n     (\\<lambda>l s.\n         wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) = l (new Q)))\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "then"], ["proof (chain)\npicking this:\n  finite\n   (support\n     (\\<lambda>l s.\n         wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) = l (new Q)))", "have pre: \"\\<And>u. \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 ?Q1 } c1 { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down>  ?Q1  }\""], ["proof (prove)\nusing this:\n  finite\n   (support\n     (\\<lambda>l s.\n         wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) = l (new Q)))\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1\n                              (\\<lambda>l s.\n                                  wp\\<^sub>1 c2 Q l s \\<and>\n                                  \\<down>\\<^sub>t (c2, s) = l (new Q))}\n                            c1 { \\<lambda>s.\n                                    \\<down>\\<^sub>t\n                                     (c1,\ns) \\<Down> \\<lambda>l s.\n              wp\\<^sub>1 c2 Q l s \\<and>\n              \\<down>\\<^sub>t (c2, s) = l (new Q)}", "using Seq(1)"], ["proof (prove)\nusing this:\n  finite\n   (support\n     (\\<lambda>l s.\n         wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) = l (new Q)))\n  finite (support ?Q) \\<Longrightarrow>\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 ?Q} c1\n                       { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> ?Q}\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1\n                              (\\<lambda>l s.\n                                  wp\\<^sub>1 c2 Q l s \\<and>\n                                  \\<down>\\<^sub>t (c2, s) = l (new Q))}\n                            c1 { \\<lambda>s.\n                                    \\<down>\\<^sub>t\n                                     (c1,\ns) \\<Down> \\<lambda>l s.\n              wp\\<^sub>1 c2 Q l s \\<and>\n              \\<down>\\<^sub>t (c2, s) = l (new Q)}", "by simp  \n\n  \\<comment> \\<open>we can rewrite this into the form we need for the Seq rule\\<close>"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1\n                         (\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and>\n                             \\<down>\\<^sub>t (c2, s) = l (new Q))}\n                       c1 { \\<lambda>s.\n                               \\<down>\\<^sub>t\n                                (c1,\n                                 s) \\<Down> \\<lambda>l s.\n         wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) = l (new Q)}\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "have A: \" \\<turnstile>\\<^sub>1 {\\<lambda>l s. wp\\<^sub>1 (c1;;c2) Q l s \\<and> l ?x = (prec c1 (%s. \\<down>\\<^sub>t (c2, s))) s} c1 { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> \\<lambda>l s. wp\\<^sub>1 c2 Q l s \\<and>  \\<down>\\<^sub>t (c2, s) \\<le> l ?x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (c1;; c2) Q l s \\<and>\n                             l (new Q) =\n                             prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s))\n                              s}\n                         c1 { \\<lambda>s.\n                                 \\<down>\\<^sub>t\n                                  (c1,\n                                   s) \\<Down> \\<lambda>l s.\n           wp\\<^sub>1 c2 Q l s \\<and>\n           \\<down>\\<^sub>t (c2, s) \\<le> l (new Q)}", "apply(rule conseq_old[OF _ pre ])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 (c1;; c2) Q l s \\<and>\n          l (new Q) =\n          prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s \\<longrightarrow>\n          wp\\<^sub>1 c1\n           (\\<lambda>l s.\n               wp\\<^sub>1 c2 Q l s \\<and>\n               \\<down>\\<^sub>t (c2, s) = l (new Q))\n           l s \\<and>\n          \\<down>\\<^sub>t (c1, s) \\<le> k * \\<down>\\<^sub>t (c1, s)\n 2. \\<forall>l s.\n       wp\\<^sub>1 c2 Q l s \\<and>\n       \\<down>\\<^sub>t (c2, s) = l (new Q) \\<longrightarrow>\n       wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) \\<le> l (new Q)", "by(auto simp add: wp1_prec) \n\n  \\<comment> \\<open>we can now apply the Seq rule with the first IH (in the right shape A) and the second IH\\<close>"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                           wp\\<^sub>1 (c1;; c2) Q l s \\<and>\n                           l (new Q) =\n                           prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s}\n                       c1 { \\<lambda>s.\n                               \\<down>\\<^sub>t\n                                (c1,\n                                 s) \\<Down> \\<lambda>l s.\n         wp\\<^sub>1 c2 Q l s \\<and> \\<down>\\<^sub>t (c2, s) \\<le> l (new Q)}\n\ngoal (3 subgoals):\n 1. \\<And>c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q}\n        c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n 2. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 3. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "show \"\\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q} c1;; c2 { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q} c1;; c2\n                         { \\<lambda>s.\n                              \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}", "apply(rule hoare1.Seq[OF A Seq(2)])  \n       \\<comment> \\<open>finally some side conditions have to be proven\\<close>"], ["proof (prove)\ngoal (4 subgoals):\n 1. finite (support Q)\n 2. new Q \\<notin> support (wp\\<^sub>1 (c1;; c2) Q)\n 3. new Q \\<notin> support (wp\\<^sub>1 c2 Q)\n 4. \\<And>l s.\n       wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n       \\<down>\\<^sub>t (c1, s) +\n       prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n       \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "using Seq(3) x12 x2 wp1_prec_Seq_correct"], ["proof (prove)\nusing this:\n  finite (support Q)\n  new Q \\<notin> support (wp\\<^sub>1 (c1;; c2) Q)\n  new Q \\<notin> support (wp\\<^sub>1 c2 Q)\n  wp\\<^sub>1 (?c1.0;; ?c2.0) ?Q ?l ?s \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c1.0, ?s) +\n  prec ?c1.0 (\\<lambda>s. \\<down>\\<^sub>t (?c2.0, s)) ?s\n  \\<le> \\<down>\\<^sub>t (?c1.0;; ?c2.0, ?s)\n\ngoal (4 subgoals):\n 1. finite (support Q)\n 2. new Q \\<notin> support (wp\\<^sub>1 (c1;; c2) Q)\n 3. new Q \\<notin> support (wp\\<^sub>1 c2 Q)\n 4. \\<And>l s.\n       wp\\<^sub>1 (c1;; c2) Q l s \\<Longrightarrow>\n       \\<down>\\<^sub>t (c1, s) +\n       prec c1 (\\<lambda>s. \\<down>\\<^sub>t (c2, s)) s\n       \\<le> \\<down>\\<^sub>t (c1;; c2, s)", "."], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (c1;; c2) Q} c1;; c2\n                       { \\<lambda>s. \\<down>\\<^sub>t (c1;; c2, s) \\<Down> Q}\n\ngoal (2 subgoals):\n 1. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 2. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 2. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "case (If b c1 c2)"], ["proof (state)\nthis:\n  finite (support ?Q) \\<Longrightarrow>\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 ?Q} c1\n                       { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> ?Q}\n  finite (support ?Q) \\<Longrightarrow>\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 ?Q} c2\n                       { \\<lambda>s. \\<down>\\<^sub>t (c2, s) \\<Down> ?Q}\n  finite (support Q)\n\ngoal (2 subgoals):\n 1. \\<And>x1 c1 c2 Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c1 Q} c1\n  { \\<lambda>s. \\<down>\\<^sub>t (c1, s) \\<Down> Q};\n        \\<And>Q.\n           finite (support Q) \\<Longrightarrow>\n           \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c2 Q} c2\n                                { \\<lambda>s.\n                                     \\<down>\\<^sub>t (c2, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1\n          (IF x1 THEN c1 ELSE c2) Q}\n        IF x1 THEN c1 ELSE c2\n        { \\<lambda>s. \\<down>\\<^sub>t (IF x1 THEN c1 ELSE c2, s) \\<Down> Q}\n 2. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (IF b THEN c1 ELSE c2) Q}\n                         IF b THEN c1 ELSE c2\n                         { \\<lambda>s.\n                              \\<down>\\<^sub>t\n                               (IF b THEN c1 ELSE c2, s) \\<Down> Q}", "apply(simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>x xa.\n                             (bval b xa \\<longrightarrow>\n                              wp\\<^sub>1 c1 Q x xa) \\<and>\n                             (\\<not> bval b xa \\<longrightarrow>\n                              wp\\<^sub>1 c2 Q x xa)}\n                         IF b THEN c1 ELSE c2\n                         { \\<lambda>s.\n                              \\<down>\\<^sub>t\n                               (IF b THEN c1 ELSE c2, s) \\<Down> Q}", "apply(rule If2[where e=\"%s. if bval b s then \\<down>\\<^sub>t (c1, s) else \\<down>\\<^sub>t (c2, s)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             ((bval b s \\<longrightarrow>\n                               wp\\<^sub>1 c1 Q l s) \\<and>\n                              (\\<not> bval b s \\<longrightarrow>\n                               wp\\<^sub>1 c2 Q l s)) \\<and>\n                             bval b s}\n                         c1 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 2. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             ((bval b s \\<longrightarrow>\n                               wp\\<^sub>1 c1 Q l s) \\<and>\n                              (\\<not> bval b s \\<longrightarrow>\n                               wp\\<^sub>1 c2 Q l s)) \\<and>\n                             \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 3. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (if bval b s then \\<down>\\<^sub>t (c1, s)\n        else \\<down>\\<^sub>t (c2, s)) +\n       1 =\n       \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)", "apply(simp_all  cong:rev_conj_cong)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s. wp\\<^sub>1 c1 Q l s \\<and> bval b s}\n                         c1 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 2. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 3. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(rule conseq_old[where Q=Q and Q'=Q])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c1 Q l s \\<and> bval b s \\<longrightarrow>\n          ?P14 l s \\<and>\n          ?e'14 s\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 2. \\<turnstile>\\<^sub>1 {?P14} c1 { ?e'14 \\<Down> Q}\n 3. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 4. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 5. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "prefer 2"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<turnstile>\\<^sub>1 {?P14} c1 { ?e'14 \\<Down> Q}\n 2. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c1 Q l s \\<and> bval b s \\<longrightarrow>\n          ?P14 l s \\<and>\n          ?e'14 s\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 3. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 4. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 5. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(rule If.IH(1))"], ["proof (prove)\ngoal (5 subgoals):\n 1. finite (support Q)\n 2. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c1 Q l s \\<and> bval b s \\<longrightarrow>\n          wp\\<^sub>1 c1 Q l s \\<and>\n          \\<down>\\<^sub>t (c1, s)\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 3. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 4. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 5. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(fact)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c1 Q l s \\<and> bval b s \\<longrightarrow>\n          wp\\<^sub>1 c1 Q l s \\<and>\n          \\<down>\\<^sub>t (c1, s)\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 2. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 3. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 4. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(simp_all)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c1 Q l s \\<and> bval b s \\<longrightarrow>\n          0 < \\<down>\\<^sub>t (c1, s) \\<longrightarrow> Suc 0 \\<le> k\n 2. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 3. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(auto)[1]"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s}\n                         c2 { \\<lambda>s.\n                                 if bval b s then \\<down>\\<^sub>t (c1, s)\n                                 else \\<down>\\<^sub>t (c2, s) \\<Down> Q}\n 2. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(rule conseq_old[where Q=Q and Q'=Q])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s \\<longrightarrow>\n          ?P36 l s \\<and>\n          ?e'36 s\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 2. \\<turnstile>\\<^sub>1 {?P36} c2 { ?e'36 \\<Down> Q}\n 3. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 4. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "prefer 2"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {?P36} c2 { ?e'36 \\<Down> Q}\n 2. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s \\<longrightarrow>\n          ?P36 l s \\<and>\n          ?e'36 s\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 3. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 4. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(rule If.IH(2))"], ["proof (prove)\ngoal (4 subgoals):\n 1. finite (support Q)\n 2. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s \\<longrightarrow>\n          wp\\<^sub>1 c2 Q l s \\<and>\n          \\<down>\\<^sub>t (c2, s)\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 3. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 4. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(fact)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s \\<longrightarrow>\n          wp\\<^sub>1 c2 Q l s \\<and>\n          \\<down>\\<^sub>t (c2, s)\n          \\<le> k *\n                (if bval b s then \\<down>\\<^sub>t (c1, s)\n                 else \\<down>\\<^sub>t (c2, s))\n 2. \\<forall>l s. Q l s \\<longrightarrow> Q l s\n 3. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(simp_all)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 c2 Q l s \\<and> \\<not> bval b s \\<longrightarrow>\n          0 < \\<down>\\<^sub>t (c2, s) \\<longrightarrow> Suc 0 \\<le> k\n 2. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply(auto)[1]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l s.\n       (bval b s \\<longrightarrow> wp\\<^sub>1 c1 Q l s) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        wp\\<^sub>1 c2 Q l s) \\<Longrightarrow>\n       (bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c1, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s)) \\<and>\n       (\\<not> bval b s \\<longrightarrow>\n        Suc (\\<down>\\<^sub>t (c2, s)) =\n        \\<down>\\<^sub>t (IF b THEN c1 ELSE c2, s))", "apply (blast intro: If_THE_True wp1_terminates If_THE_False)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (IF b THEN c1 ELSE c2) Q}\n                       IF b THEN c1 ELSE c2\n                       { \\<lambda>s.\n                            \\<down>\\<^sub>t\n                             (IF b THEN c1 ELSE c2, s) \\<Down> Q}\n\ngoal (1 subgoal):\n 1. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "case (While b c)"], ["proof (state)\nthis:\n  finite (support ?Q) \\<Longrightarrow>\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c ?Q} c\n                       { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> ?Q}\n  finite (support Q)\n\ngoal (1 subgoal):\n 1. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "let ?y = \"(new (wp\\<^sub>1 (WHILE b DO c) Q))\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "have \"finite (support (wp\\<^sub>1 (WHILE b DO c) Q))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (support (wp\\<^sub>1 (WHILE b DO c) Q))", "apply(rule finite_subset[OF support_wpt])"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (support Q)", "apply fact"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  finite (support (wp\\<^sub>1 (WHILE b DO c) Q))\n\ngoal (1 subgoal):\n 1. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "then"], ["proof (chain)\npicking this:\n  finite (support (wp\\<^sub>1 (WHILE b DO c) Q))", "have \"\\<exists>x. x \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)\""], ["proof (prove)\nusing this:\n  finite (support (wp\\<^sub>1 (WHILE b DO c) Q))\n\ngoal (1 subgoal):\n 1. \\<exists>x. x \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)", "using infinite_UNIV_listI"], ["proof (prove)\nusing this:\n  finite (support (wp\\<^sub>1 (WHILE b DO c) Q))\n  infinite UNIV\n\ngoal (1 subgoal):\n 1. \\<exists>x. x \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)", "using ex_new_if_finite"], ["proof (prove)\nusing this:\n  finite (support (wp\\<^sub>1 (WHILE b DO c) Q))\n  infinite UNIV\n  \\<lbrakk>infinite UNIV; finite ?A\\<rbrakk>\n  \\<Longrightarrow> \\<exists>a. a \\<notin> ?A\n\ngoal (1 subgoal):\n 1. \\<exists>x. x \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)", "by blast"], ["proof (state)\nthis:\n  \\<exists>x. x \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)\n\ngoal (1 subgoal):\n 1. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "hence yQx: \"?y \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)\""], ["proof (prove)\nusing this:\n  \\<exists>x. x \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)\n\ngoal (1 subgoal):\n 1. new (wp\\<^sub>1 (WHILE b DO c) Q)\n    \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)", "by (rule someI_ex)"], ["proof (state)\nthis:\n  new (wp\\<^sub>1 (WHILE b DO c) Q)\n  \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)\n\ngoal (1 subgoal):\n 1. \\<And>x1 c Q.\n       \\<lbrakk>\\<And>Q.\n                   finite (support Q) \\<Longrightarrow>\n                   \\<turnstile>\\<^sub>1 {wp\\<^sub>1 c Q} c\n  { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> Q};\n        finite (support Q)\\<rbrakk>\n       \\<Longrightarrow> \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE x1 DO c) Q}\n        WHILE x1 DO c\n        { \\<lambda>s. \\<down>\\<^sub>t (WHILE x1 DO c, s) \\<Down> Q}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE b DO c) Q} WHILE b DO c\n                         { \\<lambda>s.\n                              \\<down>\\<^sub>t (WHILE b DO c, s) \\<Down> Q}", "proof (rule conseq_old[OF _  hoare1.While], safe )"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 (WHILE b DO c) Q l s \\<longrightarrow>\n          ?P l s \\<and> ?e' s \\<le> k * \\<down>\\<^sub>t (WHILE b DO c, s)\n 2. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             ?P l s \\<and> bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        ?P l s \\<and> ?e' s \\<le> l ?y1}\n 3. \\<And>l s.\n       \\<lbrakk>bval b s; ?P l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s \\<le> ?e' s\n 4. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; ?P l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> ?e' s\n 5. ?y1 \\<in> support ?P \\<Longrightarrow> False\n 6. \\<And>l s.\n       \\<lbrakk>?P l s; \\<not> bval b s\\<rbrakk> \\<Longrightarrow> Q l s", "show \"\\<exists>k>0. \\<forall>l s. wp\\<^sub>1 (WHILE b DO c) Q l s \\<longrightarrow> wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>  \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> k * \\<down>\\<^sub>t (WHILE b DO c, s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 (WHILE b DO c) Q l s \\<longrightarrow>\n          wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n          \\<down>\\<^sub>t (WHILE b DO c, s)\n          \\<le> k * \\<down>\\<^sub>t (WHILE b DO c, s)", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>k>0.\n     \\<forall>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<longrightarrow>\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s)\n        \\<le> k * \\<down>\\<^sub>t (WHILE b DO c, s)\n\ngoal (5 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False\n 5. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 (WHILE b DO c) Q l s; \\<not> bval b s\\<rbrakk>\n       \\<Longrightarrow> Q l s", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False\n 5. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 (WHILE b DO c) Q l s; \\<not> bval b s\\<rbrakk>\n       \\<Longrightarrow> Q l s", "fix l s"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False\n 5. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 (WHILE b DO c) Q l s; \\<not> bval b s\\<rbrakk>\n       \\<Longrightarrow> Q l s", "assume \"wp\\<^sub>1 (WHILE b DO c) Q l s\" \"\\<not> bval b s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n  \\<not> bval b s\n\ngoal (5 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False\n 5. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 (WHILE b DO c) Q l s; \\<not> bval b s\\<rbrakk>\n       \\<Longrightarrow> Q l s", "then"], ["proof (chain)\npicking this:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n  \\<not> bval b s", "show \"Q l s\""], ["proof (prove)\nusing this:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n  \\<not> bval b s\n\ngoal (1 subgoal):\n 1. Q l s", "by (simp add: wp1While)"], ["proof (state)\nthis:\n  Q l s\n\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "fix l s"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "assume \"wp\\<^sub>1 (WHILE b DO c) Q l s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "from this[unfolded wp1_def]"], ["proof (chain)\npicking this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t", "obtain t s' where t: \"(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\" and \"Q l s'\""], ["proof (prove)\nusing this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t\n\ngoal (1 subgoal):\n 1. (\\<And>t s'.\n        \\<lbrakk>(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s';\n         Q l s'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  Q l s'\n\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  Q l s'", "have r: \"\\<down>\\<^sub>t (WHILE b DO c, s) = t\""], ["proof (prove)\nusing this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  Q l s'\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (WHILE b DO c, s) = t", "using Nielson_Hoare.bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  Q l s'\n  (?c, ?s) \\<Rightarrow> ?P \\<Down> ?T \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?P\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (WHILE b DO c, s) = t", "by auto"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (WHILE b DO c, s) = t\n\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "assume \"\\<not> bval b s\""], ["proof (state)\nthis:\n  \\<not> bval b s\n\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "with r t"], ["proof (chain)\npicking this:\n  \\<down>\\<^sub>t (WHILE b DO c, s) = t\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  \\<not> bval b s", "have   t2: \"t=1\""], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (WHILE b DO c, s) = t\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'\n  \\<not> bval b s\n\ngoal (1 subgoal):\n 1. t = 1", "by auto"], ["proof (state)\nthis:\n  t = 1\n\ngoal (4 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. \\<And>l s.\n       \\<lbrakk>\\<not> bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 4. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "from r t2"], ["proof (chain)\npicking this:\n  \\<down>\\<^sub>t (WHILE b DO c, s) = t\n  t = 1", "show \"1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\""], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (WHILE b DO c, s) = t\n  t = 1\n\ngoal (1 subgoal):\n 1. 1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)", "by auto"], ["proof (state)\nthis:\n  1 \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "fix l s"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "assume \"wp\\<^sub>1 (WHILE b DO c) Q l s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 (WHILE b DO c) Q l s\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "from this[unfolded wp1_def]"], ["proof (chain)\npicking this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t", "obtain t s'' where t: \"(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\" \"Q l s''\""], ["proof (prove)\nusing this:\n  \\<exists>t p. (WHILE b DO c, s) \\<Rightarrow> p \\<Down> t \\<and> Q l t\n\ngoal (1 subgoal):\n 1. (\\<And>t s''.\n        \\<lbrakk>(WHILE b DO c, s) \\<Rightarrow> t \\<Down> s'';\n         Q l s''\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''", "have r: \"\\<down>\\<^sub>t (WHILE b DO c, s) = t\""], ["proof (prove)\nusing this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (WHILE b DO c, s) = t", "using Nielson_Hoare.bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''\n  (?c, ?s) \\<Rightarrow> ?P \\<Down> ?T \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?P\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (WHILE b DO c, s) = t", "by auto"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (WHILE b DO c, s) = t\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "assume \"bval b s\""], ["proof (state)\nthis:\n  bval b s\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "with t"], ["proof (chain)\npicking this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''\n  bval b s", "obtain t1 t2 s' where 1: \"(c,s) \\<Rightarrow> t1 \\<Down> s'\" and 2: \"(WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\" and sum: \"t=t1+t2+1\" and \"bval b s\""], ["proof (prove)\nusing this:\n  (WHILE b DO c, s) \\<Rightarrow> t \\<Down> s''\n  Q l s''\n  bval b s\n\ngoal (1 subgoal):\n 1. (\\<And>t1 s' t2.\n        \\<lbrakk>(c, s) \\<Rightarrow> t1 \\<Down> s';\n         (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''; t = t1 + t2 + 1;\n         bval b s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  (c, s) \\<Rightarrow> t1 \\<Down> s'\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\n  t = t1 + t2 + 1\n  bval b s\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "from 1"], ["proof (chain)\npicking this:\n  (c, s) \\<Rightarrow> t1 \\<Down> s'", "have A: \"\\<down>\\<^sub>t (c,s) = t1\" and s': \"\\<down>\\<^sub>s (c,s) = s'\""], ["proof (prove)\nusing this:\n  (c, s) \\<Rightarrow> t1 \\<Down> s'\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c, s) = t1 &&& \\<down>\\<^sub>s (c, s) = s'", "using Nielson_Hoare.bigstepT_the_cost bigstepT_the_state"], ["proof (prove)\nusing this:\n  (c, s) \\<Rightarrow> t1 \\<Down> s'\n  (?c, ?s) \\<Rightarrow> ?P \\<Down> ?T \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?P\n  (?c, ?s) \\<Rightarrow> ?P \\<Down> ?T \\<Longrightarrow>\n  \\<down>\\<^sub>s (?c, ?s) = ?T\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (c, s) = t1 &&& \\<down>\\<^sub>s (c, s) = s'", "by auto"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (c, s) = t1\n  \\<down>\\<^sub>s (c, s) = s'\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "from 2 s'"], ["proof (chain)\npicking this:\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\n  \\<down>\\<^sub>s (c, s) = s'", "have B: \"\\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s(c,s)) = t2\""], ["proof (prove)\nusing this:\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\n  \\<down>\\<^sub>s (c, s) = s'\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) = t2", "using Nielson_Hoare.bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (WHILE b DO c, s') \\<Rightarrow> t2 \\<Down> s''\n  \\<down>\\<^sub>s (c, s) = s'\n  (?c, ?s) \\<Rightarrow> ?P \\<Down> ?T \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?P\n\ngoal (1 subgoal):\n 1. \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) = t2", "by auto"], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) = t2\n\ngoal (3 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and> ?e'1 s = l ?y1}\n                         c { ?e''1 \\<Down> \\<lambda>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. \\<And>l s.\n       \\<lbrakk>bval b s; wp\\<^sub>1 (WHILE b DO c) Q l s\\<rbrakk>\n       \\<Longrightarrow> 1 + ?e'1 s + ?e''1 s\n                         \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n 3. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "show \"1 + (%s. \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s(c,s))) s  + (%s. \\<down>\\<^sub>t (c,s)) s \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) +\n    \\<down>\\<^sub>t (c, s)\n    \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)", "apply(simp add: r A B sum)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  1 + \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) +\n  \\<down>\\<^sub>t (c, s)\n  \\<le> \\<down>\\<^sub>t (WHILE b DO c, s)\n\ngoal (2 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and>\n                             \\<down>\\<^sub>t\n                              (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n                             l ?y1}\n                         c { \\<lambda>s.\n                                \\<down>\\<^sub>t\n                                 (c, s) \\<Down> \\<lambda>l s.\n             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n             \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and>\n                             \\<down>\\<^sub>t\n                              (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n                             l ?y1}\n                         c { \\<lambda>s.\n                                \\<down>\\<^sub>t\n                                 (c, s) \\<Down> \\<lambda>l s.\n             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n             \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y1}\n 2. ?y1 \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow> False", "show \"\\<turnstile>\\<^sub>1 {\\<lambda>l s. wp\\<^sub>1 (WHILE b DO c) Q l s \\<and> bval b s \\<and> \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) = l ?y} c\n         { \\<lambda>s. \\<down>\\<^sub>t (c, s) \\<Down> \\<lambda>l s. wp\\<^sub>1 (WHILE b DO c) Q l s \\<and> \\<down>\\<^sub>t (WHILE b DO c, s) \\<le> l ?y}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                             bval b s \\<and>\n                             \\<down>\\<^sub>t\n                              (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n                             l (new (wp\\<^sub>1 (WHILE b DO c) Q))}\n                         c { \\<lambda>s.\n                                \\<down>\\<^sub>t\n                                 (c, s) \\<Down> \\<lambda>l s.\n             wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n             \\<down>\\<^sub>t (WHILE b DO c, s)\n             \\<le> l (new (wp\\<^sub>1 (WHILE b DO c) Q))}", "apply(rule conseq_old[OF _ While(1), of _ \"%l s. wp\\<^sub>1 (WHILE b DO c) Q l s \\<and> \\<down>\\<^sub>t (WHILE b DO c, s) = l ?y\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<exists>k>0.\n       \\<forall>l s.\n          wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n          bval b s \\<and>\n          \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n          l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n          wp\\<^sub>1 c\n           (\\<lambda>a c.\n               wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n               \\<down>\\<^sub>t (WHILE b DO c, c) =\n               a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n           l s \\<and>\n          \\<down>\\<^sub>t (c, s) \\<le> k * \\<down>\\<^sub>t (c, s)\n 2. finite\n     (support\n       (\\<lambda>a c.\n           wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n           \\<down>\\<^sub>t (WHILE b DO c, c) =\n           a (new (wp\\<^sub>1 (WHILE b DO c) Q))))\n 3. \\<forall>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s)\n       \\<le> l (new (wp\\<^sub>1 (WHILE b DO c) Q))", "apply(rule exI[where x=1])"], ["proof (prove)\ngoal (3 subgoals):\n 1. 0 < 1 \\<and>\n    (\\<forall>l s.\n        wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n        bval b s \\<and>\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n        wp\\<^sub>1 c\n         (\\<lambda>a c.\n             wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n             \\<down>\\<^sub>t (WHILE b DO c, c) =\n             a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n         l s \\<and>\n        \\<down>\\<^sub>t (c, s) \\<le> 1 * \\<down>\\<^sub>t (c, s))\n 2. finite\n     (support\n       (\\<lambda>a c.\n           wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n           \\<down>\\<^sub>t (WHILE b DO c, c) =\n           a (new (wp\\<^sub>1 (WHILE b DO c) Q))))\n 3. \\<forall>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s)\n       \\<le> l (new (wp\\<^sub>1 (WHILE b DO c) Q))", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<forall>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       bval b s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n       wp\\<^sub>1 c\n        (\\<lambda>a c.\n            wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n            \\<down>\\<^sub>t (WHILE b DO c, c) =\n            a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n        l s\n 2. finite\n     (support\n       (\\<lambda>a c.\n           wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n           \\<down>\\<^sub>t (WHILE b DO c, c) =\n           a (new (wp\\<^sub>1 (WHILE b DO c) Q))))\n 3. \\<forall>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s)\n       \\<le> l (new (wp\\<^sub>1 (WHILE b DO c) Q))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       bval b s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n       wp\\<^sub>1 c\n        (\\<lambda>a c.\n            wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n            \\<down>\\<^sub>t (WHILE b DO c, c) =\n            a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n        l s", "apply safe"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 (WHILE b DO c) Q l s; bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "apply(subst (asm) wp1While)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>if bval b s\n                then wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n                else Q l s;\n        bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s; bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s; bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "fix l s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s; bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "assume 1: \"wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\""], ["proof (state)\nthis:\n  wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s; bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "assume 2: \"\\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) = l ?y\""], ["proof (state)\nthis:\n  \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n  l (new (wp\\<^sub>1 (WHILE b DO c) Q))\n\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s; bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "then"], ["proof (chain)\npicking this:\n  \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n  l (new (wp\\<^sub>1 (WHILE b DO c) Q))", "have \"l ?y = prec c (%s. \\<down>\\<^sub>t (WHILE b DO c, s)) s\""], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n  l (new (wp\\<^sub>1 (WHILE b DO c) Q))\n\ngoal (1 subgoal):\n 1. l (new (wp\\<^sub>1 (WHILE b DO c) Q)) =\n    prec c (\\<lambda>s. \\<down>\\<^sub>t (WHILE b DO c, s)) s", "unfolding prec_def"], ["proof (prove)\nusing this:\n  \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n  l (new (wp\\<^sub>1 (WHILE b DO c) Q))\n\ngoal (1 subgoal):\n 1. l (new (wp\\<^sub>1 (WHILE b DO c) Q)) =\n    \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s))", "by auto"], ["proof (state)\nthis:\n  l (new (wp\\<^sub>1 (WHILE b DO c) Q)) =\n  prec c (\\<lambda>s. \\<down>\\<^sub>t (WHILE b DO c, s)) s\n\ngoal (1 subgoal):\n 1. \\<And>l s.\n       \\<lbrakk>wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s; bval b s;\n        \\<down>\\<^sub>t (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n        l (new (wp\\<^sub>1 (WHILE b DO c) Q))\\<rbrakk>\n       \\<Longrightarrow> wp\\<^sub>1 c\n                          (\\<lambda>a c.\n                              wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n                              \\<down>\\<^sub>t (WHILE b DO c, c) =\n                              a (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n                          l s", "with 1 wp1_prec2[of c \"(wp\\<^sub>1 (WHILE b DO c) Q)\" l s _ \"(\\<lambda>s. \\<down>\\<^sub>t (WHILE b DO c, s))\"]"], ["proof (chain)\npicking this:\n  wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n  (wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s \\<and>\n   l ?x = prec c (\\<lambda>s. \\<down>\\<^sub>t (WHILE b DO c, s)) s) =\n  wp\\<^sub>1 c\n   (\\<lambda>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) = l ?x)\n   l s\n  l (new (wp\\<^sub>1 (WHILE b DO c) Q)) =\n  prec c (\\<lambda>s. \\<down>\\<^sub>t (WHILE b DO c, s)) s", "show \"wp\\<^sub>1 c (\\<lambda>l s. wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>  \\<down>\\<^sub>t (WHILE b DO c, s) = l ?y) l s\""], ["proof (prove)\nusing this:\n  wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s\n  (wp\\<^sub>1 c (wp\\<^sub>1 (WHILE b DO c) Q) l s \\<and>\n   l ?x = prec c (\\<lambda>s. \\<down>\\<^sub>t (WHILE b DO c, s)) s) =\n  wp\\<^sub>1 c\n   (\\<lambda>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) = l ?x)\n   l s\n  l (new (wp\\<^sub>1 (WHILE b DO c) Q)) =\n  prec c (\\<lambda>s. \\<down>\\<^sub>t (WHILE b DO c, s)) s\n\ngoal (1 subgoal):\n 1. wp\\<^sub>1 c\n     (\\<lambda>l s.\n         wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n         \\<down>\\<^sub>t (WHILE b DO c, s) =\n         l (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n     l s", "by auto"], ["proof (state)\nthis:\n  wp\\<^sub>1 c\n   (\\<lambda>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n   l s\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite\n     (support\n       (\\<lambda>a c.\n           wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n           \\<down>\\<^sub>t (WHILE b DO c, c) =\n           a (new (wp\\<^sub>1 (WHILE b DO c) Q))))\n 2. \\<forall>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s)\n       \\<le> l (new (wp\\<^sub>1 (WHILE b DO c) Q))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     (support\n       (\\<lambda>a c.\n           wp\\<^sub>1 (WHILE b DO c) Q a c \\<and>\n           \\<down>\\<^sub>t (WHILE b DO c, c) =\n           a (new (wp\\<^sub>1 (WHILE b DO c) Q))))", "apply(rule finite_subset[OF support_and])"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     (support (wp\\<^sub>1 (WHILE b DO c) Q) \\<union>\n      support\n       (\\<lambda>l s.\n           \\<down>\\<^sub>t (WHILE b DO c, s) =\n           l (new (wp\\<^sub>1 (WHILE b DO c) Q))))", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite (support (wp\\<^sub>1 (WHILE b DO c) Q))\n 2. finite\n     (support\n       (\\<lambda>l s.\n           \\<down>\\<^sub>t (WHILE b DO c, s) =\n           l (new (wp\\<^sub>1 (WHILE b DO c) Q))))", "apply(rule finite_subset[OF support_wpt])"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite (support Q)\n 2. finite\n     (support\n       (\\<lambda>l s.\n           \\<down>\\<^sub>t (WHILE b DO c, s) =\n           l (new (wp\\<^sub>1 (WHILE b DO c) Q))))", "apply fact"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     (support\n       (\\<lambda>l s.\n           \\<down>\\<^sub>t (WHILE b DO c, s) =\n           l (new (wp\\<^sub>1 (WHILE b DO c) Q))))", "apply(rule finite_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. support\n     (\\<lambda>l s.\n         \\<down>\\<^sub>t (WHILE b DO c, s) =\n         l (new (wp\\<^sub>1 (WHILE b DO c) Q)))\n    \\<subseteq> ?B8\n 2. finite ?B8", "apply(rule support_single)"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {new (wp\\<^sub>1 (WHILE b DO c) Q)}", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l s.\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s) =\n       l (new (wp\\<^sub>1 (WHILE b DO c) Q)) \\<longrightarrow>\n       wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n       \\<down>\\<^sub>t (WHILE b DO c, s)\n       \\<le> l (new (wp\\<^sub>1 (WHILE b DO c) Q))", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {\\<lambda>l s.\n                           wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n                           bval b s \\<and>\n                           \\<down>\\<^sub>t\n                            (WHILE b DO c, \\<down>\\<^sub>s (c, s)) =\n                           l (new (wp\\<^sub>1 (WHILE b DO c) Q))}\n                       c { \\<lambda>s.\n                              \\<down>\\<^sub>t\n                               (c, s) \\<Down> \\<lambda>l s.\n           wp\\<^sub>1 (WHILE b DO c) Q l s \\<and>\n           \\<down>\\<^sub>t (WHILE b DO c, s)\n           \\<le> l (new (wp\\<^sub>1 (WHILE b DO c) Q))}\n\ngoal (1 subgoal):\n 1. new (wp\\<^sub>1 (WHILE b DO c) Q)\n    \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow>\n    False", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. new (wp\\<^sub>1 (WHILE b DO c) Q)\n    \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow>\n    False", "assume \"new (wp\\<^sub>1 (WHILE b DO c) Q) \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q)\""], ["proof (state)\nthis:\n  new (wp\\<^sub>1 (WHILE b DO c) Q)\n  \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q)\n\ngoal (1 subgoal):\n 1. new (wp\\<^sub>1 (WHILE b DO c) Q)\n    \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q) \\<Longrightarrow>\n    False", "with yQx"], ["proof (chain)\npicking this:\n  new (wp\\<^sub>1 (WHILE b DO c) Q)\n  \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)\n  new (wp\\<^sub>1 (WHILE b DO c) Q)\n  \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q)", "show \"False\""], ["proof (prove)\nusing this:\n  new (wp\\<^sub>1 (WHILE b DO c) Q)\n  \\<notin> support (wp\\<^sub>1 (WHILE b DO c) Q)\n  new (wp\\<^sub>1 (WHILE b DO c) Q)\n  \\<in> support (wp\\<^sub>1 (WHILE b DO c) Q)\n\ngoal (1 subgoal):\n 1. False", "by blast"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<turnstile>\\<^sub>1 {wp\\<^sub>1 (WHILE b DO c) Q} WHILE b DO c\n                       { \\<lambda>s.\n                            \\<down>\\<^sub>t (WHILE b DO c, s) \\<Down> Q}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma valid_wp: \"\\<Turnstile>\\<^sub>1 {P}c{p \\<Down> Q} \\<longleftrightarrow> (\\<exists>k>0. (\\<forall>l s. P l s \\<longrightarrow> (wp\\<^sub>1 c Q l s \\<and> ((THE n. (\\<exists> t. ((c,s) \\<Rightarrow> n \\<Down> t)))) \\<le> k * p s)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Turnstile>\\<^sub>1 {P} c { p \\<Down>Q}) =\n    (\\<exists>k>0.\n        \\<forall>l s.\n           P l s \\<longrightarrow>\n           wp\\<^sub>1 c Q l s \\<and> \\<down>\\<^sub>t (c, s) \\<le> k * p s)", "apply(rule)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<Turnstile>\\<^sub>1 {P} c { p \\<Down>Q} \\<Longrightarrow>\n    \\<exists>k>0.\n       \\<forall>l s.\n          P l s \\<longrightarrow>\n          wp\\<^sub>1 c Q l s \\<and> \\<down>\\<^sub>t (c, s) \\<le> k * p s\n 2. \\<exists>k>0.\n       \\<forall>l s.\n          P l s \\<longrightarrow>\n          wp\\<^sub>1 c Q l s \\<and>\n          \\<down>\\<^sub>t (c, s) \\<le> k * p s \\<Longrightarrow>\n    \\<Turnstile>\\<^sub>1 {P} c { p \\<Down>Q}", "apply(auto simp: hoare1_valid_def wp1_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>0 < k;\n        \\<forall>l s.\n           P l s \\<longrightarrow>\n           (\\<exists>t pa.\n               (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n               pa \\<le> k * p s \\<and> Q l t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t.\n                                   (\\<exists>p.\n (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                                   Q l t) \\<and>\n                               \\<down>\\<^sub>t (c, s) \\<le> k * p s\n 2. \\<And>k.\n       \\<lbrakk>0 < k;\n        \\<forall>l s.\n           P l s \\<longrightarrow>\n           (\\<exists>t.\n               (\\<exists>p. (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n               Q l t) \\<and>\n           \\<down>\\<^sub>t (c, s) \\<le> k * p s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t pa.\n                                   (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n                                   pa \\<le> k * p s \\<and> Q l t)", "subgoal for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < k;\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t pa.\n            (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n            pa \\<le> k * p s \\<and> Q l t)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k>0.\n                         \\<forall>l s.\n                            P l s \\<longrightarrow>\n                            (\\<exists>t.\n                                (\\<exists>p.\n                                    (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                                Q l t) \\<and>\n                            \\<down>\\<^sub>t (c, s) \\<le> k * p s", "apply(rule exI[where x=k])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < k;\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t pa.\n            (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n            pa \\<le> k * p s \\<and> Q l t)\\<rbrakk>\n    \\<Longrightarrow> 0 < k \\<and>\n                      (\\<forall>l s.\n                          P l s \\<longrightarrow>\n                          (\\<exists>t.\n                              (\\<exists>p.\n                                  (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                              Q l t) \\<and>\n                          \\<down>\\<^sub>t (c, s) \\<le> k * p s)", "using bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (?c, ?s) \\<Rightarrow> ?P \\<Down> ?T \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?P\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < k;\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t pa.\n            (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n            pa \\<le> k * p s \\<and> Q l t)\\<rbrakk>\n    \\<Longrightarrow> 0 < k \\<and>\n                      (\\<forall>l s.\n                          P l s \\<longrightarrow>\n                          (\\<exists>t.\n                              (\\<exists>p.\n                                  (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n                              Q l t) \\<and>\n                          \\<down>\\<^sub>t (c, s) \\<le> k * p s)", "by fast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>0 < k;\n        \\<forall>l s.\n           P l s \\<longrightarrow>\n           (\\<exists>t.\n               (\\<exists>p. (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n               Q l t) \\<and>\n           \\<down>\\<^sub>t (c, s) \\<le> k * p s\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k>0.\n                            \\<forall>l s.\n                               P l s \\<longrightarrow>\n                               (\\<exists>t pa.\n                                   (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n                                   pa \\<le> k * p s \\<and> Q l t)", "subgoal for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < k;\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t.\n            (\\<exists>p. (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n            Q l t) \\<and>\n        \\<down>\\<^sub>t (c, s) \\<le> k * p s\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k>0.\n                         \\<forall>l s.\n                            P l s \\<longrightarrow>\n                            (\\<exists>t pa.\n                                (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n                                pa \\<le> k * p s \\<and> Q l t)", "apply(rule exI[where x=k])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < k;\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t.\n            (\\<exists>p. (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n            Q l t) \\<and>\n        \\<down>\\<^sub>t (c, s) \\<le> k * p s\\<rbrakk>\n    \\<Longrightarrow> 0 < k \\<and>\n                      (\\<forall>l s.\n                          P l s \\<longrightarrow>\n                          (\\<exists>t pa.\n                              (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n                              pa \\<le> k * p s \\<and> Q l t))", "using bigstepT_the_cost"], ["proof (prove)\nusing this:\n  (?c, ?s) \\<Rightarrow> ?P \\<Down> ?T \\<Longrightarrow>\n  \\<down>\\<^sub>t (?c, ?s) = ?P\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < k;\n     \\<forall>l s.\n        P l s \\<longrightarrow>\n        (\\<exists>t.\n            (\\<exists>p. (c, s) \\<Rightarrow> p \\<Down> t) \\<and>\n            Q l t) \\<and>\n        \\<down>\\<^sub>t (c, s) \\<le> k * p s\\<rbrakk>\n    \\<Longrightarrow> 0 < k \\<and>\n                      (\\<forall>l s.\n                          P l s \\<longrightarrow>\n                          (\\<exists>t pa.\n                              (c, s) \\<Rightarrow> pa \\<Down> t \\<and>\n                              pa \\<le> k * p s \\<and> Q l t))", "by fast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "theorem hoare1_complete: \"finite (support Q) \\<Longrightarrow> \\<Turnstile>\\<^sub>1 {P}c{p \\<Down> Q} \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P}c{p \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>finite (support Q);\n     \\<Turnstile>\\<^sub>1 {P} c { p \\<Down>Q}\\<rbrakk>\n    \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P} c { p \\<Down> Q}", "apply(rule conseq_old[OF _ wp1_is_pre, where Q'=Q and Q=Q, simplified])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>finite (support Q);\n     \\<Turnstile>\\<^sub>1 {P} c { p \\<Down>Q}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k>0.\n                         \\<forall>l s.\n                            P l s \\<longrightarrow>\n                            wp\\<^sub>1 c Q l s \\<and>\n                            \\<down>\\<^sub>t (c, s) \\<le> k * p s\n 2. \\<lbrakk>finite (support Q);\n     \\<Turnstile>\\<^sub>1 {P} c { p \\<Down>Q}\\<rbrakk>\n    \\<Longrightarrow> finite (support Q)", "by (auto simp: valid_wp)"], ["", "corollary hoare1_sound_complete: \"finite (support Q) \\<Longrightarrow> \\<turnstile>\\<^sub>1 {P}c{p \\<Down> Q} \\<longleftrightarrow> \\<Turnstile>\\<^sub>1 {P}c{p \\<Down> Q}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (support Q) \\<Longrightarrow>\n    (\\<turnstile>\\<^sub>1 {P} c { p \\<Down> Q}) =\n    (\\<Turnstile>\\<^sub>1 {P} c { p \\<Down>Q})", "by (metis hoare1_sound hoare1_complete)"], ["", "end"]]}