{"file_name": "/home/qj213/afp-2021-10-22/thys/Hoare_Time/Partial_Evaluation.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Hoare_Time", "problem_names": ["lemma emb_part[simp]: \"emb (part s) q = s\"", "lemma part_emb[simp]: \"dom ps = UNIV \\<Longrightarrow> part (emb ps q) = ps\"", "lemma dom_part[simp]: \"dom (part s) = UNIV\"", "lemma \"paval' a ps = Some v \\<Longrightarrow> vars a \\<subseteq> dom ps\"", "lemma paval'_aval: \"paval' a ps = Some v \\<Longrightarrow> aval a (emb ps s) = v\"", "lemma paval_aval: \"vars a \\<subseteq> dom ps \\<Longrightarrow> paval a ps = aval a (\\<lambda>v. case ps v of None \\<Rightarrow> s v | Some r \\<Rightarrow> r)\"", "lemma paval'_paval: \"vars a \\<subseteq> dom ps \\<Longrightarrow> paval' a ps = Some (paval a ps)\"", "lemma paval_paval': \"paval' a ps = Some v \\<Longrightarrow> paval a ps = v\"", "lemma pbval'_pbval: \"vars a \\<subseteq> dom ps \\<Longrightarrow> pbval' a ps = Some (pbval a ps)\"", "lemma paval_aval_vars: \"vars a \\<subseteq> dom ps \\<Longrightarrow> paval a ps = aval a (emb ps s)\"", "lemma pbval_bval_vars: \"vars b \\<subseteq> dom ps \\<Longrightarrow> pbval b ps = bval b (emb ps s)\"", "lemma paval'dom: \"paval' a ps = Some v \\<Longrightarrow> vars a \\<subseteq> dom ps\""], "translations": [["", "lemma emb_part[simp]: \"emb (part s) q = s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. emb (part s) q = s", "unfolding emb_def part_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>v.\n        case Some (s v) of None \\<Rightarrow> q v\n        | Some r \\<Rightarrow> r) =\n    s", "by auto"], ["", "lemma part_emb[simp]: \"dom ps = UNIV \\<Longrightarrow> part (emb ps q) = ps\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dom ps = UNIV \\<Longrightarrow> part (emb ps q) = ps", "unfolding emb_def part_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. dom ps = UNIV \\<Longrightarrow>\n    (\\<lambda>v.\n        Some\n         (case ps v of None \\<Rightarrow> q v | Some r \\<Rightarrow> r)) =\n    ps", "apply(rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v.\n       dom ps = UNIV \\<Longrightarrow>\n       Some (case ps v of None \\<Rightarrow> q v | Some r \\<Rightarrow> r) =\n       ps v", "by (simp add: domD option.case_eq_if)"], ["", "lemma dom_part[simp]: \"dom (part s) = UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dom (part s) = UNIV", "unfolding part_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. dom (\\<lambda>v. Some (s v)) = UNIV", "by auto"], ["", "abbreviation optplus :: \"int option \\<Rightarrow> int option \\<Rightarrow> int option\"   where \"optplus a b \\<equiv> (case a of None \\<Rightarrow> None | Some a' \\<Rightarrow> (case b of None \\<Rightarrow> None | Some b' \\<Rightarrow> Some (a' + b'))) \""], ["", "abbreviation opttimes :: \"int option \\<Rightarrow> int option \\<Rightarrow> int option\"   where \"opttimes a b \\<equiv> (case a of None \\<Rightarrow> None | Some a' \\<Rightarrow> (case b of None \\<Rightarrow> None | Some b' \\<Rightarrow> Some (a' * b'))) \""], ["", "abbreviation optdiv :: \"int option \\<Rightarrow> int option \\<Rightarrow> int option\"   where \"optdiv a b \\<equiv> (case a of None \\<Rightarrow> None | Some a' \\<Rightarrow> (case b of None \\<Rightarrow> None | Some b' \\<Rightarrow> Some (a' div b'))) \""], ["", "fun paval' :: \"aexp \\<Rightarrow> partstate \\<Rightarrow> val option\" where\n\"paval' (N n) s = Some n\" |\n\"paval' (V x) s = s x\" |\n\"paval' (Plus a\\<^sub>1 a\\<^sub>2) s = optplus (paval' a\\<^sub>1 s)   (paval' a\\<^sub>2 s)\" |\n\"paval' (Times a\\<^sub>1 a\\<^sub>2) s = opttimes (paval' a\\<^sub>1 s)   (paval' a\\<^sub>2 s)\" |\n\"paval' (Div a\\<^sub>1 a\\<^sub>2) s = optdiv (paval' a\\<^sub>1 s)   (paval' a\\<^sub>2 s)\""], ["", "lemma \"paval' a ps = Some v \\<Longrightarrow> vars a \\<subseteq> dom ps\""], ["proof (prove)\ngoal (1 subgoal):\n 1. paval' a ps = Some v \\<Longrightarrow> vars a \\<subseteq> dom ps", "proof(induct a arbitrary: v)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Plus a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "case (Plus a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Plus a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "from Plus(3)"], ["proof (chain)\npicking this:\n  paval' (Plus a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Plus a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "with Plus(3)"], ["proof (chain)\npicking this:\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Plus a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "from Plus(1)[OF 1] Plus(2)[OF 2]"], ["proof (chain)\npicking this:\n  vars a1 \\<subseteq> dom ps\n  vars a2 \\<subseteq> dom ps", "show ?case"], ["proof (prove)\nusing this:\n  vars a1 \\<subseteq> dom ps\n  vars a2 \\<subseteq> dom ps\n\ngoal (1 subgoal):\n 1. vars (Plus a1 a2) \\<subseteq> dom ps", "by auto"], ["proof (state)\nthis:\n  vars (Plus a1 a2) \\<subseteq> dom ps\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "case (Times a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Times a1 a2) ps = Some v\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "from Times(3)"], ["proof (chain)\npicking this:\n  paval' (Times a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Times a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "with Times(3)"], ["proof (chain)\npicking this:\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "from Times(1)[OF 1] Times(2)[OF 2]"], ["proof (chain)\npicking this:\n  vars a1 \\<subseteq> dom ps\n  vars a2 \\<subseteq> dom ps", "show ?case"], ["proof (prove)\nusing this:\n  vars a1 \\<subseteq> dom ps\n  vars a2 \\<subseteq> dom ps\n\ngoal (1 subgoal):\n 1. vars (Times a1 a2) \\<subseteq> dom ps", "by auto"], ["proof (state)\nthis:\n  vars (Times a1 a2) \\<subseteq> dom ps\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "case (Div a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Div a1 a2) ps = Some v\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "from Div(3)"], ["proof (chain)\npicking this:\n  paval' (Div a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Div a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "with Div(3)"], ["proof (chain)\npicking this:\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "from Div(1)[OF 1] Div(2)[OF 2]"], ["proof (chain)\npicking this:\n  vars a1 \\<subseteq> dom ps\n  vars a2 \\<subseteq> dom ps", "show ?case"], ["proof (prove)\nusing this:\n  vars a1 \\<subseteq> dom ps\n  vars a2 \\<subseteq> dom ps\n\ngoal (1 subgoal):\n 1. vars (Div a1 a2) \\<subseteq> dom ps", "by auto"], ["proof (state)\nthis:\n  vars (Div a1 a2) \\<subseteq> dom ps\n\ngoal (2 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps", "qed  (simp_all, blast)"], ["", "lemma paval'_aval: \"paval' a ps = Some v \\<Longrightarrow> aval a (emb ps s) = v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. paval' a ps = Some v \\<Longrightarrow> aval a (emb ps s) = v", "proof(induct a arbitrary: v)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Plus a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "case (Plus a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> aval a1 (emb ps s) = ?v\n  paval' a2 ps = Some ?v \\<Longrightarrow> aval a2 (emb ps s) = ?v\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Plus a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "from Plus(3)"], ["proof (chain)\npicking this:\n  paval' (Plus a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Plus a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "with Plus(3)"], ["proof (chain)\npicking this:\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Plus a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "from Plus(1)[OF 1] Plus(2)[OF 2] Plus(3) 1 2"], ["proof (chain)\npicking this:\n  aval a1 (emb ps s) = v1\n  aval a2 (emb ps s) = v2\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2", "show ?case"], ["proof (prove)\nusing this:\n  aval a1 (emb ps s) = v1\n  aval a2 (emb ps s) = v2\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2\n\ngoal (1 subgoal):\n 1. aval (Plus a1 a2) (emb ps s) = v", "by auto"], ["proof (state)\nthis:\n  aval (Plus a1 a2) (emb ps s) = v\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "case (Times a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> aval a1 (emb ps s) = ?v\n  paval' a2 ps = Some ?v \\<Longrightarrow> aval a2 (emb ps s) = ?v\n  paval' (Times a1 a2) ps = Some v\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "from Times(3)"], ["proof (chain)\npicking this:\n  paval' (Times a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Times a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "with Times(3)"], ["proof (chain)\npicking this:\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Times a1 a2) (emb ps s) = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "from Times(1)[OF 1] Times(2)[OF 2] Times(3) 1 2"], ["proof (chain)\npicking this:\n  aval a1 (emb ps s) = v1\n  aval a2 (emb ps s) = v2\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2", "show ?case"], ["proof (prove)\nusing this:\n  aval a1 (emb ps s) = v1\n  aval a2 (emb ps s) = v2\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2\n\ngoal (1 subgoal):\n 1. aval (Times a1 a2) (emb ps s) = v", "by auto"], ["proof (state)\nthis:\n  aval (Times a1 a2) (emb ps s) = v\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "case (Div a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> aval a1 (emb ps s) = ?v\n  paval' a2 ps = Some ?v \\<Longrightarrow> aval a2 (emb ps s) = ?v\n  paval' (Div a1 a2) ps = Some v\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "from Div(3)"], ["proof (chain)\npicking this:\n  paval' (Div a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Div a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "with Div(3)"], ["proof (chain)\npicking this:\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   aval a1 (emb ps s) = v;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow> aval a2 (emb ps s) = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> aval (Div a1 a2) (emb ps s) = v", "from Div(1)[OF 1] Div(2)[OF 2] Div(3) 1 2"], ["proof (chain)\npicking this:\n  aval a1 (emb ps s) = v1\n  aval a2 (emb ps s) = v2\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2", "show ?case"], ["proof (prove)\nusing this:\n  aval a1 (emb ps s) = v1\n  aval a2 (emb ps s) = v2\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2\n\ngoal (1 subgoal):\n 1. aval (Div a1 a2) (emb ps s) = v", "by auto"], ["proof (state)\nthis:\n  aval (Div a1 a2) (emb ps s) = v\n\ngoal (2 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow> aval (N x) (emb ps s) = v\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow> aval (V x) (emb ps s) = v", "qed (simp_all add: emb_def)"], ["", "fun paval :: \"aexp \\<Rightarrow> partstate \\<Rightarrow> val\" where\n\"paval (N n) s = n\" |\n\"paval (V x) s = the (s x)\" |\n\"paval (Plus a\\<^sub>1 a\\<^sub>2) s = paval a\\<^sub>1 s + paval a\\<^sub>2 s\" |\n\"paval (Times a\\<^sub>1 a\\<^sub>2) s = paval a\\<^sub>1 s * paval a\\<^sub>2 s\" |\n\"paval (Div a\\<^sub>1 a\\<^sub>2) s = paval a\\<^sub>1 s div paval a\\<^sub>2 s\""], ["", "lemma paval_aval: \"vars a \\<subseteq> dom ps \\<Longrightarrow> paval a ps = aval a (\\<lambda>v. case ps v of None \\<Rightarrow> s v | Some r \\<Rightarrow> r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vars a \\<subseteq> dom ps \\<Longrightarrow>\n    paval a ps =\n    aval a\n     (\\<lambda>v.\n         case ps v of None \\<Rightarrow> s v | Some r \\<Rightarrow> r)", "by (induct a, auto)"], ["", "lemma paval'_paval: \"vars a \\<subseteq> dom ps \\<Longrightarrow> paval' a ps = Some (paval a ps)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vars a \\<subseteq> dom ps \\<Longrightarrow>\n    paval' a ps = Some (paval a ps)", "by (induct a, auto)"], ["", "lemma paval_paval': \"paval' a ps = Some v \\<Longrightarrow> paval a ps = v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. paval' a ps = Some v \\<Longrightarrow> paval a ps = v", "proof(induct a arbitrary: v)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Plus a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "case (Plus a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> paval a1 ps = ?v\n  paval' a2 ps = Some ?v \\<Longrightarrow> paval a2 ps = ?v\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (5 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Plus a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "from Plus(3)"], ["proof (chain)\npicking this:\n  paval' (Plus a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (5 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Plus a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "with Plus(3)"], ["proof (chain)\npicking this:\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (5 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Plus a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "from Plus(1)[OF 1] Plus(2)[OF 2] Plus(3) 1 2"], ["proof (chain)\npicking this:\n  paval a1 ps = v1\n  paval a2 ps = v2\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2", "show ?case"], ["proof (prove)\nusing this:\n  paval a1 ps = v1\n  paval a2 ps = v2\n  paval' (Plus a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2\n\ngoal (1 subgoal):\n 1. paval (Plus a1 a2) ps = v", "by auto"], ["proof (state)\nthis:\n  paval (Plus a1 a2) ps = v\n\ngoal (4 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "case (Times a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> paval a1 ps = ?v\n  paval' a2 ps = Some ?v \\<Longrightarrow> paval a2 ps = ?v\n  paval' (Times a1 a2) ps = Some v\n\ngoal (4 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "from Times(3)"], ["proof (chain)\npicking this:\n  paval' (Times a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Times a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (4 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "with Times(3)"], ["proof (chain)\npicking this:\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (4 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps = v\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "from Times(1)[OF 1] Times(2)[OF 2] Times(3) 1 2"], ["proof (chain)\npicking this:\n  paval a1 ps = v1\n  paval a2 ps = v2\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2", "show ?case"], ["proof (prove)\nusing this:\n  paval a1 ps = v1\n  paval a2 ps = v2\n  paval' (Times a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2\n\ngoal (1 subgoal):\n 1. paval (Times a1 a2) ps = v", "by auto"], ["proof (state)\nthis:\n  paval (Times a1 a2) ps = v\n\ngoal (3 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "case (Div a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> paval a1 ps = ?v\n  paval' a2 ps = Some ?v \\<Longrightarrow> paval a2 ps = ?v\n  paval' (Div a1 a2) ps = Some v\n\ngoal (3 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "from Div(3)"], ["proof (chain)\npicking this:\n  paval' (Div a1 a2) ps = Some v", "obtain v1 where 1: \"paval' a1 ps = Some v1\""], ["proof (prove)\nusing this:\n  paval' (Div a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. (\\<And>v1.\n        paval' a1 ps = Some v1 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a1 ps = Some v1\n\ngoal (3 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "with Div(3)"], ["proof (chain)\npicking this:\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1", "obtain v2 where 2: \"paval' a2 ps = Some v2\""], ["proof (prove)\nusing this:\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n\ngoal (1 subgoal):\n 1. (\\<And>v2.\n        paval' a2 ps = Some v2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  paval' a2 ps = Some v2\n\ngoal (3 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow> paval a1 ps = v;\n        \\<And>v. paval' a2 ps = Some v \\<Longrightarrow> paval a2 ps = v;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = v", "from Div(1)[OF 1] Div(2)[OF 2] Div(3) 1 2"], ["proof (chain)\npicking this:\n  paval a1 ps = v1\n  paval a2 ps = v2\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2", "show ?case"], ["proof (prove)\nusing this:\n  paval a1 ps = v1\n  paval a2 ps = v2\n  paval' (Div a1 a2) ps = Some v\n  paval' a1 ps = Some v1\n  paval' a2 ps = Some v2\n\ngoal (1 subgoal):\n 1. paval (Div a1 a2) ps = v", "by auto"], ["proof (state)\nthis:\n  paval (Div a1 a2) ps = v\n\ngoal (2 subgoals):\n 1. \\<And>x v. paval' (N x) ps = Some v \\<Longrightarrow> paval (N x) ps = v\n 2. \\<And>x v. paval' (V x) ps = Some v \\<Longrightarrow> paval (V x) ps = v", "qed simp_all"], ["", "fun pbval :: \"bexp \\<Rightarrow> partstate \\<Rightarrow> bool\" where\n\"pbval (Bc v) s = v\" |\n\"pbval (Not b) s = (\\<not> pbval b s)\" |\n\"pbval (And b\\<^sub>1 b\\<^sub>2) s = (pbval b\\<^sub>1 s \\<and> pbval b\\<^sub>2 s)\" |\n\"pbval (Less a\\<^sub>1 a\\<^sub>2) s = (paval a\\<^sub>1 s < paval a\\<^sub>2 s)\""], ["", "abbreviation optnot  where \"optnot a \\<equiv> (case a of None \\<Rightarrow> None | Some a' \\<Rightarrow> Some (~a'))\""], ["", "abbreviation optand  where \"optand a b \\<equiv> (case a of None \\<Rightarrow> None | Some a' \\<Rightarrow> (case b of None \\<Rightarrow> None | Some b' \\<Rightarrow> Some (a' \\<and> b'))) \""], ["", "abbreviation optless   where \"optless a b \\<equiv> (case a of None \\<Rightarrow> None | Some a' \\<Rightarrow> (case b of None \\<Rightarrow> None | Some b' \\<Rightarrow> Some (a' < b'))) \""], ["", "fun pbval' :: \"bexp \\<Rightarrow> partstate \\<Rightarrow> bool option\" where\n\"pbval' (Bc v) s = Some v\" |\n\"pbval' (Not b) s = (optnot (pbval' b s))\" |\n\"pbval' (And b\\<^sub>1 b\\<^sub>2) s = (optand (pbval' b\\<^sub>1 s) (pbval' b\\<^sub>2 s))\" |\n\"pbval' (Less a\\<^sub>1 a\\<^sub>2) s = (optless (paval' a\\<^sub>1 s) (paval' a\\<^sub>2 s))\""], ["", "lemma pbval'_pbval: \"vars a \\<subseteq> dom ps \\<Longrightarrow> pbval' a ps = Some (pbval a ps)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vars a \\<subseteq> dom ps \\<Longrightarrow>\n    pbval' a ps = Some (pbval a ps)", "apply(induct a)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       vars (Bc x) \\<subseteq> dom ps \\<Longrightarrow>\n       pbval' (Bc x) ps = Some (pbval (Bc x) ps)\n 2. \\<And>a.\n       \\<lbrakk>vars a \\<subseteq> dom ps \\<Longrightarrow>\n                pbval' a ps = Some (pbval a ps);\n        vars (bexp.Not a) \\<subseteq> dom ps\\<rbrakk>\n       \\<Longrightarrow> pbval' (bexp.Not a) ps =\n                         Some (pbval (bexp.Not a) ps)\n 3. \\<And>a1 a2.\n       \\<lbrakk>vars a1 \\<subseteq> dom ps \\<Longrightarrow>\n                pbval' a1 ps = Some (pbval a1 ps);\n        vars a2 \\<subseteq> dom ps \\<Longrightarrow>\n        pbval' a2 ps = Some (pbval a2 ps);\n        vars (And a1 a2) \\<subseteq> dom ps\\<rbrakk>\n       \\<Longrightarrow> pbval' (And a1 a2) ps = Some (pbval (And a1 a2) ps)\n 4. \\<And>x1a x2a.\n       vars (Less x1a x2a) \\<subseteq> dom ps \\<Longrightarrow>\n       pbval' (Less x1a x2a) ps = Some (pbval (Less x1a x2a) ps)", "apply (auto simp: paval'_paval)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma paval_aval_vars: \"vars a \\<subseteq> dom ps \\<Longrightarrow> paval a ps = aval a (emb ps s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vars a \\<subseteq> dom ps \\<Longrightarrow>\n    paval a ps = aval a (emb ps s)", "apply(induct a)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x.\n       vars (N x) \\<subseteq> dom ps \\<Longrightarrow>\n       paval (N x) ps = aval (N x) (emb ps s)\n 2. \\<And>x.\n       vars (V x) \\<subseteq> dom ps \\<Longrightarrow>\n       paval (V x) ps = aval (V x) (emb ps s)\n 3. \\<And>a1 a2.\n       \\<lbrakk>vars a1 \\<subseteq> dom ps \\<Longrightarrow>\n                paval a1 ps = aval a1 (emb ps s);\n        vars a2 \\<subseteq> dom ps \\<Longrightarrow>\n        paval a2 ps = aval a2 (emb ps s);\n        vars (Plus a1 a2) \\<subseteq> dom ps\\<rbrakk>\n       \\<Longrightarrow> paval (Plus a1 a2) ps =\n                         aval (Plus a1 a2) (emb ps s)\n 4. \\<And>a1 a2.\n       \\<lbrakk>vars a1 \\<subseteq> dom ps \\<Longrightarrow>\n                paval a1 ps = aval a1 (emb ps s);\n        vars a2 \\<subseteq> dom ps \\<Longrightarrow>\n        paval a2 ps = aval a2 (emb ps s);\n        vars (Times a1 a2) \\<subseteq> dom ps\\<rbrakk>\n       \\<Longrightarrow> paval (Times a1 a2) ps =\n                         aval (Times a1 a2) (emb ps s)\n 5. \\<And>a1 a2.\n       \\<lbrakk>vars a1 \\<subseteq> dom ps \\<Longrightarrow>\n                paval a1 ps = aval a1 (emb ps s);\n        vars a2 \\<subseteq> dom ps \\<Longrightarrow>\n        paval a2 ps = aval a2 (emb ps s);\n        vars (Div a1 a2) \\<subseteq> dom ps\\<rbrakk>\n       \\<Longrightarrow> paval (Div a1 a2) ps = aval (Div a1 a2) (emb ps s)", "by(auto simp: emb_def)"], ["", "lemma pbval_bval_vars: \"vars b \\<subseteq> dom ps \\<Longrightarrow> pbval b ps = bval b (emb ps s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vars b \\<subseteq> dom ps \\<Longrightarrow>\n    pbval b ps = bval b (emb ps s)", "apply(induct b)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       vars (Bc x) \\<subseteq> dom ps \\<Longrightarrow>\n       pbval (Bc x) ps = bval (Bc x) (emb ps s)\n 2. \\<And>b.\n       \\<lbrakk>vars b \\<subseteq> dom ps \\<Longrightarrow>\n                pbval b ps = bval b (emb ps s);\n        vars (bexp.Not b) \\<subseteq> dom ps\\<rbrakk>\n       \\<Longrightarrow> pbval (bexp.Not b) ps =\n                         bval (bexp.Not b) (emb ps s)\n 3. \\<And>b1 b2.\n       \\<lbrakk>vars b1 \\<subseteq> dom ps \\<Longrightarrow>\n                pbval b1 ps = bval b1 (emb ps s);\n        vars b2 \\<subseteq> dom ps \\<Longrightarrow>\n        pbval b2 ps = bval b2 (emb ps s);\n        vars (And b1 b2) \\<subseteq> dom ps\\<rbrakk>\n       \\<Longrightarrow> pbval (And b1 b2) ps = bval (And b1 b2) (emb ps s)\n 4. \\<And>x1a x2a.\n       vars (Less x1a x2a) \\<subseteq> dom ps \\<Longrightarrow>\n       pbval (Less x1a x2a) ps = bval (Less x1a x2a) (emb ps s)", "apply (simp_all)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x1a x2a.\n       vars x1a \\<subseteq> dom ps \\<and>\n       vars x2a \\<subseteq> dom ps \\<Longrightarrow>\n       (paval x1a ps < paval x2a ps) =\n       (aval x1a (emb ps s) < aval x2a (emb ps s))", "using paval_aval_vars[where s=s]"], ["proof (prove)\nusing this:\n  vars ?a \\<subseteq> dom ?ps \\<Longrightarrow>\n  paval ?a ?ps = aval ?a (emb ?ps s)\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2a.\n       vars x1a \\<subseteq> dom ps \\<and>\n       vars x2a \\<subseteq> dom ps \\<Longrightarrow>\n       (paval x1a ps < paval x2a ps) =\n       (aval x1a (emb ps s) < aval x2a (emb ps s))", "by auto"], ["", "lemma paval'dom: \"paval' a ps = Some v \\<Longrightarrow> vars a \\<subseteq> dom ps\""], ["proof (prove)\ngoal (1 subgoal):\n 1. paval' a ps = Some v \\<Longrightarrow> vars a \\<subseteq> dom ps", "proof (induct a arbitrary: v)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Plus a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "case (Plus a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (5 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Plus a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Plus a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 5. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "then"], ["proof (chain)\npicking this:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Plus a1 a2) ps = Some v", "show ?case"], ["proof (prove)\nusing this:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Plus a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. vars (Plus a1 a2) \\<subseteq> dom ps", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        optplus (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y\n 2. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        optplus (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y", "apply fastforce"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        optplus (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y", "by (metis (no_types, lifting) domD option.case_eq_if option.collapse subset_iff)"], ["proof (state)\nthis:\n  vars (Plus a1 a2) \\<subseteq> dom ps\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "case (Times a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Times a1 a2) ps = Some v\n\ngoal (4 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Times a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Times a1 a2) \\<subseteq> dom ps\n 4. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "then"], ["proof (chain)\npicking this:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Times a1 a2) ps = Some v", "show ?case"], ["proof (prove)\nusing this:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Times a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. vars (Times a1 a2) \\<subseteq> dom ps", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        opttimes (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y\n 2. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        opttimes (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y", "apply fastforce"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        opttimes (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y", "by (metis (no_types, lifting) domD option.case_eq_if option.collapse subset_iff)"], ["proof (state)\nthis:\n  vars (Times a1 a2) \\<subseteq> dom ps\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "case (Div a1 a2)"], ["proof (state)\nthis:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Div a1 a2) ps = Some v\n\ngoal (3 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps\n 3. \\<And>a1 a2 v.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        paval' (Div a1 a2) ps = Some v\\<rbrakk>\n       \\<Longrightarrow> vars (Div a1 a2) \\<subseteq> dom ps", "then"], ["proof (chain)\npicking this:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Div a1 a2) ps = Some v", "show ?case"], ["proof (prove)\nusing this:\n  paval' a1 ps = Some ?v \\<Longrightarrow> vars a1 \\<subseteq> dom ps\n  paval' a2 ps = Some ?v \\<Longrightarrow> vars a2 \\<subseteq> dom ps\n  paval' (Div a1 a2) ps = Some v\n\ngoal (1 subgoal):\n 1. vars (Div a1 a2) \\<subseteq> dom ps", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        optdiv (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y\n 2. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        optdiv (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y", "apply fastforce"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>v.\n                   paval' a1 ps = Some v \\<Longrightarrow>\n                   vars a1 \\<subseteq> dom ps;\n        \\<And>v.\n           paval' a2 ps = Some v \\<Longrightarrow>\n           vars a2 \\<subseteq> dom ps;\n        optdiv (paval' a1 ps) (paval' a2 ps) = Some v;\n        x \\<in> vars a2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. ps x = Some y", "by (metis (no_types, lifting) domD option.case_eq_if option.collapse subset_iff)"], ["proof (state)\nthis:\n  vars (Div a1 a2) \\<subseteq> dom ps\n\ngoal (2 subgoals):\n 1. \\<And>x v.\n       paval' (N x) ps = Some v \\<Longrightarrow>\n       vars (N x) \\<subseteq> dom ps\n 2. \\<And>x v.\n       paval' (V x) ps = Some v \\<Longrightarrow>\n       vars (V x) \\<subseteq> dom ps", "qed auto"], ["", "end"]]}