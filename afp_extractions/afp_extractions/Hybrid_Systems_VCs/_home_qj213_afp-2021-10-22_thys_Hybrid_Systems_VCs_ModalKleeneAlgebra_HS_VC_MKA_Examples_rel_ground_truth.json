{"file_name": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs/ModalKleeneAlgebra/HS_VC_MKA_Examples_rel.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs", "problem_names": ["lemma pendulum_dyn:\n  \"\\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil> \\<le> wp (EVOL \\<phi> G T) \\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil>\"", "lemma pendulum_inv:\n  \"\\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil>\"", "lemma local_flow_pend: \"local_flow f UNIV UNIV \\<phi>\"", "lemma pendulum_flow:\n  \"\\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil>\"", "lemma inv_imp_pos_le[bb_real_arith]:\n  assumes \"0 > g\" and inv: \"2 * g * x - 2 * g * h = v * v\"\n  shows \"(x::real) \\<le> h\"", "lemma bouncing_ball_inv:\n  fixes h::real\n  shows \"g < 0 \\<Longrightarrow> h \\<ge> 0 \\<Longrightarrow> \\<lceil>\\<lambda>s. s$1 = h \\<and> s$2 = 0\\<rceil> \\<le>\n  wp\n    (LOOP\n      ((x\\<acute>= f g & (\\<lambda> s. s$1 \\<ge> 0) DINV (\\<lambda>s. 2 * g * s$1 - 2 * g * h - s$2 * s$2 = 0));\n       (IF (\\<lambda> s. s$1 = 0) THEN (2 ::= (\\<lambda>s. - s$2)) ELSE skip))\n    INV (\\<lambda>s. 0 \\<le> s$1 \\<and> 2 * g * s$1 - 2 * g * h - s$2 * s$2 = 0)\n  ) \\<lceil>\\<lambda>s. 0 \\<le> s$1 \\<and> s$1 \\<le> h\\<rceil>\"", "lemma inv_conserv_at_ground[bb_real_arith]:\n  assumes invar: \"2 * g * x = 2 * g * h + v * v\"\n    and pos: \"g * \\<tau>\\<^sup>2 / 2 + v * \\<tau> + (x::real) = 0\"\n  shows \"2 * g * h + (g * \\<tau> * (g * \\<tau> + v) + v * (g * \\<tau> + v)) = 0\"", "lemma inv_conserv_at_air[bb_real_arith]:\n  assumes invar: \"2 * g * x = 2 * g * h + v * v\"\n  shows \"2 * g * (g * \\<tau>\\<^sup>2 / 2 + v * \\<tau> + (x::real)) =\n  2 * g * h + (g * \\<tau> * (g * \\<tau> + v) + v * (g * \\<tau> + v))\" (is \"?lhs = ?rhs\")", "lemma bouncing_ball_dyn:\n  fixes h::real\n  assumes \"g < 0\" and \"h \\<ge> 0\"\n  shows \"g < 0 \\<Longrightarrow> h \\<ge> 0 \\<Longrightarrow>\n  \\<lceil>\\<lambda>s. s$1 = h \\<and> s$2 = 0\\<rceil> \\<le> wp\n    (LOOP\n      ((EVOL (\\<phi> g) (\\<lambda>s. 0 \\<le> s$1) T);\n      (IF (\\<lambda> s. s$1 = 0) THEN (2 ::= (\\<lambda>s. - s$2)) ELSE skip))\n    INV (\\<lambda>s. 0 \\<le> s$1 \\<and> 2 * g * s$1 = 2 * g * h + s$2 * s$2))\n  \\<lceil>\\<lambda>s. 0 \\<le> s$1 \\<and> s$1 \\<le> h\\<rceil>\"", "lemma local_flow_ball: \"local_flow (f g) UNIV UNIV (\\<phi> g)\"", "lemma bouncing_ball_flow:\n  fixes h::real\n  assumes \"g < 0\" and \"h \\<ge> 0\"\n  shows \"g < 0 \\<Longrightarrow> h \\<ge> 0 \\<Longrightarrow>\n  \\<lceil>\\<lambda>s. s$1 = h \\<and> s$2 = 0\\<rceil> \\<le> wp\n    (LOOP\n      ((x\\<acute>= (\\<lambda>t. f g) & (\\<lambda> s. s$1 \\<ge> 0) on (\\<lambda>s. UNIV) UNIV @ 0);\n      (IF (\\<lambda> s. s$1 = 0) THEN (2 ::= (\\<lambda>s. - s$2)) ELSE skip))\n    INV (\\<lambda>s. 0 \\<le> s$1 \\<and> 2 * g * s$1 = 2 * g * h + s$2 * s$2))\n  \\<lceil>\\<lambda>s. 0 \\<le> s$1 \\<and> s$1 \\<le> h\\<rceil>\"", "lemma norm_diff_temp_dyn: \"0 < a \\<Longrightarrow> \\<parallel>f a L s\\<^sub>1 - f a L s\\<^sub>2\\<parallel> = \\<bar>a\\<bar> * \\<bar>s\\<^sub>1$1 - s\\<^sub>2$1\\<bar>\"", "lemma local_lipschitz_temp_dyn:\n  assumes \"0 < (a::real)\"\n  shows \"local_lipschitz UNIV UNIV (\\<lambda>t::real. f a L)\"", "lemma local_flow_temp: \"a > 0 \\<Longrightarrow> local_flow (f a L) UNIV UNIV (\\<phi> a L)\"", "lemma temp_dyn_down_real_arith:\n  assumes \"a > 0\" and Thyps: \"0 < Tmin\" \"Tmin \\<le> T\" \"T \\<le> Tmax\"\n    and thyps: \"0 \\<le> (t::real)\" \"\\<forall>\\<tau>\\<in>{0..t}. \\<tau> \\<le> - (ln (Tmin / T) / a) \"\n  shows \"Tmin \\<le> exp (-a * t) * T\" and \"exp (-a * t) * T \\<le> Tmax\"", "lemma temp_dyn_up_real_arith:\n  assumes \"a > 0\" and Thyps: \"Tmin \\<le> T\" \"T \\<le> Tmax\" \"Tmax < (L::real)\"\n    and thyps: \"0 \\<le> t\" \"\\<forall>\\<tau>\\<in>{0..t}. \\<tau> \\<le> - (ln ((L - Tmax) / (L - T)) / a) \"\n  shows \"L - Tmax \\<le> exp (-(a * t)) * (L - T)\"\n    and \"L - exp (-(a * t)) * (L - T) \\<le> Tmax\"\n    and \"Tmin \\<le> L - exp (-(a * t)) * (L - T)\"", "lemmas fbox_temp_dyn = local_flow.wp_g_ode_subset[OF local_flow_temp]", "lemma thermostat:\n  assumes \"a > 0\" and \"0 < Tmin\" and \"Tmax < L\"\n  shows \"\\<lceil>\\<lambda>s. Tmin \\<le> s$1 \\<and> s$1 \\<le> Tmax \\<and> s$4 = 0\\<rceil> \\<le> wp\n  (LOOP\n    \\<comment> \\<open>control\\<close>\n    ((2 ::= (\\<lambda>s. 0));(3 ::= (\\<lambda>s. s$1));\n    (IF (\\<lambda>s. s$4 = 0 \\<and> s$3 \\<le> Tmin + 1) THEN (4 ::= (\\<lambda>s.1)) ELSE\n    (IF (\\<lambda>s. s$4 = 1 \\<and> s$3 \\<ge> Tmax - 1) THEN (4 ::= (\\<lambda>s.0)) ELSE skip));\n    \\<comment> \\<open>dynamics\\<close>\n    (IF (\\<lambda>s. s$4 = 0) THEN (x\\<acute>= f a 0 & (\\<lambda>s. s$2 \\<le> - (ln (Tmin/s$3))/a))\n    ELSE (x\\<acute>= f a L & (\\<lambda>s. s$2 \\<le> - (ln ((L-Tmax)/(L-s$3)))/a))) )\n  INV (\\<lambda>s. Tmin \\<le>s$1 \\<and> s$1 \\<le> Tmax \\<and> (s$4 = 0 \\<or> s$4 = 1)))\n  \\<lceil>\\<lambda>s. Tmin \\<le> s$1 \\<and> s$1 \\<le> Tmax\\<rceil>\"", "lemma local_flow_tank: \"local_flow (f k) UNIV UNIV (\\<phi> k)\"", "lemma tank_arith:\n  assumes \"0 \\<le> (\\<tau>::real)\" and \"0 < c\\<^sub>o\" and \"c\\<^sub>o < c\\<^sub>i\"\n  shows \"\\<forall>\\<tau>\\<in>{0..\\<tau>}. \\<tau> \\<le> - ((hmin - y) / c\\<^sub>o) \\<Longrightarrow>  hmin \\<le> y - c\\<^sub>o * \\<tau>\"\n    and \"\\<forall>\\<tau>\\<in>{0..\\<tau>}. \\<tau> \\<le> (hmax - y) / (c\\<^sub>i - c\\<^sub>o) \\<Longrightarrow>  (c\\<^sub>i - c\\<^sub>o) * \\<tau> + y \\<le> hmax\"\n    and \"hmin \\<le> y \\<Longrightarrow> hmin \\<le> (c\\<^sub>i - c\\<^sub>o) * \\<tau> + y\"\n    and \"y \\<le> hmax \\<Longrightarrow> y - c\\<^sub>o * \\<tau> \\<le> hmax\"", "lemma tank_flow:\n  assumes \"0 < c\\<^sub>o\" and \"c\\<^sub>o < c\\<^sub>i\"\n  shows \"\\<lceil>\\<lambda>s. I hmin hmax s\\<rceil> \\<le> wp\n  (LOOP \n    \\<comment> \\<open>control\\<close>\n    ((2 ::=(\\<lambda>s.0));(3 ::=(\\<lambda>s. s$1));\n    (IF (\\<lambda>s. s$4 = 0 \\<and> s$3 \\<le> hmin + 1) THEN (4 ::= (\\<lambda>s.1)) ELSE \n    (IF (\\<lambda>s. s$4 = 1 \\<and> s$3 \\<ge> hmax - 1) THEN (4 ::= (\\<lambda>s.0)) ELSE skip));\n    \\<comment> \\<open>dynamics\\<close>\n    (IF (\\<lambda>s. s$4 = 0) THEN (x\\<acute>= f (c\\<^sub>i-c\\<^sub>o) & (G hmax (c\\<^sub>i-c\\<^sub>o))) \n     ELSE (x\\<acute>= f (-c\\<^sub>o) & (G hmin (-c\\<^sub>o)))) ) INV I hmin hmax) \n  \\<lceil>\\<lambda>s. I hmin hmax s\\<rceil>\""], "translations": [["", "lemma pendulum_dyn:\n  \"\\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil> \\<le> wp (EVOL \\<phi> G T) \\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               r\\<^sup>2 = (s $ 1)\\<^sup>2 + (s $ 2)\\<^sup>2\\<rceil>\n    \\<subseteq> wp (EVOL \\<phi> G T)\n                 \\<lceil>\\<lambda>s.\n                            r\\<^sup>2 =\n                            (s $ 1)\\<^sup>2 + (s $ 2)\\<^sup>2\\<rceil>", "by simp\n\n\\<comment> \\<open>Verified with differential invariants. \\<close>"], ["", "lemma pendulum_inv:\n  \"\\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               r\\<^sup>2 = (s $ 1)\\<^sup>2 + (s $ 2)\\<^sup>2\\<rceil>\n    \\<subseteq> wp x\\<acute>=\\<lambda>t.\n                                f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n                 \\<lceil>\\<lambda>s.\n                            r\\<^sup>2 =\n                            (s $ 1)\\<^sup>2 + (s $ 2)\\<^sup>2\\<rceil>", "by (auto intro!: poly_derivatives diff_invariant_rules)\n\n\\<comment> \\<open>Verified with the flow. \\<close>"], ["", "lemma local_flow_pend: \"local_flow f UNIV UNIV \\<phi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. local_flow f UNIV UNIV \\<phi>", "apply(unfold_locales, simp_all add: local_lipschitz_def lipschitz_on_def vec_eq_iff, clarsimp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x t.\n       \\<exists>u>0.\n          (\\<exists>ta. dist t ta \\<le> u) \\<longrightarrow>\n          (\\<exists>L\\<ge>0.\n              \\<forall>xa\\<in>cball x u.\n                 \\<forall>y\\<in>cball x u.\n                    dist (f xa) (f y) \\<le> L \\<cdot> dist xa y)\n 2. \\<And>t s.\n       \\<forall>i.\n           D (\\<lambda>x.\n                 if i = 1 then s $ 1 \\<cdot> cos x + s $ 2 \\<cdot> sin x\n                 else - s $ 1 \\<cdot> sin x +\n                      s $ 2 \\<cdot>\n                      cos x) = (\\<lambda>x.\n                                   if i = 1 then \\<phi> x s $ 2\n                                   else - \\<phi> x s $ 1)\n           on {0--t}\n 3. \\<And>s. \\<forall>i. i \\<noteq> 1 \\<longrightarrow> s $ 2 = s $ i", "apply(rule_tac x=\"1\" in exI, clarsimp, rule_tac x=1 in exI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x t ta.\n       dist t ta \\<le> 1 \\<Longrightarrow>\n       0 \\<le> 1 \\<and>\n       (\\<forall>xa\\<in>cball x 1.\n           \\<forall>y\\<in>cball x 1.\n              dist (f xa) (f y) \\<le> 1 \\<cdot> dist xa y)\n 2. \\<And>t s.\n       \\<forall>i.\n           D (\\<lambda>x.\n                 if i = 1 then s $ 1 \\<cdot> cos x + s $ 2 \\<cdot> sin x\n                 else - s $ 1 \\<cdot> sin x +\n                      s $ 2 \\<cdot>\n                      cos x) = (\\<lambda>x.\n                                   if i = 1 then \\<phi> x s $ 2\n                                   else - \\<phi> x s $ 1)\n           on {0--t}\n 3. \\<And>s. \\<forall>i. i \\<noteq> 1 \\<longrightarrow> s $ 2 = s $ i", "apply(simp add: dist_norm norm_vec_def L2_set_def power2_commute UNIV_2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t s.\n       \\<forall>i.\n           D (\\<lambda>x.\n                 if i = 1 then s $ 1 \\<cdot> cos x + s $ 2 \\<cdot> sin x\n                 else - s $ 1 \\<cdot> sin x +\n                      s $ 2 \\<cdot>\n                      cos x) = (\\<lambda>x.\n                                   if i = 1 then \\<phi> x s $ 2\n                                   else - \\<phi> x s $ 1)\n           on {0--t}\n 2. \\<And>s. \\<forall>i. i \\<noteq> 1 \\<longrightarrow> s $ 2 = s $ i", "by (auto simp: forall_2 intro!: poly_derivatives)"], ["", "lemma pendulum_flow:\n  \"\\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>\\<lambda>s. r\\<^sup>2 = (s$1)\\<^sup>2 + (s$2)\\<^sup>2\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               r\\<^sup>2 = (s $ 1)\\<^sup>2 + (s $ 2)\\<^sup>2\\<rceil>\n    \\<subseteq> wp x\\<acute>=\\<lambda>t.\n                                f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n                 \\<lceil>\\<lambda>s.\n                            r\\<^sup>2 =\n                            (s $ 1)\\<^sup>2 + (s $ 2)\\<^sup>2\\<rceil>", "by (simp add: local_flow.wp_g_ode_subset[OF local_flow_pend])"], ["", "no_notation fpend (\"f\")\n        and pend_flow (\"\\<phi>\")"], ["", "subsubsection\\<open> Bouncing Ball \\<close>"], ["", "text \\<open> A ball is dropped from rest at an initial height @{text \"h\"}. The motion is described with\nthe free-fall equations @{text \"x' t = v t\"} and @{text \"v' t = g\"} where @{text \"g\"} is the\nconstant acceleration due to gravity. The bounce is modelled with a variable assignment that\nflips the velocity. That is, we model it as a completely elastic collision with the ground. We use \n@{text \"s$1\"} to represent the ball's height and @{text \"s$2\"} for its velocity. We prove that the \nball remains above ground and below its initial resting position. \\<close>"], ["", "abbreviation fball :: \"real \\<Rightarrow> real^2 \\<Rightarrow> real^2\" (\"f\")\n  where \"f g s \\<equiv> (\\<chi> i. if i = 1 then s$2 else g)\""], ["", "abbreviation ball_flow :: \"real \\<Rightarrow> real \\<Rightarrow> real^2 \\<Rightarrow> real^2\" (\"\\<phi>\")\n  where \"\\<phi> g t s \\<equiv> (\\<chi> i. if i = 1 then g * t ^ 2/2 + s$2 * t + s$1 else g * t + s$2)\"\n\n\\<comment> \\<open>Verified with differential invariants. \\<close>"], ["", "named_theorems bb_real_arith \"real arithmetic properties for the bouncing ball.\""], ["", "lemma inv_imp_pos_le[bb_real_arith]:\n  assumes \"0 > g\" and inv: \"2 * g * x - 2 * g * h = v * v\"\n  shows \"(x::real) \\<le> h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> h", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<le> h", "have \"v * v = 2 * g * x - 2 * g * h \\<and> 0 > g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v \\<cdot> v = 2 \\<cdot> g \\<cdot> x - 2 \\<cdot> g \\<cdot> h \\<and> g < 0", "using inv and \\<open>0 > g\\<close>"], ["proof (prove)\nusing this:\n  2 \\<cdot> g \\<cdot> x - 2 \\<cdot> g \\<cdot> h = v \\<cdot> v\n  g < 0\n\ngoal (1 subgoal):\n 1. v \\<cdot> v = 2 \\<cdot> g \\<cdot> x - 2 \\<cdot> g \\<cdot> h \\<and> g < 0", "by auto"], ["proof (state)\nthis:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> x - 2 \\<cdot> g \\<cdot> h \\<and> g < 0\n\ngoal (1 subgoal):\n 1. x \\<le> h", "hence obs:\"v * v = 2 * g * (x - h) \\<and> 0 > g \\<and> v * v \\<ge> 0\""], ["proof (prove)\nusing this:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> x - 2 \\<cdot> g \\<cdot> h \\<and> g < 0\n\ngoal (1 subgoal):\n 1. v \\<cdot> v = 2 \\<cdot> g \\<cdot> (x - h) \\<and>\n    g < 0 \\<and> 0 \\<le> v \\<cdot> v", "using left_diff_distrib mult.commute"], ["proof (prove)\nusing this:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> x - 2 \\<cdot> g \\<cdot> h \\<and> g < 0\n  (?a - ?b) \\<cdot> ?c = ?a \\<cdot> ?c - ?b \\<cdot> ?c\n  ?a \\<cdot> ?b = ?b \\<cdot> ?a\n\ngoal (1 subgoal):\n 1. v \\<cdot> v = 2 \\<cdot> g \\<cdot> (x - h) \\<and>\n    g < 0 \\<and> 0 \\<le> v \\<cdot> v", "by (metis zero_le_square)"], ["proof (state)\nthis:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> (x - h) \\<and>\n  g < 0 \\<and> 0 \\<le> v \\<cdot> v\n\ngoal (1 subgoal):\n 1. x \\<le> h", "hence \"(v * v)/(2 * g) = (x - h)\""], ["proof (prove)\nusing this:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> (x - h) \\<and>\n  g < 0 \\<and> 0 \\<le> v \\<cdot> v\n\ngoal (1 subgoal):\n 1. v \\<cdot> v / (2 \\<cdot> g) = x - h", "by auto"], ["proof (state)\nthis:\n  v \\<cdot> v / (2 \\<cdot> g) = x - h\n\ngoal (1 subgoal):\n 1. x \\<le> h", "also"], ["proof (state)\nthis:\n  v \\<cdot> v / (2 \\<cdot> g) = x - h\n\ngoal (1 subgoal):\n 1. x \\<le> h", "from obs"], ["proof (chain)\npicking this:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> (x - h) \\<and>\n  g < 0 \\<and> 0 \\<le> v \\<cdot> v", "have \"(v * v)/(2 * g) \\<le> 0\""], ["proof (prove)\nusing this:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> (x - h) \\<and>\n  g < 0 \\<and> 0 \\<le> v \\<cdot> v\n\ngoal (1 subgoal):\n 1. v \\<cdot> v / (2 \\<cdot> g) \\<le> 0", "using divide_nonneg_neg"], ["proof (prove)\nusing this:\n  v \\<cdot> v = 2 \\<cdot> g \\<cdot> (x - h) \\<and>\n  g < 0 \\<and> 0 \\<le> v \\<cdot> v\n  \\<lbrakk>(0::?'a) \\<le> ?x; ?y < (0::?'a)\\<rbrakk>\n  \\<Longrightarrow> ?x / ?y \\<le> (0::?'a)\n\ngoal (1 subgoal):\n 1. v \\<cdot> v / (2 \\<cdot> g) \\<le> 0", "by fastforce"], ["proof (state)\nthis:\n  v \\<cdot> v / (2 \\<cdot> g) \\<le> 0\n\ngoal (1 subgoal):\n 1. x \\<le> h", "ultimately"], ["proof (chain)\npicking this:\n  v \\<cdot> v / (2 \\<cdot> g) = x - h\n  v \\<cdot> v / (2 \\<cdot> g) \\<le> 0", "have \"h - x \\<ge> 0\""], ["proof (prove)\nusing this:\n  v \\<cdot> v / (2 \\<cdot> g) = x - h\n  v \\<cdot> v / (2 \\<cdot> g) \\<le> 0\n\ngoal (1 subgoal):\n 1. 0 \\<le> h - x", "by linarith"], ["proof (state)\nthis:\n  0 \\<le> h - x\n\ngoal (1 subgoal):\n 1. x \\<le> h", "thus ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> h - x\n\ngoal (1 subgoal):\n 1. x \\<le> h", "by auto"], ["proof (state)\nthis:\n  x \\<le> h\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bouncing_ball_inv:\n  fixes h::real\n  shows \"g < 0 \\<Longrightarrow> h \\<ge> 0 \\<Longrightarrow> \\<lceil>\\<lambda>s. s$1 = h \\<and> s$2 = 0\\<rceil> \\<le>\n  wp\n    (LOOP\n      ((x\\<acute>= f g & (\\<lambda> s. s$1 \\<ge> 0) DINV (\\<lambda>s. 2 * g * s$1 - 2 * g * h - s$2 * s$2 = 0));\n       (IF (\\<lambda> s. s$1 = 0) THEN (2 ::= (\\<lambda>s. - s$2)) ELSE skip))\n    INV (\\<lambda>s. 0 \\<le> s$1 \\<and> 2 * g * s$1 - 2 * g * h - s$2 * s$2 = 0)\n  ) \\<lceil>\\<lambda>s. 0 \\<le> s$1 \\<and> s$1 \\<le> h\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>g < 0; 0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>\\<lambda>s. s $ 1 = h \\<and> s $ 2 = 0\\<rceil>\n                      \\<subseteq> wp (LOOP x\\<acute>=\\<lambda>t.\n                  f g & \\<lambda>s.\n                           0 \\<le> s $\n                                   1 on \\<lambda>s.\n     {t. 0 \\<le> t} UNIV @ 0 DINV \\<lambda>s.\n                                     2 \\<cdot> g \\<cdot> s $ 1 -\n                                     2 \\<cdot> g \\<cdot> h -\n                                     s $ 2 \\<cdot> s $ 2 =\n                                     0  ;\n     (IF (\\<lambda>s.\n             s $ 1 =\n             0) THEN (2 ::= (\\<lambda>s.\n                                - s $\n                                  2)) ELSE skip) INV (\\<lambda>s.\n                   0 \\<le> s $ 1 \\<and>\n                   2 \\<cdot> g \\<cdot> s $ 1 - 2 \\<cdot> g \\<cdot> h -\n                   s $ 2 \\<cdot> s $ 2 =\n                   0) )\n                                   \\<lceil>\\<lambda>s.\n        0 \\<le> s $ 1 \\<and> s $ 1 \\<le> h\\<rceil>", "apply(rule wp_loopI, simp_all, force simp: bb_real_arith)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>g < 0; 0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>\\<lambda>s.\n                                 0 \\<le> s $ 1 \\<and>\n                                 2 \\<cdot> g \\<cdot> s $ 1 -\n                                 2 \\<cdot> g \\<cdot> h =\n                                 s $ 2 \\<cdot> s $ 2\\<rceil>\n                      \\<subseteq> wp x\\<acute>=\\<lambda>t.\n            f g & \\<lambda>s.\n                     0 \\<le> s $\n                             1 on \\<lambda>s.\n                                     Collect\n((\\<le>)\n  0) UNIV @ 0 DINV \\<lambda>s.\n                      2 \\<cdot> g \\<cdot> s $ 1 - 2 \\<cdot> g \\<cdot> h =\n                      s $ 2 \\<cdot> s $ 2 \n                                   \\<lceil>\\<lambda>s.\n        (s $ 1 = 0 \\<longrightarrow>\n         - (2 \\<cdot> g \\<cdot> h) = s $ 2 \\<cdot> s $ 2) \\<and>\n        (s $ 1 = 0 \\<or>\n         0 \\<le> s $ 1 \\<and>\n         2 \\<cdot> g \\<cdot> s $ 1 - 2 \\<cdot> g \\<cdot> h =\n         s $ 2 \\<cdot> s $ 2)\\<rceil>", "by (rule wp_g_odei) (auto intro!: poly_derivatives diff_invariant_rules)\n\n\\<comment> \\<open>Verified with annotated dynamics. \\<close>"], ["", "lemma inv_conserv_at_ground[bb_real_arith]:\n  assumes invar: \"2 * g * x = 2 * g * h + v * v\"\n    and pos: \"g * \\<tau>\\<^sup>2 / 2 + v * \\<tau> + (x::real) = 0\"\n  shows \"2 * g * h + (g * \\<tau> * (g * \\<tau> + v) + v * (g * \\<tau> + v)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    0", "from pos"], ["proof (chain)\npicking this:\n  g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x = 0", "have \"g * \\<tau>\\<^sup>2  + 2 * v * \\<tau> + 2 * x = 0\""], ["proof (prove)\nusing this:\n  g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x = 0\n\ngoal (1 subgoal):\n 1. g \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> v \\<cdot> \\<tau> + 2 \\<cdot> x = 0", "by auto"], ["proof (state)\nthis:\n  g \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> v \\<cdot> \\<tau> + 2 \\<cdot> x = 0\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    0", "then"], ["proof (chain)\npicking this:\n  g \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> v \\<cdot> \\<tau> + 2 \\<cdot> x = 0", "have \"g\\<^sup>2 * \\<tau>\\<^sup>2  + 2 * g * v * \\<tau> + 2 * g * x = 0\""], ["proof (prove)\nusing this:\n  g \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> v \\<cdot> \\<tau> + 2 \\<cdot> x = 0\n\ngoal (1 subgoal):\n 1. g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> x =\n    0", "by (metis (mono_tags, hide_lams) Groups.mult_ac(1,3) mult_zero_right\n        monoid_mult_class.power2_eq_square semiring_class.distrib_left)"], ["proof (state)\nthis:\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> x =\n  0\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    0", "hence \"g\\<^sup>2 * \\<tau>\\<^sup>2 + 2 * g * v * \\<tau> + v\\<^sup>2 + 2 * g * h = 0\""], ["proof (prove)\nusing this:\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> x =\n  0\n\ngoal (1 subgoal):\n 1. g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    v\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> h =\n    0", "using invar"], ["proof (prove)\nusing this:\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> x =\n  0\n  2 \\<cdot> g \\<cdot> x = 2 \\<cdot> g \\<cdot> h + v \\<cdot> v\n\ngoal (1 subgoal):\n 1. g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    v\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> h =\n    0", "by (simp add: monoid_mult_class.power2_eq_square)"], ["proof (state)\nthis:\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  v\\<^sup>2 +\n  2 \\<cdot> g \\<cdot> h =\n  0\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    0", "hence obs: \"(g * \\<tau> + v)\\<^sup>2 + 2 * g * h = 0\""], ["proof (prove)\nusing this:\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  v\\<^sup>2 +\n  2 \\<cdot> g \\<cdot> h =\n  0\n\ngoal (1 subgoal):\n 1. (g \\<cdot> \\<tau> + v)\\<^sup>2 + 2 \\<cdot> g \\<cdot> h = 0", "apply(subst power2_sum)"], ["proof (prove)\ngoal (1 subgoal):\n 1. g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    v\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> h =\n    0 \\<Longrightarrow>\n    (g \\<cdot> \\<tau>)\\<^sup>2 + v\\<^sup>2 +\n    2 \\<cdot> (g \\<cdot> \\<tau>) \\<cdot> v +\n    2 \\<cdot> g \\<cdot> h =\n    0", "by (metis (no_types, hide_lams) Groups.add_ac(2, 3)\n        Groups.mult_ac(2, 3) monoid_mult_class.power2_eq_square nat_distrib(2))"], ["proof (state)\nthis:\n  (g \\<cdot> \\<tau> + v)\\<^sup>2 + 2 \\<cdot> g \\<cdot> h = 0\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    0", "thus \"2 * g * h + (g * \\<tau> * (g * \\<tau> + v) + v * (g * \\<tau> + v)) = 0\""], ["proof (prove)\nusing this:\n  (g \\<cdot> \\<tau> + v)\\<^sup>2 + 2 \\<cdot> g \\<cdot> h = 0\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    0", "by (simp add: monoid_mult_class.power2_eq_square)"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma inv_conserv_at_air[bb_real_arith]:\n  assumes invar: \"2 * g * x = 2 * g * h + v * v\"\n  shows \"2 * g * (g * \\<tau>\\<^sup>2 / 2 + v * \\<tau> + (x::real)) =\n  2 * g * h + (g * \\<tau> * (g * \\<tau> + v) + v * (g * \\<tau> + v))\" (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "have \"?lhs = g\\<^sup>2 * \\<tau>\\<^sup>2 + 2 * g * v * \\<tau> + 2 * g * x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> x", "by(auto simp: algebra_simps semiring_normalization_rules(29))"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> x\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "also"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> x\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "have \"... = g\\<^sup>2 * \\<tau>\\<^sup>2 + 2 * g * v * \\<tau> + 2 * g * h + v * v\" (is \"... = ?middle\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> x =\n    g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> h +\n    v \\<cdot> v", "by(subst invar, simp)"], ["proof (state)\nthis:\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> x =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "finally"], ["proof (chain)\npicking this:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v", "have \"?lhs = ?middle\""], ["proof (prove)\nusing this:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> h +\n    v \\<cdot> v", "."], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "moreover"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "{"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "have \"?rhs = g * g * (\\<tau> * \\<tau>) + 2 * g * v * \\<tau> + 2 * g * h + v * v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    g \\<cdot> g \\<cdot> (\\<tau> \\<cdot> \\<tau>) +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> h +\n    v \\<cdot> v", "by (simp add: Groups.mult_ac(2,3) semiring_class.distrib_left)"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g \\<cdot> g \\<cdot> (\\<tau> \\<cdot> \\<tau>) +\n  2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "also"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g \\<cdot> g \\<cdot> (\\<tau> \\<cdot> \\<tau>) +\n  2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "have \"... = ?middle\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g \\<cdot> g \\<cdot> (\\<tau> \\<cdot> \\<tau>) +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> h +\n    v \\<cdot> v =\n    g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> h +\n    v \\<cdot> v", "by (simp add: semiring_normalization_rules(29))"], ["proof (state)\nthis:\n  g \\<cdot> g \\<cdot> (\\<tau> \\<cdot> \\<tau>) +\n  2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "finally"], ["proof (chain)\npicking this:\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v", "have \"?rhs = ?middle\""], ["proof (prove)\nusing this:\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n    g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 +\n    2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n    2 \\<cdot> g \\<cdot> h +\n    v \\<cdot> v", "."], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "}"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "ultimately"], ["proof (chain)\npicking this:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v", "show ?thesis"], ["proof (prove)\nusing this:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v)) =\n  g\\<^sup>2 \\<cdot> \\<tau>\\<^sup>2 + 2 \\<cdot> g \\<cdot> v \\<cdot> \\<tau> +\n  2 \\<cdot> g \\<cdot> h +\n  v \\<cdot> v\n\ngoal (1 subgoal):\n 1. 2 \\<cdot> g \\<cdot>\n    (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n    2 \\<cdot> g \\<cdot> h +\n    (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n     v \\<cdot> (g \\<cdot> \\<tau> + v))", "by auto"], ["proof (state)\nthis:\n  2 \\<cdot> g \\<cdot>\n  (g \\<cdot> \\<tau>\\<^sup>2 / 2 + v \\<cdot> \\<tau> + x) =\n  2 \\<cdot> g \\<cdot> h +\n  (g \\<cdot> \\<tau> \\<cdot> (g \\<cdot> \\<tau> + v) +\n   v \\<cdot> (g \\<cdot> \\<tau> + v))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bouncing_ball_dyn:\n  fixes h::real\n  assumes \"g < 0\" and \"h \\<ge> 0\"\n  shows \"g < 0 \\<Longrightarrow> h \\<ge> 0 \\<Longrightarrow>\n  \\<lceil>\\<lambda>s. s$1 = h \\<and> s$2 = 0\\<rceil> \\<le> wp\n    (LOOP\n      ((EVOL (\\<phi> g) (\\<lambda>s. 0 \\<le> s$1) T);\n      (IF (\\<lambda> s. s$1 = 0) THEN (2 ::= (\\<lambda>s. - s$2)) ELSE skip))\n    INV (\\<lambda>s. 0 \\<le> s$1 \\<and> 2 * g * s$1 = 2 * g * h + s$2 * s$2))\n  \\<lceil>\\<lambda>s. 0 \\<le> s$1 \\<and> s$1 \\<le> h\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>g < 0; 0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>\\<lambda>s. s $ 1 = h \\<and> s $ 2 = 0\\<rceil>\n                      \\<subseteq> wp (LOOP EVOL\n      (\\<lambda>t s.\n          \\<chi>i.\n             if i = 1 then g \\<cdot> t\\<^sup>2 / 2 + s $ 2 \\<cdot> t + s $ 1\n             else g \\<cdot> t + s $ 2)\n      (\\<lambda>s. 0 \\<le> s $ 1) T ;\n     (IF (\\<lambda>s.\n             s $ 1 =\n             0) THEN (2 ::= (\\<lambda>s.\n                                - s $\n                                  2)) ELSE skip) INV (\\<lambda>s.\n                   0 \\<le> s $ 1 \\<and>\n                   2 \\<cdot> g \\<cdot> s $ 1 =\n                   2 \\<cdot> g \\<cdot> h + s $ 2 \\<cdot> s $ 2) )\n                                   \\<lceil>\\<lambda>s.\n        0 \\<le> s $ 1 \\<and> s $ 1 \\<le> h\\<rceil>", "by (rule wp_loopI) (auto simp: bb_real_arith)\n\n\\<comment> \\<open>Verified with the flow. \\<close>"], ["", "lemma local_flow_ball: \"local_flow (f g) UNIV UNIV (\\<phi> g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. local_flow (f g) UNIV UNIV\n     (\\<lambda>t s.\n         \\<chi>i.\n            if i = 1 then g \\<cdot> t\\<^sup>2 / 2 + s $ 2 \\<cdot> t + s $ 1\n            else g \\<cdot> t + s $ 2)", "apply(unfold_locales, simp_all add: local_lipschitz_def lipschitz_on_def vec_eq_iff, clarsimp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x t.\n       \\<exists>u>0.\n          (\\<exists>ta. dist t ta \\<le> u) \\<longrightarrow>\n          (\\<exists>L\\<ge>0.\n              \\<forall>xa\\<in>cball x u.\n                 \\<forall>y\\<in>cball x u.\n                    dist (f g xa) (f g y) \\<le> L \\<cdot> dist xa y)\n 2. \\<And>t s.\n       \\<forall>i.\n           D (\\<lambda>x.\n                 if i = 1\n                 then g \\<cdot> x\\<^sup>2 / 2 + s $ 2 \\<cdot> x + s $ 1\n                 else g \\<cdot> x +\n                      s $\n                      2) = (\\<lambda>x.\n                               if i = 1\n                               then (\\<chi>i.\n  if i = 1 then g \\<cdot> x\\<^sup>2 / 2 + s $ 2 \\<cdot> x + s $ 1\n  else g \\<cdot> x + s $ 2) $\n                                    2\n                               else g)\n           on {0--t}\n 3. \\<And>s. \\<forall>i. i \\<noteq> 1 \\<longrightarrow> s $ 2 = s $ i", "apply(rule_tac x=\"1/2\" in exI, clarsimp, rule_tac x=1 in exI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x t ta.\n       dist t ta \\<cdot> 2 \\<le> 1 \\<Longrightarrow>\n       0 \\<le> 1 \\<and>\n       (\\<forall>xa\\<in>cball x (1 / 2).\n           \\<forall>y\\<in>cball x (1 / 2).\n              dist (f g xa) (f g y) \\<le> 1 \\<cdot> dist xa y)\n 2. \\<And>t s.\n       \\<forall>i.\n           D (\\<lambda>x.\n                 if i = 1\n                 then g \\<cdot> x\\<^sup>2 / 2 + s $ 2 \\<cdot> x + s $ 1\n                 else g \\<cdot> x +\n                      s $\n                      2) = (\\<lambda>x.\n                               if i = 1\n                               then (\\<chi>i.\n  if i = 1 then g \\<cdot> x\\<^sup>2 / 2 + s $ 2 \\<cdot> x + s $ 1\n  else g \\<cdot> x + s $ 2) $\n                                    2\n                               else g)\n           on {0--t}\n 3. \\<And>s. \\<forall>i. i \\<noteq> 1 \\<longrightarrow> s $ 2 = s $ i", "apply(simp add: dist_norm norm_vec_def L2_set_def UNIV_2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t s.\n       \\<forall>i.\n           D (\\<lambda>x.\n                 if i = 1\n                 then g \\<cdot> x\\<^sup>2 / 2 + s $ 2 \\<cdot> x + s $ 1\n                 else g \\<cdot> x +\n                      s $\n                      2) = (\\<lambda>x.\n                               if i = 1\n                               then (\\<chi>i.\n  if i = 1 then g \\<cdot> x\\<^sup>2 / 2 + s $ 2 \\<cdot> x + s $ 1\n  else g \\<cdot> x + s $ 2) $\n                                    2\n                               else g)\n           on {0--t}\n 2. \\<And>s. \\<forall>i. i \\<noteq> 1 \\<longrightarrow> s $ 2 = s $ i", "by (auto simp: forall_2 intro!: poly_derivatives)"], ["", "lemma bouncing_ball_flow:\n  fixes h::real\n  assumes \"g < 0\" and \"h \\<ge> 0\"\n  shows \"g < 0 \\<Longrightarrow> h \\<ge> 0 \\<Longrightarrow>\n  \\<lceil>\\<lambda>s. s$1 = h \\<and> s$2 = 0\\<rceil> \\<le> wp\n    (LOOP\n      ((x\\<acute>= (\\<lambda>t. f g) & (\\<lambda> s. s$1 \\<ge> 0) on (\\<lambda>s. UNIV) UNIV @ 0);\n      (IF (\\<lambda> s. s$1 = 0) THEN (2 ::= (\\<lambda>s. - s$2)) ELSE skip))\n    INV (\\<lambda>s. 0 \\<le> s$1 \\<and> 2 * g * s$1 = 2 * g * h + s$2 * s$2))\n  \\<lceil>\\<lambda>s. 0 \\<le> s$1 \\<and> s$1 \\<le> h\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>g < 0; 0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>\\<lambda>s. s $ 1 = h \\<and> s $ 2 = 0\\<rceil>\n                      \\<subseteq> wp (LOOP x\\<acute>=\\<lambda>t.\n                  f g & \\<lambda>s.\n                           0 \\<le> s $ 1 on \\<lambda>s. UNIV UNIV @ 0 ;\n     (IF (\\<lambda>s.\n             s $ 1 =\n             0) THEN (2 ::= (\\<lambda>s.\n                                - s $\n                                  2)) ELSE skip) INV (\\<lambda>s.\n                   0 \\<le> s $ 1 \\<and>\n                   2 \\<cdot> g \\<cdot> s $ 1 =\n                   2 \\<cdot> g \\<cdot> h + s $ 2 \\<cdot> s $ 2) )\n                                   \\<lceil>\\<lambda>s.\n        0 \\<le> s $ 1 \\<and> s $ 1 \\<le> h\\<rceil>", "apply(rule wp_loopI, simp_all add: local_flow.wp_g_ode_subset[OF local_flow_ball])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>g < 0; 0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s.\n                         0 \\<le> s $ 1 \\<and>\n                         2 \\<cdot> g \\<cdot> s $ 1 =\n                         2 \\<cdot> g \\<cdot> h +\n                         s $ 2 \\<cdot> s $ 2 \\<longrightarrow>\n                         s $ 1 \\<le> h\n 2. \\<lbrakk>g < 0; 0 \\<le> h\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s.\n                         0 \\<le> s $ 1 \\<and>\n                         2 \\<cdot> g \\<cdot> s $ 1 =\n                         2 \\<cdot> g \\<cdot> h +\n                         s $ 2 \\<cdot> s $ 2 \\<longrightarrow>\n                         (\\<forall>t.\n                             (\\<forall>\\<tau>\\<le>t.\n                                 0 \\<le> g \\<cdot> \\<tau>\\<^sup>2 / 2 +\n   s $ 2 \\<cdot> \\<tau> +\n   s $ 1) \\<longrightarrow>\n                             (g \\<cdot> t\\<^sup>2 / 2 + s $ 2 \\<cdot> t +\n                              s $ 1 =\n                              0 \\<longrightarrow>\n                              2 \\<cdot> g \\<cdot> h +\n                              (g \\<cdot> t \\<cdot> (g \\<cdot> t + s $ 2) +\n                               s $ 2 \\<cdot> (g \\<cdot> t + s $ 2)) =\n                              0) \\<and>\n                             (g \\<cdot> t\\<^sup>2 / 2 + s $ 2 \\<cdot> t +\n                              s $ 1 =\n                              0 \\<or>\n                              2 \\<cdot> g \\<cdot>\n                              (g \\<cdot> t\\<^sup>2 / 2 + s $ 2 \\<cdot> t +\n                               s $ 1) =\n                              2 \\<cdot> g \\<cdot> h +\n                              (g \\<cdot> t \\<cdot> (g \\<cdot> t + s $ 2) +\n                               s $ 2 \\<cdot> (g \\<cdot> t + s $ 2))))", "by (auto simp: bb_real_arith)"], ["", "no_notation fball (\"f\")\n        and ball_flow (\"\\<phi>\")"], ["", "subsubsection\\<open> Thermostat \\<close>"], ["", "text \\<open> A thermostat has a chronometer, a thermometer and a switch to turn on and off a heater.\nAt most every @{text \"t\"} minutes, it sets its chronometer to @{term \"0::real\"}, it registers\nthe room temperature, and it turns the heater on (or off) based on this reading. The temperature\nfollows the ODE @{text \"T' = - a * (T - U)\"} where @{text \"U\"} is @{text \"L \\<ge> 0\"} when the heater\nis on, and @{text \"0\"} when it is off. We use @{term \"1::4\"} to denote the room's temperature,\n@{term \"2::4\"} is time as measured by the thermostat's chronometer, @{term \"3::4\"} is the\ntemperature detected by the thermometer, and @{term \"4::4\"} states whether the heater is on\n(@{text \"s$4 = 1\"}) or off (@{text \"s$4 = 0\"}). We prove that the thermostat keeps the room's\ntemperature between @{text \"Tmin\"} and @{text \"Tmax\"}. \\<close>"], ["", "abbreviation temp_vec_field :: \"real \\<Rightarrow> real \\<Rightarrow> real^4 \\<Rightarrow> real^4\" (\"f\")\n  where \"f a L s \\<equiv> (\\<chi> i. if i = 2 then 1 else (if i = 1 then - a * (s$1 - L) else 0))\""], ["", "abbreviation temp_flow :: \"real \\<Rightarrow> real \\<Rightarrow> real \\<Rightarrow> real^4 \\<Rightarrow> real^4\" (\"\\<phi>\")\n  where \"\\<phi> a L t s \\<equiv> (\\<chi> i. if i = 1 then - exp(-a * t) * (L - s$1) + L else\n  (if i = 2 then t + s$2 else s$i))\"\n\n\\<comment> \\<open>Verified with the flow. \\<close>"], ["", "lemma norm_diff_temp_dyn: \"0 < a \\<Longrightarrow> \\<parallel>f a L s\\<^sub>1 - f a L s\\<^sub>2\\<parallel> = \\<bar>a\\<bar> * \\<bar>s\\<^sub>1$1 - s\\<^sub>2$1\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow>\n    \\<parallel>f a L s\\<^sub>1 - f a L s\\<^sub>2\\<parallel> =\n    \\<bar>a\\<bar> \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "proof(simp add: norm_vec_def L2_set_def, unfold UNIV_4, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow>\n    \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n          a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "assume a1: \"0 < a\""], ["proof (state)\nthis:\n  0 < a\n\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow>\n    \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n          a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "have f2: \"\\<And>r ra. \\<bar>(r::real) + - ra\\<bar> = \\<bar>ra + - r\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra. \\<bar>r + - ra\\<bar> = \\<bar>ra + - r\\<bar>", "by (metis abs_minus_commute minus_real_def)"], ["proof (state)\nthis:\n  \\<bar>?r + - ?ra\\<bar> = \\<bar>?ra + - ?r\\<bar>\n\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow>\n    \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n          a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "have \"\\<And>r ra rb. (r::real) * ra + - (r * rb) = r * (ra + - rb)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra rb. r \\<cdot> ra + - (r \\<cdot> rb) = r \\<cdot> (ra + - rb)", "by (metis minus_real_def right_diff_distrib)"], ["proof (state)\nthis:\n  ?r \\<cdot> ?ra + - (?r \\<cdot> ?rb) = ?r \\<cdot> (?ra + - ?rb)\n\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow>\n    \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n          a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "hence \"\\<bar>a * (s\\<^sub>1$1 + - L) + - (a * (s\\<^sub>2$1 + - L))\\<bar> = a * \\<bar>s\\<^sub>1$1 + - s\\<^sub>2$1\\<bar>\""], ["proof (prove)\nusing this:\n  ?r \\<cdot> ?ra + - (?r \\<cdot> ?rb) = ?r \\<cdot> (?ra + - ?rb)\n\ngoal (1 subgoal):\n 1. \\<bar>a \\<cdot> (s\\<^sub>1 $ 1 + - L) +\n          - (a \\<cdot> (s\\<^sub>2 $ 1 + - L))\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 + - s\\<^sub>2 $ 1\\<bar>", "using a1"], ["proof (prove)\nusing this:\n  ?r \\<cdot> ?ra + - (?r \\<cdot> ?rb) = ?r \\<cdot> (?ra + - ?rb)\n  0 < a\n\ngoal (1 subgoal):\n 1. \\<bar>a \\<cdot> (s\\<^sub>1 $ 1 + - L) +\n          - (a \\<cdot> (s\\<^sub>2 $ 1 + - L))\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 + - s\\<^sub>2 $ 1\\<bar>", "by (simp add: abs_mult)"], ["proof (state)\nthis:\n  \\<bar>a \\<cdot> (s\\<^sub>1 $ 1 + - L) +\n        - (a \\<cdot> (s\\<^sub>2 $ 1 + - L))\\<bar> =\n  a \\<cdot> \\<bar>s\\<^sub>1 $ 1 + - s\\<^sub>2 $ 1\\<bar>\n\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow>\n    \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n          a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "thus \"\\<bar>a * (s\\<^sub>2$1 - L) - a * (s\\<^sub>1$1 - L)\\<bar> = a * \\<bar>s\\<^sub>1$1 - s\\<^sub>2$1\\<bar>\""], ["proof (prove)\nusing this:\n  \\<bar>a \\<cdot> (s\\<^sub>1 $ 1 + - L) +\n        - (a \\<cdot> (s\\<^sub>2 $ 1 + - L))\\<bar> =\n  a \\<cdot> \\<bar>s\\<^sub>1 $ 1 + - s\\<^sub>2 $ 1\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n          a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "using f2 minus_real_def"], ["proof (prove)\nusing this:\n  \\<bar>a \\<cdot> (s\\<^sub>1 $ 1 + - L) +\n        - (a \\<cdot> (s\\<^sub>2 $ 1 + - L))\\<bar> =\n  a \\<cdot> \\<bar>s\\<^sub>1 $ 1 + - s\\<^sub>2 $ 1\\<bar>\n  \\<bar>?r + - ?ra\\<bar> = \\<bar>?ra + - ?r\\<bar>\n  ?x - ?y = ?x + - ?y\n\ngoal (1 subgoal):\n 1. \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n          a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n    a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>", "by presburger"], ["proof (state)\nthis:\n  \\<bar>a \\<cdot> (s\\<^sub>2 $ 1 - L) -\n        a \\<cdot> (s\\<^sub>1 $ 1 - L)\\<bar> =\n  a \\<cdot> \\<bar>s\\<^sub>1 $ 1 - s\\<^sub>2 $ 1\\<bar>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma local_lipschitz_temp_dyn:\n  assumes \"0 < (a::real)\"\n  shows \"local_lipschitz UNIV UNIV (\\<lambda>t::real. f a L)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. local_lipschitz UNIV UNIV (\\<lambda>t. f a L)", "apply(unfold local_lipschitz_def lipschitz_on_def dist_norm)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>UNIV.\n       \\<forall>t\\<in>UNIV.\n          \\<exists>u>0.\n             \\<exists>La.\n                \\<forall>t\\<in>cball t u \\<inter> UNIV.\n                   0 \\<le> La \\<and>\n                   (\\<forall>xa\\<in>cball x u \\<inter> UNIV.\n                       \\<forall>y\\<in>cball x u \\<inter> UNIV.\n                          \\<parallel>f a L xa - f a L y\\<parallel>\n                          \\<le> La \\<cdot> (\\<parallel>xa - y\\<parallel>))", "apply(clarsimp, rule_tac x=1 in exI, clarsimp, rule_tac x=a in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x t ta.\n       dist t ta \\<le> 1 \\<Longrightarrow>\n       0 \\<le> a \\<and>\n       (\\<forall>xa\\<in>cball x 1.\n           \\<forall>y\\<in>cball x 1.\n              \\<parallel>f a L xa - f a L y\\<parallel>\n              \\<le> a \\<cdot> (\\<parallel>xa - y\\<parallel>))", "using assms"], ["proof (prove)\nusing this:\n  0 < a\n\ngoal (1 subgoal):\n 1. \\<And>x t ta.\n       dist t ta \\<le> 1 \\<Longrightarrow>\n       0 \\<le> a \\<and>\n       (\\<forall>xa\\<in>cball x 1.\n           \\<forall>y\\<in>cball x 1.\n              \\<parallel>f a L xa - f a L y\\<parallel>\n              \\<le> a \\<cdot> (\\<parallel>xa - y\\<parallel>))", "apply(simp_all add: norm_diff_temp_dyn)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x t ta.\n       \\<lbrakk>dist t ta \\<le> 1; 0 < a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa\\<in>cball x 1.\n                            \\<forall>y\\<in>cball x 1.\n                               \\<bar>xa $ 1 - y $ 1\\<bar>\n                               \\<le> \\<parallel>xa - y\\<parallel>", "apply(simp add: norm_vec_def L2_set_def, unfold UNIV_4, clarsimp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x t ta xa y.\n       \\<lbrakk>dist t ta \\<le> 1; 0 < a; dist x xa \\<le> 1;\n        dist x y \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> \\<bar>xa $ 1 - y $ 1\\<bar>\n                         \\<le> sqrt\n                                ((xa $ 1 - y $ 1)\\<^sup>2 +\n                                 ((xa $ 2 - y $ 2)\\<^sup>2 +\n                                  ((xa $ 3 - y $ 3)\\<^sup>2 +\n                                   (xa $ 4 - y $ 4)\\<^sup>2)))", "unfolding real_sqrt_abs[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x t ta xa y.\n       \\<lbrakk>dist t ta \\<le> 1; 0 < a; dist x xa \\<le> 1;\n        dist x y \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> sqrt ((xa $ 1 - y $ 1)\\<^sup>2)\n                         \\<le> sqrt\n                                ((xa $ 1 - y $ 1)\\<^sup>2 +\n                                 ((xa $ 2 - y $ 2)\\<^sup>2 +\n                                  ((xa $ 3 - y $ 3)\\<^sup>2 +\n                                   (xa $ 4 - y $ 4)\\<^sup>2)))", "by (rule real_le_lsqrt) auto"], ["", "lemma local_flow_temp: \"a > 0 \\<Longrightarrow> local_flow (f a L) UNIV UNIV (\\<phi> a L)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow> local_flow (f a L) UNIV UNIV (\\<phi> a L)", "by (unfold_locales, auto intro!: poly_derivatives local_lipschitz_temp_dyn simp: forall_4 vec_eq_iff)"], ["", "lemma temp_dyn_down_real_arith:\n  assumes \"a > 0\" and Thyps: \"0 < Tmin\" \"Tmin \\<le> T\" \"T \\<le> Tmax\"\n    and thyps: \"0 \\<le> (t::real)\" \"\\<forall>\\<tau>\\<in>{0..t}. \\<tau> \\<le> - (ln (Tmin / T) / a) \"\n  shows \"Tmin \\<le> exp (-a * t) * T\" and \"exp (-a * t) * T \\<le> Tmax\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T &&&\n    exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "proof-"], ["proof (state)\ngoal (2 subgoals):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T\n 2. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "have \"0 \\<le> t \\<and> t \\<le> - (ln (Tmin / T) / a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> t \\<and> t \\<le> - (ln (Tmin / T) / a)", "using thyps"], ["proof (prove)\nusing this:\n  0 \\<le> t\n  \\<forall>\\<tau>\\<in>{0..t}. \\<tau> \\<le> - (ln (Tmin / T) / a)\n\ngoal (1 subgoal):\n 1. 0 \\<le> t \\<and> t \\<le> - (ln (Tmin / T) / a)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> t \\<and> t \\<le> - (ln (Tmin / T) / a)\n\ngoal (2 subgoals):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T\n 2. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "hence \"ln (Tmin / T) \\<le> - a * t \\<and> - a * t \\<le> 0\""], ["proof (prove)\nusing this:\n  0 \\<le> t \\<and> t \\<le> - (ln (Tmin / T) / a)\n\ngoal (1 subgoal):\n 1. ln (Tmin / T) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0", "using assms(1) divide_le_cancel"], ["proof (prove)\nusing this:\n  0 \\<le> t \\<and> t \\<le> - (ln (Tmin / T) / a)\n  0 < a\n  (?a / ?c \\<le> ?b / ?c) =\n  (((0::?'a) < ?c \\<longrightarrow> ?a \\<le> ?b) \\<and>\n   (?c < (0::?'a) \\<longrightarrow> ?b \\<le> ?a))\n\ngoal (1 subgoal):\n 1. ln (Tmin / T) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0", "by fastforce"], ["proof (state)\nthis:\n  ln (Tmin / T) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n\ngoal (2 subgoals):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T\n 2. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "also"], ["proof (state)\nthis:\n  ln (Tmin / T) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n\ngoal (2 subgoals):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T\n 2. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "have \"Tmin / T > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < Tmin / T", "using Thyps"], ["proof (prove)\nusing this:\n  0 < Tmin\n  Tmin \\<le> T\n  T \\<le> Tmax\n\ngoal (1 subgoal):\n 1. 0 < Tmin / T", "by auto"], ["proof (state)\nthis:\n  0 < Tmin / T\n\ngoal (2 subgoals):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T\n 2. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "ultimately"], ["proof (chain)\npicking this:\n  ln (Tmin / T) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n  0 < Tmin / T", "have obs: \"Tmin / T \\<le> exp (-a * t)\" \"exp (-a * t) \\<le> 1\""], ["proof (prove)\nusing this:\n  ln (Tmin / T) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n  0 < Tmin / T\n\ngoal (1 subgoal):\n 1. Tmin / T \\<le> exp (- a \\<cdot> t) &&& exp (- a \\<cdot> t) \\<le> 1", "using exp_ln exp_le_one_iff"], ["proof (prove)\nusing this:\n  ln (Tmin / T) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n  0 < Tmin / T\n  0 < ?x \\<Longrightarrow> exp (ln ?x) = ?x\n  (exp ?x \\<le> 1) = (?x \\<le> 0)\n\ngoal (1 subgoal):\n 1. Tmin / T \\<le> exp (- a \\<cdot> t) &&& exp (- a \\<cdot> t) \\<le> 1", "by (metis exp_less_cancel_iff not_less, simp)"], ["proof (state)\nthis:\n  Tmin / T \\<le> exp (- a \\<cdot> t)\n  exp (- a \\<cdot> t) \\<le> 1\n\ngoal (2 subgoals):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T\n 2. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "thus \"Tmin \\<le> exp (-a * t) * T\""], ["proof (prove)\nusing this:\n  Tmin / T \\<le> exp (- a \\<cdot> t)\n  exp (- a \\<cdot> t) \\<le> 1\n\ngoal (1 subgoal):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T", "using Thyps"], ["proof (prove)\nusing this:\n  Tmin / T \\<le> exp (- a \\<cdot> t)\n  exp (- a \\<cdot> t) \\<le> 1\n  0 < Tmin\n  Tmin \\<le> T\n  T \\<le> Tmax\n\ngoal (1 subgoal):\n 1. Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T", "by (simp add: pos_divide_le_eq)"], ["proof (state)\nthis:\n  Tmin \\<le> exp (- a \\<cdot> t) \\<cdot> T\n\ngoal (1 subgoal):\n 1. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "show \"exp (-a * t) * T \\<le> Tmax\""], ["proof (prove)\ngoal (1 subgoal):\n 1. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "using Thyps mult_left_le_one_le[OF _ exp_ge_zero obs(2), of T]\n      less_eq_real_def order_trans_rules(23)"], ["proof (prove)\nusing this:\n  0 < Tmin\n  Tmin \\<le> T\n  T \\<le> Tmax\n  0 \\<le> T \\<Longrightarrow> exp (- a \\<cdot> t) \\<cdot> T \\<le> T\n  (?x \\<le> ?y) = (?x < ?y \\<or> ?x = ?y)\n  \\<lbrakk>?x \\<le> ?y; ?y \\<le> ?z\\<rbrakk> \\<Longrightarrow> ?x \\<le> ?z\n\ngoal (1 subgoal):\n 1. exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax", "by blast"], ["proof (state)\nthis:\n  exp (- a \\<cdot> t) \\<cdot> T \\<le> Tmax\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma temp_dyn_up_real_arith:\n  assumes \"a > 0\" and Thyps: \"Tmin \\<le> T\" \"T \\<le> Tmax\" \"Tmax < (L::real)\"\n    and thyps: \"0 \\<le> t\" \"\\<forall>\\<tau>\\<in>{0..t}. \\<tau> \\<le> - (ln ((L - Tmax) / (L - T)) / a) \"\n  shows \"L - Tmax \\<le> exp (-(a * t)) * (L - T)\"\n    and \"L - exp (-(a * t)) * (L - T) \\<le> Tmax\"\n    and \"Tmin \\<le> L - exp (-(a * t)) * (L - T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T) &&&\n    L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax &&&\n    Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "proof-"], ["proof (state)\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "have \"0 \\<le> t \\<and> t \\<le> - (ln ((L - Tmax) / (L - T)) / a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> t \\<and> t \\<le> - (ln ((L - Tmax) / (L - T)) / a)", "using thyps"], ["proof (prove)\nusing this:\n  0 \\<le> t\n  \\<forall>\\<tau>\\<in>{0..t}. \\<tau> \\<le> - (ln ((L - Tmax) / (L - T)) / a)\n\ngoal (1 subgoal):\n 1. 0 \\<le> t \\<and> t \\<le> - (ln ((L - Tmax) / (L - T)) / a)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> t \\<and> t \\<le> - (ln ((L - Tmax) / (L - T)) / a)\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "hence \"ln ((L - Tmax) / (L - T)) \\<le> - a * t \\<and> - a * t \\<le> 0\""], ["proof (prove)\nusing this:\n  0 \\<le> t \\<and> t \\<le> - (ln ((L - Tmax) / (L - T)) / a)\n\ngoal (1 subgoal):\n 1. ln ((L - Tmax) / (L - T)) \\<le> - a \\<cdot> t \\<and>\n    - a \\<cdot> t \\<le> 0", "using assms(1) divide_le_cancel"], ["proof (prove)\nusing this:\n  0 \\<le> t \\<and> t \\<le> - (ln ((L - Tmax) / (L - T)) / a)\n  0 < a\n  (?a / ?c \\<le> ?b / ?c) =\n  (((0::?'a) < ?c \\<longrightarrow> ?a \\<le> ?b) \\<and>\n   (?c < (0::?'a) \\<longrightarrow> ?b \\<le> ?a))\n\ngoal (1 subgoal):\n 1. ln ((L - Tmax) / (L - T)) \\<le> - a \\<cdot> t \\<and>\n    - a \\<cdot> t \\<le> 0", "by fastforce"], ["proof (state)\nthis:\n  ln ((L - Tmax) / (L - T)) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "also"], ["proof (state)\nthis:\n  ln ((L - Tmax) / (L - T)) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "have \"(L - Tmax) / (L - T) > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < (L - Tmax) / (L - T)", "using Thyps"], ["proof (prove)\nusing this:\n  Tmin \\<le> T\n  T \\<le> Tmax\n  Tmax < L\n\ngoal (1 subgoal):\n 1. 0 < (L - Tmax) / (L - T)", "by auto"], ["proof (state)\nthis:\n  0 < (L - Tmax) / (L - T)\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "ultimately"], ["proof (chain)\npicking this:\n  ln ((L - Tmax) / (L - T)) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n  0 < (L - Tmax) / (L - T)", "have \"(L - Tmax) / (L - T) \\<le> exp (-a * t) \\<and> exp (-a * t) \\<le> 1\""], ["proof (prove)\nusing this:\n  ln ((L - Tmax) / (L - T)) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n  0 < (L - Tmax) / (L - T)\n\ngoal (1 subgoal):\n 1. (L - Tmax) / (L - T) \\<le> exp (- a \\<cdot> t) \\<and>\n    exp (- a \\<cdot> t) \\<le> 1", "using exp_ln exp_le_one_iff"], ["proof (prove)\nusing this:\n  ln ((L - Tmax) / (L - T)) \\<le> - a \\<cdot> t \\<and> - a \\<cdot> t \\<le> 0\n  0 < (L - Tmax) / (L - T)\n  0 < ?x \\<Longrightarrow> exp (ln ?x) = ?x\n  (exp ?x \\<le> 1) = (?x \\<le> 0)\n\ngoal (1 subgoal):\n 1. (L - Tmax) / (L - T) \\<le> exp (- a \\<cdot> t) \\<and>\n    exp (- a \\<cdot> t) \\<le> 1", "by (metis exp_less_cancel_iff not_less)"], ["proof (state)\nthis:\n  (L - Tmax) / (L - T) \\<le> exp (- a \\<cdot> t) \\<and>\n  exp (- a \\<cdot> t) \\<le> 1\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "moreover"], ["proof (state)\nthis:\n  (L - Tmax) / (L - T) \\<le> exp (- a \\<cdot> t) \\<and>\n  exp (- a \\<cdot> t) \\<le> 1\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "have \"L - T > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < L - T", "using Thyps"], ["proof (prove)\nusing this:\n  Tmin \\<le> T\n  T \\<le> Tmax\n  Tmax < L\n\ngoal (1 subgoal):\n 1. 0 < L - T", "by auto"], ["proof (state)\nthis:\n  0 < L - T\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "ultimately"], ["proof (chain)\npicking this:\n  (L - Tmax) / (L - T) \\<le> exp (- a \\<cdot> t) \\<and>\n  exp (- a \\<cdot> t) \\<le> 1\n  0 < L - T", "have obs: \"(L - Tmax) \\<le> exp (-a * t) * (L - T) \\<and> exp (-a * t) * (L - T) \\<le> (L - T)\""], ["proof (prove)\nusing this:\n  (L - Tmax) / (L - T) \\<le> exp (- a \\<cdot> t) \\<and>\n  exp (- a \\<cdot> t) \\<le> 1\n  0 < L - T\n\ngoal (1 subgoal):\n 1. L - Tmax \\<le> exp (- a \\<cdot> t) \\<cdot> (L - T) \\<and>\n    exp (- a \\<cdot> t) \\<cdot> (L - T) \\<le> L - T", "by (simp add: pos_divide_le_eq)"], ["proof (state)\nthis:\n  L - Tmax \\<le> exp (- a \\<cdot> t) \\<cdot> (L - T) \\<and>\n  exp (- a \\<cdot> t) \\<cdot> (L - T) \\<le> L - T\n\ngoal (3 subgoals):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n 2. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 3. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "thus \"(L - Tmax) \\<le> exp (-(a * t)) * (L - T)\""], ["proof (prove)\nusing this:\n  L - Tmax \\<le> exp (- a \\<cdot> t) \\<cdot> (L - T) \\<and>\n  exp (- a \\<cdot> t) \\<cdot> (L - T) \\<le> L - T\n\ngoal (1 subgoal):\n 1. L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "by auto"], ["proof (state)\nthis:\n  L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n\ngoal (2 subgoals):\n 1. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n 2. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "thus \"L - exp (-(a * t)) * (L - T) \\<le> Tmax\""], ["proof (prove)\nusing this:\n  L - Tmax \\<le> exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n\ngoal (1 subgoal):\n 1. L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax", "by auto"], ["proof (state)\nthis:\n  L - exp (- (a \\<cdot> t)) \\<cdot> (L - T) \\<le> Tmax\n\ngoal (1 subgoal):\n 1. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "show \"Tmin \\<le> L - exp (-(a * t)) * (L - T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "using Thyps and obs"], ["proof (prove)\nusing this:\n  Tmin \\<le> T\n  T \\<le> Tmax\n  Tmax < L\n  L - Tmax \\<le> exp (- a \\<cdot> t) \\<cdot> (L - T) \\<and>\n  exp (- a \\<cdot> t) \\<cdot> (L - T) \\<le> L - T\n\ngoal (1 subgoal):\n 1. Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)", "by auto"], ["proof (state)\nthis:\n  Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - T)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas fbox_temp_dyn = local_flow.wp_g_ode_subset[OF local_flow_temp]"], ["", "lemma thermostat:\n  assumes \"a > 0\" and \"0 < Tmin\" and \"Tmax < L\"\n  shows \"\\<lceil>\\<lambda>s. Tmin \\<le> s$1 \\<and> s$1 \\<le> Tmax \\<and> s$4 = 0\\<rceil> \\<le> wp\n  (LOOP\n    \\<comment> \\<open>control\\<close>\n    ((2 ::= (\\<lambda>s. 0));(3 ::= (\\<lambda>s. s$1));\n    (IF (\\<lambda>s. s$4 = 0 \\<and> s$3 \\<le> Tmin + 1) THEN (4 ::= (\\<lambda>s.1)) ELSE\n    (IF (\\<lambda>s. s$4 = 1 \\<and> s$3 \\<ge> Tmax - 1) THEN (4 ::= (\\<lambda>s.0)) ELSE skip));\n    \\<comment> \\<open>dynamics\\<close>\n    (IF (\\<lambda>s. s$4 = 0) THEN (x\\<acute>= f a 0 & (\\<lambda>s. s$2 \\<le> - (ln (Tmin/s$3))/a))\n    ELSE (x\\<acute>= f a L & (\\<lambda>s. s$2 \\<le> - (ln ((L-Tmax)/(L-s$3)))/a))) )\n  INV (\\<lambda>s. Tmin \\<le>s$1 \\<and> s$1 \\<le> Tmax \\<and> (s$4 = 0 \\<or> s$4 = 1)))\n  \\<lceil>\\<lambda>s. Tmin \\<le> s$1 \\<and> s$1 \\<le> Tmax\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               Tmin \\<le> s $ 1 \\<and>\n               s $ 1 \\<le> Tmax \\<and> s $ 4 = 0\\<rceil>\n    \\<subseteq> wp (LOOP (2 ::= (\\<lambda>s. 0)) ;\n                         (3 ::= (\\<lambda>s. s $ 1)) ;\n                         (IF (\\<lambda>s.\n                                 s $ 4 = 0 \\<and>\n                                 s $ 3\n                                 \\<le> Tmin +\n 1) THEN (4 ::= (\\<lambda>s.\n                    1)) ELSE IF (\\<lambda>s.\n                                    s $ 4 = 1 \\<and>\n                                    Tmax - 1\n                                    \\<le> s $\n    3) THEN (4 ::= (\\<lambda>s. 0)) ELSE skip) ;\n                         (IF (\\<lambda>s.\n                                 s $ 4 =\n                                 0) THEN x\\<acute>=\\<lambda>t.\n                f a 0 & \\<lambda>s.\n                           s $ 2\n                           \\<le> - ln (Tmin / s $ 3) /\n                                 a on \\<lambda>s.\n   {t. 0 \\<le> t} UNIV @ 0 ELSE x\\<acute>=\\<lambda>t.\n       f a L & \\<lambda>s.\n                  s $ 2\n                  \\<le> - ln ((L - Tmax) / (L - s $ 3)) /\n                        a on \\<lambda>s.\n                                {t. 0 \\<le> t} UNIV @ 0) INV (\\<lambda>s.\n                           Tmin \\<le> s $ 1 \\<and>\n                           s $ 1 \\<le> Tmax \\<and>\n                           (s $ 4 = 0 \\<or> s $ 4 = 1)) )\n                 \\<lceil>\\<lambda>s.\n                            Tmin \\<le> s $ 1 \\<and> s $ 1 \\<le> Tmax\\<rceil>", "apply(rule wp_loopI, simp_all add: fbox_temp_dyn[OF assms(1)])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s.\n       Tmin \\<le> s $ 1 \\<and>\n       s $ 1 \\<le> Tmax \\<and> (s $ 4 = 0 \\<or> s $ 4 = 1) \\<longrightarrow>\n       (s $ 4 = 0 \\<longrightarrow>\n        s $ 1 \\<le> Tmin + 1 \\<longrightarrow>\n        (\\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                \\<tau>\n                \\<le> - (ln ((L - Tmax) / (L - s $ 1)) /\n                         a)) \\<longrightarrow>\n            Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1) \\<and>\n            L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1)\n            \\<le> Tmax)) \\<and>\n       (s $ 4 = 0 \\<and> s $ 1 \\<le> Tmin + 1 \\<or>\n        (s $ 4 = 1 \\<longrightarrow>\n         Tmax - 1 \\<le> s $ 1 \\<longrightarrow>\n         (\\<forall>t\\<ge>0.\n             (\\<forall>\\<tau>.\n                 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                 \\<tau> \\<le> - (ln (Tmin / s $ 1) / a)) \\<longrightarrow>\n             Tmin \\<le> exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<and>\n             exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<le> Tmax)) \\<and>\n        (s $ 4 = 1 \\<and> Tmax - 1 \\<le> s $ 1 \\<or>\n         (s $ 4 = 0 \\<longrightarrow>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau> \\<le> - (ln (Tmin / s $ 1) / a)) \\<longrightarrow>\n              Tmin \\<le> exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<and>\n              exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<le> Tmax)) \\<and>\n         (s $ 4 = 0 \\<or>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau>\n                  \\<le> - (ln ((L - Tmax) / (L - s $ 1)) /\n                           a)) \\<longrightarrow>\n              Tmin\n              \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1) \\<and>\n              L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1) \\<le> Tmax))))", "using temp_dyn_up_real_arith[OF assms(1) _ _ assms(3), of Tmin]\n    and temp_dyn_down_real_arith[OF assms(1,2), of _ Tmax]"], ["proof (prove)\nusing this:\n  \\<lbrakk>Tmin \\<le> ?T; ?T \\<le> Tmax; 0 \\<le> ?t;\n   \\<forall>\\<tau>\\<in>{0..?t}.\n      \\<tau> \\<le> - (ln ((L - Tmax) / (L - ?T)) / a)\\<rbrakk>\n  \\<Longrightarrow> L - Tmax \\<le> exp (- (a \\<cdot> ?t)) \\<cdot> (L - ?T)\n  \\<lbrakk>Tmin \\<le> ?T; ?T \\<le> Tmax; 0 \\<le> ?t;\n   \\<forall>\\<tau>\\<in>{0..?t}.\n      \\<tau> \\<le> - (ln ((L - Tmax) / (L - ?T)) / a)\\<rbrakk>\n  \\<Longrightarrow> L - exp (- (a \\<cdot> ?t)) \\<cdot> (L - ?T) \\<le> Tmax\n  \\<lbrakk>Tmin \\<le> ?T; ?T \\<le> Tmax; 0 \\<le> ?t;\n   \\<forall>\\<tau>\\<in>{0..?t}.\n      \\<tau> \\<le> - (ln ((L - Tmax) / (L - ?T)) / a)\\<rbrakk>\n  \\<Longrightarrow> Tmin \\<le> L - exp (- (a \\<cdot> ?t)) \\<cdot> (L - ?T)\n  \\<lbrakk>Tmin \\<le> ?T; ?T \\<le> Tmax; 0 \\<le> ?t;\n   \\<forall>\\<tau>\\<in>{0..?t}. \\<tau> \\<le> - (ln (Tmin / ?T) / a)\\<rbrakk>\n  \\<Longrightarrow> Tmin \\<le> exp (- a \\<cdot> ?t) \\<cdot> ?T\n  \\<lbrakk>Tmin \\<le> ?T; ?T \\<le> Tmax; 0 \\<le> ?t;\n   \\<forall>\\<tau>\\<in>{0..?t}. \\<tau> \\<le> - (ln (Tmin / ?T) / a)\\<rbrakk>\n  \\<Longrightarrow> exp (- a \\<cdot> ?t) \\<cdot> ?T \\<le> Tmax\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       Tmin \\<le> s $ 1 \\<and>\n       s $ 1 \\<le> Tmax \\<and> (s $ 4 = 0 \\<or> s $ 4 = 1) \\<longrightarrow>\n       (s $ 4 = 0 \\<longrightarrow>\n        s $ 1 \\<le> Tmin + 1 \\<longrightarrow>\n        (\\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                \\<tau>\n                \\<le> - (ln ((L - Tmax) / (L - s $ 1)) /\n                         a)) \\<longrightarrow>\n            Tmin \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1) \\<and>\n            L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1)\n            \\<le> Tmax)) \\<and>\n       (s $ 4 = 0 \\<and> s $ 1 \\<le> Tmin + 1 \\<or>\n        (s $ 4 = 1 \\<longrightarrow>\n         Tmax - 1 \\<le> s $ 1 \\<longrightarrow>\n         (\\<forall>t\\<ge>0.\n             (\\<forall>\\<tau>.\n                 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                 \\<tau> \\<le> - (ln (Tmin / s $ 1) / a)) \\<longrightarrow>\n             Tmin \\<le> exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<and>\n             exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<le> Tmax)) \\<and>\n        (s $ 4 = 1 \\<and> Tmax - 1 \\<le> s $ 1 \\<or>\n         (s $ 4 = 0 \\<longrightarrow>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau> \\<le> - (ln (Tmin / s $ 1) / a)) \\<longrightarrow>\n              Tmin \\<le> exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<and>\n              exp (- (a \\<cdot> t)) \\<cdot> s $ 1 \\<le> Tmax)) \\<and>\n         (s $ 4 = 0 \\<or>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau>\n                  \\<le> - (ln ((L - Tmax) / (L - s $ 1)) /\n                           a)) \\<longrightarrow>\n              Tmin\n              \\<le> L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1) \\<and>\n              L - exp (- (a \\<cdot> t)) \\<cdot> (L - s $ 1) \\<le> Tmax))))", "by auto"], ["", "no_notation temp_vec_field (\"f\")\n        and temp_flow (\"\\<phi>\")"], ["", "subsubsection \\<open> Tank \\<close>"], ["", "text \\<open> A controller turns a water pump on and off to keep the level of water @{text \"h\"} in a tank\nwithin an acceptable range @{text \"hmin \\<le> h \\<le> hmax\"}. Just like in the previous example, after \neach intervention, the controller registers the current level of water and resets its chronometer,\nthen it changes the status of the water pump accordingly. The level of water grows linearly \n@{text \"h' = k\"} at a rate of @{text \"k = c\\<^sub>i-c\\<^sub>o\"} if the pump is on, and at a rate of \n@{text \"k = -c\\<^sub>o\"} if the pump is off. We use @{term \"1::4\"} to denote the tank's level of water,\n@{term \"2::4\"} is time as measured by the controller's chronometer, @{term \"3::4\"} is the\nlevel of water measured by the chronometer, and @{term \"4::4\"} states whether the pump is on\n(@{text \"s$4 = 1\"}) or off (@{text \"s$4 = 0\"}). We prove that the controller keeps the level of\nwater between @{text \"hmin\"} and @{text \"hmax\"}. \\<close>"], ["", "abbreviation tank_vec_field :: \"real \\<Rightarrow> real^4 \\<Rightarrow> real^4\" (\"f\")\n  where \"f k s \\<equiv> (\\<chi> i. if i = 2 then 1 else (if i = 1 then k else 0))\""], ["", "abbreviation tank_flow :: \"real \\<Rightarrow> real \\<Rightarrow> real^4 \\<Rightarrow> real^4\" (\"\\<phi>\")\n  where \"\\<phi> k \\<tau> s \\<equiv> (\\<chi> i. if i = 1 then k * \\<tau> + s$1 else \n  (if i = 2 then \\<tau> + s$2 else s$i))\""], ["", "abbreviation tank_guard :: \"real \\<Rightarrow> real \\<Rightarrow> real^4 \\<Rightarrow> bool\" (\"G\")\n  where \"G Hm k s \\<equiv> s$2 \\<le> (Hm - s$3)/k\""], ["", "abbreviation tank_loop_inv :: \"real \\<Rightarrow> real \\<Rightarrow> real^4 \\<Rightarrow> bool\" (\"I\")\n  where \"I hmin hmax s \\<equiv> hmin \\<le> s$1 \\<and> s$1 \\<le> hmax \\<and> (s$4 = 0 \\<or> s$4 = 1)\""], ["", "abbreviation tank_diff_inv :: \"real \\<Rightarrow> real \\<Rightarrow> real \\<Rightarrow> real^4 \\<Rightarrow> bool\" (\"dI\")\n  where \"dI hmin hmax k s \\<equiv> s$1 = k * s$2 + s$3 \\<and> 0 \\<le> s$2 \\<and> \n    hmin \\<le> s$3 \\<and> s$3 \\<le> hmax \\<and> (s$4 =0 \\<or> s$4 = 1)\""], ["", "lemma local_flow_tank: \"local_flow (f k) UNIV UNIV (\\<phi> k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. local_flow (f k) UNIV UNIV (\\<phi> k)", "apply (unfold_locales, unfold local_lipschitz_def lipschitz_on_def, simp_all, clarsimp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x t.\n       \\<exists>u>0.\n          (\\<exists>ta. dist t ta \\<le> u) \\<longrightarrow>\n          (\\<exists>L\\<ge>0.\n              \\<forall>xa\\<in>cball x u.\n                 \\<forall>y\\<in>cball x u. 0 \\<le> L \\<cdot> dist xa y)\n 2. \\<And>t s.\n       \\<forall>i.\n          (i = 1 \\<longrightarrow>\n            D (\\<lambda>x. k \\<cdot> x + s $ 1) = (\\<lambda>x. k)\n            on {0--t}) \\<and>\n          (i \\<noteq> 1 \\<longrightarrow>\n           (i = 2 \\<longrightarrow>\n             D (\\<lambda>x. x + s $ 2) = (\\<lambda>x. 1) on {0--t}) \\<and>\n           (i \\<noteq> 2 \\<longrightarrow>\n             D (\\<lambda>x. s $ i) = (\\<lambda>x. 0) on {0--t}))\n 3. \\<And>s. \\<phi> k 0 s = s", "apply(rule_tac x=\"1/2\" in exI, clarsimp, rule_tac x=1 in exI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x t ta.\n       dist t ta \\<cdot> 2 \\<le> 1 \\<Longrightarrow>\n       0 \\<le> 1 \\<and>\n       (\\<forall>xa\\<in>cball x (1 / 2).\n           \\<forall>y\\<in>cball x (1 / 2). 0 \\<le> 1 \\<cdot> dist xa y)\n 2. \\<And>t s.\n       \\<forall>i.\n          (i = 1 \\<longrightarrow>\n            D (\\<lambda>x. k \\<cdot> x + s $ 1) = (\\<lambda>x. k)\n            on {0--t}) \\<and>\n          (i \\<noteq> 1 \\<longrightarrow>\n           (i = 2 \\<longrightarrow>\n             D (\\<lambda>x. x + s $ 2) = (\\<lambda>x. 1) on {0--t}) \\<and>\n           (i \\<noteq> 2 \\<longrightarrow>\n             D (\\<lambda>x. s $ i) = (\\<lambda>x. 0) on {0--t}))\n 3. \\<And>s. \\<phi> k 0 s = s", "apply(simp add: dist_norm norm_vec_def L2_set_def, unfold UNIV_4)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x t ta.\n       \\<bar>t - ta\\<bar> \\<cdot> 2 \\<le> 1 \\<Longrightarrow>\n       \\<forall>xa\\<in>cball x (1 / 2).\n          \\<forall>y\\<in>cball x (1 / 2).\n             0 \\<le> (\\<Sum>i\\<in>{1, 2, 3, 4}. (xa $ i - y $ i)\\<^sup>2)\n 2. \\<And>t s.\n       \\<forall>i.\n          (i = 1 \\<longrightarrow>\n            D (\\<lambda>x. k \\<cdot> x + s $ 1) = (\\<lambda>x. k)\n            on {0--t}) \\<and>\n          (i \\<noteq> 1 \\<longrightarrow>\n           (i = 2 \\<longrightarrow>\n             D (\\<lambda>x. x + s $ 2) = (\\<lambda>x. 1) on {0--t}) \\<and>\n           (i \\<noteq> 2 \\<longrightarrow>\n             D (\\<lambda>x. s $ i) = (\\<lambda>x. 0) on {0--t}))\n 3. \\<And>s. \\<phi> k 0 s = s", "by (auto intro!: poly_derivatives simp: vec_eq_iff)"], ["", "lemma tank_arith:\n  assumes \"0 \\<le> (\\<tau>::real)\" and \"0 < c\\<^sub>o\" and \"c\\<^sub>o < c\\<^sub>i\"\n  shows \"\\<forall>\\<tau>\\<in>{0..\\<tau>}. \\<tau> \\<le> - ((hmin - y) / c\\<^sub>o) \\<Longrightarrow>  hmin \\<le> y - c\\<^sub>o * \\<tau>\"\n    and \"\\<forall>\\<tau>\\<in>{0..\\<tau>}. \\<tau> \\<le> (hmax - y) / (c\\<^sub>i - c\\<^sub>o) \\<Longrightarrow>  (c\\<^sub>i - c\\<^sub>o) * \\<tau> + y \\<le> hmax\"\n    and \"hmin \\<le> y \\<Longrightarrow> hmin \\<le> (c\\<^sub>i - c\\<^sub>o) * \\<tau> + y\"\n    and \"y \\<le> hmax \\<Longrightarrow> y - c\\<^sub>o * \\<tau> \\<le> hmax\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<forall>\\<tau>\\<in>{0..\\<tau>}.\n         \\<tau> \\<le> - ((hmin - y) / c\\<^sub>o) \\<Longrightarrow>\n      hmin \\<le> y - c\\<^sub>o \\<cdot> \\<tau>) &&&\n     (\\<forall>\\<tau>\\<in>{0..\\<tau>}.\n         \\<tau> \\<le> (hmax - y) / (c\\<^sub>i - c\\<^sub>o) \\<Longrightarrow>\n      (c\\<^sub>i - c\\<^sub>o) \\<cdot> \\<tau> + y \\<le> hmax)) &&&\n    (hmin \\<le> y \\<Longrightarrow>\n     hmin \\<le> (c\\<^sub>i - c\\<^sub>o) \\<cdot> \\<tau> + y) &&&\n    (y \\<le> hmax \\<Longrightarrow> y - c\\<^sub>o \\<cdot> \\<tau> \\<le> hmax)", "apply(simp_all add: field_simps le_divide_eq assms)"], ["proof (prove)\ngoal (2 subgoals):\n 1. hmin \\<le> y \\<Longrightarrow>\n    hmin + \\<tau> \\<cdot> c\\<^sub>o \\<le> y + \\<tau> \\<cdot> c\\<^sub>i\n 2. y \\<le> hmax \\<Longrightarrow> y \\<le> hmax + \\<tau> \\<cdot> c\\<^sub>o", "using assms"], ["proof (prove)\nusing this:\n  0 \\<le> \\<tau>\n  0 < c\\<^sub>o\n  c\\<^sub>o < c\\<^sub>i\n\ngoal (2 subgoals):\n 1. hmin \\<le> y \\<Longrightarrow>\n    hmin + \\<tau> \\<cdot> c\\<^sub>o \\<le> y + \\<tau> \\<cdot> c\\<^sub>i\n 2. y \\<le> hmax \\<Longrightarrow> y \\<le> hmax + \\<tau> \\<cdot> c\\<^sub>o", "apply (meson add_mono less_eq_real_def mult_left_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<le> hmax \\<Longrightarrow> y \\<le> hmax + \\<tau> \\<cdot> c\\<^sub>o", "using assms"], ["proof (prove)\nusing this:\n  0 \\<le> \\<tau>\n  0 < c\\<^sub>o\n  c\\<^sub>o < c\\<^sub>i\n\ngoal (1 subgoal):\n 1. y \\<le> hmax \\<Longrightarrow> y \\<le> hmax + \\<tau> \\<cdot> c\\<^sub>o", "by (meson add_increasing2 less_eq_real_def mult_nonneg_nonneg)"], ["", "lemma tank_flow:\n  assumes \"0 < c\\<^sub>o\" and \"c\\<^sub>o < c\\<^sub>i\"\n  shows \"\\<lceil>\\<lambda>s. I hmin hmax s\\<rceil> \\<le> wp\n  (LOOP \n    \\<comment> \\<open>control\\<close>\n    ((2 ::=(\\<lambda>s.0));(3 ::=(\\<lambda>s. s$1));\n    (IF (\\<lambda>s. s$4 = 0 \\<and> s$3 \\<le> hmin + 1) THEN (4 ::= (\\<lambda>s.1)) ELSE \n    (IF (\\<lambda>s. s$4 = 1 \\<and> s$3 \\<ge> hmax - 1) THEN (4 ::= (\\<lambda>s.0)) ELSE skip));\n    \\<comment> \\<open>dynamics\\<close>\n    (IF (\\<lambda>s. s$4 = 0) THEN (x\\<acute>= f (c\\<^sub>i-c\\<^sub>o) & (G hmax (c\\<^sub>i-c\\<^sub>o))) \n     ELSE (x\\<acute>= f (-c\\<^sub>o) & (G hmin (-c\\<^sub>o)))) ) INV I hmin hmax) \n  \\<lceil>\\<lambda>s. I hmin hmax s\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>I hmin hmax\\<rceil>\n    \\<subseteq> wp (LOOP (2 ::= (\\<lambda>s. 0)) ;\n                         (3 ::= (\\<lambda>s. s $ 1)) ;\n                         (IF (\\<lambda>s.\n                                 s $ 4 = 0 \\<and>\n                                 s $ 3\n                                 \\<le> hmin +\n 1) THEN (4 ::= (\\<lambda>s.\n                    1)) ELSE IF (\\<lambda>s.\n                                    s $ 4 = 1 \\<and>\n                                    hmax - 1\n                                    \\<le> s $\n    3) THEN (4 ::= (\\<lambda>s. 0)) ELSE skip) ;\n                         (IF (\\<lambda>s.\n                                 s $ 4 =\n                                 0) THEN x\\<acute>=\\<lambda>t.\n                f (c\\<^sub>i -\n                   c\\<^sub>o) & G hmax\n                                 (c\\<^sub>i -\n                                  c\\<^sub>o) on \\<lambda>s.\n             {t. 0 \\<le> t} UNIV @ 0 ELSE x\\<acute>=\\<lambda>t.\n                 f (- c\\<^sub>o) & G hmin\n                                    (- c\\<^sub>o) on \\<lambda>s.\n                  {t. 0 \\<le> t} UNIV @ 0) INV I hmin hmax )\n                 \\<lceil>I hmin hmax\\<rceil>", "apply(rule wp_loopI, simp_all add: local_flow.wp_g_ode_subset[OF local_flow_tank])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I hmin hmax s \\<longrightarrow>\n       (s $ 4 = 0 \\<longrightarrow>\n        s $ 1 \\<le> hmin + 1 \\<longrightarrow>\n        (\\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                \\<tau>\n                \\<le> - ((hmin - s $ 1) / c\\<^sub>o)) \\<longrightarrow>\n            hmin \\<le> s $ 1 - c\\<^sub>o \\<cdot> t \\<and>\n            s $ 1 - c\\<^sub>o \\<cdot> t \\<le> hmax)) \\<and>\n       (s $ 4 = 0 \\<and> s $ 1 \\<le> hmin + 1 \\<or>\n        (s $ 4 = 1 \\<longrightarrow>\n         hmax - 1 \\<le> s $ 1 \\<longrightarrow>\n         (\\<forall>t\\<ge>0.\n             (\\<forall>\\<tau>.\n                 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                 \\<tau>\n                 \\<le> (hmax - s $ 1) /\n                       (c\\<^sub>i - c\\<^sub>o)) \\<longrightarrow>\n             hmin \\<le> (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<and>\n             (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<le> hmax)) \\<and>\n        (s $ 4 = 1 \\<and> hmax - 1 \\<le> s $ 1 \\<or>\n         (s $ 4 = 0 \\<longrightarrow>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau>\n                  \\<le> (hmax - s $ 1) /\n                        (c\\<^sub>i - c\\<^sub>o)) \\<longrightarrow>\n              hmin \\<le> (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<and>\n              (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<le> hmax)) \\<and>\n         (s $ 4 = 0 \\<or>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau>\n                  \\<le> - ((hmin - s $ 1) / c\\<^sub>o)) \\<longrightarrow>\n              hmin \\<le> s $ 1 - c\\<^sub>o \\<cdot> t \\<and>\n              s $ 1 - c\\<^sub>o \\<cdot> t \\<le> hmax))))", "using assms tank_arith[OF _ assms]"], ["proof (prove)\nusing this:\n  0 < c\\<^sub>o\n  c\\<^sub>o < c\\<^sub>i\n  \\<lbrakk>0 \\<le> ?\\<tau>;\n   \\<forall>\\<tau>\\<in>{0..?\\<tau>}.\n      \\<tau> \\<le> - ((?hmin - ?y) / c\\<^sub>o)\\<rbrakk>\n  \\<Longrightarrow> ?hmin \\<le> ?y - c\\<^sub>o \\<cdot> ?\\<tau>\n  \\<lbrakk>0 \\<le> ?\\<tau>;\n   \\<forall>\\<tau>\\<in>{0..?\\<tau>}.\n      \\<tau> \\<le> (?hmax - ?y) / (c\\<^sub>i - c\\<^sub>o)\\<rbrakk>\n  \\<Longrightarrow> (c\\<^sub>i - c\\<^sub>o) \\<cdot> ?\\<tau> + ?y \\<le> ?hmax\n  \\<lbrakk>0 \\<le> ?\\<tau>; ?hmin \\<le> ?y\\<rbrakk>\n  \\<Longrightarrow> ?hmin \\<le> (c\\<^sub>i - c\\<^sub>o) \\<cdot> ?\\<tau> + ?y\n  \\<lbrakk>0 \\<le> ?\\<tau>; ?y \\<le> ?hmax\\<rbrakk>\n  \\<Longrightarrow> ?y - c\\<^sub>o \\<cdot> ?\\<tau> \\<le> ?hmax\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I hmin hmax s \\<longrightarrow>\n       (s $ 4 = 0 \\<longrightarrow>\n        s $ 1 \\<le> hmin + 1 \\<longrightarrow>\n        (\\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                \\<tau>\n                \\<le> - ((hmin - s $ 1) / c\\<^sub>o)) \\<longrightarrow>\n            hmin \\<le> s $ 1 - c\\<^sub>o \\<cdot> t \\<and>\n            s $ 1 - c\\<^sub>o \\<cdot> t \\<le> hmax)) \\<and>\n       (s $ 4 = 0 \\<and> s $ 1 \\<le> hmin + 1 \\<or>\n        (s $ 4 = 1 \\<longrightarrow>\n         hmax - 1 \\<le> s $ 1 \\<longrightarrow>\n         (\\<forall>t\\<ge>0.\n             (\\<forall>\\<tau>.\n                 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                 \\<tau>\n                 \\<le> (hmax - s $ 1) /\n                       (c\\<^sub>i - c\\<^sub>o)) \\<longrightarrow>\n             hmin \\<le> (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<and>\n             (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<le> hmax)) \\<and>\n        (s $ 4 = 1 \\<and> hmax - 1 \\<le> s $ 1 \\<or>\n         (s $ 4 = 0 \\<longrightarrow>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau>\n                  \\<le> (hmax - s $ 1) /\n                        (c\\<^sub>i - c\\<^sub>o)) \\<longrightarrow>\n              hmin \\<le> (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<and>\n              (c\\<^sub>i - c\\<^sub>o) \\<cdot> t + s $ 1 \\<le> hmax)) \\<and>\n         (s $ 4 = 0 \\<or>\n          (\\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  \\<tau>\n                  \\<le> - ((hmin - s $ 1) / c\\<^sub>o)) \\<longrightarrow>\n              hmin \\<le> s $ 1 - c\\<^sub>o \\<cdot> t \\<and>\n              s $ 1 - c\\<^sub>o \\<cdot> t \\<le> hmax))))", "by auto"], ["", "no_notation tank_vec_field (\"f\")\n        and tank_flow (\"\\<phi>\")\n        and tank_loop_inv (\"I\")\n        and tank_diff_inv (\"dI\")\n        and tank_guard (\"G\")"], ["", "end"]]}