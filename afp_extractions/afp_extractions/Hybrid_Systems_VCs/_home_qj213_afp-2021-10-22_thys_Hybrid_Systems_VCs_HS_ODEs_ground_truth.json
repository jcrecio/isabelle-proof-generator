{"file_name": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs/HS_ODEs.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs", "problem_names": ["lemma image_le_pred[simp]: \"(\\<P> f A \\<subseteq> {s. G s}) = (\\<forall>x\\<in>A. G (f x))\"", "lemma ivp_solsI: \n  assumes \"D X = (\\<lambda>t. f t (X t)) on U s\" and \"X t\\<^sub>0 = s\" \n      and \"X \\<in> U s \\<rightarrow> S\" and \"t\\<^sub>0 \\<in> U s\"\n    shows \"X \\<in> Sols f U S t\\<^sub>0 s\"", "lemma ivp_solsD:\n  assumes \"X \\<in> Sols f U S t\\<^sub>0 s\"\n  shows \"D X = (\\<lambda>t. f t (X t)) on U s\" and \"X t\\<^sub>0 = s\" \n    and \"X \\<in> U s \\<rightarrow> S\" and \"t\\<^sub>0 \\<in> U s\"", "lemma in_ivp_sols_subset:\n  \"t\\<^sub>0 \\<in> (U s) \\<Longrightarrow> (U s) \\<subseteq> (T s) \\<Longrightarrow> X \\<in> Sols f T S t\\<^sub>0 s \\<Longrightarrow> X \\<in> Sols f U S t\\<^sub>0 s \"", "lemma g_orbit_eq: \n  fixes X::\"('a::preorder) \\<Rightarrow> 'b\"\n  shows \"\\<gamma> X G U = {X t |t. t \\<in> U \\<and> (\\<forall>\\<tau>\\<in>down U t. G (X \\<tau>))}\"", "lemma g_orbital_eq: \"g_orbital f G U S t\\<^sub>0 s = \n  {X t |t X. t \\<in> U s \\<and> \\<P> X (down (U s) t) \\<subseteq> {s. G s} \\<and> X \\<in> Sols f U S t\\<^sub>0 s }\"", "lemma g_orbitalI:\n  assumes \"X \\<in> Sols f U S t\\<^sub>0 s\"\n    and \"t \\<in> U s\" and \"(\\<P> X (down (U s) t) \\<subseteq> {s. G s})\"\n  shows \"X t \\<in> g_orbital f G U S t\\<^sub>0 s\"", "lemma g_orbitalD:\n  assumes \"s' \\<in> g_orbital f G U S t\\<^sub>0 s\"\n  obtains X and t where \"X \\<in> Sols f U S t\\<^sub>0 s\"\n  and \"X t = s'\" and \"t \\<in> U s\" and \"(\\<P> X (down (U s) t) \\<subseteq> {s. G s})\"", "lemma \"g_orbital f G U S t\\<^sub>0 s = {X t |t X. X t \\<in> \\<gamma> X G (U s) \\<and> X \\<in> Sols f U S t\\<^sub>0 s}\"", "lemma \"X \\<in> Sols f U S t\\<^sub>0 s \\<Longrightarrow> \\<gamma> X G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s\"", "lemma \"g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbital f (\\<lambda>s. True) U S t\\<^sub>0 s\"", "lemma diff_invariant_eq: \"diff_invariant I f U S t\\<^sub>0 G = \n  (\\<forall>s. I s \\<longrightarrow> (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s. (\\<forall>t\\<in>U s.(\\<forall>\\<tau>\\<in>(down (U s) t). G (X \\<tau>)) \\<longrightarrow> I (X t))))\"", "lemma diff_inv_eq_inv_set:\n  \"diff_invariant I f U S t\\<^sub>0 G = (\\<forall>s. I s \\<longrightarrow> (g_orbital f G U S t\\<^sub>0 s) \\<subseteq> {s. I s})\"", "lemma \"diff_invariant I f U S t\\<^sub>0 (\\<lambda>s. True) \\<Longrightarrow> diff_invariant I f U S t\\<^sub>0 G\"", "lemma diff_invariant_eq_rule [diff_invariant_rules]:\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\"\n    and dX: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (D (\\<lambda>\\<tau>. \\<mu>(X \\<tau>)-\\<nu>(X \\<tau>)) = ((*\\<^sub>R) 0) on U(X t\\<^sub>0))\"\n  shows \"diff_invariant (\\<lambda>s. \\<mu> s = \\<nu> s) f U S t\\<^sub>0 G\"", "lemma diff_invariant_leq_rule [diff_invariant_rules]:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\"\n    and Gg: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> > t\\<^sub>0 \\<longrightarrow> G (X \\<tau>) \\<longrightarrow> \\<mu>' (X \\<tau>) \\<ge> \\<nu>' (X \\<tau>))\"\n    and Gl: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> < t\\<^sub>0 \\<longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))\"\n    and dX: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> D (\\<lambda>\\<tau>. \\<mu>(X \\<tau>)-\\<nu>(X \\<tau>)) = (\\<lambda>\\<tau>. \\<mu>'(X \\<tau>)-\\<nu>'(X \\<tau>)) on U(X t\\<^sub>0)\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s \\<le> \\<mu> s) f U S t\\<^sub>0 G\"", "lemma diff_invariant_less_rule [diff_invariant_rules]:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\"\n    and Gg: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> > t\\<^sub>0 \\<longrightarrow> G (X \\<tau>) \\<longrightarrow> \\<mu>' (X \\<tau>) \\<ge> \\<nu>' (X \\<tau>))\"\n    and Gl: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> < t\\<^sub>0 \\<longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))\"\n    and dX: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> D (\\<lambda>\\<tau>. \\<mu>(X \\<tau>)-\\<nu>(X \\<tau>)) = (\\<lambda>\\<tau>. \\<mu>'(X \\<tau>)-\\<nu>'(X \\<tau>)) on U(X t\\<^sub>0)\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G\"", "lemma diff_invariant_nleq_rule:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  shows \"diff_invariant (\\<lambda>s. \\<not> \\<nu> s \\<le> \\<mu> s) f U S t\\<^sub>0 G \\<longleftrightarrow> diff_invariant (\\<lambda>s. \\<nu> s > \\<mu> s) f U S t\\<^sub>0 G\"", "lemma diff_invariant_neq_rule [diff_invariant_rules]:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes \"diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G\"\n    and \"diff_invariant (\\<lambda>s. \\<nu> s > \\<mu> s) f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s \\<noteq> \\<mu> s) f U S t\\<^sub>0 G\"", "lemma diff_invariant_neq_rule_converse:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\" \"\\<And>s t. s \\<in> S \\<Longrightarrow> t \\<in> U s \\<Longrightarrow> t\\<^sub>0 \\<le> t\"\n    and conts: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> continuous_on (\\<P> X (U (X t\\<^sub>0))) \\<nu>\"\n      \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> continuous_on (\\<P> X (U (X t\\<^sub>0))) \\<mu>\"\n    and dI:\"diff_invariant (\\<lambda>s. \\<nu> s \\<noteq> \\<mu> s) f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G\"", "lemma diff_invariant_conj_rule [diff_invariant_rules]:\n  assumes \"diff_invariant I\\<^sub>1 f U S t\\<^sub>0 G\"\n    and \"diff_invariant I\\<^sub>2 f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<and> I\\<^sub>2 s) f U S t\\<^sub>0 G\"", "lemma diff_invariant_disj_rule [diff_invariant_rules]:\n  assumes \"diff_invariant I\\<^sub>1 f U S t\\<^sub>0 G\"\n    and \"diff_invariant I\\<^sub>2 f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<or> I\\<^sub>2 s) f U S t\\<^sub>0 G\"", "lemma ll_on_open: \"ll_on_open T f S\"", "lemmas subintervalI = closed_segment_subset_domain\n   and init_time_ex_ivl = existence_ivl_initial_time[OF init_time]\n   and flow_at_init[simp] = general.flow_initial_time[OF init_time]", "lemma flow_has_vderiv_on_ex_ivl:\n  assumes \"s \\<in> S\"\n  shows \"D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s\"", "lemma flow_funcset_ex_ivl:\n  assumes \"s \\<in> S\"\n  shows \"flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S\"", "lemma flow_in_ivp_sols_ex_ivl:\n  assumes \"s \\<in> S\"\n  shows \"flow t\\<^sub>0 s \\<in> Sols f (\\<lambda>s. ex_ivl s) S t\\<^sub>0 s\"", "lemma csols_eq: \"csols t\\<^sub>0 s = {(x, t). t \\<in> T \\<and>  x \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s}\"", "lemma subset_ex_ivlI:\n  \"Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s \\<Longrightarrow> {t\\<^sub>0--t} \\<subseteq> T \\<Longrightarrow> A \\<subseteq> {t\\<^sub>0--t} \\<Longrightarrow> A \\<subseteq> ex_ivl s\"", "lemma unique_solution: \\<comment> \\<open> proved for a subset of T for general applications \\<close>\n  assumes \"s \\<in> S\" and \"t\\<^sub>0 \\<in> U\" and \"t \\<in> U\" \n    and \"is_interval U\" and \"U \\<subseteq> ex_ivl s\" \n    and xivp: \"D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on U\" \"Y\\<^sub>1 t\\<^sub>0 = s\" \"Y\\<^sub>1 \\<in> U \\<rightarrow> S\"\n    and yivp: \"D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on U\" \"Y\\<^sub>2 t\\<^sub>0 = s\" \"Y\\<^sub>2 \\<in> U \\<rightarrow> S\"\n  shows \"Y\\<^sub>1 t = Y\\<^sub>2 t\"", "lemma unique_solution_closed_ivl:\n  assumes xivp: \"D X = (\\<lambda>t. f t (X t)) on {t\\<^sub>0--t}\" \"X t\\<^sub>0 = s\" \"X \\<in> {t\\<^sub>0--t} \\<rightarrow> S\" and \"t \\<in> T\"\n    and yivp: \"D Y = (\\<lambda>t. f t (Y t)) on {t\\<^sub>0--t}\" \"Y t\\<^sub>0 = s\" \"Y \\<in> {t\\<^sub>0--t} \\<rightarrow> S\" and \"s \\<in> S\" \n  shows \"X t = Y t\"", "lemma solution_eq_flow:\n  assumes xivp: \"D X = (\\<lambda>t. f t (X t)) on ex_ivl s\" \"X t\\<^sub>0 = s\" \"X \\<in> ex_ivl s \\<rightarrow> S\" \n    and \"t \\<in> ex_ivl s\" and \"s \\<in> S\" \n  shows \"X t = flow t\\<^sub>0 s t\"", "lemma ivp_unique_solution:\n  assumes \"s \\<in> S\" and ivl: \"is_interval (U s)\" and \"U s \\<subseteq> T\" and \"t \\<in> U s\" \n    and ivp1: \"Y\\<^sub>1 \\<in> Sols f U S t\\<^sub>0 s\" and ivp2: \"Y\\<^sub>2 \\<in> Sols f U S t\\<^sub>0 s\"\n  shows \"Y\\<^sub>1 t = Y\\<^sub>2 t\"", "lemma g_orbital_orbit:\n  assumes \"s \\<in> S\" and ivl: \"is_interval (U s)\" and \"U s \\<subseteq> T\"\n    and ivp: \"Y \\<in> Sols f U S t\\<^sub>0 s\"\n  shows \"g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)\"", "lemma local_lipschitz_add: \n  fixes f1 f2 :: \"real \\<Rightarrow> 'a::banach \\<Rightarrow> 'a\"\n  assumes \"local_lipschitz T S f1\"\n      and \"local_lipschitz T S f2\" \n    shows \"local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)\"", "lemma picard_lindeloef_add: \"picard_lindeloef f1 T S t\\<^sub>0 \\<Longrightarrow> picard_lindeloef f2 T S t\\<^sub>0 \\<Longrightarrow> \n  picard_lindeloef (\\<lambda>t s. f1 t s + f2 t s) T S t\\<^sub>0\"", "lemma picard_lindeloef_constant: \"picard_lindeloef (\\<lambda>t s. c) UNIV UNIV t\\<^sub>0\"", "lemma in_ivp_sols_ivl: \n  assumes \"t \\<in> T\" \"s \\<in> S\"\n  shows \"(\\<lambda>t. \\<phi> t s) \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {0--t}) S 0 s\"", "lemma eq_solution_ivl:\n  assumes xivp: \"D X = (\\<lambda>t. f (X t)) on {0--t}\" \"X 0 = s\" \"X \\<in> {0--t} \\<rightarrow> S\" \n    and indom: \"t \\<in> T\" \"s \\<in> S\"\n  shows \"X t = \\<phi> t s\"", "lemma ex_ivl_eq:\n  assumes \"s \\<in> S\"\n  shows \"ex_ivl s = T\"", "lemma has_derivative_on_open1: \n  assumes  \"t > 0\" \"t \\<in> T\" \"s \\<in> S\"\n  obtains B where \"t \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within B\"", "lemma has_derivative_on_open2: \n  assumes \"t < 0\" \"t \\<in> T\" \"s \\<in> S\"\n  obtains B where \"t \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within B\"", "lemma has_derivative_on_open3: \n  assumes \"s \\<in> S\"\n  obtains B where \"0 \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s)) at 0 within B\"", "lemma has_derivative_on_open: \n  assumes \"t \\<in> T\" \"s \\<in> S\"\n  obtains B where \"t \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within B\"", "lemma in_domain:\n  assumes \"s \\<in> S\"\n  shows \"(\\<lambda>t. \\<phi> t s) \\<in> T \\<rightarrow> S\"", "lemma has_vderiv_on_domain:\n  assumes \"s \\<in> S\"\n  shows \"D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on T\"", "lemma in_ivp_sols: \n  assumes \"s \\<in> S\" and \"0 \\<in> U s\" and \"U s \\<subseteq> T\"\n  shows \"(\\<lambda>t. \\<phi> t s) \\<in> Sols (\\<lambda>t. f) U S 0 s\"", "lemma eq_solution:\n  assumes \"s \\<in> S\" and \"is_interval (U s)\" and \"U s \\<subseteq> T\" and \"t \\<in> U s\"\n    and xivp: \"X \\<in> Sols (\\<lambda>t. f) U S 0 s\"\n  shows \"X t = \\<phi> t s\"", "lemma ivp_sols_collapse: \n  assumes \"T = UNIV\" and \"s \\<in> S\"\n  shows \"Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 s = {(\\<lambda>t. \\<phi> t s)}\"", "lemma additive_in_ivp_sols:\n  assumes \"s \\<in> S\" and \"\\<P> (\\<lambda>\\<tau>. \\<tau> + t) T \\<subseteq> T\"\n  shows \"(\\<lambda>\\<tau>. \\<phi> (\\<tau> + t) s) \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 (\\<phi> (0 + t) s)\"", "lemma is_monoid_action:\n  assumes \"s \\<in> S\" and \"T = UNIV\"\n  shows \"\\<phi> 0 s = s\" and \"\\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)\"", "lemma g_orbital_collapses: \n  assumes \"s \\<in> S\" and \"is_interval (U s)\" and \"U s \\<subseteq> T\" and \"0 \\<in> U s\"\n  shows \"g_orbital (\\<lambda>t. f) G U S 0 s = {\\<phi> t s| t. t \\<in> U s \\<and> (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s))}\"", "lemma orbit_eq: \n  assumes \"s \\<in> S\"\n  shows \"\\<gamma>\\<^sup>\\<phi> s = {\\<phi> t s| t. t \\<in> T}\"", "lemma true_g_orbit_eq:\n  assumes \"s \\<in> S\"\n  shows \"g_orbit (\\<lambda>t. \\<phi> t s) (\\<lambda>s. True) T = \\<gamma>\\<^sup>\\<phi> s\"", "lemma line_is_local_flow: \n  \"0 \\<in> T \\<Longrightarrow> is_interval T \\<Longrightarrow> open T \\<Longrightarrow> local_flow (\\<lambda> s. c) T UNIV (\\<lambda> t s. s + t *\\<^sub>R c)\""], "translations": [["", "lemma image_le_pred[simp]: \"(\\<P> f A \\<subseteq> {s. G s}) = (\\<forall>x\\<in>A. G (f x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<P> f A \\<subseteq> {s. G s}) = (\\<forall>x\\<in>A. G (f x))", "unfolding image_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ({y. \\<exists>x\\<in>A. y = f x} \\<subseteq> {s. G s}) =\n    (\\<forall>x\\<in>A. G (f x))", "by force"], ["", "definition ivp_sols :: \"(real \\<Rightarrow> 'a \\<Rightarrow> ('a::real_normed_vector)) \\<Rightarrow> ('a \\<Rightarrow> real set) \\<Rightarrow> 'a set \\<Rightarrow> \n  real \\<Rightarrow> 'a \\<Rightarrow> (real \\<Rightarrow> 'a) set\" (\"Sols\")\n  where \"Sols f U S t\\<^sub>0 s = {X \\<in> U s \\<rightarrow> S. (D X = (\\<lambda>t. f t (X t)) on U s) \\<and> X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s}\""], ["", "lemma ivp_solsI: \n  assumes \"D X = (\\<lambda>t. f t (X t)) on U s\" and \"X t\\<^sub>0 = s\" \n      and \"X \\<in> U s \\<rightarrow> S\" and \"t\\<^sub>0 \\<in> U s\"\n    shows \"X \\<in> Sols f U S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<in> Sols f U S t\\<^sub>0 s", "using assms"], ["proof (prove)\nusing this:\n   D X = (\\<lambda>t. f t (X t)) on U s\n  X t\\<^sub>0 = s\n  X \\<in> U s \\<rightarrow> S\n  t\\<^sub>0 \\<in> U s\n\ngoal (1 subgoal):\n 1. X \\<in> Sols f U S t\\<^sub>0 s", "unfolding ivp_sols_def"], ["proof (prove)\nusing this:\n   D X = (\\<lambda>t. f t (X t)) on U s\n  X t\\<^sub>0 = s\n  X \\<in> U s \\<rightarrow> S\n  t\\<^sub>0 \\<in> U s\n\ngoal (1 subgoal):\n 1. X \\<in> {X \\<in> U s \\<rightarrow> S.\n              D X = (\\<lambda>t. f t (X t)) on U s \\<and>\n             X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s}", "by blast"], ["", "lemma ivp_solsD:\n  assumes \"X \\<in> Sols f U S t\\<^sub>0 s\"\n  shows \"D X = (\\<lambda>t. f t (X t)) on U s\" and \"X t\\<^sub>0 = s\" \n    and \"X \\<in> U s \\<rightarrow> S\" and \"t\\<^sub>0 \\<in> U s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ( D X = (\\<lambda>t. f t (X t)) on U s &&& X t\\<^sub>0 = s) &&&\n    X \\<in> U s \\<rightarrow> S &&& t\\<^sub>0 \\<in> U s", "using assms"], ["proof (prove)\nusing this:\n  X \\<in> Sols f U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. ( D X = (\\<lambda>t. f t (X t)) on U s &&& X t\\<^sub>0 = s) &&&\n    X \\<in> U s \\<rightarrow> S &&& t\\<^sub>0 \\<in> U s", "unfolding ivp_sols_def"], ["proof (prove)\nusing this:\n  X \\<in> {X \\<in> U s \\<rightarrow> S.\n            D X = (\\<lambda>t. f t (X t)) on U s \\<and>\n           X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s}\n\ngoal (1 subgoal):\n 1. ( D X = (\\<lambda>t. f t (X t)) on U s &&& X t\\<^sub>0 = s) &&&\n    X \\<in> U s \\<rightarrow> S &&& t\\<^sub>0 \\<in> U s", "by auto"], ["", "lemma in_ivp_sols_subset:\n  \"t\\<^sub>0 \\<in> (U s) \\<Longrightarrow> (U s) \\<subseteq> (T s) \\<Longrightarrow> X \\<in> Sols f T S t\\<^sub>0 s \\<Longrightarrow> X \\<in> Sols f U S t\\<^sub>0 s \""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> X \\<in> Sols f U S t\\<^sub>0 s", "apply(rule ivp_solsI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow>  D X = (\\<lambda>t. f t (X t)) on U s\n 2. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> X t\\<^sub>0 = s\n 3. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> X \\<in> U s \\<rightarrow> S\n 4. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> t\\<^sub>0 \\<in> U s", "using ivp_solsD(1,2) has_vderiv_on_subset"], ["proof (prove)\nusing this:\n  ?X \\<in> Sols ?f ?U ?S ?t\\<^sub>0 ?s \\<Longrightarrow>\n   D ?X = (\\<lambda>t. ?f t (?X t)) on ?U ?s\n  ?X \\<in> Sols ?f ?U ?S ?t\\<^sub>0 ?s \\<Longrightarrow> ?X ?t\\<^sub>0 = ?s\n  \\<lbrakk> D ?f = ?f' on ?S; ?T \\<subseteq> ?S\\<rbrakk>\n  \\<Longrightarrow>  D ?f = ?f' on ?T\n\ngoal (4 subgoals):\n 1. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow>  D X = (\\<lambda>t. f t (X t)) on U s\n 2. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> X t\\<^sub>0 = s\n 3. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> X \\<in> U s \\<rightarrow> S\n 4. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> t\\<^sub>0 \\<in> U s", "apply blast+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> X \\<in> U s \\<rightarrow> S\n 2. \\<lbrakk>t\\<^sub>0 \\<in> U s; U s \\<subseteq> T s;\n     X \\<in> Sols f T S t\\<^sub>0 s\\<rbrakk>\n    \\<Longrightarrow> t\\<^sub>0 \\<in> U s", "by (drule ivp_solsD(3)) auto"], ["", "abbreviation \"down U t \\<equiv> {\\<tau> \\<in> U. \\<tau> \\<le> t}\""], ["", "definition g_orbit :: \"(('a::ord) \\<Rightarrow> 'b) \\<Rightarrow> ('b \\<Rightarrow> bool) \\<Rightarrow> 'a set \\<Rightarrow> 'b set\" (\"\\<gamma>\")\n  where \"\\<gamma> X G U = \\<Union>{\\<P> X (down U t) |t. \\<P> X (down U t) \\<subseteq> {s. G s}}\""], ["", "lemma g_orbit_eq: \n  fixes X::\"('a::preorder) \\<Rightarrow> 'b\"\n  shows \"\\<gamma> X G U = {X t |t. t \\<in> U \\<and> (\\<forall>\\<tau>\\<in>down U t. G (X \\<tau>))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<gamma> X G U =\n    {X t |t. t \\<in> U \\<and> (\\<forall>\\<tau>\\<in>down U t. G (X \\<tau>))}", "unfolding g_orbit_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     {\\<P> X (down U t) |t. \\<P> X (down U t) \\<subseteq> Collect G} =\n    {X t |t. t \\<in> U \\<and> (\\<forall>\\<tau>\\<in>down U t. G (X \\<tau>))}", "using order_trans"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x \\<le> ?y; ?y \\<le> ?z\\<rbrakk> \\<Longrightarrow> ?x \\<le> ?z\n\ngoal (1 subgoal):\n 1. \\<Union>\n     {\\<P> X (down U t) |t. \\<P> X (down U t) \\<subseteq> Collect G} =\n    {X t |t. t \\<in> U \\<and> (\\<forall>\\<tau>\\<in>down U t. G (X \\<tau>))}", "by auto blast"], ["", "definition g_orbital :: \"(real \\<Rightarrow> 'a \\<Rightarrow> 'a) \\<Rightarrow> ('a \\<Rightarrow> bool) \\<Rightarrow> ('a \\<Rightarrow> real set) \\<Rightarrow> 'a set \\<Rightarrow> real \\<Rightarrow> \n  ('a::real_normed_vector) \\<Rightarrow> 'a set\" \n  where \"g_orbital f G U S t\\<^sub>0 s = \\<Union>{\\<gamma> X G (U s) |X. X \\<in> ivp_sols f U S t\\<^sub>0 s}\""], ["", "lemma g_orbital_eq: \"g_orbital f G U S t\\<^sub>0 s = \n  {X t |t X. t \\<in> U s \\<and> \\<P> X (down (U s) t) \\<subseteq> {s. G s} \\<and> X \\<in> Sols f U S t\\<^sub>0 s }\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s =\n    {X t |t X.\n     t \\<in> U s \\<and>\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s} \\<and>\n     X \\<in> Sols f U S t\\<^sub>0 s}", "unfolding g_orbital_def ivp_sols_def g_orbit_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union>\n     {{X t |t.\n       t \\<in> U s \\<and>\n       (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>))} |\n      X. X \\<in> {X \\<in> U s \\<rightarrow> S.\n                   D X = (\\<lambda>t. f t (X t)) on U s \\<and>\n                  X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s}} =\n    {X t |t X.\n     t \\<in> U s \\<and>\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s} \\<and>\n     X \\<in> {X \\<in> U s \\<rightarrow> S.\n               D X = (\\<lambda>t. f t (X t)) on U s \\<and>\n              X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s}}", "by auto"], ["", "lemma g_orbitalI:\n  assumes \"X \\<in> Sols f U S t\\<^sub>0 s\"\n    and \"t \\<in> U s\" and \"(\\<P> X (down (U s) t) \\<subseteq> {s. G s})\"\n  shows \"X t \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X t \\<in> g_orbital f G U S t\\<^sub>0 s", "using assms"], ["proof (prove)\nusing this:\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. X t \\<in> g_orbital f G U S t\\<^sub>0 s", "unfolding g_orbital_eq(1)"], ["proof (prove)\nusing this:\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. X t\n    \\<in> {X t |t X.\n           t \\<in> U s \\<and>\n           \\<P> X (down (U s) t) \\<subseteq> Collect G \\<and>\n           X \\<in> Sols f U S t\\<^sub>0 s}", "by auto"], ["", "lemma g_orbitalD:\n  assumes \"s' \\<in> g_orbital f G U S t\\<^sub>0 s\"\n  obtains X and t where \"X \\<in> Sols f U S t\\<^sub>0 s\"\n  and \"X t = s'\" and \"t \\<in> U s\" and \"(\\<P> X (down (U s) t) \\<subseteq> {s. G s})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X t.\n        \\<lbrakk>X \\<in> Sols f U S t\\<^sub>0 s; X t = s'; t \\<in> U s;\n         \\<P> X (down (U s) t) \\<subseteq> {s. G s}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms"], ["proof (prove)\nusing this:\n  s' \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. (\\<And>X t.\n        \\<lbrakk>X \\<in> Sols f U S t\\<^sub>0 s; X t = s'; t \\<in> U s;\n         \\<P> X (down (U s) t) \\<subseteq> {s. G s}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding g_orbital_def g_orbit_eq"], ["proof (prove)\nusing this:\n  s' \\<in> \\<Union>\n            {{X t |t.\n              t \\<in> U s \\<and>\n              (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>))} |\n             X. X \\<in> Sols f U S t\\<^sub>0 s}\n\ngoal (1 subgoal):\n 1. (\\<And>X t.\n        \\<lbrakk>X \\<in> Sols f U S t\\<^sub>0 s; X t = s'; t \\<in> U s;\n         \\<P> X (down (U s) t) \\<subseteq> {s. G s}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["", "lemma \"g_orbital f G U S t\\<^sub>0 s = {X t |t X. X t \\<in> \\<gamma> X G (U s) \\<and> X \\<in> Sols f U S t\\<^sub>0 s}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s =\n    {X t |t X.\n     X t \\<in> \\<gamma> X G (U s) \\<and> X \\<in> Sols f U S t\\<^sub>0 s}", "unfolding g_orbital_eq g_orbit_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. {X t |t X.\n     t \\<in> U s \\<and>\n     \\<P> X (down (U s) t) \\<subseteq> Collect G \\<and>\n     X \\<in> Sols f U S t\\<^sub>0 s} =\n    {X t |t X.\n     X t\n     \\<in> {X t |t.\n            t \\<in> U s \\<and>\n            (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>))} \\<and>\n     X \\<in> Sols f U S t\\<^sub>0 s}", "by auto"], ["", "lemma \"X \\<in> Sols f U S t\\<^sub>0 s \\<Longrightarrow> \\<gamma> X G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<in> Sols f U S t\\<^sub>0 s \\<Longrightarrow>\n    \\<gamma> X G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s", "unfolding g_orbital_eq g_orbit_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<in> Sols f U S t\\<^sub>0 s \\<Longrightarrow>\n    {X t |t.\n     t \\<in> U s \\<and> (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>))}\n    \\<subseteq> {X t |t X.\n                 t \\<in> U s \\<and>\n                 \\<P> X (down (U s) t) \\<subseteq> Collect G \\<and>\n                 X \\<in> Sols f U S t\\<^sub>0 s}", "by auto"], ["", "lemma \"g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbital f (\\<lambda>s. True) U S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s\n    \\<subseteq> g_orbital f (\\<lambda>s. True) U S t\\<^sub>0 s", "unfolding g_orbital_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. {X t |t X.\n     t \\<in> U s \\<and>\n     \\<P> X (down (U s) t) \\<subseteq> Collect G \\<and>\n     X \\<in> Sols f U S t\\<^sub>0 s}\n    \\<subseteq> {X t |t X.\n                 t \\<in> U s \\<and>\n                 \\<P> X (down (U s) t) \\<subseteq> {s. True} \\<and>\n                 X \\<in> Sols f U S t\\<^sub>0 s}", "by auto"], ["", "no_notation g_orbit (\"\\<gamma>\")"], ["", "subsection \\<open> Differential Invariants \\<close>"], ["", "definition diff_invariant :: \"('a \\<Rightarrow> bool) \\<Rightarrow> (real \\<Rightarrow> ('a::real_normed_vector) \\<Rightarrow> 'a) \\<Rightarrow> \n  ('a \\<Rightarrow> real set) \\<Rightarrow> 'a set \\<Rightarrow> real \\<Rightarrow> ('a \\<Rightarrow> bool) \\<Rightarrow> bool\" \n  where \"diff_invariant I f U S t\\<^sub>0 G \\<equiv> (\\<Union> \\<circ> (\\<P> (g_orbital f G U S t\\<^sub>0))) {s. I s} \\<subseteq> {s. I s}\""], ["", "lemma diff_invariant_eq: \"diff_invariant I f U S t\\<^sub>0 G = \n  (\\<forall>s. I s \\<longrightarrow> (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s. (\\<forall>t\\<in>U s.(\\<forall>\\<tau>\\<in>(down (U s) t). G (X \\<tau>)) \\<longrightarrow> I (X t))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I f U S t\\<^sub>0 G =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n            \\<forall>t\\<in>U s.\n               (\\<forall>\\<tau>\\<in>down (U s) t.\n                   G (X \\<tau>)) \\<longrightarrow>\n               I (X t)))", "unfolding diff_invariant_def g_orbital_eq image_le_pred"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<Union> \\<circ>\n      \\<P>\n       (\\<lambda>s.\n           {X t |t X.\n            t \\<in> U s \\<and>\n            (\\<forall>x\\<in>down (U s) t. G (X x)) \\<and>\n            X \\<in> Sols f U S t\\<^sub>0 s}))\n      {s. I s}\n     \\<subseteq> {s. I s}) =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n            \\<forall>t\\<in>U s.\n               (\\<forall>\\<tau>\\<in>down (U s) t.\n                   G (X \\<tau>)) \\<longrightarrow>\n               I (X t)))", "by auto"], ["", "lemma diff_inv_eq_inv_set:\n  \"diff_invariant I f U S t\\<^sub>0 G = (\\<forall>s. I s \\<longrightarrow> (g_orbital f G U S t\\<^sub>0 s) \\<subseteq> {s. I s})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I f U S t\\<^sub>0 G =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        g_orbital f G U S t\\<^sub>0 s \\<subseteq> {s. I s})", "unfolding diff_invariant_eq g_orbital_eq image_le_pred"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>s.\n        I s \\<longrightarrow>\n        (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n            \\<forall>t\\<in>U s.\n               (\\<forall>\\<tau>\\<in>down (U s) t.\n                   G (X \\<tau>)) \\<longrightarrow>\n               I (X t))) =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        {X t |t X.\n         t \\<in> U s \\<and>\n         (\\<forall>x\\<in>down (U s) t. G (X x)) \\<and>\n         X \\<in> Sols f U S t\\<^sub>0 s}\n        \\<subseteq> {s. I s})", "by auto"], ["", "lemma \"diff_invariant I f U S t\\<^sub>0 (\\<lambda>s. True) \\<Longrightarrow> diff_invariant I f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I f U S t\\<^sub>0 (\\<lambda>s. True) \\<Longrightarrow>\n    diff_invariant I f U S t\\<^sub>0 G", "unfolding diff_invariant_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n           \\<forall>t\\<in>U s.\n              (\\<forall>\\<tau>\\<in>down (U s) t. True) \\<longrightarrow>\n              I (X t)) \\<Longrightarrow>\n    \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n           \\<forall>t\\<in>U s.\n              (\\<forall>\\<tau>\\<in>down (U s) t.\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "by auto"], ["", "named_theorems diff_invariant_rules \"rules for certifying differential invariants.\""], ["", "lemma diff_invariant_eq_rule [diff_invariant_rules]:\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\"\n    and dX: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (D (\\<lambda>\\<tau>. \\<mu>(X \\<tau>)-\\<nu>(X \\<tau>)) = ((*\\<^sub>R) 0) on U(X t\\<^sub>0))\"\n  shows \"diff_invariant (\\<lambda>s. \\<mu> s = \\<nu> s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. \\<mu> s = \\<nu> s) f U S t\\<^sub>0 G", "proof(simp add: diff_invariant_eq ivp_sols_def, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<mu> (X t) = \\<nu> (X t)", "fix X t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<mu> (X t) = \\<nu> (X t)", "assume xivp:\"D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U (X t\\<^sub>0)\" \"\\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0)\" \"X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\"\n    and tHyp:\"t \\<in> U (X t\\<^sub>0)\" and t0Hyp: \"t\\<^sub>0 \\<in> U (X t\\<^sub>0)\""], ["proof (state)\nthis:\n   D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U (X t\\<^sub>0)\n  \\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<mu> (X t) = \\<nu> (X t)", "hence \"{t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\""], ["proof (prove)\nusing this:\n   D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U (X t\\<^sub>0)\n  \\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)", "using closed_segment_subset_interval[OF Uhyp t0Hyp tHyp]"], ["proof (prove)\nusing this:\n   D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U (X t\\<^sub>0)\n  \\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n  X t\\<^sub>0 \\<in> S \\<Longrightarrow>\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)", "by blast"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<mu> (X t) = \\<nu> (X t)", "hence \"D (\\<lambda>\\<tau>. \\<mu> (X \\<tau>) - \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R 0) on {t\\<^sub>0--t}\""], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>\\<tau>.\n           \\<mu> (X \\<tau>) -\n           \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R 0)\n     on {t\\<^sub>0--t}", "using has_vderiv_on_subset[OF dX[OF xivp(1)]]"], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  ?T \\<subseteq> U (X t\\<^sub>0) \\<Longrightarrow>\n   D (\\<lambda>\\<tau>. \\<mu> (X \\<tau>) - \\<nu> (X \\<tau>)) = (*\\<^sub>R) 0\n   on ?T\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>\\<tau>.\n           \\<mu> (X \\<tau>) -\n           \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R 0)\n     on {t\\<^sub>0--t}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R 0)\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<mu> (X t) = \\<nu> (X t)", "then"], ["proof (chain)\npicking this:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R 0)\n   on {t\\<^sub>0--t}", "obtain \\<tau> where \"\\<mu> (X t) - \\<nu> (X t) - (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) = (t - t\\<^sub>0) * \\<tau> *\\<^sub>R 0\""], ["proof (prove)\nusing this:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R 0)\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<mu> (X t) - \\<nu> (X t) -\n        (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n        (t - t\\<^sub>0) * \\<tau> *\\<^sub>R 0 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using mvt_very_simple_closed_segmentE"], ["proof (prove)\nusing this:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R 0)\n   on {t\\<^sub>0--t}\n  \\<lbrakk> D ?f = ?f' on {?a--?b};\n   \\<And>y.\n      \\<lbrakk>y \\<in> {?a--?b}; ?f ?b - ?f ?a = (?b - ?a) * ?f' y\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<mu> (X t) - \\<nu> (X t) -\n        (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n        (t - t\\<^sub>0) * \\<tau> *\\<^sub>R 0 \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<mu> (X t) - \\<nu> (X t) - (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n  (t - t\\<^sub>0) * \\<tau> *\\<^sub>R 0\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<mu> (X t\\<^sub>0) = \\<nu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<mu> (X t) = \\<nu> (X t)", "thus \"\\<mu> (X t) = \\<nu> (X t)\""], ["proof (prove)\nusing this:\n  \\<mu> (X t) - \\<nu> (X t) - (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n  (t - t\\<^sub>0) * \\<tau> *\\<^sub>R 0\n\ngoal (1 subgoal):\n 1. \\<mu> (X t) = \\<nu> (X t)", "by (simp add: xivp(2))"], ["proof (state)\nthis:\n  \\<mu> (X t) = \\<nu> (X t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_invariant_leq_rule [diff_invariant_rules]:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\"\n    and Gg: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> > t\\<^sub>0 \\<longrightarrow> G (X \\<tau>) \\<longrightarrow> \\<mu>' (X \\<tau>) \\<ge> \\<nu>' (X \\<tau>))\"\n    and Gl: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> < t\\<^sub>0 \\<longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))\"\n    and dX: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> D (\\<lambda>\\<tau>. \\<mu>(X \\<tau>)-\\<nu>(X \\<tau>)) = (\\<lambda>\\<tau>. \\<mu>'(X \\<tau>)-\\<nu>'(X \\<tau>)) on U(X t\\<^sub>0)\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s \\<le> \\<mu> s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. \\<nu> s \\<le> \\<mu> s) f U S t\\<^sub>0 G", "proof(simp_all add: diff_invariant_eq ivp_sols_def, safe)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "fix X t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "assume Ghyp: \"\\<forall>\\<tau>. \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\""], ["proof (state)\nthis:\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "assume xivp: \"D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\" \"\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0)\" \"X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\""], ["proof (state)\nthis:\n   D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "assume tHyp: \"t \\<in> U (X t\\<^sub>0)\" and t0Hyp: \"t\\<^sub>0 \\<in> U (X t\\<^sub>0)\""], ["proof (state)\nthis:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "hence obs1: \"{t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\" \"{t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\""], ["proof (prove)\nusing this:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0) &&&\n    {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)", "using closed_segment_subset_interval[OF Uhyp t0Hyp tHyp] xivp(3) segment_open_subset_closed"], ["proof (prove)\nusing this:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n  X t\\<^sub>0 \\<in> S \\<Longrightarrow>\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n  {?a<--<?b} \\<subseteq> {?a--?b}\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0) &&&\n    {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)", "by (force, metis PiE \\<open>X t\\<^sub>0 \\<in> S \\<Longrightarrow> {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\\<close> dual_order.trans)"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "hence obs2: \"D (\\<lambda>\\<tau>. \\<mu> (X \\<tau>) - \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>)) on {t\\<^sub>0--t}\""], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>\\<tau>.\n           \\<mu> (X \\<tau>) -\n           \\<nu>\n            (X \\<tau>)) = (\\<lambda>\\<tau>.\n                              \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n     on {t\\<^sub>0--t}", "using has_vderiv_on_subset[OF dX[OF xivp(1)]]"], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n  ?T \\<subseteq> U (X t\\<^sub>0) \\<Longrightarrow>\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on ?T\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>\\<tau>.\n           \\<mu> (X \\<tau>) -\n           \\<nu>\n            (X \\<tau>)) = (\\<lambda>\\<tau>.\n                              \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n     on {t\\<^sub>0--t}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "{"], ["proof (state)\nthis:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "assume \"t \\<noteq> t\\<^sub>0\""], ["proof (state)\nthis:\n  t \\<noteq> t\\<^sub>0\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "then"], ["proof (chain)\npicking this:\n  t \\<noteq> t\\<^sub>0", "obtain r where rHyp: \"r \\<in> {t\\<^sub>0<--<t}\" \n      and \"(\\<mu>(X t)-\\<nu>(X t)) - (\\<mu>(X t\\<^sub>0)-\\<nu>(X t\\<^sub>0)) = (\\<lambda>\\<tau>. \\<tau>*(\\<mu>'(X r)-\\<nu>'(X r))) (t - t\\<^sub>0)\""], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>r \\<in> {t\\<^sub>0<--<t};\n         \\<mu> (X t) - \\<nu> (X t) -\n         (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n         (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using mvt_simple_closed_segmentE obs2"], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0\n  \\<lbrakk> D ?f = ?f' on {?a--?b}; ?a \\<noteq> ?b;\n   \\<And>y.\n      \\<lbrakk>y \\<in> {?a<--<?b};\n       ?f ?b - ?f ?a = (?b - ?a) * ?f' y\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>r \\<in> {t\\<^sub>0<--<t};\n         \\<mu> (X t) - \\<nu> (X t) -\n         (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n         (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  r \\<in> {t\\<^sub>0<--<t}\n  \\<mu> (X t) - \\<nu> (X t) - (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "hence mvt: \"\\<mu>(X t)-\\<nu>(X t) = (t - t\\<^sub>0)*(\\<mu>'(X r)-\\<nu>'(X r)) + (\\<mu>(X t\\<^sub>0)-\\<nu>(X t\\<^sub>0))\""], ["proof (prove)\nusing this:\n  r \\<in> {t\\<^sub>0<--<t}\n  \\<mu> (X t) - \\<nu> (X t) - (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. \\<mu> (X t) - \\<nu> (X t) =\n    (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n    (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))", "by force"], ["proof (state)\nthis:\n  \\<mu> (X t) - \\<nu> (X t) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n  (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "have primed: \"\\<And>\\<tau>. \\<tau> \\<in> U (X t\\<^sub>0) \\<Longrightarrow> \\<tau> > t\\<^sub>0 \\<Longrightarrow> G (X \\<tau>) \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<ge> \\<nu>' (X \\<tau>)\" \n      \"\\<And>\\<tau>. \\<tau> \\<in> U (X t\\<^sub>0) \\<Longrightarrow> \\<tau> < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); t\\<^sub>0 < \\<tau>;\n         G (X \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> \\<nu>' (X \\<tau>) \\<le> \\<mu>' (X \\<tau>)) &&&\n    (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); \\<tau> < t\\<^sub>0\\<rbrakk>\n        \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))", "using Gg[OF xivp(1)] Gl[OF xivp(1)]"], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\\<in>U (X t\\<^sub>0).\n     t\\<^sub>0 < \\<tau> \\<longrightarrow>\n     G (X \\<tau>) \\<longrightarrow>\n     \\<nu>' (X \\<tau>) \\<le> \\<mu>' (X \\<tau>)\n  \\<forall>\\<tau>\\<in>U (X t\\<^sub>0).\n     \\<tau> < t\\<^sub>0 \\<longrightarrow>\n     \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); t\\<^sub>0 < \\<tau>;\n         G (X \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> \\<nu>' (X \\<tau>) \\<le> \\<mu>' (X \\<tau>)) &&&\n    (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); \\<tau> < t\\<^sub>0\\<rbrakk>\n        \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>?\\<tau> \\<in> U (X t\\<^sub>0); t\\<^sub>0 < ?\\<tau>;\n   G (X ?\\<tau>)\\<rbrakk>\n  \\<Longrightarrow> \\<nu>' (X ?\\<tau>) \\<le> \\<mu>' (X ?\\<tau>)\n  \\<lbrakk>?\\<tau> \\<in> U (X t\\<^sub>0); ?\\<tau> < t\\<^sub>0\\<rbrakk>\n  \\<Longrightarrow> \\<mu>' (X ?\\<tau>) \\<le> \\<nu>' (X ?\\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "have \"t > t\\<^sub>0 \\<Longrightarrow> r > t\\<^sub>0 \\<and> G (X r)\" \"\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\" \"r \\<in> U (X t\\<^sub>0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)) &&&\n    (\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0) &&&\n    r \\<in> U (X t\\<^sub>0)", "using \\<open>r \\<in> {t\\<^sub>0<--<t}\\<close> obs1 Ghyp"], ["proof (prove)\nusing this:\n  r \\<in> {t\\<^sub>0<--<t}\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. (t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)) &&&\n    (\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0) &&&\n    r \\<in> U (X t\\<^sub>0)", "unfolding open_segment_eq_real_ivl closed_segment_eq_real_ivl"], ["proof (prove)\nusing this:\n  r \\<in> (if t\\<^sub>0 \\<le> t then {t\\<^sub>0<..<t} else {t<..<t\\<^sub>0})\n  (if t\\<^sub>0 \\<le> t then {t\\<^sub>0..t} else {t..t\\<^sub>0})\n  \\<subseteq> U (X t\\<^sub>0)\n  (if t\\<^sub>0 \\<le> t then {t\\<^sub>0<..<t} else {t<..<t\\<^sub>0})\n  \\<subseteq> U (X t\\<^sub>0)\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. (t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)) &&&\n    (\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0) &&&\n    r \\<in> U (X t\\<^sub>0)", "by auto"], ["proof (state)\nthis:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "moreover"], ["proof (state)\nthis:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "have \"r > t\\<^sub>0 \\<Longrightarrow> G (X r) \\<Longrightarrow> (\\<mu>'(X r)- \\<nu>'(X r)) \\<ge> 0\" \"r < t\\<^sub>0 \\<Longrightarrow> (\\<mu>'(X r)-\\<nu>'(X r)) \\<le> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n     \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)) &&&\n    (r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0)", "using primed(1,2)[OF \\<open>r \\<in> U (X t\\<^sub>0)\\<close>]"], ["proof (prove)\nusing this:\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> \\<nu>' (X r) \\<le> \\<mu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) \\<le> \\<nu>' (X r)\n\ngoal (1 subgoal):\n 1. (\\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n     \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)) &&&\n    (r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0)", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "ultimately"], ["proof (chain)\npicking this:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0", "have \"(t - t\\<^sub>0) * (\\<mu>'(X r)-\\<nu>'(X r)) \\<ge> 0\""], ["proof (prove)\nusing this:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0\n\ngoal (1 subgoal):\n 1. 0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))", "by (case_tac \"t \\<ge> t\\<^sub>0\", force, auto simp: split_mult_pos_le)"], ["proof (state)\nthis:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "hence \"(t - t\\<^sub>0) * (\\<mu>'(X r)-\\<nu>'(X r)) + (\\<mu>(X t\\<^sub>0)-\\<nu>(X t\\<^sub>0)) \\<ge> 0\""], ["proof (prove)\nusing this:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. 0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n            (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))", "using xivp(2)"], ["proof (prove)\nusing this:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n  \\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. 0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n            (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))", "by auto"], ["proof (state)\nthis:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n          (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "hence \"\\<nu> (X t) \\<le> \\<mu> (X t)\""], ["proof (prove)\nusing this:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n          (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) \\<le> \\<mu> (X t)", "using mvt"], ["proof (prove)\nusing this:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n          (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n  \\<mu> (X t) - \\<nu> (X t) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n  (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) \\<le> \\<mu> (X t)", "by simp"], ["proof (state)\nthis:\n  \\<nu> (X t) \\<le> \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "}"], ["proof (state)\nthis:\n  t \\<noteq> t\\<^sub>0 \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)", "thus \"\\<nu> (X t) \\<le> \\<mu> (X t)\""], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0 \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) \\<le> \\<mu> (X t)", "using xivp"], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0 \\<Longrightarrow> \\<nu> (X t) \\<le> \\<mu> (X t)\n   D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) \\<le> \\<mu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) \\<le> \\<mu> (X t)", "by blast"], ["proof (state)\nthis:\n  \\<nu> (X t) \\<le> \\<mu> (X t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_invariant_less_rule [diff_invariant_rules]:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\"\n    and Gg: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> > t\\<^sub>0 \\<longrightarrow> G (X \\<tau>) \\<longrightarrow> \\<mu>' (X \\<tau>) \\<ge> \\<nu>' (X \\<tau>))\"\n    and Gl: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> (\\<forall>\\<tau>\\<in>U(X t\\<^sub>0). \\<tau> < t\\<^sub>0 \\<longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))\"\n    and dX: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> D (\\<lambda>\\<tau>. \\<mu>(X \\<tau>)-\\<nu>(X \\<tau>)) = (\\<lambda>\\<tau>. \\<mu>'(X \\<tau>)-\\<nu>'(X \\<tau>)) on U(X t\\<^sub>0)\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G", "proof(simp_all add: diff_invariant_eq ivp_sols_def, safe)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "fix X t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume Ghyp: \"\\<forall>\\<tau>. \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\""], ["proof (state)\nthis:\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume xivp: \"D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\" \"\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\" \"X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\""], ["proof (state)\nthis:\n   D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume tHyp: \"t \\<in> U (X t\\<^sub>0)\" and t0Hyp: \"t\\<^sub>0 \\<in> U (X t\\<^sub>0)\""], ["proof (state)\nthis:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence obs1: \"{t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\" \"{t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\""], ["proof (prove)\nusing this:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0) &&&\n    {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)", "using closed_segment_subset_interval[OF Uhyp t0Hyp tHyp] xivp(3) segment_open_subset_closed"], ["proof (prove)\nusing this:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n  X t\\<^sub>0 \\<in> S \\<Longrightarrow>\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n  {?a<--<?b} \\<subseteq> {?a--?b}\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0) &&&\n    {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)", "by (force, metis PiE \\<open>X t\\<^sub>0 \\<in> S \\<Longrightarrow> {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\\<close> dual_order.trans)"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence obs2: \"D (\\<lambda>\\<tau>. \\<mu> (X \\<tau>) - \\<nu> (X \\<tau>)) = (\\<lambda>\\<tau>. \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>)) on {t\\<^sub>0--t}\""], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>\\<tau>.\n           \\<mu> (X \\<tau>) -\n           \\<nu>\n            (X \\<tau>)) = (\\<lambda>\\<tau>.\n                              \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n     on {t\\<^sub>0--t}", "using has_vderiv_on_subset[OF dX[OF xivp(1)]]"], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n  ?T \\<subseteq> U (X t\\<^sub>0) \\<Longrightarrow>\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on ?T\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>\\<tau>.\n           \\<mu> (X \\<tau>) -\n           \\<nu>\n            (X \\<tau>)) = (\\<lambda>\\<tau>.\n                              \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n     on {t\\<^sub>0--t}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "{"], ["proof (state)\nthis:\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume \"t \\<noteq> t\\<^sub>0\""], ["proof (state)\nthis:\n  t \\<noteq> t\\<^sub>0\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "then"], ["proof (chain)\npicking this:\n  t \\<noteq> t\\<^sub>0", "obtain r where rHyp: \"r \\<in> {t\\<^sub>0<--<t}\" \n      and \"(\\<mu>(X t)-\\<nu>(X t)) - (\\<mu>(X t\\<^sub>0)-\\<nu>(X t\\<^sub>0)) = (\\<lambda>\\<tau>. \\<tau>*(\\<mu>'(X r)-\\<nu>'(X r))) (t - t\\<^sub>0)\""], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>r \\<in> {t\\<^sub>0<--<t};\n         \\<mu> (X t) - \\<nu> (X t) -\n         (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n         (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using mvt_simple_closed_segmentE obs2"], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0\n  \\<lbrakk> D ?f = ?f' on {?a--?b}; ?a \\<noteq> ?b;\n   \\<And>y.\n      \\<lbrakk>y \\<in> {?a<--<?b};\n       ?f ?b - ?f ?a = (?b - ?a) * ?f' y\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n   D (\\<lambda>\\<tau>.\n         \\<mu> (X \\<tau>) -\n         \\<nu>\n          (X \\<tau>)) = (\\<lambda>\\<tau>.\n                            \\<mu>' (X \\<tau>) - \\<nu>' (X \\<tau>))\n   on {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>r \\<in> {t\\<^sub>0<--<t};\n         \\<mu> (X t) - \\<nu> (X t) -\n         (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n         (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  r \\<in> {t\\<^sub>0<--<t}\n  \\<mu> (X t) - \\<nu> (X t) - (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence mvt: \"\\<mu>(X t)-\\<nu>(X t) = (t - t\\<^sub>0)*(\\<mu>'(X r)-\\<nu>'(X r)) + (\\<mu>(X t\\<^sub>0)-\\<nu>(X t\\<^sub>0))\""], ["proof (prove)\nusing this:\n  r \\<in> {t\\<^sub>0<--<t}\n  \\<mu> (X t) - \\<nu> (X t) - (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0)) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. \\<mu> (X t) - \\<nu> (X t) =\n    (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n    (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))", "by force"], ["proof (state)\nthis:\n  \\<mu> (X t) - \\<nu> (X t) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n  (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "have primed: \"\\<And>\\<tau>. \\<tau> \\<in> U (X t\\<^sub>0) \\<Longrightarrow> \\<tau> > t\\<^sub>0 \\<Longrightarrow> G (X \\<tau>) \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<ge> \\<nu>' (X \\<tau>)\" \n      \"\\<And>\\<tau>. \\<tau> \\<in> U (X t\\<^sub>0) \\<Longrightarrow> \\<tau> < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); t\\<^sub>0 < \\<tau>;\n         G (X \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> \\<nu>' (X \\<tau>) \\<le> \\<mu>' (X \\<tau>)) &&&\n    (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); \\<tau> < t\\<^sub>0\\<rbrakk>\n        \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))", "using Gg[OF xivp(1)] Gl[OF xivp(1)]"], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\\<in>U (X t\\<^sub>0).\n     t\\<^sub>0 < \\<tau> \\<longrightarrow>\n     G (X \\<tau>) \\<longrightarrow>\n     \\<nu>' (X \\<tau>) \\<le> \\<mu>' (X \\<tau>)\n  \\<forall>\\<tau>\\<in>U (X t\\<^sub>0).\n     \\<tau> < t\\<^sub>0 \\<longrightarrow>\n     \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); t\\<^sub>0 < \\<tau>;\n         G (X \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> \\<nu>' (X \\<tau>) \\<le> \\<mu>' (X \\<tau>)) &&&\n    (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> U (X t\\<^sub>0); \\<tau> < t\\<^sub>0\\<rbrakk>\n        \\<Longrightarrow> \\<mu>' (X \\<tau>) \\<le> \\<nu>' (X \\<tau>))", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>?\\<tau> \\<in> U (X t\\<^sub>0); t\\<^sub>0 < ?\\<tau>;\n   G (X ?\\<tau>)\\<rbrakk>\n  \\<Longrightarrow> \\<nu>' (X ?\\<tau>) \\<le> \\<mu>' (X ?\\<tau>)\n  \\<lbrakk>?\\<tau> \\<in> U (X t\\<^sub>0); ?\\<tau> < t\\<^sub>0\\<rbrakk>\n  \\<Longrightarrow> \\<mu>' (X ?\\<tau>) \\<le> \\<nu>' (X ?\\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "have \"t > t\\<^sub>0 \\<Longrightarrow> r > t\\<^sub>0 \\<and> G (X r)\" \"\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\" \"r \\<in> U (X t\\<^sub>0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)) &&&\n    (\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0) &&&\n    r \\<in> U (X t\\<^sub>0)", "using \\<open>r \\<in> {t\\<^sub>0<--<t}\\<close> obs1 Ghyp"], ["proof (prove)\nusing this:\n  r \\<in> {t\\<^sub>0<--<t}\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  {t\\<^sub>0<--<t} \\<subseteq> U (X t\\<^sub>0)\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. (t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)) &&&\n    (\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0) &&&\n    r \\<in> U (X t\\<^sub>0)", "unfolding open_segment_eq_real_ivl closed_segment_eq_real_ivl"], ["proof (prove)\nusing this:\n  r \\<in> (if t\\<^sub>0 \\<le> t then {t\\<^sub>0<..<t} else {t<..<t\\<^sub>0})\n  (if t\\<^sub>0 \\<le> t then {t\\<^sub>0..t} else {t..t\\<^sub>0})\n  \\<subseteq> U (X t\\<^sub>0)\n  (if t\\<^sub>0 \\<le> t then {t\\<^sub>0<..<t} else {t<..<t\\<^sub>0})\n  \\<subseteq> U (X t\\<^sub>0)\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. (t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)) &&&\n    (\\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0) &&&\n    r \\<in> U (X t\\<^sub>0)", "by auto"], ["proof (state)\nthis:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "moreover"], ["proof (state)\nthis:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "have \"r > t\\<^sub>0 \\<Longrightarrow> G (X r) \\<Longrightarrow> (\\<mu>'(X r)- \\<nu>'(X r)) \\<ge> 0\" \"r < t\\<^sub>0 \\<Longrightarrow> (\\<mu>'(X r)-\\<nu>'(X r)) \\<le> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n     \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)) &&&\n    (r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0)", "using primed(1,2)[OF \\<open>r \\<in> U (X t\\<^sub>0)\\<close>]"], ["proof (prove)\nusing this:\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> \\<nu>' (X r) \\<le> \\<mu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) \\<le> \\<nu>' (X r)\n\ngoal (1 subgoal):\n 1. (\\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n     \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)) &&&\n    (r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0)", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "ultimately"], ["proof (chain)\npicking this:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0", "have \"(t - t\\<^sub>0) * (\\<mu>'(X r)-\\<nu>'(X r)) \\<ge> 0\""], ["proof (prove)\nusing this:\n  t\\<^sub>0 < t \\<Longrightarrow> t\\<^sub>0 < r \\<and> G (X r)\n  \\<not> t\\<^sub>0 \\<le> t \\<Longrightarrow> r < t\\<^sub>0\n  r \\<in> U (X t\\<^sub>0)\n  \\<lbrakk>t\\<^sub>0 < r; G (X r)\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<mu>' (X r) - \\<nu>' (X r)\n  r < t\\<^sub>0 \\<Longrightarrow> \\<mu>' (X r) - \\<nu>' (X r) \\<le> 0\n\ngoal (1 subgoal):\n 1. 0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))", "by (case_tac \"t \\<ge> t\\<^sub>0\", force, auto simp: split_mult_pos_le)"], ["proof (state)\nthis:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence \"(t - t\\<^sub>0) * (\\<mu>'(X r)-\\<nu>'(X r)) + (\\<mu>(X t\\<^sub>0)-\\<nu>(X t\\<^sub>0)) > 0\""], ["proof (prove)\nusing this:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n\ngoal (1 subgoal):\n 1. 0 < (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n        (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))", "using xivp(2)"], ["proof (prove)\nusing this:\n  0 \\<le> (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r))\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. 0 < (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n        (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))", "by auto"], ["proof (state)\nthis:\n  0 < (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n      (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence \"\\<nu> (X t) < \\<mu> (X t)\""], ["proof (prove)\nusing this:\n  0 < (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n      (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) < \\<mu> (X t)", "using mvt"], ["proof (prove)\nusing this:\n  0 < (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n      (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n  \\<mu> (X t) - \\<nu> (X t) =\n  (t - t\\<^sub>0) * (\\<mu>' (X r) - \\<nu>' (X r)) +\n  (\\<mu> (X t\\<^sub>0) - \\<nu> (X t\\<^sub>0))\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) < \\<mu> (X t)", "by simp"], ["proof (state)\nthis:\n  \\<nu> (X t) < \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "}"], ["proof (state)\nthis:\n  t \\<noteq> t\\<^sub>0 \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "thus \"\\<nu> (X t) < \\<mu> (X t)\""], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0 \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) < \\<mu> (X t)", "using xivp"], ["proof (prove)\nusing this:\n  t \\<noteq> t\\<^sub>0 \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\n   D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) < \\<mu> (X t)", "by blast"], ["proof (state)\nthis:\n  \\<nu> (X t) < \\<mu> (X t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_invariant_nleq_rule:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  shows \"diff_invariant (\\<lambda>s. \\<not> \\<nu> s \\<le> \\<mu> s) f U S t\\<^sub>0 G \\<longleftrightarrow> diff_invariant (\\<lambda>s. \\<nu> s > \\<mu> s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. \\<not> \\<nu> s \\<le> \\<mu> s) f U S\n     t\\<^sub>0 G =\n    diff_invariant (\\<lambda>s. \\<mu> s < \\<nu> s) f U S t\\<^sub>0 G", "unfolding diff_invariant_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>s.\n        \\<not> \\<nu> s \\<le> \\<mu> s \\<longrightarrow>\n        (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n            \\<forall>t\\<in>U s.\n               (\\<forall>\\<tau>\\<in>down (U s) t.\n                   G (X \\<tau>)) \\<longrightarrow>\n               \\<not> \\<nu> (X t) \\<le> \\<mu> (X t))) =\n    (\\<forall>s.\n        \\<mu> s < \\<nu> s \\<longrightarrow>\n        (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n            \\<forall>t\\<in>U s.\n               (\\<forall>\\<tau>\\<in>down (U s) t.\n                   G (X \\<tau>)) \\<longrightarrow>\n               \\<mu> (X t) < \\<nu> (X t)))", "apply safe"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<forall>s.\n                   \\<not> \\<nu> s \\<le> \\<mu> s \\<longrightarrow>\n                   (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                       \\<forall>t\\<in>U s.\n                          (\\<forall>\\<tau>\\<in>down (U s) t.\n                              G (X \\<tau>)) \\<longrightarrow>\n                          \\<not> \\<nu> (X t) \\<le> \\<mu> (X t));\n        \\<mu> s < \\<nu> s; X \\<in> Sols f U S t\\<^sub>0 s; t \\<in> U s;\n        \\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<mu> (X t) < \\<nu> (X t)\n 2. \\<And>s X t.\n       \\<lbrakk>\\<forall>s.\n                   \\<mu> s < \\<nu> s \\<longrightarrow>\n                   (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                       \\<forall>t\\<in>U s.\n                          (\\<forall>\\<tau>\\<in>down (U s) t.\n                              G (X \\<tau>)) \\<longrightarrow>\n                          \\<mu> (X t) < \\<nu> (X t));\n        \\<not> \\<nu> s \\<le> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s; \\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>);\n        \\<nu> (X t) \\<le> \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "by (clarsimp, erule_tac x=s in allE, simp, erule_tac x=X in ballE, force, force)+"], ["", "lemma diff_invariant_neq_rule [diff_invariant_rules]:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes \"diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G\"\n    and \"diff_invariant (\\<lambda>s. \\<nu> s > \\<mu> s) f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s \\<noteq> \\<mu> s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. \\<nu> s \\<noteq> \\<mu> s) f U S t\\<^sub>0 G", "proof(unfold diff_invariant_eq, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "fix s::'a and X::\"real \\<Rightarrow> 'a\" and t::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "assume \"\\<nu> s \\<noteq> \\<mu> s\" and Xhyp: \"X \\<in> Sols f U S t\\<^sub>0 s\" \n     and thyp: \"t \\<in> U s\" and Ghyp: \"\\<forall>\\<tau>. \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\""], ["proof (state)\nthis:\n  \\<nu> s \\<noteq> \\<mu> s\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "hence \"\\<nu> s < \\<mu> s \\<or> \\<nu> s > \\<mu> s\""], ["proof (prove)\nusing this:\n  \\<nu> s \\<noteq> \\<mu> s\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<nu> s < \\<mu> s \\<or> \\<mu> s < \\<nu> s", "by linarith"], ["proof (state)\nthis:\n  \\<nu> s < \\<mu> s \\<or> \\<mu> s < \\<nu> s\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  \\<nu> s < \\<mu> s \\<or> \\<mu> s < \\<nu> s\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "have \"\\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "using assms(1) Xhyp thyp Ghyp"], ["proof (prove)\nusing this:\n  diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "unfolding diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     \\<nu> s < \\<mu> s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n         \\<forall>t\\<in>U s.\n            (\\<forall>\\<tau>\\<in>down (U s) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            \\<nu> (X t) < \\<mu> (X t))\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "by auto"], ["proof (state)\nthis:\n  \\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  \\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "have \"\\<nu> s > \\<mu> s \\<Longrightarrow> \\<nu> (X t) > \\<mu> (X t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<mu> s < \\<nu> s \\<Longrightarrow> \\<mu> (X t) < \\<nu> (X t)", "using assms(2) Xhyp thyp Ghyp"], ["proof (prove)\nusing this:\n  diff_invariant (\\<lambda>s. \\<mu> s < \\<nu> s) f U S t\\<^sub>0 G\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<mu> s < \\<nu> s \\<Longrightarrow> \\<mu> (X t) < \\<nu> (X t)", "unfolding diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     \\<mu> s < \\<nu> s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n         \\<forall>t\\<in>U s.\n            (\\<forall>\\<tau>\\<in>down (U s) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            \\<mu> (X t) < \\<nu> (X t))\n  X \\<in> Sols f U S t\\<^sub>0 s\n  t \\<in> U s\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<mu> s < \\<nu> s \\<Longrightarrow> \\<mu> (X t) < \\<nu> (X t)", "by auto"], ["proof (state)\nthis:\n  \\<mu> s < \\<nu> s \\<Longrightarrow> \\<mu> (X t) < \\<nu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>\\<nu> s \\<noteq> \\<mu> s; X \\<in> Sols f U S t\\<^sub>0 s;\n        t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        \\<nu> (X t) = \\<mu> (X t)\\<rbrakk>\n       \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  \\<nu> s < \\<mu> s \\<or> \\<mu> s < \\<nu> s\n  \\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\n  \\<mu> s < \\<nu> s \\<Longrightarrow> \\<mu> (X t) < \\<nu> (X t)", "show \"\\<nu> (X t) = \\<mu> (X t) \\<Longrightarrow> False\""], ["proof (prove)\nusing this:\n  \\<nu> s < \\<mu> s \\<or> \\<mu> s < \\<nu> s\n  \\<nu> s < \\<mu> s \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)\n  \\<mu> s < \\<nu> s \\<Longrightarrow> \\<mu> (X t) < \\<nu> (X t)\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) = \\<mu> (X t) \\<Longrightarrow> False", "by auto"], ["proof (state)\nthis:\n  \\<nu> (X t) = \\<mu> (X t) \\<Longrightarrow> False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_invariant_neq_rule_converse:\n  fixes \\<mu>::\"'a::banach \\<Rightarrow> real\"\n  assumes Uhyp: \"\\<And>s. s \\<in> S \\<Longrightarrow> is_interval (U s)\" \"\\<And>s t. s \\<in> S \\<Longrightarrow> t \\<in> U s \\<Longrightarrow> t\\<^sub>0 \\<le> t\"\n    and conts: \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> continuous_on (\\<P> X (U (X t\\<^sub>0))) \\<nu>\"\n      \"\\<And>X. (D X = (\\<lambda>\\<tau>. f \\<tau> (X \\<tau>)) on U(X t\\<^sub>0)) \\<Longrightarrow> continuous_on (\\<P> X (U (X t\\<^sub>0))) \\<mu>\"\n    and dI:\"diff_invariant (\\<lambda>s. \\<nu> s \\<noteq> \\<mu> s) f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. \\<nu> s < \\<mu> s) f U S t\\<^sub>0 G", "proof(unfold diff_invariant_eq ivp_sols_def, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "fix X t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume Ghyp: \"\\<forall>\\<tau>. \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\""], ["proof (state)\nthis:\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume xivp: \"D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\" \"\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\" \"X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\""], ["proof (state)\nthis:\n   D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume tHyp: \"t \\<in> U (X t\\<^sub>0)\" and t0Hyp: \"t\\<^sub>0 \\<in> U (X t\\<^sub>0)\""], ["proof (state)\nthis:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence \"t\\<^sub>0 \\<le> t\" and \"\\<mu> (X t) \\<noteq> \\<nu> (X t)\""], ["proof (prove)\nusing this:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. t\\<^sub>0 \\<le> t &&& \\<mu> (X t) \\<noteq> \\<nu> (X t)", "using xivp(3) Uhyp(2)"], ["proof (prove)\nusing this:\n  t \\<in> U (X t\\<^sub>0)\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n  \\<lbrakk>?s \\<in> S; ?t \\<in> U ?s\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>0 \\<le> ?t\n\ngoal (1 subgoal):\n 1. t\\<^sub>0 \\<le> t &&& \\<mu> (X t) \\<noteq> \\<nu> (X t)", "apply force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<mu> (X t) \\<noteq> \\<nu> (X t)", "using dI tHyp xivp(2) Ghyp ivp_solsI[of X f U \"X t\\<^sub>0\", OF xivp(1) _ xivp(3) t0Hyp]"], ["proof (prove)\nusing this:\n  diff_invariant (\\<lambda>s. \\<nu> s \\<noteq> \\<mu> s) f U S t\\<^sub>0 G\n  t \\<in> U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n  X t\\<^sub>0 = X t\\<^sub>0 \\<Longrightarrow>\n  X \\<in> Sols f U S t\\<^sub>0 (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<mu> (X t) \\<noteq> \\<nu> (X t)", "unfolding diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     \\<nu> s \\<noteq> \\<mu> s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n         \\<forall>t\\<in>U s.\n            (\\<forall>\\<tau>\\<in>down (U s) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            \\<nu> (X t) \\<noteq> \\<mu> (X t))\n  t \\<in> U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n  X t\\<^sub>0 = X t\\<^sub>0 \\<Longrightarrow>\n  X \\<in> Sols f U S t\\<^sub>0 (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<mu> (X t) \\<noteq> \\<nu> (X t)", "by force"], ["proof (state)\nthis:\n  t\\<^sub>0 \\<le> t\n  \\<mu> (X t) \\<noteq> \\<nu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "moreover"], ["proof (state)\nthis:\n  t\\<^sub>0 \\<le> t\n  \\<mu> (X t) \\<noteq> \\<nu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "{"], ["proof (state)\nthis:\n  t\\<^sub>0 \\<le> t\n  \\<mu> (X t) \\<noteq> \\<nu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "assume ineq2:\"\\<nu> (X t) > \\<mu> (X t)\""], ["proof (state)\nthis:\n  \\<mu> (X t) < \\<nu> (X t)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "note continuous_on_compose[OF vderiv_on_continuous_on[OF xivp(1)]]"], ["proof (state)\nthis:\n  continuous_on (\\<P> X (U (X t\\<^sub>0))) ?g \\<Longrightarrow>\n  continuous_on (U (X t\\<^sub>0)) (?g \\<circ> X)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence \"continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X)\" and \"continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)\""], ["proof (prove)\nusing this:\n  continuous_on (\\<P> X (U (X t\\<^sub>0))) ?g \\<Longrightarrow>\n  continuous_on (U (X t\\<^sub>0)) (?g \\<circ> X)\n\ngoal (1 subgoal):\n 1. continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X) &&&\n    continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)", "using xivp(1) conts"], ["proof (prove)\nusing this:\n  continuous_on (\\<P> X (U (X t\\<^sub>0))) ?g \\<Longrightarrow>\n  continuous_on (U (X t\\<^sub>0)) (?g \\<circ> X)\n   D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0)\n   D ?X = (\\<lambda>\\<tau>. f \\<tau> (?X \\<tau>))\n   on U (?X t\\<^sub>0) \\<Longrightarrow>\n  continuous_on (\\<P> ?X (U (?X t\\<^sub>0))) \\<nu>\n   D ?X = (\\<lambda>\\<tau>. f \\<tau> (?X \\<tau>))\n   on U (?X t\\<^sub>0) \\<Longrightarrow>\n  continuous_on (\\<P> ?X (U (?X t\\<^sub>0))) \\<mu>\n\ngoal (1 subgoal):\n 1. continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X) &&&\n    continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)", "by blast+"], ["proof (state)\nthis:\n  continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X)\n  continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "also"], ["proof (state)\nthis:\n  continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X)\n  continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "have \"{t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)", "using closed_segment_subset_interval[OF Uhyp(1) t0Hyp tHyp] xivp(3) t0Hyp"], ["proof (prove)\nusing this:\n  X t\\<^sub>0 \\<in> S \\<Longrightarrow>\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  X \\<in> U (X t\\<^sub>0) \\<rightarrow> S\n  t\\<^sub>0 \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)", "by auto"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "ultimately"], ["proof (chain)\npicking this:\n  continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X)\n  continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)", "have \"continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<nu> (X \\<tau>))\" \n      and \"continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<mu> (X \\<tau>))\""], ["proof (prove)\nusing this:\n  continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X)\n  continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<nu> (X \\<tau>)) &&&\n    continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<mu> (X \\<tau>))", "using continuous_on_subset"], ["proof (prove)\nusing this:\n  continuous_on (U (X t\\<^sub>0)) (\\<nu> \\<circ> X)\n  continuous_on (U (X t\\<^sub>0)) (\\<mu> \\<circ> X)\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n  \\<lbrakk>continuous_on ?s ?f; ?t \\<subseteq> ?s\\<rbrakk>\n  \\<Longrightarrow> continuous_on ?t ?f\n\ngoal (1 subgoal):\n 1. continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<nu> (X \\<tau>)) &&&\n    continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<mu> (X \\<tau>))", "by auto"], ["proof (state)\nthis:\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<nu> (X \\<tau>))\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<mu> (X \\<tau>))\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "then"], ["proof (chain)\npicking this:\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<nu> (X \\<tau>))\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<mu> (X \\<tau>))", "obtain \\<tau> where \"\\<tau> \\<in> {t\\<^sub>0--t}\" \"\\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\""], ["proof (prove)\nusing this:\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<nu> (X \\<tau>))\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<mu> (X \\<tau>))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> {t\\<^sub>0--t};\n         \\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using IVT_two_functions_real_ivl[OF _ _ xivp(2) ineq2]"], ["proof (prove)\nusing this:\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<nu> (X \\<tau>))\n  continuous_on {t\\<^sub>0--t} (\\<lambda>\\<tau>. \\<mu> (X \\<tau>))\n  \\<lbrakk>continuous_on {t\\<^sub>0--t} (\\<lambda>a. \\<nu> (X a));\n   continuous_on {t\\<^sub>0--t} (\\<lambda>a. \\<mu> (X a))\\<rbrakk>\n  \\<Longrightarrow> \\<exists>x\\<in>{t\\<^sub>0--t}. \\<nu> (X x) = \\<mu> (X x)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> {t\\<^sub>0--t};\n         \\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  \\<tau> \\<in> {t\\<^sub>0--t}\n  \\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence \"\\<forall>r\\<in>down (U (X t\\<^sub>0)) \\<tau>. G (X r)\" and \"\\<tau> \\<in> U (X t\\<^sub>0)\""], ["proof (prove)\nusing this:\n  \\<tau> \\<in> {t\\<^sub>0--t}\n  \\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<forall>r\\<in>down (U (X t\\<^sub>0)) \\<tau>. G (X r) &&&\n    \\<tau> \\<in> U (X t\\<^sub>0)", "using Ghyp \\<open>\\<tau> \\<in> {t\\<^sub>0--t}\\<close> \\<open>t\\<^sub>0 \\<le> t\\<close> \\<open>{t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\\<close>"], ["proof (prove)\nusing this:\n  \\<tau> \\<in> {t\\<^sub>0--t}\n  \\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\n  \\<forall>\\<tau>.\n     \\<tau> \\<in> U (X t\\<^sub>0) \\<and> \\<tau> \\<le> t \\<longrightarrow>\n     G (X \\<tau>)\n  \\<tau> \\<in> {t\\<^sub>0--t}\n  t\\<^sub>0 \\<le> t\n  {t\\<^sub>0--t} \\<subseteq> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<forall>r\\<in>down (U (X t\\<^sub>0)) \\<tau>. G (X r) &&&\n    \\<tau> \\<in> U (X t\\<^sub>0)", "by (auto simp: closed_segment_eq_real_ivl)"], ["proof (state)\nthis:\n  \\<forall>r\\<in>down (U (X t\\<^sub>0)) \\<tau>. G (X r)\n  \\<tau> \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence \"\\<mu> (X \\<tau>) \\<noteq> \\<nu> (X \\<tau>)\""], ["proof (prove)\nusing this:\n  \\<forall>r\\<in>down (U (X t\\<^sub>0)) \\<tau>. G (X r)\n  \\<tau> \\<in> U (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<mu> (X \\<tau>) \\<noteq> \\<nu> (X \\<tau>)", "using dI tHyp xivp(2) ivp_solsI[of X f U \"X t\\<^sub>0\", OF xivp(1) _ xivp(3) t0Hyp]"], ["proof (prove)\nusing this:\n  \\<forall>r\\<in>down (U (X t\\<^sub>0)) \\<tau>. G (X r)\n  \\<tau> \\<in> U (X t\\<^sub>0)\n  diff_invariant (\\<lambda>s. \\<nu> s \\<noteq> \\<mu> s) f U S t\\<^sub>0 G\n  t \\<in> U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n  X t\\<^sub>0 = X t\\<^sub>0 \\<Longrightarrow>\n  X \\<in> Sols f U S t\\<^sub>0 (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<mu> (X \\<tau>) \\<noteq> \\<nu> (X \\<tau>)", "unfolding diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>r\\<in>down (U (X t\\<^sub>0)) \\<tau>. G (X r)\n  \\<tau> \\<in> U (X t\\<^sub>0)\n  \\<forall>s.\n     \\<nu> s \\<noteq> \\<mu> s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n         \\<forall>t\\<in>U s.\n            (\\<forall>\\<tau>\\<in>down (U s) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            \\<nu> (X t) \\<noteq> \\<mu> (X t))\n  t \\<in> U (X t\\<^sub>0)\n  \\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0)\n  X t\\<^sub>0 = X t\\<^sub>0 \\<Longrightarrow>\n  X \\<in> Sols f U S t\\<^sub>0 (X t\\<^sub>0)\n\ngoal (1 subgoal):\n 1. \\<mu> (X \\<tau>) \\<noteq> \\<nu> (X \\<tau>)", "by force"], ["proof (state)\nthis:\n  \\<mu> (X \\<tau>) \\<noteq> \\<nu> (X \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "hence \"False\""], ["proof (prove)\nusing this:\n  \\<mu> (X \\<tau>) \\<noteq> \\<nu> (X \\<tau>)\n\ngoal (1 subgoal):\n 1. False", "using \\<open>\\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\\<close>"], ["proof (prove)\nusing this:\n  \\<mu> (X \\<tau>) \\<noteq> \\<nu> (X \\<tau>)\n  \\<mu> (X \\<tau>) = \\<nu> (X \\<tau>)\n\ngoal (1 subgoal):\n 1. False", "by blast"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "}"], ["proof (state)\nthis:\n  \\<mu> (X t) < \\<nu> (X t) \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>\\<nu> (X t\\<^sub>0) < \\<mu> (X t\\<^sub>0);\n        t \\<in> U (X t\\<^sub>0); X \\<in> U (X t\\<^sub>0) \\<rightarrow> S;\n         D X = (\\<lambda>x. f x (X x)) on U (X t\\<^sub>0);\n        t\\<^sub>0 \\<in> U (X t\\<^sub>0);\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U (X t\\<^sub>0) \\<and>\n           \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<nu> (X t) < \\<mu> (X t)", "ultimately"], ["proof (chain)\npicking this:\n  t\\<^sub>0 \\<le> t\n  \\<mu> (X t) \\<noteq> \\<nu> (X t)\n  \\<mu> (X t) < \\<nu> (X t) \\<Longrightarrow> False", "show \"\\<nu> (X t) < \\<mu> (X t)\""], ["proof (prove)\nusing this:\n  t\\<^sub>0 \\<le> t\n  \\<mu> (X t) \\<noteq> \\<nu> (X t)\n  \\<mu> (X t) < \\<nu> (X t) \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. \\<nu> (X t) < \\<mu> (X t)", "by fastforce"], ["proof (state)\nthis:\n  \\<nu> (X t) < \\<mu> (X t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_invariant_conj_rule [diff_invariant_rules]:\n  assumes \"diff_invariant I\\<^sub>1 f U S t\\<^sub>0 G\"\n    and \"diff_invariant I\\<^sub>2 f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<and> I\\<^sub>2 s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<and> I\\<^sub>2 s) f U S\n     t\\<^sub>0 G", "using assms"], ["proof (prove)\nusing this:\n  diff_invariant I\\<^sub>1 f U S t\\<^sub>0 G\n  diff_invariant I\\<^sub>2 f U S t\\<^sub>0 G\n\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<and> I\\<^sub>2 s) f U S\n     t\\<^sub>0 G", "unfolding diff_invariant_def"], ["proof (prove)\nusing this:\n  (\\<Union> \\<circ> \\<P> (g_orbital f G U S t\\<^sub>0)) {s. I\\<^sub>1 s}\n  \\<subseteq> {s. I\\<^sub>1 s}\n  (\\<Union> \\<circ> \\<P> (g_orbital f G U S t\\<^sub>0)) {s. I\\<^sub>2 s}\n  \\<subseteq> {s. I\\<^sub>2 s}\n\ngoal (1 subgoal):\n 1. (\\<Union> \\<circ> \\<P> (g_orbital f G U S t\\<^sub>0))\n     {s. I\\<^sub>1 s \\<and> I\\<^sub>2 s}\n    \\<subseteq> {s. I\\<^sub>1 s \\<and> I\\<^sub>2 s}", "by auto"], ["", "lemma diff_invariant_disj_rule [diff_invariant_rules]:\n  assumes \"diff_invariant I\\<^sub>1 f U S t\\<^sub>0 G\"\n    and \"diff_invariant I\\<^sub>2 f U S t\\<^sub>0 G\"\n  shows \"diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<or> I\\<^sub>2 s) f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<or> I\\<^sub>2 s) f U S\n     t\\<^sub>0 G", "using assms"], ["proof (prove)\nusing this:\n  diff_invariant I\\<^sub>1 f U S t\\<^sub>0 G\n  diff_invariant I\\<^sub>2 f U S t\\<^sub>0 G\n\ngoal (1 subgoal):\n 1. diff_invariant (\\<lambda>s. I\\<^sub>1 s \\<or> I\\<^sub>2 s) f U S\n     t\\<^sub>0 G", "unfolding diff_invariant_def"], ["proof (prove)\nusing this:\n  (\\<Union> \\<circ> \\<P> (g_orbital f G U S t\\<^sub>0)) {s. I\\<^sub>1 s}\n  \\<subseteq> {s. I\\<^sub>1 s}\n  (\\<Union> \\<circ> \\<P> (g_orbital f G U S t\\<^sub>0)) {s. I\\<^sub>2 s}\n  \\<subseteq> {s. I\\<^sub>2 s}\n\ngoal (1 subgoal):\n 1. (\\<Union> \\<circ> \\<P> (g_orbital f G U S t\\<^sub>0))\n     {s. I\\<^sub>1 s \\<or> I\\<^sub>2 s}\n    \\<subseteq> {s. I\\<^sub>1 s \\<or> I\\<^sub>2 s}", "by auto"], ["", "subsection \\<open> Picard-Lindeloef \\<close>"], ["", "text\\<open> A locale with the assumptions of Picard-Lindeloef's theorem. It extends \n@{term \"ll_on_open_it\"} by providing an initial time @{term \"t\\<^sub>0 \\<in> T\"}.\\<close>"], ["", "locale picard_lindeloef =\n  fixes f::\"real \\<Rightarrow> ('a::{heine_borel,banach}) \\<Rightarrow> 'a\" and T::\"real set\" and S::\"'a set\" and t\\<^sub>0::real\n  assumes open_domain: \"open T\" \"open S\"\n    and interval_time: \"is_interval T\"\n    and init_time: \"t\\<^sub>0 \\<in> T\"\n    and cont_vec_field: \"\\<forall>s \\<in> S. continuous_on T (\\<lambda>t. f t s)\"\n    and lipschitz_vec_field: \"local_lipschitz T S f\"\nbegin"], ["", "sublocale ll_on_open_it T f S t\\<^sub>0"], ["proof (prove)\ngoal (1 subgoal):\n 1. ll_on_open_it T f S", "by (unfold_locales) (auto simp: cont_vec_field lipschitz_vec_field interval_time open_domain)"], ["", "lemma ll_on_open: \"ll_on_open T f S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ll_on_open T f S", "using local.general.ll_on_open_axioms"], ["proof (prove)\nusing this:\n  ll_on_open T f S\n\ngoal (1 subgoal):\n 1. ll_on_open T f S", "."], ["", "lemmas subintervalI = closed_segment_subset_domain\n   and init_time_ex_ivl = existence_ivl_initial_time[OF init_time]\n   and flow_at_init[simp] = general.flow_initial_time[OF init_time]"], ["", "abbreviation \"ex_ivl s \\<equiv> existence_ivl t\\<^sub>0 s\""], ["", "lemma flow_has_vderiv_on_ex_ivl:\n  assumes \"s \\<in> S\"\n  shows \"D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s\""], ["proof (prove)\ngoal (1 subgoal):\n 1.  D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s", "using flow_usolves_ode[OF init_time \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S\n\ngoal (1 subgoal):\n 1.  D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s", "unfolding usolves_ode_from_def solves_ode_def"], ["proof (prove)\nusing this:\n  ( D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t))\n    on ex_ivl s \\<and>\n   flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S) \\<and>\n  t\\<^sub>0 \\<in> ex_ivl s \\<and>\n  is_interval (ex_ivl s) \\<and>\n  (\\<forall>z T'.\n      t\\<^sub>0 \\<in> T' \\<and>\n      is_interval T' \\<and>\n      T' \\<subseteq> ex_ivl s \\<and>\n       D z = (\\<lambda>t. f t (z t)) on T' \\<and>\n      z \\<in> T' \\<rightarrow> S \\<longrightarrow>\n      z t\\<^sub>0 = flow t\\<^sub>0 s t\\<^sub>0 \\<longrightarrow>\n      (\\<forall>t\\<in>T'. z t = flow t\\<^sub>0 s t))\n\ngoal (1 subgoal):\n 1.  D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s", "by blast"], ["", "lemma flow_funcset_ex_ivl:\n  assumes \"s \\<in> S\"\n  shows \"flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S", "using flow_usolves_ode[OF init_time \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S\n\ngoal (1 subgoal):\n 1. flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S", "unfolding usolves_ode_from_def solves_ode_def"], ["proof (prove)\nusing this:\n  ( D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t))\n    on ex_ivl s \\<and>\n   flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S) \\<and>\n  t\\<^sub>0 \\<in> ex_ivl s \\<and>\n  is_interval (ex_ivl s) \\<and>\n  (\\<forall>z T'.\n      t\\<^sub>0 \\<in> T' \\<and>\n      is_interval T' \\<and>\n      T' \\<subseteq> ex_ivl s \\<and>\n       D z = (\\<lambda>t. f t (z t)) on T' \\<and>\n      z \\<in> T' \\<rightarrow> S \\<longrightarrow>\n      z t\\<^sub>0 = flow t\\<^sub>0 s t\\<^sub>0 \\<longrightarrow>\n      (\\<forall>t\\<in>T'. z t = flow t\\<^sub>0 s t))\n\ngoal (1 subgoal):\n 1. flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S", "by blast"], ["", "lemma flow_in_ivp_sols_ex_ivl:\n  assumes \"s \\<in> S\"\n  shows \"flow t\\<^sub>0 s \\<in> Sols f (\\<lambda>s. ex_ivl s) S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. flow t\\<^sub>0 s \\<in> Sols f ex_ivl S t\\<^sub>0 s", "using flow_has_vderiv_on_ex_ivl[OF assms]"], ["proof (prove)\nusing this:\n   D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s\n\ngoal (1 subgoal):\n 1. flow t\\<^sub>0 s \\<in> Sols f ex_ivl S t\\<^sub>0 s", "apply(rule ivp_solsI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. flow t\\<^sub>0 s t\\<^sub>0 = s\n 2. flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S\n 3. t\\<^sub>0 \\<in> ex_ivl s", "apply(simp_all add: init_time assms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S", "by (rule flow_funcset_ex_ivl[OF assms])"], ["", "lemma csols_eq: \"csols t\\<^sub>0 s = {(x, t). t \\<in> T \\<and>  x \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. csols t\\<^sub>0 s =\n    {(x, t).\n     t \\<in> T \\<and>\n     x \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s}", "unfolding ivp_sols_def csols_def solves_ode_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(x, t1).\n     {t\\<^sub>0--t1} \\<subseteq> T \\<and>\n     x t\\<^sub>0 = s \\<and>\n      D x = (\\<lambda>t. f t (x t)) on {t\\<^sub>0--t1} \\<and>\n     x \\<in> {t\\<^sub>0--t1} \\<rightarrow> S} =\n    {(x, t).\n     t \\<in> T \\<and>\n     x \\<in> {X \\<in> {t\\<^sub>0--t} \\<rightarrow> S.\n               D X = (\\<lambda>t. f t (X t)) on {t\\<^sub>0--t} \\<and>\n              X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> {t\\<^sub>0--t}}}", "using closed_segment_subset_domain init_time"], ["proof (prove)\nusing this:\n  \\<lbrakk>?t0.0 \\<in> T; ?t \\<in> T\\<rbrakk>\n  \\<Longrightarrow> {?t0.0--?t} \\<subseteq> T\n  t\\<^sub>0 \\<in> T\n\ngoal (1 subgoal):\n 1. {(x, t1).\n     {t\\<^sub>0--t1} \\<subseteq> T \\<and>\n     x t\\<^sub>0 = s \\<and>\n      D x = (\\<lambda>t. f t (x t)) on {t\\<^sub>0--t1} \\<and>\n     x \\<in> {t\\<^sub>0--t1} \\<rightarrow> S} =\n    {(x, t).\n     t \\<in> T \\<and>\n     x \\<in> {X \\<in> {t\\<^sub>0--t} \\<rightarrow> S.\n               D X = (\\<lambda>t. f t (X t)) on {t\\<^sub>0--t} \\<and>\n              X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> {t\\<^sub>0--t}}}", "by auto"], ["", "lemma subset_ex_ivlI:\n  \"Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s \\<Longrightarrow> {t\\<^sub>0--t} \\<subseteq> T \\<Longrightarrow> A \\<subseteq> {t\\<^sub>0--t} \\<Longrightarrow> A \\<subseteq> ex_ivl s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s;\n     {t\\<^sub>0--t} \\<subseteq> T; A \\<subseteq> {t\\<^sub>0--t}\\<rbrakk>\n    \\<Longrightarrow> A \\<subseteq> ex_ivl s", "apply(clarsimp simp: existence_ivl_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s;\n        {t\\<^sub>0--t} \\<subseteq> T; A \\<subseteq> {t\\<^sub>0--t};\n        x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>csols t\\<^sub>0 s.\n                            x \\<in> (case xa of\n                                     (x, xa) \\<Rightarrow> {t\\<^sub>0--xa})", "apply(subgoal_tac \"t\\<^sub>0 \\<in> T\", clarsimp simp: csols_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s;\n        {t\\<^sub>0--t} \\<subseteq> T; A \\<subseteq> {t\\<^sub>0--t};\n        x \\<in> A; t\\<^sub>0 \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            b \\<in> T \\<and>\n                            a \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--b}) S\n                                     t\\<^sub>0 s \\<and>\n                            x \\<in> {t\\<^sub>0--b}\n 2. \\<And>x.\n       \\<lbrakk>Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s;\n        {t\\<^sub>0--t} \\<subseteq> T; A \\<subseteq> {t\\<^sub>0--t};\n        x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>0 \\<in> T", "apply(rule_tac x=Y\\<^sub>1 in exI, rule_tac x=t in exI, safe, force)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s;\n        {t\\<^sub>0--t} \\<subseteq> T; A \\<subseteq> {t\\<^sub>0--t};\n        x \\<in> A; t\\<^sub>0 \\<in> T\\<rbrakk>\n       \\<Longrightarrow> Y\\<^sub>1\n                         \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S\n                                t\\<^sub>0 s\n 2. \\<And>x.\n       \\<lbrakk>Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s;\n        {t\\<^sub>0--t} \\<subseteq> T; A \\<subseteq> {t\\<^sub>0--t};\n        x \\<in> A; t\\<^sub>0 \\<in> T\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {t\\<^sub>0--t}\n 3. \\<And>x.\n       \\<lbrakk>Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. T) S t\\<^sub>0 s;\n        {t\\<^sub>0--t} \\<subseteq> T; A \\<subseteq> {t\\<^sub>0--t};\n        x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>0 \\<in> T", "by (rule in_ivp_sols_subset[where T=\"\\<lambda>s. T\"], auto)"], ["", "lemma unique_solution: \\<comment> \\<open> proved for a subset of T for general applications \\<close>\n  assumes \"s \\<in> S\" and \"t\\<^sub>0 \\<in> U\" and \"t \\<in> U\" \n    and \"is_interval U\" and \"U \\<subseteq> ex_ivl s\" \n    and xivp: \"D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on U\" \"Y\\<^sub>1 t\\<^sub>0 = s\" \"Y\\<^sub>1 \\<in> U \\<rightarrow> S\"\n    and yivp: \"D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on U\" \"Y\\<^sub>2 t\\<^sub>0 = s\" \"Y\\<^sub>2 \\<in> U \\<rightarrow> S\"\n  shows \"Y\\<^sub>1 t = Y\\<^sub>2 t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "have \"t\\<^sub>0 \\<in> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t\\<^sub>0 \\<in> T", "using assms existence_ivl_subset"], ["proof (prove)\nusing this:\n  s \\<in> S\n  t\\<^sub>0 \\<in> U\n  t \\<in> U\n  is_interval U\n  U \\<subseteq> ex_ivl s\n   D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on U\n  Y\\<^sub>1 t\\<^sub>0 = s\n  Y\\<^sub>1 \\<in> U \\<rightarrow> S\n   D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on U\n  Y\\<^sub>2 t\\<^sub>0 = s\n  Y\\<^sub>2 \\<in> U \\<rightarrow> S\n  ex_ivl ?x0.0 \\<subseteq> T\n\ngoal (1 subgoal):\n 1. t\\<^sub>0 \\<in> T", "by auto"], ["proof (state)\nthis:\n  t\\<^sub>0 \\<in> T\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "have key: \"(flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S", "using flow_usolves_ode[OF \\<open>t\\<^sub>0 \\<in> T\\<close> \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S\n\ngoal (1 subgoal):\n 1. (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S", "."], ["proof (state)\nthis:\n  (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "hence \"\\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t\""], ["proof (prove)\nusing this:\n  (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t", "unfolding usolves_ode_from_def solves_ode_def"], ["proof (prove)\nusing this:\n  ( D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t))\n    on ex_ivl s \\<and>\n   flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S) \\<and>\n  t\\<^sub>0 \\<in> ex_ivl s \\<and>\n  is_interval (ex_ivl s) \\<and>\n  (\\<forall>z T'.\n      t\\<^sub>0 \\<in> T' \\<and>\n      is_interval T' \\<and>\n      T' \\<subseteq> ex_ivl s \\<and>\n       D z = (\\<lambda>t. f t (z t)) on T' \\<and>\n      z \\<in> T' \\<rightarrow> S \\<longrightarrow>\n      z t\\<^sub>0 = flow t\\<^sub>0 s t\\<^sub>0 \\<longrightarrow>\n      (\\<forall>t\\<in>T'. z t = flow t\\<^sub>0 s t))\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t", "apply safe"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> U;\n         D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t))\n         on ex_ivl s;\n        flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S;\n        t\\<^sub>0 \\<in> ex_ivl s; is_interval (ex_ivl s);\n        \\<forall>z T'.\n           t\\<^sub>0 \\<in> T' \\<and>\n           is_interval T' \\<and>\n           T' \\<subseteq> ex_ivl s \\<and>\n            D z = (\\<lambda>t. f t (z t)) on T' \\<and>\n           z \\<in> T' \\<rightarrow> S \\<longrightarrow>\n           z t\\<^sub>0 = flow t\\<^sub>0 s t\\<^sub>0 \\<longrightarrow>\n           (\\<forall>t\\<in>T'. z t = flow t\\<^sub>0 s t)\\<rbrakk>\n       \\<Longrightarrow> Y\\<^sub>1 t = flow t\\<^sub>0 s t", "by (erule_tac x=Y\\<^sub>1 in allE, erule_tac x=U in allE, auto simp: assms)"], ["proof (state)\nthis:\n  \\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "also"], ["proof (state)\nthis:\n  \\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "have \"\\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t", "using key"], ["proof (prove)\nusing this:\n  (flow t\\<^sub>0 s usolves_ode f from t\\<^sub>0) (ex_ivl s) S\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t", "unfolding usolves_ode_from_def solves_ode_def"], ["proof (prove)\nusing this:\n  ( D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t))\n    on ex_ivl s \\<and>\n   flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S) \\<and>\n  t\\<^sub>0 \\<in> ex_ivl s \\<and>\n  is_interval (ex_ivl s) \\<and>\n  (\\<forall>z T'.\n      t\\<^sub>0 \\<in> T' \\<and>\n      is_interval T' \\<and>\n      T' \\<subseteq> ex_ivl s \\<and>\n       D z = (\\<lambda>t. f t (z t)) on T' \\<and>\n      z \\<in> T' \\<rightarrow> S \\<longrightarrow>\n      z t\\<^sub>0 = flow t\\<^sub>0 s t\\<^sub>0 \\<longrightarrow>\n      (\\<forall>t\\<in>T'. z t = flow t\\<^sub>0 s t))\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t", "apply safe"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> U;\n         D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t))\n         on ex_ivl s;\n        flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S;\n        t\\<^sub>0 \\<in> ex_ivl s; is_interval (ex_ivl s);\n        \\<forall>z T'.\n           t\\<^sub>0 \\<in> T' \\<and>\n           is_interval T' \\<and>\n           T' \\<subseteq> ex_ivl s \\<and>\n            D z = (\\<lambda>t. f t (z t)) on T' \\<and>\n           z \\<in> T' \\<rightarrow> S \\<longrightarrow>\n           z t\\<^sub>0 = flow t\\<^sub>0 s t\\<^sub>0 \\<longrightarrow>\n           (\\<forall>t\\<in>T'. z t = flow t\\<^sub>0 s t)\\<rbrakk>\n       \\<Longrightarrow> Y\\<^sub>2 t = flow t\\<^sub>0 s t", "by (erule_tac x=Y\\<^sub>2 in allE, erule_tac x=U in allE, auto simp: assms)"], ["proof (state)\nthis:\n  \\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t\n  \\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t", "show \"Y\\<^sub>1 t = Y\\<^sub>2 t\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t\n  \\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>U. Y\\<^sub>1 t = flow t\\<^sub>0 s t\n  \\<forall>t\\<in>U. Y\\<^sub>2 t = flow t\\<^sub>0 s t\n  s \\<in> S\n  t\\<^sub>0 \\<in> U\n  t \\<in> U\n  is_interval U\n  U \\<subseteq> ex_ivl s\n   D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on U\n  Y\\<^sub>1 t\\<^sub>0 = s\n  Y\\<^sub>1 \\<in> U \\<rightarrow> S\n   D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on U\n  Y\\<^sub>2 t\\<^sub>0 = s\n  Y\\<^sub>2 \\<in> U \\<rightarrow> S\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "by auto"], ["proof (state)\nthis:\n  Y\\<^sub>1 t = Y\\<^sub>2 t\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Applications of lemma @{text \"unique_solution\"}: \\<close>"], ["", "lemma unique_solution_closed_ivl:\n  assumes xivp: \"D X = (\\<lambda>t. f t (X t)) on {t\\<^sub>0--t}\" \"X t\\<^sub>0 = s\" \"X \\<in> {t\\<^sub>0--t} \\<rightarrow> S\" and \"t \\<in> T\"\n    and yivp: \"D Y = (\\<lambda>t. f t (Y t)) on {t\\<^sub>0--t}\" \"Y t\\<^sub>0 = s\" \"Y \\<in> {t\\<^sub>0--t} \\<rightarrow> S\" and \"s \\<in> S\" \n  shows \"X t = Y t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X t = Y t", "apply(rule unique_solution[OF \\<open>s \\<in> S\\<close>, of \"{t\\<^sub>0--t}\"], simp_all add: assms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s", "apply(unfold existence_ivl_def csols_eq ivp_sols_def, clarsimp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {t\\<^sub>0--t} \\<Longrightarrow>\n       \\<exists>a b.\n          b \\<in> T \\<and>\n          a \\<in> {t\\<^sub>0--b} \\<rightarrow> S \\<and>\n           D a = (\\<lambda>x. f x (a x)) on {t\\<^sub>0--b} \\<and>\n          a t\\<^sub>0 = s \\<and> x \\<in> {t\\<^sub>0--b}", "using xivp \\<open>t \\<in> T\\<close>"], ["proof (prove)\nusing this:\n   D X = (\\<lambda>t. f t (X t)) on {t\\<^sub>0--t}\n  X t\\<^sub>0 = s\n  X \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n  t \\<in> T\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {t\\<^sub>0--t} \\<Longrightarrow>\n       \\<exists>a b.\n          b \\<in> T \\<and>\n          a \\<in> {t\\<^sub>0--b} \\<rightarrow> S \\<and>\n           D a = (\\<lambda>x. f x (a x)) on {t\\<^sub>0--b} \\<and>\n          a t\\<^sub>0 = s \\<and> x \\<in> {t\\<^sub>0--b}", "by blast"], ["", "lemma solution_eq_flow:\n  assumes xivp: \"D X = (\\<lambda>t. f t (X t)) on ex_ivl s\" \"X t\\<^sub>0 = s\" \"X \\<in> ex_ivl s \\<rightarrow> S\" \n    and \"t \\<in> ex_ivl s\" and \"s \\<in> S\" \n  shows \"X t = flow t\\<^sub>0 s t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X t = flow t\\<^sub>0 s t", "apply(rule unique_solution[OF \\<open>s \\<in> S\\<close> init_time_ex_ivl \\<open>t \\<in> ex_ivl s\\<close>])"], ["proof (prove)\ngoal (9 subgoals):\n 1. s \\<in> S\n 2. is_interval (ex_ivl s)\n 3. ex_ivl s \\<subseteq> ex_ivl s\n 4.  D X = (\\<lambda>t. f t (X t)) on ex_ivl s\n 5. X t\\<^sub>0 = s\n 6. X \\<in> ex_ivl s \\<rightarrow> S\n 7.  D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s\n 8. flow t\\<^sub>0 s t\\<^sub>0 = s\n 9. flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S", "using flow_has_vderiv_on_ex_ivl flow_funcset_ex_ivl \\<open>s \\<in> S\\<close>"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow>\n   D flow t\\<^sub>0 ?s = (\\<lambda>t. f t (flow t\\<^sub>0 ?s t))\n   on ex_ivl ?s\n  ?s \\<in> S \\<Longrightarrow>\n  flow t\\<^sub>0 ?s \\<in> ex_ivl ?s \\<rightarrow> S\n  s \\<in> S\n\ngoal (9 subgoals):\n 1. s \\<in> S\n 2. is_interval (ex_ivl s)\n 3. ex_ivl s \\<subseteq> ex_ivl s\n 4.  D X = (\\<lambda>t. f t (X t)) on ex_ivl s\n 5. X t\\<^sub>0 = s\n 6. X \\<in> ex_ivl s \\<rightarrow> S\n 7.  D flow t\\<^sub>0 s = (\\<lambda>t. f t (flow t\\<^sub>0 s t)) on ex_ivl s\n 8. flow t\\<^sub>0 s t\\<^sub>0 = s\n 9. flow t\\<^sub>0 s \\<in> ex_ivl s \\<rightarrow> S", "by (auto simp: assms)"], ["", "lemma ivp_unique_solution:\n  assumes \"s \\<in> S\" and ivl: \"is_interval (U s)\" and \"U s \\<subseteq> T\" and \"t \\<in> U s\" \n    and ivp1: \"Y\\<^sub>1 \\<in> Sols f U S t\\<^sub>0 s\" and ivp2: \"Y\\<^sub>2 \\<in> Sols f U S t\\<^sub>0 s\"\n  shows \"Y\\<^sub>1 t = Y\\<^sub>2 t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t = Y\\<^sub>2 t", "proof(rule unique_solution[OF \\<open>s \\<in> S\\<close>, of \"{t\\<^sub>0--t}\"], simp_all)"], ["proof (state)\ngoal (7 subgoals):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n 2.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 3. Y\\<^sub>1 t\\<^sub>0 = s\n 4. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 5.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 6. Y\\<^sub>2 t\\<^sub>0 = s\n 7. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "have \"t\\<^sub>0 \\<in> U s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t\\<^sub>0 \\<in> U s", "using ivp_solsD[OF ivp1]"], ["proof (prove)\nusing this:\n   D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on U s\n  Y\\<^sub>1 t\\<^sub>0 = s\n  Y\\<^sub>1 \\<in> U s \\<rightarrow> S\n  t\\<^sub>0 \\<in> U s\n\ngoal (1 subgoal):\n 1. t\\<^sub>0 \\<in> U s", "by auto"], ["proof (state)\nthis:\n  t\\<^sub>0 \\<in> U s\n\ngoal (7 subgoals):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n 2.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 3. Y\\<^sub>1 t\\<^sub>0 = s\n 4. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 5.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 6. Y\\<^sub>2 t\\<^sub>0 = s\n 7. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "hence obs0: \"{t\\<^sub>0--t} \\<subseteq> U s\""], ["proof (prove)\nusing this:\n  t\\<^sub>0 \\<in> U s\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U s", "using closed_segment_subset_interval[OF ivl] \\<open>t \\<in> U s\\<close>"], ["proof (prove)\nusing this:\n  t\\<^sub>0 \\<in> U s\n  \\<lbrakk>?a \\<in> U s; ?b \\<in> U s\\<rbrakk>\n  \\<Longrightarrow> {?a--?b} \\<subseteq> U s\n  t \\<in> U s\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U s", "by blast"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> U s\n\ngoal (7 subgoals):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n 2.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 3. Y\\<^sub>1 t\\<^sub>0 = s\n 4. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 5.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 6. Y\\<^sub>2 t\\<^sub>0 = s\n 7. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "moreover"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> U s\n\ngoal (7 subgoals):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n 2.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 3. Y\\<^sub>1 t\\<^sub>0 = s\n 4. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 5.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 6. Y\\<^sub>2 t\\<^sub>0 = s\n 7. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "have obs1: \"Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s", "by (rule in_ivp_sols_subset[OF _ calculation(1) ivp1], simp)"], ["proof (state)\nthis:\n  Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\n\ngoal (7 subgoals):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n 2.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 3. Y\\<^sub>1 t\\<^sub>0 = s\n 4. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 5.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 6. Y\\<^sub>2 t\\<^sub>0 = s\n 7. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "moreover"], ["proof (state)\nthis:\n  Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\n\ngoal (7 subgoals):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n 2.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 3. Y\\<^sub>1 t\\<^sub>0 = s\n 4. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 5.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 6. Y\\<^sub>2 t\\<^sub>0 = s\n 7. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "have obs2: \"Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s", "by (rule in_ivp_sols_subset[OF _ calculation(1) ivp2], simp)"], ["proof (state)\nthis:\n  Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\n\ngoal (7 subgoals):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n 2.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 3. Y\\<^sub>1 t\\<^sub>0 = s\n 4. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 5.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 6. Y\\<^sub>2 t\\<^sub>0 = s\n 7. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "ultimately"], ["proof (chain)\npicking this:\n  {t\\<^sub>0--t} \\<subseteq> U s\n  Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\n  Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s", "show \"{t\\<^sub>0--t} \\<subseteq> ex_ivl s\""], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U s\n  Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\n  Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> ex_ivl s", "apply(unfold existence_ivl_def csols_eq, clarsimp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>{t\\<^sub>0--t} \\<subseteq> U s;\n        Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s;\n        Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s;\n        x \\<in> {t\\<^sub>0--t}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a b.\n                            b \\<in> T \\<and>\n                            a \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--b}) S\n                                     t\\<^sub>0 s \\<and>\n                            x \\<in> {t\\<^sub>0--b}", "apply(rule_tac x=Y\\<^sub>1 in exI, rule_tac x=t in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>{t\\<^sub>0--t} \\<subseteq> U s;\n        Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s;\n        Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s;\n        x \\<in> {t\\<^sub>0--t}\\<rbrakk>\n       \\<Longrightarrow> t \\<in> T \\<and>\n                         Y\\<^sub>1\n                         \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S\n                                t\\<^sub>0 s \\<and>\n                         x \\<in> {t\\<^sub>0--t}", "using \\<open>t \\<in> U s\\<close> and \\<open>U s \\<subseteq> T\\<close>"], ["proof (prove)\nusing this:\n  t \\<in> U s\n  U s \\<subseteq> T\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>{t\\<^sub>0--t} \\<subseteq> U s;\n        Y\\<^sub>1 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s;\n        Y\\<^sub>2 \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S t\\<^sub>0 s;\n        x \\<in> {t\\<^sub>0--t}\\<rbrakk>\n       \\<Longrightarrow> t \\<in> T \\<and>\n                         Y\\<^sub>1\n                         \\<in> Sols f (\\<lambda>s. {t\\<^sub>0--t}) S\n                                t\\<^sub>0 s \\<and>\n                         x \\<in> {t\\<^sub>0--t}", "by force"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> ex_ivl s\n\ngoal (6 subgoals):\n 1.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n 2. Y\\<^sub>1 t\\<^sub>0 = s\n 3. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 4.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 5. Y\\<^sub>2 t\\<^sub>0 = s\n 6. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "show \"D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1.  D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}", "by (rule ivp_solsD[OF in_ivp_sols_subset[OF _ _ ivp1]], simp_all add: obs0)"], ["proof (state)\nthis:\n   D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n\ngoal (5 subgoals):\n 1. Y\\<^sub>1 t\\<^sub>0 = s\n 2. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 3.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n 4. Y\\<^sub>2 t\\<^sub>0 = s\n 5. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "show \"D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1.  D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}", "by (rule ivp_solsD[OF in_ivp_sols_subset[OF _ _ ivp2]], simp_all add: obs0)"], ["proof (state)\nthis:\n   D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n\ngoal (4 subgoals):\n 1. Y\\<^sub>1 t\\<^sub>0 = s\n 2. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 3. Y\\<^sub>2 t\\<^sub>0 = s\n 4. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "show \"Y\\<^sub>1 t\\<^sub>0 = s\" and \"Y\\<^sub>2 t\\<^sub>0 = s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t\\<^sub>0 = s &&& Y\\<^sub>2 t\\<^sub>0 = s", "using ivp_solsD[OF ivp1] ivp_solsD[OF ivp2]"], ["proof (prove)\nusing this:\n   D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on U s\n  Y\\<^sub>1 t\\<^sub>0 = s\n  Y\\<^sub>1 \\<in> U s \\<rightarrow> S\n  t\\<^sub>0 \\<in> U s\n   D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on U s\n  Y\\<^sub>2 t\\<^sub>0 = s\n  Y\\<^sub>2 \\<in> U s \\<rightarrow> S\n  t\\<^sub>0 \\<in> U s\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 t\\<^sub>0 = s &&& Y\\<^sub>2 t\\<^sub>0 = s", "by auto"], ["proof (state)\nthis:\n  Y\\<^sub>1 t\\<^sub>0 = s\n  Y\\<^sub>2 t\\<^sub>0 = s\n\ngoal (2 subgoals):\n 1. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n 2. Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "show \"Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\" and \"Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S &&&\n    Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "using ivp_solsD[OF obs1] ivp_solsD[OF obs2]"], ["proof (prove)\nusing this:\n   D Y\\<^sub>1 = (\\<lambda>t. f t (Y\\<^sub>1 t)) on {t\\<^sub>0--t}\n  Y\\<^sub>1 t\\<^sub>0 = s\n  Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n  t\\<^sub>0 \\<in> {t\\<^sub>0--t}\n   D Y\\<^sub>2 = (\\<lambda>t. f t (Y\\<^sub>2 t)) on {t\\<^sub>0--t}\n  Y\\<^sub>2 t\\<^sub>0 = s\n  Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n  t\\<^sub>0 \\<in> {t\\<^sub>0--t}\n\ngoal (1 subgoal):\n 1. Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S &&&\n    Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S", "by auto"], ["proof (state)\nthis:\n  Y\\<^sub>1 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n  Y\\<^sub>2 \\<in> {t\\<^sub>0--t} \\<rightarrow> S\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma g_orbital_orbit:\n  assumes \"s \\<in> S\" and ivl: \"is_interval (U s)\" and \"U s \\<subseteq> T\"\n    and ivp: \"Y \\<in> Sols f U S t\\<^sub>0 s\"\n  shows \"g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)", "have eq1: \"\\<forall>Z \\<in> Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. Z t = Y t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>Z\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. Z t = Y t", "by (clarsimp, rule ivp_unique_solution[OF assms(1,2,3) _ _ ivp], auto)"], ["proof (state)\nthis:\n  \\<forall>Z\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. Z t = Y t\n\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)", "have \"g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbit (\\<lambda>t. Y t) G (U s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbit Y G (U s)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> g_orbital f G U S t\\<^sub>0 s \\<Longrightarrow>\n       x \\<in> g_orbit Y G (U s)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> g_orbital f G U S t\\<^sub>0 s \\<Longrightarrow>\n       x \\<in> g_orbit Y G (U s)", "assume \"x \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (state)\nthis:\n  x \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> g_orbital f G U S t\\<^sub>0 s \\<Longrightarrow>\n       x \\<in> g_orbit Y G (U s)", "then"], ["proof (chain)\npicking this:\n  x \\<in> g_orbital f G U S t\\<^sub>0 s", "obtain Z and t \n      where z_def: \"x = Z t \\<and> t \\<in> U s \\<and> (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and> Z \\<in> Sols f U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  x \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. (\\<And>Z t.\n        x = Z t \\<and>\n        t \\<in> U s \\<and>\n        (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n        Z \\<in> Sols f U S t\\<^sub>0 s \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "unfolding g_orbital_eq"], ["proof (prove)\nusing this:\n  x \\<in> {X t |t X.\n           t \\<in> U s \\<and>\n           \\<P> X (down (U s) t) \\<subseteq> Collect G \\<and>\n           X \\<in> Sols f U S t\\<^sub>0 s}\n\ngoal (1 subgoal):\n 1. (\\<And>Z t.\n        x = Z t \\<and>\n        t \\<in> U s \\<and>\n        (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n        Z \\<in> Sols f U S t\\<^sub>0 s \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x = Z t \\<and>\n  t \\<in> U s \\<and>\n  (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n  Z \\<in> Sols f U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> g_orbital f G U S t\\<^sub>0 s \\<Longrightarrow>\n       x \\<in> g_orbit Y G (U s)", "hence \"{t\\<^sub>0--t} \\<subseteq> U s\""], ["proof (prove)\nusing this:\n  x = Z t \\<and>\n  t \\<in> U s \\<and>\n  (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n  Z \\<in> Sols f U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U s", "using closed_segment_subset_interval[OF ivl ivp_solsD(4)[OF ivp]]"], ["proof (prove)\nusing this:\n  x = Z t \\<and>\n  t \\<in> U s \\<and>\n  (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n  Z \\<in> Sols f U S t\\<^sub>0 s\n  ?b \\<in> U s \\<Longrightarrow> {t\\<^sub>0--?b} \\<subseteq> U s\n\ngoal (1 subgoal):\n 1. {t\\<^sub>0--t} \\<subseteq> U s", "by blast"], ["proof (state)\nthis:\n  {t\\<^sub>0--t} \\<subseteq> U s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> g_orbital f G U S t\\<^sub>0 s \\<Longrightarrow>\n       x \\<in> g_orbit Y G (U s)", "hence \"\\<forall>\\<tau>\\<in>{t\\<^sub>0--t}. Z \\<tau> = Y \\<tau>\""], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U s\n\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>{t\\<^sub>0--t}. Z \\<tau> = Y \\<tau>", "using z_def"], ["proof (prove)\nusing this:\n  {t\\<^sub>0--t} \\<subseteq> U s\n  x = Z t \\<and>\n  t \\<in> U s \\<and>\n  (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n  Z \\<in> Sols f U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>{t\\<^sub>0--t}. Z \\<tau> = Y \\<tau>", "apply clarsimp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>\\<tau>.\n       \\<lbrakk>{t\\<^sub>0--t} \\<subseteq> U s; \\<tau> \\<in> {t\\<^sub>0--t};\n        x = Z t; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (Z \\<tau>);\n        Z \\<in> Sols f U S t\\<^sub>0 s\\<rbrakk>\n       \\<Longrightarrow> Z \\<tau> = Y \\<tau>", "by (rule ivp_unique_solution[OF assms(1,2,3) _ _ ivp], auto)"], ["proof (state)\nthis:\n  \\<forall>\\<tau>\\<in>{t\\<^sub>0--t}. Z \\<tau> = Y \\<tau>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> g_orbital f G U S t\\<^sub>0 s \\<Longrightarrow>\n       x \\<in> g_orbit Y G (U s)", "thus \"x \\<in> g_orbit Y G (U s)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\\<in>{t\\<^sub>0--t}. Z \\<tau> = Y \\<tau>\n\ngoal (1 subgoal):\n 1. x \\<in> g_orbit Y G (U s)", "using z_def eq1"], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\\<in>{t\\<^sub>0--t}. Z \\<tau> = Y \\<tau>\n  x = Z t \\<and>\n  t \\<in> U s \\<and>\n  (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n  Z \\<in> Sols f U S t\\<^sub>0 s\n  \\<forall>Z\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. Z t = Y t\n\ngoal (1 subgoal):\n 1. x \\<in> g_orbit Y G (U s)", "unfolding g_orbit_eq"], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\\<in>{t\\<^sub>0--t}. Z \\<tau> = Y \\<tau>\n  x = Z t \\<and>\n  t \\<in> U s \\<and>\n  (\\<forall>\\<tau>\\<in>down (U s) t. G (Z \\<tau>)) \\<and>\n  Z \\<in> Sols f U S t\\<^sub>0 s\n  \\<forall>Z\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. Z t = Y t\n\ngoal (1 subgoal):\n 1. x \\<in> {Y t |t.\n             t \\<in> U s \\<and>\n             (\\<forall>\\<tau>\\<in>down (U s) t. G (Y \\<tau>))}", "by simp metis"], ["proof (state)\nthis:\n  x \\<in> g_orbit Y G (U s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbit Y G (U s)\n\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)", "moreover"], ["proof (state)\nthis:\n  g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbit Y G (U s)\n\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)", "have \"g_orbit Y G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbit Y G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s", "apply(unfold g_orbital_eq g_orbit_eq ivp_sols_def, clarsimp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (Y \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ta X.\n                            Y t = X ta \\<and>\n                            ta \\<in> U s \\<and>\n                            (\\<forall>x.\n                                x \\<in> U s \\<and>\n                                x \\<le> ta \\<longrightarrow>\n                                G (X x)) \\<and>\n                            X \\<in> U s \\<rightarrow> S \\<and>\n                             D X = (\\<lambda>x. f x (X x)) on U s \\<and>\n                            X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s", "apply(rule_tac x=t in exI, rule_tac x=Y in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (Y \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> Y t = Y t \\<and>\n                         t \\<in> U s \\<and>\n                         (\\<forall>x.\n                             x \\<in> U s \\<and> x \\<le> t \\<longrightarrow>\n                             G (Y x)) \\<and>\n                         Y \\<in> U s \\<rightarrow> S \\<and>\n                          D Y = (\\<lambda>x. f x (Y x)) on U s \\<and>\n                         Y t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s", "using ivp_solsD[OF ivp]"], ["proof (prove)\nusing this:\n   D Y = (\\<lambda>t. f t (Y t)) on U s\n  Y t\\<^sub>0 = s\n  Y \\<in> U s \\<rightarrow> S\n  t\\<^sub>0 \\<in> U s\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (Y \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> Y t = Y t \\<and>\n                         t \\<in> U s \\<and>\n                         (\\<forall>x.\n                             x \\<in> U s \\<and> x \\<le> t \\<longrightarrow>\n                             G (Y x)) \\<and>\n                         Y \\<in> U s \\<rightarrow> S \\<and>\n                          D Y = (\\<lambda>x. f x (Y x)) on U s \\<and>\n                         Y t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s", "by auto"], ["proof (state)\nthis:\n  g_orbit Y G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)", "ultimately"], ["proof (chain)\npicking this:\n  g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbit Y G (U s)\n  g_orbit Y G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s", "show ?thesis"], ["proof (prove)\nusing this:\n  g_orbital f G U S t\\<^sub>0 s \\<subseteq> g_orbit Y G (U s)\n  g_orbit Y G (U s) \\<subseteq> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)", "by blast"], ["proof (state)\nthis:\n  g_orbital f G U S t\\<^sub>0 s = g_orbit Y G (U s)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "lemma local_lipschitz_add: \n  fixes f1 f2 :: \"real \\<Rightarrow> 'a::banach \\<Rightarrow> 'a\"\n  assumes \"local_lipschitz T S f1\"\n      and \"local_lipschitz T S f2\" \n    shows \"local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)", "proof(unfold local_lipschitz_def, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "fix s and t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "assume \"s \\<in> S\" and \"t \\<in> T\""], ["proof (state)\nthis:\n  s \\<in> S\n  t \\<in> T\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "obtain \\<epsilon>\\<^sub>1 L1 where \"\\<epsilon>\\<^sub>1 > 0\" and L1: \"\\<And>\\<tau>. \\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T \\<Longrightarrow> L1-lipschitz_on (cball s \\<epsilon>\\<^sub>1 \\<inter> S) (f1 \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<epsilon>\\<^sub>1 L1.\n        \\<lbrakk>0 < \\<epsilon>\\<^sub>1;\n         \\<And>\\<tau>.\n            \\<tau>\n            \\<in> cball t \\<epsilon>\\<^sub>1 \\<inter> T \\<Longrightarrow>\n            L1-lipschitz_on (cball s \\<epsilon>\\<^sub>1 \\<inter> S)\n             (f1 \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using local_lipschitzE[OF assms(1) \\<open>t \\<in> T\\<close> \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  (\\<And>u L.\n      \\<lbrakk>0 < u;\n       \\<And>sa.\n          sa \\<in> cball t u \\<inter> T \\<Longrightarrow>\n          L-lipschitz_on (cball s u \\<inter> S) (f1 sa)\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<epsilon>\\<^sub>1 L1.\n        \\<lbrakk>0 < \\<epsilon>\\<^sub>1;\n         \\<And>\\<tau>.\n            \\<tau>\n            \\<in> cball t \\<epsilon>\\<^sub>1 \\<inter> T \\<Longrightarrow>\n            L1-lipschitz_on (cball s \\<epsilon>\\<^sub>1 \\<inter> S)\n             (f1 \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < \\<epsilon>\\<^sub>1\n  ?\\<tau> \\<in> cball t \\<epsilon>\\<^sub>1 \\<inter> T \\<Longrightarrow>\n  L1-lipschitz_on (cball s \\<epsilon>\\<^sub>1 \\<inter> S) (f1 ?\\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "obtain \\<epsilon>\\<^sub>2 L2 where \"\\<epsilon>\\<^sub>2 > 0\" and L2: \"\\<And>\\<tau>. \\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T \\<Longrightarrow> L2-lipschitz_on (cball s \\<epsilon>\\<^sub>2 \\<inter> S) (f2 \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<epsilon>\\<^sub>2 L2.\n        \\<lbrakk>0 < \\<epsilon>\\<^sub>2;\n         \\<And>\\<tau>.\n            \\<tau>\n            \\<in> cball t \\<epsilon>\\<^sub>2 \\<inter> T \\<Longrightarrow>\n            L2-lipschitz_on (cball s \\<epsilon>\\<^sub>2 \\<inter> S)\n             (f2 \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using local_lipschitzE[OF assms(2) \\<open>t \\<in> T\\<close> \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  (\\<And>u L.\n      \\<lbrakk>0 < u;\n       \\<And>sa.\n          sa \\<in> cball t u \\<inter> T \\<Longrightarrow>\n          L-lipschitz_on (cball s u \\<inter> S) (f2 sa)\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<epsilon>\\<^sub>2 L2.\n        \\<lbrakk>0 < \\<epsilon>\\<^sub>2;\n         \\<And>\\<tau>.\n            \\<tau>\n            \\<in> cball t \\<epsilon>\\<^sub>2 \\<inter> T \\<Longrightarrow>\n            L2-lipschitz_on (cball s \\<epsilon>\\<^sub>2 \\<inter> S)\n             (f2 \\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < \\<epsilon>\\<^sub>2\n  ?\\<tau> \\<in> cball t \\<epsilon>\\<^sub>2 \\<inter> T \\<Longrightarrow>\n  L2-lipschitz_on (cball s \\<epsilon>\\<^sub>2 \\<inter> S) (f2 ?\\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "have ballH: \"cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S \\<subseteq> cball s \\<epsilon>\\<^sub>1 \\<inter> S\" \"cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S \\<subseteq> cball s \\<epsilon>\\<^sub>2 \\<inter> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S\n    \\<subseteq> cball s \\<epsilon>\\<^sub>1 \\<inter> S &&&\n    cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S\n    \\<subseteq> cball s \\<epsilon>\\<^sub>2 \\<inter> S", "by auto"], ["proof (state)\nthis:\n  cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S\n  \\<subseteq> cball s \\<epsilon>\\<^sub>1 \\<inter> S\n  cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S\n  \\<subseteq> cball s \\<epsilon>\\<^sub>2 \\<inter> S\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "have obs1: \"\\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T. L1-lipschitz_on (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S) (f1 \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T.\n       L1-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (f1 \\<tau>)", "using lipschitz_on_subset[OF L1 ballH(1)]"], ["proof (prove)\nusing this:\n  ?\\<tau>1 \\<in> cball t \\<epsilon>\\<^sub>1 \\<inter> T \\<Longrightarrow>\n  L1-lipschitz_on\n   (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n   (f1 ?\\<tau>1)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T.\n       L1-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (f1 \\<tau>)", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T.\n     L1-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f1 \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "also"], ["proof (state)\nthis:\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T.\n     L1-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f1 \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "have obs2: \"\\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T. L2-lipschitz_on (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S) (f2 \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T.\n       L2-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (f2 \\<tau>)", "using lipschitz_on_subset[OF L2 ballH(2)]"], ["proof (prove)\nusing this:\n  ?\\<tau>1 \\<in> cball t \\<epsilon>\\<^sub>2 \\<inter> T \\<Longrightarrow>\n  L2-lipschitz_on\n   (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n   (f2 ?\\<tau>1)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T.\n       L2-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (f2 \\<tau>)", "by blast"], ["proof (state)\nthis:\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T.\n     L2-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f2 \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T.\n     L1-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f1 \\<tau>)\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T.\n     L2-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f2 \\<tau>)", "have \"\\<forall>\\<tau>\\<in>cball t (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> T. \n    (L1 + L2)-lipschitz_on (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S) (\\<lambda>s. f1 \\<tau> s + f2 \\<tau> s)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T.\n     L1-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f1 \\<tau>)\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T.\n     L2-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f2 \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\n             \\<in>cball t\n                   (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                  T.\n       (L1 + L2)-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (\\<lambda>s. f1 \\<tau> s + f2 \\<tau> s)", "using lipschitz_on_add"], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>1 \\<inter> T.\n     L1-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f1 \\<tau>)\n  \\<forall>\\<tau>\\<in>cball t \\<epsilon>\\<^sub>2 \\<inter> T.\n     L2-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (f2 \\<tau>)\n  \\<lbrakk>?C-lipschitz_on ?U ?f; ?D-lipschitz_on ?U ?g\\<rbrakk>\n  \\<Longrightarrow> (?C + ?D)-lipschitz_on ?U (\\<lambda>x. ?f x + ?g x)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\n             \\<in>cball t\n                   (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                  T.\n       (L1 + L2)-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (\\<lambda>s. f1 \\<tau> s + f2 \\<tau> s)", "by fastforce"], ["proof (state)\nthis:\n  \\<forall>\\<tau>\n           \\<in>cball t (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                T.\n     (L1 + L2)-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (\\<lambda>s. f1 \\<tau> s + f2 \\<tau> s)\n\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<lbrakk>x \\<in> S; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            \\<exists>L.\n                               \\<forall>t\\<in>cball t u \\<inter> T.\n                                  L-lipschitz_on (cball x u \\<inter> S)\n                                   (\\<lambda>s. f1 t s + f2 t s)", "thus \"\\<exists>u>0. \\<exists>L. \\<forall>t\\<in>cball t u \\<inter> T. L-lipschitz_on (cball s u \\<inter> S) (\\<lambda>s. f1 t s + f2 t s)\""], ["proof (prove)\nusing this:\n  \\<forall>\\<tau>\n           \\<in>cball t (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                T.\n     (L1 + L2)-lipschitz_on\n      (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n      (\\<lambda>s. f1 \\<tau> s + f2 \\<tau> s)\n\ngoal (1 subgoal):\n 1. \\<exists>u>0.\n       \\<exists>L.\n          \\<forall>t\\<in>cball t u \\<inter> T.\n             L-lipschitz_on (cball s u \\<inter> S)\n              (\\<lambda>s. f1 t s + f2 t s)", "apply(rule_tac x=\"min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2\" in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\n             \\<in>cball t\n                   (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                  T.\n       (L1 + L2)-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (\\<lambda>s. f1 \\<tau> s + f2 \\<tau> s) \\<Longrightarrow>\n    0 < min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2 \\<and>\n    (\\<exists>L.\n        \\<forall>t\\<in>cball t\n                        (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                       T.\n           L-lipschitz_on\n            (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n            (\\<lambda>s. f1 t s + f2 t s))", "using \\<open>\\<epsilon>\\<^sub>1 > 0\\<close> \\<open>\\<epsilon>\\<^sub>2 > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < \\<epsilon>\\<^sub>1\n  0 < \\<epsilon>\\<^sub>2\n\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\n             \\<in>cball t\n                   (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                  T.\n       (L1 + L2)-lipschitz_on\n        (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n        (\\<lambda>s. f1 \\<tau> s + f2 \\<tau> s) \\<Longrightarrow>\n    0 < min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2 \\<and>\n    (\\<exists>L.\n        \\<forall>t\\<in>cball t\n                        (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter>\n                       T.\n           L-lipschitz_on\n            (cball s (min \\<epsilon>\\<^sub>1 \\<epsilon>\\<^sub>2) \\<inter> S)\n            (\\<lambda>s. f1 t s + f2 t s))", "by force"], ["proof (state)\nthis:\n  \\<exists>u>0.\n     \\<exists>L.\n        \\<forall>t\\<in>cball t u \\<inter> T.\n           L-lipschitz_on (cball s u \\<inter> S)\n            (\\<lambda>s. f1 t s + f2 t s)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma picard_lindeloef_add: \"picard_lindeloef f1 T S t\\<^sub>0 \\<Longrightarrow> picard_lindeloef f2 T S t\\<^sub>0 \\<Longrightarrow> \n  picard_lindeloef (\\<lambda>t s. f1 t s + f2 t s) T S t\\<^sub>0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>picard_lindeloef f1 T S t\\<^sub>0;\n     picard_lindeloef f2 T S t\\<^sub>0\\<rbrakk>\n    \\<Longrightarrow> picard_lindeloef (\\<lambda>t s. f1 t s + f2 t s) T S\n                       t\\<^sub>0", "unfolding picard_lindeloef_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(open T \\<and> open S \\<and> is_interval T) \\<and>\n             t\\<^sub>0 \\<in> T \\<and>\n             (\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f1 t s)) \\<and>\n             local_lipschitz T S f1;\n     (open T \\<and> open S \\<and> is_interval T) \\<and>\n     t\\<^sub>0 \\<in> T \\<and>\n     (\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f2 t s)) \\<and>\n     local_lipschitz T S f2\\<rbrakk>\n    \\<Longrightarrow> (open T \\<and> open S \\<and> is_interval T) \\<and>\n                      t\\<^sub>0 \\<in> T \\<and>\n                      (\\<forall>s\\<in>S.\n                          continuous_on T\n                           (\\<lambda>t. f1 t s + f2 t s)) \\<and>\n                      local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)", "apply(clarsimp, rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f1 t s);\n     local_lipschitz T S f1; open T; open S; is_interval T;\n     t\\<^sub>0 \\<in> T;\n     \\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f2 t s);\n     local_lipschitz T S f2\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s\\<in>S.\n                         continuous_on T (\\<lambda>t. f1 t s + f2 t s)\n 2. \\<lbrakk>\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f1 t s);\n     local_lipschitz T S f1; open T; open S; is_interval T;\n     t\\<^sub>0 \\<in> T;\n     \\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f2 t s);\n     local_lipschitz T S f2\\<rbrakk>\n    \\<Longrightarrow> local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)", "using continuous_on_add"], ["proof (prove)\nusing this:\n  \\<lbrakk>continuous_on ?s ?f; continuous_on ?s ?g\\<rbrakk>\n  \\<Longrightarrow> continuous_on ?s (\\<lambda>x. ?f x + ?g x)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f1 t s);\n     local_lipschitz T S f1; open T; open S; is_interval T;\n     t\\<^sub>0 \\<in> T;\n     \\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f2 t s);\n     local_lipschitz T S f2\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s\\<in>S.\n                         continuous_on T (\\<lambda>t. f1 t s + f2 t s)\n 2. \\<lbrakk>\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f1 t s);\n     local_lipschitz T S f1; open T; open S; is_interval T;\n     t\\<^sub>0 \\<in> T;\n     \\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f2 t s);\n     local_lipschitz T S f2\\<rbrakk>\n    \\<Longrightarrow> local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)", "apply fastforce"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f1 t s);\n     local_lipschitz T S f1; open T; open S; is_interval T;\n     t\\<^sub>0 \\<in> T;\n     \\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f2 t s);\n     local_lipschitz T S f2\\<rbrakk>\n    \\<Longrightarrow> local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)", "using local_lipschitz_add"], ["proof (prove)\nusing this:\n  \\<lbrakk>local_lipschitz ?T ?S ?f1.0; local_lipschitz ?T ?S ?f2.0\\<rbrakk>\n  \\<Longrightarrow> local_lipschitz ?T ?S\n                     (\\<lambda>t s. ?f1.0 t s + ?f2.0 t s)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f1 t s);\n     local_lipschitz T S f1; open T; open S; is_interval T;\n     t\\<^sub>0 \\<in> T;\n     \\<forall>s\\<in>S. continuous_on T (\\<lambda>t. f2 t s);\n     local_lipschitz T S f2\\<rbrakk>\n    \\<Longrightarrow> local_lipschitz T S (\\<lambda>t s. f1 t s + f2 t s)", "by blast"], ["", "lemma picard_lindeloef_constant: \"picard_lindeloef (\\<lambda>t s. c) UNIV UNIV t\\<^sub>0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. picard_lindeloef (\\<lambda>t s. c) UNIV UNIV t\\<^sub>0", "apply(unfold_locales, simp_all add: local_lipschitz_def lipschitz_on_def, clarsimp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x t.\n       \\<exists>u>0.\n          (\\<exists>ta. dist t ta \\<le> u) \\<longrightarrow>\n          (\\<exists>L\\<ge>0.\n              \\<forall>xa\\<in>cball x u.\n                 \\<forall>y\\<in>cball x u. 0 \\<le> L * dist xa y)", "by (rule_tac x=1 in exI, clarsimp, rule_tac x=\"1/2\" in exI, simp)"], ["", "subsection \\<open> Flows for ODEs \\<close>"], ["", "text\\<open> A locale designed for verification of hybrid systems. The user can select the interval \nof existence and the defining flow equation via the variables @{term \"T\"} and @{term \"\\<phi>\"}.\\<close>"], ["", "locale local_flow = picard_lindeloef \"(\\<lambda> t. f)\" T S 0 \n  for f::\"'a::{heine_borel,banach} \\<Rightarrow> 'a\" and T S L +\n  fixes \\<phi> :: \"real \\<Rightarrow> 'a \\<Rightarrow> 'a\"\n  assumes ivp:\n    \"\\<And> t s. t \\<in> T \\<Longrightarrow> s \\<in> S \\<Longrightarrow> D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--t}\"\n    \"\\<And> s. s \\<in> S \\<Longrightarrow> \\<phi> 0 s = s\"\n    \"\\<And> t s. t \\<in> T \\<Longrightarrow> s \\<in> S \\<Longrightarrow> (\\<lambda>t. \\<phi> t s) \\<in> {0--t} \\<rightarrow> S\"\nbegin"], ["", "lemma in_ivp_sols_ivl: \n  assumes \"t \\<in> T\" \"s \\<in> S\"\n  shows \"(\\<lambda>t. \\<phi> t s) \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {0--t}) S 0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. \\<phi> t s)\n    \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {0--t}) S 0 s", "apply(rule ivp_solsI)"], ["proof (prove)\ngoal (4 subgoals):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--t}\n 2. \\<phi> 0 s = s\n 3. (\\<lambda>t. \\<phi> t s) \\<in> {0--t} \\<rightarrow> S\n 4. 0 \\<in> {0--t}", "using ivp assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>?t \\<in> T; ?s \\<in> S\\<rbrakk>\n  \\<Longrightarrow>  D (\\<lambda>t.\n                           \\<phi> t ?s) = (\\<lambda>t. f (\\<phi> t ?s))\n                     on {0--?t}\n  ?s \\<in> S \\<Longrightarrow> \\<phi> 0 ?s = ?s\n  \\<lbrakk>?t \\<in> T; ?s \\<in> S\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>t. \\<phi> t ?s) \\<in> {0--?t} \\<rightarrow> S\n  t \\<in> T\n  s \\<in> S\n\ngoal (4 subgoals):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--t}\n 2. \\<phi> 0 s = s\n 3. (\\<lambda>t. \\<phi> t s) \\<in> {0--t} \\<rightarrow> S\n 4. 0 \\<in> {0--t}", "by auto"], ["", "lemma eq_solution_ivl:\n  assumes xivp: \"D X = (\\<lambda>t. f (X t)) on {0--t}\" \"X 0 = s\" \"X \\<in> {0--t} \\<rightarrow> S\" \n    and indom: \"t \\<in> T\" \"s \\<in> S\"\n  shows \"X t = \\<phi> t s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X t = \\<phi> t s", "apply(rule unique_solution_closed_ivl[OF xivp \\<open>t \\<in> T\\<close>])"], ["proof (prove)\ngoal (4 subgoals):\n 1.  D (\\<lambda>a. \\<phi> a s) = (\\<lambda>t. f (\\<phi> t s)) on {0--t}\n 2. \\<phi> 0 s = s\n 3. (\\<lambda>a. \\<phi> a s) \\<in> {0--t} \\<rightarrow> S\n 4. s \\<in> S", "using \\<open>s \\<in> S\\<close> ivp indom"], ["proof (prove)\nusing this:\n  s \\<in> S\n  \\<lbrakk>?t \\<in> T; ?s \\<in> S\\<rbrakk>\n  \\<Longrightarrow>  D (\\<lambda>t.\n                           \\<phi> t ?s) = (\\<lambda>t. f (\\<phi> t ?s))\n                     on {0--?t}\n  ?s \\<in> S \\<Longrightarrow> \\<phi> 0 ?s = ?s\n  \\<lbrakk>?t \\<in> T; ?s \\<in> S\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>t. \\<phi> t ?s) \\<in> {0--?t} \\<rightarrow> S\n  t \\<in> T\n  s \\<in> S\n\ngoal (4 subgoals):\n 1.  D (\\<lambda>a. \\<phi> a s) = (\\<lambda>t. f (\\<phi> t s)) on {0--t}\n 2. \\<phi> 0 s = s\n 3. (\\<lambda>a. \\<phi> a s) \\<in> {0--t} \\<rightarrow> S\n 4. s \\<in> S", "by auto"], ["", "lemma ex_ivl_eq:\n  assumes \"s \\<in> S\"\n  shows \"ex_ivl s = T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ex_ivl s = T", "using existence_ivl_subset[of s]"], ["proof (prove)\nusing this:\n  ex_ivl s \\<subseteq> T\n\ngoal (1 subgoal):\n 1. ex_ivl s = T", "apply safe"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ex_ivl s \\<subseteq> T; x \\<in> T\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ex_ivl s", "unfolding existence_ivl_def csols_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>(\\<Union>(x,\n                    y)\\<in>{(x, t).\n                            t \\<in> T \\<and>\n                            x \\<in> Sols (\\<lambda>t. f)\n                                     (\\<lambda>s. {0--t}) S 0 s}.\n                    {0--y})\n                \\<subseteq> T;\n        x \\<in> T\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (\\<Union>(x,\n                                     y)\\<in>{(x, t).\n       t \\<in> T \\<and>\n       x \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {0--t}) S 0 s}.\n                                     {0--y})", "using in_ivp_sols_ivl[OF _ assms]"], ["proof (prove)\nusing this:\n  ?t \\<in> T \\<Longrightarrow>\n  (\\<lambda>t. \\<phi> t s)\n  \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {0--?t}) S 0 s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>(\\<Union>(x,\n                    y)\\<in>{(x, t).\n                            t \\<in> T \\<and>\n                            x \\<in> Sols (\\<lambda>t. f)\n                                     (\\<lambda>s. {0--t}) S 0 s}.\n                    {0--y})\n                \\<subseteq> T;\n        x \\<in> T\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (\\<Union>(x,\n                                     y)\\<in>{(x, t).\n       t \\<in> T \\<and>\n       x \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {0--t}) S 0 s}.\n                                     {0--y})", "by blast"], ["", "lemma has_derivative_on_open1: \n  assumes  \"t > 0\" \"t \\<in> T\" \"s \\<in> S\"\n  obtains B where \"t \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "obtain r::real where rHyp: \"r > 0\" \"ball t r \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; ball t r \\<subseteq> T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using open_contains_ball_eq open_domain(1) \\<open>t \\<in> T\\<close>"], ["proof (prove)\nusing this:\n  open ?S \\<Longrightarrow>\n  (?x \\<in> ?S) = (\\<exists>e>0. ball ?x e \\<subseteq> ?S)\n  open T\n  t \\<in> T\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; ball t r \\<subseteq> T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < r\n  ball t r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  0 < r\n  ball t r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"t + r/2 > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < t + r / 2", "using \\<open>r > 0\\<close> \\<open>t > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n  0 < t\n\ngoal (1 subgoal):\n 1. 0 < t + r / 2", "by auto"], ["proof (state)\nthis:\n  0 < t + r / 2\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  0 < t + r / 2\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"{0--t} \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0--t} \\<subseteq> T", "using subintervalI[OF init_time \\<open>t \\<in> T\\<close>]"], ["proof (prove)\nusing this:\n  {0--t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0--t} \\<subseteq> T", "."], ["proof (state)\nthis:\n  {0--t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  0 < r\n  ball t r \\<subseteq> T\n  0 < t + r / 2\n  {0--t} \\<subseteq> T", "have subs: \"{0<--<t + r/2} \\<subseteq> T\""], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n  0 < t + r / 2\n  {0--t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0<--<t + r / 2} \\<subseteq> T", "unfolding abs_le_eq abs_le_eq real_ivl_eqs[OF \\<open>t > 0\\<close>] real_ivl_eqs[OF \\<open>t + r/2 > 0\\<close>]"], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n  0 < t + r / 2\n  {0..t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0<..<t + r / 2} \\<subseteq> T", "by clarify (case_tac \"t < x\", simp_all add: cball_def ball_def dist_norm subset_eq field_simps)"], ["proof (state)\nthis:\n  {0<--<t + r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"t + r/2 \\<in> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t + r / 2 \\<in> T", "using rHyp"], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. t + r / 2 \\<in> T", "unfolding real_ivl_eqs[OF rHyp(1)]"], ["proof (prove)\nusing this:\n  0 < r\n  {t - r<..<t + r} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. t + r / 2 \\<in> T", "by (simp add: subset_eq)"], ["proof (state)\nthis:\n  t + r / 2 \\<in> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"{0--t + r/2} \\<subseteq> T\""], ["proof (prove)\nusing this:\n  t + r / 2 \\<in> T\n\ngoal (1 subgoal):\n 1. {0--t + r / 2} \\<subseteq> T", "using subintervalI[OF init_time]"], ["proof (prove)\nusing this:\n  t + r / 2 \\<in> T\n  ?t \\<in> T \\<Longrightarrow> {0--?t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0--t + r / 2} \\<subseteq> T", "by blast"], ["proof (state)\nthis:\n  {0--t + r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--(t + r/2)})\""], ["proof (prove)\nusing this:\n  {0--t + r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--t + r / 2}", "using ivp(1)[OF _ \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  {0--t + r / 2} \\<subseteq> T\n  ?t \\<in> T \\<Longrightarrow>\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--?t}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--t + r / 2}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0--t + r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence vderiv: \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0<--<t + r/2})\""], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0--t + r / 2}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0<--<t + r / 2}", "apply(rule has_vderiv_on_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. {0<--<t + r / 2} \\<subseteq> {0--t + r / 2}", "unfolding real_ivl_eqs[OF \\<open>t + r/2 > 0\\<close>]"], ["proof (prove)\ngoal (1 subgoal):\n 1. {0<..<t + r / 2} \\<subseteq> {0..t + r / 2}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"t \\<in> {0<--<t + r/2}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> {0<--<t + r / 2}", "unfolding real_ivl_eqs[OF \\<open>t + r/2 > 0\\<close>]"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> {0<..<t + r / 2}", "using rHyp \\<open>t > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n  0 < t\n\ngoal (1 subgoal):\n 1. t \\<in> {0<..<t + r / 2}", "by simp"], ["proof (state)\nthis:\n  t \\<in> {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  t \\<in> {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) (at t within {0<--<t + r/2})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within {0<--<t + r / 2}", "using vderiv calculation"], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0<--<t + r / 2}\n  t \\<in> {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within {0<--<t + r / 2}", "unfolding has_vderiv_on_def has_vector_derivative_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{0<--<t + r / 2}.\n     D (\\<lambda>t.\n           \\<phi> t s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n      at x within {0<--<t + r / 2}\n  t \\<in> {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within {0<--<t + r / 2}", "by blast"], ["proof (state)\nthis:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"open {0<--<t + r/2}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open {0<--<t + r / 2}", "unfolding real_ivl_eqs[OF \\<open>t + r/2 > 0\\<close>]"], ["proof (prove)\ngoal (1 subgoal):\n 1. open {0<..<t + r / 2}", "by simp"], ["proof (state)\nthis:\n  open {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  t \\<in> {0<--<t + r / 2}\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t + r / 2}\n  open {0<--<t + r / 2}", "show ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> {0<--<t + r / 2}\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t + r / 2}\n  open {0<--<t + r / 2}\n\ngoal (1 subgoal):\n 1. thesis", "using subs that"], ["proof (prove)\nusing this:\n  t \\<in> {0<--<t + r / 2}\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t + r / 2}\n  open {0<--<t + r / 2}\n  {0<--<t + r / 2} \\<subseteq> T\n  \\<lbrakk>t \\<in> ?B; open ?B; ?B \\<subseteq> T;\n   D (\\<lambda>\\<tau>.\n         \\<phi> \\<tau>\n          s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n    at t within ?B\\<rbrakk>\n  \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. thesis", "by blast"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma has_derivative_on_open2: \n  assumes \"t < 0\" \"t \\<in> T\" \"s \\<in> S\"\n  obtains B where \"t \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "obtain r::real where rHyp: \"r > 0\" \"ball t r \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; ball t r \\<subseteq> T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using open_contains_ball_eq open_domain(1) \\<open>t \\<in> T\\<close>"], ["proof (prove)\nusing this:\n  open ?S \\<Longrightarrow>\n  (?x \\<in> ?S) = (\\<exists>e>0. ball ?x e \\<subseteq> ?S)\n  open T\n  t \\<in> T\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; ball t r \\<subseteq> T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < r\n  ball t r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  0 < r\n  ball t r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"t - r/2 < 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t - r / 2 < 0", "using \\<open>r > 0\\<close> \\<open>t < 0\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n  t < 0\n\ngoal (1 subgoal):\n 1. t - r / 2 < 0", "by auto"], ["proof (state)\nthis:\n  t - r / 2 < 0\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  t - r / 2 < 0\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"{0--t} \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0--t} \\<subseteq> T", "using subintervalI[OF init_time \\<open>t \\<in> T\\<close>]"], ["proof (prove)\nusing this:\n  {0--t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0--t} \\<subseteq> T", "."], ["proof (state)\nthis:\n  {0--t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  0 < r\n  ball t r \\<subseteq> T\n  t - r / 2 < 0\n  {0--t} \\<subseteq> T", "have subs: \"{0<--<t - r/2} \\<subseteq> T\""], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n  t - r / 2 < 0\n  {0--t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0<--<t - r / 2} \\<subseteq> T", "unfolding open_segment_eq_real_ivl closed_segment_eq_real_ivl\n      real_ivl_eqs[OF rHyp(1)]"], ["proof (prove)\nusing this:\n  0 < r\n  (if t - r \\<le> t + r then {t - r<..<t + r} else {t + r<..<t - r})\n  \\<subseteq> T\n  t - r / 2 < 0\n  (if 0 \\<le> t then {0..t} else {t..0}) \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (if 0 \\<le> t - r / 2 then {0<..<t - r / 2} else {t - r / 2<..<0})\n    \\<subseteq> T", "by(auto simp: subset_eq)"], ["proof (state)\nthis:\n  {0<--<t - r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"t - r/2 \\<in> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t - r / 2 \\<in> T", "using rHyp"], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. t - r / 2 \\<in> T", "unfolding real_ivl_eqs"], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. t - r / 2 \\<in> T", "by (simp add: subset_eq)"], ["proof (state)\nthis:\n  t - r / 2 \\<in> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"{0--t - r/2} \\<subseteq> T\""], ["proof (prove)\nusing this:\n  t - r / 2 \\<in> T\n\ngoal (1 subgoal):\n 1. {0--t - r / 2} \\<subseteq> T", "using subintervalI[OF init_time]"], ["proof (prove)\nusing this:\n  t - r / 2 \\<in> T\n  ?t \\<in> T \\<Longrightarrow> {0--?t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0--t - r / 2} \\<subseteq> T", "by blast"], ["proof (state)\nthis:\n  {0--t - r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--(t - r/2)})\""], ["proof (prove)\nusing this:\n  {0--t - r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--t - r / 2}", "using ivp(1)[OF _ \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  {0--t - r / 2} \\<subseteq> T\n  ?t \\<in> T \\<Longrightarrow>\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--?t}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--t - r / 2}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0--t - r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence vderiv: \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0<--<t - r/2})\""], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0--t - r / 2}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0<--<t - r / 2}", "apply(rule has_vderiv_on_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. {0<--<t - r / 2} \\<subseteq> {0--t - r / 2}", "unfolding open_segment_eq_real_ivl closed_segment_eq_real_ivl"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if 0 \\<le> t - r / 2 then {0<..<t - r / 2} else {t - r / 2<..<0})\n    \\<subseteq> (if 0 \\<le> t - r / 2 then {0..t - r / 2}\n                 else {t - r / 2..0})", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"t \\<in> {0<--<t - r/2}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> {0<--<t - r / 2}", "unfolding open_segment_eq_real_ivl"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> (if 0 \\<le> t - r / 2 then {0<..<t - r / 2}\n             else {t - r / 2<..<0})", "using rHyp \\<open>t < 0\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n  ball t r \\<subseteq> T\n  t < 0\n\ngoal (1 subgoal):\n 1. t \\<in> (if 0 \\<le> t - r / 2 then {0<..<t - r / 2}\n             else {t - r / 2<..<0})", "by simp"], ["proof (state)\nthis:\n  t \\<in> {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  t \\<in> {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) (at t within {0<--<t - r/2})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within {0<--<t - r / 2}", "using vderiv calculation"], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0<--<t - r / 2}\n  t \\<in> {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within {0<--<t - r / 2}", "unfolding has_vderiv_on_def has_vector_derivative_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{0<--<t - r / 2}.\n     D (\\<lambda>t.\n           \\<phi> t s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n      at x within {0<--<t - r / 2}\n  t \\<in> {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within {0<--<t - r / 2}", "by blast"], ["proof (state)\nthis:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"open {0<--<t - r/2}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open {0<--<t - r / 2}", "unfolding open_segment_eq_real_ivl"], ["proof (prove)\ngoal (1 subgoal):\n 1. open (if 0 \\<le> t - r / 2 then {0<..<t - r / 2} else {t - r / 2<..<0})", "by simp"], ["proof (state)\nthis:\n  open {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  t \\<in> {0<--<t - r / 2}\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t - r / 2}\n  open {0<--<t - r / 2}", "show ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> {0<--<t - r / 2}\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t - r / 2}\n  open {0<--<t - r / 2}\n\ngoal (1 subgoal):\n 1. thesis", "using subs that"], ["proof (prove)\nusing this:\n  t \\<in> {0<--<t - r / 2}\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within {0<--<t - r / 2}\n  open {0<--<t - r / 2}\n  {0<--<t - r / 2} \\<subseteq> T\n  \\<lbrakk>t \\<in> ?B; open ?B; ?B \\<subseteq> T;\n   D (\\<lambda>\\<tau>.\n         \\<phi> \\<tau>\n          s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n    at t within ?B\\<rbrakk>\n  \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. thesis", "by blast"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma has_derivative_on_open3: \n  assumes \"s \\<in> S\"\n  obtains B where \"0 \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s)) at 0 within B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "obtain r::real where rHyp: \"r > 0\" \"ball 0 r \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; ball 0 r \\<subseteq> T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using open_contains_ball_eq open_domain(1) init_time"], ["proof (prove)\nusing this:\n  open ?S \\<Longrightarrow>\n  (?x \\<in> ?S) = (\\<exists>e>0. ball ?x e \\<subseteq> ?S)\n  open T\n  0 \\<in> T\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; ball 0 r \\<subseteq> T\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < r\n  ball 0 r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"r/2 \\<in> T\" \"-r/2 \\<in> T\" \"r/2 > 0\""], ["proof (prove)\nusing this:\n  0 < r\n  ball 0 r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. r / 2 \\<in> T &&& - r / 2 \\<in> T &&& 0 < r / 2", "unfolding real_ivl_eqs"], ["proof (prove)\nusing this:\n  0 < r\n  ball 0 r \\<subseteq> T\n\ngoal (1 subgoal):\n 1. r / 2 \\<in> T &&& - r / 2 \\<in> T &&& 0 < r / 2", "by auto"], ["proof (state)\nthis:\n  r / 2 \\<in> T\n  - r / 2 \\<in> T\n  0 < r / 2\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence subs: \"{0--r/2} \\<subseteq> T\" \"{0--(-r/2)} \\<subseteq> T\""], ["proof (prove)\nusing this:\n  r / 2 \\<in> T\n  - r / 2 \\<in> T\n  0 < r / 2\n\ngoal (1 subgoal):\n 1. {0--r / 2} \\<subseteq> T &&& {0--- r / 2} \\<subseteq> T", "using subintervalI[OF init_time]"], ["proof (prove)\nusing this:\n  r / 2 \\<in> T\n  - r / 2 \\<in> T\n  0 < r / 2\n  ?t \\<in> T \\<Longrightarrow> {0--?t} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. {0--r / 2} \\<subseteq> T &&& {0--- r / 2} \\<subseteq> T", "by auto"], ["proof (state)\nthis:\n  {0--r / 2} \\<subseteq> T\n  {0--- r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--r/2})\"\n    \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--(-r/2)})\""], ["proof (prove)\nusing this:\n  {0--r / 2} \\<subseteq> T\n  {0--- r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--r / 2} &&&\n     D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--- r / 2}", "using ivp(1)[OF _ \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  {0--r / 2} \\<subseteq> T\n  {0--- r / 2} \\<subseteq> T\n  ?t \\<in> T \\<Longrightarrow>\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--?t}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--r / 2} &&&\n     D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--- r / 2}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--r / 2}\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--- r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--r / 2}\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--- r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"{0--r/2} = {0--r/2} \\<union> closure {0--r/2} \\<inter> closure {0--(-r/2)}\"\n    \"{0--(-r/2)} = {0--(-r/2)} \\<union> closure {0--r/2} \\<inter> closure {0--(-r/2)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0--r / 2} =\n    {0--r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2} &&&\n    {0--- r / 2} =\n    {0--- r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}", "unfolding closed_segment_eq_real_ivl \\<open>r/2 > 0\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) =\n    (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<union>\n    closure (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<inter>\n    closure (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}) &&&\n    (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}) =\n    (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}) \\<union>\n    closure (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<inter>\n    closure (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0})", "by auto"], ["proof (state)\nthis:\n  {0--r / 2} =\n  {0--r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}\n  {0--- r / 2} =\n  {0--- r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--r / 2}\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--- r / 2}\n  {0--r / 2} =\n  {0--r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}\n  {0--- r / 2} =\n  {0--- r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}", "have vderivs:\n    \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--r/2} \\<union> closure {0--r/2} \\<inter> closure {0--(-r/2)})\"\n    \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--(-r/2)} \\<union> closure {0--r/2} \\<inter> closure {0--(-r/2)})\""], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--r / 2}\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {0--- r / 2}\n  {0--r / 2} =\n  {0--r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}\n  {0--- r / 2} =\n  {0--- r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--r / 2} \\<union>\n        closure {0--r / 2} \\<inter> closure {0--- r / 2} &&&\n     D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {0--- r / 2} \\<union>\n        closure {0--r / 2} \\<inter> closure {0--- r / 2}", "unfolding closed_segment_eq_real_ivl \\<open>r/2 > 0\\<close>"], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}\n  (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) =\n  (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<union>\n  closure (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<inter>\n  closure (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0})\n  (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}) =\n  (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}) \\<union>\n  closure (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<inter>\n  closure (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0})\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<union>\n        closure (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<inter>\n        closure (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}) &&&\n     D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0}) \\<union>\n        closure (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<inter>\n        closure (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0})", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0--r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0--- r / 2} \\<union> closure {0--r / 2} \\<inter> closure {0--- r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have obs: \"0 \\<in> {-r/2<--<r/2}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<in> {- r / 2<--<r / 2}", "unfolding open_segment_eq_real_ivl"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<in> (if - r / 2 \\<le> r / 2 then {- r / 2<..<r / 2}\n             else {r / 2<..<- r / 2})", "using \\<open>r/2 > 0\\<close>"], ["proof (prove)\nusing this:\n  0 < r / 2\n\ngoal (1 subgoal):\n 1. 0 \\<in> (if - r / 2 \\<le> r / 2 then {- r / 2<..<r / 2}\n             else {r / 2<..<- r / 2})", "by auto"], ["proof (state)\nthis:\n  0 \\<in> {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have union: \"{-r/2--r/2} = {0--r/2} \\<union> {0--(-r/2)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {- r / 2--r / 2} = {0--r / 2} \\<union> {0--- r / 2}", "unfolding closed_segment_eq_real_ivl"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if - r / 2 \\<le> r / 2 then {- r / 2..r / 2} else {r / 2..- r / 2}) =\n    (if 0 \\<le> r / 2 then {0..r / 2} else {r / 2..0}) \\<union>\n    (if 0 \\<le> - r / 2 then {0..- r / 2} else {- r / 2..0})", "by auto"], ["proof (state)\nthis:\n  {- r / 2--r / 2} = {0--r / 2} \\<union> {0--- r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {-r/2--r/2})\""], ["proof (prove)\nusing this:\n  {- r / 2--r / 2} = {0--r / 2} \\<union> {0--- r / 2}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {- r / 2--r / 2}", "using has_vderiv_on_union[OF vderivs]"], ["proof (prove)\nusing this:\n  {- r / 2--r / 2} = {0--r / 2} \\<union> {0--- r / 2}\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {0--r / 2} \\<union> {0--- r / 2}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {- r / 2--r / 2}", "by simp"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {- r / 2--r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"(D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on {-r/2<--<r/2})\""], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {- r / 2--r / 2}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {- r / 2<--<r / 2}", "using has_vderiv_on_subset[OF _ segment_open_subset_closed[of \"-r/2\" \"r/2\"]]"], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {- r / 2--r / 2}\n   D ?f = ?f' on {- r / 2--r / 2} \\<Longrightarrow>\n   D ?f = ?f' on {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n     on {- r / 2<--<r / 2}", "by auto"], ["proof (state)\nthis:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s)) (at 0 within {-r/2<--<r/2})\""], ["proof (prove)\nusing this:\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s))\n   on {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n     at 0 within {- r / 2<--<r / 2}", "unfolding has_vderiv_on_def has_vector_derivative_def"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{- r / 2<--<r / 2}.\n     D (\\<lambda>t.\n           \\<phi> t s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n      at x within {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n     at 0 within {- r / 2<--<r / 2}", "using obs"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{- r / 2<--<r / 2}.\n     D (\\<lambda>t.\n           \\<phi> t s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n      at x within {- r / 2<--<r / 2}\n  0 \\<in> {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. D (\\<lambda>\\<tau>.\n          \\<phi> \\<tau>\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n     at 0 within {- r / 2<--<r / 2}", "by blast"], ["proof (state)\nthis:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n   at 0 within {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n   at 0 within {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"open {-r/2<--<r/2}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open {- r / 2<--<r / 2}", "unfolding open_segment_eq_real_ivl"], ["proof (prove)\ngoal (1 subgoal):\n 1. open\n     (if - r / 2 \\<le> r / 2 then {- r / 2<..<r / 2}\n      else {r / 2<..<- r / 2})", "by simp"], ["proof (state)\nthis:\n  open {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  open {- r / 2<--<r / 2}\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"{-r/2<--<r/2} \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {- r / 2<--<r / 2} \\<subseteq> T", "using subs union segment_open_subset_closed"], ["proof (prove)\nusing this:\n  {0--r / 2} \\<subseteq> T\n  {0--- r / 2} \\<subseteq> T\n  {- r / 2--r / 2} = {0--r / 2} \\<union> {0--- r / 2}\n  {?a<--<?b} \\<subseteq> {?a--?b}\n\ngoal (1 subgoal):\n 1. {- r / 2<--<r / 2} \\<subseteq> T", "by blast"], ["proof (state)\nthis:\n  {- r / 2<--<r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n          at 0 within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n   at 0 within {- r / 2<--<r / 2}\n  open {- r / 2<--<r / 2}\n  {- r / 2<--<r / 2} \\<subseteq> T", "show ?thesis"], ["proof (prove)\nusing this:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n   at 0 within {- r / 2<--<r / 2}\n  open {- r / 2<--<r / 2}\n  {- r / 2<--<r / 2} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. thesis", "using obs that"], ["proof (prove)\nusing this:\n  D (\\<lambda>\\<tau>.\n        \\<phi> \\<tau>\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n   at 0 within {- r / 2<--<r / 2}\n  open {- r / 2<--<r / 2}\n  {- r / 2<--<r / 2} \\<subseteq> T\n  0 \\<in> {- r / 2<--<r / 2}\n  \\<lbrakk>0 \\<in> ?B; open ?B; ?B \\<subseteq> T;\n   D (\\<lambda>\\<tau>.\n         \\<phi> \\<tau>\n          s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n    at 0 within ?B\\<rbrakk>\n  \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. thesis", "by blast"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma has_derivative_on_open: \n  assumes \"t \\<in> T\" \"s \\<in> S\"\n  obtains B where \"t \\<in> B\" and \"open B\" and \"B \\<subseteq> T\"\n    and \"D (\\<lambda>\\<tau>. \\<phi> \\<tau> s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "apply(subgoal_tac \"t < 0 \\<or> t = 0 \\<or> t > 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>B.\n                \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n                 D (\\<lambda>\\<tau>.\n                       \\<phi> \\<tau>\n                        s) \\<mapsto> (\\<lambda>\\<tau>.\n   \\<tau> *\\<^sub>R f (\\<phi> t s))\n                  at t within B\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     t < 0 \\<or> t = 0 \\<or> 0 < t\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    t < 0 \\<or> t = 0 \\<or> 0 < t", "using has_derivative_on_open1[OF _ assms] has_derivative_on_open2[OF _ assms]\n    has_derivative_on_open3[OF \\<open>s \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < t;\n   \\<And>B.\n      \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n       D (\\<lambda>\\<tau>.\n             \\<phi> \\<tau>\n              s) \\<mapsto> (\\<lambda>\\<tau>.\n                               \\<tau> *\\<^sub>R f (\\<phi> t s))\n        at t within B\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n  \\<lbrakk>t < 0;\n   \\<And>B.\n      \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n       D (\\<lambda>\\<tau>.\n             \\<phi> \\<tau>\n              s) \\<mapsto> (\\<lambda>\\<tau>.\n                               \\<tau> *\\<^sub>R f (\\<phi> t s))\n        at t within B\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n  (\\<And>B.\n      \\<lbrakk>0 \\<in> B; open B; B \\<subseteq> T;\n       D (\\<lambda>\\<tau>.\n             \\<phi> \\<tau>\n              s) \\<mapsto> (\\<lambda>\\<tau>.\n                               \\<tau> *\\<^sub>R f (\\<phi> 0 s))\n        at 0 within B\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>B.\n                \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n                 D (\\<lambda>\\<tau>.\n                       \\<phi> \\<tau>\n                        s) \\<mapsto> (\\<lambda>\\<tau>.\n   \\<tau> *\\<^sub>R f (\\<phi> t s))\n                  at t within B\\<rbrakk>\n                \\<Longrightarrow> thesis;\n     t < 0 \\<or> t = 0 \\<or> 0 < t\\<rbrakk>\n    \\<Longrightarrow> thesis\n 2. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>\\<tau>.\n               \\<phi> \\<tau>\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    t < 0 \\<or> t = 0 \\<or> 0 < t", "by blast force"], ["", "lemma in_domain:\n  assumes \"s \\<in> S\"\n  shows \"(\\<lambda>t. \\<phi> t s) \\<in> T \\<rightarrow> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. \\<phi> t s) \\<in> T \\<rightarrow> S", "using ivp(3)[OF _ assms]"], ["proof (prove)\nusing this:\n  ?t \\<in> T \\<Longrightarrow>\n  (\\<lambda>t. \\<phi> t s) \\<in> {0--?t} \\<rightarrow> S\n\ngoal (1 subgoal):\n 1. (\\<lambda>t. \\<phi> t s) \\<in> T \\<rightarrow> S", "by blast"], ["", "lemma has_vderiv_on_domain:\n  assumes \"s \\<in> S\"\n  shows \"D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on T\""], ["proof (prove)\ngoal (1 subgoal):\n 1.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on T", "proof(unfold has_vderiv_on_def has_vector_derivative_def, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> T \\<Longrightarrow>\n       D (\\<lambda>t.\n             \\<phi> t\n              s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n        at x within T", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> T \\<Longrightarrow>\n       D (\\<lambda>t.\n             \\<phi> t\n              s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n        at x within T", "assume \"t \\<in> T\""], ["proof (state)\nthis:\n  t \\<in> T\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> T \\<Longrightarrow>\n       D (\\<lambda>t.\n             \\<phi> t\n              s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n        at x within T", "then"], ["proof (chain)\npicking this:\n  t \\<in> T", "obtain B where \"t \\<in> B\" and \"open B\" and \"B \\<subseteq> T\" \n    and Dhyp: \"D (\\<lambda>t. \\<phi> t s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within B\""], ["proof (prove)\nusing this:\n  t \\<in> T\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>t.\n               \\<phi> t\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms has_derivative_on_open[OF \\<open>t \\<in> T\\<close>]"], ["proof (prove)\nusing this:\n  t \\<in> T\n  s \\<in> S\n  \\<lbrakk>?s \\<in> S;\n   \\<And>B.\n      \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n       D (\\<lambda>\\<tau>.\n             \\<phi> \\<tau>\n              ?s) \\<mapsto> (\\<lambda>\\<tau>.\n                                \\<tau> *\\<^sub>R f (\\<phi> t ?s))\n        at t within B\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>B.\n        \\<lbrakk>t \\<in> B; open B; B \\<subseteq> T;\n         D (\\<lambda>t.\n               \\<phi> t\n                s) \\<mapsto> (\\<lambda>\\<tau>.\n                                 \\<tau> *\\<^sub>R f (\\<phi> t s))\n          at t within B\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  t \\<in> B\n  open B\n  B \\<subseteq> T\n  D (\\<lambda>t.\n        \\<phi> t\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> T \\<Longrightarrow>\n       D (\\<lambda>t.\n             \\<phi> t\n              s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n        at x within T", "hence \"t \\<in> interior B\""], ["proof (prove)\nusing this:\n  t \\<in> B\n  open B\n  B \\<subseteq> T\n  D (\\<lambda>t.\n        \\<phi> t\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within B\n\ngoal (1 subgoal):\n 1. t \\<in> interior B", "using interior_eq"], ["proof (prove)\nusing this:\n  t \\<in> B\n  open B\n  B \\<subseteq> T\n  D (\\<lambda>t.\n        \\<phi> t\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within B\n  (interior ?S = ?S) = open ?S\n\ngoal (1 subgoal):\n 1. t \\<in> interior B", "by auto"], ["proof (state)\nthis:\n  t \\<in> interior B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> T \\<Longrightarrow>\n       D (\\<lambda>t.\n             \\<phi> t\n              s) \\<mapsto> (\\<lambda>xa. xa *\\<^sub>R f (\\<phi> x s))\n        at x within T", "thus \"D (\\<lambda>t. \\<phi> t s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s)) at t within T\""], ["proof (prove)\nusing this:\n  t \\<in> interior B\n\ngoal (1 subgoal):\n 1. D (\\<lambda>t.\n          \\<phi> t\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within T", "using has_derivative_at_within_mono[OF _ \\<open>B \\<subseteq> T\\<close> Dhyp]"], ["proof (prove)\nusing this:\n  t \\<in> interior B\n  t \\<in> interior B \\<Longrightarrow>\n  D (\\<lambda>t.\n        \\<phi> t\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within T\n\ngoal (1 subgoal):\n 1. D (\\<lambda>t.\n          \\<phi> t\n           s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n     at t within T", "by blast"], ["proof (state)\nthis:\n  D (\\<lambda>t.\n        \\<phi> t\n         s) \\<mapsto> (\\<lambda>\\<tau>. \\<tau> *\\<^sub>R f (\\<phi> t s))\n   at t within T\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma in_ivp_sols: \n  assumes \"s \\<in> S\" and \"0 \\<in> U s\" and \"U s \\<subseteq> T\"\n  shows \"(\\<lambda>t. \\<phi> t s) \\<in> Sols (\\<lambda>t. f) U S 0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. \\<phi> t s) \\<in> Sols (\\<lambda>t. f) U S 0 s", "apply(rule in_ivp_sols_subset[OF _ _ ivp_solsI, of _ _ _ \"\\<lambda>s. T\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. 0 \\<in> U s\n 2. U s \\<subseteq> T\n 3.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on T\n 4. \\<phi> 0 s = s\n 5. (\\<lambda>t. \\<phi> t s) \\<in> T \\<rightarrow> S\n 6. 0 \\<in> T", "using  ivp(2)[OF \\<open>s \\<in> S\\<close>] has_vderiv_on_domain[OF \\<open>s \\<in> S\\<close>] \n    in_domain[OF \\<open>s \\<in> S\\<close>] assms"], ["proof (prove)\nusing this:\n  \\<phi> 0 s = s\n   D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on T\n  (\\<lambda>t. \\<phi> t s) \\<in> T \\<rightarrow> S\n  s \\<in> S\n  0 \\<in> U s\n  U s \\<subseteq> T\n\ngoal (6 subgoals):\n 1. 0 \\<in> U s\n 2. U s \\<subseteq> T\n 3.  D (\\<lambda>t. \\<phi> t s) = (\\<lambda>t. f (\\<phi> t s)) on T\n 4. \\<phi> 0 s = s\n 5. (\\<lambda>t. \\<phi> t s) \\<in> T \\<rightarrow> S\n 6. 0 \\<in> T", "by auto"], ["", "lemma eq_solution:\n  assumes \"s \\<in> S\" and \"is_interval (U s)\" and \"U s \\<subseteq> T\" and \"t \\<in> U s\"\n    and xivp: \"X \\<in> Sols (\\<lambda>t. f) U S 0 s\"\n  shows \"X t = \\<phi> t s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X t = \\<phi> t s", "apply(rule ivp_unique_solution[OF assms], rule in_ivp_sols)"], ["proof (prove)\ngoal (3 subgoals):\n 1. s \\<in> S\n 2. 0 \\<in> U s\n 3. U s \\<subseteq> T", "by (simp_all add: ivp_solsD(4)[OF xivp] assms)"], ["", "lemma ivp_sols_collapse: \n  assumes \"T = UNIV\" and \"s \\<in> S\"\n  shows \"Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 s = {(\\<lambda>t. \\<phi> t s)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 s = {\\<lambda>t. \\<phi> t s}", "apply (safe, simp_all add: fun_eq_iff, clarsimp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       x \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 s \\<Longrightarrow>\n       x xa = \\<phi> xa s\n 2. (\\<lambda>t. \\<phi> t s)\n    \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 s", "apply(rule eq_solution[of _ \"\\<lambda>s. T\"]; simp add: assms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. \\<phi> t s)\n    \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 s", "by (rule in_ivp_sols; simp add: assms)"], ["", "lemma additive_in_ivp_sols:\n  assumes \"s \\<in> S\" and \"\\<P> (\\<lambda>\\<tau>. \\<tau> + t) T \\<subseteq> T\"\n  shows \"(\\<lambda>\\<tau>. \\<phi> (\\<tau> + t) s) \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 (\\<phi> (0 + t) s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>\\<tau>. \\<phi> (\\<tau> + t) s)\n    \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. T) S 0 (\\<phi> (0 + t) s)", "apply(rule ivp_solsI[OF vderiv_on_composeI])"], ["proof (prove)\ngoal (6 subgoals):\n 1.  D (\\<lambda>a. \\<phi> a s) = ?f'1 on \\<P> (\\<lambda>ta. ta + t) T\n 2.  D (\\<lambda>ta. ta + t) = ?g'1 on T\n 3. (\\<lambda>\\<tau>. f (\\<phi> (\\<tau> + t) s)) =\n    (\\<lambda>\\<tau>. ?g'1 \\<tau> *\\<^sub>R ?f'1 (\\<tau> + t))\n 4. \\<phi> (0 + t) s = \\<phi> (0 + t) s\n 5. (\\<lambda>\\<tau>. \\<phi> (\\<tau> + t) s) \\<in> T \\<rightarrow> S\n 6. 0 \\<in> T", "apply(rule has_vderiv_on_subset[OF has_vderiv_on_domain])"], ["proof (prove)\ngoal (7 subgoals):\n 1. s \\<in> S\n 2. \\<P> (\\<lambda>ta. ta + t) T \\<subseteq> T\n 3.  D (\\<lambda>ta. ta + t) = ?g'1 on T\n 4. (\\<lambda>\\<tau>. f (\\<phi> (\\<tau> + t) s)) =\n    (\\<lambda>\\<tau>. ?g'1 \\<tau> *\\<^sub>R f (\\<phi> (\\<tau> + t) s))\n 5. \\<phi> (0 + t) s = \\<phi> (0 + t) s\n 6. (\\<lambda>\\<tau>. \\<phi> (\\<tau> + t) s) \\<in> T \\<rightarrow> S\n 7. 0 \\<in> T", "using in_domain assms init_time"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow>\n  (\\<lambda>t. \\<phi> t ?s) \\<in> T \\<rightarrow> S\n  s \\<in> S\n  \\<P> (\\<lambda>\\<tau>. \\<tau> + t) T \\<subseteq> T\n  0 \\<in> T\n\ngoal (7 subgoals):\n 1. s \\<in> S\n 2. \\<P> (\\<lambda>ta. ta + t) T \\<subseteq> T\n 3.  D (\\<lambda>ta. ta + t) = ?g'1 on T\n 4. (\\<lambda>\\<tau>. f (\\<phi> (\\<tau> + t) s)) =\n    (\\<lambda>\\<tau>. ?g'1 \\<tau> *\\<^sub>R f (\\<phi> (\\<tau> + t) s))\n 5. \\<phi> (0 + t) s = \\<phi> (0 + t) s\n 6. (\\<lambda>\\<tau>. \\<phi> (\\<tau> + t) s) \\<in> T \\<rightarrow> S\n 7. 0 \\<in> T", "by (auto intro!: poly_derivatives)"], ["", "lemma is_monoid_action:\n  assumes \"s \\<in> S\" and \"T = UNIV\"\n  shows \"\\<phi> 0 s = s\" and \"\\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi> 0 s = s &&&\n    \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "proof-"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<phi> 0 s = s\n 2. \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "show \"\\<phi> 0 s = s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi> 0 s = s", "using ivp assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>?t \\<in> T; ?s \\<in> S\\<rbrakk>\n  \\<Longrightarrow>  D (\\<lambda>t.\n                           \\<phi> t ?s) = (\\<lambda>t. f (\\<phi> t ?s))\n                     on {0--?t}\n  ?s \\<in> S \\<Longrightarrow> \\<phi> 0 ?s = ?s\n  \\<lbrakk>?t \\<in> T; ?s \\<in> S\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>t. \\<phi> t ?s) \\<in> {0--?t} \\<rightarrow> S\n  s \\<in> S\n  T = UNIV\n\ngoal (1 subgoal):\n 1. \\<phi> 0 s = s", "by simp"], ["proof (state)\nthis:\n  \\<phi> 0 s = s\n\ngoal (1 subgoal):\n 1. \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "have \"\\<phi> (0 + t\\<^sub>2) s = \\<phi> t\\<^sub>2 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi> (0 + t\\<^sub>2) s = \\<phi> t\\<^sub>2 s", "by simp"], ["proof (state)\nthis:\n  \\<phi> (0 + t\\<^sub>2) s = \\<phi> t\\<^sub>2 s\n\ngoal (1 subgoal):\n 1. \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "also"], ["proof (state)\nthis:\n  \\<phi> (0 + t\\<^sub>2) s = \\<phi> t\\<^sub>2 s\n\ngoal (1 subgoal):\n 1. \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "have \"\\<phi> (0 + t\\<^sub>2) s \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi> (0 + t\\<^sub>2) s \\<in> S", "using in_domain assms"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow>\n  (\\<lambda>t. \\<phi> t ?s) \\<in> T \\<rightarrow> S\n  s \\<in> S\n  T = UNIV\n\ngoal (1 subgoal):\n 1. \\<phi> (0 + t\\<^sub>2) s \\<in> S", "by auto"], ["proof (state)\nthis:\n  \\<phi> (0 + t\\<^sub>2) s \\<in> S\n\ngoal (1 subgoal):\n 1. \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "ultimately"], ["proof (chain)\npicking this:\n  \\<phi> (0 + t\\<^sub>2) s = \\<phi> t\\<^sub>2 s\n  \\<phi> (0 + t\\<^sub>2) s \\<in> S", "show \"\\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)\""], ["proof (prove)\nusing this:\n  \\<phi> (0 + t\\<^sub>2) s = \\<phi> t\\<^sub>2 s\n  \\<phi> (0 + t\\<^sub>2) s \\<in> S\n\ngoal (1 subgoal):\n 1. \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "using eq_solution[OF _ _ _ _ additive_in_ivp_sols] assms"], ["proof (prove)\nusing this:\n  \\<phi> (0 + t\\<^sub>2) s = \\<phi> t\\<^sub>2 s\n  \\<phi> (0 + t\\<^sub>2) s \\<in> S\n  \\<lbrakk>\\<phi> (0 + ?t1) ?s1 \\<in> S; is_interval T; T \\<subseteq> T;\n   ?t \\<in> T; ?s1 \\<in> S;\n   \\<P> (\\<lambda>\\<tau>. \\<tau> + ?t1) T \\<subseteq> T\\<rbrakk>\n  \\<Longrightarrow> \\<phi> (?t + ?t1) ?s1 = \\<phi> ?t (\\<phi> (0 + ?t1) ?s1)\n  s \\<in> S\n  T = UNIV\n\ngoal (1 subgoal):\n 1. \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)", "by auto"], ["proof (state)\nthis:\n  \\<phi> (t\\<^sub>1 + t\\<^sub>2) s = \\<phi> t\\<^sub>1 (\\<phi> t\\<^sub>2 s)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma g_orbital_collapses: \n  assumes \"s \\<in> S\" and \"is_interval (U s)\" and \"U s \\<subseteq> T\" and \"0 \\<in> U s\"\n  shows \"g_orbital (\\<lambda>t. f) G U S 0 s = {\\<phi> t s| t. t \\<in> U s \\<and> (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbital (\\<lambda>t. f) G U S 0 s =\n    {\\<phi> t s |t.\n     t \\<in> U s \\<and>\n     (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s))}", "apply (subst g_orbital_orbit[of _ _ \"\\<lambda>t. \\<phi> t s\"], simp_all add: assms g_orbit_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. \\<phi> t s) \\<in> Sols (\\<lambda>t. f) U S 0 s", "by (rule in_ivp_sols, simp_all add: assms)"], ["", "definition orbit :: \"'a \\<Rightarrow> 'a set\" (\"\\<gamma>\\<^sup>\\<phi>\")\n  where \"\\<gamma>\\<^sup>\\<phi> s = g_orbital (\\<lambda>t. f) (\\<lambda>s. True) (\\<lambda>s. T) S 0 s\""], ["", "lemma orbit_eq: \n  assumes \"s \\<in> S\"\n  shows \"\\<gamma>\\<^sup>\\<phi> s = {\\<phi> t s| t. t \\<in> T}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<gamma>\\<^sup>\\<phi> s = {\\<phi> t s |t. t \\<in> T}", "apply(unfold orbit_def, subst g_orbital_collapses)"], ["proof (prove)\ngoal (5 subgoals):\n 1. s \\<in> S\n 2. is_interval T\n 3. T \\<subseteq> T\n 4. 0 \\<in> T\n 5. {\\<phi> t s |t. t \\<in> T \\<and> (\\<forall>\\<tau>\\<in>down T t. True)} =\n    {\\<phi> t s |t. t \\<in> T}", "by (simp_all add: assms init_time interval_time)"], ["", "lemma true_g_orbit_eq:\n  assumes \"s \\<in> S\"\n  shows \"g_orbit (\\<lambda>t. \\<phi> t s) (\\<lambda>s. True) T = \\<gamma>\\<^sup>\\<phi> s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g_orbit (\\<lambda>t. \\<phi> t s) (\\<lambda>s. True) T =\n    \\<gamma>\\<^sup>\\<phi> s", "unfolding g_orbit_eq orbit_eq[OF assms]"], ["proof (prove)\ngoal (1 subgoal):\n 1. {\\<phi> t s |t. t \\<in> T \\<and> (\\<forall>\\<tau>\\<in>down T t. True)} =\n    {\\<phi> t s |t. t \\<in> T}", "by simp"], ["", "end"], ["", "lemma line_is_local_flow: \n  \"0 \\<in> T \\<Longrightarrow> is_interval T \\<Longrightarrow> open T \\<Longrightarrow> local_flow (\\<lambda> s. c) T UNIV (\\<lambda> t s. s + t *\\<^sub>R c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<in> T; is_interval T; open T\\<rbrakk>\n    \\<Longrightarrow> local_flow (\\<lambda>s. c) T UNIV\n                       (\\<lambda>t s. s + t *\\<^sub>R c)", "apply(unfold_locales, simp_all add: local_lipschitz_def lipschitz_on_def, clarsimp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x t.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u>0.\n                            (\\<exists>ta.\n                                dist t ta \\<le> u \\<and>\n                                ta \\<in> T) \\<longrightarrow>\n                            (\\<exists>L\\<ge>0.\n                                \\<forall>xa\\<in>cball x u.\n                                   \\<forall>y\\<in>cball x u.\n0 \\<le> L * dist xa y)\n 2. \\<And>t s.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow>  D (\\<lambda>t.\n                                s + t *\\<^sub>R c) = (\\<lambda>t. c)\n                          on {0--t}", "apply(rule_tac x=1 in exI, clarsimp, rule_tac x=\"1/2\" in exI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>t s.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow>  D (\\<lambda>t.\n                                s + t *\\<^sub>R c) = (\\<lambda>t. c)\n                          on {0--t}", "apply(rule_tac f'1=\"\\<lambda> s. 0\" and g'1=\"\\<lambda> s. c\" in has_vderiv_on_add[THEN has_vderiv_on_eq_rhs])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>t s.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow>  D (\\<lambda>x. s) = (\\<lambda>s. 0::'a) on {0--t}\n 2. \\<And>t s.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T\\<rbrakk>\n       \\<Longrightarrow>  D (\\<lambda>x. x *\\<^sub>R c) = (\\<lambda>s. c)\n                          on {0--t}\n 3. \\<And>t s x.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T;\n        x \\<in> {0--t}\\<rbrakk>\n       \\<Longrightarrow> (0::'a) + c = c", "apply(rule derivative_intros, simp)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>t s x.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T;\n        x \\<in> {0--t}\\<rbrakk>\n       \\<Longrightarrow> x *\\<^sub>R (0::'a) + 1 *\\<^sub>R c = c\n 2. \\<And>t s x.\n       \\<lbrakk>0 \\<in> T; is_interval T; open T; t \\<in> T;\n        x \\<in> {0--t}\\<rbrakk>\n       \\<Longrightarrow> (0::'a) + c = c", "by simp_all"], ["", "end"]]}