{"file_name": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs/ModalKleeneAlgebra/HS_VC_MKA_rel.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs", "problem_names": ["lemma p2r_simps[simp]: \n  \"\\<lceil>P\\<rceil> \\<le> \\<lceil>Q\\<rceil> = (\\<forall>s. P s \\<longrightarrow> Q s)\"\n  \"(\\<lceil>P\\<rceil> = \\<lceil>Q\\<rceil>) = (\\<forall>s. P s = Q s)\"\n  \"(\\<lceil>P\\<rceil> ; \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<and> Q s\\<rceil>\"\n  \"(\\<lceil>P\\<rceil> \\<union> \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<or> Q s\\<rceil>\"\n  \"rel_ad \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<not> P s\\<rceil>\"\n  \"rel_aka.ads_d \\<lceil>P\\<rceil> = \\<lceil>P\\<rceil>\"", "lemma in_p2r [simp]: \"(a,b) \\<in> \\<lceil>P\\<rceil> = (P a \\<and> a = b)\"", "lemma wp_rel: \"wp R \\<lceil>P\\<rceil> = \\<lceil>\\<lambda> x. \\<forall> y. (x,y) \\<in> R \\<longrightarrow> P y\\<rceil>\"", "lemma wp_test[simp]: \"wp \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. P s \\<longrightarrow> Q s\\<rceil>\"", "lemma wp_assign [simp]: \"wp (x ::= e) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. Q (\\<chi> j. ((($) s)(x := (e s))) j)\\<rceil>\"", "lemma wp_nondet_assign[simp]: \"wp (x ::= ?) \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi> j. ((($) s)(x := k)) j)\\<rceil>\"", "lemma le_wp_choice_iff: \"\\<lceil>P\\<rceil> \\<le> wp (X \\<union> Y) \\<lceil>Q\\<rceil> \\<longleftrightarrow> \\<lceil>P\\<rceil> \\<le> wp X \\<lceil>Q\\<rceil> \\<and> \\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>Q\\<rceil>\"", "lemma change_loopI: \"LOOP X INV G = LOOP X INV I\"", "lemma wp_loopI: \n  \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp R \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (LOOP R INV I) \\<lceil>Q\\<rceil>\"", "lemma wp_loopI_break: \n  \"\\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp X \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>  \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (Y ; (LOOP X INV I)) \\<lceil>Q\\<rceil>\"", "lemma wp_g_dyn[simp]:  \n  fixes \\<phi> :: \"('a::preorder) \\<Rightarrow> 'b \\<Rightarrow> 'b\"\n  shows \"wp (EVOL \\<phi> G U) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\"", "lemma wp_g_orbital: \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>X\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>)) \\<longrightarrow> Q (X t)\\<rceil>\"", "lemma wp_g_ode_subset:\n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"wp (x\\<acute>= (\\<lambda>t. f) & G on U S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>(U s). (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\"", "lemma wp_g_ode: \"wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. T) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>T. (\\<forall>\\<tau>\\<in>down T t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\"", "lemma wp_g_ode_ivl: \"t \\<ge> 0 \\<Longrightarrow> t \\<in> T \\<Longrightarrow> wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. {0..t}) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>{0..t}. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\"", "lemma wp_orbit: \"wp ({(s,s') | s s'. s' \\<in> \\<gamma>\\<^sup>\\<phi> s}) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>T. Q (\\<phi> t s))\\<rceil>\"", "lemma wp_g_orbital_guard: \n  assumes \"H = (\\<lambda>s. G s \\<and> Q s)\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>H\\<rceil>\"", "lemma wp_g_orbital_inv:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma wp_diff_inv[simp]: \"(\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>) = diff_invariant I f U S t\\<^sub>0 G\"", "lemma diff_inv_guard_ignore:\n  assumes \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. True) on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\"\n  shows \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\"", "lemma wp_diff_inv_eq: \n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"diff_invariant I (\\<lambda>t. f) U S 0 (\\<lambda>s. True) = \n  (\\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil> = wp (x\\<acute>= (\\<lambda>t. f) & (\\<lambda>s. True) on U S @ 0) \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil>)\"", "lemma diff_inv_eq_inv_set:\n  \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. T) S 0 (\\<lambda>s. True) = (\\<forall>s. I s \\<longrightarrow> \\<gamma>\\<^sup>\\<phi> s \\<subseteq> {s. I s})\"", "lemma wp_g_odei: \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow> \n  \\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0 DINV I) \\<lceil>Q\\<rceil>\"", "lemma diff_solve_axiom1: \n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\"", "lemma diff_solve_axiom2: \n  fixes c::\"'a::{heine_borel, banach}\"\n  shows \"wp (x\\<acute>=(\\<lambda>s. c) & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow> Q (s + t *\\<^sub>R c)\\<rceil>\"", "lemma diff_solve_rule:\n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n    and \"\\<forall>s. P s \\<longrightarrow> (\\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil>\"", "lemma diff_weak_axiom1: \"Id \\<subseteq> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>G\\<rceil>\"", "lemma diff_weak_axiom2: \n  \"wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>\\<lambda> s. G s \\<longrightarrow> Q s\\<rceil>\"", "lemma diff_weak_rule: \n  assumes \"\\<lceil>G\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma wp_g_evol_IdD:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = Id\"\n    and \"\\<forall>\\<tau>\\<in>(down (U s) t). (s, x \\<tau>) \\<in> (x\\<acute>= f & G on U S @ t\\<^sub>0)\"\n  shows \"\\<forall>\\<tau>\\<in>(down (U s) t). C (x \\<tau>)\"", "lemma diff_cut_axiom:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = Id\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma diff_cut_rule:\n  assumes wp_C: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil>\"\n    and wp_Q: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma diff_inv_axiom1:\n  assumes \"G s \\<longrightarrow> I s\" and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. t \\<ge> 0}) UNIV 0 G\"\n  shows \"(s,s) \\<in> wp (x\\<acute>= f & G) \\<lceil>I\\<rceil>\"", "lemma diff_inv_axiom2:\n  assumes \"picard_lindeloef (\\<lambda>t. f) UNIV UNIV 0\"\n    and \"\\<And>s. {t::real. t \\<ge> 0} \\<subseteq> picard_lindeloef.ex_ivl (\\<lambda>t. f) UNIV UNIV 0 s\"\n    and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t::real. t \\<ge> 0}) UNIV 0 G\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>I\\<rceil> = wp \\<lceil>G\\<rceil> \\<lceil>I\\<rceil>\"", "lemma diff_inv_rule:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"diff_invariant I f U S t\\<^sub>0 G\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], "translations": [["", "lemma p2r_simps[simp]: \n  \"\\<lceil>P\\<rceil> \\<le> \\<lceil>Q\\<rceil> = (\\<forall>s. P s \\<longrightarrow> Q s)\"\n  \"(\\<lceil>P\\<rceil> = \\<lceil>Q\\<rceil>) = (\\<forall>s. P s = Q s)\"\n  \"(\\<lceil>P\\<rceil> ; \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<and> Q s\\<rceil>\"\n  \"(\\<lceil>P\\<rceil> \\<union> \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<or> Q s\\<rceil>\"\n  \"rel_ad \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<not> P s\\<rceil>\"\n  \"rel_aka.ads_d \\<lceil>P\\<rceil> = \\<lceil>P\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lceil>P\\<rceil> \\<subseteq> \\<lceil>Q\\<rceil>) =\n     (\\<forall>s. P s \\<longrightarrow> Q s) &&&\n     (\\<lceil>P\\<rceil> = \\<lceil>Q\\<rceil>) = (\\<forall>s. P s = Q s) &&&\n     \\<lceil>P\\<rceil> ; \\<lceil>Q\\<rceil> =\n     \\<lceil>\\<lambda>s. P s \\<and> Q s\\<rceil>) &&&\n    \\<lceil>P\\<rceil> \\<union> \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s. P s \\<or> Q s\\<rceil> &&&\n    rel_ad \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<not> P s\\<rceil> &&&\n    rel_aka.ads_d \\<lceil>P\\<rceil> = \\<lceil>P\\<rceil>", "unfolding p2r_def rel_ad_def rel_aka.ads_d_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (({(s, s) |s. P s} \\<subseteq> {(s, s) |s. Q s}) =\n     (\\<forall>s. P s \\<longrightarrow> Q s) &&&\n     ({(s, s) |s. P s} = {(s, s) |s. Q s}) = (\\<forall>s. P s = Q s) &&&\n     {(s, s) |s. P s} ; {(s, s) |s. Q s} = {(s, s) |s. P s \\<and> Q s}) &&&\n    {(s, s) |s. P s} \\<union> {(s, s) |s. Q s} =\n    {(s, s) |s. P s \\<or> Q s} &&&\n    {(x, x) |x. \\<nexists>y. (x, y) \\<in> {(s, s) |s. P s}} =\n    {(s, s) |s. \\<not> P s} &&&\n    {(x, x) |x.\n     \\<nexists>y.\n        (x, y)\n        \\<in> {(x, x) |x. \\<nexists>y. (x, y) \\<in> {(s, s) |s. P s}}} =\n    {(s, s) |s. P s}", "by auto"], ["", "lemma in_p2r [simp]: \"(a,b) \\<in> \\<lceil>P\\<rceil> = (P a \\<and> a = b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((a, b) \\<in> \\<lceil>P\\<rceil>) = (P a \\<and> a = b)", "by (auto simp: p2r_def)"], ["", "text \\<open> Lemmas for verification condition generation \\<close>"], ["", "lemma wp_rel: \"wp R \\<lceil>P\\<rceil> = \\<lceil>\\<lambda> x. \\<forall> y. (x,y) \\<in> R \\<longrightarrow> P y\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp R \\<lceil>P\\<rceil> =\n    \\<lceil>\\<lambda>x.\n               \\<forall>y. (x, y) \\<in> R \\<longrightarrow> P y\\<rceil>", "unfolding rel_aka.fbox_def p2r_def rel_ad_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {(x, x) |x.\n     \\<nexists>y.\n        (x, y)\n        \\<in> R ; {(x, x) |x. \\<nexists>y. (x, y) \\<in> {(s, s) |s. P s}}} =\n    {(s, s) |s. \\<forall>y. (s, y) \\<in> R \\<longrightarrow> P y}", "by auto\n\n\\<comment> \\<open> Tests \\<close>"], ["", "lemma wp_test[simp]: \"wp \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. P s \\<longrightarrow> Q s\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s. P s \\<longrightarrow> Q s\\<rceil>", "by (subst wp_rel, simp add: p2r_def)\n\n\\<comment> \\<open> Assignments \\<close>"], ["", "definition assign :: \"'b \\<Rightarrow> ('a^'b \\<Rightarrow> 'a) \\<Rightarrow> ('a^'b) rel\" (\"(2_ ::= _)\" [70, 65] 61) \n  where \"(x ::= e) = {(s, vec_upd s x (e s))| s. True}\""], ["", "lemma wp_assign [simp]: \"wp (x ::= e) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. Q (\\<chi> j. ((($) s)(x := (e s))) j)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (x ::= e) \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s. Q (\\<chi>j. ((($) s)(x := e s)) j)\\<rceil>", "unfolding wp_rel vec_upd_def assign_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>xa.\n               \\<forall>y.\n                  (xa, y)\n                  \\<in> {(s, vec_lambda ((($) s)(x := e s))) |s.\n                         True} \\<longrightarrow>\n                  Q y\\<rceil> =\n    \\<lceil>\\<lambda>s. Q (\\<chi>j. ((($) s)(x := e s)) j)\\<rceil>", "by (auto simp: fun_upd_def)\n\n\\<comment> \\<open> Nondeterministic assignments \\<close>"], ["", "definition nondet_assign :: \"'b \\<Rightarrow> ('a^'b) rel\" (\"(2_ ::= ? )\" [70] 61)\n  where \"(x ::= ?) = {(s,vec_upd s x k)|s k. True}\""], ["", "lemma wp_nondet_assign[simp]: \"wp (x ::= ?) \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi> j. ((($) s)(x := k)) j)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (x ::= ? ) \\<lceil>P\\<rceil> =\n    \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi>j. ((($) s)(x := k)) j)\\<rceil>", "unfolding wp_rel nondet_assign_def vec_upd_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>xa.\n               \\<forall>y.\n                  (xa, y)\n                  \\<in> {(s, \\<chi>j. if j = x then k else s $ j) |s k.\n                         True} \\<longrightarrow>\n                  P y\\<rceil> =\n    \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi>j. ((($) s)(x := k)) j)\\<rceil>", "apply(clarsimp, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s k.\n       \\<forall>y.\n          (\\<exists>k.\n              y = (\\<chi>j. if j = x then k else s $ j)) \\<longrightarrow>\n          P y \\<Longrightarrow>\n       P (\\<chi>j. if j = x then k else s $ j)\n 2. \\<And>s y k.\n       \\<forall>k. P (\\<chi>j. if j = x then k else s $ j) \\<Longrightarrow>\n       P (\\<chi>j. if j = x then k else s $ j)", "by (erule_tac x=\"(\\<chi> j. if j = x then k else s $ j)\" in allE, auto)\n\n\\<comment> \\<open> Nondeterministic choice \\<close>"], ["", "lemma le_wp_choice_iff: \"\\<lceil>P\\<rceil> \\<le> wp (X \\<union> Y) \\<lceil>Q\\<rceil> \\<longleftrightarrow> \\<lceil>P\\<rceil> \\<le> wp X \\<lceil>Q\\<rceil> \\<and> \\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>P\\<rceil> \\<subseteq> wp (X \\<union> Y) \\<lceil>Q\\<rceil>) =\n    (\\<lceil>P\\<rceil> \\<subseteq> wp X \\<lceil>Q\\<rceil> \\<and>\n     \\<lceil>P\\<rceil> \\<subseteq> wp Y \\<lceil>Q\\<rceil>)", "using rel_aka.le_fbox_choice_iff[of \"\\<lceil>P\\<rceil>\"]"], ["proof (prove)\nusing this:\n  (rel_aka.ads_d \\<lceil>P\\<rceil> \\<subseteq> wp (?x \\<union> ?y) ?q) =\n  (rel_aka.ads_d \\<lceil>P\\<rceil> \\<subseteq> wp ?x ?q \\<and>\n   rel_aka.ads_d \\<lceil>P\\<rceil> \\<subseteq> wp ?y ?q)\n\ngoal (1 subgoal):\n 1. (\\<lceil>P\\<rceil> \\<subseteq> wp (X \\<union> Y) \\<lceil>Q\\<rceil>) =\n    (\\<lceil>P\\<rceil> \\<subseteq> wp X \\<lceil>Q\\<rceil> \\<and>\n     \\<lceil>P\\<rceil> \\<subseteq> wp Y \\<lceil>Q\\<rceil>)", "by simp\n\n\\<comment> \\<open> Conditional statement \\<close>"], ["", "abbreviation cond_sugar :: \"'a pred \\<Rightarrow> 'a rel \\<Rightarrow> 'a rel \\<Rightarrow> 'a rel\" (\"IF _ THEN _ ELSE _\" [64,64] 63) \n  where \"IF P THEN X ELSE Y \\<equiv> rel_aka.aka_cond \\<lceil>P\\<rceil> X Y\"\n\n\\<comment> \\<open> Finite iteration \\<close>"], ["", "abbreviation loopi_sugar :: \"'a rel \\<Rightarrow> 'a pred \\<Rightarrow> 'a rel\" (\"LOOP _ INV _ \" [64,64] 63)\n  where \"LOOP R INV I \\<equiv> rel_aka.aka_loopi R \\<lceil>I\\<rceil>\""], ["", "lemma change_loopI: \"LOOP X INV G = LOOP X INV I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LOOP X INV G  = LOOP X INV I", "by (unfold rel_aka.aka_loopi_def, simp)"], ["", "lemma wp_loopI: \n  \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp R \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (LOOP R INV I) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> \\<lceil>Q\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> wp R \\<lceil>I\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<subseteq> wp (LOOP R INV I ) \\<lceil>Q\\<rceil>", "using rel_aka.fbox_loopi[of \"\\<lceil>P\\<rceil>\"]"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> rel_aka.ads_d ?i;\n   rel_aka.ads_d ?i \\<subseteq> wp ?x ?i;\n   rel_aka.ads_d ?i \\<subseteq> rel_aka.ads_d ?q\\<rbrakk>\n  \\<Longrightarrow> \\<lceil>P\\<rceil>\n                    \\<subseteq> wp (rel_aka.aka_loopi ?x ?i) ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> \\<lceil>Q\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> wp R \\<lceil>I\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<subseteq> wp (LOOP R INV I ) \\<lceil>Q\\<rceil>", "by auto"], ["", "lemma wp_loopI_break: \n  \"\\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp X \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>  \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (Y ; (LOOP X INV I)) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> wp Y \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> wp X \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<subseteq> wp (Y ; (LOOP X INV I )) \\<lceil>Q\\<rceil>", "using rel_aka.fbox_loopi_break[of \"\\<lceil>P\\<rceil>\"]"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> wp ?y (rel_aka.ads_d ?i);\n   rel_aka.ads_d ?i \\<subseteq> wp ?x ?i;\n   rel_aka.ads_d ?i \\<subseteq> rel_aka.ads_d ?q\\<rbrakk>\n  \\<Longrightarrow> \\<lceil>P\\<rceil>\n                    \\<subseteq> wp (?y ; rel_aka.aka_loopi ?x ?i) ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> wp Y \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> wp X \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<subseteq> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<subseteq> wp (Y ; (LOOP X INV I )) \\<lceil>Q\\<rceil>", "by auto"], ["", "subsubsection \\<open> Evolution commands \\<close>"], ["", "text \\<open>Verification by providing evolution\\<close>"], ["", "definition g_evol :: \"(('a::ord) \\<Rightarrow> 'b \\<Rightarrow> 'b) \\<Rightarrow> 'b pred \\<Rightarrow> ('b \\<Rightarrow> 'a set) \\<Rightarrow> 'b rel\" (\"EVOL\")\n  where \"EVOL \\<phi> G U = {(s,s') |s s'. s' \\<in> g_orbit (\\<lambda>t. \\<phi> t s) G (U s)}\""], ["", "lemma wp_g_dyn[simp]:  \n  fixes \\<phi> :: \"('a::preorder) \\<Rightarrow> 'b \\<Rightarrow> 'b\"\n  shows \"wp (EVOL \\<phi> G U) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (EVOL \\<phi> G U) \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<in>U s.\n                  (\\<forall>\\<tau>\\<in>down (U s) t.\n                      G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                  Q (\\<phi> t s)\\<rceil>", "unfolding wp_rel g_evol_def g_orbit_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>x.\n               \\<forall>y.\n                  (x, y)\n                  \\<in> {(s, s') |s s'.\n                         s' \\<in> {\\<phi> t s |t.\n                                   t \\<in> U s \\<and>\n                                   (\\<forall>\\<tau>\\<in>down (U s) t.\n G (\\<phi> \\<tau> s))}} \\<longrightarrow>\n                  Q y\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<in>U s.\n                  (\\<forall>\\<tau>\\<in>down (U s) t.\n                      G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                  Q (\\<phi> t s)\\<rceil>", "by auto"], ["", "text \\<open>Verification by providing solutions\\<close>"], ["", "definition g_ode :: \"(real \\<Rightarrow> ('a::banach)\\<Rightarrow>'a) \\<Rightarrow> 'a pred \\<Rightarrow> ('a \\<Rightarrow> real set) \\<Rightarrow> 'a set \\<Rightarrow> real \\<Rightarrow> \n  'a rel\" (\"(1x\\<acute>=_ & _ on _ _ @ _)\") \n  where \"(x\\<acute>= f & G on U S @ t\\<^sub>0) = {(s,s') |s s'. s' \\<in> g_orbital f G U S t\\<^sub>0 s}\""], ["", "lemma wp_g_orbital: \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>X\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>)) \\<longrightarrow> Q (X t)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil>", "unfolding g_orbital_eq wp_rel ivp_sols_def g_ode_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>x.\n               \\<forall>y.\n                  (x, y)\n                  \\<in> {(s, s') |s s'.\n                         s' \\<in> {X t |t X.\n                                   t \\<in> U s \\<and>\n                                   \\<P> X (down (U s) t)\n                                   \\<subseteq> Collect G \\<and>\n                                   X \\<in> {X \\<in> U s \\<rightarrow> S.\n       D X = (\\<lambda>t. f t (X t)) on U s \\<and>\n      X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s}}} \\<longrightarrow>\n                  Q y\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>{X \\<in> U s \\<rightarrow> S.\n                                D X = (\\<lambda>t. f t (X t)) on U s \\<and>\n                               X t\\<^sub>0 = s \\<and> t\\<^sub>0 \\<in> U s}.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil>", "by auto"], ["", "context local_flow\nbegin"], ["", "lemma wp_g_ode_subset:\n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"wp (x\\<acute>= (\\<lambda>t. f) & G on U S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>(U s). (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=\\<lambda>t. f & G on U S @ 0 \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s \\<in> S \\<longrightarrow>\n               (\\<forall>t\\<in>U s.\n                   (\\<forall>\\<tau>\\<in>down (U s) t.\n                       G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                   Q (\\<phi> t s))\\<rceil>", "apply(unfold wp_g_orbital, clarsimp, rule iffI; clarify)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s t.\n       \\<lbrakk>\\<forall>X\\<in>Sols (\\<lambda>t. f) U S 0 s.\n                   \\<forall>t\\<in>U s.\n                      (\\<forall>\\<tau>.\n                          \\<tau> \\<in> U s \\<and>\n                          \\<tau> \\<le> t \\<longrightarrow>\n                          G (X \\<tau>)) \\<longrightarrow>\n                      Q (X t);\n        s \\<in> S; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (\\<phi> \\<tau> s)\\<rbrakk>\n       \\<Longrightarrow> Q (\\<phi> t s)\n 2. \\<And>s X t.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "apply(force simp: in_ivp_sols assms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "apply(frule ivp_solsD(2), frule ivp_solsD(3), frule ivp_solsD(4))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "apply(subgoal_tac \"\\<forall>\\<tau>\\<in>down (U s) t. X \\<tau> = \\<phi> \\<tau> s\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s X t.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<forall>\\<tau>\\<in>down (U s) t.\n           X \\<tau> = \\<phi> \\<tau> s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)\n 2. \\<And>s X t.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>\\<in>down (U s) t.\n                            X \\<tau> = \\<phi> \\<tau> s", "apply(clarsimp, fastforce, rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> X \\<tau> = \\<phi> \\<tau> s", "apply(rule ivp_unique_solution[OF _ _ _ _ _ in_ivp_sols])"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> s \\<in> S\n 2. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> is_interval (?U74 s X t \\<tau> s)\n 3. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T\n 4. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> \\<tau> \\<in> ?U74 s X t \\<tau> s\n 5. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Sols (\\<lambda>t. f) (?U74 s X t \\<tau>) S\n                                  0 s\n 6. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> s \\<in> S\n 7. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> 0 \\<in> ?U74 s X t \\<tau> s\n 8. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T", "using assms"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow>\n  0 \\<in> U ?s \\<and> is_interval (U ?s) \\<and> U ?s \\<subseteq> T\n\ngoal (8 subgoals):\n 1. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> s \\<in> S\n 2. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> is_interval (?U74 s X t \\<tau> s)\n 3. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T\n 4. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> \\<tau> \\<in> ?U74 s X t \\<tau> s\n 5. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> X \\<in> Sols (\\<lambda>t. f) (?U74 s X t \\<tau>) S\n                                  0 s\n 6. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> s \\<in> S\n 7. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> 0 \\<in> ?U74 s X t \\<tau> s\n 8. \\<And>s X t \\<tau>.\n       \\<lbrakk>s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        \\<tau> \\<in> U s \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        X \\<in> Sols (\\<lambda>t. f) U S 0 s; t \\<in> U s;\n        \\<forall>\\<tau>.\n           \\<tau> \\<in> U s \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; X \\<in> U s \\<rightarrow> S; 0 \\<in> U s;\n        \\<tau> \\<in> down (U s) t\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T", "by auto"], ["", "lemma wp_g_ode: \"wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. T) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>T. (\\<forall>\\<tau>\\<in>down T t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=\\<lambda>t. f & G on \\<lambda>s. T S @ 0\n     \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s \\<in> S \\<longrightarrow>\n               (\\<forall>t\\<in>T.\n                   (\\<forall>\\<tau>\\<in>down T t.\n                       G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                   Q (\\<phi> t s))\\<rceil>", "by (subst wp_g_ode_subset, simp_all add: init_time interval_time)"], ["", "lemma wp_g_ode_ivl: \"t \\<ge> 0 \\<Longrightarrow> t \\<in> T \\<Longrightarrow> wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. {0..t}) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>{0..t}. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> t; t \\<in> T\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>=\\<lambda>t.\nf & G on \\<lambda>s. {0..t} S @ 0\n                       \\<lceil>Q\\<rceil> =\n                      \\<lceil>\\<lambda>s.\n                                 s \\<in> S \\<longrightarrow>\n                                 (\\<forall>t\\<in>{0..t}.\n                                     (\\<forall>\\<tau>\\<in>{0..t}.\n   G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                                     Q (\\<phi> t s))\\<rceil>", "apply(subst wp_g_ode_subset, simp_all add: subintervalI init_time real_Icc_closed_segment)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> t; t \\<in> T\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s.\n                         (s \\<in> S \\<longrightarrow>\n                          (\\<forall>ta\\<in>{0--t}.\n                              (\\<forall>\\<tau>.\n                                  \\<tau> \\<in> {0--t} \\<and>\n                                  \\<tau> \\<le> ta \\<longrightarrow>\n                                  G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                              Q (\\<phi> ta s))) =\n                         (s \\<in> S \\<longrightarrow>\n                          (\\<forall>t\\<in>{0--t}.\n                              (\\<forall>\\<tau>\\<in>{0..t}.\n                                  G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                              Q (\\<phi> t s)))", "by (auto simp: closed_segment_eq_real_ivl)"], ["", "lemma wp_orbit: \"wp ({(s,s') | s s'. s' \\<in> \\<gamma>\\<^sup>\\<phi> s}) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>T. Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp {(s, s') |s s'. s' \\<in> \\<gamma>\\<^sup>\\<phi> s} \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s \\<in> S \\<longrightarrow>\n               (\\<forall>t\\<in>T. Q (\\<phi> t s))\\<rceil>", "unfolding orbit_def wp_g_ode g_ode_def[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               s \\<in> S \\<longrightarrow>\n               (\\<forall>t\\<in>T.\n                   (\\<forall>\\<tau>\\<in>down T t. True) \\<longrightarrow>\n                   Q (\\<phi> t s))\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s \\<in> S \\<longrightarrow>\n               (\\<forall>t\\<in>T. Q (\\<phi> t s))\\<rceil>", "by auto"], ["", "end"], ["", "text \\<open> Verification with differential invariants \\<close>"], ["", "definition g_ode_inv :: \"(real \\<Rightarrow> ('a::banach)\\<Rightarrow>'a) \\<Rightarrow> 'a pred \\<Rightarrow> ('a \\<Rightarrow> real set) \\<Rightarrow> 'a set \\<Rightarrow> \n  real \\<Rightarrow> 'a pred \\<Rightarrow> 'a rel\" (\"(1x\\<acute>=_ & _ on _ _ @ _ DINV _ )\") \n  where \"(x\\<acute>= f & G on U S @ t\\<^sub>0 DINV I) = (x\\<acute>= f & G on U S @ t\\<^sub>0)\""], ["", "lemma wp_g_orbital_guard: \n  assumes \"H = (\\<lambda>s. G s \\<and> Q s)\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>H\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>H\\<rceil>", "unfolding wp_g_orbital"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     H (X t)\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  H = (\\<lambda>s. G s \\<and> Q s)\n\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     H (X t)\\<rceil>", "by auto"], ["", "lemma wp_g_orbital_inv:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "using assms(1)"], ["proof (prove)\nusing this:\n  \\<lceil>P\\<rceil> \\<subseteq> \\<lceil>I\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule order.trans)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<lceil>I\\<rceil>\n  \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule order.trans)"], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule rel_aka.fbox_iso)"], ["proof (prove)\ngoal (1 subgoal):\n 1. rel_aka.ads_d \\<lceil>I\\<rceil>\n    \\<subseteq> rel_aka.ads_d \\<lceil>Q\\<rceil>", "using assms(3)"], ["proof (prove)\nusing this:\n  \\<lceil>I\\<rceil> \\<subseteq> \\<lceil>Q\\<rceil>\n\ngoal (1 subgoal):\n 1. rel_aka.ads_d \\<lceil>I\\<rceil>\n    \\<subseteq> rel_aka.ads_d \\<lceil>Q\\<rceil>", "by auto"], ["", "lemma wp_diff_inv[simp]: \"(\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>) = diff_invariant I f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>) =\n    diff_invariant I f U S t\\<^sub>0 G", "unfolding diff_invariant_eq wp_g_orbital"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<subseteq> \\<lceil>\\<lambda>s.\n                            \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                               \\<forall>t\\<in>U s.\n                                  (\\<forall>\\<tau>\\<in>down (U s) t.\nG (X \\<tau>)) \\<longrightarrow>\n                                  I (X t)\\<rceil>) =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n            \\<forall>t\\<in>U s.\n               (\\<forall>\\<tau>\\<in>down (U s) t.\n                   G (X \\<tau>)) \\<longrightarrow>\n               I (X t)))", "by(auto simp: p2r_def)"], ["", "lemma diff_inv_guard_ignore:\n  assumes \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. True) on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\"\n  shows \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  \\<lceil>I\\<rceil>\n  \\<subseteq> wp x\\<acute>=f & \\<lambda>s. True on U S @ t\\<^sub>0\n               \\<lceil>I\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>", "unfolding wp_diff_inv diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n         \\<forall>t\\<in>U s.\n            (\\<forall>\\<tau>\\<in>down (U s) t. True) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n           \\<forall>t\\<in>U s.\n              (\\<forall>\\<tau>\\<in>down (U s) t.\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "by auto"], ["", "context local_flow\nbegin"], ["", "lemma wp_diff_inv_eq: \n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"diff_invariant I (\\<lambda>t. f) U S 0 (\\<lambda>s. True) = \n  (\\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil> = wp (x\\<acute>= (\\<lambda>t. f) & (\\<lambda>s. True) on U S @ 0) \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I (\\<lambda>t. f) U S 0 (\\<lambda>s. True) =\n    (\\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil> =\n     wp x\\<acute>=\\<lambda>t. f & \\<lambda>s. True on U S @ 0\n      \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil>)", "unfolding wp_diff_inv[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<subseteq> wp x\\<acute>=\\<lambda>t. f & \\<lambda>s. True on U S @ 0\n                  \\<lceil>I\\<rceil>) =\n    (\\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil> =\n     wp x\\<acute>=\\<lambda>t. f & \\<lambda>s. True on U S @ 0\n      \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil>)", "apply(subst wp_g_ode_subset[OF assms], simp)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<subseteq> \\<lceil>\\<lambda>s.\n                            s \\<in> S \\<longrightarrow>\n                            (\\<forall>t\\<in>U s.\n                                (\\<forall>\\<tau>\\<in>down (U s) t.\n                                    True) \\<longrightarrow>\n                                I (\\<phi> t s))\\<rceil>) =\n    (\\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil> =\n     \\<lceil>\\<lambda>s.\n                s \\<in> S \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>\\<in>down (U s) t.\n                        True) \\<longrightarrow>\n                    \\<phi> t s \\<in> S \\<longrightarrow>\n                    I (\\<phi> t s))\\<rceil>)", "apply(clarsimp, safe, force)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s \\<in> S \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s \\<in> S;\n        \\<forall>t\\<in>U s.\n           \\<phi> t s \\<in> S \\<longrightarrow> I (\\<phi> t s)\\<rbrakk>\n       \\<Longrightarrow> I s\n 2. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s \\<in> S \\<longrightarrow> I s) =\n                   (s \\<in> S \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        \\<phi> t s \\<in> S \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s \\<in> S; t \\<in> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "apply(erule_tac x=0 in ballE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s \\<in> S \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s \\<in> S;\n        \\<phi> 0 s \\<in> S \\<longrightarrow> I (\\<phi> 0 s)\\<rbrakk>\n       \\<Longrightarrow> I s\n 2. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s \\<in> S \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s \\<in> S; 0 \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I s\n 3. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s \\<in> S \\<longrightarrow> I s) =\n                   (s \\<in> S \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        \\<phi> t s \\<in> S \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s \\<in> S; t \\<in> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "using init_time in_domain ivp(2) assms"], ["proof (prove)\nusing this:\n  0 \\<in> T\n  ?s \\<in> S \\<Longrightarrow>\n  (\\<lambda>t. \\<phi> t ?s) \\<in> T \\<rightarrow> S\n  ?s \\<in> S \\<Longrightarrow> \\<phi> 0 ?s = ?s\n  ?s \\<in> S \\<Longrightarrow>\n  0 \\<in> U ?s \\<and> is_interval (U ?s) \\<and> U ?s \\<subseteq> T\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s \\<in> S \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s \\<in> S;\n        \\<phi> 0 s \\<in> S \\<longrightarrow> I (\\<phi> 0 s)\\<rbrakk>\n       \\<Longrightarrow> I s\n 2. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s \\<in> S \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s \\<in> S; 0 \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I s\n 3. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s \\<in> S \\<longrightarrow> I s) =\n                   (s \\<in> S \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        \\<phi> t s \\<in> S \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s \\<in> S; t \\<in> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "apply(force, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s \\<in> S \\<longrightarrow> I s) =\n                   (s \\<in> S \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        \\<phi> t s \\<in> S \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s \\<in> S; t \\<in> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "apply(erule_tac x=s in allE, clarsimp, erule_tac x=t in ballE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s t.\n       \\<lbrakk>I s; s \\<in> S; t \\<in> U s;\n        \\<phi> t s \\<in> S \\<longrightarrow> I (\\<phi> t s)\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)\n 2. \\<And>s t.\n       \\<lbrakk>I s; s \\<in> S; t \\<in> U s; t \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "using in_domain ivp(2) assms"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow>\n  (\\<lambda>t. \\<phi> t ?s) \\<in> T \\<rightarrow> S\n  ?s \\<in> S \\<Longrightarrow> \\<phi> 0 ?s = ?s\n  ?s \\<in> S \\<Longrightarrow>\n  0 \\<in> U ?s \\<and> is_interval (U ?s) \\<and> U ?s \\<subseteq> T\n\ngoal (2 subgoals):\n 1. \\<And>s t.\n       \\<lbrakk>I s; s \\<in> S; t \\<in> U s;\n        \\<phi> t s \\<in> S \\<longrightarrow> I (\\<phi> t s)\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)\n 2. \\<And>s t.\n       \\<lbrakk>I s; s \\<in> S; t \\<in> U s; t \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "by force+"], ["", "lemma diff_inv_eq_inv_set:\n  \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. T) S 0 (\\<lambda>s. True) = (\\<forall>s. I s \\<longrightarrow> \\<gamma>\\<^sup>\\<phi> s \\<subseteq> {s. I s})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I (\\<lambda>t. f) (\\<lambda>s. T) S 0\n     (\\<lambda>s. True) =\n    (\\<forall>s.\n        I s \\<longrightarrow> \\<gamma>\\<^sup>\\<phi> s \\<subseteq> {s. I s})", "unfolding diff_inv_eq_inv_set orbit_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>s.\n        I s \\<longrightarrow>\n        g_orbital (\\<lambda>t. f) (\\<lambda>s. True) (\\<lambda>s. T) S 0 s\n        \\<subseteq> Collect I) =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        g_orbital (\\<lambda>t. f) (\\<lambda>s. True) (\\<lambda>s. T) S 0 s\n        \\<subseteq> {s. I s})", "by (auto simp: p2r_def)"], ["", "end"], ["", "lemma wp_g_odei: \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow> \n  \\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0 DINV I) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<subseteq> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 DINV I \n                                   \\<lceil>Q\\<rceil>", "unfolding g_ode_inv_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<subseteq> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                                   \\<lceil>Q\\<rceil>", "apply(rule_tac b=\"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\" in order.trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<subseteq> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                                   \\<lceil>I\\<rceil>\n 2. \\<lbrakk>\\<lceil>P\\<rceil> \\<subseteq> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<subseteq> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                       \\<lceil>I\\<rceil>\n                      \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                                   \\<lceil>Q\\<rceil>", "apply(rule_tac I=\"I\" in wp_g_orbital_inv, simp_all)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>s. P s \\<longrightarrow> I s;\n     diff_invariant I f U S t\\<^sub>0 G;\n     \\<forall>s. I s \\<and> G s \\<longrightarrow> Q s\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                       \\<lceil>I\\<rceil>\n                      \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                                   \\<lceil>Q\\<rceil>", "apply(subst wp_g_orbital_guard, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>s. P s \\<longrightarrow> I s;\n     diff_invariant I f U S t\\<^sub>0 G;\n     \\<forall>s. I s \\<and> G s \\<longrightarrow> Q s\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                       \\<lceil>\\<lambda>s. G s \\<and> I s\\<rceil>\n                      \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0\n                                   \\<lceil>Q\\<rceil>", "by (rule rel_aka.fbox_iso, simp)"], ["", "subsubsection \\<open> Derivation of the rules of dL \\<close>"], ["", "text \\<open> We derive rules of differential dynamic logic (dL). This allows the components to reason \nin the style of that logic. \\<close>"], ["", "abbreviation g_dl_ode ::\"(('a::banach)\\<Rightarrow>'a) \\<Rightarrow> 'a pred \\<Rightarrow> 'a rel\" (\"(1x\\<acute>=_ & _)\") \n  where \"(x\\<acute>=f & G) \\<equiv> (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. {t. t \\<ge> 0}) UNIV @ 0)\""], ["", "abbreviation g_dl_ode_inv :: \"(('a::banach)\\<Rightarrow>'a) \\<Rightarrow> 'a pred \\<Rightarrow> 'a pred \\<Rightarrow> 'a rel\" (\"(1x\\<acute>=_ & _ DINV _)\") \n  where \"(x\\<acute>= f & G DINV I) \\<equiv> (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. {t. t \\<ge> 0}) UNIV @ 0 DINV I)\""], ["", "lemma diff_solve_axiom1: \n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=\\<lambda>t. f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n     \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>\\<in>{0..t}.\n                      G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                  Q (\\<phi> t s)\\<rceil>", "by (subst local_flow.wp_g_ode_subset[OF assms], auto)"], ["", "lemma diff_solve_axiom2: \n  fixes c::\"'a::{heine_borel, banach}\"\n  shows \"wp (x\\<acute>=(\\<lambda>s. c) & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow> Q (s + t *\\<^sub>R c)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=\\<lambda>t s. c & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n     \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>\\<in>{0..t}.\n                      G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow>\n                  Q (s + t *\\<^sub>R c)\\<rceil>", "apply(subst local_flow.wp_g_ode_subset[where \\<phi>=\"(\\<lambda>t s. s + t *\\<^sub>R c)\" and T=UNIV])"], ["proof (prove)\ngoal (3 subgoals):\n 1. local_flow (\\<lambda>s. c) UNIV UNIV (\\<lambda>t s. s + t *\\<^sub>R c)\n 2. \\<And>s.\n       s \\<in> UNIV \\<Longrightarrow>\n       0 \\<in> Collect ((\\<le>) 0) \\<and>\n       is_interval (Collect ((\\<le>) 0)) \\<and>\n       Collect ((\\<le>) 0) \\<subseteq> UNIV\n 3. \\<lceil>\\<lambda>s.\n               s \\<in> UNIV \\<longrightarrow>\n               (\\<forall>t\\<in>Collect ((\\<le>) 0).\n                   (\\<forall>\\<tau>\\<in>down (Collect ((\\<le>) 0)) t.\n                       G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow>\n                   Q (s + t *\\<^sub>R c))\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>\\<in>{0..t}.\n                      G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow>\n                  Q (s + t *\\<^sub>R c)\\<rceil>", "by (rule line_is_local_flow, auto)"], ["", "lemma diff_solve_rule:\n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n    and \"\\<forall>s. P s \\<longrightarrow> (\\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=\\<lambda>t.\n                                f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n                 \\<lceil>Q\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  local_flow f UNIV UNIV \\<phi>\n  \\<forall>s.\n     P s \\<longrightarrow>\n     (\\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow>\n         Q (\\<phi> t s))\n\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=\\<lambda>t.\n                                f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n                 \\<lceil>Q\\<rceil>", "by (subst local_flow.wp_g_ode_subset[OF assms(1)], auto)"], ["", "lemma diff_weak_axiom1: \"Id \\<subseteq> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>G\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. skip \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>G\\<rceil>", "unfolding wp_rel g_ode_def g_orbital_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. skip\n    \\<subseteq> \\<lceil>\\<lambda>x.\n                           \\<forall>y.\n                              (x, y)\n                              \\<in> {(s, s') |s s'.\n                                     s' \\<in> {X t |t X.\n         t \\<in> U s \\<and>\n         \\<P> X (down (U s) t) \\<subseteq> Collect G \\<and>\n         X \\<in> Sols f U S t\\<^sub>0 s}} \\<longrightarrow>\n                              G y\\<rceil>", "by auto"], ["", "lemma diff_weak_axiom2: \n  \"wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>\\<lambda> s. G s \\<longrightarrow> Q s\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=f & G on T S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    wp x\\<acute>=f & G on T S @ t\\<^sub>0\n     \\<lceil>\\<lambda>s. G s \\<longrightarrow> Q s\\<rceil>", "unfolding wp_g_orbital image_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f T S t\\<^sub>0 s.\n                  \\<forall>t\\<in>T s.\n                     (\\<forall>\\<tau>\\<in>down (T s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f T S t\\<^sub>0 s.\n                  \\<forall>t\\<in>T s.\n                     (\\<forall>\\<tau>\\<in>down (T s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     G (X t) \\<longrightarrow> Q (X t)\\<rceil>", "by force"], ["", "lemma diff_weak_rule: \n  assumes \"\\<lceil>G\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  \\<lceil>G\\<rceil> \\<subseteq> \\<lceil>Q\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "by (auto simp: wp_g_orbital)"], ["", "lemma wp_g_evol_IdD:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = Id\"\n    and \"\\<forall>\\<tau>\\<in>(down (U s) t). (s, x \\<tau>) \\<in> (x\\<acute>= f & G on U S @ t\\<^sub>0)\"\n  shows \"\\<forall>\\<tau>\\<in>(down (U s) t). C (x \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>down (U s) t. C (x \\<tau>)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. \\<tau> \\<in> down (U s) t \\<Longrightarrow> C (x \\<tau>)", "fix \\<tau>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. \\<tau> \\<in> down (U s) t \\<Longrightarrow> C (x \\<tau>)", "assume \"\\<tau> \\<in> (down (U s) t)\""], ["proof (state)\nthis:\n  \\<tau> \\<in> down (U s) t\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. \\<tau> \\<in> down (U s) t \\<Longrightarrow> C (x \\<tau>)", "hence \"x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  \\<tau> \\<in> down (U s) t\n\ngoal (1 subgoal):\n 1. x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<tau> \\<in> down (U s) t\n  \\<forall>\\<tau>\\<in>down (U s) t.\n     (s, x \\<tau>) \\<in> x\\<acute>=f & G on U S @ t\\<^sub>0\n\ngoal (1 subgoal):\n 1. x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s", "unfolding g_ode_def"], ["proof (prove)\nusing this:\n  \\<tau> \\<in> down (U s) t\n  \\<forall>\\<tau>\\<in>down (U s) t.\n     (s, x \\<tau>)\n     \\<in> {(s, s') |s s'. s' \\<in> g_orbital f G U S t\\<^sub>0 s}\n\ngoal (1 subgoal):\n 1. x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s", "by blast"], ["proof (state)\nthis:\n  x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. \\<tau> \\<in> down (U s) t \\<Longrightarrow> C (x \\<tau>)", "also"], ["proof (state)\nthis:\n  x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. \\<tau> \\<in> down (U s) t \\<Longrightarrow> C (x \\<tau>)", "have \"\\<forall>y. y \\<in> (g_orbital f G U S t\\<^sub>0 s) \\<longrightarrow> C y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>y. y \\<in> g_orbital f G U S t\\<^sub>0 s \\<longrightarrow> C y", "using assms(1)"], ["proof (prove)\nusing this:\n  wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>C\\<rceil> = skip\n\ngoal (1 subgoal):\n 1. \\<forall>y. y \\<in> g_orbital f G U S t\\<^sub>0 s \\<longrightarrow> C y", "unfolding wp_rel g_ode_def"], ["proof (prove)\nusing this:\n  \\<lceil>\\<lambda>x.\n             \\<forall>y.\n                (x, y)\n                \\<in> {(s, s') |s s'.\n                       s' \\<in> g_orbital f G U S t\\<^sub>0\n                                 s} \\<longrightarrow>\n                C y\\<rceil> =\n  skip\n\ngoal (1 subgoal):\n 1. \\<forall>y. y \\<in> g_orbital f G U S t\\<^sub>0 s \\<longrightarrow> C y", "by(auto simp: p2r_def)"], ["proof (state)\nthis:\n  \\<forall>y. y \\<in> g_orbital f G U S t\\<^sub>0 s \\<longrightarrow> C y\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. \\<tau> \\<in> down (U s) t \\<Longrightarrow> C (x \\<tau>)", "ultimately"], ["proof (chain)\npicking this:\n  x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\n  \\<forall>y. y \\<in> g_orbital f G U S t\\<^sub>0 s \\<longrightarrow> C y", "show \"C (x \\<tau>)\""], ["proof (prove)\nusing this:\n  x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\n  \\<forall>y. y \\<in> g_orbital f G U S t\\<^sub>0 s \\<longrightarrow> C y\n\ngoal (1 subgoal):\n 1. C (x \\<tau>)", "by blast"], ["proof (state)\nthis:\n  C (x \\<tau>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_cut_axiom:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = Id\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    wp x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n     \\<lceil>Q\\<rceil>", "proof(rule_tac f=\"\\<lambda> x. wp x \\<lceil>Q\\<rceil>\" in HOL.arg_cong, rule subset_antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. x\\<acute>=f & G on U S @ t\\<^sub>0\n    \\<subseteq> x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n 2. x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n    \\<subseteq> x\\<acute>=f & G on U S @ t\\<^sub>0", "show \"(x\\<acute>=f & G on U S @ t\\<^sub>0) \\<subseteq> (x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x\\<acute>=f & G on U S @ t\\<^sub>0\n    \\<subseteq> x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0", "proof(clarsimp simp: g_ode_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "fix s and s'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "assume \"s' \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (state)\nthis:\n  s' \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "then"], ["proof (chain)\npicking this:\n  s' \\<in> g_orbital f G U S t\\<^sub>0 s", "obtain \\<tau>::real and X where x_ivp: \"X \\<in> Sols f U S t\\<^sub>0 s\" \n      and \"X \\<tau> = s'\" and \"\\<tau> \\<in> U s\" and guard_x:\"(\\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s})\""], ["proof (prove)\nusing this:\n  s' \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. (\\<And>X \\<tau>.\n        \\<lbrakk>X \\<in> Sols f U S t\\<^sub>0 s; X \\<tau> = s';\n         \\<tau> \\<in> U s;\n         \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using g_orbitalD[of s' \"f\" G _ S t\\<^sub>0 s]"], ["proof (prove)\nusing this:\n  s' \\<in> g_orbital f G U S t\\<^sub>0 s\n  \\<lbrakk>s' \\<in> g_orbital f G ?U S t\\<^sub>0 s;\n   \\<And>X t.\n      \\<lbrakk>X \\<in> Sols f ?U S t\\<^sub>0 s; X t = s'; t \\<in> ?U s;\n       \\<P> X (down (?U s) t) \\<subseteq> {s. G s}\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>X \\<tau>.\n        \\<lbrakk>X \\<in> Sols f U S t\\<^sub>0 s; X \\<tau> = s';\n         \\<tau> \\<in> U s;\n         \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  X \\<in> Sols f U S t\\<^sub>0 s\n  X \\<tau> = s'\n  \\<tau> \\<in> U s\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "have \"\\<forall>t\\<in>(down (U s) \\<tau>). \\<P> X (down (U s) t) \\<subseteq> {s. G s}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       \\<P> X (down (U s) t) \\<subseteq> {s. G s}", "using guard_x"], ["proof (prove)\nusing this:\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       \\<P> X (down (U s) t) \\<subseteq> {s. G s}", "by (force simp: image_def)"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "also"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "have \"\\<forall>t\\<in>(down (U s) \\<tau>). t \\<in> U s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. t \\<in> U s", "using \\<open>\\<tau> \\<in> U s\\<close>"], ["proof (prove)\nusing this:\n  \\<tau> \\<in> U s\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. t \\<in> U s", "by auto"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>. t \\<in> U s\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n  \\<forall>t\\<in>down (U s) \\<tau>. t \\<in> U s", "have \"\\<forall>t\\<in>(down (U s) \\<tau>). X t \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n  \\<forall>t\\<in>down (U s) \\<tau>. t \\<in> U s\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       X t \\<in> g_orbital f G U S t\\<^sub>0 s", "using g_orbitalI[OF x_ivp]"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n  \\<forall>t\\<in>down (U s) \\<tau>. t \\<in> U s\n  \\<lbrakk>?t \\<in> U s;\n   \\<P> X (down (U s) ?t) \\<subseteq> {s. ?G s}\\<rbrakk>\n  \\<Longrightarrow> X ?t \\<in> g_orbital f ?G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       X t \\<in> g_orbital f G U S t\\<^sub>0 s", "by (metis (mono_tags, lifting))"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>. X t \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "hence \"\\<forall>t\\<in>(down (U s) \\<tau>). C (X t)\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>. X t \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. C (X t)", "using wp_g_evol_IdD[OF assms(1)]"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>. X t \\<in> g_orbital f G U S t\\<^sub>0 s\n  \\<forall>\\<tau>\\<in>down (U ?s) ?t.\n     (?s, ?x \\<tau>)\n     \\<in> x\\<acute>=f & G on U S @ t\\<^sub>0 \\<Longrightarrow>\n  \\<forall>\\<tau>\\<in>down (U ?s) ?t. C (?x \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. C (X t)", "unfolding g_ode_def"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>. X t \\<in> g_orbital f G U S t\\<^sub>0 s\n  \\<forall>\\<tau>\\<in>down (U ?s) ?t.\n     (?s, ?x \\<tau>)\n     \\<in> {(s, s') |s s'.\n            s' \\<in> g_orbital f G U S t\\<^sub>0 s} \\<Longrightarrow>\n  \\<forall>\\<tau>\\<in>down (U ?s) ?t. C (?x \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. C (X t)", "by blast"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>. C (X t)\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       b \\<in> g_orbital f G U S t\\<^sub>0 a \\<Longrightarrow>\n       b \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 a", "thus \"s' \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>. C (X t)\n\ngoal (1 subgoal):\n 1. s' \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s", "using g_orbitalI[OF x_ivp \\<open>\\<tau> \\<in> U s\\<close>] guard_x \\<open>X \\<tau> = s'\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>. C (X t)\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. ?G s} \\<Longrightarrow>\n  X \\<tau> \\<in> g_orbital f ?G U S t\\<^sub>0 s\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\n  X \\<tau> = s'\n\ngoal (1 subgoal):\n 1. s' \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s", "by fastforce"], ["proof (state)\nthis:\n  s' \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x\\<acute>=f & G on U S @ t\\<^sub>0\n  \\<subseteq> x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n\ngoal (1 subgoal):\n 1. x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n    \\<subseteq> x\\<acute>=f & G on U S @ t\\<^sub>0", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n    \\<subseteq> x\\<acute>=f & G on U S @ t\\<^sub>0", "show \"(x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0) \\<subseteq> (x\\<acute>=f & G on U S @ t\\<^sub>0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n    \\<subseteq> x\\<acute>=f & G on U S @ t\\<^sub>0", "by (auto simp: g_orbital_eq g_ode_def)"], ["proof (state)\nthis:\n  x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n  \\<subseteq> x\\<acute>=f & G on U S @ t\\<^sub>0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_cut_rule:\n  assumes wp_C: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil>\"\n    and wp_Q: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "proof(subst wp_rel, simp add: g_orbital_eq p2r_def g_ode_def, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; t \\<in> U s;\n        \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        X \\<in> Sols f U S t\\<^sub>0 s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "fix t::real and X::\"real \\<Rightarrow> 'a\" and s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; t \\<in> U s;\n        \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        X \\<in> Sols f U S t\\<^sub>0 s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "assume \"P s\" and \"t \\<in> U s\"\n    and x_ivp:\"X \\<in> Sols f U S t\\<^sub>0 s\" \n    and guard_x:\"\\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x)\""], ["proof (state)\nthis:\n  P s\n  t \\<in> U s\n  X \\<in> Sols f U S t\\<^sub>0 s\n  \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x)\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; t \\<in> U s;\n        \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        X \\<in> Sols f U S t\\<^sub>0 s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "have \"\\<forall>t\\<in>(down (U s) t). X t \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. X t \\<in> g_orbital f G U S t\\<^sub>0 s", "using g_orbitalI[OF x_ivp] guard_x"], ["proof (prove)\nusing this:\n  \\<lbrakk>?t \\<in> U s;\n   \\<P> X (down (U s) ?t) \\<subseteq> {s. ?G s}\\<rbrakk>\n  \\<Longrightarrow> X ?t \\<in> g_orbital f ?G U S t\\<^sub>0 s\n  \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. X t \\<in> g_orbital f G U S t\\<^sub>0 s", "by auto"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) t. X t \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; t \\<in> U s;\n        \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        X \\<in> Sols f U S t\\<^sub>0 s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "hence \"\\<forall>t\\<in>(down (U s) t). C (X t)\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. X t \\<in> g_orbital f G U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. C (X t)", "using wp_C \\<open>P s\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. X t \\<in> g_orbital f G U S t\\<^sub>0 s\n  \\<lceil>P\\<rceil>\n  \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>C\\<rceil>\n  P s\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. C (X t)", "by (subst (asm) wp_rel, auto simp: g_ode_def)"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) t. C (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; t \\<in> U s;\n        \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        X \\<in> Sols f U S t\\<^sub>0 s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "hence \"X t \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. C (X t)\n\ngoal (1 subgoal):\n 1. X t \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s", "using guard_x \\<open>t \\<in> U s\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. C (X t)\n  \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x)\n  t \\<in> U s\n\ngoal (1 subgoal):\n 1. X t \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s", "by (auto intro!: g_orbitalI x_ivp)"], ["proof (state)\nthis:\n  X t \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; t \\<in> U s;\n        \\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        X \\<in> Sols f U S t\\<^sub>0 s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "thus \"Q (X t)\""], ["proof (prove)\nusing this:\n  X t \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\n\ngoal (1 subgoal):\n 1. Q (X t)", "using \\<open>P s\\<close> wp_Q"], ["proof (prove)\nusing this:\n  X t \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\n  P s\n  \\<lceil>P\\<rceil>\n  \\<subseteq> wp x\\<acute>=f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n               \\<lceil>Q\\<rceil>\n\ngoal (1 subgoal):\n 1. Q (X t)", "by (subst (asm) wp_rel) (auto simp: g_ode_def)"], ["proof (state)\nthis:\n  Q (X t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_inv_axiom1:\n  assumes \"G s \\<longrightarrow> I s\" and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. t \\<ge> 0}) UNIV 0 G\"\n  shows \"(s,s) \\<in> wp (x\\<acute>= f & G) \\<lceil>I\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (s, s)\n    \\<in> wp x\\<acute>=\\<lambda>t.\n                          f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n           \\<lceil>I\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  G s \\<longrightarrow> I s\n  diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 G\n\ngoal (1 subgoal):\n 1. (s, s)\n    \\<in> wp x\\<acute>=\\<lambda>t.\n                          f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n           \\<lceil>I\\<rceil>", "unfolding wp_g_orbital diff_invariant_eq"], ["proof (prove)\nusing this:\n  G s \\<longrightarrow> I s\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0))\n                      UNIV 0 s.\n         \\<forall>t\\<in>Collect ((\\<le>) 0).\n            (\\<forall>\\<tau>\\<in>down (Collect ((\\<le>) 0)) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. (s, s)\n    \\<in> \\<lceil>\\<lambda>s.\n                     \\<forall>X\\<in>Sols (\\<lambda>t. f)\n                                     (\\<lambda>s. Collect ((\\<le>) 0)) UNIV\n                                     0 s.\n                        \\<forall>t\\<in>Collect ((\\<le>) 0).\n                           (\\<forall>\\<tau>\n                                     \\<in>down (Collect ((\\<le>) 0)) t.\n                               G (X \\<tau>)) \\<longrightarrow>\n                           I (X t)\\<rceil>", "apply clarsimp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        \\<forall>s.\n           I s \\<longrightarrow>\n           (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                            (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>.\n                      0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                      G (X \\<tau>)) \\<longrightarrow>\n                  I (X t));\n        X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV\n                 0 s;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> I (X t)", "by (erule_tac x=s in allE, frule ivp_solsD(2), clarsimp)"], ["", "lemma diff_inv_axiom2:\n  assumes \"picard_lindeloef (\\<lambda>t. f) UNIV UNIV 0\"\n    and \"\\<And>s. {t::real. t \\<ge> 0} \\<subseteq> picard_lindeloef.ex_ivl (\\<lambda>t. f) UNIV UNIV 0 s\"\n    and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t::real. t \\<ge> 0}) UNIV 0 G\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>I\\<rceil> = wp \\<lceil>G\\<rceil> \\<lceil>I\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>=\\<lambda>t. f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n     \\<lceil>I\\<rceil> =\n    wp \\<lceil>G\\<rceil> \\<lceil>I\\<rceil>", "proof(unfold wp_g_orbital, subst wp_rel, clarsimp simp: fun_eq_iff)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "fix s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "let \"?ex_ivl s\" = \"picard_lindeloef.ex_ivl (\\<lambda>t. f) UNIV UNIV 0 s\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "let \"?lhs s\" = \n    \"\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. t \\<ge> 0}) UNIV 0 s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>. 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)) \\<longrightarrow> I (X t)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "obtain X where xivp1: \"X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. ?ex_ivl s) UNIV 0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X.\n        X \\<in> Sols (\\<lambda>t. f)\n                 (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV\n                 0 s \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using picard_lindeloef.flow_in_ivp_sols_ex_ivl[OF assms(1)]"], ["proof (prove)\nusing this:\n  ?s \\<in> UNIV \\<Longrightarrow>\n  ll_on_open.flow UNIV (\\<lambda>t. f) UNIV 0 ?s\n  \\<in> Sols (\\<lambda>t. f)\n         (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV 0 ?s\n\ngoal (1 subgoal):\n 1. (\\<And>X.\n        X \\<in> Sols (\\<lambda>t. f)\n                 (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV\n                 0 s \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  X \\<in> Sols (\\<lambda>t. f)\n           (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV 0 s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "have xivp2: \"X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s", "by (rule in_ivp_sols_subset[OF _ _ xivp1], simp_all add: assms(2))"], ["proof (state)\nthis:\n  X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence shyp: \"X 0 = s\""], ["proof (prove)\nusing this:\n  X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s\n\ngoal (1 subgoal):\n 1. X 0 = s", "using ivp_solsD"], ["proof (prove)\nusing this:\n  X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s\n  ?X \\<in> Sols ?f ?U ?S ?t\\<^sub>0 ?s \\<Longrightarrow>\n   D ?X = (\\<lambda>t. ?f t (?X t)) on ?U ?s\n  ?X \\<in> Sols ?f ?U ?S ?t\\<^sub>0 ?s \\<Longrightarrow> ?X ?t\\<^sub>0 = ?s\n  ?X \\<in> Sols ?f ?U ?S ?t\\<^sub>0 ?s \\<Longrightarrow>\n  ?X \\<in> ?U ?s \\<rightarrow> ?S\n  ?X \\<in> Sols ?f ?U ?S ?t\\<^sub>0 ?s \\<Longrightarrow>\n  ?t\\<^sub>0 \\<in> ?U ?s\n\ngoal (1 subgoal):\n 1. X 0 = s", "by auto"], ["proof (state)\nthis:\n  X 0 = s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "have dinv: \"\\<forall>s. I s \\<longrightarrow> ?lhs s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                        UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "using assms(3)"], ["proof (prove)\nusing this:\n  diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 G\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                        UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "unfolding diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0))\n                      UNIV 0 s.\n         \\<forall>t\\<in>Collect ((\\<le>) 0).\n            (\\<forall>\\<tau>\\<in>down (Collect ((\\<le>) 0)) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                        UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "by auto"], ["proof (state)\nthis:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV\n                      0 s.\n         \\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "{"], ["proof (state)\nthis:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV\n                      0 s.\n         \\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "assume \"?lhs s\" and \"G s\""], ["proof (state)\nthis:\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n  G s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence \"I s\""], ["proof (prove)\nusing this:\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n  G s\n\ngoal (1 subgoal):\n 1. I s", "by (erule_tac x=X in ballE, erule_tac x=0 in allE, auto simp: shyp xivp2)"], ["proof (state)\nthis:\n  I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                           UNIV 0 s.\n              \\<forall>t\\<ge>0.\n                 (\\<forall>\\<tau>.\n                     0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                     G (X \\<tau>)) \\<longrightarrow>\n                 I (X t);\n   G s\\<rbrakk>\n  \\<Longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence \"?lhs s \\<longrightarrow> (G s \\<longrightarrow> I s)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                           UNIV 0 s.\n              \\<forall>t\\<ge>0.\n                 (\\<forall>\\<tau>.\n                     0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                     G (X \\<tau>)) \\<longrightarrow>\n                 I (X t);\n   G s\\<rbrakk>\n  \\<Longrightarrow> I s\n\ngoal (1 subgoal):\n 1. (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                     s.\n        \\<forall>t\\<ge>0.\n           (\\<forall>\\<tau>.\n               0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n               G (X \\<tau>)) \\<longrightarrow>\n           I (X t)) \\<longrightarrow>\n    G s \\<longrightarrow> I s", "by blast"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "moreover"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "{"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "assume \"G s \\<longrightarrow> I s\""], ["proof (state)\nthis:\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence \"?lhs s\""], ["proof (prove)\nusing this:\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                    s.\n       \\<forall>t\\<ge>0.\n          (\\<forall>\\<tau>.\n              0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n              G (X \\<tau>)) \\<longrightarrow>\n          I (X t)", "apply(clarify, subgoal_tac \"\\<forall>\\<tau>. 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> I (X t)\n 2. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>.\n                            0 \\<le> \\<tau> \\<and>\n                            \\<tau> \\<le> t \\<longrightarrow>\n                            G (X \\<tau>)", "apply(erule_tac x=0 in allE, frule ivp_solsD(2), simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X t.\n       \\<lbrakk>X \\<in> Sols (\\<lambda>t. f)\n                         (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s;\n        0 \\<le> t; I s;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s; X 0 = s\\<rbrakk>\n       \\<Longrightarrow> I (X t)\n 2. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>.\n                            0 \\<le> \\<tau> \\<and>\n                            \\<tau> \\<le> t \\<longrightarrow>\n                            G (X \\<tau>)", "using dinv"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV\n                      0 s.\n         \\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (2 subgoals):\n 1. \\<And>X t.\n       \\<lbrakk>X \\<in> Sols (\\<lambda>t. f)\n                         (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s;\n        0 \\<le> t; I s;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s; X 0 = s\\<rbrakk>\n       \\<Longrightarrow> I (X t)\n 2. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>.\n                            0 \\<le> \\<tau> \\<and>\n                            \\<tau> \\<le> t \\<longrightarrow>\n                            G (X \\<tau>)", "by blast+"], ["proof (state)\nthis:\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "}"], ["proof (state)\nthis:\n  G s \\<longrightarrow> I s \\<Longrightarrow>\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "ultimately"], ["proof (chain)\npicking this:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n  G s \\<longrightarrow> I s \\<Longrightarrow>\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)", "show \"?lhs s = (G s \\<longrightarrow> I s)\""], ["proof (prove)\nusing this:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n  G s \\<longrightarrow> I s \\<Longrightarrow>\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n\ngoal (1 subgoal):\n 1. (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                     s.\n        \\<forall>t\\<ge>0.\n           (\\<forall>\\<tau>.\n               0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n               G (X \\<tau>)) \\<longrightarrow>\n           I (X t)) =\n    (G s \\<longrightarrow> I s)", "by blast"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) =\n  (G s \\<longrightarrow> I s)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_inv_rule:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"diff_invariant I f U S t\\<^sub>0 G\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule wp_g_orbital_inv[OF assms(1) _ assms(3)])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<subseteq> wp x\\<acute>=f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>", "unfolding wp_diff_inv"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I f U S t\\<^sub>0 G", "using assms(2)"], ["proof (prove)\nusing this:\n  diff_invariant I f U S t\\<^sub>0 G\n\ngoal (1 subgoal):\n 1. diff_invariant I f U S t\\<^sub>0 G", "."], ["", "end"]]}