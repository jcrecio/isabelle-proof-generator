{"file_name": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs/ModalKleeneAlgebra/HS_VC_MKA_ndfun.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Hybrid_Systems_VCs", "problem_names": ["lemma nd_fun_ad_zero[nd_fun_ka]: \"ad x \\<cdot> x = 0\"\n  and nd_fun_ad[nd_fun_ka]: \"ad (x \\<cdot> y) + ad (x \\<cdot> ad (ad y)) = ad (x \\<cdot> ad (ad y))\"\n  and nd_fun_ad_one[nd_fun_ka]: \"ad (ad x) + ad x = 1\" for x::\"'a nd_fun\"", "lemma p2ndf_simps[simp]: \n  \"\\<lceil>P\\<rceil> \\<le> \\<lceil>Q\\<rceil> = (\\<forall>s. P s \\<longrightarrow> Q s)\"\n  \"(\\<lceil>P\\<rceil> = \\<lceil>Q\\<rceil>) = (\\<forall>s. P s = Q s)\"\n  \"(\\<lceil>P\\<rceil> \\<cdot> \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<and> Q s\\<rceil>\"\n  \"(\\<lceil>P\\<rceil> + \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<or> Q s\\<rceil>\"\n  \"ad \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<not> P s\\<rceil>\"\n  \"d \\<lceil>P\\<rceil> = \\<lceil>P\\<rceil>\" \"\\<lceil>P\\<rceil> \\<le> \\<eta>\\<^sup>\\<bullet>\"", "lemma wp_nd_fun: \"wp F \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>s'. s' \\<in> ((F\\<^sub>\\<bullet>) s) \\<longrightarrow> P s'\\<rceil>\"", "lemma wp_test[simp]: \"wp \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. P s \\<longrightarrow> Q s\\<rceil>\"", "lemma wp_assign[simp]: \"wp (x ::= e) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. Q (\\<chi> j. ((($) s)(x := (e s))) j)\\<rceil>\"", "lemma wp_nondet_assign[simp]: \"wp (x ::= ?) \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi> j. ((($) s)(x := k)) j)\\<rceil>\"", "lemma le_wp_choice_iff: \"\\<lceil>P\\<rceil> \\<le> wp (X + Y) \\<lceil>Q\\<rceil> \\<longleftrightarrow> \\<lceil>P\\<rceil> \\<le> wp X \\<lceil>Q\\<rceil> \\<and> \\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>Q\\<rceil>\"", "lemma change_loopI: \"LOOP X INV G = LOOP X INV I\"", "lemma wp_loopI: \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp R \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (LOOP R INV I) \\<lceil>Q\\<rceil>\"", "lemma wp_loopI_break: \n  \"\\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp X \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>  \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (Y ; (LOOP X INV I)) \\<lceil>Q\\<rceil>\"", "lemma wp_g_dyn[simp]: \n  fixes \\<phi> :: \"('a::preorder) \\<Rightarrow> 'b \\<Rightarrow> 'b\"\n  shows \"wp (EVOL \\<phi> G U) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\"", "lemma wp_g_orbital: \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>= \n  \\<lceil>\\<lambda>s. \\<forall>X\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>)) \\<longrightarrow> Q (X t)\\<rceil>\"", "lemma wp_g_ode_subset: \n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"wp (x\\<acute>= (\\<lambda>t. f) & G on U S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\"", "lemma wp_g_ode: \"wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. T) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>T. (\\<forall>\\<tau>\\<in>down T t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\"", "lemma wp_g_ode_ivl: \"t \\<ge> 0 \\<Longrightarrow> t \\<in> T \\<Longrightarrow> wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. {0..t}) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>{0..t}. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\"", "lemma wp_orbit: \"wp (\\<gamma>\\<^sup>\\<phi>\\<^sup>\\<bullet>) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda> s. s \\<in> S \\<longrightarrow> (\\<forall> t \\<in> T. Q (\\<phi> t s))\\<rceil>\"", "lemma wp_g_orbital_guard: \n  assumes \"H = (\\<lambda>s. G s \\<and> Q s)\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>H\\<rceil>\"", "lemma wp_g_orbital_inv:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma wp_diff_inv[simp]: \"(\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>) = diff_invariant I f U S t\\<^sub>0 G\"", "lemma diff_inv_guard_ignore:\n  assumes \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. True) on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\"\n  shows \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\"", "lemma wp_diff_inv_eq: \n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"diff_invariant I (\\<lambda>t. f) U S 0 (\\<lambda>s. True) = \n  (\\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil> = wp (x\\<acute>= (\\<lambda>t. f) & (\\<lambda>s. True) on U S @ 0) \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil>)\"", "lemma diff_inv_eq_inv_set:\n  \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. T) S 0 (\\<lambda>s. True) = (\\<forall>s. I s \\<longrightarrow> \\<gamma>\\<^sup>\\<phi> s \\<subseteq> {s. I s})\"", "lemma wp_g_odei: \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow>\n  \\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0 DINV I) \\<lceil>Q\\<rceil>\"", "lemma diff_solve_axiom1: \n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\"", "lemma diff_solve_axiom2: \n  fixes c::\"'a::{heine_borel, banach}\"\n  shows \"wp (x\\<acute>=(\\<lambda>s. c) & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow> Q (s + t *\\<^sub>R c)\\<rceil>\"", "lemma diff_solve_rule:\n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n    and \"\\<forall>s. P s \\<longrightarrow> (\\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil>\"", "lemma diff_weak_axiom1: \"\\<eta>\\<^sup>\\<bullet> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>G\\<rceil>\"", "lemma diff_weak_axiom2: \n  \"wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>\\<lambda> s. G s \\<longrightarrow> Q s\\<rceil>\"", "lemma diff_weak_rule: \n  assumes \"\\<lceil>G\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma wp_g_orbit_IdD:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = \\<eta>\\<^sup>\\<bullet>\"\n    and \"\\<forall>\\<tau>\\<in>(down (U s) t). x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\"\n  shows \"\\<forall>\\<tau>\\<in>(down (U s) t). C (x \\<tau>)\"", "lemma diff_cut_axiom:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = \\<eta>\\<^sup>\\<bullet>\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma diff_cut_rule:\n  assumes wp_C: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil>\"\n    and wp_Q: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"", "lemma diff_inv_axiom1:\n  assumes \"G s \\<longrightarrow> I s\" and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. t \\<ge> 0}) UNIV 0 G\"\n  shows \"s \\<in> ((wp (x\\<acute>= f & G) \\<lceil>I\\<rceil>)\\<^sub>\\<bullet>) s\"", "lemma diff_inv_axiom2:\n  assumes \"picard_lindeloef (\\<lambda>t. f) UNIV UNIV 0\"\n    and \"\\<And>s. {t::real. t \\<ge> 0} \\<subseteq> picard_lindeloef.ex_ivl (\\<lambda>t. f) UNIV UNIV 0 s\"\n    and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t::real. t \\<ge> 0}) UNIV 0 G\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>I\\<rceil> = wp \\<lceil>G\\<rceil> \\<lceil>I\\<rceil>\"", "lemma diff_inv_rule:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"diff_invariant I f U S t\\<^sub>0 G\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], "translations": [["", "lemma nd_fun_ad_zero[nd_fun_ka]: \"ad x \\<cdot> x = 0\"\n  and nd_fun_ad[nd_fun_ka]: \"ad (x \\<cdot> y) + ad (x \\<cdot> ad (ad y)) = ad (x \\<cdot> ad (ad y))\"\n  and nd_fun_ad_one[nd_fun_ka]: \"ad (ad x) + ad x = 1\" for x::\"'a nd_fun\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ad x \\<cdot> x = 0 &&&\n    ad (x \\<cdot> y) + ad (x \\<cdot> ad (ad y)) =\n    ad (x \\<cdot> ad (ad y)) &&&\n    ad (ad x) + ad x = 1", "unfolding antidomain_op_nd_fun_def times_nd_fun_def plus_nd_fun_def zero_nd_fun_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. id (\\<lambda>f g.\n           (f\\<^sub>\\<bullet> \\<circ>\\<^sub>K\n            g\\<^sub>\\<bullet>)\\<^sup>\\<bullet>)\n     ((\\<lambda>s.\n          if (x\\<^sub>\\<bullet>) s = {} then \\<eta> s\n          else {})\\<^sup>\\<bullet>)\n     x =\n    \\<zeta>\\<^sup>\\<bullet> &&&\n    (((\\<lambda>s.\n          if (id (\\<lambda>f g.\n                     (f\\<^sub>\\<bullet> \\<circ>\\<^sub>K\n                      g\\<^sub>\\<bullet>)\\<^sup>\\<bullet>)\n               x y\\<^sub>\\<bullet>)\n              s =\n             {}\n          then \\<eta> s else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet> \\<squnion>\n     ((\\<lambda>s.\n          if (id (\\<lambda>f g.\n                     (f\\<^sub>\\<bullet> \\<circ>\\<^sub>K\n                      g\\<^sub>\\<bullet>)\\<^sup>\\<bullet>)\n               x ((\\<lambda>s.\n                      if (((\\<lambda>s.\n                               if (y\\<^sub>\\<bullet>) s = {} then \\<eta> s\n                               else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                          s =\n                         {}\n                      then \\<eta> s\n                      else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n              s =\n             {}\n          then \\<eta> s\n          else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\\<^sup>\\<bullet> =\n    (\\<lambda>s.\n        if (id (\\<lambda>f g.\n                   (f\\<^sub>\\<bullet> \\<circ>\\<^sub>K\n                    g\\<^sub>\\<bullet>)\\<^sup>\\<bullet>)\n             x ((\\<lambda>s.\n                    if (((\\<lambda>s.\n                             if (y\\<^sub>\\<bullet>) s = {} then \\<eta> s\n                             else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                        s =\n                       {}\n                    then \\<eta> s else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n            s =\n           {}\n        then \\<eta> s else {})\\<^sup>\\<bullet> &&&\n    (((\\<lambda>s.\n          if (((\\<lambda>s.\n                   if (x\\<^sub>\\<bullet>) s = {} then \\<eta> s\n                   else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n              s =\n             {}\n          then \\<eta> s else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet> \\<squnion>\n     ((\\<lambda>s.\n          if (x\\<^sub>\\<bullet>) s = {} then \\<eta> s\n          else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\\<^sup>\\<bullet> =\n    1", "by (auto simp: nd_fun_eq_iff kcomp_def one_nd_fun_def)"], ["", "instance"], ["proof (prove)\ngoal (1 subgoal):\n 1. OFCLASS('a nd_fun, antidomain_kleene_algebra_class)", "apply intro_classes"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x. ad x \\<cdot> x = 0\n 2. \\<And>x y.\n       ad (x \\<cdot> y) + ad (x \\<cdot> ad (ad y)) =\n       ad (x \\<cdot> ad (ad y))\n 3. \\<And>x. ad (ad x) + ad x = 1", "using nd_fun_ka"], ["proof (prove)\nusing this:\n  ?x + ?y + ?z = ?x + (?y + ?z)\n  ?x + ?y = ?y + ?x\n  ?x + ?x = ?x\n  (?x + ?y) \\<cdot> ?z = ?x \\<cdot> ?z + ?y \\<cdot> ?z\n  ?x \\<cdot> (?y + ?z) = ?x \\<cdot> ?y + ?x \\<cdot> ?z\n  0 + ?x = ?x\n  0 \\<cdot> ?x = 0\n  ?x \\<cdot> 0 = 0\n  (?x \\<le> ?y) = (?x + ?y = ?y)\n  (?x < ?y) = (?x + ?y = ?y \\<and> ?x \\<noteq> ?y)\n  ?z \\<cdot> ?x \\<le> ?z \\<cdot> (?x + ?y)\n  1 + ?x \\<cdot> ?x\\<^sup>\\<star> \\<le> ?x\\<^sup>\\<star>\n  ?z + ?x \\<cdot> ?y \\<le> ?y \\<Longrightarrow>\n  ?x\\<^sup>\\<star> \\<cdot> ?z \\<le> ?y\n  ?z + ?y \\<cdot> ?x \\<le> ?y \\<Longrightarrow>\n  ?z \\<cdot> ?x\\<^sup>\\<star> \\<le> ?y\n  ad ?x \\<cdot> ?x = 0\n  ad (?x \\<cdot> ?y) + ad (?x \\<cdot> ad (ad ?y)) =\n  ad (?x \\<cdot> ad (ad ?y))\n  ad (ad ?x) + ad ?x = 1\n\ngoal (3 subgoals):\n 1. \\<And>x. ad x \\<cdot> x = 0\n 2. \\<And>x y.\n       ad (x \\<cdot> y) + ad (x \\<cdot> ad (ad y)) =\n       ad (x \\<cdot> ad (ad y))\n 3. \\<And>x. ad (ad x) + ad x = 1", "by simp_all"], ["", "end"], ["", "subsubsection \\<open> Regular programs\\<close>"], ["", "text\\<open> Now that we know that non-deterministic functions form an Antidomain Kleene Algebra, we give\n a lifting operation from predicates to @{typ \"'a nd_fun\"} and use it to compute weakest liberal\npreconditions.\\<close>"], ["", "type_synonym 'a pred = \"'a \\<Rightarrow> bool\""], ["", "notation fbox (\"wp\")"], ["", "no_notation Archimedean_Field.ceiling (\"\\<lceil>_\\<rceil>\")\n        and Relation.relcomp (infixl \";\" 75)\n        and Range_Semiring.antirange_semiring_class.ars_r (\"r\")\n        and antidomain_semiringl.ads_d (\"d\")"], ["", "abbreviation p2ndf :: \"'a pred \\<Rightarrow> 'a nd_fun\" (\"(1\\<lceil>_\\<rceil>)\")\n  where \"\\<lceil>Q\\<rceil> \\<equiv> (\\<lambda> x::'a. {s::'a. s = x \\<and> Q s})\\<^sup>\\<bullet>\""], ["", "lemma p2ndf_simps[simp]: \n  \"\\<lceil>P\\<rceil> \\<le> \\<lceil>Q\\<rceil> = (\\<forall>s. P s \\<longrightarrow> Q s)\"\n  \"(\\<lceil>P\\<rceil> = \\<lceil>Q\\<rceil>) = (\\<forall>s. P s = Q s)\"\n  \"(\\<lceil>P\\<rceil> \\<cdot> \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<and> Q s\\<rceil>\"\n  \"(\\<lceil>P\\<rceil> + \\<lceil>Q\\<rceil>) = \\<lceil>\\<lambda> s. P s \\<or> Q s\\<rceil>\"\n  \"ad \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<not> P s\\<rceil>\"\n  \"d \\<lceil>P\\<rceil> = \\<lceil>P\\<rceil>\" \"\\<lceil>P\\<rceil> \\<le> \\<eta>\\<^sup>\\<bullet>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lceil>P\\<rceil> \\<le> \\<lceil>Q\\<rceil>) =\n     (\\<forall>s. P s \\<longrightarrow> Q s) &&&\n     (\\<lceil>P\\<rceil> = \\<lceil>Q\\<rceil>) = (\\<forall>s. P s = Q s) &&&\n     \\<lceil>P\\<rceil> \\<cdot> \\<lceil>Q\\<rceil> =\n     \\<lceil>\\<lambda>s. P s \\<and> Q s\\<rceil>) &&&\n    (\\<lceil>P\\<rceil> + \\<lceil>Q\\<rceil> =\n     \\<lceil>\\<lambda>s. P s \\<or> Q s\\<rceil> &&&\n     ad \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<not> P s\\<rceil>) &&&\n    d \\<lceil>P\\<rceil> = \\<lceil>P\\<rceil> &&&\n    \\<lceil>P\\<rceil> \\<le> \\<eta>\\<^sup>\\<bullet>", "unfolding less_eq_nd_fun_def times_nd_fun_def plus_nd_fun_def ads_d_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (id (\\<lambda>f g. f\\<^sub>\\<bullet> \\<le> g\\<^sub>\\<bullet>)\n      \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> =\n     (\\<forall>s. P s \\<longrightarrow> Q s) &&&\n     (\\<lceil>P\\<rceil> = \\<lceil>Q\\<rceil>) = (\\<forall>s. P s = Q s) &&&\n     id (\\<lambda>f g.\n            (f\\<^sub>\\<bullet> \\<circ>\\<^sub>K\n             g\\<^sub>\\<bullet>)\\<^sup>\\<bullet>)\n      \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> =\n     \\<lceil>\\<lambda>s. P s \\<and> Q s\\<rceil>) &&&\n    ((\\<lceil>P\\<rceil>\\<^sub>\\<bullet> \\<squnion>\n      \\<lceil>Q\\<rceil>\\<^sub>\\<bullet>)\\<^sup>\\<bullet> =\n     \\<lceil>\\<lambda>s. P s \\<or> Q s\\<rceil> &&&\n     ad \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<not> P s\\<rceil>) &&&\n    ad (ad \\<lceil>P\\<rceil>) = \\<lceil>P\\<rceil> &&&\n    id (\\<lambda>f g. f\\<^sub>\\<bullet> \\<le> g\\<^sub>\\<bullet>)\n     \\<lceil>P\\<rceil> (\\<eta>\\<^sup>\\<bullet>)", "by (auto simp: nd_fun_eq_iff kcomp_def le_fun_def antidomain_op_nd_fun_def)"], ["", "text \\<open> Lemmas for verification condition generation \\<close>"], ["", "lemma wp_nd_fun: \"wp F \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>s'. s' \\<in> ((F\\<^sub>\\<bullet>) s) \\<longrightarrow> P s'\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp F \\<lceil>P\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>s'.\n                  s2p ((F\\<^sub>\\<bullet>) s) s' \\<longrightarrow>\n                  P s'\\<rceil>", "apply(simp add: fbox_def antidomain_op_nd_fun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>s.\n        if ((F \\<cdot>\n             (\\<lambda>s.\n                 if \\<not> P s then \\<eta> s\n                 else {})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n            s =\n           {}\n        then \\<eta> s else {})\\<^sup>\\<bullet> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>s'.\n                  s2p ((F\\<^sub>\\<bullet>) s) s' \\<longrightarrow>\n                  P s'\\<rceil>", "by(rule nd_fun_ext, auto simp: Rep_comp_hom kcomp_prop)\n\n\\<comment> \\<open> Skip \\<close>"], ["", "abbreviation skip :: \"'a nd_fun\"\n  where \"skip \\<equiv> 1\"\n\n\\<comment> \\<open> Tests \\<close>"], ["", "lemma wp_test[simp]: \"wp \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. P s \\<longrightarrow> Q s\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp \\<lceil>P\\<rceil> \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s. P s \\<longrightarrow> Q s\\<rceil>", "by (subst wp_nd_fun, simp)\n\n\\<comment> \\<open> Assignments \\<close>"], ["", "definition assign :: \"'b \\<Rightarrow> ('a^'b \\<Rightarrow> 'a) \\<Rightarrow> ('a^'b) nd_fun\" (\"(2_ ::= _)\" [70, 65] 61) \n  where \"(x ::= e) = (\\<lambda>s. {vec_upd s x (e s)})\\<^sup>\\<bullet>\""], ["", "lemma wp_assign[simp]: \"wp (x ::= e) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. Q (\\<chi> j. ((($) s)(x := (e s))) j)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (x ::= e) \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s. Q (\\<chi>j. ((($) s)(x := e s)) j)\\<rceil>", "unfolding wp_nd_fun nd_fun_eq_iff vec_upd_def assign_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>xa.\n       (\\<lceil>\\<lambda>s.\n                   \\<forall>s'.\n                      s2p ((((\\<lambda>s.\n                                 \\<eta>\n                                  (vec_lambda\n                                    ((($) s)\n                                     (x :=\n  e s))))\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                            s)\n                       s' \\<longrightarrow>\n                      Q s'\\<rceil>\\<^sub>\\<bullet>)\n        xa =\n       (\\<lceil>\\<lambda>s.\n                   Q (vec_lambda\n                       ((($) s)(x := e s)))\\<rceil>\\<^sub>\\<bullet>)\n        xa", "by auto\n\n\\<comment> \\<open> Nondeterministic assignments \\<close>"], ["", "definition nondet_assign :: \"'b \\<Rightarrow> ('a^'b) nd_fun\" (\"(2_ ::= ? )\" [70] 61)\n  where \"(x ::= ?) = (\\<lambda>s. {(vec_upd s x k)|k. True})\\<^sup>\\<bullet>\""], ["", "lemma wp_nondet_assign[simp]: \"wp (x ::= ?) \\<lceil>P\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi> j. ((($) s)(x := k)) j)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (x ::= ? ) \\<lceil>P\\<rceil> =\n    \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi>j. ((($) s)(x := k)) j)\\<rceil>", "unfolding wp_nd_fun nondet_assign_def vec_upd_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>s'.\n                  s2p ((((\\<lambda>s.\n                             {\\<chi>j. if j = x then k else s $ j |k.\n                              True})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                        s)\n                   s' \\<longrightarrow>\n                  P s'\\<rceil> =\n    \\<lceil>\\<lambda>s. \\<forall>k. P (\\<chi>j. ((($) s)(x := k)) j)\\<rceil>", "apply(clarsimp, safe)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s k.\n       \\<forall>s'.\n          (\\<exists>k.\n              s' = (\\<chi>j. if j = x then k else s $ j)) \\<longrightarrow>\n          P s' \\<Longrightarrow>\n       P (\\<chi>j. if j = x then k else s $ j)\n 2. \\<And>s s' k.\n       \\<forall>k. P (\\<chi>j. if j = x then k else s $ j) \\<Longrightarrow>\n       P (\\<chi>j. if j = x then k else s $ j)", "by (erule_tac x=\"(\\<chi> j. if j = x then k else s $ j)\" in allE, auto)\n\n\\<comment> \\<open> Nondeterministic choice \\<close>"], ["", "lemma le_wp_choice_iff: \"\\<lceil>P\\<rceil> \\<le> wp (X + Y) \\<lceil>Q\\<rceil> \\<longleftrightarrow> \\<lceil>P\\<rceil> \\<le> wp X \\<lceil>Q\\<rceil> \\<and> \\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>P\\<rceil> \\<le> wp (X + Y) \\<lceil>Q\\<rceil>) =\n    (\\<lceil>P\\<rceil> \\<le> wp X \\<lceil>Q\\<rceil> \\<and>\n     \\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>Q\\<rceil>)", "using le_fbox_choice_iff[of \"\\<lceil>P\\<rceil>\"]"], ["proof (prove)\nusing this:\n  (d \\<lceil>P\\<rceil> \\<le> wp (?x + ?y) ?q) =\n  (d \\<lceil>P\\<rceil> \\<le> wp ?x ?q \\<and>\n   d \\<lceil>P\\<rceil> \\<le> wp ?y ?q)\n\ngoal (1 subgoal):\n 1. (\\<lceil>P\\<rceil> \\<le> wp (X + Y) \\<lceil>Q\\<rceil>) =\n    (\\<lceil>P\\<rceil> \\<le> wp X \\<lceil>Q\\<rceil> \\<and>\n     \\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>Q\\<rceil>)", "by simp\n\n\\<comment> \\<open> Sequential composition \\<close>"], ["", "abbreviation seq_comp :: \"'a nd_fun \\<Rightarrow> 'a nd_fun \\<Rightarrow> 'a nd_fun\" (infixl \";\" 75)\n  where \"f ; g \\<equiv> f \\<cdot> g\"\n\n\\<comment> \\<open> Conditional statement \\<close>"], ["", "abbreviation cond_sugar :: \"'a pred \\<Rightarrow> 'a nd_fun \\<Rightarrow> 'a nd_fun \\<Rightarrow> 'a nd_fun\" (\"IF _ THEN _ ELSE _\" [64,64] 63) \n  where \"IF P THEN X ELSE Y \\<equiv> aka_cond \\<lceil>P\\<rceil> X Y\"\n\n\\<comment> \\<open> Finite iteration \\<close>"], ["", "abbreviation loopi_sugar :: \"'a nd_fun \\<Rightarrow> 'a pred \\<Rightarrow> 'a nd_fun\" (\"LOOP _ INV _ \" [64,64] 63)\n  where \"LOOP R INV I \\<equiv> aka_loopi R \\<lceil>I\\<rceil>\""], ["", "lemma change_loopI: \"LOOP X INV G = LOOP X INV I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LOOP X INV G  = LOOP X INV I", "by (unfold aka_loopi_def, simp)"], ["", "lemma wp_loopI: \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp R \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (LOOP R INV I) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> wp R \\<lceil>I\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<le> wp (LOOP R INV I ) \\<lceil>Q\\<rceil>", "using fbox_loopi[of \"\\<lceil>P\\<rceil>\"]"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<lceil>P\\<rceil> \\<le> d ?i; d ?i \\<le> wp ?x ?i;\n   d ?i \\<le> d ?q\\<rbrakk>\n  \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (loop ?x inv ?i ) ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> wp R \\<lceil>I\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<le> wp (LOOP R INV I ) \\<lceil>Q\\<rceil>", "by auto"], ["", "lemma wp_loopI_break: \n  \"\\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp X \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>  \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (Y ; (LOOP X INV I)) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> wp X \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<le> wp (Y ; (LOOP X INV I )) \\<lceil>Q\\<rceil>", "using fbox_loopi_break[of \"\\<lceil>P\\<rceil>\"]"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<lceil>P\\<rceil> \\<le> wp ?y (d ?i); d ?i \\<le> wp ?x ?i;\n   d ?i \\<le> d ?q\\<rbrakk>\n  \\<Longrightarrow> \\<lceil>P\\<rceil> \\<le> wp (?y ; (loop ?x inv ?i )) ?q\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> wp Y \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> wp X \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<le> wp (Y ; (LOOP X INV I )) \\<lceil>Q\\<rceil>", "by auto"], ["", "subsubsection \\<open> Evolution commands \\<close>"], ["", "text  \\<open>Verification by providing evolution\\<close>"], ["", "definition g_evol :: \"(('a::ord) \\<Rightarrow> 'b \\<Rightarrow> 'b) \\<Rightarrow> 'b pred \\<Rightarrow> ('b \\<Rightarrow> 'a set) \\<Rightarrow> 'b nd_fun\" (\"EVOL\")\n  where \"EVOL \\<phi> G T = (\\<lambda>s. g_orbit (\\<lambda>t. \\<phi> t s) G (T s))\\<^sup>\\<bullet>\""], ["", "lemma wp_g_dyn[simp]: \n  fixes \\<phi> :: \"('a::preorder) \\<Rightarrow> 'b \\<Rightarrow> 'b\"\n  shows \"wp (EVOL \\<phi> G U) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda>s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (EVOL \\<phi> G U) \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<in>U s.\n                  (\\<forall>\\<tau>\\<in>down (U s) t.\n                      G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                  Q (\\<phi> t s)\\<rceil>", "unfolding wp_nd_fun g_evol_def g_orbit_eq"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>s'.\n                  s2p ((((\\<lambda>s.\n                             {\\<phi> t s |t.\n                              s2p (U s) t \\<and>\n                              (\\<forall>\\<tau>\\<in>down (U s) t.\n                                  G (\\<phi> \\<tau>\ns))})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                        s)\n                   s' \\<longrightarrow>\n                  Q s'\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<in>U s.\n                  (\\<forall>\\<tau>\\<in>down (U s) t.\n                      G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                  Q (\\<phi> t s)\\<rceil>", "by (auto simp: fun_eq_iff)"], ["", "text \\<open>Verification by providing solutions\\<close>"], ["", "definition g_ode ::\"(real \\<Rightarrow> ('a::banach) \\<Rightarrow> 'a) \\<Rightarrow> 'a pred \\<Rightarrow> ('a \\<Rightarrow> real set) \\<Rightarrow> 'a set \\<Rightarrow> \n  real \\<Rightarrow> 'a nd_fun\" (\"(1x\\<acute>= _ & _ on _ _ @ _)\") \n  where \"(x\\<acute>= f & G on U S @ t\\<^sub>0) \\<equiv> (\\<lambda> s. g_orbital f G U S t\\<^sub>0 s)\\<^sup>\\<bullet>\""], ["", "lemma wp_g_orbital: \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>= \n  \\<lceil>\\<lambda>s. \\<forall>X\\<in>Sols f U S t\\<^sub>0 s. \\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (X \\<tau>)) \\<longrightarrow> Q (X t)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil>", "unfolding g_orbital_eq(1) wp_nd_fun g_ode_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>s'.\n                  s2p ((((\\<lambda>s.\n                             {X t |t X.\n                              s2p (U s) t \\<and>\n                              \\<P> X (down (U s) t)\n                              \\<subseteq> Collect G \\<and>\n                              s2p (Sols f U S t\\<^sub>0 s)\n                               X})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                        s)\n                   s' \\<longrightarrow>\n                  Q s'\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil>", "by (auto simp: fun_eq_iff)"], ["", "context local_flow\nbegin"], ["", "lemma wp_g_ode_subset: \n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"wp (x\\<acute>= (\\<lambda>t. f) & G on U S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>U s. (\\<forall>\\<tau>\\<in>down (U s) t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= \\<lambda>t. f & G on U S @ 0 \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s2p S s \\<longrightarrow>\n               (\\<forall>t\\<in>U s.\n                   (\\<forall>\\<tau>\\<in>down (U s) t.\n                       G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                   Q (\\<phi> t s))\\<rceil>", "apply(unfold wp_g_orbital, clarsimp, rule iffI; clarify)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s t.\n       \\<lbrakk>\\<forall>X\\<in>Sols (\\<lambda>t. f) U S 0 s.\n                   \\<forall>t\\<in>U s.\n                      (\\<forall>\\<tau>.\n                          s2p (U s) \\<tau> \\<and>\n                          \\<tau> \\<le> t \\<longrightarrow>\n                          G (X \\<tau>)) \\<longrightarrow>\n                      Q (X t);\n        s2p S s; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (\\<phi> \\<tau> s)\\<rbrakk>\n       \\<Longrightarrow> Q (\\<phi> t s)\n 2. \\<And>s X t.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "apply(force simp: in_ivp_sols assms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "apply(frule ivp_solsD(2), frule ivp_solsD(3), frule ivp_solsD(4))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s X t.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "apply(subgoal_tac \"\\<forall>\\<tau>\\<in>down (U s) t. X \\<tau> = \\<phi> \\<tau> s\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s X t.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        \\<forall>\\<tau>\\<in>down (U s) t.\n           X \\<tau> = \\<phi> \\<tau> s\\<rbrakk>\n       \\<Longrightarrow> Q (X t)\n 2. \\<And>s X t.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>\\<in>down (U s) t.\n                            X \\<tau> = \\<phi> \\<tau> s", "apply(clarsimp, fastforce, rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> X \\<tau> = \\<phi> \\<tau> s", "apply(rule ivp_unique_solution[OF _ _ _ _ _ in_ivp_sols])"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p S s\n 2. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> is_interval (?U74 s X t \\<tau> s)\n 3. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T\n 4. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p (?U74 s X t \\<tau> s) \\<tau>\n 5. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p (Sols (\\<lambda>t. f) (?U74 s X t \\<tau>) S 0\n                               s)\n                          X\n 6. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p S s\n 7. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p (?U74 s X t \\<tau> s) 0\n 8. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T", "using assms"], ["proof (prove)\nusing this:\n  s2p S ?s \\<Longrightarrow>\n  s2p (U ?s) 0 \\<and> is_interval (U ?s) \\<and> U ?s \\<subseteq> T\n\ngoal (8 subgoals):\n 1. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p S s\n 2. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> is_interval (?U74 s X t \\<tau> s)\n 3. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T\n 4. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p (?U74 s X t \\<tau> s) \\<tau>\n 5. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p (Sols (\\<lambda>t. f) (?U74 s X t \\<tau>) S 0\n                               s)\n                          X\n 6. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p S s\n 7. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> s2p (?U74 s X t \\<tau> s) 0\n 8. \\<And>s X t \\<tau>.\n       \\<lbrakk>s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>.\n                        s2p (U s) \\<tau> \\<and>\n                        \\<tau> \\<le> t \\<longrightarrow>\n                        G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                    Q (\\<phi> t s));\n        s2p (Sols (\\<lambda>t. f) U S 0 s) X; s2p (U s) t;\n        \\<forall>\\<tau>.\n           s2p (U s) \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        X 0 = s; s2p (U s \\<rightarrow> S) X; s2p (U s) 0;\n        s2p (down (U s) t) \\<tau>\\<rbrakk>\n       \\<Longrightarrow> ?U74 s X t \\<tau> s \\<subseteq> T", "by auto"], ["", "lemma wp_g_ode: \"wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. T) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>T. (\\<forall>\\<tau>\\<in>down T t. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= \\<lambda>t. f & G on \\<lambda>s. T S @ 0\n     \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s2p S s \\<longrightarrow>\n               (\\<forall>t\\<in>T.\n                   (\\<forall>\\<tau>\\<in>down T t.\n                       G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                   Q (\\<phi> t s))\\<rceil>", "by (subst wp_g_ode_subset, simp_all add: init_time interval_time)"], ["", "lemma wp_g_ode_ivl: \"t \\<ge> 0 \\<Longrightarrow> t \\<in> T \\<Longrightarrow> wp (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. {0..t}) S @ 0) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> (\\<forall>t\\<in>{0..t}. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> t; s2p T t\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>= \\<lambda>t.\n f & G on \\<lambda>s. {0..t} S @ 0\n                       \\<lceil>Q\\<rceil> =\n                      \\<lceil>\\<lambda>s.\n                                 s2p S s \\<longrightarrow>\n                                 (\\<forall>t\\<in>{0..t}.\n                                     (\\<forall>\\<tau>\\<in>{0..t}.\n   G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                                     Q (\\<phi> t s))\\<rceil>", "apply(subst wp_g_ode_subset, simp_all add: subintervalI init_time real_Icc_closed_segment)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> t; s2p T t\\<rbrakk>\n    \\<Longrightarrow> \\<forall>s.\n                         (s2p S s \\<longrightarrow>\n                          (\\<forall>ta\\<in>{0--t}.\n                              (\\<forall>\\<tau>.\n                                  s2p {0--t} \\<tau> \\<and>\n                                  \\<tau> \\<le> ta \\<longrightarrow>\n                                  G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                              Q (\\<phi> ta s))) =\n                         (s2p S s \\<longrightarrow>\n                          (\\<forall>t\\<in>{0--t}.\n                              (\\<forall>\\<tau>\\<in>{0..t}.\n                                  G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                              Q (\\<phi> t s)))", "by (auto simp: closed_segment_eq_real_ivl)"], ["", "lemma wp_orbit: \"wp (\\<gamma>\\<^sup>\\<phi>\\<^sup>\\<bullet>) \\<lceil>Q\\<rceil> = \\<lceil>\\<lambda> s. s \\<in> S \\<longrightarrow> (\\<forall> t \\<in> T. Q (\\<phi> t s))\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (\\<gamma>\\<^sup>\\<phi>\\<^sup>\\<bullet>) \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s2p S s \\<longrightarrow>\n               (\\<forall>t\\<in>T. Q (\\<phi> t s))\\<rceil>", "unfolding orbit_def wp_g_ode g_ode_def[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               s2p S s \\<longrightarrow>\n               (\\<forall>t\\<in>T.\n                   (\\<forall>\\<tau>\\<in>down T t. True) \\<longrightarrow>\n                   Q (\\<phi> t s))\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               s2p S s \\<longrightarrow>\n               (\\<forall>t\\<in>T. Q (\\<phi> t s))\\<rceil>", "by auto"], ["", "end"], ["", "text \\<open> Verification with differential invariants \\<close>"], ["", "definition g_ode_inv :: \"(real \\<Rightarrow> ('a::banach)\\<Rightarrow>'a) \\<Rightarrow> 'a pred \\<Rightarrow> ('a \\<Rightarrow> real set) \\<Rightarrow> 'a set \\<Rightarrow> \n  real \\<Rightarrow> 'a pred \\<Rightarrow> 'a nd_fun\" (\"(1x\\<acute>=_ & _ on _ _ @ _ DINV _ )\") \n  where \"(x\\<acute>= f & G on U S @ t\\<^sub>0 DINV I) = (x\\<acute>= f & G on U S @ t\\<^sub>0)\""], ["", "lemma wp_g_orbital_guard: \n  assumes \"H = (\\<lambda>s. G s \\<and> Q s)\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>H\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>H\\<rceil>", "unfolding wp_g_orbital"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     H (X t)\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  H = (\\<lambda>s. G s \\<and> Q s)\n\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                  \\<forall>t\\<in>U s.\n                     (\\<forall>\\<tau>\\<in>down (U s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     H (X t)\\<rceil>", "by auto"], ["", "lemma wp_g_orbital_inv:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "using assms(1)"], ["proof (prove)\nusing this:\n  \\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule order.trans)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<lceil>I\\<rceil>\n  \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule order.trans)"], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule fbox_iso)"], ["proof (prove)\ngoal (1 subgoal):\n 1. d \\<lceil>I\\<rceil> \\<le> d \\<lceil>Q\\<rceil>", "using assms(3)"], ["proof (prove)\nusing this:\n  \\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\n\ngoal (1 subgoal):\n 1. d \\<lceil>I\\<rceil> \\<le> d \\<lceil>Q\\<rceil>", "by auto"], ["", "lemma wp_diff_inv[simp]: \"(\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>) = diff_invariant I f U S t\\<^sub>0 G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>) =\n    diff_invariant I f U S t\\<^sub>0 G", "unfolding diff_invariant_eq wp_g_orbital"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<le> \\<lceil>\\<lambda>s.\n                      \\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n                         \\<forall>t\\<in>U s.\n                            (\\<forall>\\<tau>\\<in>down (U s) t.\n                                G (X \\<tau>)) \\<longrightarrow>\n                            I (X t)\\<rceil>) =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n            \\<forall>t\\<in>U s.\n               (\\<forall>\\<tau>\\<in>down (U s) t.\n                   G (X \\<tau>)) \\<longrightarrow>\n               I (X t)))", "by(auto simp: fun_eq_iff)"], ["", "lemma diff_inv_guard_ignore:\n  assumes \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. True) on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\"\n  shows \"\\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  \\<lceil>I\\<rceil>\n  \\<le> wp x\\<acute>= f & \\<lambda>s. True on U S @ t\\<^sub>0\n         \\<lceil>I\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>", "unfolding wp_diff_inv diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n         \\<forall>t\\<in>U s.\n            (\\<forall>\\<tau>\\<in>down (U s) t. True) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols f U S t\\<^sub>0 s.\n           \\<forall>t\\<in>U s.\n              (\\<forall>\\<tau>\\<in>down (U s) t.\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "by auto"], ["", "context local_flow\nbegin"], ["", "lemma wp_diff_inv_eq: \n  assumes \"\\<And>s. s \\<in> S \\<Longrightarrow> 0 \\<in> U s \\<and> is_interval (U s) \\<and> U s \\<subseteq> T\"\n  shows \"diff_invariant I (\\<lambda>t. f) U S 0 (\\<lambda>s. True) = \n  (\\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil> = wp (x\\<acute>= (\\<lambda>t. f) & (\\<lambda>s. True) on U S @ 0) \\<lceil>\\<lambda>s. s \\<in> S \\<longrightarrow> I s\\<rceil>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I (\\<lambda>t. f) U S 0 (\\<lambda>s. True) =\n    (\\<lceil>\\<lambda>s. s2p S s \\<longrightarrow> I s\\<rceil> =\n     wp x\\<acute>= \\<lambda>t. f & \\<lambda>s. True on U S @ 0\n      \\<lceil>\\<lambda>s. s2p S s \\<longrightarrow> I s\\<rceil>)", "unfolding wp_diff_inv[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<le> wp x\\<acute>= \\<lambda>t. f & \\<lambda>s. True on U S @ 0\n            \\<lceil>I\\<rceil>) =\n    (\\<lceil>\\<lambda>s. s2p S s \\<longrightarrow> I s\\<rceil> =\n     wp x\\<acute>= \\<lambda>t. f & \\<lambda>s. True on U S @ 0\n      \\<lceil>\\<lambda>s. s2p S s \\<longrightarrow> I s\\<rceil>)", "apply(subst wp_g_ode_subset[OF assms], simp)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lceil>I\\<rceil>\n     \\<le> \\<lceil>\\<lambda>s.\n                      s2p S s \\<longrightarrow>\n                      (\\<forall>t\\<in>U s.\n                          (\\<forall>\\<tau>\\<in>down (U s) t.\n                              True) \\<longrightarrow>\n                          I (\\<phi> t s))\\<rceil>) =\n    (\\<lceil>\\<lambda>s. s2p S s \\<longrightarrow> I s\\<rceil> =\n     \\<lceil>\\<lambda>s.\n                s2p S s \\<longrightarrow>\n                (\\<forall>t\\<in>U s.\n                    (\\<forall>\\<tau>\\<in>down (U s) t.\n                        True) \\<longrightarrow>\n                    s2p S (\\<phi> t s) \\<longrightarrow>\n                    I (\\<phi> t s))\\<rceil>)", "apply(clarsimp, safe, force)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s2p S s \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s2p S s;\n        \\<forall>t\\<in>U s.\n           s2p S (\\<phi> t s) \\<longrightarrow> I (\\<phi> t s)\\<rbrakk>\n       \\<Longrightarrow> I s\n 2. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s2p S s \\<longrightarrow> I s) =\n                   (s2p S s \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        s2p S (\\<phi> t s) \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s2p S s; s2p (U s) t\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "apply(erule_tac x=0 in ballE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s2p S s \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s2p S s;\n        s2p S (\\<phi> 0 s) \\<longrightarrow> I (\\<phi> 0 s)\\<rbrakk>\n       \\<Longrightarrow> I s\n 2. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s2p S s \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s2p S s; 0 \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I s\n 3. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s2p S s \\<longrightarrow> I s) =\n                   (s2p S s \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        s2p S (\\<phi> t s) \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s2p S s; s2p (U s) t\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "using init_time in_domain ivp(2) assms"], ["proof (prove)\nusing this:\n  s2p T 0\n  s2p S ?s \\<Longrightarrow>\n  s2p (T \\<rightarrow> S) (\\<lambda>t. \\<phi> t ?s)\n  s2p S ?s \\<Longrightarrow> \\<phi> 0 ?s = ?s\n  s2p S ?s \\<Longrightarrow>\n  s2p (U ?s) 0 \\<and> is_interval (U ?s) \\<and> U ?s \\<subseteq> T\n\ngoal (3 subgoals):\n 1. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s2p S s \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s2p S s;\n        s2p S (\\<phi> 0 s) \\<longrightarrow> I (\\<phi> 0 s)\\<rbrakk>\n       \\<Longrightarrow> I s\n 2. \\<And>s.\n       \\<lbrakk>\\<forall>s.\n                   I s \\<longrightarrow>\n                   s2p S s \\<longrightarrow>\n                   (\\<forall>t\\<in>U s. I (\\<phi> t s));\n        s2p S s; 0 \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I s\n 3. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s2p S s \\<longrightarrow> I s) =\n                   (s2p S s \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        s2p S (\\<phi> t s) \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s2p S s; s2p (U s) t\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "apply(force, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>\\<forall>s.\n                   (s2p S s \\<longrightarrow> I s) =\n                   (s2p S s \\<longrightarrow>\n                    (\\<forall>t\\<in>U s.\n                        s2p S (\\<phi> t s) \\<longrightarrow>\n                        I (\\<phi> t s)));\n        I s; s2p S s; s2p (U s) t\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "apply(erule_tac x=s in allE, clarsimp, erule_tac x=t in ballE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>s t.\n       \\<lbrakk>I s; s2p S s; s2p (U s) t;\n        s2p S (\\<phi> t s) \\<longrightarrow> I (\\<phi> t s)\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)\n 2. \\<And>s t.\n       \\<lbrakk>I s; s2p S s; s2p (U s) t; t \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "using in_domain ivp(2) assms"], ["proof (prove)\nusing this:\n  s2p S ?s \\<Longrightarrow>\n  s2p (T \\<rightarrow> S) (\\<lambda>t. \\<phi> t ?s)\n  s2p S ?s \\<Longrightarrow> \\<phi> 0 ?s = ?s\n  s2p S ?s \\<Longrightarrow>\n  s2p (U ?s) 0 \\<and> is_interval (U ?s) \\<and> U ?s \\<subseteq> T\n\ngoal (2 subgoals):\n 1. \\<And>s t.\n       \\<lbrakk>I s; s2p S s; s2p (U s) t;\n        s2p S (\\<phi> t s) \\<longrightarrow> I (\\<phi> t s)\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)\n 2. \\<And>s t.\n       \\<lbrakk>I s; s2p S s; s2p (U s) t; t \\<notin> U s\\<rbrakk>\n       \\<Longrightarrow> I (\\<phi> t s)", "by force+"], ["", "lemma diff_inv_eq_inv_set:\n  \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. T) S 0 (\\<lambda>s. True) = (\\<forall>s. I s \\<longrightarrow> \\<gamma>\\<^sup>\\<phi> s \\<subseteq> {s. I s})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I (\\<lambda>t. f) (\\<lambda>s. T) S 0\n     (\\<lambda>s. True) =\n    (\\<forall>s.\n        I s \\<longrightarrow> \\<gamma>\\<^sup>\\<phi> s \\<subseteq> {s. I s})", "unfolding diff_inv_eq_inv_set orbit_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>s.\n        I s \\<longrightarrow>\n        g_orbital (\\<lambda>t. f) (\\<lambda>s. True) (\\<lambda>s. T) S 0 s\n        \\<subseteq> Collect I) =\n    (\\<forall>s.\n        I s \\<longrightarrow>\n        g_orbital (\\<lambda>t. f) (\\<lambda>s. True) (\\<lambda>s. T) S 0 s\n        \\<subseteq> {s. I s})", "by auto"], ["", "end"], ["", "lemma wp_g_odei: \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>I\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil> \\<Longrightarrow> \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil> \\<le> \\<lceil>Q\\<rceil> \\<Longrightarrow>\n  \\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0 DINV I) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<le> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<le> wp x\\<acute>=f & G on U S @ t\\<^sub>0 DINV I \n                             \\<lceil>Q\\<rceil>", "unfolding g_ode_inv_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<le> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                             \\<lceil>Q\\<rceil>", "apply(rule_tac b=\"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>I\\<rceil>\" in order.trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<le> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> \\<lceil>P\\<rceil>\n                      \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                             \\<lceil>I\\<rceil>\n 2. \\<lbrakk>\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>;\n     \\<lceil>I\\<rceil>\n     \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>;\n     \\<lceil>\\<lambda>s. I s \\<and> G s\\<rceil>\n     \\<le> \\<lceil>Q\\<rceil>\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                       \\<lceil>I\\<rceil>\n                      \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                             \\<lceil>Q\\<rceil>", "apply(rule_tac I=\"I\" in wp_g_orbital_inv, simp_all)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>s. P s \\<longrightarrow> I s;\n     diff_invariant I f U S t\\<^sub>0 G;\n     \\<forall>s. I s \\<and> G s \\<longrightarrow> Q s\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                       \\<lceil>I\\<rceil>\n                      \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                             \\<lceil>Q\\<rceil>", "apply(subst wp_g_orbital_guard, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>s. P s \\<longrightarrow> I s;\n     diff_invariant I f U S t\\<^sub>0 G;\n     \\<forall>s. I s \\<and> G s \\<longrightarrow> Q s\\<rbrakk>\n    \\<Longrightarrow> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                       \\<lceil>\\<lambda>s. G s \\<and> I s\\<rceil>\n                      \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0\n                             \\<lceil>Q\\<rceil>", "by (rule fbox_iso, simp)"], ["", "subsubsection \\<open> Derivation of the rules of dL \\<close>"], ["", "text \\<open> We derive rules of differential dynamic logic (dL). This allows the components to reason \nin the style of that logic. \\<close>"], ["", "abbreviation g_dl_ode ::\"(('a::banach)\\<Rightarrow>'a) \\<Rightarrow> 'a pred \\<Rightarrow> 'a nd_fun\" (\"(1x\\<acute>=_ & _)\") \n  where \"(x\\<acute>= f & G) \\<equiv> (x\\<acute>= (\\<lambda>t. f) & G on (\\<lambda>s. {t. t \\<ge> 0}) UNIV @ 0)\""], ["", "abbreviation g_dl_ode_inv :: \"(('a::banach)\\<Rightarrow>'a) \\<Rightarrow> 'a pred \\<Rightarrow> 'a pred \\<Rightarrow> 'a nd_fun\" (\"(1x\\<acute>=_ & _ DINV _)\") \n  where \"(x\\<acute>= f & G DINV I) \\<equiv> (x\\<acute>=(\\<lambda>t. f) & G on (\\<lambda>s. {t. t \\<ge> 0}) UNIV @ 0 DINV I)\""], ["", "lemma diff_solve_axiom1: \n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= \\<lambda>t. f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n     \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>\\<in>{0..t}.\n                      G (\\<phi> \\<tau> s)) \\<longrightarrow>\n                  Q (\\<phi> t s)\\<rceil>", "by (subst local_flow.wp_g_ode_subset[OF assms], auto)"], ["", "lemma diff_solve_axiom2: \n  fixes c::\"'a::{heine_borel, banach}\"\n  shows \"wp (x\\<acute>=(\\<lambda>s. c) & G) \\<lceil>Q\\<rceil> = \n  \\<lceil>\\<lambda>s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow> Q (s + t *\\<^sub>R c)\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= \\<lambda>t s. c & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n     \\<lceil>Q\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>\\<in>{0..t}.\n                      G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow>\n                  Q (s + t *\\<^sub>R c)\\<rceil>", "apply(subst local_flow.wp_g_ode_subset[where \\<phi>=\"(\\<lambda>t s. s + t *\\<^sub>R c)\" and T=UNIV])"], ["proof (prove)\ngoal (3 subgoals):\n 1. local_flow (\\<lambda>s. c) UNIV UNIV (\\<lambda>t s. s + t *\\<^sub>R c)\n 2. \\<And>s.\n       s2p UNIV s \\<Longrightarrow>\n       s2p (Collect ((\\<le>) 0)) 0 \\<and>\n       is_interval (Collect ((\\<le>) 0)) \\<and>\n       Collect ((\\<le>) 0) \\<subseteq> UNIV\n 3. \\<lceil>\\<lambda>s.\n               s2p UNIV s \\<longrightarrow>\n               (\\<forall>t\\<in>Collect ((\\<le>) 0).\n                   (\\<forall>\\<tau>\\<in>down (Collect ((\\<le>) 0)) t.\n                       G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow>\n                   Q (s + t *\\<^sub>R c))\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>\\<in>{0..t}.\n                      G (s + \\<tau> *\\<^sub>R c)) \\<longrightarrow>\n                  Q (s + t *\\<^sub>R c)\\<rceil>", "by (rule line_is_local_flow, auto)"], ["", "lemma diff_solve_rule:\n  assumes \"local_flow f UNIV UNIV \\<phi>\"\n    and \"\\<forall>s. P s \\<longrightarrow> (\\<forall>t\\<ge>0. (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow> Q (\\<phi> t s))\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= \\<lambda>t.\n                           f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n           \\<lceil>Q\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  local_flow f UNIV UNIV \\<phi>\n  \\<forall>s.\n     P s \\<longrightarrow>\n     (\\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>\\<in>{0..t}. G (\\<phi> \\<tau> s)) \\<longrightarrow>\n         Q (\\<phi> t s))\n\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= \\<lambda>t.\n                           f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n           \\<lceil>Q\\<rceil>", "by (subst local_flow.wp_g_ode_subset[OF assms(1)], auto)"], ["", "lemma diff_weak_axiom1: \"\\<eta>\\<^sup>\\<bullet> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>G\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<eta>\\<^sup>\\<bullet>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>G\\<rceil>", "unfolding wp_nd_fun g_ode_def g_orbital_eq less_eq_nd_fun_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. id (\\<lambda>f g. f\\<^sub>\\<bullet> \\<le> g\\<^sub>\\<bullet>)\n     (\\<eta>\\<^sup>\\<bullet>)\n     \\<lceil>\\<lambda>s.\n                \\<forall>s'.\n                   s2p ((((\\<lambda>s.\n                              {X t |t X.\n                               s2p (U s) t \\<and>\n                               \\<P> X (down (U s) t)\n                               \\<subseteq> Collect G \\<and>\n                               s2p (Sols f U S t\\<^sub>0 s)\n                                X})\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                         s)\n                    s' \\<longrightarrow>\n                   G s'\\<rceil>", "by (auto simp: le_fun_def)"], ["", "lemma diff_weak_axiom2: \n  \"wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & G on T S @ t\\<^sub>0) \\<lceil>\\<lambda> s. G s \\<longrightarrow> Q s\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= f & G on T S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    wp x\\<acute>= f & G on T S @ t\\<^sub>0\n     \\<lceil>\\<lambda>s. G s \\<longrightarrow> Q s\\<rceil>", "unfolding wp_g_orbital image_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f T S t\\<^sub>0 s.\n                  \\<forall>t\\<in>T s.\n                     (\\<forall>\\<tau>\\<in>down (T s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     Q (X t)\\<rceil> =\n    \\<lceil>\\<lambda>s.\n               \\<forall>X\\<in>Sols f T S t\\<^sub>0 s.\n                  \\<forall>t\\<in>T s.\n                     (\\<forall>\\<tau>\\<in>down (T s) t.\n                         G (X \\<tau>)) \\<longrightarrow>\n                     G (X t) \\<longrightarrow> Q (X t)\\<rceil>", "by force"], ["", "lemma diff_weak_rule: \n  assumes \"\\<lceil>G\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "using assms"], ["proof (prove)\nusing this:\n  \\<lceil>G\\<rceil> \\<le> \\<lceil>Q\\<rceil>\n\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "by (auto simp: wp_g_orbital)"], ["", "lemma wp_g_orbit_IdD:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = \\<eta>\\<^sup>\\<bullet>\"\n    and \"\\<forall>\\<tau>\\<in>(down (U s) t). x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\"\n  shows \"\\<forall>\\<tau>\\<in>(down (U s) t). C (x \\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<tau>\\<in>down (U s) t. C (x \\<tau>)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. s2p (down (U s) t) \\<tau> \\<Longrightarrow> C (x \\<tau>)", "fix \\<tau>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. s2p (down (U s) t) \\<tau> \\<Longrightarrow> C (x \\<tau>)", "assume \"\\<tau> \\<in> (down (U s) t)\""], ["proof (state)\nthis:\n  s2p (down (U s) t) \\<tau>\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. s2p (down (U s) t) \\<tau> \\<Longrightarrow> C (x \\<tau>)", "hence \"x \\<tau> \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  s2p (down (U s) t) \\<tau>\n\ngoal (1 subgoal):\n 1. s2p (g_orbital f G U S t\\<^sub>0 s) (x \\<tau>)", "using assms(2)"], ["proof (prove)\nusing this:\n  s2p (down (U s) t) \\<tau>\n  \\<forall>\\<tau>\\<in>down (U s) t.\n     s2p (g_orbital f G U S t\\<^sub>0 s) (x \\<tau>)\n\ngoal (1 subgoal):\n 1. s2p (g_orbital f G U S t\\<^sub>0 s) (x \\<tau>)", "by blast"], ["proof (state)\nthis:\n  s2p (g_orbital f G U S t\\<^sub>0 s) (x \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. s2p (down (U s) t) \\<tau> \\<Longrightarrow> C (x \\<tau>)", "also"], ["proof (state)\nthis:\n  s2p (g_orbital f G U S t\\<^sub>0 s) (x \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. s2p (down (U s) t) \\<tau> \\<Longrightarrow> C (x \\<tau>)", "have \"\\<forall>y. y \\<in> (g_orbital f G U S t\\<^sub>0 s) \\<longrightarrow> C y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>y. s2p (g_orbital f G U S t\\<^sub>0 s) y \\<longrightarrow> C y", "using assms(1)"], ["proof (prove)\nusing this:\n  wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>C\\<rceil> =\n  \\<eta>\\<^sup>\\<bullet>\n\ngoal (1 subgoal):\n 1. \\<forall>y. s2p (g_orbital f G U S t\\<^sub>0 s) y \\<longrightarrow> C y", "unfolding wp_nd_fun g_ode_def"], ["proof (prove)\nusing this:\n  \\<lceil>\\<lambda>s.\n             \\<forall>s'.\n                s2p (((g_orbital f G U S\n                        t\\<^sub>0\\<^sup>\\<bullet>)\\<^sub>\\<bullet>)\n                      s)\n                 s' \\<longrightarrow>\n                C s'\\<rceil> =\n  \\<eta>\\<^sup>\\<bullet>\n\ngoal (1 subgoal):\n 1. \\<forall>y. s2p (g_orbital f G U S t\\<^sub>0 s) y \\<longrightarrow> C y", "by (subst (asm) nd_fun_eq_iff) auto"], ["proof (state)\nthis:\n  \\<forall>y. s2p (g_orbital f G U S t\\<^sub>0 s) y \\<longrightarrow> C y\n\ngoal (1 subgoal):\n 1. \\<And>\\<tau>. s2p (down (U s) t) \\<tau> \\<Longrightarrow> C (x \\<tau>)", "ultimately"], ["proof (chain)\npicking this:\n  s2p (g_orbital f G U S t\\<^sub>0 s) (x \\<tau>)\n  \\<forall>y. s2p (g_orbital f G U S t\\<^sub>0 s) y \\<longrightarrow> C y", "show \"C (x \\<tau>)\""], ["proof (prove)\nusing this:\n  s2p (g_orbital f G U S t\\<^sub>0 s) (x \\<tau>)\n  \\<forall>y. s2p (g_orbital f G U S t\\<^sub>0 s) y \\<longrightarrow> C y\n\ngoal (1 subgoal):\n 1. C (x \\<tau>)", "by blast"], ["proof (state)\nthis:\n  C (x \\<tau>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_cut_axiom:\n  assumes \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil> = \\<eta>\\<^sup>\\<bullet>\"\n  shows \"wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil> = wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil> =\n    wp x\\<acute>= f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n     \\<lceil>Q\\<rceil>", "proof(rule_tac f=\"\\<lambda> x. wp x \\<lceil>Q\\<rceil>\" in HOL.arg_cong, rule nd_fun_ext, rule subset_antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) x\n       \\<subseteq> (x\\<acute>= f & \\<lambda>s.\nG s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n                    x\n 2. \\<And>x.\n       (x\\<acute>= f & \\<lambda>s.\n                          G s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n        x\n       \\<subseteq> (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) x", "fix s"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) x\n       \\<subseteq> (x\\<acute>= f & \\<lambda>s.\nG s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n                    x\n 2. \\<And>x.\n       (x\\<acute>= f & \\<lambda>s.\n                          G s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n        x\n       \\<subseteq> (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) x", "show \"((x\\<acute>= f & G on U S @ t\\<^sub>0)\\<^sub>\\<bullet>) s \\<subseteq> ((x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0)\\<^sub>\\<bullet>) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) s\n    \\<subseteq> (x\\<acute>= f & \\<lambda>s.\n                                   G s \\<and>\n                                   C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n                 s", "proof(clarsimp simp: g_ode_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "fix s'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "assume \"s' \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (state)\nthis:\n  s2p (g_orbital f G U S t\\<^sub>0 s) s'\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "then"], ["proof (chain)\npicking this:\n  s2p (g_orbital f G U S t\\<^sub>0 s) s'", "obtain \\<tau>::real and X where x_ivp: \"X \\<in> ivp_sols f U S t\\<^sub>0 s\" \n      and \"X \\<tau> = s'\" and \"\\<tau> \\<in> U s\" and guard_x:\"(\\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s})\""], ["proof (prove)\nusing this:\n  s2p (g_orbital f G U S t\\<^sub>0 s) s'\n\ngoal (1 subgoal):\n 1. (\\<And>X \\<tau>.\n        \\<lbrakk>s2p (Sols f U S t\\<^sub>0 s) X; X \\<tau> = s';\n         s2p (U s) \\<tau>;\n         \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using g_orbitalD[of s' \"f\" G _ S t\\<^sub>0 s]"], ["proof (prove)\nusing this:\n  s2p (g_orbital f G U S t\\<^sub>0 s) s'\n  \\<lbrakk>s2p (g_orbital f G ?U S t\\<^sub>0 s) s';\n   \\<And>X t.\n      \\<lbrakk>s2p (Sols f ?U S t\\<^sub>0 s) X; X t = s'; s2p (?U s) t;\n       \\<P> X (down (?U s) t) \\<subseteq> {s. G s}\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>X \\<tau>.\n        \\<lbrakk>s2p (Sols f U S t\\<^sub>0 s) X; X \\<tau> = s';\n         s2p (U s) \\<tau>;\n         \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  s2p (Sols f U S t\\<^sub>0 s) X\n  X \\<tau> = s'\n  s2p (U s) \\<tau>\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "have \"\\<forall>t\\<in>(down (U s) \\<tau>). \\<P> X (down (U s) t) \\<subseteq> {s. G s}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       \\<P> X (down (U s) t) \\<subseteq> {s. G s}", "using guard_x"], ["proof (prove)\nusing this:\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       \\<P> X (down (U s) t) \\<subseteq> {s. G s}", "by (force simp: image_def)"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "also"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "have \"\\<forall>t\\<in>(down (U s) \\<tau>). t \\<in> (U s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. s2p (U s) t", "using \\<open>\\<tau> \\<in> (U s)\\<close>"], ["proof (prove)\nusing this:\n  s2p (U s) \\<tau>\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. s2p (U s) t", "by auto"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>. s2p (U s) t\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n  \\<forall>t\\<in>down (U s) \\<tau>. s2p (U s) t", "have \"\\<forall>t\\<in>(down (U s) \\<tau>). X t \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n  \\<forall>t\\<in>down (U s) \\<tau>. s2p (U s) t\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       s2p (g_orbital f G U S t\\<^sub>0 s) (X t)", "using g_orbitalI[OF x_ivp]"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     \\<P> X (down (U s) t) \\<subseteq> {s. G s}\n  \\<forall>t\\<in>down (U s) \\<tau>. s2p (U s) t\n  \\<lbrakk>s2p (U s) ?t;\n   \\<P> X (down (U s) ?t) \\<subseteq> {s. ?G s}\\<rbrakk>\n  \\<Longrightarrow> s2p (g_orbital f ?G U S t\\<^sub>0 s) (X ?t)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>.\n       s2p (g_orbital f G U S t\\<^sub>0 s) (X t)", "by (metis (mono_tags, lifting))"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     s2p (g_orbital f G U S t\\<^sub>0 s) (X t)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "hence \"\\<forall>t\\<in>(down (U s) \\<tau>). C (X t)\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     s2p (g_orbital f G U S t\\<^sub>0 s) (X t)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. C (X t)", "using wp_g_orbit_IdD[OF assms(1)]"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>.\n     s2p (g_orbital f G U S t\\<^sub>0 s) (X t)\n  \\<forall>\\<tau>\\<in>down (U ?s) ?t.\n     s2p (g_orbital f G U S t\\<^sub>0 ?s) (?x \\<tau>) \\<Longrightarrow>\n  \\<forall>\\<tau>\\<in>down (U ?s) ?t. C (?x \\<tau>)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) \\<tau>. C (X t)", "by blast"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) \\<tau>. C (X t)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       s2p (g_orbital f G U S t\\<^sub>0 s) x \\<Longrightarrow>\n       s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) x", "thus \"s' \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>. C (X t)\n\ngoal (1 subgoal):\n 1. s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) s'", "using g_orbitalI[OF x_ivp \\<open>\\<tau> \\<in> (U s)\\<close>] guard_x \\<open>X \\<tau> = s'\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) \\<tau>. C (X t)\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. ?G s} \\<Longrightarrow>\n  s2p (g_orbital f ?G U S t\\<^sub>0 s) (X \\<tau>)\n  \\<P> X (down (U s) \\<tau>) \\<subseteq> {s. G s}\n  X \\<tau> = s'\n\ngoal (1 subgoal):\n 1. s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) s'", "by fastforce"], ["proof (state)\nthis:\n  s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) s'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) s\n  \\<subseteq> (x\\<acute>= f & \\<lambda>s.\n                                 G s \\<and>\n                                 C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n               s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       (x\\<acute>= f & \\<lambda>s.\n                          G s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n        x\n       \\<subseteq> (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       (x\\<acute>= f & \\<lambda>s.\n                          G s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n        x\n       \\<subseteq> (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) x", "fix s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       (x\\<acute>= f & \\<lambda>s.\n                          G s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n        x\n       \\<subseteq> (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) x", "show \"((x\\<acute>= f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0)\\<^sub>\\<bullet>) s \\<subseteq> ((x\\<acute>= f & G on U S @ t\\<^sub>0)\\<^sub>\\<bullet>) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x\\<acute>= f & \\<lambda>s.\n                       G s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n     s\n    \\<subseteq> (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) s", "by (auto simp: g_orbital_eq g_ode_def)"], ["proof (state)\nthis:\n  (x\\<acute>= f & \\<lambda>s.\n                     G s \\<and> C s on U S @ t\\<^sub>0\\<^sub>\\<bullet>)\n   s\n  \\<subseteq> (x\\<acute>= f & G on U S @ t\\<^sub>0\\<^sub>\\<bullet>) s\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_cut_rule:\n  assumes wp_C: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>C\\<rceil>\"\n    and wp_Q: \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & (\\<lambda>s. G s \\<and> C s) on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "proof(simp add: wp_nd_fun g_orbital_eq g_ode_def, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; s2p (U s) t;\n        \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        s2p (Sols f U S t\\<^sub>0 s) X\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "fix t::real and X::\"real \\<Rightarrow> 'a\" and s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; s2p (U s) t;\n        \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        s2p (Sols f U S t\\<^sub>0 s) X\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "assume \"P s\" and \"t \\<in> U s\"\n    and x_ivp:\"X \\<in> ivp_sols f U S t\\<^sub>0 s\" \n    and guard_x:\"\\<forall>x. x \\<in> U s \\<and> x \\<le> t \\<longrightarrow> G (X x)\""], ["proof (state)\nthis:\n  P s\n  s2p (U s) t\n  s2p (Sols f U S t\\<^sub>0 s) X\n  \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x)\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; s2p (U s) t;\n        \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        s2p (Sols f U S t\\<^sub>0 s) X\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "have \"\\<forall>t\\<in>(down (U s) t). X t \\<in> g_orbital f G U S t\\<^sub>0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. s2p (g_orbital f G U S t\\<^sub>0 s) (X t)", "using g_orbitalI[OF x_ivp] guard_x"], ["proof (prove)\nusing this:\n  \\<lbrakk>s2p (U s) ?t;\n   \\<P> X (down (U s) ?t) \\<subseteq> {s. ?G s}\\<rbrakk>\n  \\<Longrightarrow> s2p (g_orbital f ?G U S t\\<^sub>0 s) (X ?t)\n  \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. s2p (g_orbital f G U S t\\<^sub>0 s) (X t)", "by auto"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) t. s2p (g_orbital f G U S t\\<^sub>0 s) (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; s2p (U s) t;\n        \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        s2p (Sols f U S t\\<^sub>0 s) X\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "hence \"\\<forall>t\\<in>(down (U s) t). C (X t)\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. s2p (g_orbital f G U S t\\<^sub>0 s) (X t)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. C (X t)", "using wp_C \\<open>P s\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. s2p (g_orbital f G U S t\\<^sub>0 s) (X t)\n  \\<lceil>P\\<rceil>\n  \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>C\\<rceil>\n  P s\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>down (U s) t. C (X t)", "by (subst (asm) wp_nd_fun, auto simp: g_ode_def)"], ["proof (state)\nthis:\n  \\<forall>t\\<in>down (U s) t. C (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; s2p (U s) t;\n        \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        s2p (Sols f U S t\\<^sub>0 s) X\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "hence \"X t \\<in> g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. C (X t)\n\ngoal (1 subgoal):\n 1. s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) (X t)", "using guard_x \\<open>t \\<in> (U s)\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>down (U s) t. C (X t)\n  \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x)\n  s2p (U s) t\n\ngoal (1 subgoal):\n 1. s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) (X t)", "by (auto intro!: g_orbitalI x_ivp)"], ["proof (state)\nthis:\n  s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s t X.\n       \\<lbrakk>P s; s2p (U s) t;\n        \\<forall>x. s2p (U s) x \\<and> x \\<le> t \\<longrightarrow> G (X x);\n        s2p (Sols f U S t\\<^sub>0 s) X\\<rbrakk>\n       \\<Longrightarrow> Q (X t)", "thus \"Q (X t)\""], ["proof (prove)\nusing this:\n  s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) (X t)\n\ngoal (1 subgoal):\n 1. Q (X t)", "using \\<open>P s\\<close> wp_Q"], ["proof (prove)\nusing this:\n  s2p (g_orbital f (\\<lambda>s. G s \\<and> C s) U S t\\<^sub>0 s) (X t)\n  P s\n  \\<lceil>P\\<rceil>\n  \\<le> wp x\\<acute>= f & \\<lambda>s. G s \\<and> C s on U S @ t\\<^sub>0\n         \\<lceil>Q\\<rceil>\n\ngoal (1 subgoal):\n 1. Q (X t)", "by (subst (asm) wp_nd_fun) (auto simp: g_ode_def)"], ["proof (state)\nthis:\n  Q (X t)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_inv_axiom1:\n  assumes \"G s \\<longrightarrow> I s\" and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. t \\<ge> 0}) UNIV 0 G\"\n  shows \"s \\<in> ((wp (x\\<acute>= f & G) \\<lceil>I\\<rceil>)\\<^sub>\\<bullet>) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s2p ((wp x\\<acute>= \\<lambda>t.\n                           f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n           \\<lceil>I\\<rceil>\\<^sub>\\<bullet>)\n          s)\n     s", "using assms"], ["proof (prove)\nusing this:\n  G s \\<longrightarrow> I s\n  diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 G\n\ngoal (1 subgoal):\n 1. s2p ((wp x\\<acute>= \\<lambda>t.\n                           f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n           \\<lceil>I\\<rceil>\\<^sub>\\<bullet>)\n          s)\n     s", "unfolding wp_g_orbital diff_invariant_eq"], ["proof (prove)\nusing this:\n  G s \\<longrightarrow> I s\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0))\n                      UNIV 0 s.\n         \\<forall>t\\<in>Collect ((\\<le>) 0).\n            (\\<forall>\\<tau>\\<in>down (Collect ((\\<le>) 0)) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. s2p ((\\<lceil>\\<lambda>s.\n                     \\<forall>X\\<in>Sols (\\<lambda>t. f)\n                                     (\\<lambda>s. Collect ((\\<le>) 0)) UNIV\n                                     0 s.\n                        \\<forall>t\\<in>Collect ((\\<le>) 0).\n                           (\\<forall>\\<tau>\n                                     \\<in>down (Collect ((\\<le>) 0)) t.\n                               G (X \\<tau>)) \\<longrightarrow>\n                           I (X t)\\<rceil>\\<^sub>\\<bullet>)\n          s)\n     s", "apply clarsimp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        \\<forall>s.\n           I s \\<longrightarrow>\n           (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                            (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n               \\<forall>t\\<ge>0.\n                  (\\<forall>\\<tau>.\n                      0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                      G (X \\<tau>)) \\<longrightarrow>\n                  I (X t));\n        s2p (Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0\n              s)\n         X;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> I (X t)", "by (erule_tac x=s in allE, frule ivp_solsD(2), clarsimp)"], ["", "lemma diff_inv_axiom2:\n  assumes \"picard_lindeloef (\\<lambda>t. f) UNIV UNIV 0\"\n    and \"\\<And>s. {t::real. t \\<ge> 0} \\<subseteq> picard_lindeloef.ex_ivl (\\<lambda>t. f) UNIV UNIV 0 s\"\n    and \"diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t::real. t \\<ge> 0}) UNIV 0 G\"\n  shows \"wp (x\\<acute>= f & G) \\<lceil>I\\<rceil> = wp \\<lceil>G\\<rceil> \\<lceil>I\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp x\\<acute>= \\<lambda>t. f & G on \\<lambda>s. {t. 0 \\<le> t} UNIV @ 0\n     \\<lceil>I\\<rceil> =\n    wp \\<lceil>G\\<rceil> \\<lceil>I\\<rceil>", "proof(unfold wp_g_orbital, subst wp_nd_fun, clarsimp simp: fun_eq_iff)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "fix s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "let \"?ex_ivl s\" = \"picard_lindeloef.ex_ivl (\\<lambda>t. f) UNIV UNIV 0 s\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "let \"?lhs s\" = \n    \"\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. t \\<ge> 0}) UNIV 0 s. \\<forall>t\\<ge>0. (\\<forall>\\<tau>. 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)) \\<longrightarrow> I (X t)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "obtain X where xivp1: \"X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. ?ex_ivl s) UNIV 0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>X.\n        s2p (Sols (\\<lambda>t. f)\n              (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV 0\n              s)\n         X \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using picard_lindeloef.flow_in_ivp_sols_ex_ivl[OF assms(1)]"], ["proof (prove)\nusing this:\n  s2p UNIV ?s \\<Longrightarrow>\n  s2p (Sols (\\<lambda>t. f)\n        (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV 0 ?s)\n   (ll_on_open.flow UNIV (\\<lambda>t. f) UNIV 0 ?s)\n\ngoal (1 subgoal):\n 1. (\\<And>X.\n        s2p (Sols (\\<lambda>t. f)\n              (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV 0\n              s)\n         X \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  s2p (Sols (\\<lambda>t. f)\n        (ll_on_open.existence_ivl UNIV (\\<lambda>t. f) UNIV 0) UNIV 0 s)\n   X\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "have xivp2: \"X \\<in> Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s2p (Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s) X", "by (rule in_ivp_sols_subset[OF _ _ xivp1], simp_all add: assms(2))"], ["proof (state)\nthis:\n  s2p (Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s) X\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence shyp: \"X 0 = s\""], ["proof (prove)\nusing this:\n  s2p (Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s) X\n\ngoal (1 subgoal):\n 1. X 0 = s", "using ivp_solsD"], ["proof (prove)\nusing this:\n  s2p (Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s) X\n  s2p (Sols ?f ?U ?S ?t\\<^sub>0 ?s) ?X \\<Longrightarrow>\n   D ?X = (\\<lambda>t. ?f t (?X t)) on ?U ?s\n  s2p (Sols ?f ?U ?S ?t\\<^sub>0 ?s) ?X \\<Longrightarrow> ?X ?t\\<^sub>0 = ?s\n  s2p (Sols ?f ?U ?S ?t\\<^sub>0 ?s) ?X \\<Longrightarrow>\n  s2p (?U ?s \\<rightarrow> ?S) ?X\n  s2p (Sols ?f ?U ?S ?t\\<^sub>0 ?s) ?X \\<Longrightarrow>\n  s2p (?U ?s) ?t\\<^sub>0\n\ngoal (1 subgoal):\n 1. X 0 = s", "by auto"], ["proof (state)\nthis:\n  X 0 = s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "have dinv: \"\\<forall>s. I s \\<longrightarrow> ?lhs s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                        UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "using assms(3)"], ["proof (prove)\nusing this:\n  diff_invariant I (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 G\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                        UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "unfolding diff_invariant_eq"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0))\n                      UNIV 0 s.\n         \\<forall>t\\<in>Collect ((\\<le>) 0).\n            (\\<forall>\\<tau>\\<in>down (Collect ((\\<le>) 0)) t.\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<forall>s.\n       I s \\<longrightarrow>\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                        UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t))", "by auto"], ["proof (state)\nthis:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV\n                      0 s.\n         \\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "{"], ["proof (state)\nthis:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV\n                      0 s.\n         \\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "assume \"?lhs s\" and \"G s\""], ["proof (state)\nthis:\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n  G s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence \"I s\""], ["proof (prove)\nusing this:\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n  G s\n\ngoal (1 subgoal):\n 1. I s", "by (erule_tac x=X in ballE, erule_tac x=0 in allE, auto simp: shyp xivp2)"], ["proof (state)\nthis:\n  I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                           UNIV 0 s.\n              \\<forall>t\\<ge>0.\n                 (\\<forall>\\<tau>.\n                     0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                     G (X \\<tau>)) \\<longrightarrow>\n                 I (X t);\n   G s\\<rbrakk>\n  \\<Longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence \"?lhs s \\<longrightarrow> (G s \\<longrightarrow> I s)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t})\n                           UNIV 0 s.\n              \\<forall>t\\<ge>0.\n                 (\\<forall>\\<tau>.\n                     0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                     G (X \\<tau>)) \\<longrightarrow>\n                 I (X t);\n   G s\\<rbrakk>\n  \\<Longrightarrow> I s\n\ngoal (1 subgoal):\n 1. (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                     s.\n        \\<forall>t\\<ge>0.\n           (\\<forall>\\<tau>.\n               0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n               G (X \\<tau>)) \\<longrightarrow>\n           I (X t)) \\<longrightarrow>\n    G s \\<longrightarrow> I s", "by blast"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "moreover"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "{"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "assume \"G s \\<longrightarrow> I s\""], ["proof (state)\nthis:\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "hence \"?lhs s\""], ["proof (prove)\nusing this:\n  G s \\<longrightarrow> I s\n\ngoal (1 subgoal):\n 1. \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                    s.\n       \\<forall>t\\<ge>0.\n          (\\<forall>\\<tau>.\n              0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n              G (X \\<tau>)) \\<longrightarrow>\n          I (X t)", "apply(clarify, subgoal_tac \"\\<forall>\\<tau>. 0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow> G (X \\<tau>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        s2p (Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s) X;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>)\\<rbrakk>\n       \\<Longrightarrow> I (X t)\n 2. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        s2p (Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s) X;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>.\n                            0 \\<le> \\<tau> \\<and>\n                            \\<tau> \\<le> t \\<longrightarrow>\n                            G (X \\<tau>)", "apply(erule_tac x=0 in allE, frule ivp_solsD(2), simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X t.\n       \\<lbrakk>s2p (Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0))\n                      UNIV 0 s)\n                 X;\n        0 \\<le> t; I s;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s; X 0 = s\\<rbrakk>\n       \\<Longrightarrow> I (X t)\n 2. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        s2p (Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s) X;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>.\n                            0 \\<le> \\<tau> \\<and>\n                            \\<tau> \\<le> t \\<longrightarrow>\n                            G (X \\<tau>)", "using dinv"], ["proof (prove)\nusing this:\n  \\<forall>s.\n     I s \\<longrightarrow>\n     (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV\n                      0 s.\n         \\<forall>t\\<ge>0.\n            (\\<forall>\\<tau>.\n                0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                G (X \\<tau>)) \\<longrightarrow>\n            I (X t))\n\ngoal (2 subgoals):\n 1. \\<And>X t.\n       \\<lbrakk>s2p (Sols (\\<lambda>t. f) (\\<lambda>s. Collect ((\\<le>) 0))\n                      UNIV 0 s)\n                 X;\n        0 \\<le> t; I s;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s; X 0 = s\\<rbrakk>\n       \\<Longrightarrow> I (X t)\n 2. \\<And>X t.\n       \\<lbrakk>G s \\<longrightarrow> I s;\n        s2p (Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s) X;\n        0 \\<le> t;\n        \\<forall>\\<tau>.\n           0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n           G (X \\<tau>);\n        G s \\<longrightarrow> I s\\<rbrakk>\n       \\<Longrightarrow> \\<forall>\\<tau>.\n                            0 \\<le> \\<tau> \\<and>\n                            \\<tau> \\<le> t \\<longrightarrow>\n                            G (X \\<tau>)", "by blast+"], ["proof (state)\nthis:\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "}"], ["proof (state)\nthis:\n  G s \\<longrightarrow> I s \\<Longrightarrow>\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       (\\<forall>X\\<in>Sols (\\<lambda>t. f)\n                        (\\<lambda>s. Collect ((\\<le>) 0)) UNIV 0 s.\n           \\<forall>t\\<ge>0.\n              (\\<forall>\\<tau>.\n                  0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n                  G (X \\<tau>)) \\<longrightarrow>\n              I (X t)) =\n       (G s \\<longrightarrow> I s)", "ultimately"], ["proof (chain)\npicking this:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n  G s \\<longrightarrow> I s \\<Longrightarrow>\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)", "show \"?lhs s = (G s \\<longrightarrow> I s)\""], ["proof (prove)\nusing this:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) \\<longrightarrow>\n  G s \\<longrightarrow> I s\n  G s \\<longrightarrow> I s \\<Longrightarrow>\n  \\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0 s.\n     \\<forall>t\\<ge>0.\n        (\\<forall>\\<tau>.\n            0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n            G (X \\<tau>)) \\<longrightarrow>\n        I (X t)\n\ngoal (1 subgoal):\n 1. (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                     s.\n        \\<forall>t\\<ge>0.\n           (\\<forall>\\<tau>.\n               0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n               G (X \\<tau>)) \\<longrightarrow>\n           I (X t)) =\n    (G s \\<longrightarrow> I s)", "by blast"], ["proof (state)\nthis:\n  (\\<forall>X\\<in>Sols (\\<lambda>t. f) (\\<lambda>s. {t. 0 \\<le> t}) UNIV 0\n                   s.\n      \\<forall>t\\<ge>0.\n         (\\<forall>\\<tau>.\n             0 \\<le> \\<tau> \\<and> \\<tau> \\<le> t \\<longrightarrow>\n             G (X \\<tau>)) \\<longrightarrow>\n         I (X t)) =\n  (G s \\<longrightarrow> I s)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_inv_rule:\n  assumes \"\\<lceil>P\\<rceil> \\<le> \\<lceil>I\\<rceil>\" and \"diff_invariant I f U S t\\<^sub>0 G\" and \"\\<lceil>I\\<rceil> \\<le> \\<lceil>Q\\<rceil>\"\n  shows \"\\<lceil>P\\<rceil> \\<le> wp (x\\<acute>= f & G on U S @ t\\<^sub>0) \\<lceil>Q\\<rceil>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>P\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>Q\\<rceil>", "apply(rule wp_g_orbital_inv[OF assms(1) _ assms(3)])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lceil>I\\<rceil>\n    \\<le> wp x\\<acute>= f & G on U S @ t\\<^sub>0 \\<lceil>I\\<rceil>", "unfolding wp_diff_inv"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_invariant I f U S t\\<^sub>0 G", "using assms(2)"], ["proof (prove)\nusing this:\n  diff_invariant I f U S t\\<^sub>0 G\n\ngoal (1 subgoal):\n 1. diff_invariant I f U S t\\<^sub>0 G", "."], ["", "end"]]}