{"file_name": "/home/qj213/afp-2021-10-22/thys/Error_Function/Error_Function_Asymptotics.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Error_Function", "problem_names": ["lemma real_powr_eq_powerI:\n  \"x > 0 \\<Longrightarrow> y = real y' \\<Longrightarrow> x powr y = x ^ y'\"", "lemma erf_remainder_integral_aux_nonneg:\n  \"x > 0 \\<Longrightarrow> integral {x..x + real m} (\\<lambda>t. exp (-(t^2)) / t ^ (2*n)) \\<ge> 0\"", "lemma erf_remainder_integral_aux_bound:\n  assumes \"x > 0\"\n  shows   \"norm (integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n))) \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\"\n    and   \"integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n)) \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\"", "lemma convergent_erf_remainder_integral:\n  assumes \"x > 0\"\n  shows   \"convergent (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (-(t^2)) / t ^ (2*n)))\"", "lemma LIMSEQ_erf_remainder_integral:\n  \"x > 0 \\<Longrightarrow> (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (-(t^2)) / t ^ (2*n))) \\<longlonglongrightarrow>\n                 erf_remainder_integral n x\"", "lemma\n  assumes \"x > 0\"\n  shows   erf_remainder_integral_nonneg: \"erf_remainder_integral n x \\<ge> 0\"\n    and   erf_remainder_integral_bound:  \"erf_remainder_integral n x \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\"", "lemma erf_remainder_integral_bigo: \n  \"erf_remainder_integral n \\<in> O(\\<lambda>x. exp (-x\\<^sup>2) / x ^ (2*n+1))\"", "theorem erf_remainder_bigo: \"erf_remainder n \\<in> O(\\<lambda>x. exp (-x\\<^sup>2) / x ^ (2*n+1))\"", "lemma erf_remainder_integral_0_conv_erfc:\n  assumes \"(x::real) > 0\"\n  shows   \"erf_remainder_integral 0 x = sqrt pi / 2 * erfc x\"", "lemma erf_remainder_0_conv_erfc: \"x > 0 \\<Longrightarrow> erf_remainder 0 x = erfc x\"", "lemma erf_remainder_integral_conv_Suc:\n  assumes \"x > 0\"\n  shows   \"erf_remainder_integral n x = exp (-x\\<^sup>2) / (2*x^(2*n+1)) -\n             real (2*n+1) / 2 * erf_remainder_integral (Suc n) x\"", "lemma erf_remainder_conv_Suc:\n  assumes \"x > 0\"\n  shows   \"erf_remainder n x = (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n                    exp (- x\\<^sup>2) / (x ^ (2 * n + 1)) + erf_remainder (Suc n) x\"", "theorem erfc_unroll:\n  assumes \"x > 0\"\n  shows   \"erfc x = exp (-x\\<^sup>2) / sqrt pi * \n             (\\<Sum>i<n. (-1)^i * fact (2*i) / (4^i*fact i) / x^(2*i+1)) + erf_remainder n x\"", "lemma erfc_aux_unroll: \n  \"x > 0 \\<Longrightarrow> \n     erfc_aux x = (\\<Sum>i<n. (-1)^i * fact (2*i) / (4^i*fact i) / x^(2*i+1)) + erf_remainder' n x\"", "lemma erf_remainder'_bigo: \"erf_remainder' n \\<in> O(\\<lambda>x. 1 / x ^ (2*n+1))\"", "lemma has_field_derivative_erfc_aux: \n    \"(erfc_aux has_field_derivative (2 * x * erfc_aux x - 2)) (at x)\""], "translations": [["", "lemma real_powr_eq_powerI:\n  \"x > 0 \\<Longrightarrow> y = real y' \\<Longrightarrow> x powr y = x ^ y'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < x; y = real y'\\<rbrakk> \\<Longrightarrow> x powr y = x ^ y'", "by (simp add: powr_realpow)"], ["", "definition erf_remainder_integral where\n  \"erf_remainder_integral n x =\n     lim (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (-(t^2)) / t ^ (2*n)))\""], ["", "text \\<open>\n  The following is the remainder term in the asymptotic expansion of @{term erfc}.\n\\<close>"], ["", "definition erf_remainder where\n  \"erf_remainder n x =\n     ((-1)^n * 2 * fact (2*n)) / (sqrt pi * 4 ^ n * fact n) *\n     erf_remainder_integral n x\""], ["", "lemma erf_remainder_integral_aux_nonneg:\n  \"x > 0 \\<Longrightarrow> integral {x..x + real m} (\\<lambda>t. exp (-(t^2)) / t ^ (2*n)) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < x \\<Longrightarrow>\n    0 \\<le> integral {x..x + real m}\n             (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "by (intro integral_nonneg integrable_continuous_real) (auto intro!: continuous_intros)"], ["", "lemma erf_remainder_integral_aux_bound:\n  assumes \"x > 0\"\n  shows   \"norm (integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n))) \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\"\n    and   \"integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n)) \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1) &&&\n    integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n 2. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "have \"norm (integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n))) \\<le>\n          integral {x..x + real m} (\\<lambda>t. exp (-x*t) / x ^ (2*n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> integral {x..x + real m} (\\<lambda>t. exp (- x * t) / x ^ (2 * n))", "proof (intro integral_norm_bound_integral ballI)"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)) integrable_on\n    {x..x + real m}\n 2. (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) integrable_on {x..x + real m}\n 3. \\<And>xa.\n       xa \\<in> {x..x + real m} \\<Longrightarrow>\n       norm (exp (- xa\\<^sup>2) / xa ^ (2 * n))\n       \\<le> exp (- x * xa) / x ^ (2 * n)", "fix t"], ["proof (state)\ngoal (3 subgoals):\n 1. (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)) integrable_on\n    {x..x + real m}\n 2. (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) integrable_on {x..x + real m}\n 3. \\<And>xa.\n       xa \\<in> {x..x + real m} \\<Longrightarrow>\n       norm (exp (- xa\\<^sup>2) / xa ^ (2 * n))\n       \\<le> exp (- x * xa) / x ^ (2 * n)", "assume t: \"t \\<in> {x..x + real m}\""], ["proof (state)\nthis:\n  t \\<in> {x..x + real m}\n\ngoal (3 subgoals):\n 1. (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)) integrable_on\n    {x..x + real m}\n 2. (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) integrable_on {x..x + real m}\n 3. \\<And>xa.\n       xa \\<in> {x..x + real m} \\<Longrightarrow>\n       norm (exp (- xa\\<^sup>2) / xa ^ (2 * n))\n       \\<le> exp (- x * xa) / x ^ (2 * n)", "from t"], ["proof (chain)\npicking this:\n  t \\<in> {x..x + real m}", "have \"norm (exp (-t\\<^sup>2) / t ^ (2*n)) = exp (-t\\<^sup>2) / t ^ (2*n)\""], ["proof (prove)\nusing this:\n  t \\<in> {x..x + real m}\n\ngoal (1 subgoal):\n 1. norm (exp (- t\\<^sup>2) / t ^ (2 * n)) = exp (- t\\<^sup>2) / t ^ (2 * n)", "by simp"], ["proof (state)\nthis:\n  norm (exp (- t\\<^sup>2) / t ^ (2 * n)) = exp (- t\\<^sup>2) / t ^ (2 * n)\n\ngoal (3 subgoals):\n 1. (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)) integrable_on\n    {x..x + real m}\n 2. (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) integrable_on {x..x + real m}\n 3. \\<And>xa.\n       xa \\<in> {x..x + real m} \\<Longrightarrow>\n       norm (exp (- xa\\<^sup>2) / xa ^ (2 * n))\n       \\<le> exp (- x * xa) / x ^ (2 * n)", "also"], ["proof (state)\nthis:\n  norm (exp (- t\\<^sup>2) / t ^ (2 * n)) = exp (- t\\<^sup>2) / t ^ (2 * n)\n\ngoal (3 subgoals):\n 1. (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)) integrable_on\n    {x..x + real m}\n 2. (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) integrable_on {x..x + real m}\n 3. \\<And>xa.\n       xa \\<in> {x..x + real m} \\<Longrightarrow>\n       norm (exp (- xa\\<^sup>2) / xa ^ (2 * n))\n       \\<le> exp (- x * xa) / x ^ (2 * n)", "have \"\\<dots> \\<le> exp (-x*t) / x ^ (2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. exp (- t\\<^sup>2) / t ^ (2 * n) \\<le> exp (- x * t) / x ^ (2 * n)", "using t assms"], ["proof (prove)\nusing this:\n  t \\<in> {x..x + real m}\n  0 < x\n\ngoal (1 subgoal):\n 1. exp (- t\\<^sup>2) / t ^ (2 * n) \\<le> exp (- x * t) / x ^ (2 * n)", "by (intro frac_le) (simp_all add: self_le_power power2_eq_square power_mono)"], ["proof (state)\nthis:\n  exp (- t\\<^sup>2) / t ^ (2 * n) \\<le> exp (- x * t) / x ^ (2 * n)\n\ngoal (3 subgoals):\n 1. (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)) integrable_on\n    {x..x + real m}\n 2. (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) integrable_on {x..x + real m}\n 3. \\<And>xa.\n       xa \\<in> {x..x + real m} \\<Longrightarrow>\n       norm (exp (- xa\\<^sup>2) / xa ^ (2 * n))\n       \\<le> exp (- x * xa) / x ^ (2 * n)", "finally"], ["proof (chain)\npicking this:\n  norm (exp (- t\\<^sup>2) / t ^ (2 * n)) \\<le> exp (- x * t) / x ^ (2 * n)", "show \"norm (exp (-t\\<^sup>2) / t ^ (2*n)) \\<le> \\<dots>\""], ["proof (prove)\nusing this:\n  norm (exp (- t\\<^sup>2) / t ^ (2 * n)) \\<le> exp (- x * t) / x ^ (2 * n)\n\ngoal (1 subgoal):\n 1. norm (exp (- t\\<^sup>2) / t ^ (2 * n)) \\<le> exp (- x * t) / x ^ (2 * n)", "by simp"], ["proof (state)\nthis:\n  norm (exp (- t\\<^sup>2) / t ^ (2 * n)) \\<le> exp (- x * t) / x ^ (2 * n)\n\ngoal (2 subgoals):\n 1. (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)) integrable_on\n    {x..x + real m}\n 2. (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) integrable_on {x..x + real m}", "qed (insert assms, auto intro!: continuous_intros integrable_continuous_real)"], ["proof (state)\nthis:\n  norm\n   (integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<le> integral {x..x + real m} (\\<lambda>t. exp (- x * t) / x ^ (2 * n))\n\ngoal (2 subgoals):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n 2. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "also"], ["proof (state)\nthis:\n  norm\n   (integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<le> integral {x..x + real m} (\\<lambda>t. exp (- x * t) / x ^ (2 * n))\n\ngoal (2 subgoals):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n 2. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "have \"\\<dots> = -exp (-x*(x + real m)) / x ^ (2*n+1) - (-exp (-x*x) / x ^ (2*n+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) =\n    - exp (- x * (x + real m)) / x ^ (2 * n + 1) -\n    - exp (- x * x) / x ^ (2 * n + 1)", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) =\n    - exp (- x * (x + real m)) / x ^ (2 * n + 1) -\n    - exp (- x * x) / x ^ (2 * n + 1)", "by (intro integral_unique fundamental_theorem_of_calculus)\n       (auto simp: has_field_derivative_iff_has_vector_derivative [symmetric]\n             intro!: derivative_eq_intros)"], ["proof (state)\nthis:\n  integral {x..x + real m} (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) =\n  - exp (- x * (x + real m)) / x ^ (2 * n + 1) -\n  - exp (- x * x) / x ^ (2 * n + 1)\n\ngoal (2 subgoals):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n 2. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "also"], ["proof (state)\nthis:\n  integral {x..x + real m} (\\<lambda>t. exp (- x * t) / x ^ (2 * n)) =\n  - exp (- x * (x + real m)) / x ^ (2 * n + 1) -\n  - exp (- x * x) / x ^ (2 * n + 1)\n\ngoal (2 subgoals):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n 2. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "have \"\\<dots> \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - exp (- x * (x + real m)) / x ^ (2 * n + 1) -\n    - exp (- x * x) / x ^ (2 * n + 1)\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. - exp (- x * (x + real m)) / x ^ (2 * n + 1) -\n    - exp (- x * x) / x ^ (2 * n + 1)\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "by (simp add: power2_eq_square)"], ["proof (state)\nthis:\n  - exp (- x * (x + real m)) / x ^ (2 * n + 1) -\n  - exp (- x * x) / x ^ (2 * n + 1)\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal (2 subgoals):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n 2. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "finally"], ["proof (chain)\npicking this:\n  norm\n   (integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "show *: \"norm (integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n))) \\<le>\n                      exp (-x\\<^sup>2) / x ^ (2*n+1)\""], ["proof (prove)\nusing this:\n  norm\n   (integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "."], ["proof (state)\nthis:\n  norm\n   (integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "have \"integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n)) \\<le>\n          norm (integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> norm\n           (integral {x..x + real m}\n             (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))", "by simp"], ["proof (state)\nthis:\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n  \\<le> norm\n         (integral {x..x + real m}\n           (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "also"], ["proof (state)\nthis:\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n  \\<le> norm\n         (integral {x..x + real m}\n           (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "note *"], ["proof (state)\nthis:\n  norm\n   (integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "finally"], ["proof (chain)\npicking this:\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "show \"integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n)) \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\""], ["proof (prove)\nusing this:\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "."], ["proof (state)\nthis:\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma convergent_erf_remainder_integral:\n  assumes \"x > 0\"\n  shows   \"convergent (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (-(t^2)) / t ^ (2*n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. convergent\n     (\\<lambda>m.\n         integral {x..x + real m}\n          (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))", "proof (intro Bseq_mono_convergent BseqI'; clarify?)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>na.\n       norm\n        (integral {x..x + real na}\n          (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n       \\<le> ?K2\n 2. \\<And>m na.\n       m \\<le> na \\<Longrightarrow>\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n       \\<le> integral {x..x + real na}\n              (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "fix m :: nat"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>na.\n       norm\n        (integral {x..x + real na}\n          (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n       \\<le> ?K2\n 2. \\<And>m na.\n       m \\<le> na \\<Longrightarrow>\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n       \\<le> integral {x..x + real na}\n              (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "show \"norm (integral {x..x + real m} (\\<lambda>t. exp (-t\\<^sup>2) / t ^ (2*n))) \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. norm\n     (integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "by (rule erf_remainder_integral_aux_bound)"], ["proof (state)\nthis:\n  norm\n   (integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. \\<And>m na.\n       m \\<le> na \\<Longrightarrow>\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n       \\<le> integral {x..x + real na}\n              (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "qed (insert assms, auto intro!: integral_subset_le integrable_continuous_real continuous_intros)"], ["", "lemma LIMSEQ_erf_remainder_integral:\n  \"x > 0 \\<Longrightarrow> (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (-(t^2)) / t ^ (2*n))) \\<longlonglongrightarrow>\n                 erf_remainder_integral n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < x \\<Longrightarrow>\n    (\\<lambda>m.\n        integral {x..x + real m}\n         (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<longlonglongrightarrow> erf_remainder_integral n x", "using convergent_erf_remainder_integral[of x]"], ["proof (prove)\nusing this:\n  0 < x \\<Longrightarrow>\n  convergent\n   (\\<lambda>m.\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * ?n)))\n\ngoal (1 subgoal):\n 1. 0 < x \\<Longrightarrow>\n    (\\<lambda>m.\n        integral {x..x + real m}\n         (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n    \\<longlonglongrightarrow> erf_remainder_integral n x", "by (simp add: convergent_LIMSEQ_iff erf_remainder_integral_def)"], ["", "text \\<open>\n  We show some bounds on the remainder term.\n\\<close>"], ["", "lemma\n  assumes \"x > 0\"\n  shows   erf_remainder_integral_nonneg: \"erf_remainder_integral n x \\<ge> 0\"\n    and   erf_remainder_integral_bound:  \"erf_remainder_integral n x \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> erf_remainder_integral n x &&&\n    erf_remainder_integral n x \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 \\<le> erf_remainder_integral n x\n 2. erf_remainder_integral n x \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "note * = LIMSEQ_erf_remainder_integral[OF assms]"], ["proof (state)\nthis:\n  (\\<lambda>m.\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * ?n)))\n  \\<longlonglongrightarrow> erf_remainder_integral ?n x\n\ngoal (2 subgoals):\n 1. 0 \\<le> erf_remainder_integral n x\n 2. erf_remainder_integral n x \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "show \"erf_remainder_integral n x \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> erf_remainder_integral n x", "by (intro tendsto_le[OF _ * tendsto_const] always_eventually\n          erf_remainder_integral_aux_nonneg allI assms sequentially_bot)"], ["proof (state)\nthis:\n  0 \\<le> erf_remainder_integral n x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "show \"erf_remainder_integral n x \\<le> exp (-x\\<^sup>2) / x ^ (2*n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder_integral n x \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)", "by (intro tendsto_le[OF _ tendsto_const *] always_eventually\n          erf_remainder_integral_aux_bound allI assms sequentially_bot)"], ["proof (state)\nthis:\n  erf_remainder_integral n x \\<le> exp (- x\\<^sup>2) / x ^ (2 * n + 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma erf_remainder_integral_bigo: \n  \"erf_remainder_integral n \\<in> O(\\<lambda>x. exp (-x\\<^sup>2) / x ^ (2*n+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder_integral n\n    \\<in> O(\\<lambda>x. exp (- x\\<^sup>2) / x ^ (2 * n + 1))", "using erf_remainder_integral_nonneg erf_remainder_integral_bound"], ["proof (prove)\nusing this:\n  0 < ?x \\<Longrightarrow> 0 \\<le> erf_remainder_integral ?n ?x\n  0 < ?x \\<Longrightarrow>\n  erf_remainder_integral ?n ?x \\<le> exp (- ?x\\<^sup>2) / ?x ^ (2 * ?n + 1)\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n\n    \\<in> O(\\<lambda>x. exp (- x\\<^sup>2) / x ^ (2 * n + 1))", "by (auto intro!: bigoI[of _ 1] eventually_mono [OF eventually_gt_at_top[of \"0::real\"]])"], ["", "theorem erf_remainder_bigo: \"erf_remainder n \\<in> O(\\<lambda>x. exp (-x\\<^sup>2) / x ^ (2*n+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder n \\<in> O(\\<lambda>x. exp (- x\\<^sup>2) / x ^ (2 * n + 1))", "using erf_remainder_integral_bigo[of n]"], ["proof (prove)\nusing this:\n  erf_remainder_integral n\n  \\<in> O(\\<lambda>x. exp (- x\\<^sup>2) / x ^ (2 * n + 1))\n\ngoal (1 subgoal):\n 1. erf_remainder n \\<in> O(\\<lambda>x. exp (- x\\<^sup>2) / x ^ (2 * n + 1))", "by (simp add: erf_remainder_def [abs_def])"], ["", "text \\<open>\n  Next, we unroll the remainder term to develop the asymptotic expansion.\n\\<close>"], ["", "lemma erf_remainder_integral_0_conv_erfc:\n  assumes \"(x::real) > 0\"\n  shows   \"erf_remainder_integral 0 x = sqrt pi / 2 * erfc x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "have \"(\\<lambda>m. sqrt pi / 2 * (erf (x + real m) - erf x)) \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\"\n    (is \"filterlim ?f _ _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>m. sqrt pi / 2 * (erf (x + real m) - erf x))\n    \\<longlonglongrightarrow> sqrt pi / 2 * erfc x", "unfolding erfc_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>m. sqrt pi / 2 * (erf (x + real m) - erf x))\n    \\<longlonglongrightarrow> sqrt pi / 2 * (1 - erf x)", "by (intro tendsto_intros filterlim_tendsto_add_at_top[OF \n          tendsto_const filterlim_real_sequentially])"], ["proof (state)\nthis:\n  (\\<lambda>m. sqrt pi / 2 * (erf (x + real m) - erf x))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "also"], ["proof (state)\nthis:\n  (\\<lambda>m. sqrt pi / 2 * (erf (x + real m) - erf x))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "have \"?f = (\\<lambda>m. integral {x..x+real m} (\\<lambda>t. exp (-t\\<^sup>2)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>m. sqrt pi / 2 * (erf (x + real m) - erf x)) =\n    (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))", "by (auto simp: fun_eq_iff integral_unique[OF integral_exp_minus_squared_real])"], ["proof (state)\nthis:\n  (\\<lambda>m. sqrt pi / 2 * (erf (x + real m) - erf x)) =\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x", "have \"(\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))) \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\""], ["proof (prove)\nusing this:\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\n\ngoal (1 subgoal):\n 1. (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n    \\<longlonglongrightarrow> sqrt pi / 2 * erfc x", "."], ["proof (state)\nthis:\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "have \"(\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))) \\<longlonglongrightarrow> erf_remainder_integral 0 x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n    \\<longlonglongrightarrow> erf_remainder_integral 0 x", "using LIMSEQ_erf_remainder_integral[of x 0] assms"], ["proof (prove)\nusing this:\n  0 < x \\<Longrightarrow>\n  (\\<lambda>m.\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * 0)))\n  \\<longlonglongrightarrow> erf_remainder_integral 0 x\n  0 < x\n\ngoal (1 subgoal):\n 1. (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n    \\<longlonglongrightarrow> erf_remainder_integral 0 x", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> erf_remainder_integral 0 x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> erf_remainder_integral 0 x", "show \"erf_remainder_integral 0 x = sqrt pi / 2 * erfc x\""], ["proof (prove)\nusing this:\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> sqrt pi / 2 * erfc x\n  (\\<lambda>m. integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2)))\n  \\<longlonglongrightarrow> erf_remainder_integral 0 x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral 0 x = sqrt pi / 2 * erfc x", "by (intro LIMSEQ_unique)"], ["proof (state)\nthis:\n  erf_remainder_integral 0 x = sqrt pi / 2 * erfc x\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  The first remainder is the @{term erfc} function itself.\n\\<close>"], ["", "lemma erf_remainder_0_conv_erfc: \"x > 0 \\<Longrightarrow> erf_remainder 0 x = erfc x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < x \\<Longrightarrow> erf_remainder 0 x = erfc x", "by (simp add: erf_remainder_def erf_remainder_integral_0_conv_erfc)"], ["", "text \\<open>\n  Also, the following recurrence allows us to get the next term of the asymptotic expansion.\n\\<close>"], ["", "lemma erf_remainder_integral_conv_Suc:\n  assumes \"x > 0\"\n  shows   \"erf_remainder_integral n x = exp (-x\\<^sup>2) / (2*x^(2*n+1)) -\n             real (2*n+1) / 2 * erf_remainder_integral (Suc n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "let ?A = \"\\<lambda>m. {x..x + real m}\""], ["proof (state)\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "let ?J = \"\\<lambda>m n. integral {x..x+real m} (\\<lambda>t. exp(-t\\<^sup>2) / t ^ (2*n))\""], ["proof (state)\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "define I where\n    \"I = (\\<lambda>m. exp (- (x + real m)\\<^sup>2) / (- 2 * (x + real m) ^ (2 * n + 1)) -\n              exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) - real (2*n+1)/2 * ?J m (Suc n))\""], ["proof (state)\nthis:\n  I =\n  (\\<lambda>m.\n      exp (- (x + real m)\\<^sup>2) / (- 2 * (x + real m) ^ (2 * n + 1)) -\n      exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n      real (2 * n + 1) / 2 *\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)))\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "have I_eq: \"I = (\\<lambda>m. integral (?A m) (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I =\n    (\\<lambda>m.\n        integral {x..x + real m}\n         (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m.\n       I m =\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "fix m :: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m.\n       I m =\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "have \"((\\<lambda>t. (-2*t*exp (-(t^2))) * inverse (-2*t^(2*n+1))) has_integral I m) (?A m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         - 2 * t * exp (- t\\<^sup>2) *\n         inverse (- 2 * t ^ (2 * n + 1))) has_integral\n     I m)\n     {x..x + real m}", "proof (rule integration_by_parts[OF bounded_bilinear_mult])"], ["proof (state)\ngoal (6 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} ?f\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       (?f has_vector_derivative - 2 * t * exp (- t\\<^sup>2)) (at t)\n 5. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       ((\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1))) has_vector_derivative\n        ?g' t)\n        (at t)\n 6. ((\\<lambda>t. ?f t * ?g' t) has_integral\n     ?f (x + real m) * inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     ?f x * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "fix t"], ["proof (state)\ngoal (6 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} ?f\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       (?f has_vector_derivative - 2 * t * exp (- t\\<^sup>2)) (at t)\n 5. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       ((\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1))) has_vector_derivative\n        ?g' t)\n        (at t)\n 6. ((\\<lambda>t. ?f t * ?g' t) has_integral\n     ?f (x + real m) * inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     ?f x * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "assume t: \"t \\<in> ?A m\""], ["proof (state)\nthis:\n  t \\<in> {x..x + real m}\n\ngoal (6 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} ?f\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       (?f has_vector_derivative - 2 * t * exp (- t\\<^sup>2)) (at t)\n 5. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       ((\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1))) has_vector_derivative\n        ?g' t)\n        (at t)\n 6. ((\\<lambda>t. ?f t * ?g' t) has_integral\n     ?f (x + real m) * inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     ?f x * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "with assms"], ["proof (chain)\npicking this:\n  0 < x\n  t \\<in> {x..x + real m}", "show \"((\\<lambda>t. exp (-(t^2))) has_vector_derivative -2*t*exp (-(t^2))) (at t)\""], ["proof (prove)\nusing this:\n  0 < x\n  t \\<in> {x..x + real m}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. exp (- t\\<^sup>2)) has_vector_derivative\n     - 2 * t * exp (- t\\<^sup>2))\n     (at t)", "by (auto simp: has_field_derivative_iff_has_vector_derivative [symmetric]\n                       field_simps intro!: derivative_eq_intros)"], ["proof (state)\nthis:\n  ((\\<lambda>t. exp (- t\\<^sup>2)) has_vector_derivative\n   - 2 * t * exp (- t\\<^sup>2))\n   (at t)\n\ngoal (5 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       ((\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1))) has_vector_derivative\n        ?g' t)\n        (at t)\n 5. ((\\<lambda>t. exp (- t\\<^sup>2) * ?g' t) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "from assms t"], ["proof (chain)\npicking this:\n  0 < x\n  t \\<in> {x..x + real m}", "have \"((\\<lambda>t. -(1/2) * t powr (-2*n-1)) has_field_derivative\n                           (2*n+1)/2 * t powr (-2*n-2)) (at t)\""], ["proof (prove)\nusing this:\n  0 < x\n  t \\<in> {x..x + real m}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         - (1 / 2) *\n         t powr real_of_int (- 2 * int n - 1)) has_real_derivative\n     real (2 * n + 1) / 2 * t powr real_of_int (- 2 * int n - 2))\n     (at t)", "by (auto intro!: derivative_eq_intros simp: field_simps powr_numeral power2_eq_square\n                         powr_minus powr_divide [symmetric] powr_add)"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       - (1 / 2) * t powr real_of_int (- 2 * int n - 1)) has_real_derivative\n   real (2 * n + 1) / 2 * t powr real_of_int (- 2 * int n - 2))\n   (at t)\n\ngoal (5 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       ((\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1))) has_vector_derivative\n        ?g' t)\n        (at t)\n 5. ((\\<lambda>t. exp (- t\\<^sup>2) * ?g' t) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "also"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       - (1 / 2) * t powr real_of_int (- 2 * int n - 1)) has_real_derivative\n   real (2 * n + 1) / 2 * t powr real_of_int (- 2 * int n - 2))\n   (at t)\n\ngoal (5 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       ((\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1))) has_vector_derivative\n        ?g' t)\n        (at t)\n 5. ((\\<lambda>t. exp (- t\\<^sup>2) * ?g' t) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "have \"?this \\<longleftrightarrow> ((\\<lambda>t. inverse (-2*t^(2*n+1))) has_field_derivative\n                              (2*n+1)/2 / t ^ (2*Suc n)) (at t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         - (1 / 2) *\n         t powr real_of_int (- 2 * int n - 1)) has_real_derivative\n     real (2 * n + 1) / 2 * t powr real_of_int (- 2 * int n - 2))\n     (at t) =\n    ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_real_derivative\n     real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n     (at t)", "using t"], ["proof (prove)\nusing this:\n  t \\<in> {x..x + real m}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         - (1 / 2) *\n         t powr real_of_int (- 2 * int n - 1)) has_real_derivative\n     real (2 * n + 1) / 2 * t powr real_of_int (- 2 * int n - 2))\n     (at t) =\n    ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_real_derivative\n     real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n     (at t)", "using eventually_nhds_in_open[of \"{0<..}\" t] assms"], ["proof (prove)\nusing this:\n  t \\<in> {x..x + real m}\n  \\<lbrakk>open {0<..}; t \\<in> {0<..}\\<rbrakk>\n  \\<Longrightarrow> \\<forall>\\<^sub>F y in nhds t. y \\<in> {0<..}\n  0 < x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         - (1 / 2) *\n         t powr real_of_int (- 2 * int n - 1)) has_real_derivative\n     real (2 * n + 1) / 2 * t powr real_of_int (- 2 * int n - 2))\n     (at t) =\n    ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_real_derivative\n     real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n     (at t)", "by (intro DERIV_cong_ev refl)\n           (auto elim!: eventually_mono simp: powr_minus field_simps powr_diff\n                        powr_realpow power2_eq_square intro!: real_powr_eq_powerI)"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       - (1 / 2) * t powr real_of_int (- 2 * int n - 1)) has_real_derivative\n   real (2 * n + 1) / 2 * t powr real_of_int (- 2 * int n - 2))\n   (at t) =\n  ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_real_derivative\n   real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n   (at t)\n\ngoal (5 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. \\<And>t.\n       t \\<in> {x..x + real m} \\<Longrightarrow>\n       ((\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1))) has_vector_derivative\n        ?g' t)\n        (at t)\n 5. ((\\<lambda>t. exp (- t\\<^sup>2) * ?g' t) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "finally"], ["proof (chain)\npicking this:\n  ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_real_derivative\n   real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n   (at t)", "show \"((\\<lambda>t. inverse (-2*t^(2*n+1))) has_vector_derivative\n                              (2*n+1)/2 / t ^ (2*Suc n)) (at t)\""], ["proof (prove)\nusing this:\n  ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_real_derivative\n   real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n   (at t)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_vector_derivative\n     real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n     (at t)", "by (simp add: has_field_derivative_iff_has_vector_derivative)"], ["proof (state)\nthis:\n  ((\\<lambda>t. inverse (- 2 * t ^ (2 * n + 1))) has_vector_derivative\n   real (2 * n + 1) / 2 / t ^ (2 * Suc n))\n   (at t)\n\ngoal (4 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "have \"((\\<lambda>t. real (2*n+1)/2 * (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) has_integral\n             real (2*n+1)/2 * ?J m (Suc n)) (?A m)\" (is \"(?f has_integral ?a) _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         real (2 * n + 1) / 2 *\n         (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) has_integral\n     real (2 * n + 1) / 2 *\n     integral {x..x + real m}\n      (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)))\n     {x..x + real m}", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         real (2 * n + 1) / 2 *\n         (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) has_integral\n     real (2 * n + 1) / 2 *\n     integral {x..x + real m}\n      (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)))\n     {x..x + real m}", "by (intro has_integral_mult_right integrable_integral integrable_continuous_real)\n           (auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       real (2 * n + 1) / 2 *\n       (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) has_integral\n   real (2 * n + 1) / 2 *\n   integral {x..x + real m}\n    (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)))\n   {x..x + real m}\n\ngoal (4 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "also"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       real (2 * n + 1) / 2 *\n       (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) has_integral\n   real (2 * n + 1) / 2 *\n   integral {x..x + real m}\n    (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)))\n   {x..x + real m}\n\ngoal (4 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "have \"?f = (\\<lambda>t. exp (- t\\<^sup>2) * (real (2 * n + 1) / 2 / t ^ (2 * Suc n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t.\n        real (2 * n + 1) / 2 * (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) =\n    (\\<lambda>t.\n        exp (- t\\<^sup>2) * (real (2 * n + 1) / 2 / t ^ (2 * Suc n)))", "by (simp add: fun_eq_iff field_simps)"], ["proof (state)\nthis:\n  (\\<lambda>t.\n      real (2 * n + 1) / 2 * (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) =\n  (\\<lambda>t. exp (- t\\<^sup>2) * (real (2 * n + 1) / 2 / t ^ (2 * Suc n)))\n\ngoal (4 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "also"], ["proof (state)\nthis:\n  (\\<lambda>t.\n      real (2 * n + 1) / 2 * (exp (- t\\<^sup>2) / t ^ (2 * Suc n))) =\n  (\\<lambda>t. exp (- t\\<^sup>2) * (real (2 * n + 1) / 2 / t ^ (2 * Suc n)))\n\ngoal (4 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "have \"?a = exp (- (x + real m)\\<^sup>2) * inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n                          exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) - I m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (2 * n + 1) / 2 *\n    integral {x..x + real m}\n     (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)) =\n    exp (- (x + real m)\\<^sup>2) *\n    inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n    exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n    I m", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. real (2 * n + 1) / 2 *\n    integral {x..x + real m}\n     (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)) =\n    exp (- (x + real m)\\<^sup>2) *\n    inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n    exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n    I m", "by (simp add: I_def algebra_simps inverse_eq_divide)"], ["proof (state)\nthis:\n  real (2 * n + 1) / 2 *\n  integral {x..x + real m}\n   (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)) =\n  exp (- (x + real m)\\<^sup>2) *\n  inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n  exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n  I m\n\ngoal (4 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))\n 4. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "finally"], ["proof (chain)\npicking this:\n  ((\\<lambda>t.\n       exp (- t\\<^sup>2) *\n       (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n   exp (- (x + real m)\\<^sup>2) *\n   inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n   exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n   I m)\n   {x..x + real m}", "show \"((\\<lambda>t. exp (- t\\<^sup>2) * (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral \\<dots>)\n                      {x..x + real m}\""], ["proof (prove)\nusing this:\n  ((\\<lambda>t.\n       exp (- t\\<^sup>2) *\n       (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n   exp (- (x + real m)\\<^sup>2) *\n   inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n   exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n   I m)\n   {x..x + real m}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>t.\n         exp (- t\\<^sup>2) *\n         (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n     exp (- (x + real m)\\<^sup>2) *\n     inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n     exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n     I m)\n     {x..x + real m}", "."], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       exp (- t\\<^sup>2) *\n       (real (2 * n + 1) / 2 / t ^ (2 * Suc n))) has_integral\n   exp (- (x + real m)\\<^sup>2) *\n   inverse (- 2 * (x + real m) ^ (2 * n + 1)) -\n   exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n   I m)\n   {x..x + real m}\n\ngoal (3 subgoals):\n 1. x \\<le> x + real m\n 2. continuous_on {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2))\n 3. continuous_on {x..x + real m}\n     (\\<lambda>x. inverse (- 2 * x ^ (2 * n + 1)))", "qed (insert assms, auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  ((\\<lambda>t.\n       - 2 * t * exp (- t\\<^sup>2) *\n       inverse (- 2 * t ^ (2 * n + 1))) has_integral\n   I m)\n   {x..x + real m}\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       I m =\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "hence \"I m = integral {x..x + real m} (\\<lambda>t. - 2*t*exp (- t\\<^sup>2) * inverse (-2*t^(2 * n + 1)))\""], ["proof (prove)\nusing this:\n  ((\\<lambda>t.\n       - 2 * t * exp (- t\\<^sup>2) *\n       inverse (- 2 * t ^ (2 * n + 1))) has_integral\n   I m)\n   {x..x + real m}\n\ngoal (1 subgoal):\n 1. I m =\n    integral {x..x + real m}\n     (\\<lambda>t.\n         - 2 * t * exp (- t\\<^sup>2) * inverse (- 2 * t ^ (2 * n + 1)))", "by (simp add: has_integral_iff)"], ["proof (state)\nthis:\n  I m =\n  integral {x..x + real m}\n   (\\<lambda>t.\n       - 2 * t * exp (- t\\<^sup>2) * inverse (- 2 * t ^ (2 * n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       I m =\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "also"], ["proof (state)\nthis:\n  I m =\n  integral {x..x + real m}\n   (\\<lambda>t.\n       - 2 * t * exp (- t\\<^sup>2) * inverse (- 2 * t ^ (2 * n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       I m =\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "have \"\\<dots> = integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2*n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {x..x + real m}\n     (\\<lambda>t.\n         - 2 * t * exp (- t\\<^sup>2) * inverse (- 2 * t ^ (2 * n + 1))) =\n    integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. integral {x..x + real m}\n     (\\<lambda>t.\n         - 2 * t * exp (- t\\<^sup>2) * inverse (- 2 * t ^ (2 * n + 1))) =\n    integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "by (intro integral_cong) (simp_all add: field_simps)"], ["proof (state)\nthis:\n  integral {x..x + real m}\n   (\\<lambda>t.\n       - 2 * t * exp (- t\\<^sup>2) * inverse (- 2 * t ^ (2 * n + 1))) =\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       I m =\n       integral {x..x + real m}\n        (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "finally"], ["proof (chain)\npicking this:\n  I m =\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "show \"I m = \\<dots>\""], ["proof (prove)\nusing this:\n  I m =\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n\ngoal (1 subgoal):\n 1. I m =\n    integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))", "."], ["proof (state)\nthis:\n  I m =\n  integral {x..x + real m} (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  I =\n  (\\<lambda>m.\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "have \"filterlim (\\<lambda>m. (-exp (- (x + real m)\\<^sup>2)) / (2 * (x + real m) ^ (2 * n + 1)))\n          (nhds 0) at_top\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>m.\n        - exp (- (x + real m)\\<^sup>2) / (2 * (x + real m) ^ (2 * n + 1)))\n    \\<longlonglongrightarrow> 0", "by (rule real_tendsto_divide_at_top filterlim_real_sequentially tendsto_minus\n             filterlim_compose[OF exp_at_bot] filterlim_compose[OF filterlim_uminus_at_bot_at_top]\n             filterlim_pow_at_top filterlim_tendsto_add_at_top tendsto_const filterlim_ident\n             filterlim_tendsto_pos_mult_at_top | simp)+"], ["proof (state)\nthis:\n  (\\<lambda>m.\n      - exp (- (x + real m)\\<^sup>2) / (2 * (x + real m) ^ (2 * n + 1)))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "hence *: \"filterlim (\\<lambda>m. (exp (- (x + real m)\\<^sup>2)) / (-2 * (x + real m) ^ (2 * n + 1)))\n              (nhds 0) at_top\""], ["proof (prove)\nusing this:\n  (\\<lambda>m.\n      - exp (- (x + real m)\\<^sup>2) / (2 * (x + real m) ^ (2 * n + 1)))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. (\\<lambda>m.\n        exp (- (x + real m)\\<^sup>2) / (- 2 * (x + real m) ^ (2 * n + 1)))\n    \\<longlonglongrightarrow> 0", "by (simp add: add_ac)"], ["proof (state)\nthis:\n  (\\<lambda>m.\n      exp (- (x + real m)\\<^sup>2) / (- 2 * (x + real m) ^ (2 * n + 1)))\n  \\<longlonglongrightarrow> 0\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "have \"I \\<longlonglongrightarrow> 0 - exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n                  real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. I \\<longlonglongrightarrow> 0 -\n                                exp (- x\\<^sup>2) *\n                                inverse (- 2 * x ^ (2 * n + 1)) -\n                                real (2 * n + 1) / 2 *\n                                erf_remainder_integral (Suc n) x", "unfolding I_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>m.\n        exp (- (x + real m)\\<^sup>2) / (- 2 * (x + real m) ^ (2 * n + 1)) -\n        exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n        real (2 * n + 1) / 2 *\n        integral {x..x + real m}\n         (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * Suc n)))\n    \\<longlonglongrightarrow> 0 -\n                              exp (- x\\<^sup>2) *\n                              inverse (- 2 * x ^ (2 * n + 1)) -\n                              real (2 * n + 1) / 2 *\n                              erf_remainder_integral (Suc n) x", "by (intro tendsto_diff * tendsto_const tendsto_mult LIMSEQ_erf_remainder_integral assms)"], ["proof (state)\nthis:\n  I \\<longlonglongrightarrow> 0 -\n                              exp (- x\\<^sup>2) *\n                              inverse (- 2 * x ^ (2 * n + 1)) -\n                              real (2 * n + 1) / 2 *\n                              erf_remainder_integral (Suc n) x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "moreover"], ["proof (state)\nthis:\n  I \\<longlonglongrightarrow> 0 -\n                              exp (- x\\<^sup>2) *\n                              inverse (- 2 * x ^ (2 * n + 1)) -\n                              real (2 * n + 1) / 2 *\n                              erf_remainder_integral (Suc n) x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "from LIMSEQ_erf_remainder_integral[OF assms, of n] I_eq"], ["proof (chain)\npicking this:\n  (\\<lambda>m.\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<longlonglongrightarrow> erf_remainder_integral n x\n  I =\n  (\\<lambda>m.\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))", "have \"I \\<longlonglongrightarrow> erf_remainder_integral n x\""], ["proof (prove)\nusing this:\n  (\\<lambda>m.\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n  \\<longlonglongrightarrow> erf_remainder_integral n x\n  I =\n  (\\<lambda>m.\n      integral {x..x + real m}\n       (\\<lambda>t. exp (- t\\<^sup>2) / t ^ (2 * n)))\n\ngoal (1 subgoal):\n 1. I \\<longlonglongrightarrow> erf_remainder_integral n x", "by simp"], ["proof (state)\nthis:\n  I \\<longlonglongrightarrow> erf_remainder_integral n x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "ultimately"], ["proof (chain)\npicking this:\n  I \\<longlonglongrightarrow> 0 -\n                              exp (- x\\<^sup>2) *\n                              inverse (- 2 * x ^ (2 * n + 1)) -\n                              real (2 * n + 1) / 2 *\n                              erf_remainder_integral (Suc n) x\n  I \\<longlonglongrightarrow> erf_remainder_integral n x", "have \"0 - exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) - real (2 * n + 1) / 2 *\n                     erf_remainder_integral (Suc n) x = erf_remainder_integral n x\""], ["proof (prove)\nusing this:\n  I \\<longlonglongrightarrow> 0 -\n                              exp (- x\\<^sup>2) *\n                              inverse (- 2 * x ^ (2 * n + 1)) -\n                              real (2 * n + 1) / 2 *\n                              erf_remainder_integral (Suc n) x\n  I \\<longlonglongrightarrow> erf_remainder_integral n x\n\ngoal (1 subgoal):\n 1. 0 - exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x =\n    erf_remainder_integral n x", "by (rule LIMSEQ_unique)"], ["proof (state)\nthis:\n  0 - exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n  real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x =\n  erf_remainder_integral n x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "thus ?thesis"], ["proof (prove)\nusing this:\n  0 - exp (- x\\<^sup>2) * inverse (- 2 * x ^ (2 * n + 1)) -\n  real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x =\n  erf_remainder_integral n x\n\ngoal (1 subgoal):\n 1. erf_remainder_integral n x =\n    exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n    real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  erf_remainder_integral n x =\n  exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) -\n  real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma erf_remainder_conv_Suc:\n  assumes \"x > 0\"\n  shows   \"erf_remainder n x = (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n                    exp (- x\\<^sup>2) / (x ^ (2 * n + 1)) + erf_remainder (Suc n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "have \"erf_remainder n x =\n          (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n             exp (- x\\<^sup>2) / (2 * x ^ (2 * n + 1)) + -(\n          (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n            real (2 * n + 1) / 2 * erf_remainder_integral (Suc n) x)\" (is \"_ = ?A + ?B\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    (2 * x ^ (2 * n + 1)) +\n    - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n       real (2 * n + 1) /\n       2 *\n       erf_remainder_integral (Suc n) x)", "unfolding erf_remainder_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    erf_remainder_integral n x =\n    (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    (2 * x ^ (2 * n + 1)) +\n    - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n       real (2 * n + 1) /\n       2 *\n       erf_remainder_integral (Suc n) x)", "using assms"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    erf_remainder_integral n x =\n    (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    (2 * x ^ (2 * n + 1)) +\n    - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n       real (2 * n + 1) /\n       2 *\n       erf_remainder_integral (Suc n) x)", "by (subst erf_remainder_integral_conv_Suc)\n       (auto simp: assms algebra_simps simp del: power_Suc)"], ["proof (state)\nthis:\n  erf_remainder n x =\n  (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  (2 * x ^ (2 * n + 1)) +\n  - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n     real (2 * n + 1) /\n     2 *\n     erf_remainder_integral (Suc n) x)\n\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "also"], ["proof (state)\nthis:\n  erf_remainder n x =\n  (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  (2 * x ^ (2 * n + 1)) +\n  - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n     real (2 * n + 1) /\n     2 *\n     erf_remainder_integral (Suc n) x)\n\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "have \"?B = erf_remainder (Suc n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n       real (2 * n + 1) /\n       2 *\n       erf_remainder_integral (Suc n) x) =\n    erf_remainder (Suc n) x", "by (simp add: divide_simps erf_remainder_def)"], ["proof (state)\nthis:\n  - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n     real (2 * n + 1) /\n     2 *\n     erf_remainder_integral (Suc n) x) =\n  erf_remainder (Suc n) x\n\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "also"], ["proof (state)\nthis:\n  - ((- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n     real (2 * n + 1) /\n     2 *\n     erf_remainder_integral (Suc n) x) =\n  erf_remainder (Suc n) x\n\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "have \"?A = (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n                    exp (- x\\<^sup>2) / (x ^ (2 * n + 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    (2 * x ^ (2 * n + 1)) =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1)", "by (simp add: divide_simps)"], ["proof (state)\nthis:\n  (- 1) ^ n * 2 * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  (2 * x ^ (2 * n + 1)) =\n  (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  x ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "finally"], ["proof (chain)\npicking this:\n  erf_remainder n x =\n  (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  x ^ (2 * n + 1) +\n  erf_remainder (Suc n) x", "show ?thesis"], ["proof (prove)\nusing this:\n  erf_remainder n x =\n  (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  x ^ (2 * n + 1) +\n  erf_remainder (Suc n) x\n\ngoal (1 subgoal):\n 1. erf_remainder n x =\n    (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n    exp (- x\\<^sup>2) /\n    x ^ (2 * n + 1) +\n    erf_remainder (Suc n) x", "."], ["proof (state)\nthis:\n  erf_remainder n x =\n  (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  x ^ (2 * n + 1) +\n  erf_remainder (Suc n) x\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  Finally, this gives us the full asymptotic expansion for @{term erfc}:\n\\<close>"], ["", "theorem erfc_unroll:\n  assumes \"x > 0\"\n  shows   \"erfc x = exp (-x\\<^sup>2) / sqrt pi * \n             (\\<Sum>i<n. (-1)^i * fact (2*i) / (4^i*fact i) / x^(2*i+1)) + erf_remainder n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<n.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder n x", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x\n 2. \\<And>n.\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder n x \\<Longrightarrow>\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<Suc n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder (Suc n) x", "case (Suc n)"], ["proof (state)\nthis:\n  erfc x =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder n x\n\ngoal (2 subgoals):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x\n 2. \\<And>n.\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder n x \\<Longrightarrow>\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<Suc n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder (Suc n) x", "note Suc.IH"], ["proof (state)\nthis:\n  erfc x =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder n x\n\ngoal (2 subgoals):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x\n 2. \\<And>n.\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder n x \\<Longrightarrow>\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<Suc n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder (Suc n) x", "also"], ["proof (state)\nthis:\n  erfc x =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder n x\n\ngoal (2 subgoals):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x\n 2. \\<And>n.\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder n x \\<Longrightarrow>\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<Suc n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder (Suc n) x", "note erf_remainder_conv_Suc[OF assms, of n]"], ["proof (state)\nthis:\n  erf_remainder n x =\n  (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  x ^ (2 * n + 1) +\n  erf_remainder (Suc n) x\n\ngoal (2 subgoals):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x\n 2. \\<And>n.\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder n x \\<Longrightarrow>\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<Suc n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder (Suc n) x", "also"], ["proof (state)\nthis:\n  erf_remainder n x =\n  (- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n  exp (- x\\<^sup>2) /\n  x ^ (2 * n + 1) +\n  erf_remainder (Suc n) x\n\ngoal (2 subgoals):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x\n 2. \\<And>n.\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder n x \\<Longrightarrow>\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<Suc n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder (Suc n) x", "have \"exp (- x\\<^sup>2) / sqrt pi *\n               (\\<Sum>i<n. (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2*i+1)) +\n                 ((- 1) ^ n * fact (2*n) / (sqrt pi * 4 ^ n * fact n) * exp (- x\\<^sup>2) / x^(2*n+1) +\n                 erf_remainder (Suc n) x) =\n               exp (- x\\<^sup>2) / sqrt pi *\n                 (\\<Sum>i<Suc n. (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n                 erf_remainder (Suc n) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<n.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    ((- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n     exp (- x\\<^sup>2) /\n     x ^ (2 * n + 1) +\n     erf_remainder (Suc n) x) =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<Suc n.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder (Suc n) x", "by (subst sum.lessThan_Suc) (simp add: algebra_simps)"], ["proof (state)\nthis:\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  ((- 1) ^ n * fact (2 * n) / (sqrt pi * 4 ^ n * fact n) *\n   exp (- x\\<^sup>2) /\n   x ^ (2 * n + 1) +\n   erf_remainder (Suc n) x) =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<Suc n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder (Suc n) x\n\ngoal (2 subgoals):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x\n 2. \\<And>n.\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder n x \\<Longrightarrow>\n       erfc x =\n       exp (- x\\<^sup>2) / sqrt pi *\n       (\\<Sum>i<Suc n.\n           (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n       erf_remainder (Suc n) x", "finally"], ["proof (chain)\npicking this:\n  erfc x =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<Suc n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder (Suc n) x", "show ?case"], ["proof (prove)\nusing this:\n  erfc x =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<Suc n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder (Suc n) x\n\ngoal (1 subgoal):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<Suc n.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder (Suc n) x", "."], ["proof (state)\nthis:\n  erfc x =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<Suc n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder (Suc n) x\n\ngoal (1 subgoal):\n 1. erfc x =\n    exp (- x\\<^sup>2) / sqrt pi *\n    (\\<Sum>i<0.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder 0 x", "qed (auto simp: assms erf_remainder_0_conv_erfc)"], ["", "text \\<open>\n  For convenience, we define another auxiliary function that is more suitable for use in an \n  automated expansion framework, since it has a simple asymptotic expansion in powers of $x$.\n\\<close>"], ["", "definition erfc_aux where \"erfc_aux x = exp (x\\<^sup>2) * sqrt pi * erfc x\""], ["", "definition erf_remainder' where \"erf_remainder' n x = exp (x\\<^sup>2) * sqrt pi * erf_remainder n x\""], ["", "lemma erfc_aux_unroll: \n  \"x > 0 \\<Longrightarrow> \n     erfc_aux x = (\\<Sum>i<n. (-1)^i * fact (2*i) / (4^i*fact i) / x^(2*i+1)) + erf_remainder' n x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < x \\<Longrightarrow>\n    erfc_aux x =\n    (\\<Sum>i<n.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder' n x", "using erfc_unroll[of x n]"], ["proof (prove)\nusing this:\n  0 < x \\<Longrightarrow>\n  erfc x =\n  exp (- x\\<^sup>2) / sqrt pi *\n  (\\<Sum>i<n.\n      (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n  erf_remainder n x\n\ngoal (1 subgoal):\n 1. 0 < x \\<Longrightarrow>\n    erfc_aux x =\n    (\\<Sum>i<n.\n        (- 1) ^ i * fact (2 * i) / (4 ^ i * fact i) / x ^ (2 * i + 1)) +\n    erf_remainder' n x", "by (simp add: erfc_aux_def erf_remainder'_def exp_minus field_simps del: of_nat_Suc)"], ["", "lemma erf_remainder'_bigo: \"erf_remainder' n \\<in> O(\\<lambda>x. 1 / x ^ (2*n+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. erf_remainder' n \\<in> O(\\<lambda>x. 1 / x ^ (2 * n + 1))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. erf_remainder' n \\<in> O(\\<lambda>x. 1 / x ^ (2 * n + 1))", "have \"(\\<lambda>x. exp (x\\<^sup>2) * erf_remainder n x) \\<in> O(\\<lambda>x. exp (x\\<^sup>2) * (exp (-x\\<^sup>2) / x ^ (2*n+1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. exp (x\\<^sup>2) * erf_remainder n x)\n    \\<in> O(\\<lambda>x.\n               exp (x\\<^sup>2) * (exp (- x\\<^sup>2) / x ^ (2 * n + 1)))", "by (intro landau_o.big.mult erf_remainder_bigo) simp_all"], ["proof (state)\nthis:\n  (\\<lambda>x. exp (x\\<^sup>2) * erf_remainder n x)\n  \\<in> O(\\<lambda>x.\n             exp (x\\<^sup>2) * (exp (- x\\<^sup>2) / x ^ (2 * n + 1)))\n\ngoal (1 subgoal):\n 1. erf_remainder' n \\<in> O(\\<lambda>x. 1 / x ^ (2 * n + 1))", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>x. exp (x\\<^sup>2) * erf_remainder n x)\n  \\<in> O(\\<lambda>x.\n             exp (x\\<^sup>2) * (exp (- x\\<^sup>2) / x ^ (2 * n + 1)))\n\ngoal (1 subgoal):\n 1. erf_remainder' n \\<in> O(\\<lambda>x. 1 / x ^ (2 * n + 1))", "by (simp add: exp_minus erf_remainder'_def [abs_def])"], ["proof (state)\nthis:\n  erf_remainder' n \\<in> O(\\<lambda>x. 1 / x ^ (2 * n + 1))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma has_field_derivative_erfc_aux: \n    \"(erfc_aux has_field_derivative (2 * x * erfc_aux x - 2)) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (erfc_aux has_real_derivative 2 * x * erfc_aux x - 2) (at x)", "by (auto simp: erfc_aux_def [abs_def] exp_minus field_simps intro!: derivative_eq_intros)"], ["", "end"]]}