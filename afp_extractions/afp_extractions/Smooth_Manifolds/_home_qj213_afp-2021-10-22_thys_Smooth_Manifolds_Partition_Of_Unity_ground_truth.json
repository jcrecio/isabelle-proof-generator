{"file_name": "/home/qj213/afp-2021-10-22/thys/Smooth_Manifolds/Partition_Of_Unity.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Smooth_Manifolds", "problem_names": ["lemma reguler_refinementE:\n  fixes \\<X>::\"'i \\<Rightarrow> 'a set\"\n  assumes cover: \"carrier \\<subseteq> (\\<Union>i\\<in>I. \\<X> i)\" and open_cover: \"\\<And>i. i \\<in> I \\<Longrightarrow> open (\\<X> i)\"\n  obtains N::\"nat set\" and \\<psi>::\"nat \\<Rightarrow> ('a, 'b) chart\"\n  where \"\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas\" \"(domain o \\<psi>) ` N refines \\<X> ` I\" \"regular_cover N \\<psi>\"", "lemma diff_apply_chart:\n  \"diff k (charts_submanifold (domain \\<psi>)) charts_eucl \\<psi>\" if \"\\<psi> \\<in> atlas\"", "lemma diff_inv_chart:\n  \"diff k (manifold_eucl.charts_submanifold (codomain c)) charts (inv_chart c)\" if \"c \\<in> atlas\"", "lemma chart_inj_on [simp]:\n  fixes c :: \"('a, 'b) chart\"\n  assumes \"x \\<in> domain c\" \"y \\<in> domain c\"\n  shows \"c x = c y \\<longleftrightarrow> x = y\"", "theorem partitions_of_unityE:\n  fixes A::\"'i set\" and X::\"'i \\<Rightarrow> 'a set\"\n  assumes \"carrier \\<subseteq> (\\<Union>i\\<in>A. X i)\"\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> open (X i)\"\n  obtains \\<phi>::\"'i \\<Rightarrow> 'a \\<Rightarrow> real\"\n  where \"\\<And>i. i \\<in> A \\<Longrightarrow> diff_fun k charts (\\<phi> i)\"\n    and \"\\<And>i x. i \\<in> A \\<Longrightarrow> x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> i x\"\n    and \"\\<And>i x. i \\<in> A \\<Longrightarrow> x \\<in> carrier \\<Longrightarrow> \\<phi> i x \\<le> 1\"\n    and \"\\<And>x. x \\<in> carrier \\<Longrightarrow> (\\<Sum>i\\<in>{i\\<in>A. \\<phi> i x \\<noteq> 0}. \\<phi> i x) = 1\"\n    and \"\\<And>i. i \\<in> A \\<Longrightarrow> csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i\"\n    and \"locally_finite_on carrier A (\\<lambda>i. csupport_on carrier (\\<phi> i))\"", "lemma smooth_bump_functionE:\n  assumes \"closedin (top_of_set carrier) A\"\n    and \"A \\<subseteq> U\" \"U \\<subseteq> carrier\" \"open U\"\n  obtains \\<psi>::\"'a \\<Rightarrow> real\" where\n    \"diff_fun k charts \\<psi>\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1\"\n    \"csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\"", "lemma diff_fun_onE:\n  assumes \"diff_fun_on A f\"\n  obtains W f' where\n    \"A \\<subseteq> W\" \"W \\<subseteq> carrier\" \"open W\" \"diff_fun k (charts_submanifold W) f'\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\"", "lemma diff_fun_onI:\n  assumes  \"A \\<subseteq> W\" \"W \\<subseteq> carrier\" \"open W\" \"diff_fun k (charts_submanifold W) f'\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\"\n  shows \"diff_fun_on A f\"", "lemma extension_lemmaE:\n  fixes f::\"'a \\<Rightarrow> 'e::euclidean_space\"\n  assumes \"closedin (top_of_set carrier) A\"\n  assumes \"diff_fun_on A f\" \"A \\<subseteq> U\" \"U \\<subseteq> carrier\" \"open U\"\n  obtains f' where\n    \"diff_fun k charts f'\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x\"\n    \"csupport_on carrier f' \\<inter> carrier \\<subseteq> U\""], "translations": [["", "lemma reguler_refinementE:\n  fixes \\<X>::\"'i \\<Rightarrow> 'a set\"\n  assumes cover: \"carrier \\<subseteq> (\\<Union>i\\<in>I. \\<X> i)\" and open_cover: \"\\<And>i. i \\<in> I \\<Longrightarrow> open (\\<X> i)\"\n  obtains N::\"nat set\" and \\<psi>::\"nat \\<Rightarrow> ('a, 'b) chart\"\n  where \"\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas\" \"(domain o \\<psi>) ` N refines \\<X> ` I\" \"regular_cover N \\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from precompact_locally_finite_open_coverE"], ["proof (chain)\npicking this:\n  (\\<And>W.\n      \\<lbrakk>carrier = \\<Union> (range W); \\<And>i. open (W i);\n       \\<And>i. compact (closure (W i));\n       \\<And>i. closure (W i) \\<subseteq> carrier;\n       locally_finite_on carrier UNIV W\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain V::\"nat\\<Rightarrow>_\" where V:\n    \"carrier = (\\<Union>i. V i)\"\n    \"\\<And>i. open (V i)\"\n    \"\\<And>i. compact (closure (V i))\"\n    \"\\<And>i. closure (V i) \\<subseteq> carrier\"\n    \"locally_finite_on carrier UNIV V\""], ["proof (prove)\nusing this:\n  (\\<And>W.\n      \\<lbrakk>carrier = \\<Union> (range W); \\<And>i. open (W i);\n       \\<And>i. compact (closure (W i));\n       \\<And>i. closure (W i) \\<subseteq> carrier;\n       locally_finite_on carrier UNIV W\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>carrier = \\<Union> (range V); \\<And>i. open (V i);\n         \\<And>i. compact (closure (V i));\n         \\<And>i. closure (V i) \\<subseteq> carrier;\n         locally_finite_on carrier UNIV V\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  carrier = \\<Union> (range V)\n  open (V ?i2)\n  compact (closure (V ?i2))\n  closure (V ?i2) \\<subseteq> carrier\n  locally_finite_on carrier UNIV V\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define intersecting where \"intersecting v = {i. V i \\<inter> v \\<noteq> {}}\" for v"], ["proof (state)\nthis:\n  intersecting ?v = {i. V i \\<inter> ?v \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have intersecting_closure: \"intersecting (closure x) = intersecting x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. intersecting (closure x) = intersecting x", "using open_Int_closure_eq_empty[OF V(2), of _ x]"], ["proof (prove)\nusing this:\n  (V ?i3 \\<inter> closure x = {}) = (V ?i3 \\<inter> x = {})\n\ngoal (1 subgoal):\n 1. intersecting (closure x) = intersecting x", "by (auto simp: intersecting_def)"], ["proof (state)\nthis:\n  intersecting (closure ?x2) = intersecting ?x2\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from locally_finite_compactD[OF V(5) V(3) V(4)]"], ["proof (chain)\npicking this:\n  finite {i \\<in> UNIV. V i \\<inter> closure (V ?i3) \\<noteq> {}}", "have \"finite (intersecting (closure (V x)))\" for x"], ["proof (prove)\nusing this:\n  finite {i \\<in> UNIV. V i \\<inter> closure (V ?i3) \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. finite (intersecting (closure (V x)))", "by (simp add: intersecting_def)"], ["proof (state)\nthis:\n  finite (intersecting (closure (V ?x2)))\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  finite (intersecting (closure (V ?x2)))", "have finite_intersecting: \"finite (intersecting (V x))\" for x"], ["proof (prove)\nusing this:\n  finite (intersecting (closure (V ?x2)))\n\ngoal (1 subgoal):\n 1. finite (intersecting (V x))", "by (simp add: intersecting_closure)"], ["proof (state)\nthis:\n  finite (intersecting (V ?x2))\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<exists>\\<psi>::('a, 'b) chart.\n    \\<psi> \\<in> atlas \\<and>\n    codomain \\<psi> = ball 0 3 \\<and>\n    (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n     (\\<forall>j. p \\<in> V j \\<longrightarrow> domain \\<psi> \\<subseteq> V j) \\<and>\n      p \\<in> domain \\<psi> \\<and>\n      \\<psi> p = 0\"\n    if \"p \\<in> carrier\" for p"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "from cover that open_cover"], ["proof (chain)\npicking this:\n  carrier \\<subseteq> \\<Union> (\\<X> ` I)\n  p \\<in> carrier\n  ?i2 \\<in> I \\<Longrightarrow> open (\\<X> ?i2)", "obtain c where c: \"p \\<in> \\<X> c\" \"open (\\<X> c)\" \"c \\<in> I\""], ["proof (prove)\nusing this:\n  carrier \\<subseteq> \\<Union> (\\<X> ` I)\n  p \\<in> carrier\n  ?i2 \\<in> I \\<Longrightarrow> open (\\<X> ?i2)\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        \\<lbrakk>p \\<in> \\<X> c; open (\\<X> c); c \\<in> I\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  p \\<in> \\<X> c\n  open (\\<X> c)\n  c \\<in> I\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "define VS where \"VS = {U. p \\<in> V U}\""], ["proof (state)\nthis:\n  VS = {U. p \\<in> V U}\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "have open_VS: \"\\<And>T. T \\<in> VS \\<Longrightarrow> open (V T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>T. T \\<in> VS \\<Longrightarrow> open (V T)", "by (auto simp: VS_def V)"], ["proof (state)\nthis:\n  ?T2 \\<in> VS \\<Longrightarrow> open (V ?T2)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "from locally_finite_onD[OF V(5) that]"], ["proof (chain)\npicking this:\n  finite {i \\<in> UNIV. p \\<in> V i}", "have \"finite VS\""], ["proof (prove)\nusing this:\n  finite {i \\<in> UNIV. p \\<in> V i}\n\ngoal (1 subgoal):\n 1. finite VS", "by (simp add: VS_def)"], ["proof (state)\nthis:\n  finite VS\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "from atlasE[OF that]"], ["proof (chain)\npicking this:\n  (\\<And>c.\n      \\<lbrakk>c \\<in> atlas; p \\<in> domain c\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain \\<psi>' where \\<psi>': \"\\<psi>' \\<in> atlas\" \"p \\<in> domain \\<psi>'\""], ["proof (prove)\nusing this:\n  (\\<And>c.\n      \\<lbrakk>c \\<in> atlas; p \\<in> domain c\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>'.\n        \\<lbrakk>\\<psi>' \\<in> atlas; p \\<in> domain \\<psi>'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "."], ["proof (state)\nthis:\n  \\<psi>' \\<in> atlas\n  p \\<in> domain \\<psi>'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "define W where  \"W = (\\<Inter>i\\<in>VS. V i) \\<inter> domain \\<psi>' \\<inter> \\<X> c\""], ["proof (state)\nthis:\n  W = \\<Inter> (V ` VS) \\<inter> domain \\<psi>' \\<inter> \\<X> c\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "have \"open W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open W", "by (force simp: W_def open_VS intro!: c \\<open>finite VS\\<close>)"], ["proof (state)\nthis:\n  open W\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "have \"p \\<in> W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> W", "by (auto simp: W_def c \\<psi>' VS_def)"], ["proof (state)\nthis:\n  p \\<in> W\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "have \"W \\<subseteq> carrier\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W \\<subseteq> carrier", "using \\<psi>'"], ["proof (prove)\nusing this:\n  \\<psi>' \\<in> atlas\n  p \\<in> domain \\<psi>'\n\ngoal (1 subgoal):\n 1. W \\<subseteq> carrier", "by (auto simp: W_def)"], ["proof (state)\nthis:\n  W \\<subseteq> carrier\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "have \"0 < (3::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 3", "by auto"], ["proof (state)\nthis:\n  0 < 3\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "from open_centered_ball_chartE[OF \\<open>p \\<in> W\\<close> \\<open>open W\\<close> \\<open>W \\<subseteq> carrier\\<close> \\<open>0 < 3\\<close>]"], ["proof (chain)\npicking this:\n  (\\<And>c.\n      \\<lbrakk>c \\<in> atlas; p \\<in> domain c; apply_chart c p = ?x0.0;\n       domain c \\<subseteq> W; codomain c = ball ?x0.0 3\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain \\<psi> where \\<psi>: \"\\<psi> \\<in> atlas\" \"p \\<in> domain \\<psi>\" \"\\<psi> p = 0\" \"domain \\<psi> \\<subseteq> W\" \"codomain \\<psi> = ball 0 3\""], ["proof (prove)\nusing this:\n  (\\<And>c.\n      \\<lbrakk>c \\<in> atlas; p \\<in> domain c; apply_chart c p = ?x0.0;\n       domain c \\<subseteq> W; codomain c = ball ?x0.0 3\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>\\<psi> \\<in> atlas; p \\<in> domain \\<psi>;\n         apply_chart \\<psi> p = (0::'b); domain \\<psi> \\<subseteq> W;\n         codomain \\<psi> = ball (0::'b) 3\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  \\<psi> \\<in> atlas\n  p \\<in> domain \\<psi>\n  apply_chart \\<psi> p = (0::'b)\n  domain \\<psi> \\<subseteq> W\n  codomain \\<psi> = ball (0::'b) 3\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "moreover"], ["proof (state)\nthis:\n  \\<psi> \\<in> atlas\n  p \\<in> domain \\<psi>\n  apply_chart \\<psi> p = (0::'b)\n  domain \\<psi> \\<subseteq> W\n  codomain \\<psi> = ball (0::'b) 3\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "have \"\\<exists>x\\<in>I. domain \\<psi> \\<subseteq> \\<X> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>I. domain \\<psi> \\<subseteq> \\<X> x", "using c \\<psi>"], ["proof (prove)\nusing this:\n  p \\<in> \\<X> c\n  open (\\<X> c)\n  c \\<in> I\n  \\<psi> \\<in> atlas\n  p \\<in> domain \\<psi>\n  apply_chart \\<psi> p = (0::'b)\n  domain \\<psi> \\<subseteq> W\n  codomain \\<psi> = ball (0::'b) 3\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>I. domain \\<psi> \\<subseteq> \\<X> x", "by (auto simp: W_def)"], ["proof (state)\nthis:\n  \\<exists>x\\<in>I. domain \\<psi> \\<subseteq> \\<X> x\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "moreover"], ["proof (state)\nthis:\n  \\<exists>x\\<in>I. domain \\<psi> \\<subseteq> \\<X> x\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "have \"p \\<in> V j \\<Longrightarrow> domain \\<psi> \\<subseteq> V j\" for j"], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> V j \\<Longrightarrow> domain \\<psi> \\<subseteq> V j", "using c \\<psi>"], ["proof (prove)\nusing this:\n  p \\<in> \\<X> c\n  open (\\<X> c)\n  c \\<in> I\n  \\<psi> \\<in> atlas\n  p \\<in> domain \\<psi>\n  apply_chart \\<psi> p = (0::'b)\n  domain \\<psi> \\<subseteq> W\n  codomain \\<psi> = ball (0::'b) 3\n\ngoal (1 subgoal):\n 1. p \\<in> V j \\<Longrightarrow> domain \\<psi> \\<subseteq> V j", "by (auto simp: W_def VS_def)"], ["proof (state)\nthis:\n  p \\<in> V ?j2 \\<Longrightarrow> domain \\<psi> \\<subseteq> V ?j2\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "ultimately"], ["proof (chain)\npicking this:\n  \\<psi> \\<in> atlas\n  p \\<in> domain \\<psi>\n  apply_chart \\<psi> p = (0::'b)\n  domain \\<psi> \\<subseteq> W\n  codomain \\<psi> = ball (0::'b) 3\n  \\<exists>x\\<in>I. domain \\<psi> \\<subseteq> \\<X> x\n  p \\<in> V ?j2 \\<Longrightarrow> domain \\<psi> \\<subseteq> V ?j2", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<psi> \\<in> atlas\n  p \\<in> domain \\<psi>\n  apply_chart \\<psi> p = (0::'b)\n  domain \\<psi> \\<subseteq> W\n  codomain \\<psi> = ball (0::'b) 3\n  \\<exists>x\\<in>I. domain \\<psi> \\<subseteq> \\<X> x\n  p \\<in> V ?j2 \\<Longrightarrow> domain \\<psi> \\<subseteq> V ?j2\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<psi> \\<in> atlas \\<and>\n       codomain \\<psi> = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p \\<in> V j \\<longrightarrow>\n           domain \\<psi> \\<subseteq> V j) \\<and>\n       p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)", "by (intro exI[where x=\\<psi>]) auto"], ["proof (state)\nthis:\n  \\<exists>\\<psi>.\n     \\<psi> \\<in> atlas \\<and>\n     codomain \\<psi> = ball (0::'b) 3 \\<and>\n     (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n     (\\<forall>j.\n         p \\<in> V j \\<longrightarrow> domain \\<psi> \\<subseteq> V j) \\<and>\n     p \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p = (0::'b)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?p2 \\<in> carrier \\<Longrightarrow>\n  \\<exists>\\<psi>.\n     \\<psi> \\<in> atlas \\<and>\n     codomain \\<psi> = ball (0::'b) 3 \\<and>\n     (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n     (\\<forall>j.\n         ?p2 \\<in> V j \\<longrightarrow>\n         domain \\<psi> \\<subseteq> V j) \\<and>\n     ?p2 \\<in> domain \\<psi> \\<and> apply_chart \\<psi> ?p2 = (0::'b)\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  ?p2 \\<in> carrier \\<Longrightarrow>\n  \\<exists>\\<psi>.\n     \\<psi> \\<in> atlas \\<and>\n     codomain \\<psi> = ball (0::'b) 3 \\<and>\n     (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n     (\\<forall>j.\n         ?p2 \\<in> V j \\<longrightarrow>\n         domain \\<psi> \\<subseteq> V j) \\<and>\n     ?p2 \\<in> domain \\<psi> \\<and> apply_chart \\<psi> ?p2 = (0::'b)", "have \"\\<forall>p2 \\<in> carrier.\n    \\<exists>\\<psi>::('a, 'b) chart. \\<psi> \\<in> atlas \\<and> codomain \\<psi> = ball 0 3 \\<and>\n         (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and> (\\<forall>j. p2 \\<in> V j \\<longrightarrow> domain \\<psi> \\<subseteq> V j) \\<and> p2 \\<in> domain \\<psi> \\<and>\n         apply_chart \\<psi> p2 = 0\""], ["proof (prove)\nusing this:\n  ?p2 \\<in> carrier \\<Longrightarrow>\n  \\<exists>\\<psi>.\n     \\<psi> \\<in> atlas \\<and>\n     codomain \\<psi> = ball (0::'b) 3 \\<and>\n     (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n     (\\<forall>j.\n         ?p2 \\<in> V j \\<longrightarrow>\n         domain \\<psi> \\<subseteq> V j) \\<and>\n     ?p2 \\<in> domain \\<psi> \\<and> apply_chart \\<psi> ?p2 = (0::'b)\n\ngoal (1 subgoal):\n 1. \\<forall>p2\\<in>carrier.\n       \\<exists>\\<psi>.\n          \\<psi> \\<in> atlas \\<and>\n          codomain \\<psi> = ball (0::'b) 3 \\<and>\n          (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n          (\\<forall>j.\n              p2 \\<in> V j \\<longrightarrow>\n              domain \\<psi> \\<subseteq> V j) \\<and>\n          p2 \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p2 = (0::'b)", "by blast"], ["proof (state)\nthis:\n  \\<forall>p2\\<in>carrier.\n     \\<exists>\\<psi>.\n        \\<psi> \\<in> atlas \\<and>\n        codomain \\<psi> = ball (0::'b) 3 \\<and>\n        (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n        (\\<forall>j.\n            p2 \\<in> V j \\<longrightarrow>\n            domain \\<psi> \\<subseteq> V j) \\<and>\n        p2 \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p2 = (0::'b)\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  \\<forall>p2\\<in>carrier.\n     \\<exists>\\<psi>.\n        \\<psi> \\<in> atlas \\<and>\n        codomain \\<psi> = ball (0::'b) 3 \\<and>\n        (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n        (\\<forall>j.\n            p2 \\<in> V j \\<longrightarrow>\n            domain \\<psi> \\<subseteq> V j) \\<and>\n        p2 \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p2 = (0::'b)", "obtain \\<psi>::\"'a \\<Rightarrow> ('a, 'b) chart\" where \\<psi>:\n    \"\\<And>p. p \\<in> carrier \\<Longrightarrow> codomain (\\<psi> p) = ball 0 3\"\n    \"\\<And>p. p \\<in> carrier \\<Longrightarrow> (\\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c)\"\n    \"\\<And>p j. p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j\"\n    \"\\<And>p j. p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p)\"\n    \"\\<And>p. p \\<in> carrier \\<Longrightarrow> (\\<psi> p) p = 0\"\n    \"\\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas\""], ["proof (prove)\nusing this:\n  \\<forall>p2\\<in>carrier.\n     \\<exists>\\<psi>.\n        \\<psi> \\<in> atlas \\<and>\n        codomain \\<psi> = ball (0::'b) 3 \\<and>\n        (\\<exists>c\\<in>I. domain \\<psi> \\<subseteq> \\<X> c) \\<and>\n        (\\<forall>j.\n            p2 \\<in> V j \\<longrightarrow>\n            domain \\<psi> \\<subseteq> V j) \\<and>\n        p2 \\<in> domain \\<psi> \\<and> apply_chart \\<psi> p2 = (0::'b)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>\\<And>p.\n                    p \\<in> carrier \\<Longrightarrow>\n                    codomain (\\<psi> p) = ball (0::'b) 3;\n         \\<And>p.\n            p \\<in> carrier \\<Longrightarrow>\n            \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n         \\<And>p j.\n            p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n         \\<And>p j.\n            p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n         \\<And>p.\n            p \\<in> carrier \\<Longrightarrow>\n            apply_chart (\\<psi> p) p = (0::'b);\n         \\<And>p.\n            p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding bchoice_iff"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     \\<forall>p2\\<in>carrier.\n        f p2 \\<in> atlas \\<and>\n        codomain (f p2) = ball (0::'b) 3 \\<and>\n        (\\<exists>c\\<in>I. domain (f p2) \\<subseteq> \\<X> c) \\<and>\n        (\\<forall>j.\n            p2 \\<in> V j \\<longrightarrow>\n            domain (f p2) \\<subseteq> V j) \\<and>\n        p2 \\<in> domain (f p2) \\<and> apply_chart (f p2) p2 = (0::'b)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>\\<And>p.\n                    p \\<in> carrier \\<Longrightarrow>\n                    codomain (\\<psi> p) = ball (0::'b) 3;\n         \\<And>p.\n            p \\<in> carrier \\<Longrightarrow>\n            \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n         \\<And>p j.\n            p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n         \\<And>p j.\n            p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n         \\<And>p.\n            p \\<in> carrier \\<Longrightarrow>\n            apply_chart (\\<psi> p) p = (0::'b);\n         \\<And>p.\n            p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "apply atomize_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f.\n       \\<forall>p2\\<in>carrier.\n          f p2 \\<in> atlas \\<and>\n          codomain (f p2) = ball (0::'b) 3 \\<and>\n          (\\<exists>c\\<in>I. domain (f p2) \\<subseteq> \\<X> c) \\<and>\n          (\\<forall>j.\n              p2 \\<in> V j \\<longrightarrow>\n              domain (f p2) \\<subseteq> V j) \\<and>\n          p2 \\<in> domain (f p2) \\<and>\n          apply_chart (f p2) p2 = (0::'b) \\<Longrightarrow>\n    \\<exists>\\<psi>.\n       (\\<forall>p.\n           p \\<in> carrier \\<longrightarrow>\n           codomain (\\<psi> p) = ball (0::'b) 3) \\<and>\n       (\\<forall>p.\n           p \\<in> carrier \\<longrightarrow>\n           (\\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c)) \\<and>\n       (\\<forall>p j.\n           p \\<in> V j \\<longrightarrow>\n           domain (\\<psi> p) \\<subseteq> V j) \\<and>\n       (\\<forall>p j.\n           p \\<in> carrier \\<longrightarrow>\n           p \\<in> domain (\\<psi> p)) \\<and>\n       (\\<forall>p.\n           p \\<in> carrier \\<longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b)) \\<and>\n       (\\<forall>p. p \\<in> carrier \\<longrightarrow> \\<psi> p \\<in> atlas)", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>p2\\<in>carrier.\n          f p2 \\<in> atlas \\<and>\n          codomain (f p2) = ball (0::'b) 3 \\<and>\n          (\\<exists>c\\<in>I. domain (f p2) \\<subseteq> \\<X> c) \\<and>\n          (\\<forall>j.\n              p2 \\<in> V j \\<longrightarrow>\n              domain (f p2) \\<subseteq> V j) \\<and>\n          p2 \\<in> domain (f p2) \\<and>\n          apply_chart (f p2) p2 = (0::'b) \\<Longrightarrow>\n       \\<exists>\\<psi>.\n          (\\<forall>p.\n              p \\<in> carrier \\<longrightarrow>\n              codomain (\\<psi> p) = ball (0::'b) 3) \\<and>\n          (\\<forall>p.\n              p \\<in> carrier \\<longrightarrow>\n              (\\<exists>c\\<in>I.\n                  domain (\\<psi> p) \\<subseteq> \\<X> c)) \\<and>\n          (\\<forall>p j.\n              p \\<in> V j \\<longrightarrow>\n              domain (\\<psi> p) \\<subseteq> V j) \\<and>\n          (\\<forall>p.\n              p \\<in> carrier \\<longrightarrow>\n              p \\<in> domain (\\<psi> p)) \\<and>\n          (\\<forall>p.\n              p \\<in> carrier \\<longrightarrow>\n              apply_chart (\\<psi> p) p = (0::'b)) \\<and>\n          (\\<forall>p.\n              p \\<in> carrier \\<longrightarrow> \\<psi> p \\<in> atlas)", "subgoal for f"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>p2\\<in>carrier.\n       f p2 \\<in> atlas \\<and>\n       codomain (f p2) = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain (f p2) \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p2 \\<in> V j \\<longrightarrow>\n           domain (f p2) \\<subseteq> V j) \\<and>\n       p2 \\<in> domain (f p2) \\<and>\n       apply_chart (f p2) p2 = (0::'b) \\<Longrightarrow>\n    \\<exists>\\<psi>.\n       (\\<forall>p.\n           p \\<in> carrier \\<longrightarrow>\n           codomain (\\<psi> p) = ball (0::'b) 3) \\<and>\n       (\\<forall>p.\n           p \\<in> carrier \\<longrightarrow>\n           (\\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c)) \\<and>\n       (\\<forall>p j.\n           p \\<in> V j \\<longrightarrow>\n           domain (\\<psi> p) \\<subseteq> V j) \\<and>\n       (\\<forall>p.\n           p \\<in> carrier \\<longrightarrow>\n           p \\<in> domain (\\<psi> p)) \\<and>\n       (\\<forall>p.\n           p \\<in> carrier \\<longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b)) \\<and>\n       (\\<forall>p. p \\<in> carrier \\<longrightarrow> \\<psi> p \\<in> atlas)", "apply (rule exI[where x=f])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>p2\\<in>carrier.\n       f p2 \\<in> atlas \\<and>\n       codomain (f p2) = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain (f p2) \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p2 \\<in> V j \\<longrightarrow>\n           domain (f p2) \\<subseteq> V j) \\<and>\n       p2 \\<in> domain (f p2) \\<and>\n       apply_chart (f p2) p2 = (0::'b) \\<Longrightarrow>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow>\n        codomain (f p) = ball (0::'b) 3) \\<and>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow>\n        (\\<exists>c\\<in>I. domain (f p) \\<subseteq> \\<X> c)) \\<and>\n    (\\<forall>p j.\n        p \\<in> V j \\<longrightarrow> domain (f p) \\<subseteq> V j) \\<and>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow> p \\<in> domain (f p)) \\<and>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow>\n        apply_chart (f p) p = (0::'b)) \\<and>\n    (\\<forall>p. p \\<in> carrier \\<longrightarrow> f p \\<in> atlas)", "using V"], ["proof (prove)\nusing this:\n  carrier = \\<Union> (range V)\n  open (V ?i2)\n  compact (closure (V ?i2))\n  closure (V ?i2) \\<subseteq> carrier\n  locally_finite_on carrier UNIV V\n\ngoal (1 subgoal):\n 1. \\<forall>p2\\<in>carrier.\n       f p2 \\<in> atlas \\<and>\n       codomain (f p2) = ball (0::'b) 3 \\<and>\n       (\\<exists>c\\<in>I. domain (f p2) \\<subseteq> \\<X> c) \\<and>\n       (\\<forall>j.\n           p2 \\<in> V j \\<longrightarrow>\n           domain (f p2) \\<subseteq> V j) \\<and>\n       p2 \\<in> domain (f p2) \\<and>\n       apply_chart (f p2) p2 = (0::'b) \\<Longrightarrow>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow>\n        codomain (f p) = ball (0::'b) 3) \\<and>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow>\n        (\\<exists>c\\<in>I. domain (f p) \\<subseteq> \\<X> c)) \\<and>\n    (\\<forall>p j.\n        p \\<in> V j \\<longrightarrow> domain (f p) \\<subseteq> V j) \\<and>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow> p \\<in> domain (f p)) \\<and>\n    (\\<forall>p.\n        p \\<in> carrier \\<longrightarrow>\n        apply_chart (f p) p = (0::'b)) \\<and>\n    (\\<forall>p. p \\<in> carrier \\<longrightarrow> f p \\<in> atlas)", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ?p3 \\<in> carrier \\<Longrightarrow> codomain (\\<psi> ?p3) = ball (0::'b) 3\n  ?p3 \\<in> carrier \\<Longrightarrow>\n  \\<exists>c\\<in>I. domain (\\<psi> ?p3) \\<subseteq> \\<X> c\n  ?p3 \\<in> V ?j3 \\<Longrightarrow> domain (\\<psi> ?p3) \\<subseteq> V ?j3\n  ?p3 \\<in> carrier \\<Longrightarrow> ?p3 \\<in> domain (\\<psi> ?p3)\n  ?p3 \\<in> carrier \\<Longrightarrow> apply_chart (\\<psi> ?p3) ?p3 = (0::'b)\n  ?p3 \\<in> carrier \\<Longrightarrow> \\<psi> ?p3 \\<in> atlas\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define U where \"U p = inv_chart (\\<psi> p) ` ball 0 1\" for p"], ["proof (state)\nthis:\n  U ?p = inv_chart (\\<psi> ?p) ` ball (0::'b) 1\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have U_open: \"open (U p)\" if \"p \\<in> carrier\" for p"], ["proof (prove)\ngoal (1 subgoal):\n 1. open (U p)", "using that \\<psi>"], ["proof (prove)\nusing this:\n  p \\<in> carrier\n  ?p3 \\<in> carrier \\<Longrightarrow> codomain (\\<psi> ?p3) = ball (0::'b) 3\n  ?p3 \\<in> carrier \\<Longrightarrow>\n  \\<exists>c\\<in>I. domain (\\<psi> ?p3) \\<subseteq> \\<X> c\n  ?p3 \\<in> V ?j3 \\<Longrightarrow> domain (\\<psi> ?p3) \\<subseteq> V ?j3\n  ?p3 \\<in> carrier \\<Longrightarrow> ?p3 \\<in> domain (\\<psi> ?p3)\n  ?p3 \\<in> carrier \\<Longrightarrow> apply_chart (\\<psi> ?p3) ?p3 = (0::'b)\n  ?p3 \\<in> carrier \\<Longrightarrow> \\<psi> ?p3 \\<in> atlas\n\ngoal (1 subgoal):\n 1. open (U p)", "by (auto simp: U_def)"], ["proof (state)\nthis:\n  ?p3 \\<in> carrier \\<Longrightarrow> open (U ?p3)\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have U_subset_domain: \"x \\<in> U p \\<Longrightarrow> x \\<in> domain (\\<psi> p)\" if \"p \\<in> carrier\" for x p"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> U p \\<Longrightarrow> x \\<in> domain (\\<psi> p)", "using \\<psi>(1) that"], ["proof (prove)\nusing this:\n  ?p3 \\<in> carrier \\<Longrightarrow> codomain (\\<psi> ?p3) = ball (0::'b) 3\n  p \\<in> carrier\n\ngoal (1 subgoal):\n 1. x \\<in> U p \\<Longrightarrow> x \\<in> domain (\\<psi> p)", "by (auto simp: U_def)"], ["proof (state)\nthis:\n  \\<lbrakk>?p3 \\<in> carrier; ?x3 \\<in> U ?p3\\<rbrakk>\n  \\<Longrightarrow> ?x3 \\<in> domain (\\<psi> ?p3)\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<exists>M. M \\<subseteq> closure (V l) \\<and> finite M \\<and> closure (V l) \\<subseteq> \\<Union>(U ` M)\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "have clcover: \"closure (V l) \\<subseteq> \\<Union>(U ` closure (V l))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V l) \\<subseteq> \\<Union> (U ` closure (V l))", "using \\<psi>"], ["proof (prove)\nusing this:\n  ?p3 \\<in> carrier \\<Longrightarrow> codomain (\\<psi> ?p3) = ball (0::'b) 3\n  ?p3 \\<in> carrier \\<Longrightarrow>\n  \\<exists>c\\<in>I. domain (\\<psi> ?p3) \\<subseteq> \\<X> c\n  ?p3 \\<in> V ?j3 \\<Longrightarrow> domain (\\<psi> ?p3) \\<subseteq> V ?j3\n  ?p3 \\<in> carrier \\<Longrightarrow> ?p3 \\<in> domain (\\<psi> ?p3)\n  ?p3 \\<in> carrier \\<Longrightarrow> apply_chart (\\<psi> ?p3) ?p3 = (0::'b)\n  ?p3 \\<in> carrier \\<Longrightarrow> \\<psi> ?p3 \\<in> atlas\n\ngoal (1 subgoal):\n 1. closure (V l) \\<subseteq> \\<Union> (U ` closure (V l))", "apply (auto simp: U_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>closure (V l).\n                            x \\<in> inv_chart (\\<psi> xa) ` ball (0::'b) 1", "apply (rule bexI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> inv_chart (\\<psi> (?x31 x)) `\n                                 ball (0::'b) 1\n 2. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> ?x31 x \\<in> closure (V l)", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> ?x31 x \\<in> closure (V l)\n 2. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> inv_chart (\\<psi> (?x31 x)) `\n                                 ball (0::'b) 1", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> inv_chart (\\<psi> x) ` ball (0::'b) 1", "apply (rule image_eqI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x = inv_chart (\\<psi> x) (?x34 x)\n 2. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> ?x34 x \\<in> ball (0::'b) 1", "apply (rule inv_chart_inverse[symmetric])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> domain (\\<psi> x)\n 2. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> apply_chart (\\<psi> x) x \\<in> ball (0::'b) 1", "apply (rule \\<psi>)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier\n 2. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> apply_chart (\\<psi> x) x \\<in> ball (0::'b) 1", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier\n 2. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> norm (apply_chart (\\<psi> x) x) < 1", "using V(4)"], ["proof (prove)\nusing this:\n  closure (V ?i2) \\<subseteq> carrier\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier\n 2. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> norm (apply_chart (\\<psi> x) x) < 1", "apply force"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>p.\n                   p \\<in> carrier \\<Longrightarrow>\n                   codomain (\\<psi> p) = ball (0::'b) 3;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           \\<exists>c\\<in>I. domain (\\<psi> p) \\<subseteq> \\<X> c;\n        \\<And>p j.\n           p \\<in> V j \\<Longrightarrow> domain (\\<psi> p) \\<subseteq> V j;\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow> p \\<in> domain (\\<psi> p);\n        \\<And>p.\n           p \\<in> carrier \\<Longrightarrow>\n           apply_chart (\\<psi> p) p = (0::'b);\n        \\<And>p. p \\<in> carrier \\<Longrightarrow> \\<psi> p \\<in> atlas;\n        x \\<in> closure (V l)\\<rbrakk>\n       \\<Longrightarrow> norm (apply_chart (\\<psi> x) x) < 1", "by (metis V(4) less_irrefl norm_numeral norm_one norm_zero one_less_numeral_iff subsetCE\n          zero_less_norm_iff zero_neq_numeral)"], ["proof (state)\nthis:\n  closure (V l) \\<subseteq> \\<Union> (U ` closure (V l))\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "have \"B \\<in> U ` closure (V l) \\<Longrightarrow> open B\" for B"], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> U ` closure (V l) \\<Longrightarrow> open B", "using V(4)"], ["proof (prove)\nusing this:\n  closure (V ?i2) \\<subseteq> carrier\n\ngoal (1 subgoal):\n 1. B \\<in> U ` closure (V l) \\<Longrightarrow> open B", "by (auto intro!: U_open)"], ["proof (state)\nthis:\n  ?B3 \\<in> U ` closure (V l) \\<Longrightarrow> open ?B3\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "from compactE[OF V(3) clcover this]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>B.\n              B \\<in> U ` closure (V l) \\<Longrightarrow>\n              B \\<in> U ` closure (V l);\n   \\<And>\\<T>'.\n      \\<lbrakk>\\<T>' \\<subseteq> U ` closure (V l); finite \\<T>';\n       closure (V l) \\<subseteq> \\<Union> \\<T>'\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis", "obtain Um where Um: \"Um \\<subseteq> U ` closure (V l)\" \"finite Um\" \"closure (V l) \\<subseteq> \\<Union>Um\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>B.\n              B \\<in> U ` closure (V l) \\<Longrightarrow>\n              B \\<in> U ` closure (V l);\n   \\<And>\\<T>'.\n      \\<lbrakk>\\<T>' \\<subseteq> U ` closure (V l); finite \\<T>';\n       closure (V l) \\<subseteq> \\<Union> \\<T>'\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>Um.\n        \\<lbrakk>Um \\<subseteq> U ` closure (V l); finite Um;\n         closure (V l) \\<subseteq> \\<Union> Um\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  Um \\<subseteq> U ` closure (V l)\n  finite Um\n  closure (V l) \\<subseteq> \\<Union> Um\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "from Um(1)"], ["proof (chain)\npicking this:\n  Um \\<subseteq> U ` closure (V l)", "have \"\\<forall>t\\<in>Um. \\<exists>p\\<in>closure (V l). t = U p\""], ["proof (prove)\nusing this:\n  Um \\<subseteq> U ` closure (V l)\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>Um. \\<exists>p\\<in>closure (V l). t = U p", "by auto"], ["proof (state)\nthis:\n  \\<forall>t\\<in>Um. \\<exists>p\\<in>closure (V l). t = U p\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "then"], ["proof (chain)\npicking this:\n  \\<forall>t\\<in>Um. \\<exists>p\\<in>closure (V l). t = U p", "obtain p_of where p_of: \"\\<And>t. t \\<in> Um \\<Longrightarrow> p_of t \\<in> closure (V l)\"\n      \"\\<And>t. t \\<in> Um \\<Longrightarrow> t = U (p_of t)\""], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>Um. \\<exists>p\\<in>closure (V l). t = U p\n\ngoal (1 subgoal):\n 1. (\\<And>p_of.\n        \\<lbrakk>\\<And>t.\n                    t \\<in> Um \\<Longrightarrow> p_of t \\<in> closure (V l);\n         \\<And>t. t \\<in> Um \\<Longrightarrow> t = U (p_of t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  ?t3 \\<in> Um \\<Longrightarrow> p_of ?t3 \\<in> closure (V l)\n  ?t3 \\<in> Um \\<Longrightarrow> ?t3 = U (p_of ?t3)\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "have \"p_of ` Um \\<subseteq> closure (V l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p_of ` Um \\<subseteq> closure (V l)", "using p_of"], ["proof (prove)\nusing this:\n  ?t3 \\<in> Um \\<Longrightarrow> p_of ?t3 \\<in> closure (V l)\n  ?t3 \\<in> Um \\<Longrightarrow> ?t3 = U (p_of ?t3)\n\ngoal (1 subgoal):\n 1. p_of ` Um \\<subseteq> closure (V l)", "by auto"], ["proof (state)\nthis:\n  p_of ` Um \\<subseteq> closure (V l)\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "moreover"], ["proof (state)\nthis:\n  p_of ` Um \\<subseteq> closure (V l)\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "have \"finite (p_of ` Um)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (p_of ` Um)", "using \\<open>finite Um\\<close>"], ["proof (prove)\nusing this:\n  finite Um\n\ngoal (1 subgoal):\n 1. finite (p_of ` Um)", "by auto"], ["proof (state)\nthis:\n  finite (p_of ` Um)\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "moreover"], ["proof (state)\nthis:\n  finite (p_of ` Um)\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "have \"closure (V l) \\<subseteq> \\<Union>(U ` p_of ` Um)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V l) \\<subseteq> \\<Union> (U ` p_of ` Um)", "using Um p_of"], ["proof (prove)\nusing this:\n  Um \\<subseteq> U ` closure (V l)\n  finite Um\n  closure (V l) \\<subseteq> \\<Union> Um\n  ?t3 \\<in> Um \\<Longrightarrow> p_of ?t3 \\<in> closure (V l)\n  ?t3 \\<in> Um \\<Longrightarrow> ?t3 = U (p_of ?t3)\n\ngoal (1 subgoal):\n 1. closure (V l) \\<subseteq> \\<Union> (U ` p_of ` Um)", "by auto"], ["proof (state)\nthis:\n  closure (V l) \\<subseteq> \\<Union> (U ` p_of ` Um)\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "ultimately"], ["proof (chain)\npicking this:\n  p_of ` Um \\<subseteq> closure (V l)\n  finite (p_of ` Um)\n  closure (V l) \\<subseteq> \\<Union> (U ` p_of ` Um)", "show ?thesis"], ["proof (prove)\nusing this:\n  p_of ` Um \\<subseteq> closure (V l)\n  finite (p_of ` Um)\n  closure (V l) \\<subseteq> \\<Union> (U ` p_of ` Um)\n\ngoal (1 subgoal):\n 1. \\<exists>M\\<subseteq>closure (V l).\n       finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)", "by blast"], ["proof (state)\nthis:\n  \\<exists>M\\<subseteq>closure (V l).\n     finite M \\<and> closure (V l) \\<subseteq> \\<Union> (U ` M)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>M\\<subseteq>closure (V ?l3).\n     finite M \\<and> closure (V ?l3) \\<subseteq> \\<Union> (U ` M)\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  \\<exists>M\\<subseteq>closure (V ?l3).\n     finite M \\<and> closure (V ?l3) \\<subseteq> \\<Union> (U ` M)", "obtain M' where M': \"\\<And>l. M' l \\<subseteq> closure (V l)\" \"\\<And>l. finite (M' l)\" \"\\<And>l. closure (V l) \\<subseteq> \\<Union>(U ` M' l)\""], ["proof (prove)\nusing this:\n  \\<exists>M\\<subseteq>closure (V ?l3).\n     finite M \\<and> closure (V ?l3) \\<subseteq> \\<Union> (U ` M)\n\ngoal (1 subgoal):\n 1. (\\<And>M'.\n        \\<lbrakk>\\<And>l. M' l \\<subseteq> closure (V l);\n         \\<And>l. finite (M' l);\n         \\<And>l. closure (V l) \\<subseteq> \\<Union> (U ` M' l)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  M' ?l3 \\<subseteq> closure (V ?l3)\n  finite (M' ?l3)\n  closure (V ?l3) \\<subseteq> \\<Union> (U ` M' ?l3)\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define M where \"M v = M' (LEAST l. V l = v)\" for v"], ["proof (state)\nthis:\n  M ?v = M' (LEAST l. V l = ?v)\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have V_Least: \"V (LEAST la. V la = V l) = V l\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. V (LEAST la. V la = V l) = V l", "by (rule LeastI_ex) auto"], ["proof (state)\nthis:\n  V (LEAST la. V la = V ?l3) = V ?l3\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have M: \"M (V l) \\<subseteq> closure (V l)\" \"finite (M v)\" \"closure (V l) \\<subseteq> \\<Union>(U ` M (V l))\" for v l"], ["proof (prove)\ngoal (1 subgoal):\n 1. M (V l) \\<subseteq> closure (V l) &&&\n    finite (M v) &&& closure (V l) \\<subseteq> \\<Union> (U ` M (V l))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. M (V l) \\<subseteq> closure (V l)", "unfolding M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. M' (LEAST la. V la = V l) \\<subseteq> closure (V l)", "apply (rule order_trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. M' (LEAST la. V la = V l) \\<subseteq> ?y\n 2. ?y \\<subseteq> closure (V l)", "apply (rule M')"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V (LEAST la. V la = V l)) \\<subseteq> closure (V l)", "by (auto simp: V_Least)"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite (M v)\n 2. closure (V l) \\<subseteq> \\<Union> (U ` M (V l))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (M v)", "using M'"], ["proof (prove)\nusing this:\n  M' ?l3 \\<subseteq> closure (V ?l3)\n  finite (M' ?l3)\n  closure (V ?l3) \\<subseteq> \\<Union> (U ` M' ?l3)\n\ngoal (1 subgoal):\n 1. finite (M v)", "by (auto simp: M_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V l) \\<subseteq> \\<Union> (U ` M (V l))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V l) \\<subseteq> \\<Union> (U ` M (V l))", "unfolding M_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V l) \\<subseteq> \\<Union> (U ` M' (LEAST la. V la = V l))", "apply (subst V_Least[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V (LEAST la. V la = V l))\n    \\<subseteq> \\<Union> (U ` M' (LEAST la. V la = V l))", "by (rule M')"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n  finite (M ?v3)\n  closure (V ?l3) \\<subseteq> \\<Union> (U ` M (V ?l3))\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from M(1) V(4)"], ["proof (chain)\npicking this:\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n  closure (V ?i2) \\<subseteq> carrier", "have M_carrier: \"x \\<in> M (V l) \\<Longrightarrow> x \\<in> carrier\" for x l"], ["proof (prove)\nusing this:\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n  closure (V ?i2) \\<subseteq> carrier\n\ngoal (1 subgoal):\n 1. x \\<in> M (V l) \\<Longrightarrow> x \\<in> carrier", "by auto"], ["proof (state)\nthis:\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> ?x3 \\<in> carrier\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"countable (\\<Union>l. M (V l))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. countable (\\<Union>l. M (V l))", "using M(2)"], ["proof (prove)\nusing this:\n  finite (M ?v3)\n\ngoal (1 subgoal):\n 1. countable (\\<Union>l. M (V l))", "by (auto simp: countable_finite)"], ["proof (state)\nthis:\n  countable (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from countableE_bij[OF this]"], ["proof (chain)\npicking this:\n  (\\<And>f C.\n      bij_betw f C (\\<Union>l. M (V l)) \\<Longrightarrow>\n      ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain m and N::\"nat set\" where n: \"bij_betw m N (\\<Union>l. M (V l))\""], ["proof (prove)\nusing this:\n  (\\<And>f C.\n      bij_betw f C (\\<Union>l. M (V l)) \\<Longrightarrow>\n      ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>m N.\n        bij_betw m N (\\<Union>l. M (V l)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "."], ["proof (state)\nthis:\n  bij_betw m N (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define m' where \"m' = the_inv_into N m\""], ["proof (state)\nthis:\n  m' = the_inv_into N m\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have m_inverse[simp]: \"\\<And>i. i \\<in> N \\<Longrightarrow> m' (m i) = i\"\n    and m'_inverse[simp]: \"\\<And>x l. x \\<in> M (V l) \\<Longrightarrow> m (m' x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>i. i \\<in> N \\<Longrightarrow> m' (m i) = i) &&&\n    (\\<And>x l. x \\<in> M (V l) \\<Longrightarrow> m (m' x) = x)", "using n"], ["proof (prove)\nusing this:\n  bij_betw m N (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<And>i. i \\<in> N \\<Longrightarrow> m' (m i) = i) &&&\n    (\\<And>x l. x \\<in> M (V l) \\<Longrightarrow> m (m' x) = x)", "by (force simp: bij_betw_def m'_def the_inv_into_f_f)+"], ["proof (state)\nthis:\n  ?i3 \\<in> N \\<Longrightarrow> m' (m ?i3) = ?i3\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> m (m' ?x3) = ?x3\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have m_in: \"m i \\<in> (\\<Union>l. M (V l))\" if \"i \\<in> N\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. m i \\<in> (\\<Union>l. M (V l))", "using n that"], ["proof (prove)\nusing this:\n  bij_betw m N (\\<Union>l. M (V l))\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. m i \\<in> (\\<Union>l. M (V l))", "by (auto dest!: bij_betwE)"], ["proof (state)\nthis:\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have m'_in: \"m' x \\<in> N\" if \"x \\<in> M (V l)\" for x l"], ["proof (prove)\ngoal (1 subgoal):\n 1. m' x \\<in> N", "using that n"], ["proof (prove)\nusing this:\n  x \\<in> M (V l)\n  bij_betw m N (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. m' x \\<in> N", "by (auto simp: m'_def bij_betw_def intro!: the_inv_into_into)"], ["proof (state)\nthis:\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> m' ?x3 \\<in> N\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from m_in"], ["proof (chain)\npicking this:\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> (\\<Union>l. M (V l))", "have m_in_carrier: \"m i \\<in> carrier\" if \"i \\<in> N\" for i"], ["proof (prove)\nusing this:\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. m i \\<in> carrier", "using that M_carrier"], ["proof (prove)\nusing this:\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> (\\<Union>l. M (V l))\n  i \\<in> N\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> ?x3 \\<in> carrier\n\ngoal (1 subgoal):\n 1. m i \\<in> carrier", "by auto"], ["proof (state)\nthis:\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> carrier\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> carrier", "have \"\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> (m i) \\<in> atlas\""], ["proof (prove)\nusing this:\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> carrier\n\ngoal (1 subgoal):\n 1. \\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> (m i) \\<in> atlas", "by (rule \\<psi>(6))"], ["proof (state)\nthis:\n  ?i3 \\<in> N \\<Longrightarrow> \\<psi> (m ?i3) \\<in> atlas\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  ?i3 \\<in> N \\<Longrightarrow> \\<psi> (m ?i3) \\<in> atlas\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"(domain o (\\<lambda>i. (\\<psi> (m i)))) ` N refines \\<X> ` I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (domain \\<circ> (\\<lambda>i. \\<psi> (m i))) ` N refines \\<X> ` I", "by (auto simp: refines_def dest!: m_in_carrier \\<psi>(2))"], ["proof (state)\nthis:\n  (domain \\<circ> (\\<lambda>i. \\<psi> (m i))) ` N refines \\<X> ` I\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  (domain \\<circ> (\\<lambda>i. \\<psi> (m i))) ` N refines \\<X> ` I\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"regular_cover N (\\<lambda>i. \\<psi> (m i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "have \"countable N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. countable N", "by simp"], ["proof (state)\nthis:\n  countable N\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "moreover"], ["proof (state)\nthis:\n  countable N\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "have carrier_subset: \"carrier \\<subseteq> (\\<Union>i \\<in> N. inv_chart (\\<psi> (m i)) ` ball 0 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier\n    \\<subseteq> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)", "unfolding V"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (range V)\n    \\<subseteq> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)", "proof safe"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>xa \\<in> UNIV; x \\<in> V xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (\\<Union>i\\<in>N.\n                                     inv_chart (\\<psi> (m i)) `\n                                     ball (0::'b) 1)", "fix x i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>xa \\<in> UNIV; x \\<in> V xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (\\<Union>i\\<in>N.\n                                     inv_chart (\\<psi> (m i)) `\n                                     ball (0::'b) 1)", "assume \"x \\<in> V i\""], ["proof (state)\nthis:\n  x \\<in> V i\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>xa \\<in> UNIV; x \\<in> V xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (\\<Union>i\\<in>N.\n                                     inv_chart (\\<psi> (m i)) `\n                                     ball (0::'b) 1)", "with M"], ["proof (chain)\npicking this:\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n  finite (M ?v3)\n  closure (V ?l3) \\<subseteq> \\<Union> (U ` M (V ?l3))\n  x \\<in> V i", "obtain p where p: \"p \\<in> M (V i)\" \"x \\<in> U p\""], ["proof (prove)\nusing this:\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n  finite (M ?v3)\n  closure (V ?l3) \\<subseteq> \\<Union> (U ` M (V ?l3))\n  x \\<in> V i\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> M (V i); x \\<in> U p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  p \\<in> M (V i)\n  x \\<in> U p\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>xa \\<in> UNIV; x \\<in> V xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (\\<Union>i\\<in>N.\n                                     inv_chart (\\<psi> (m i)) `\n                                     ball (0::'b) 1)", "from p"], ["proof (chain)\npicking this:\n  p \\<in> M (V i)\n  x \\<in> U p", "show \"x \\<in> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball 0 1)\""], ["proof (prove)\nusing this:\n  p \\<in> M (V i)\n  x \\<in> U p\n\ngoal (1 subgoal):\n 1. x \\<in> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)", "by (auto simp: U_def intro!: bexI[where x=\"m' p\"] m'_in)"], ["proof (state)\nthis:\n  x \\<in> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  carrier\n  \\<subseteq> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "have carrier_eq_W:  \"carrier = (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\" (is \"_ = ?W\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier = (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "proof (rule antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n 2. (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier", "note carrier_subset"], ["proof (state)\nthis:\n  carrier\n  \\<subseteq> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n\ngoal (2 subgoals):\n 1. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n 2. (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier", "also"], ["proof (state)\nthis:\n  carrier\n  \\<subseteq> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n\ngoal (2 subgoals):\n 1. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n 2. (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier", "have \"\\<dots> \\<subseteq> ?W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n    \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "using U_subset_domain \\<psi>(1) M_carrier m_in"], ["proof (prove)\nusing this:\n  \\<lbrakk>?p3 \\<in> carrier; ?x3 \\<in> U ?p3\\<rbrakk>\n  \\<Longrightarrow> ?x3 \\<in> domain (\\<psi> ?p3)\n  ?p3 \\<in> carrier \\<Longrightarrow> codomain (\\<psi> ?p3) = ball (0::'b) 3\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> ?x3 \\<in> carrier\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n    \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "by (force simp: V)"], ["proof (state)\nthis:\n  (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n  \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n\ngoal (2 subgoals):\n 1. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n 2. (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier", "finally"], ["proof (chain)\npicking this:\n  carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "show \"carrier \\<subseteq> ?W\""], ["proof (prove)\nusing this:\n  carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n\ngoal (1 subgoal):\n 1. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "by auto"], ["proof (state)\nthis:\n  carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier", "show \"?W \\<subseteq> carrier\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier", "using M_carrier \\<psi>(6)"], ["proof (prove)\nusing this:\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> ?x3 \\<in> carrier\n  ?p3 \\<in> carrier \\<Longrightarrow> \\<psi> ?p3 \\<in> atlas\n\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier", "by (auto dest!: m_in)"], ["proof (state)\nthis:\n  (\\<Union>i\\<in>N. domain (\\<psi> (m i))) \\<subseteq> carrier\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  carrier = (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "moreover"], ["proof (state)\nthis:\n  carrier = (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "have \"locally_finite_on carrier N (\\<lambda>i. domain (\\<psi> (m i)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. locally_finite_on carrier N (\\<lambda>i. domain (\\<psi> (m i)))", "proof (rule locally_finite_on_open_coverI)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}\n 2. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n 3. \\<And>i. i \\<in> N \\<Longrightarrow> open (domain (\\<psi> (m i)))", "show \"open (domain (\\<psi> (m i)))\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. open (domain (\\<psi> (m i)))", "by auto"], ["proof (state)\nthis:\n  open (domain (\\<psi> (m ?i3)))\n\ngoal (2 subgoals):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}\n 2. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "show \"carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "unfolding carrier_eq_W"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n    \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))", "by auto"], ["proof (state)\nthis:\n  carrier \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "fix ki"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "assume \"ki \\<in> N\""], ["proof (state)\nthis:\n  ki \\<in> N\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "from m_in[OF this]"], ["proof (chain)\npicking this:\n  m ki \\<in> (\\<Union>l. M (V l))", "obtain k where k: \"m ki \\<in> M (V k)\""], ["proof (prove)\nusing this:\n  m ki \\<in> (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<And>k. m ki \\<in> M (V k) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  m ki \\<in> M (V k)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have pkc: \"m ki \\<in> closure (V k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m ki \\<in> closure (V k)", "using k M(1)"], ["proof (prove)\nusing this:\n  m ki \\<in> M (V k)\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n\ngoal (1 subgoal):\n 1. m ki \\<in> closure (V k)", "by force"], ["proof (state)\nthis:\n  m ki \\<in> closure (V k)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "obtain j where j: \"m ki \\<in> V j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>j. m ki \\<in> V j \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using M_carrier[of \"m ki\" k] V(1) k"], ["proof (prove)\nusing this:\n  m ki \\<in> M (V k) \\<Longrightarrow> m ki \\<in> carrier\n  carrier = \\<Union> (range V)\n  m ki \\<in> M (V k)\n\ngoal (1 subgoal):\n 1. (\\<And>j. m ki \\<in> V j \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  m ki \\<in> V j\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have kj: \"V k \\<inter> V j \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. V k \\<inter> V j \\<noteq> {}", "using open_Int_closure_eq_empty[OF V(2)]"], ["proof (prove)\nusing this:\n  (V ?i3 \\<inter> closure ?T = {}) = (V ?i3 \\<inter> ?T = {})\n\ngoal (1 subgoal):\n 1. V k \\<inter> V j \\<noteq> {}", "using pkc j"], ["proof (prove)\nusing this:\n  (V ?i3 \\<inter> closure ?T = {}) = (V ?i3 \\<inter> ?T = {})\n  m ki \\<in> closure (V k)\n  m ki \\<in> V j\n\ngoal (1 subgoal):\n 1. V k \\<inter> V j \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  V k \\<inter> V j \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "then"], ["proof (chain)\npicking this:\n  V k \\<inter> V j \\<noteq> {}", "have jinterk: \"j \\<in> intersecting (V k)\""], ["proof (prove)\nusing this:\n  V k \\<inter> V j \\<noteq> {}\n\ngoal (1 subgoal):\n 1. j \\<in> intersecting (V k)", "by (auto simp: intersecting_def)"], ["proof (state)\nthis:\n  j \\<in> intersecting (V k)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have 1: \"compact (closure (V k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. compact (closure (V k))", "by (rule V)"], ["proof (state)\nthis:\n  compact (closure (V k))\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have 2: \"closure (V k) \\<subseteq> \\<Union>(range V)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V k) \\<subseteq> \\<Union> (range V)", "unfolding V(1)[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V k) \\<subseteq> carrier", "by (rule V)"], ["proof (state)\nthis:\n  closure (V k) \\<subseteq> \\<Union> (range V)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have 3: \"B \\<in> range V \\<Longrightarrow> open B\" for B"], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> range V \\<Longrightarrow> open B", "by (auto simp: V)"], ["proof (state)\nthis:\n  ?B3 \\<in> range V \\<Longrightarrow> open ?B3\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "from compactE[OF 1 2 3]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>B. B \\<in> range V \\<Longrightarrow> B \\<in> range V;\n   \\<And>\\<T>'.\n      \\<lbrakk>\\<T>' \\<subseteq> range V; finite \\<T>';\n       closure (V k) \\<subseteq> \\<Union> \\<T>'\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis", "obtain Vj where \"Vj \\<subseteq> range V\" \"finite Vj\" \"closure (V k) \\<subseteq> \\<Union>Vj\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>B. B \\<in> range V \\<Longrightarrow> B \\<in> range V;\n   \\<And>\\<T>'.\n      \\<lbrakk>\\<T>' \\<subseteq> range V; finite \\<T>';\n       closure (V k) \\<subseteq> \\<Union> \\<T>'\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>Vj.\n        \\<lbrakk>Vj \\<subseteq> range V; finite Vj;\n         closure (V k) \\<subseteq> \\<Union> Vj\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  Vj \\<subseteq> range V\n  finite Vj\n  closure (V k) \\<subseteq> \\<Union> Vj\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "then"], ["proof (chain)\npicking this:\n  Vj \\<subseteq> range V\n  finite Vj\n  closure (V k) \\<subseteq> \\<Union> Vj", "obtain J where \"finite J\" \"closure (V k) \\<subseteq> \\<Union>(V ` J)\""], ["proof (prove)\nusing this:\n  Vj \\<subseteq> range V\n  finite Vj\n  closure (V k) \\<subseteq> \\<Union> Vj\n\ngoal (1 subgoal):\n 1. (\\<And>J.\n        \\<lbrakk>finite J;\n         closure (V k) \\<subseteq> \\<Union> (V ` J)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "apply atomize_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Vj \\<subseteq> range V; finite Vj;\n     closure (V k) \\<subseteq> \\<Union> Vj\\<rbrakk>\n    \\<Longrightarrow> \\<exists>J.\n                         finite J \\<and>\n                         closure (V k) \\<subseteq> \\<Union> (V ` J)", "by (metis finite_subset_image)"], ["proof (state)\nthis:\n  finite J\n  closure (V k) \\<subseteq> \\<Union> (V ` J)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "{"], ["proof (state)\nthis:\n  finite J\n  closure (V k) \\<subseteq> \\<Union> (V ` J)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "fix ki'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "assume \"ki' \\<in> N\""], ["proof (state)\nthis:\n  ki' \\<in> N\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "assume H: \"domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\""], ["proof (state)\nthis:\n  domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "obtain k' where ki': \"m ki' \\<in> M (V k')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>k'.\n        m ki' \\<in> M (V k') \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using m_in[OF \\<open>ki' \\<in> N\\<close>]"], ["proof (prove)\nusing this:\n  m ki' \\<in> (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<And>k'.\n        m ki' \\<in> M (V k') \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  m ki' \\<in> M (V k')\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have k': \"domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\" \"m ki' \\<in> M (V k')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {} &&&\n    m ki' \\<in> M (V k')", "using ki'  H"], ["proof (prove)\nusing this:\n  m ki' \\<in> M (V k')\n  domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\n\ngoal (1 subgoal):\n 1. domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {} &&&\n    m ki' \\<in> M (V k')", "by auto"], ["proof (state)\nthis:\n  domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\n  m ki' \\<in> M (V k')\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have pkc': \"m ki' \\<in> closure (V k')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m ki' \\<in> closure (V k')", "using k' M(1)"], ["proof (prove)\nusing this:\n  domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\n  m ki' \\<in> M (V k')\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n\ngoal (1 subgoal):\n 1. m ki' \\<in> closure (V k')", "by force"], ["proof (state)\nthis:\n  m ki' \\<in> closure (V k')\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "obtain j' where j': \"m ki' \\<in> V j'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>j'. m ki' \\<in> V j' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using M_carrier V(1) k'"], ["proof (prove)\nusing this:\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> ?x3 \\<in> carrier\n  carrier = \\<Union> (range V)\n  domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\n  m ki' \\<in> M (V k')\n\ngoal (1 subgoal):\n 1. (\\<And>j'. m ki' \\<in> V j' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  m ki' \\<in> V j'\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have kj': \"(V k') \\<inter> V j' \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. V k' \\<inter> V j' \\<noteq> {}", "using open_Int_closure_eq_empty[OF V(2)]"], ["proof (prove)\nusing this:\n  (V ?i3 \\<inter> closure ?T = {}) = (V ?i3 \\<inter> ?T = {})\n\ngoal (1 subgoal):\n 1. V k' \\<inter> V j' \\<noteq> {}", "using pkc' j'"], ["proof (prove)\nusing this:\n  (V ?i3 \\<inter> closure ?T = {}) = (V ?i3 \\<inter> ?T = {})\n  m ki' \\<in> closure (V k')\n  m ki' \\<in> V j'\n\ngoal (1 subgoal):\n 1. V k' \\<inter> V j' \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  V k' \\<inter> V j' \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "then"], ["proof (chain)\npicking this:\n  V k' \\<inter> V j' \\<noteq> {}", "have j'interk': \"k' \\<in> intersecting (V j')\""], ["proof (prove)\nusing this:\n  V k' \\<inter> V j' \\<noteq> {}\n\ngoal (1 subgoal):\n 1. k' \\<in> intersecting (V j')", "by (auto simp: intersecting_def)"], ["proof (state)\nthis:\n  k' \\<in> intersecting (V j')\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have j'interj: \"j' \\<in> intersecting (V j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. j' \\<in> intersecting (V j)", "using k' \\<psi>(3)[OF j'] \\<psi>(3)[OF j]"], ["proof (prove)\nusing this:\n  domain (\\<psi> (m ki')) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}\n  m ki' \\<in> M (V k')\n  domain (\\<psi> (m ki')) \\<subseteq> V j'\n  domain (\\<psi> (m ki)) \\<subseteq> V j\n\ngoal (1 subgoal):\n 1. j' \\<in> intersecting (V j)", "by (auto simp: intersecting_def)"], ["proof (state)\nthis:\n  j' \\<in> intersecting (V j)\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "have \"k' \\<in> \\<Union>(intersecting ` V ` \\<Union>(intersecting ` V ` intersecting (V k)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k' \\<in> \\<Union>\n              (intersecting `\n               V ` \\<Union> (intersecting ` V ` intersecting (V k)))", "using jinterk j'interk' j'interj"], ["proof (prove)\nusing this:\n  j \\<in> intersecting (V k)\n  k' \\<in> intersecting (V j')\n  j' \\<in> intersecting (V j)\n\ngoal (1 subgoal):\n 1. k' \\<in> \\<Union>\n              (intersecting `\n               V ` \\<Union> (intersecting ` V ` intersecting (V k)))", "by blast"], ["proof (state)\nthis:\n  k' \\<in> \\<Union>\n            (intersecting `\n             V ` \\<Union> (intersecting ` V ` intersecting (V k)))\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "then"], ["proof (chain)\npicking this:\n  k' \\<in> \\<Union>\n            (intersecting `\n             V ` \\<Union> (intersecting ` V ` intersecting (V k)))", "have \"m ki' \\<in> \\<Union>((\\<lambda>x. M (V x)) ` \\<Union>(intersecting ` V ` \\<Union>(intersecting ` V ` intersecting (V k))))\""], ["proof (prove)\nusing this:\n  k' \\<in> \\<Union>\n            (intersecting `\n             V ` \\<Union> (intersecting ` V ` intersecting (V k)))\n\ngoal (1 subgoal):\n 1. m ki'\n    \\<in> (\\<Union>x\\<in>\\<Union>\n                          (intersecting `\n                           V `\n                           \\<Union>\n                            (intersecting ` V ` intersecting (V k))).\n              M (V x))", "using ki'"], ["proof (prove)\nusing this:\n  k' \\<in> \\<Union>\n            (intersecting `\n             V ` \\<Union> (intersecting ` V ` intersecting (V k)))\n  m ki' \\<in> M (V k')\n\ngoal (1 subgoal):\n 1. m ki'\n    \\<in> (\\<Union>x\\<in>\\<Union>\n                          (intersecting `\n                           V `\n                           \\<Union>\n                            (intersecting ` V ` intersecting (V k))).\n              M (V x))", "by auto"], ["proof (state)\nthis:\n  m ki'\n  \\<in> (\\<Union>x\\<in>\\<Union>\n                        (intersecting `\n                         V `\n                         \\<Union> (intersecting ` V ` intersecting (V k))).\n            M (V x))\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "from m_inverse[symmetric] this"], ["proof (chain)\npicking this:\n  ?t \\<in> N \\<Longrightarrow> ?t = m' (m ?t)\n  m ki'\n  \\<in> (\\<Union>x\\<in>\\<Union>\n                        (intersecting `\n                         V `\n                         \\<Union> (intersecting ` V ` intersecting (V k))).\n            M (V x))", "have \"ki' \\<in> m' ` \\<Union>((\\<lambda>x. M (V x)) ` \\<Union>(intersecting ` V ` \\<Union>(intersecting ` V ` intersecting (V k))))\""], ["proof (prove)\nusing this:\n  ?t \\<in> N \\<Longrightarrow> ?t = m' (m ?t)\n  m ki'\n  \\<in> (\\<Union>x\\<in>\\<Union>\n                        (intersecting `\n                         V `\n                         \\<Union> (intersecting ` V ` intersecting (V k))).\n            M (V x))\n\ngoal (1 subgoal):\n 1. ki'\n    \\<in> m' `\n          (\\<Union>x\\<in>\\<Union>\n                          (intersecting `\n                           V `\n                           \\<Union>\n                            (intersecting ` V ` intersecting (V k))).\n              M (V x))", "by (rule image_eqI) fact"], ["proof (state)\nthis:\n  ki'\n  \\<in> m' `\n        (\\<Union>x\\<in>\\<Union>\n                        (intersecting `\n                         V `\n                         \\<Union> (intersecting ` V ` intersecting (V k))).\n            M (V x))\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?ki'5 \\<in> N;\n   domain (\\<psi> (m ?ki'5)) \\<inter> domain (\\<psi> (m ki)) \\<noteq>\n   {}\\<rbrakk>\n  \\<Longrightarrow> ?ki'5\n                    \\<in> m' `\n                          (\\<Union>x\\<in>\\<Union>\n    (intersecting ` V ` \\<Union> (intersecting ` V ` intersecting (V k))).\n                              M (V x))\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "note * = this"], ["proof (state)\nthis:\n  \\<lbrakk>?ki'5 \\<in> N;\n   domain (\\<psi> (m ?ki'5)) \\<inter> domain (\\<psi> (m ki)) \\<noteq>\n   {}\\<rbrakk>\n  \\<Longrightarrow> ?ki'5\n                    \\<in> m' `\n                          (\\<Union>x\\<in>\\<Union>\n    (intersecting ` V ` \\<Union> (intersecting ` V ` intersecting (V k))).\n                              M (V x))\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       j \\<in> N \\<Longrightarrow>\n       finite\n        {i \\<in> N.\n         domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m j)) \\<noteq> {}}", "show \"finite {i \\<in> N. domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     {i \\<in> N.\n      domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}}", "apply (rule finite_subset[where B=\"m' ` \\<Union>((\\<lambda>x. M (V x)) ` \\<Union>(intersecting ` V ` \\<Union>(intersecting ` V ` intersecting (V k))))\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. {i \\<in> N.\n     domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}}\n    \\<subseteq> m' `\n                (\\<Union>x\\<in>\\<Union>\n                                (intersecting `\n                                 V `\n                                 \\<Union>\n                                  (intersecting ` V ` intersecting (V k))).\n                    M (V x))\n 2. finite\n     (m' `\n      (\\<Union>x\\<in>\\<Union>\n                      (intersecting `\n                       V `\n                       \\<Union> (intersecting ` V ` intersecting (V k))).\n          M (V x)))", "apply clarsimp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> N;\n        domain (\\<psi> (m x)) \\<inter> domain (\\<psi> (m ki)) \\<noteq>\n        {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> m' `\n                                 (\\<Union>x\\<in>intersecting (V k).\n                                     \\<Union>x\\<in>intersecting (V x).\n  \\<Union>x\\<in>intersecting (V x). M (V x))\n 2. finite\n     (m' `\n      (\\<Union>x\\<in>\\<Union>\n                      (intersecting `\n                       V `\n                       \\<Union> (intersecting ` V ` intersecting (V k))).\n          M (V x)))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x_ \\<in> N;\n     domain (\\<psi> (m x_)) \\<inter> domain (\\<psi> (m ki)) \\<noteq>\n     {}\\<rbrakk>\n    \\<Longrightarrow> x_ \\<in> m' `\n                               (\\<Union>x\\<in>intersecting (V k).\n                                   \\<Union>x\\<in>intersecting (V x).\n\\<Union>x\\<in>intersecting (V x). M (V x))", "by (drule *, assumption, force)"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     (m' `\n      (\\<Union>x\\<in>\\<Union>\n                      (intersecting `\n                       V `\n                       \\<Union> (intersecting ` V ` intersecting (V k))).\n          M (V x)))", "using finite_intersecting intersecting_def M"], ["proof (prove)\nusing this:\n  finite (intersecting (V ?x2))\n  intersecting ?v = {i. V i \\<inter> ?v \\<noteq> {}}\n  M (V ?l3) \\<subseteq> closure (V ?l3)\n  finite (M ?v3)\n  closure (V ?l3) \\<subseteq> \\<Union> (U ` M (V ?l3))\n\ngoal (1 subgoal):\n 1. finite\n     (m' `\n      (\\<Union>x\\<in>\\<Union>\n                      (intersecting `\n                       V `\n                       \\<Union> (intersecting ` V ` intersecting (V k))).\n          M (V x)))", "by auto"], ["proof (state)\nthis:\n  finite\n   {i \\<in> N.\n    domain (\\<psi> (m i)) \\<inter> domain (\\<psi> (m ki)) \\<noteq> {}}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  locally_finite_on carrier N (\\<lambda>i. domain (\\<psi> (m i)))\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "moreover"], ["proof (state)\nthis:\n  locally_finite_on carrier N (\\<lambda>i. domain (\\<psi> (m i)))\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "have \"(\\<forall>i \\<in> N. codomain (\\<psi> (m i)) = ball 0 3)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>N. codomain (\\<psi> (m i)) = ball (0::'b) 3", "using \\<psi>(1) M_carrier m_in"], ["proof (prove)\nusing this:\n  ?p3 \\<in> carrier \\<Longrightarrow> codomain (\\<psi> ?p3) = ball (0::'b) 3\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> ?x3 \\<in> carrier\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>N. codomain (\\<psi> (m i)) = ball (0::'b) 3", "by force"], ["proof (state)\nthis:\n  \\<forall>i\\<in>N. codomain (\\<psi> (m i)) = ball (0::'b) 3\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "moreover"], ["proof (state)\nthis:\n  \\<forall>i\\<in>N. codomain (\\<psi> (m i)) = ball (0::'b) 3\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "have \"carrier = (\\<Union>i \\<in> N. inv_chart (\\<psi> (m i)) ` ball 0 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier = (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)", "proof (rule antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. carrier\n    \\<subseteq> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n 2. (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n    \\<subseteq> carrier", "show \"(\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball 0 1) \\<subseteq> carrier\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n    \\<subseteq> carrier", "using \\<psi>(6)[OF M_carrier] M_carrier m_in"], ["proof (prove)\nusing this:\n  ?p3 \\<in> M (V ?l7) \\<Longrightarrow> \\<psi> ?p3 \\<in> atlas\n  ?x3 \\<in> M (V ?l3) \\<Longrightarrow> ?x3 \\<in> carrier\n  ?i3 \\<in> N \\<Longrightarrow> m ?i3 \\<in> (\\<Union>l. M (V l))\n\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n    \\<subseteq> carrier", "by (force simp: \\<psi>(1))"], ["proof (state)\nthis:\n  (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n  \\<subseteq> carrier\n\ngoal (1 subgoal):\n 1. carrier\n    \\<subseteq> (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)", "qed (rule carrier_subset)"], ["proof (state)\nthis:\n  carrier = (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "ultimately"], ["proof (chain)\npicking this:\n  countable N\n  carrier = (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n  locally_finite_on carrier N (\\<lambda>i. domain (\\<psi> (m i)))\n  \\<forall>i\\<in>N. codomain (\\<psi> (m i)) = ball (0::'b) 3\n  carrier = (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  countable N\n  carrier = (\\<Union>i\\<in>N. domain (\\<psi> (m i)))\n  locally_finite_on carrier N (\\<lambda>i. domain (\\<psi> (m i)))\n  \\<forall>i\\<in>N. codomain (\\<psi> (m i)) = ball (0::'b) 3\n  carrier = (\\<Union>i\\<in>N. inv_chart (\\<psi> (m i)) ` ball (0::'b) 1)\n\ngoal (1 subgoal):\n 1. regular_cover N (\\<lambda>i. \\<psi> (m i))", "by (auto simp: regular_cover_def o_def)"], ["proof (state)\nthis:\n  regular_cover N (\\<lambda>i. \\<psi> (m i))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  regular_cover N (\\<lambda>i. \\<psi> (m i))\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines \\<X> ` I;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  ?i3 \\<in> N \\<Longrightarrow> \\<psi> (m ?i3) \\<in> atlas\n  (domain \\<circ> (\\<lambda>i. \\<psi> (m i))) ` N refines \\<X> ` I\n  regular_cover N (\\<lambda>i. \\<psi> (m i))", "show ?thesis"], ["proof (prove)\nusing this:\n  ?i3 \\<in> N \\<Longrightarrow> \\<psi> (m ?i3) \\<in> atlas\n  (domain \\<circ> (\\<lambda>i. \\<psi> (m i))) ` N refines \\<X> ` I\n  regular_cover N (\\<lambda>i. \\<psi> (m i))\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_apply_chart:\n  \"diff k (charts_submanifold (domain \\<psi>)) charts_eucl \\<psi>\" if \"\\<psi> \\<in> atlas\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff k (charts_submanifold (domain \\<psi>)) charts_eucl\n     (apply_chart \\<psi>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. diff k (charts_submanifold (domain \\<psi>)) charts_eucl\n     (apply_chart \\<psi>)", "interpret submanifold charts k \"domain \\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submanifold charts k (domain \\<psi>)", "by unfold_locales auto"], ["proof (state)\ngoal (1 subgoal):\n 1. diff k (charts_submanifold (domain \\<psi>)) charts_eucl\n     (apply_chart \\<psi>)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff k (charts_submanifold (domain \\<psi>)) charts_eucl\n     (apply_chart \\<psi>)", "proof (unfold_locales)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> sub.carrier \\<Longrightarrow>\n       \\<exists>c1\\<in>sub.atlas.\n          \\<exists>c2\\<in>manifold_eucl.dest.atlas.\n             x \\<in> domain c1 \\<and>\n             apply_chart \\<psi> ` domain c1 \\<subseteq> domain c2 \\<and>\n             k-smooth_on (codomain c1)\n              (apply_chart c2 \\<circ> apply_chart \\<psi> \\<circ>\n               inv_chart c1)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> sub.carrier \\<Longrightarrow>\n       \\<exists>c1\\<in>sub.atlas.\n          \\<exists>c2\\<in>manifold_eucl.dest.atlas.\n             x \\<in> domain c1 \\<and>\n             apply_chart \\<psi> ` domain c1 \\<subseteq> domain c2 \\<and>\n             k-smooth_on (codomain c1)\n              (apply_chart c2 \\<circ> apply_chart \\<psi> \\<circ>\n               inv_chart c1)", "assume x: \"x \\<in> sub.carrier\""], ["proof (state)\nthis:\n  x \\<in> sub.carrier\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> sub.carrier \\<Longrightarrow>\n       \\<exists>c1\\<in>sub.atlas.\n          \\<exists>c2\\<in>manifold_eucl.dest.atlas.\n             x \\<in> domain c1 \\<and>\n             apply_chart \\<psi> ` domain c1 \\<subseteq> domain c2 \\<and>\n             k-smooth_on (codomain c1)\n              (apply_chart c2 \\<circ> apply_chart \\<psi> \\<circ>\n               inv_chart c1)", "show \"\\<exists>c1\\<in>sub.atlas.\n            \\<exists>c2\\<in>manifold_eucl.dest.atlas.\n               x \\<in> domain c1 \\<and> \\<psi> ` domain c1 \\<subseteq> domain c2 \\<and> k-smooth_on (codomain c1) (c2 \\<circ> \\<psi> \\<circ> inv_chart c1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1\\<in>sub.atlas.\n       \\<exists>c2\\<in>manifold_eucl.dest.atlas.\n          x \\<in> domain c1 \\<and>\n          apply_chart \\<psi> ` domain c1 \\<subseteq> domain c2 \\<and>\n          k-smooth_on (codomain c1)\n           (apply_chart c2 \\<circ> apply_chart \\<psi> \\<circ> inv_chart c1)", "apply (rule bexI[where x = \"restrict_chart (domain \\<psi>) \\<psi>\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<exists>c2\\<in>manifold_eucl.dest.atlas.\n       x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>) \\<and>\n       apply_chart \\<psi> ` domain (restrict_chart (domain \\<psi>) \\<psi>)\n       \\<subseteq> domain c2 \\<and>\n       k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>))\n        (apply_chart c2 \\<circ> apply_chart \\<psi> \\<circ>\n         inv_chart (restrict_chart (domain \\<psi>) \\<psi>))\n 2. restrict_chart (domain \\<psi>) \\<psi> \\<in> sub.atlas", "apply (rule bexI[where x = \"chart_eucl\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>) \\<and>\n    apply_chart \\<psi> ` domain (restrict_chart (domain \\<psi>) \\<psi>)\n    \\<subseteq> domain chart_eucl \\<and>\n    k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>))\n     (apply_chart chart_eucl \\<circ> apply_chart \\<psi> \\<circ>\n      inv_chart (restrict_chart (domain \\<psi>) \\<psi>))\n 2. chart_eucl \\<in> manifold_eucl.dest.atlas\n 3. restrict_chart (domain \\<psi>) \\<psi> \\<in> sub.atlas", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>) \\<and>\n    apply_chart \\<psi> ` domain (restrict_chart (domain \\<psi>) \\<psi>)\n    \\<subseteq> domain chart_eucl \\<and>\n    k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>))\n     (apply_chart chart_eucl \\<circ> apply_chart \\<psi> \\<circ>\n      inv_chart (restrict_chart (domain \\<psi>) \\<psi>))", "proof safe"], ["proof (state)\ngoal (3 subgoals):\n 1. x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>)\n 2. \\<And>x xa.\n       xa \\<in> domain\n                 (restrict_chart (domain \\<psi>) \\<psi>) \\<Longrightarrow>\n       apply_chart \\<psi> xa \\<in> domain chart_eucl\n 3. k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>))\n     (apply_chart chart_eucl \\<circ> apply_chart \\<psi> \\<circ>\n      inv_chart (restrict_chart (domain \\<psi>) \\<psi>))", "show \"x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>)", "using x \\<open>\\<psi> \\<in> atlas\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> sub.carrier\n  \\<psi> \\<in> atlas\n\ngoal (1 subgoal):\n 1. x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>)", "by auto"], ["proof (state)\nthis:\n  x \\<in> domain (restrict_chart (domain \\<psi>) \\<psi>)\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       xa \\<in> domain\n                 (restrict_chart (domain \\<psi>) \\<psi>) \\<Longrightarrow>\n       apply_chart \\<psi> xa \\<in> domain chart_eucl\n 2. k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>))\n     (apply_chart chart_eucl \\<circ> apply_chart \\<psi> \\<circ>\n      inv_chart (restrict_chart (domain \\<psi>) \\<psi>))", "show \"k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>)) (chart_eucl \\<circ> \\<psi> \\<circ> inv_chart (restrict_chart (domain \\<psi>) \\<psi>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>))\n     (apply_chart chart_eucl \\<circ> apply_chart \\<psi> \\<circ>\n      inv_chart (restrict_chart (domain \\<psi>) \\<psi>))", "apply (auto simp: o_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on (codomain \\<psi> \\<inter> inv_chart \\<psi> -` domain \\<psi>)\n     (\\<lambda>x. apply_chart \\<psi> (inv_chart \\<psi> x))", "apply (rule smooth_on_cong[where g=\"\\<lambda>x. x\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. k-smooth_on (codomain \\<psi> \\<inter> inv_chart \\<psi> -` domain \\<psi>)\n     (\\<lambda>x. x)\n 2. open (codomain \\<psi> \\<inter> inv_chart \\<psi> -` domain \\<psi>)\n 3. \\<And>x.\n       x \\<in> codomain \\<psi> \\<inter>\n               inv_chart \\<psi> -` domain \\<psi> \\<Longrightarrow>\n       apply_chart \\<psi> (inv_chart \\<psi> x) = x", "by (auto intro!: open_continuous_vimage' continuous_on_codomain)"], ["proof (state)\nthis:\n  k-smooth_on (codomain (restrict_chart (domain \\<psi>) \\<psi>))\n   (apply_chart chart_eucl \\<circ> apply_chart \\<psi> \\<circ>\n    inv_chart (restrict_chart (domain \\<psi>) \\<psi>))\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       xa \\<in> domain\n                 (restrict_chart (domain \\<psi>) \\<psi>) \\<Longrightarrow>\n       apply_chart \\<psi> xa \\<in> domain chart_eucl", "qed simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. chart_eucl \\<in> manifold_eucl.dest.atlas\n 2. restrict_chart (domain \\<psi>) \\<psi> \\<in> sub.atlas", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. chart_eucl \\<in> manifold_eucl.dest.atlas", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. restrict_chart (domain \\<psi>) \\<psi> \\<in> sub.atlas", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. restrict_chart (domain \\<psi>) \\<psi> \\<in> sub.atlas", "by (rule submanifold_atlasI) fact"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>c1\\<in>sub.atlas.\n     \\<exists>c2\\<in>manifold_eucl.dest.atlas.\n        x \\<in> domain c1 \\<and>\n        apply_chart \\<psi> ` domain c1 \\<subseteq> domain c2 \\<and>\n        k-smooth_on (codomain c1)\n         (apply_chart c2 \\<circ> apply_chart \\<psi> \\<circ> inv_chart c1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  diff k (charts_submanifold (domain \\<psi>)) charts_eucl\n   (apply_chart \\<psi>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma diff_inv_chart:\n  \"diff k (manifold_eucl.charts_submanifold (codomain c)) charts (inv_chart c)\" if \"c \\<in> atlas\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff k (manifold_eucl.dest.charts_submanifold (codomain c)) charts\n     (inv_chart c)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. diff k (manifold_eucl.dest.charts_submanifold (codomain c)) charts\n     (inv_chart c)", "interpret submanifold charts_eucl k \"codomain c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submanifold charts_eucl k (codomain c)", "by unfold_locales auto"], ["proof (state)\ngoal (1 subgoal):\n 1. diff k (manifold_eucl.dest.charts_submanifold (codomain c)) charts\n     (inv_chart c)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff k (manifold_eucl.dest.charts_submanifold (codomain c)) charts\n     (inv_chart c)", "proof (unfold_locales)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> sub.carrier \\<Longrightarrow>\n       \\<exists>c1\\<in>sub.atlas.\n          \\<exists>c2\\<in>atlas.\n             x \\<in> domain c1 \\<and>\n             inv_chart c ` domain c1 \\<subseteq> domain c2 \\<and>\n             k-smooth_on (codomain c1)\n              (apply_chart c2 \\<circ> inv_chart c \\<circ> inv_chart c1)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> sub.carrier \\<Longrightarrow>\n       \\<exists>c1\\<in>sub.atlas.\n          \\<exists>c2\\<in>atlas.\n             x \\<in> domain c1 \\<and>\n             inv_chart c ` domain c1 \\<subseteq> domain c2 \\<and>\n             k-smooth_on (codomain c1)\n              (apply_chart c2 \\<circ> inv_chart c \\<circ> inv_chart c1)", "assume x: \"x \\<in> sub.carrier\""], ["proof (state)\nthis:\n  x \\<in> sub.carrier\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> sub.carrier \\<Longrightarrow>\n       \\<exists>c1\\<in>sub.atlas.\n          \\<exists>c2\\<in>atlas.\n             x \\<in> domain c1 \\<and>\n             inv_chart c ` domain c1 \\<subseteq> domain c2 \\<and>\n             k-smooth_on (codomain c1)\n              (apply_chart c2 \\<circ> inv_chart c \\<circ> inv_chart c1)", "show \"\\<exists>c1\\<in>sub.atlas.\n            \\<exists>c2\\<in>atlas.\n               x \\<in> domain c1 \\<and> inv_chart c ` domain c1 \\<subseteq> domain c2 \\<and>\n               k-smooth_on (codomain c1) (c2 \\<circ> inv_chart c \\<circ> inv_chart c1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1\\<in>sub.atlas.\n       \\<exists>c2\\<in>atlas.\n          x \\<in> domain c1 \\<and>\n          inv_chart c ` domain c1 \\<subseteq> domain c2 \\<and>\n          k-smooth_on (codomain c1)\n           (apply_chart c2 \\<circ> inv_chart c \\<circ> inv_chart c1)", "apply (rule bexI[where x = \"restrict_chart (codomain c) chart_eucl\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<exists>c2\\<in>atlas.\n       x \\<in> domain (restrict_chart (codomain c) chart_eucl) \\<and>\n       inv_chart c ` domain (restrict_chart (codomain c) chart_eucl)\n       \\<subseteq> domain c2 \\<and>\n       k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl))\n        (apply_chart c2 \\<circ> inv_chart c \\<circ>\n         inv_chart (restrict_chart (codomain c) chart_eucl))\n 2. restrict_chart (codomain c) chart_eucl \\<in> sub.atlas", "apply (rule bexI[where x = c])"], ["proof (prove)\ngoal (3 subgoals):\n 1. x \\<in> domain (restrict_chart (codomain c) chart_eucl) \\<and>\n    inv_chart c ` domain (restrict_chart (codomain c) chart_eucl)\n    \\<subseteq> domain c \\<and>\n    k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl))\n     (apply_chart c \\<circ> inv_chart c \\<circ>\n      inv_chart (restrict_chart (codomain c) chart_eucl))\n 2. c \\<in> atlas\n 3. restrict_chart (codomain c) chart_eucl \\<in> sub.atlas", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> domain (restrict_chart (codomain c) chart_eucl) \\<and>\n    inv_chart c ` domain (restrict_chart (codomain c) chart_eucl)\n    \\<subseteq> domain c \\<and>\n    k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl))\n     (apply_chart c \\<circ> inv_chart c \\<circ>\n      inv_chart (restrict_chart (codomain c) chart_eucl))", "proof safe"], ["proof (state)\ngoal (3 subgoals):\n 1. x \\<in> domain (restrict_chart (codomain c) chart_eucl)\n 2. \\<And>x xa.\n       xa \\<in> domain\n                 (restrict_chart (codomain c) chart_eucl) \\<Longrightarrow>\n       inv_chart c xa \\<in> domain c\n 3. k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl))\n     (apply_chart c \\<circ> inv_chart c \\<circ>\n      inv_chart (restrict_chart (codomain c) chart_eucl))", "show \"x \\<in> domain (restrict_chart (codomain c) chart_eucl)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> domain (restrict_chart (codomain c) chart_eucl)", "using x \\<open>c \\<in> atlas\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> sub.carrier\n  c \\<in> atlas\n\ngoal (1 subgoal):\n 1. x \\<in> domain (restrict_chart (codomain c) chart_eucl)", "by auto"], ["proof (state)\nthis:\n  x \\<in> domain (restrict_chart (codomain c) chart_eucl)\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       xa \\<in> domain\n                 (restrict_chart (codomain c) chart_eucl) \\<Longrightarrow>\n       inv_chart c xa \\<in> domain c\n 2. k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl))\n     (apply_chart c \\<circ> inv_chart c \\<circ>\n      inv_chart (restrict_chart (codomain c) chart_eucl))", "show \"k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl)) (c \\<circ> inv_chart c \\<circ> inv_chart (restrict_chart (codomain c) chart_eucl))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl))\n     (apply_chart c \\<circ> inv_chart c \\<circ>\n      inv_chart (restrict_chart (codomain c) chart_eucl))", "apply (auto simp: o_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on (codomain c) (\\<lambda>x. apply_chart c (inv_chart c x))", "apply (rule smooth_on_cong[where g=\"\\<lambda>x. x\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. k-smooth_on (codomain c) (\\<lambda>x. x)\n 2. open (codomain c)\n 3. \\<And>x.\n       x \\<in> codomain c \\<Longrightarrow>\n       apply_chart c (inv_chart c x) = x", "by (auto intro!: open_continuous_vimage' continuous_on_codomain)"], ["proof (state)\nthis:\n  k-smooth_on (codomain (restrict_chart (codomain c) chart_eucl))\n   (apply_chart c \\<circ> inv_chart c \\<circ>\n    inv_chart (restrict_chart (codomain c) chart_eucl))\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       xa \\<in> domain\n                 (restrict_chart (codomain c) chart_eucl) \\<Longrightarrow>\n       inv_chart c xa \\<in> domain c", "qed simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. c \\<in> atlas\n 2. restrict_chart (codomain c) chart_eucl \\<in> sub.atlas", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. c \\<in> atlas", "using that"], ["proof (prove)\nusing this:\n  c \\<in> atlas\n\ngoal (1 subgoal):\n 1. c \\<in> atlas", "by simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. restrict_chart (codomain c) chart_eucl \\<in> sub.atlas", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. restrict_chart (codomain c) chart_eucl \\<in> sub.atlas", "by (rule submanifold_atlasI) auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>c1\\<in>sub.atlas.\n     \\<exists>c2\\<in>atlas.\n        x \\<in> domain c1 \\<and>\n        inv_chart c ` domain c1 \\<subseteq> domain c2 \\<and>\n        k-smooth_on (codomain c1)\n         (apply_chart c2 \\<circ> inv_chart c \\<circ> inv_chart c1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  diff k (manifold_eucl.dest.charts_submanifold (codomain c)) charts\n   (inv_chart c)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma chart_inj_on [simp]:\n  fixes c :: \"('a, 'b) chart\"\n  assumes \"x \\<in> domain c\" \"y \\<in> domain c\"\n  shows \"c x = c y \\<longleftrightarrow> x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (apply_chart c x = apply_chart c y) = (x = y)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (apply_chart c x = apply_chart c y) = (x = y)", "have \"inj_on c (domain c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on (apply_chart c) (domain c)", "by (rule inj_on_apply_chart)"], ["proof (state)\nthis:\n  inj_on (apply_chart c) (domain c)\n\ngoal (1 subgoal):\n 1. (apply_chart c x = apply_chart c y) = (x = y)", "with assms"], ["proof (chain)\npicking this:\n  x \\<in> domain c\n  y \\<in> domain c\n  inj_on (apply_chart c) (domain c)", "show ?thesis"], ["proof (prove)\nusing this:\n  x \\<in> domain c\n  y \\<in> domain c\n  inj_on (apply_chart c) (domain c)\n\ngoal (1 subgoal):\n 1. (apply_chart c x = apply_chart c y) = (x = y)", "by (auto simp: inj_on_def)"], ["proof (state)\nthis:\n  (apply_chart c x = apply_chart c y) = (x = y)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Partition of unity by smooth functions\\<close>"], ["", "text\\<open>\n  Given any open cover \\<open>X\\<close> indexed by a set \\<open>A\\<close>, there exists a family of\n  smooth functions \\<open>\\<phi>\\<close> indexed by \\<open>A\\<close>, such that \\<open>0 \\<le> \\<phi> \\<le> 1\\<close>, the (closed) support\n  of each \\<open>\\<phi> i\\<close> is contained in \\<open>X i\\<close>, the supports are locally finite, and the\n  sum of \\<open>\\<phi> i\\<close> is the constant function \\<open>1\\<close>.\\<close>"], ["", "theorem partitions_of_unityE:\n  fixes A::\"'i set\" and X::\"'i \\<Rightarrow> 'a set\"\n  assumes \"carrier \\<subseteq> (\\<Union>i\\<in>A. X i)\"\n  assumes \"\\<And>i. i \\<in> A \\<Longrightarrow> open (X i)\"\n  obtains \\<phi>::\"'i \\<Rightarrow> 'a \\<Rightarrow> real\"\n  where \"\\<And>i. i \\<in> A \\<Longrightarrow> diff_fun k charts (\\<phi> i)\"\n    and \"\\<And>i x. i \\<in> A \\<Longrightarrow> x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> i x\"\n    and \"\\<And>i x. i \\<in> A \\<Longrightarrow> x \\<in> carrier \\<Longrightarrow> \\<phi> i x \\<le> 1\"\n    and \"\\<And>x. x \\<in> carrier \\<Longrightarrow> (\\<Sum>i\\<in>{i\\<in>A. \\<phi> i x \\<noteq> 0}. \\<phi> i x) = 1\"\n    and \"\\<And>i. i \\<in> A \\<Longrightarrow> csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i\"\n    and \"locally_finite_on carrier A (\\<lambda>i. csupport_on carrier (\\<phi> i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from reguler_refinementE[OF assms]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>i. i \\<in> A \\<Longrightarrow> i \\<in> A;\n   \\<And>N \\<psi>.\n      \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n       (domain \\<circ> \\<psi>) ` N refines X ` A;\n       regular_cover N \\<psi>\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis", "obtain N and \\<psi>::\"nat \\<Rightarrow> ('a, 'b) chart\" where \\<psi>:\n    \"\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas\"\n    \"(domain o \\<psi>) ` N refines X ` A\"\n    \"regular_cover N \\<psi>\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>i. i \\<in> A \\<Longrightarrow> i \\<in> A;\n   \\<And>N \\<psi>.\n      \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n       (domain \\<circ> \\<psi>) ` N refines X ` A;\n       regular_cover N \\<psi>\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>N \\<psi>.\n        \\<lbrakk>\\<And>i. i \\<in> N \\<Longrightarrow> \\<psi> i \\<in> atlas;\n         (domain \\<circ> \\<psi>) ` N refines X ` A;\n         regular_cover N \\<psi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> \\<psi> ?i2 \\<in> atlas\n  (domain \\<circ> \\<psi>) ` N refines X ` A\n  regular_cover N \\<psi>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define U where \"U i = inv_chart (\\<psi> i) ` ball 0 1\" for i::nat"], ["proof (state)\nthis:\n  U ?i = inv_chart (\\<psi> ?i) ` ball (0::'b) 1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define V where \"V i = inv_chart (\\<psi> i) ` ball 0 2\" for i::nat"], ["proof (state)\nthis:\n  V ?i = inv_chart (\\<psi> ?i) ` ball (0::'b) 2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define W where \"W i = inv_chart (\\<psi> i) ` ball 0 3\" for i::nat"], ["proof (state)\nthis:\n  W ?i = inv_chart (\\<psi> ?i) ` ball (0::'b) 3\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from \\<open>regular_cover N \\<psi>\\<close>"], ["proof (chain)\npicking this:\n  regular_cover N \\<psi>", "have regular_cover:\n    \"countable N\"\n    \"(\\<Union>i\\<in>N. U i) = (\\<Union>i\\<in>N. domain (\\<psi> i))\"\n    \"locally_finite_on carrier N (domain \\<circ> \\<psi>)\"\n    \"\\<And>i. i \\<in> N \\<Longrightarrow> codomain (\\<psi> i) = ball 0 3\"\n    \"carrier = (\\<Union>i\\<in>N. U i)\""], ["proof (prove)\nusing this:\n  regular_cover N \\<psi>\n\ngoal (1 subgoal):\n 1. (countable N &&&\n     \\<Union> (U ` N) = (\\<Union>i\\<in>N. domain (\\<psi> i))) &&&\n    locally_finite_on carrier N (domain \\<circ> \\<psi>) &&&\n    (\\<And>i.\n        i \\<in> N \\<Longrightarrow>\n        codomain (\\<psi> i) = ball (0::'b) 3) &&&\n    carrier = \\<Union> (U ` N)", "by (auto simp: regular_cover_def U_def)"], ["proof (state)\nthis:\n  countable N\n  \\<Union> (U ` N) = (\\<Union>i\\<in>N. domain (\\<psi> i))\n  locally_finite_on carrier N (domain \\<circ> \\<psi>)\n  ?i2 \\<in> N \\<Longrightarrow> codomain (\\<psi> ?i2) = ball (0::'b) 3\n  carrier = \\<Union> (U ` N)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have open_W: \"open (W i)\" if \"i \\<in> N\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. open (W i)", "using that"], ["proof (prove)\nusing this:\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. open (W i)", "by (auto simp: W_def regular_cover)"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> open (W ?i2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have W_eq: \"domain (\\<psi> i) = W i\" if \"i \\<in> N\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. domain (\\<psi> i) = W i", "using W_def regular_cover(4) that"], ["proof (prove)\nusing this:\n  W ?i = inv_chart (\\<psi> ?i) ` ball (0::'b) 3\n  ?i2 \\<in> N \\<Longrightarrow> codomain (\\<psi> ?i2) = ball (0::'b) 3\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. domain (\\<psi> i) = W i", "by force"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> domain (\\<psi> ?i2) = W ?i2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have carrier_W: \"carrier = (\\<Union>i\\<in>N. W i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier = \\<Union> (W ` N)", "by (auto simp: regular_cover W_eq)"], ["proof (state)\nthis:\n  carrier = \\<Union> (W ` N)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have V_subset_W: \"closure (V i) \\<subseteq> W i\" if \"i \\<in> N\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "have \"closure (V i) \\<subseteq> closure (inv_chart (\\<psi> i) ` cball 0 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (V i)\n    \\<subseteq> closure (inv_chart (\\<psi> i) ` cball (0::'b) 2)", "unfolding V_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (inv_chart (\\<psi> i) ` ball (0::'b) 2)\n    \\<subseteq> closure (inv_chart (\\<psi> i) ` cball (0::'b) 2)", "by (rule closure_mono) auto"], ["proof (state)\nthis:\n  closure (V i) \\<subseteq> closure (inv_chart (\\<psi> i) ` cball (0::'b) 2)\n\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "also"], ["proof (state)\nthis:\n  closure (V i) \\<subseteq> closure (inv_chart (\\<psi> i) ` cball (0::'b) 2)\n\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "have \"\\<dots> = inv_chart (\\<psi> i) ` cball 0 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure (inv_chart (\\<psi> i) ` cball (0::'b) 2) =\n    inv_chart (\\<psi> i) ` cball (0::'b) 2", "apply (rule closure_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. closed (inv_chart (\\<psi> i) ` cball (0::'b) 2)", "apply (rule compact_imp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. compact (inv_chart (\\<psi> i) ` cball (0::'b) 2)", "apply (rule compact_continuous_image)"], ["proof (prove)\ngoal (2 subgoals):\n 1. continuous_on (cball (0::'b) 2) (inv_chart (\\<psi> i))\n 2. compact (cball (0::'b) 2)", "by (auto intro!: continuous_intros simp: regular_cover that)"], ["proof (state)\nthis:\n  closure (inv_chart (\\<psi> i) ` cball (0::'b) 2) =\n  inv_chart (\\<psi> i) ` cball (0::'b) 2\n\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "also"], ["proof (state)\nthis:\n  closure (inv_chart (\\<psi> i) ` cball (0::'b) 2) =\n  inv_chart (\\<psi> i) ` cball (0::'b) 2\n\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "have \"\\<dots> \\<subseteq> W i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_chart (\\<psi> i) ` cball (0::'b) 2 \\<subseteq> W i", "by (auto simp: W_def)"], ["proof (state)\nthis:\n  inv_chart (\\<psi> i) ` cball (0::'b) 2 \\<subseteq> W i\n\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "finally"], ["proof (chain)\npicking this:\n  closure (V i) \\<subseteq> W i", "show ?thesis"], ["proof (prove)\nusing this:\n  closure (V i) \\<subseteq> W i\n\ngoal (1 subgoal):\n 1. closure (V i) \\<subseteq> W i", "."], ["proof (state)\nthis:\n  closure (V i) \\<subseteq> W i\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> closure (V ?i2) \\<subseteq> W ?i2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have carrier_V: \"carrier = (\\<Union>i\\<in>N. V i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier = \\<Union> (V ` N)", "apply (rule antisym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. carrier \\<subseteq> \\<Union> (V ` N)\n 2. \\<Union> (V ` N) \\<subseteq> carrier", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier \\<subseteq> \\<Union> (V ` N)", "unfolding regular_cover(5)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (U ` N) \\<subseteq> \\<Union> (V ` N)", "by (auto simp: U_def V_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (V ` N) \\<subseteq> carrier", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (V ` N) \\<subseteq> carrier", "unfolding carrier_W"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (V ` N) \\<subseteq> \\<Union> (W ` N)", "using V_subset_W"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> closure (V ?i2) \\<subseteq> W ?i2\n\ngoal (1 subgoal):\n 1. \\<Union> (V ` N) \\<subseteq> \\<Union> (W ` N)", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  carrier = \\<Union> (V ` N)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define f where \"f i x = (if x \\<in> W i then H (\\<psi> i x) else 0)\" for i x"], ["proof (state)\nthis:\n  f ?i ?x = (if ?x \\<in> W ?i then H (apply_chart (\\<psi> ?i) ?x) else 0)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have f_simps: \"x \\<in> W i \\<Longrightarrow> f i x = H (\\<psi> i x)\"\n    \"x \\<notin> W i \\<Longrightarrow> f i x = 0\"\n    for i x"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<in> W i \\<Longrightarrow> f i x = H (apply_chart (\\<psi> i) x)) &&&\n    (x \\<notin> W i \\<Longrightarrow> f i x = 0)", "by (auto simp: f_def)"], ["proof (state)\nthis:\n  ?x2 \\<in> W ?i2 \\<Longrightarrow>\n  f ?i2 ?x2 = H (apply_chart (\\<psi> ?i2) ?x2)\n  ?x2 \\<notin> W ?i2 \\<Longrightarrow> f ?i2 ?x2 = 0\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have f_eq_one: \"f j y = 1\" if \"j \\<in> N\" \"y \\<in> U j\" for j y"], ["proof (prove)\ngoal (1 subgoal):\n 1. f j y = 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f j y = 1", "from that"], ["proof (chain)\npicking this:\n  j \\<in> N\n  y \\<in> U j", "have \"y \\<in> W j\""], ["proof (prove)\nusing this:\n  j \\<in> N\n  y \\<in> U j\n\ngoal (1 subgoal):\n 1. y \\<in> W j", "by (auto simp: U_def W_def)"], ["proof (state)\nthis:\n  y \\<in> W j\n\ngoal (1 subgoal):\n 1. f j y = 1", "from \\<open>y \\<in> U j\\<close>"], ["proof (chain)\npicking this:\n  y \\<in> U j", "have \"norm (\\<psi> j y) \\<le> 1\""], ["proof (prove)\nusing this:\n  y \\<in> U j\n\ngoal (1 subgoal):\n 1. norm (apply_chart (\\<psi> j) y) \\<le> 1", "by (auto simp: U_def W_eq[symmetric] \\<open>j \\<in> N\\<close> regular_cover(4))"], ["proof (state)\nthis:\n  norm (apply_chart (\\<psi> j) y) \\<le> 1\n\ngoal (1 subgoal):\n 1. f j y = 1", "then"], ["proof (chain)\npicking this:\n  norm (apply_chart (\\<psi> j) y) \\<le> 1", "show ?thesis"], ["proof (prove)\nusing this:\n  norm (apply_chart (\\<psi> j) y) \\<le> 1\n\ngoal (1 subgoal):\n 1. f j y = 1", "by (auto simp: f_def \\<open>y \\<in> W j\\<close> intro!: H_eq_one)"], ["proof (state)\nthis:\n  f j y = 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?j2 \\<in> N; ?y2 \\<in> U ?j2\\<rbrakk>\n  \\<Longrightarrow> f ?j2 ?y2 = 1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have f_diff: \"diff_fun k charts (f i)\" if i: \"i \\<in> N\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts (f i)", "proof (rule manifold_eucl.diff_open_Un, unfold diff_fun_def[symmetric])"], ["proof (state)\ngoal (5 subgoals):\n 1. diff_fun k (charts_submanifold ?U) (f i)\n 2. diff_fun k (charts_submanifold ?V) (f i)\n 3. open ?U\n 4. open ?V\n 5. carrier \\<subseteq> ?U \\<union> ?V", "note W_eq = W_eq[OF that]"], ["proof (state)\nthis:\n  domain (\\<psi> i) = W i\n\ngoal (5 subgoals):\n 1. diff_fun k (charts_submanifold ?U) (f i)\n 2. diff_fun k (charts_submanifold ?V) (f i)\n 3. open ?U\n 4. open ?V\n 5. carrier \\<subseteq> ?U \\<union> ?V", "have \"W i \\<subseteq> carrier\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W i \\<subseteq> carrier", "unfolding W_eq[symmetric] regular_cover"], ["proof (prove)\ngoal (1 subgoal):\n 1. domain (\\<psi> i) \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> i))", "using that"], ["proof (prove)\nusing this:\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. domain (\\<psi> i) \\<subseteq> (\\<Union>i\\<in>N. domain (\\<psi> i))", "by auto"], ["proof (state)\nthis:\n  W i \\<subseteq> carrier\n\ngoal (5 subgoals):\n 1. diff_fun k (charts_submanifold ?U) (f i)\n 2. diff_fun k (charts_submanifold ?V) (f i)\n 3. open ?U\n 4. open ?V\n 5. carrier \\<subseteq> ?U \\<union> ?V", "interpret W: submanifold _ _ \"W i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submanifold charts k (W i)", "by unfold_locales (auto simp: open_W i)"], ["proof (state)\ngoal (5 subgoals):\n 1. diff_fun k (charts_submanifold ?U) (f i)\n 2. diff_fun k (charts_submanifold ?V) (f i)\n 3. open ?U\n 4. open ?V\n 5. carrier \\<subseteq> ?U \\<union> ?V", "have \"diff_fun k (charts_submanifold (W i)) (H \\<circ> (\\<psi> i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (W i)) (H \\<circ> apply_chart (\\<psi> i))", "apply (rule diff_fun_compose[where ?M2.0 = charts_eucl])"], ["proof (prove)\ngoal (2 subgoals):\n 1. diff k (charts_submanifold (W i)) charts_eucl (apply_chart (\\<psi> i))\n 2. diff_fun k charts_eucl H", "apply (rule diff_apply_chart[of \"\\<psi> i\", unfolded W_eq])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<psi> i \\<in> atlas\n 2. diff_fun k charts_eucl H", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<psi> i \\<in> atlas", "using \\<psi> \\<open>i \\<in> N\\<close>"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> \\<psi> ?i2 \\<in> atlas\n  (domain \\<circ> \\<psi>) ` N refines X ` A\n  regular_cover N \\<psi>\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. \\<psi> i \\<in> atlas", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts_eucl H", "apply (rule diff_fun_charts_euclI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on UNIV H", "by (rule H_smooth_on)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (W i)) (H \\<circ> apply_chart (\\<psi> i))\n\ngoal (5 subgoals):\n 1. diff_fun k (charts_submanifold ?U) (f i)\n 2. diff_fun k (charts_submanifold ?V) (f i)\n 3. open ?U\n 4. open ?V\n 5. carrier \\<subseteq> ?U \\<union> ?V", "then"], ["proof (chain)\npicking this:\n  diff_fun k (charts_submanifold (W i)) (H \\<circ> apply_chart (\\<psi> i))", "show \"diff_fun k (charts_submanifold (W i)) (f i)\""], ["proof (prove)\nusing this:\n  diff_fun k (charts_submanifold (W i)) (H \\<circ> apply_chart (\\<psi> i))\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (W i)) (f i)", "by (rule diff_fun.diff_fun_cong) (auto simp: f_def)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (W i)) (f i)\n\ngoal (4 subgoals):\n 1. diff_fun k (charts_submanifold ?V) (f i)\n 2. open (W i)\n 3. open ?V\n 4. carrier \\<subseteq> W i \\<union> ?V", "interpret V': submanifold _ _ \"carrier - closure (V i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submanifold charts k (carrier - closure (V i))", "by unfold_locales auto"], ["proof (state)\ngoal (4 subgoals):\n 1. diff_fun k (charts_submanifold ?V) (f i)\n 2. open (W i)\n 3. open ?V\n 4. carrier \\<subseteq> W i \\<union> ?V", "have \"diff_fun k (charts_submanifold (carrier - closure (V i))) 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (carrier - closure (V i))) 0", "by (rule V'.sub.diff_fun_zero)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (carrier - closure (V i))) 0\n\ngoal (4 subgoals):\n 1. diff_fun k (charts_submanifold ?V) (f i)\n 2. open (W i)\n 3. open ?V\n 4. carrier \\<subseteq> W i \\<union> ?V", "then"], ["proof (chain)\npicking this:\n  diff_fun k (charts_submanifold (carrier - closure (V i))) 0", "show \"diff_fun k (charts_submanifold (carrier - closure (V i))) (f i)\""], ["proof (prove)\nusing this:\n  diff_fun k (charts_submanifold (carrier - closure (V i))) 0\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (carrier - closure (V i))) (f i)", "apply (rule diff_fun.diff_fun_cong)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> V'.sub.carrier \\<Longrightarrow> 0 x = f i x", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> V'.sub.carrier \\<Longrightarrow>\n       0 x = (if x \\<in> W i then H (apply_chart (\\<psi> i) x) else 0)", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<notin> closure (V i); x \\<in> carrier;\n        x \\<in> W i\\<rbrakk>\n       \\<Longrightarrow> H (apply_chart (\\<psi> i) x) = 0", "apply (rule H_eq_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<notin> closure (V i); x \\<in> carrier;\n        x \\<in> W i\\<rbrakk>\n       \\<Longrightarrow> apply_chart (\\<psi> i) x \\<notin> ball (0::'b) 2", "unfolding V_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<notin> closure (inv_chart (\\<psi> i) ` ball (0::'b) 2);\n        x \\<in> carrier; x \\<in> W i\\<rbrakk>\n       \\<Longrightarrow> apply_chart (\\<psi> i) x \\<notin> ball (0::'b) 2", "by (metis W_eq image_eqI in_closureI inv_chart_inverse)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (carrier - closure (V i))) (f i)\n\ngoal (3 subgoals):\n 1. open (W i)\n 2. open (carrier - closure (V i))\n 3. carrier \\<subseteq> W i \\<union> (carrier - closure (V i))", "show \"open (W i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (W i)", "by (auto simp: W_def regular_cover i)"], ["proof (state)\nthis:\n  open (W i)\n\ngoal (2 subgoals):\n 1. open (carrier - closure (V i))\n 2. carrier \\<subseteq> W i \\<union> (carrier - closure (V i))", "show \"open (carrier - closure (V i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (carrier - closure (V i))", "by auto"], ["proof (state)\nthis:\n  open (carrier - closure (V i))\n\ngoal (1 subgoal):\n 1. carrier \\<subseteq> W i \\<union> (carrier - closure (V i))", "show \"carrier \\<subseteq> W i \\<union> (carrier - closure (V i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier \\<subseteq> W i \\<union> (carrier - closure (V i))", "using V_subset_W[OF i]"], ["proof (prove)\nusing this:\n  closure (V i) \\<subseteq> W i\n\ngoal (1 subgoal):\n 1. carrier \\<subseteq> W i \\<union> (carrier - closure (V i))", "by auto"], ["proof (state)\nthis:\n  carrier \\<subseteq> W i \\<union> (carrier - closure (V i))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> diff_fun k charts (f ?i2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define g where \"g \\<psi> x = f \\<psi> x / (\\<Sum>i\\<in>{j\\<in>N. x \\<in> W j}. f i x)\" for \\<psi> x"], ["proof (state)\nthis:\n  g ?\\<psi> ?x =\n  f ?\\<psi> ?x / (\\<Sum>i\\<in>{j \\<in> N. ?x \\<in> W j}. f i ?x)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<forall>p\\<in>carrier. \\<exists>I. p \\<in> I \\<and> open I \\<and>finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}\"\n    (is \"\\<forall>p\\<in>carrier. ?P p\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>carrier.\n       \\<exists>I.\n          p \\<in> I \\<and>\n          open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "proof (rule ballI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>I.\n          p \\<in> I \\<and>\n          open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "fix p"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>I.\n          p \\<in> I \\<and>\n          open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "assume \"p \\<in> carrier\""], ["proof (state)\nthis:\n  p \\<in> carrier\n\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>I.\n          p \\<in> I \\<and>\n          open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "from locally_finite_onE[OF regular_cover(3) this]"], ["proof (chain)\npicking this:\n  (\\<And>Na.\n      \\<lbrakk>p \\<in> Na; open Na;\n       finite\n        {i \\<in> N.\n         (domain \\<circ> \\<psi>) i \\<inter> Na \\<noteq> {}}\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain I where \"p \\<in> I\" \"open I\" \"finite {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}}\""], ["proof (prove)\nusing this:\n  (\\<And>Na.\n      \\<lbrakk>p \\<in> Na; open Na;\n       finite\n        {i \\<in> N.\n         (domain \\<circ> \\<psi>) i \\<inter> Na \\<noteq> {}}\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>I.\n        \\<lbrakk>p \\<in> I; open I;\n         finite\n          {i \\<in> N.\n           (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "."], ["proof (state)\nthis:\n  p \\<in> I\n  open I\n  finite {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>I.\n          p \\<in> I \\<and>\n          open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "moreover"], ["proof (state)\nthis:\n  p \\<in> I\n  open I\n  finite {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>I.\n          p \\<in> I \\<and>\n          open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "have \"{i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}} = {i \\<in> N. W i \\<inter> I \\<noteq> {}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}} =\n    {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "by (auto simp: W_eq)"], ["proof (state)\nthis:\n  {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}} =\n  {i \\<in> N. W i \\<inter> I \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>I.\n          p \\<in> I \\<and>\n          open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "ultimately"], ["proof (chain)\npicking this:\n  p \\<in> I\n  open I\n  finite {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}}\n  {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}} =\n  {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "show \"?P p\""], ["proof (prove)\nusing this:\n  p \\<in> I\n  open I\n  finite {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}}\n  {i \\<in> N. (domain \\<circ> \\<psi>) i \\<inter> I \\<noteq> {}} =\n  {i \\<in> N. W i \\<inter> I \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. \\<exists>I.\n       p \\<in> I \\<and>\n       open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}", "by auto"], ["proof (state)\nthis:\n  \\<exists>I.\n     p \\<in> I \\<and>\n     open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>p\\<in>carrier.\n     \\<exists>I.\n        p \\<in> I \\<and>\n        open I \\<and> finite {i \\<in> N. W i \\<inter> I \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from bchoice[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>f.\n     \\<forall>x\\<in>carrier.\n        x \\<in> f x \\<and>\n        open (f x) \\<and> finite {i \\<in> N. W i \\<inter> f x \\<noteq> {}}", "obtain I where I:\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> I x\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> open (I x)\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> finite {i \\<in> N. W i \\<inter> I x \\<noteq> {}}\""], ["proof (prove)\nusing this:\n  \\<exists>f.\n     \\<forall>x\\<in>carrier.\n        x \\<in> f x \\<and>\n        open (f x) \\<and> finite {i \\<in> N. W i \\<inter> f x \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. (\\<And>I.\n        \\<lbrakk>\\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> I x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> open (I x);\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            finite {i \\<in> N. W i \\<inter> I x \\<noteq> {}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  ?x2 \\<in> carrier \\<Longrightarrow> ?x2 \\<in> I ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> open (I ?x2)\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  finite {i \\<in> N. W i \\<inter> I ?x2 \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have subset_W: \"{j \\<in> N. y \\<in> W j} \\<subseteq> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\" if \"y \\<in> I x\" \"x \\<in> carrier\" for x y"], ["proof (prove)\ngoal (1 subgoal):\n 1. {j \\<in> N. y \\<in> W j}\n    \\<subseteq> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}", "by (auto simp: that W_eq)"], ["proof (state)\nthis:\n  \\<lbrakk>?y2 \\<in> I ?x2; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> {j \\<in> N. ?y2 \\<in> W j}\n                    \\<subseteq> {j \\<in> N. W j \\<inter> I ?x2 \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have finite_W: \"finite {j \\<in> N. y \\<in> W j}\" if \"y \\<in> carrier\" for y"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {j \\<in> N. y \\<in> W j}", "apply (rule finite_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. {j \\<in> N. y \\<in> W j} \\<subseteq> ?B\n 2. finite ?B", "apply (rule subset_W[OF _ that])"], ["proof (prove)\ngoal (2 subgoals):\n 1. y \\<in> I y\n 2. finite {j \\<in> N. W j \\<inter> I y \\<noteq> {}}", "apply (rule I[OF that])"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {j \\<in> N. W j \\<inter> I y \\<noteq> {}}", "apply (rule I[unfolded o_def, OF that])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ?y2 \\<in> carrier \\<Longrightarrow> finite {j \\<in> N. ?y2 \\<in> W j}\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have g: \"diff_fun k charts (g i)\" if i: \"i \\<in> N\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts (g i)", "proof (rule manifold_eucl.diff_localI, unfold diff_fun_def[symmetric])"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (?U x)) (g i)\n 2. \\<And>x. x \\<in> carrier \\<Longrightarrow> open (?U x)\n 3. \\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> ?U x", "fix x"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (?U x)) (g i)\n 2. \\<And>x. x \\<in> carrier \\<Longrightarrow> open (?U x)\n 3. \\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> ?U x", "assume x: \"x \\<in> carrier\""], ["proof (state)\nthis:\n  x \\<in> carrier\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (?U x)) (g i)\n 2. \\<And>x. x \\<in> carrier \\<Longrightarrow> open (?U x)\n 3. \\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> ?U x", "show \"open (I x)\" \"x \\<in> I x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (I x) &&& x \\<in> I x", "using I x"], ["proof (prove)\nusing this:\n  ?x2 \\<in> carrier \\<Longrightarrow> ?x2 \\<in> I ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> open (I ?x2)\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  finite {i \\<in> N. W i \\<inter> I ?x2 \\<noteq> {}}\n  x \\<in> carrier\n\ngoal (1 subgoal):\n 1. open (I x) &&& x \\<in> I x", "by auto"], ["proof (state)\nthis:\n  open (I x)\n  x \\<in> I x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (I x)) (g i)", "then"], ["proof (chain)\npicking this:\n  open (I x)\n  x \\<in> I x", "interpret submanifold _ _ \"I x\""], ["proof (prove)\nusing this:\n  open (I x)\n  x \\<in> I x\n\ngoal (1 subgoal):\n 1. submanifold charts k (I x)", "by unfold_locales"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (I x)) (g i)", "interpret df: diff_fun k charts \"f i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts (f i)", "by (rule f_diff) fact"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (I x)) (g i)", "have \"diff_fun k (charts_submanifold (I x)) (\\<lambda>y. f i y / (\\<Sum>j\\<in>{j\\<in>N. W j \\<inter> I x \\<noteq> {}}. f j y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x))\n     (\\<lambda>y.\n         f i y /\n         (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j y))", "apply (rule sub.diff_fun_divide)"], ["proof (prove)\ngoal (3 subgoals):\n 1. diff_fun k (charts_submanifold (I x)) (f i)\n 2. diff_fun k (charts_submanifold (I x))\n     (\\<lambda>xa.\n         \\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j xa)\n 3. \\<And>y.\n       y \\<in> sub.carrier \\<Longrightarrow>\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}.\n          f j y) \\<noteq>\n       0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (f i)", "apply (rule df.diff_submanifold[folded diff_fun_def])"], ["proof (prove)\ngoal (1 subgoal):\n 1. open (I x)", "by (rule I) fact"], ["proof (prove)\ngoal (2 subgoals):\n 1. diff_fun k (charts_submanifold (I x))\n     (\\<lambda>xa.\n         \\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j xa)\n 2. \\<And>y.\n       y \\<in> sub.carrier \\<Longrightarrow>\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}.\n          f j y) \\<noteq>\n       0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x))\n     (\\<lambda>xa.\n         \\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j xa)", "proof (rule sub.diff_fun_sum, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>j \\<in> N; W j \\<inter> I x \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> diff_fun k (charts_submanifold (I x)) (f j)", "fix j"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>j \\<in> N; W j \\<inter> I x \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> diff_fun k (charts_submanifold (I x)) (f j)", "assume \"j \\<in> N\" \"W j \\<inter> I x \\<noteq> {}\""], ["proof (state)\nthis:\n  j \\<in> N\n  W j \\<inter> I x \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>j \\<in> N; W j \\<inter> I x \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> diff_fun k (charts_submanifold (I x)) (f j)", "interpret df': diff_fun k charts \"f j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts (f j)", "by (rule f_diff) fact"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>j \\<in> N; W j \\<inter> I x \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> diff_fun k (charts_submanifold (I x)) (f j)", "show \"diff_fun k (charts_submanifold (I x)) (f j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (f j)", "apply (rule df'.diff_fun_submanifold)"], ["proof (prove)\ngoal (1 subgoal):\n 1. open (I x)", "by (rule I) fact"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (I x)) (f j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       y \\<in> sub.carrier \\<Longrightarrow>\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}.\n          f j y) \\<noteq>\n       0", "subgoal for y"], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> sub.carrier \\<Longrightarrow>\n    (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}.\n       f j y) \\<noteq>\n    0", "apply (subst sum_nonneg_eq_0_iff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. y \\<in> sub.carrier \\<Longrightarrow>\n    finite {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\n 2. \\<And>xa.\n       \\<lbrakk>y \\<in> sub.carrier;\n        xa \\<in> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> f xa y\n 3. y \\<in> sub.carrier \\<Longrightarrow>\n    \\<not> (\\<forall>x\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}}.\n               f x y = 0)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> sub.carrier \\<Longrightarrow>\n    finite {j \\<in> N. W j \\<inter> I x \\<noteq> {}}", "using I(3)[OF x]"], ["proof (prove)\nusing this:\n  finite {i \\<in> N. W i \\<inter> I x \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. y \\<in> sub.carrier \\<Longrightarrow>\n    finite {j \\<in> N. W j \\<inter> I x \\<noteq> {}}", "by auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>y \\<in> sub.carrier;\n        xa \\<in> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> f xa y\n 2. y \\<in> sub.carrier \\<Longrightarrow>\n    \\<not> (\\<forall>x\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}}.\n               f x y = 0)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> sub.carrier;\n     xa_ \\<in> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> f xa_ y", "using H_range"], ["proof (prove)\nusing this:\n  0 \\<le> H ?x\n  H ?x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> sub.carrier;\n     xa_ \\<in> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> f xa_ y", "by (auto simp: f_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> sub.carrier \\<Longrightarrow>\n    \\<not> (\\<forall>x\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}}.\n               f x y = 0)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> sub.carrier \\<Longrightarrow>\n    \\<not> (\\<forall>x\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}}.\n               f x y = 0)", "proof clarsimp"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "assume y: \"y \\<in> I x\" \"y \\<in> carrier\""], ["proof (state)\nthis:\n  y \\<in> I x\n  y \\<in> carrier\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "then"], ["proof (chain)\npicking this:\n  y \\<in> I x\n  y \\<in> carrier", "obtain j where \"j \\<in> N\" \"y \\<in> U j\""], ["proof (prove)\nusing this:\n  y \\<in> I x\n  y \\<in> carrier\n\ngoal (1 subgoal):\n 1. (\\<And>j.\n        \\<lbrakk>j \\<in> N; y \\<in> U j\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding regular_cover(5)"], ["proof (prove)\nusing this:\n  y \\<in> I x\n  y \\<in> \\<Union> (U ` N)\n\ngoal (1 subgoal):\n 1. (\\<And>j.\n        \\<lbrakk>j \\<in> N; y \\<in> U j\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  j \\<in> N\n  y \\<in> U j\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "then"], ["proof (chain)\npicking this:\n  j \\<in> N\n  y \\<in> U j", "have \"y \\<in> W j\""], ["proof (prove)\nusing this:\n  j \\<in> N\n  y \\<in> U j\n\ngoal (1 subgoal):\n 1. y \\<in> W j", "by (auto simp: U_def W_def)"], ["proof (state)\nthis:\n  y \\<in> W j\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "moreover"], ["proof (state)\nthis:\n  y \\<in> W j\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "have \"W j \\<inter> I x \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W j \\<inter> I x \\<noteq> {}", "using W_eq \\<open>j \\<in> N\\<close> \\<open>open (I x)\\<close> \\<open>y \\<in> W j\\<close> \\<open>y \\<in> carrier\\<close> \\<open>y \\<in> I x\\<close>"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> domain (\\<psi> ?i2) = W ?i2\n  j \\<in> N\n  open (I x)\n  y \\<in> W j\n  y \\<in> carrier\n  y \\<in> I x\n\ngoal (1 subgoal):\n 1. W j \\<inter> I x \\<noteq> {}", "by auto"], ["proof (state)\nthis:\n  W j \\<inter> I x \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "moreover"], ["proof (state)\nthis:\n  W j \\<inter> I x \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "note f_eq_one[OF \\<open>j \\<in> N\\<close> \\<open>y \\<in> U j\\<close>]"], ["proof (state)\nthis:\n  f j y = 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<in> I x; y \\<in> carrier\\<rbrakk>\n    \\<Longrightarrow> \\<exists>xa.\n                         xa \\<in> N \\<and>\n                         W xa \\<inter> I x \\<noteq> {} \\<and>\n                         f xa y \\<noteq> 0", "ultimately"], ["proof (chain)\npicking this:\n  y \\<in> W j\n  W j \\<inter> I x \\<noteq> {}\n  f j y = 1", "show \"\\<exists>xa. xa \\<in> N \\<and> W xa \\<inter> I x \\<noteq> {} \\<and> f xa y \\<noteq> 0\""], ["proof (prove)\nusing this:\n  y \\<in> W j\n  W j \\<inter> I x \\<noteq> {}\n  f j y = 1\n\ngoal (1 subgoal):\n 1. \\<exists>xa.\n       xa \\<in> N \\<and>\n       W xa \\<inter> I x \\<noteq> {} \\<and> f xa y \\<noteq> 0", "by (intro exI[where x=j]) (auto simp: \\<open>j \\<in> N\\<close>)"], ["proof (state)\nthis:\n  \\<exists>xa.\n     xa \\<in> N \\<and>\n     W xa \\<inter> I x \\<noteq> {} \\<and> f xa y \\<noteq> 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (I x))\n   (\\<lambda>y.\n       f i y /\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j y))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (I x)) (g i)", "then"], ["proof (chain)\npicking this:\n  diff_fun k (charts_submanifold (I x))\n   (\\<lambda>y.\n       f i y /\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j y))", "show \"diff_fun k (charts_submanifold (I x)) (g i)\""], ["proof (prove)\nusing this:\n  diff_fun k (charts_submanifold (I x))\n   (\\<lambda>y.\n       f i y /\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j y))\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (g i)", "apply (rule diff_fun.diff_fun_cong)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       f i xa /\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j xa) =\n       g i xa", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       f i xa /\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j xa) =\n       f i xa / (\\<Sum>i\\<in>{j \\<in> N. xa \\<in> W j}. f i xa)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       f i xa = 0 \\<or>\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j xa) =\n       (\\<Sum>i\\<in>{j \\<in> N. xa \\<in> W j}. f i xa)", "apply (rule disjI2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       (\\<Sum>j | j \\<in> N \\<and> W j \\<inter> I x \\<noteq> {}. f j xa) =\n       (\\<Sum>i\\<in>{j \\<in> N. xa \\<in> W j}. f i xa)", "apply (rule sum.mono_neutral_right)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       finite {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\n 2. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       {j \\<in> N. xa \\<in> W j}\n       \\<subseteq> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\n 3. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       \\<forall>i\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}} -\n                      {j \\<in> N. xa \\<in> W j}.\n          f i xa = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. xa_ \\<in> I x \\<and> xa_ \\<in> carrier \\<Longrightarrow>\n    finite {j \\<in> N. W j \\<inter> I x \\<noteq> {}}", "using I[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  x \\<in> I x\n  open (I x)\n  finite {i \\<in> N. W i \\<inter> I x \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. xa_ \\<in> I x \\<and> xa_ \\<in> carrier \\<Longrightarrow>\n    finite {j \\<in> N. W j \\<inter> I x \\<noteq> {}}", "unfolding o_def"], ["proof (prove)\nusing this:\n  x \\<in> I x\n  open (I x)\n  finite {i \\<in> N. W i \\<inter> I x \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. xa_ \\<in> I x \\<and> xa_ \\<in> carrier \\<Longrightarrow>\n    finite {j \\<in> N. W j \\<inter> I x \\<noteq> {}}", "by simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       {j \\<in> N. xa \\<in> W j}\n       \\<subseteq> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}\n 2. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       \\<forall>i\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}} -\n                      {j \\<in> N. xa \\<in> W j}.\n          f i xa = 0", "subgoal for y"], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> I x \\<and> y \\<in> carrier \\<Longrightarrow>\n    {j \\<in> N. y \\<in> W j}\n    \\<subseteq> {j \\<in> N. W j \\<inter> I x \\<noteq> {}}", "apply (rule subset_W)"], ["proof (prove)\ngoal (2 subgoals):\n 1. y \\<in> I x \\<and> y \\<in> carrier \\<Longrightarrow> y \\<in> I x\n 2. y \\<in> I x \\<and> y \\<in> carrier \\<Longrightarrow> x \\<in> carrier", "using carrier_submanifold I \\<open>x \\<in> carrier\\<close>"], ["proof (prove)\nusing this:\n  sub.carrier = I x \\<inter> carrier\n  ?x2 \\<in> carrier \\<Longrightarrow> ?x2 \\<in> I ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> open (I ?x2)\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  finite {i \\<in> N. W i \\<inter> I ?x2 \\<noteq> {}}\n  x \\<in> carrier\n\ngoal (2 subgoals):\n 1. y \\<in> I x \\<and> y \\<in> carrier \\<Longrightarrow> y \\<in> I x\n 2. y \\<in> I x \\<and> y \\<in> carrier \\<Longrightarrow> x \\<in> carrier", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> I x \\<and> xa \\<in> carrier \\<Longrightarrow>\n       \\<forall>i\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}} -\n                      {j \\<in> N. xa \\<in> W j}.\n          f i xa = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. xa_ \\<in> I x \\<and> xa_ \\<in> carrier \\<Longrightarrow>\n    \\<forall>i\\<in>{j \\<in> N. W j \\<inter> I x \\<noteq> {}} -\n                   {j \\<in> N. xa_ \\<in> W j}.\n       f i xa_ = 0", "by (auto simp: f_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (I x)) (g i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> diff_fun k charts (g ?i2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have f_nonneg: \"0 \\<le> f i x\" for i x"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> f i x", "by (auto simp: f_def H_range intro!: sum_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> f ?i2 ?x2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have U_sub_W: \"x \\<in> U i \\<Longrightarrow> x \\<in> W i\" for x i"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> U i \\<Longrightarrow> x \\<in> W i", "by (auto simp: U_def W_def)"], ["proof (state)\nthis:\n  ?x2 \\<in> U ?i2 \\<Longrightarrow> ?x2 \\<in> W ?i2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have sumf_pos: \"(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) > 0\" if \"x \\<in> carrier\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "(* and this sum is smooth, use to simplify earlier reasoning! *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "using that"], ["proof (prove)\nusing this:\n  x \\<in> carrier\n\ngoal (1 subgoal):\n 1. 0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "apply (auto simp: regular_cover(5))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>xa \\<in> N; x \\<in> U xa\\<rbrakk>\n       \\<Longrightarrow> 0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "subgoal for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> U i\\<rbrakk>\n    \\<Longrightarrow> 0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "apply (rule sum_pos2[where i=i])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>i \\<in> N; x \\<in> U i\\<rbrakk>\n    \\<Longrightarrow> finite {j \\<in> N. x \\<in> W j}\n 2. \\<lbrakk>i \\<in> N; x \\<in> U i\\<rbrakk>\n    \\<Longrightarrow> i \\<in> {j \\<in> N. x \\<in> W j}\n 3. \\<lbrakk>i \\<in> N; x \\<in> U i\\<rbrakk> \\<Longrightarrow> 0 < f i x\n 4. \\<And>ia.\n       \\<lbrakk>i \\<in> N; x \\<in> U i;\n        ia \\<in> {j \\<in> N. x \\<in> W j}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> f ia x", "using finite_W[OF that]"], ["proof (prove)\nusing this:\n  finite {j \\<in> N. x \\<in> W j}\n\ngoal (4 subgoals):\n 1. \\<lbrakk>i \\<in> N; x \\<in> U i\\<rbrakk>\n    \\<Longrightarrow> finite {j \\<in> N. x \\<in> W j}\n 2. \\<lbrakk>i \\<in> N; x \\<in> U i\\<rbrakk>\n    \\<Longrightarrow> i \\<in> {j \\<in> N. x \\<in> W j}\n 3. \\<lbrakk>i \\<in> N; x \\<in> U i\\<rbrakk> \\<Longrightarrow> 0 < f i x\n 4. \\<And>ia.\n       \\<lbrakk>i \\<in> N; x \\<in> U i;\n        ia \\<in> {j \\<in> N. x \\<in> W j}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> f ia x", "by (auto simp: f_nonneg f_eq_one U_sub_W )"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  0 < (\\<Sum>i\\<in>{j \\<in> N. ?x2 \\<in> W j}. f i ?x2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have sumf_nonneg: \"(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<ge> 0\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "by (auto simp: f_nonneg intro!: sum_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i\\<in>{j \\<in> N. ?x2 \\<in> W j}. f i ?x2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have g_nonneg: \"0 \\<le> g i x\" if \"i \\<in> N\" \"x \\<in> carrier\" for i x"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> g i x", "by (auto simp: g_def intro!: divide_nonneg_nonneg sumf_nonneg f_nonneg)"], ["proof (state)\nthis:\n  \\<lbrakk>?i2 \\<in> N; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> g ?i2 ?x2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have g_le_one: \"g i x \\<le> 1\" if \"i \\<in> N\" \"x \\<in> carrier\" for i x"], ["proof (prove)\ngoal (1 subgoal):\n 1. g i x \\<le> 1", "apply (auto simp add: g_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f i x / (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<le> 1", "(*sumf is positive*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f i x / (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<le> 1", "apply (cases \"(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) = 0 \\<Longrightarrow>\n    f i x / (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<le> 1\n 2. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq>\n    0 \\<Longrightarrow>\n    f i x / (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<le> 1", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) = 0 \\<Longrightarrow>\n    f i x / (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<le> 1", "by simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq>\n    0 \\<Longrightarrow>\n    f i x / (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<le> 1", "apply (subst divide_le_eq_1_pos)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq>\n    0 \\<Longrightarrow>\n    0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)\n 2. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq>\n    0 \\<Longrightarrow>\n    f i x \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq>\n    0 \\<Longrightarrow>\n    0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "using sumf_nonneg[of x]"], ["proof (prove)\nusing this:\n  0 \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq>\n    0 \\<Longrightarrow>\n    0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq>\n    0 \\<Longrightarrow>\n    f i x \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "apply (cases \"x \\<in> W i\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> f i x\n                      \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)\n 2. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<notin> W i\\<rbrakk>\n    \\<Longrightarrow> f i x\n                      \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> f i x\n                      \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "apply (rule member_le_sum)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> i \\<in> {j \\<in> N. x \\<in> W j}\n 2. \\<And>xa.\n       \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n        x \\<in> W i; xa \\<in> {j \\<in> N. x \\<in> W j} - {i}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> f xa x\n 3. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> finite {j \\<in> N. x \\<in> W j}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> i \\<in> {j \\<in> N. x \\<in> W j}", "using \\<open>i \\<in> N\\<close>"], ["proof (prove)\nusing this:\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> i \\<in> {j \\<in> N. x \\<in> W j}", "by simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n        x \\<in> W i; xa \\<in> {j \\<in> N. x \\<in> W j} - {i}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> f xa x\n 2. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> finite {j \\<in> N. x \\<in> W j}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i; xa_ \\<in> {j \\<in> N. x \\<in> W j} - {i}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> f xa_ x", "by (rule f_nonneg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> finite {j \\<in> N. x \\<in> W j}", "using sum.infinite"], ["proof (prove)\nusing this:\n  infinite ?A \\<Longrightarrow> sum ?g ?A = (0::?'a)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> finite {j \\<in> N. x \\<in> W j}", "by blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<notin> W i\\<rbrakk>\n    \\<Longrightarrow> f i x\n                      \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) \\<noteq> 0;\n     x \\<notin> W i\\<rbrakk>\n    \\<Longrightarrow> f i x\n                      \\<le> (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)", "by (simp add: f_simps sum_nonneg H_range)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<lbrakk>?i2 \\<in> N; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> g ?i2 ?x2 \\<le> 1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have sum_g: \"(\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x) = 1\" if \"x \\<in> carrier\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x) = 1", "unfolding g_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i.\n       f i x / (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)) =\n    1", "apply (subst sum_divide_distrib[symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. f i x) /\n    (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) =\n    1", "using sumf_pos[OF that]"], ["proof (prove)\nusing this:\n  0 < (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. f i x) /\n    (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}. f i x) =\n    1", "by auto"], ["proof (state)\nthis:\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  (\\<Sum>i | i \\<in> N \\<and> ?x2 \\<in> W i. g i ?x2) = 1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<exists>a. \\<forall>i\\<in>N. W i \\<subseteq> X (a i) \\<and> a i \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>a. \\<forall>i\\<in>N. W i \\<subseteq> X (a i) \\<and> a i \\<in> A", "using \\<psi>(2)"], ["proof (prove)\nusing this:\n  (domain \\<circ> \\<psi>) ` N refines X ` A\n\ngoal (1 subgoal):\n 1. \\<exists>a. \\<forall>i\\<in>N. W i \\<subseteq> X (a i) \\<and> a i \\<in> A", "by (intro bchoice) (auto simp: refines_def W_eq)"], ["proof (state)\nthis:\n  \\<exists>a. \\<forall>i\\<in>N. W i \\<subseteq> X (a i) \\<and> a i \\<in> A\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  \\<exists>a. \\<forall>i\\<in>N. W i \\<subseteq> X (a i) \\<and> a i \\<in> A", "obtain a where a: \"\\<And>i. i \\<in> N \\<Longrightarrow> W i \\<subseteq> X (a i)\" \"\\<And>i. i \\<in> N \\<Longrightarrow> a i \\<in> A\""], ["proof (prove)\nusing this:\n  \\<exists>a. \\<forall>i\\<in>N. W i \\<subseteq> X (a i) \\<and> a i \\<in> A\n\ngoal (1 subgoal):\n 1. (\\<And>a.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> N \\<Longrightarrow> W i \\<subseteq> X (a i);\n         \\<And>i. i \\<in> N \\<Longrightarrow> a i \\<in> A\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> W ?i2 \\<subseteq> X (a ?i2)\n  ?i2 \\<in> N \\<Longrightarrow> a ?i2 \\<in> A\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define \\<phi> where \"\\<phi> \\<alpha> x = (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x)\" for \\<alpha> x"], ["proof (state)\nthis:\n  \\<phi> ?\\<alpha> ?x =\n  (\\<Sum>i | i \\<in> N \\<and> a i = ?\\<alpha> \\<and> ?x \\<in> W i. g i ?x)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"diff_fun k charts (\\<phi> \\<alpha>)\" if \"\\<alpha> \\<in> A\" for \\<alpha>"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts (\\<phi> \\<alpha>)", "proof (rule manifold_eucl.diff_localI, unfold diff_fun_def[symmetric])"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (?U x)) (\\<phi> \\<alpha>)\n 2. \\<And>x. x \\<in> carrier \\<Longrightarrow> open (?U x)\n 3. \\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> ?U x", "(* extract the lemma here?! *)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (?U x)) (\\<phi> \\<alpha>)\n 2. \\<And>x. x \\<in> carrier \\<Longrightarrow> open (?U x)\n 3. \\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> ?U x", "fix x"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (?U x)) (\\<phi> \\<alpha>)\n 2. \\<And>x. x \\<in> carrier \\<Longrightarrow> open (?U x)\n 3. \\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> ?U x", "assume x: \"x \\<in> carrier\""], ["proof (state)\nthis:\n  x \\<in> carrier\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (?U x)) (\\<phi> \\<alpha>)\n 2. \\<And>x. x \\<in> carrier \\<Longrightarrow> open (?U x)\n 3. \\<And>x. x \\<in> carrier \\<Longrightarrow> x \\<in> ?U x", "show \"open (I x)\" \"x \\<in> I x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (I x) &&& x \\<in> I x", "using I x"], ["proof (prove)\nusing this:\n  ?x2 \\<in> carrier \\<Longrightarrow> ?x2 \\<in> I ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> open (I ?x2)\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  finite {i \\<in> N. W i \\<inter> I ?x2 \\<noteq> {}}\n  x \\<in> carrier\n\ngoal (1 subgoal):\n 1. open (I x) &&& x \\<in> I x", "by auto"], ["proof (state)\nthis:\n  open (I x)\n  x \\<in> I x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (I x)) (\\<phi> \\<alpha>)", "then"], ["proof (chain)\npicking this:\n  open (I x)\n  x \\<in> I x", "interpret submanifold _ _ \"I x\""], ["proof (prove)\nusing this:\n  open (I x)\n  x \\<in> I x\n\ngoal (1 subgoal):\n 1. submanifold charts k (I x)", "by unfold_locales"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (I x)) (\\<phi> \\<alpha>)", "have \"diff_fun k (charts_submanifold (I x)) (\\<lambda>y. (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}. g i y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x))\n     (\\<lambda>y.\n         \\<Sum>i | i \\<in> N \\<and>\n                   a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}.\n           g i y)", "apply (rule sub.diff_fun_sum, clarsimp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>i \\<in> N; W i \\<inter> I x \\<noteq> {};\n        \\<alpha> = a i\\<rbrakk>\n       \\<Longrightarrow> diff_fun k (charts_submanifold (I x)) (g i)", "subgoal premises prems for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (g i)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (g i)", "interpret dg: diff_fun k charts \"g i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts (g i)", "by (rule g) fact"], ["proof (state)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (g i)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (g i)", "apply (rule dg.diff_fun_submanifold)"], ["proof (prove)\ngoal (1 subgoal):\n 1. open (I x)", "by (rule I) fact"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (I x)) (g i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (I x))\n   (\\<lambda>y.\n       \\<Sum>i | i \\<in> N \\<and>\n                 a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}.\n         g i y)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier \\<Longrightarrow>\n       diff_fun k (charts_submanifold (I x)) (\\<phi> \\<alpha>)", "then"], ["proof (chain)\npicking this:\n  diff_fun k (charts_submanifold (I x))\n   (\\<lambda>y.\n       \\<Sum>i | i \\<in> N \\<and>\n                 a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}.\n         g i y)", "show \"diff_fun k (charts_submanifold (I x)) (\\<phi> \\<alpha>)\""], ["proof (prove)\nusing this:\n  diff_fun k (charts_submanifold (I x))\n   (\\<lambda>y.\n       \\<Sum>i | i \\<in> N \\<and>\n                 a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}.\n         g i y)\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (I x)) (\\<phi> \\<alpha>)", "apply (rule diff_fun.diff_fun_cong)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       (\\<Sum>i | i \\<in> N \\<and>\n                  a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}.\n          g i xa) =\n       \\<phi> \\<alpha> xa", "unfolding \\<phi>_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       (\\<Sum>i | i \\<in> N \\<and>\n                  a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}.\n          g i xa) =\n       (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> xa \\<in> W i.\n          g i xa)", "apply (rule sum.mono_neutral_right)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       finite\n        {i \\<in> N. a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}}\n 2. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       {i \\<in> N. a i = \\<alpha> \\<and> xa \\<in> W i}\n       \\<subseteq> {i \\<in> N.\n                    a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}}\n 3. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       \\<forall>i\\<in>{i \\<in> N.\n                       a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}} -\n                      {i \\<in> N. a i = \\<alpha> \\<and> xa \\<in> W i}.\n          g i xa = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. xa_ \\<in> sub.carrier \\<Longrightarrow>\n    finite {i \\<in> N. a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}}", "using _ I(3)[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  finite {i \\<in> N. W i \\<inter> I x \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. xa_ \\<in> sub.carrier \\<Longrightarrow>\n    finite {i \\<in> N. a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}}", "by (rule finite_subset) (auto simp:)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       {i \\<in> N. a i = \\<alpha> \\<and> xa \\<in> W i}\n       \\<subseteq> {i \\<in> N.\n                    a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}}\n 2. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       \\<forall>i\\<in>{i \\<in> N.\n                       a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}} -\n                      {i \\<in> N. a i = \\<alpha> \\<and> xa \\<in> W i}.\n          g i xa = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. xa_ \\<in> sub.carrier \\<Longrightarrow>\n    {i \\<in> N. a i = \\<alpha> \\<and> xa_ \\<in> W i}\n    \\<subseteq> {i \\<in> N.\n                 a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}}", "using \\<open>open (I x)\\<close> carrier_submanifold"], ["proof (prove)\nusing this:\n  open (I x)\n  sub.carrier = I x \\<inter> carrier\n\ngoal (1 subgoal):\n 1. xa_ \\<in> sub.carrier \\<Longrightarrow>\n    {i \\<in> N. a i = \\<alpha> \\<and> xa_ \\<in> W i}\n    \\<subseteq> {i \\<in> N.\n                 a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}}", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> sub.carrier \\<Longrightarrow>\n       \\<forall>i\\<in>{i \\<in> N.\n                       a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}} -\n                      {i \\<in> N. a i = \\<alpha> \\<and> xa \\<in> W i}.\n          g i xa = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. xa_ \\<in> sub.carrier \\<Longrightarrow>\n    \\<forall>i\\<in>{i \\<in> N.\n                    a i = \\<alpha> \\<and> W i \\<inter> I x \\<noteq> {}} -\n                   {i \\<in> N. a i = \\<alpha> \\<and> xa_ \\<in> W i}.\n       g i xa_ = 0", "by (auto simp: g_def f_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (I x)) (\\<phi> \\<alpha>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow> diff_fun k charts (\\<phi> ?\\<alpha>2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow> diff_fun k charts (\\<phi> ?\\<alpha>2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"0 \\<le> \\<phi> \\<alpha> x\" if \"x \\<in> carrier\" for \\<alpha> x"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> \\<phi> \\<alpha> x", "by (auto simp: \\<phi>_def intro!: sum_nonneg g_nonneg that)"], ["proof (state)\nthis:\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> ?\\<alpha>2 ?x2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> ?\\<alpha>2 ?x2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<phi> \\<alpha> x \\<le> 1\" if \"\\<alpha> \\<in> A\" \"x \\<in> carrier\" for \\<alpha> x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi> \\<alpha> x \\<le> 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<phi> \\<alpha> x \\<le> 1", "have \"\\<phi> \\<alpha> x \\<le> (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi> \\<alpha> x \\<le> (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)", "unfolding \\<phi>_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x)\n    \\<le> (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)", "by (rule sum_mono2[OF finite_W]) (auto simp: intro!: g_nonneg \\<open>x \\<in> carrier\\<close>)"], ["proof (state)\nthis:\n  \\<phi> \\<alpha> x \\<le> (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)\n\ngoal (1 subgoal):\n 1. \\<phi> \\<alpha> x \\<le> 1", "also"], ["proof (state)\nthis:\n  \\<phi> \\<alpha> x \\<le> (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)\n\ngoal (1 subgoal):\n 1. \\<phi> \\<alpha> x \\<le> 1", "have \"\\<dots> = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x) = 1", "by (rule sum_g) fact"], ["proof (state)\nthis:\n  (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x) = 1\n\ngoal (1 subgoal):\n 1. \\<phi> \\<alpha> x \\<le> 1", "finally"], ["proof (chain)\npicking this:\n  \\<phi> \\<alpha> x \\<le> 1", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<phi> \\<alpha> x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<phi> \\<alpha> x \\<le> 1", "."], ["proof (state)\nthis:\n  \\<phi> \\<alpha> x \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?\\<alpha>2 \\<in> A; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> \\<phi> ?\\<alpha>2 ?x2 \\<le> 1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>?\\<alpha>2 \\<in> A; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> \\<phi> ?\\<alpha>2 ?x2 \\<le> 1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"(\\<Sum>\\<alpha>\\<in>{\\<alpha>\\<in>A. \\<phi> \\<alpha> x \\<noteq> 0}. \\<phi> \\<alpha> x) = 1\" if \"x \\<in> carrier\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "have \"(\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0. \\<phi> \\<alpha> x) =\n      (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0. \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x)", "unfolding \\<phi>_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and>\n                      (\\<Sum>i | i \\<in> N \\<and>\n                                 a i = \\<alpha> \\<and> x \\<in> W i.\n                         g i x) \\<noteq>\n                      0.\n       \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n         g i x) =\n    (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and>\n                      (\\<Sum>i | i \\<in> N \\<and>\n                                 a i = \\<alpha> \\<and> x \\<in> W i.\n                         g i x) \\<noteq>\n                      0.\n       \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x)", ".."], ["proof (state)\nthis:\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<phi> \\<alpha> x) =\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "also"], ["proof (state)\nthis:\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<phi> \\<alpha> x) =\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "have \"\\<dots> = (\\<Sum>(\\<alpha>, i)\\<in>(SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}. {i \\<in> N. a i = xa \\<and> x \\<in> W i}). g i x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n         g i x) =\n    (\\<Sum>(\\<alpha>, i)\n           \\<in>(SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                    {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x)", "apply (rule sum.Sigma)"], ["proof (prove)\ngoal (2 subgoals):\n 1. finite {\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}\n 2. \\<forall>\\<alpha>\\<in>{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n       finite {i \\<in> N. a i = \\<alpha> \\<and> x \\<in> W i}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}", "apply (rule finite_subset[where B=\"a ` {j \\<in> N. x \\<in> W j}\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. {\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}\n    \\<subseteq> a ` {j \\<in> N. x \\<in> W j}\n 2. finite (a ` {j \\<in> N. x \\<in> W j})", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. {\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}\n    \\<subseteq> a ` {j \\<in> N. x \\<in> W j}", "apply (auto simp: \\<phi>_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>xa \\<in> A;\n        (\\<Sum>i | i \\<in> N \\<and> a i = xa \\<and> x \\<in> W i.\n           g i x) \\<noteq>\n        0\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> a ` {j \\<in> N. x \\<in> W j}", "apply (subst (asm) sum_nonneg_eq_0_iff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       xa \\<in> A \\<Longrightarrow>\n       finite {i \\<in> N. a i = xa \\<and> x \\<in> W i}\n 2. \\<And>xa xaa.\n       \\<lbrakk>xa \\<in> A;\n        xaa \\<in> {i \\<in> N. a i = xa \\<and> x \\<in> W i}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xaa x\n 3. \\<And>xa.\n       \\<lbrakk>xa \\<in> A;\n        \\<not> (\\<forall>xa\\<in>{i \\<in> N. a i = xa \\<and> x \\<in> W i}.\n                   g xa x = 0)\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> a ` {j \\<in> N. x \\<in> W j}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. xa_ \\<in> A \\<Longrightarrow>\n    finite {i \\<in> N. a i = xa_ \\<and> x \\<in> W i}", "using _ finite_W[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  finite {j \\<in> N. x \\<in> W j}\n\ngoal (1 subgoal):\n 1. xa_ \\<in> A \\<Longrightarrow>\n    finite {i \\<in> N. a i = xa_ \\<and> x \\<in> W i}", "by (rule finite_subset) auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa xaa.\n       \\<lbrakk>xa \\<in> A;\n        xaa \\<in> {i \\<in> N. a i = xa \\<and> x \\<in> W i}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xaa x\n 2. \\<And>xa.\n       \\<lbrakk>xa \\<in> A;\n        \\<not> (\\<forall>xa\\<in>{i \\<in> N. a i = xa \\<and> x \\<in> W i}.\n                   g xa x = 0)\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> a ` {j \\<in> N. x \\<in> W j}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>xa_ \\<in> A;\n     xaa_ \\<in> {i \\<in> N. a i = xa_ \\<and> x \\<in> W i}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> g xaa_ x", "by (rule g_nonneg[OF _ \\<open>x \\<in> carrier\\<close>]) auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>xa \\<in> A;\n        \\<not> (\\<forall>xa\\<in>{i \\<in> N. a i = xa \\<and> x \\<in> W i}.\n                   g xa x = 0)\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> a ` {j \\<in> N. x \\<in> W j}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>xa_ \\<in> A;\n     \\<not> (\\<forall>xa\\<in>{i \\<in> N. a i = xa_ \\<and> x \\<in> W i}.\n                g xa x = 0)\\<rbrakk>\n    \\<Longrightarrow> xa_ \\<in> a ` {j \\<in> N. x \\<in> W j}", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (a ` {j \\<in> N. x \\<in> W j})", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (a ` {j \\<in> N. x \\<in> W j})", "using finite_W[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  finite {j \\<in> N. x \\<in> W j}\n\ngoal (1 subgoal):\n 1. finite (a ` {j \\<in> N. x \\<in> W j})", "by (rule finite_imageI)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<alpha>\\<in>{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n       finite {i \\<in> N. a i = \\<alpha> \\<and> x \\<in> W i}", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<alpha>\\<in>{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n       finite {i \\<in> N. a i = \\<alpha> \\<and> x \\<in> W i}", "apply (auto)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>\\<alpha>.\n       \\<lbrakk>\\<alpha> \\<in> A; \\<phi> \\<alpha> x \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> finite\n                          {i \\<in> N. a i = \\<alpha> \\<and> x \\<in> W i}", "using _ finite_W[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  finite {j \\<in> N. x \\<in> W j}\n\ngoal (1 subgoal):\n 1. \\<And>\\<alpha>.\n       \\<lbrakk>\\<alpha> \\<in> A; \\<phi> \\<alpha> x \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> finite\n                          {i \\<in> N. a i = \\<alpha> \\<and> x \\<in> W i}", "by (rule finite_subset) auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x) =\n  (\\<Sum>(\\<alpha>, i)\n         \\<in>(SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                  {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "also"], ["proof (state)\nthis:\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i. g i x) =\n  (\\<Sum>(\\<alpha>, i)\n         \\<in>(SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                  {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "have \"\\<dots> = (\\<Sum>i\\<in>snd ` (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}. {i \\<in> N. a i = xa \\<and> x \\<in> W i}). g i x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>(\\<alpha>, i)\n           \\<in>(SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                    {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x) =\n    (\\<Sum>i\\<in>snd `\n                 (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                     {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x)", "apply (rule sum.reindex_cong[where l=\"\\<lambda>i. (a i, i)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. inj_on (\\<lambda>i. (a i, i))\n     (snd `\n      (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n          {i \\<in> N. a i = xa \\<and> x \\<in> W i}))\n 2. (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i}) =\n    (\\<lambda>i. (a i, i)) `\n    snd `\n    (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i})\n 3. \\<And>xa.\n       xa \\<in> snd `\n                (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                    {i \\<in> N.\n                     a i = xa \\<and> x \\<in> W i}) \\<Longrightarrow>\n       (case (a xa, xa) of (\\<alpha>, i) \\<Rightarrow> g i x) = g xa x", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. inj_on (\\<lambda>i. (a i, i))\n     (snd `\n      (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n          {i \\<in> N. a i = xa \\<and> x \\<in> W i}))", "by (auto simp: inj_on_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i}) =\n    (\\<lambda>i. (a i, i)) `\n    snd `\n    (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i})\n 2. \\<And>xa.\n       xa \\<in> snd `\n                (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                    {i \\<in> N.\n                     a i = xa \\<and> x \\<in> W i}) \\<Longrightarrow>\n       (case (a xa, xa) of (\\<alpha>, i) \\<Rightarrow> g i x) = g xa x", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i}) =\n    (\\<lambda>i. (a i, i)) `\n    snd `\n    (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "apply (auto simp: a)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>\\<phi> (a b) x \\<noteq> 0; b \\<in> N; x \\<in> W b\\<rbrakk>\n       \\<Longrightarrow> (a b, b)\n                         \\<in> (\\<lambda>x. (a x, x)) `\n                               snd `\n                               (SIGMA xa:{\\<alpha> \\<in> A.\n    \\<phi> \\<alpha> x \\<noteq> 0}.\n                                   {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "apply (auto simp: \\<phi>_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>(\\<Sum>i | i \\<in> N \\<and> a i = a b \\<and> x \\<in> W i.\n                   g i x) \\<noteq>\n                0;\n        b \\<in> N; x \\<in> W b\\<rbrakk>\n       \\<Longrightarrow> (a b, b)\n                         \\<in> (\\<lambda>x. (a x, x)) `\n                               snd `\n                               (SIGMA xa:{\\<alpha> \\<in> A.\n    (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n       g i x) \\<noteq>\n    0}.\n                                   {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "apply (subst (asm) sum_nonneg_eq_0_iff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>b \\<in> N; x \\<in> W b\\<rbrakk>\n       \\<Longrightarrow> finite {i \\<in> N. a i = a b \\<and> x \\<in> W i}\n 2. \\<And>b xa.\n       \\<lbrakk>b \\<in> N; x \\<in> W b;\n        xa \\<in> {i \\<in> N. a i = a b \\<and> x \\<in> W i}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xa x\n 3. \\<And>b.\n       \\<lbrakk>\\<not> (\\<forall>xa\\<in>{i \\<in> N.\n   a i = a b \\<and> x \\<in> W i}.\n                           g xa x = 0);\n        b \\<in> N; x \\<in> W b\\<rbrakk>\n       \\<Longrightarrow> (a b, b)\n                         \\<in> (\\<lambda>x. (a x, x)) `\n                               snd `\n                               (SIGMA xa:{\\<alpha> \\<in> A.\n    (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n       g i x) \\<noteq>\n    0}.\n                                   {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ \\<in> N; x \\<in> W b_\\<rbrakk>\n    \\<Longrightarrow> finite {i \\<in> N. a i = a b_ \\<and> x \\<in> W i}", "using _ finite_W[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  finite {j \\<in> N. x \\<in> W j}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ \\<in> N; x \\<in> W b_\\<rbrakk>\n    \\<Longrightarrow> finite {i \\<in> N. a i = a b_ \\<and> x \\<in> W i}", "by (rule finite_subset) auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b xa.\n       \\<lbrakk>b \\<in> N; x \\<in> W b;\n        xa \\<in> {i \\<in> N. a i = a b \\<and> x \\<in> W i}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xa x\n 2. \\<And>b.\n       \\<lbrakk>\\<not> (\\<forall>xa\\<in>{i \\<in> N.\n   a i = a b \\<and> x \\<in> W i}.\n                           g xa x = 0);\n        b \\<in> N; x \\<in> W b\\<rbrakk>\n       \\<Longrightarrow> (a b, b)\n                         \\<in> (\\<lambda>x. (a x, x)) `\n                               snd `\n                               (SIGMA xa:{\\<alpha> \\<in> A.\n    (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n       g i x) \\<noteq>\n    0}.\n                                   {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ \\<in> N; x \\<in> W b_;\n     xa_ \\<in> {i \\<in> N. a i = a b_ \\<and> x \\<in> W i}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> g xa_ x", "by (auto intro!: g_nonneg \\<open>x \\<in> carrier\\<close>)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>\\<not> (\\<forall>xa\\<in>{i \\<in> N.\n   a i = a b \\<and> x \\<in> W i}.\n                           g xa x = 0);\n        b \\<in> N; x \\<in> W b\\<rbrakk>\n       \\<Longrightarrow> (a b, b)\n                         \\<in> (\\<lambda>x. (a x, x)) `\n                               snd `\n                               (SIGMA xa:{\\<alpha> \\<in> A.\n    (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n       g i x) \\<noteq>\n    0}.\n                                   {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "subgoal for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> (\\<forall>xa\\<in>{ia \\<in> N.\na ia = a i \\<and> x \\<in> W ia}.\n                        g xa x = 0);\n     i \\<in> N; x \\<in> W i\\<rbrakk>\n    \\<Longrightarrow> (a i, i)\n                      \\<in> (\\<lambda>x. (a x, x)) `\n                            snd `\n                            (SIGMA xa:{\\<alpha> \\<in> A.\n (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n    g i x) \\<noteq>\n 0}.\n                                {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>i \\<in> N; x \\<in> W i; xa \\<in> N; a xa = a i;\n        x \\<in> W xa; g xa x \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> (a i, i)\n                         \\<in> (\\<lambda>x. (a x, x)) `\n                               snd `\n                               (SIGMA xa:{\\<alpha> \\<in> A.\n    (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n       g i x) \\<noteq>\n    0}.\n                                   {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "subgoal for yy"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> (a i, i)\n                      \\<in> (\\<lambda>x. (a x, x)) `\n                            snd `\n                            (SIGMA xa:{\\<alpha> \\<in> A.\n (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n    g i x) \\<noteq>\n 0}.\n                                {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "apply (rule imageI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> i \\<in> snd `\n                              (SIGMA xa:{\\<alpha> \\<in> A.\n   (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n      g i x) \\<noteq>\n   0}.\n                                  {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "apply (rule image_eqI[where x=\"(a i, i)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> i = snd (a i, i)\n 2. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> (a i, i)\n                      \\<in> (SIGMA xa:{\\<alpha> \\<in> A.\n (\\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n    g i x) \\<noteq>\n 0}.\n                                {i \\<in> N. a i = xa \\<and> x \\<in> W i})", "apply (auto intro!: a)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0;\n     (\\<Sum>i | i \\<in> N \\<and> a i = a i \\<and> x \\<in> W i. g i x) =\n     0\\<rbrakk>\n    \\<Longrightarrow> False", "apply (subst (asm) sum_nonneg_eq_0_iff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> finite {ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}\n 2. \\<And>xa.\n       \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i;\n        x \\<in> W yy; g yy x \\<noteq> 0;\n        xa \\<in> {ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xa x\n 3. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0;\n     \\<forall>xa\\<in>{ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}.\n        g xa x = 0\\<rbrakk>\n    \\<Longrightarrow> False", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> finite {ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}", "using _ finite_W[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  finite {j \\<in> N. x \\<in> W j}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> finite {ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}", "by (rule finite_subset) auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i;\n        x \\<in> W yy; g yy x \\<noteq> 0;\n        xa \\<in> {ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xa x\n 2. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0;\n     \\<forall>xa\\<in>{ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}.\n        g xa x = 0\\<rbrakk>\n    \\<Longrightarrow> False", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0;\n     xa_ \\<in> {ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> g xa_ x", "by (rule g_nonneg[OF _ \\<open>x \\<in> carrier\\<close>]) auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0;\n     \\<forall>xa\\<in>{ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}.\n        g xa x = 0\\<rbrakk>\n    \\<Longrightarrow> False", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<in> N; x \\<in> W i; yy \\<in> N; a yy = a i; x \\<in> W yy;\n     g yy x \\<noteq> 0;\n     \\<forall>xa\\<in>{ia \\<in> N. a ia = a i \\<and> x \\<in> W ia}.\n        g xa x = 0\\<rbrakk>\n    \\<Longrightarrow> False", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> snd `\n                (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                    {i \\<in> N.\n                     a i = xa \\<and> x \\<in> W i}) \\<Longrightarrow>\n       (case (a xa, xa) of (\\<alpha>, i) \\<Rightarrow> g i x) = g xa x", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. xa_\n    \\<in> snd `\n          (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n              {i \\<in> N. a i = xa \\<and> x \\<in> W i}) \\<Longrightarrow>\n    (case (a xa_, xa_) of (\\<alpha>, i) \\<Rightarrow> g i x) = g xa_ x", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<Sum>(\\<alpha>, i)\n         \\<in>(SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                  {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x) =\n  (\\<Sum>i\\<in>snd `\n               (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                   {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "also"], ["proof (state)\nthis:\n  (\\<Sum>(\\<alpha>, i)\n         \\<in>(SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                  {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x) =\n  (\\<Sum>i\\<in>snd `\n               (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                   {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "have \"\\<dots> = (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>snd `\n                 (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                     {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x) =\n    (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)", "apply (rule sum.mono_neutral_left)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {i \\<in> N. x \\<in> W i}\n 2. snd `\n    (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i})\n    \\<subseteq> {i \\<in> N. x \\<in> W i}\n 3. \\<forall>i\\<in>{i \\<in> N. x \\<in> W i} -\n                   snd `\n                   (SIGMA xa:{\\<alpha> \\<in> A.\n                              \\<phi> \\<alpha> x \\<noteq> 0}.\n                       {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {i \\<in> N. x \\<in> W i}", "by (rule finite_W) fact"], ["proof (prove)\ngoal (2 subgoals):\n 1. snd `\n    (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i})\n    \\<subseteq> {i \\<in> N. x \\<in> W i}\n 2. \\<forall>i\\<in>{i \\<in> N. x \\<in> W i} -\n                   snd `\n                   (SIGMA xa:{\\<alpha> \\<in> A.\n                              \\<phi> \\<alpha> x \\<noteq> 0}.\n                       {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. snd `\n    (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n        {i \\<in> N. a i = xa \\<and> x \\<in> W i})\n    \\<subseteq> {i \\<in> N. x \\<in> W i}", "by auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>{i \\<in> N. x \\<in> W i} -\n                   snd `\n                   (SIGMA xa:{\\<alpha> \\<in> A.\n                              \\<phi> \\<alpha> x \\<noteq> 0}.\n                       {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>{i \\<in> N. x \\<in> W i} -\n                   snd `\n                   (SIGMA xa:{\\<alpha> \\<in> A.\n                              \\<phi> \\<alpha> x \\<noteq> 0}.\n                       {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n       g i x = 0", "apply (auto simp: Sigma_def image_iff a)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>\\<phi> (a i) x = 0; i \\<in> N; x \\<in> W i\\<rbrakk>\n       \\<Longrightarrow> g i x = 0", "apply (auto simp: \\<phi>_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>(\\<Sum>i | i \\<in> N \\<and> a i = a i \\<and> x \\<in> W i.\n                   g i x) =\n                0;\n        i \\<in> N; x \\<in> W i\\<rbrakk>\n       \\<Longrightarrow> g i x = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(\\<Sum>i | i \\<in> N \\<and> a i = a i_ \\<and> x \\<in> W i.\n                g i x) =\n             0;\n     i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> g i_ x = 0", "apply (subst (asm) sum_nonneg_eq_0_iff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> finite {ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}\n 2. \\<And>xa.\n       \\<lbrakk>i_ \\<in> N; x \\<in> W i_;\n        xa \\<in> {ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xa x\n 3. \\<lbrakk>\\<forall>xa\\<in>{ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}.\n                g xa x = 0;\n     i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> g i_ x = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> finite {ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}", "using _ finite_W[OF \\<open>x \\<in> carrier\\<close>]"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  finite {j \\<in> N. x \\<in> W j}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> finite {ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}", "by (rule finite_subset) auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>i_ \\<in> N; x \\<in> W i_;\n        xa \\<in> {ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xa x\n 2. \\<lbrakk>\\<forall>xa\\<in>{ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}.\n                g xa x = 0;\n     i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> g i_ x = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i_ \\<in> N; x \\<in> W i_;\n     xa_ \\<in> {ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> g xa_ x", "by (rule g_nonneg[OF _ \\<open>x \\<in> carrier\\<close>]) auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>xa\\<in>{ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}.\n                g xa x = 0;\n     i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> g i_ x = 0", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>xa\\<in>{ia \\<in> N. a ia = a i_ \\<and> x \\<in> W ia}.\n                g xa x = 0;\n     i_ \\<in> N; x \\<in> W i_\\<rbrakk>\n    \\<Longrightarrow> g i_ x = 0", "by auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>snd `\n               (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                   {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x) =\n  (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>snd `\n               (SIGMA xa:{\\<alpha> \\<in> A. \\<phi> \\<alpha> x \\<noteq> 0}.\n                   {i \\<in> N. a i = xa \\<and> x \\<in> W i}).\n     g i x) =\n  (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "have \"\\<dots> = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x) = 1", "by (rule sum_g) fact"], ["proof (state)\nthis:\n  (\\<Sum>i | i \\<in> N \\<and> x \\<in> W i. g i x) = 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<phi> \\<alpha> x) =\n  1", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<phi> \\<alpha> x) =\n  1\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n       \\<phi> \\<alpha> x) =\n    1", "."], ["proof (state)\nthis:\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> x \\<noteq> 0.\n     \\<phi> \\<alpha> x) =\n  1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> ?x2 \\<noteq> 0.\n     \\<phi> \\<alpha> ?x2) =\n  1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> ?x2 \\<noteq> 0.\n     \\<phi> \\<alpha> ?x2) =\n  1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have g_supp_le_V: \"support_on carrier (g i) \\<subseteq> V i\" if \"i \\<in> N\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. support_on carrier (g i) \\<subseteq> V i", "apply (auto simp: support_on_def g_def f_def V_def dest!: H_neq_zeroD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> W i; x \\<in> carrier;\n        (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}.\n           H (apply_chart (\\<psi> i) x)) \\<noteq>\n        0;\n        norm (apply_chart (\\<psi> i) x) < 2\\<rbrakk>\n       \\<Longrightarrow> x \\<in> inv_chart (\\<psi> i) ` ball (0::'b) 2", "apply (rule image_eqI[OF ])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> W i; x \\<in> carrier;\n        (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}.\n           H (apply_chart (\\<psi> i) x)) \\<noteq>\n        0;\n        norm (apply_chart (\\<psi> i) x) < 2\\<rbrakk>\n       \\<Longrightarrow> x = inv_chart (\\<psi> i) (?x21 x)\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> W i; x \\<in> carrier;\n        (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}.\n           H (apply_chart (\\<psi> i) x)) \\<noteq>\n        0;\n        norm (apply_chart (\\<psi> i) x) < 2\\<rbrakk>\n       \\<Longrightarrow> ?x21 x \\<in> ball (0::'b) 2", "apply (rule inv_chart_inverse[symmetric])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> W i; x \\<in> carrier;\n        (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}.\n           H (apply_chart (\\<psi> i) x)) \\<noteq>\n        0;\n        norm (apply_chart (\\<psi> i) x) < 2\\<rbrakk>\n       \\<Longrightarrow> x \\<in> domain (\\<psi> i)\n 2. \\<And>x.\n       \\<lbrakk>x \\<in> W i; x \\<in> carrier;\n        (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}.\n           H (apply_chart (\\<psi> i) x)) \\<noteq>\n        0;\n        norm (apply_chart (\\<psi> i) x) < 2\\<rbrakk>\n       \\<Longrightarrow> apply_chart (\\<psi> i) x \\<in> ball (0::'b) 2", "apply (simp add: W_eq that)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> W i; x \\<in> carrier;\n        (\\<Sum>i\\<in>{j \\<in> N. x \\<in> W j}.\n           H (apply_chart (\\<psi> i) x)) \\<noteq>\n        0;\n        norm (apply_chart (\\<psi> i) x) < 2\\<rbrakk>\n       \\<Longrightarrow> apply_chart (\\<psi> i) x \\<in> ball (0::'b) 2", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow> support_on carrier (g ?i2) \\<subseteq> V ?i2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  ?i2 \\<in> N \\<Longrightarrow> support_on carrier (g ?i2) \\<subseteq> V ?i2", "have clsupp_g_le_W: \"closure (support_on carrier (g i)) \\<subseteq> W i\" if \"i \\<in> N\" for i"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> support_on carrier (g ?i2) \\<subseteq> V ?i2\n\ngoal (1 subgoal):\n 1. closure (support_on carrier (g i)) \\<subseteq> W i", "unfolding csupport_on_def"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> support_on carrier (g ?i2) \\<subseteq> V ?i2\n\ngoal (1 subgoal):\n 1. closure (support_on carrier (g i)) \\<subseteq> W i", "using V_subset_W closure_mono that"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> support_on carrier (g ?i2) \\<subseteq> V ?i2\n  ?i2 \\<in> N \\<Longrightarrow> closure (V ?i2) \\<subseteq> W ?i2\n  ?S \\<subseteq> ?T \\<Longrightarrow> closure ?S \\<subseteq> closure ?T\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. closure (support_on carrier (g i)) \\<subseteq> W i", "by blast"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow>\n  closure (support_on carrier (g ?i2)) \\<subseteq> W ?i2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  ?i2 \\<in> N \\<Longrightarrow>\n  closure (support_on carrier (g ?i2)) \\<subseteq> W ?i2", "have csupp_g_le_W: \"csupport_on carrier (g i) \\<subseteq> W i\" if \"i \\<in> N\" for i"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow>\n  closure (support_on carrier (g ?i2)) \\<subseteq> W ?i2\n\ngoal (1 subgoal):\n 1. csupport_on carrier (g i) \\<subseteq> W i", "using that"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow>\n  closure (support_on carrier (g ?i2)) \\<subseteq> W ?i2\n  i \\<in> N\n\ngoal (1 subgoal):\n 1. csupport_on carrier (g i) \\<subseteq> W i", "by (auto simp: csupport_on_def)"], ["proof (state)\nthis:\n  ?i2 \\<in> N \\<Longrightarrow>\n  csupport_on carrier (g ?i2) \\<subseteq> W ?i2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have *: \"{i \\<in> N. domain (\\<psi> i) \\<inter> Na \\<noteq> {}} = {i \\<in> N. W i \\<inter> Na \\<noteq> {}}\" for Na"], ["proof (prove)\ngoal (1 subgoal):\n 1. {i \\<in> N. domain (\\<psi> i) \\<inter> Na \\<noteq> {}} =\n    {i \\<in> N. W i \\<inter> Na \\<noteq> {}}", "by (auto simp: W_eq)"], ["proof (state)\nthis:\n  {i \\<in> N. domain (\\<psi> i) \\<inter> ?Na2 \\<noteq> {}} =\n  {i \\<in> N. W i \\<inter> ?Na2 \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  {i \\<in> N. domain (\\<psi> i) \\<inter> ?Na2 \\<noteq> {}} =\n  {i \\<in> N. W i \\<inter> ?Na2 \\<noteq> {}}", "have lfW: \"locally_finite_on carrier N W\""], ["proof (prove)\nusing this:\n  {i \\<in> N. domain (\\<psi> i) \\<inter> ?Na2 \\<noteq> {}} =\n  {i \\<in> N. W i \\<inter> ?Na2 \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. locally_finite_on carrier N W", "using regular_cover(3)"], ["proof (prove)\nusing this:\n  {i \\<in> N. domain (\\<psi> i) \\<inter> ?Na2 \\<noteq> {}} =\n  {i \\<in> N. W i \\<inter> ?Na2 \\<noteq> {}}\n  locally_finite_on carrier N (domain \\<circ> \\<psi>)\n\ngoal (1 subgoal):\n 1. locally_finite_on carrier N W", "by (simp add: locally_finite_on_def)"], ["proof (state)\nthis:\n  locally_finite_on carrier N W\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  locally_finite_on carrier N W", "have lf_supp_g: \"locally_finite_on carrier {i \\<in> N. a i = \\<alpha>} (\\<lambda>i. support_on carrier (g i))\" if \"\\<alpha> \\<in> A\" for \\<alpha>"], ["proof (prove)\nusing this:\n  locally_finite_on carrier N W\n\ngoal (1 subgoal):\n 1. locally_finite_on carrier {i \\<in> N. a i = \\<alpha>}\n     (\\<lambda>i. support_on carrier (g i))", "apply (rule locally_finite_on_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       i \\<in> {i \\<in> N. a i = \\<alpha>} \\<Longrightarrow>\n       support_on carrier (g i) \\<subseteq> W i\n 2. {i \\<in> N. a i = \\<alpha>} \\<subseteq> N", "using g_supp_le_V V_subset_W"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> support_on carrier (g ?i2) \\<subseteq> V ?i2\n  ?i2 \\<in> N \\<Longrightarrow> closure (V ?i2) \\<subseteq> W ?i2\n\ngoal (2 subgoals):\n 1. \\<And>i.\n       i \\<in> {i \\<in> N. a i = \\<alpha>} \\<Longrightarrow>\n       support_on carrier (g i) \\<subseteq> W i\n 2. {i \\<in> N. a i = \\<alpha>} \\<subseteq> N", "by force+"], ["proof (state)\nthis:\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow>\n  locally_finite_on carrier {i \\<in> N. a i = ?\\<alpha>2}\n   (\\<lambda>i. support_on carrier (g i))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier \\<subseteq> X \\<alpha>\" if \"\\<alpha> \\<in> A\" for \\<alpha>"], ["proof (prove)\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "have *: \"closure (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}. support_on carrier (g i)) \\<subseteq> closure (\\<Union>i\\<in>N. V i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure\n     (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}. support_on carrier (g i))\n    \\<subseteq> closure (\\<Union> (V ` N))", "by (rule closure_mono) (use g_supp_le_V in auto)"], ["proof (state)\nthis:\n  closure\n   (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}. support_on carrier (g i))\n  \\<subseteq> closure (\\<Union> (V ` N))\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "have \"support_on carrier (\\<phi> \\<alpha>) \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}. support_on carrier (g i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. support_on carrier (\\<phi> \\<alpha>)\n    \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                    support_on carrier (g i))", "unfolding \\<phi>_def[abs_def]"], ["proof (prove)\ngoal (1 subgoal):\n 1. support_on carrier\n     (\\<lambda>x.\n         \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n           g i x)\n    \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                    support_on carrier (g i))", "apply (rule order_trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. support_on carrier\n     (\\<lambda>x.\n         \\<Sum>i | i \\<in> N \\<and> a i = \\<alpha> \\<and> x \\<in> W i.\n           g i x)\n    \\<subseteq> ?y1\n 2. ?y1\n    \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                    support_on carrier (g i))", "apply (rule support_on_nonneg_sum_subset')"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>x\\<in>carrier.\n        \\<Union>i\\<in>{i \\<in> N. a i = \\<alpha> \\<and> x \\<in> W i}.\n           support_on carrier (g i))\n    \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                    support_on carrier (g i))", "using g_supp_le_V"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> support_on carrier (g ?i2) \\<subseteq> V ?i2\n\ngoal (1 subgoal):\n 1. (\\<Union>x\\<in>carrier.\n        \\<Union>i\\<in>{i \\<in> N. a i = \\<alpha> \\<and> x \\<in> W i}.\n           support_on carrier (g i))\n    \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                    support_on carrier (g i))", "by (auto simp: carrier_V)"], ["proof (state)\nthis:\n  support_on carrier (\\<phi> \\<alpha>)\n  \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                  support_on carrier (g i))\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "then"], ["proof (chain)\npicking this:\n  support_on carrier (\\<phi> \\<alpha>)\n  \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                  support_on carrier (g i))", "have \"csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier \\<subseteq> closure \\<dots> \\<inter> carrier\""], ["proof (prove)\nusing this:\n  support_on carrier (\\<phi> \\<alpha>)\n  \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                  support_on carrier (g i))\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> closure\n                 (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                     support_on carrier (g i)) \\<inter>\n                carrier", "unfolding csupport_on_def"], ["proof (prove)\nusing this:\n  support_on carrier (\\<phi> \\<alpha>)\n  \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                  support_on carrier (g i))\n\ngoal (1 subgoal):\n 1. closure (support_on carrier (\\<phi> \\<alpha>)) \\<inter> carrier\n    \\<subseteq> closure\n                 (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                     support_on carrier (g i)) \\<inter>\n                carrier", "using closure_mono"], ["proof (prove)\nusing this:\n  support_on carrier (\\<phi> \\<alpha>)\n  \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                  support_on carrier (g i))\n  ?S \\<subseteq> ?T \\<Longrightarrow> closure ?S \\<subseteq> closure ?T\n\ngoal (1 subgoal):\n 1. closure (support_on carrier (\\<phi> \\<alpha>)) \\<inter> carrier\n    \\<subseteq> closure\n                 (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                     support_on carrier (g i)) \\<inter>\n                carrier", "by auto"], ["proof (state)\nthis:\n  csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n  \\<subseteq> closure\n               (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                   support_on carrier (g i)) \\<inter>\n              carrier\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "also"], ["proof (state)\nthis:\n  csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n  \\<subseteq> closure\n               (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n                   support_on carrier (g i)) \\<inter>\n              carrier\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "have \"\\<dots> = (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}. closure (support_on carrier (g i)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closure\n     (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n         support_on carrier (g i)) \\<inter>\n    carrier =\n    (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n        closure (support_on carrier (g i)))", "apply (rule locally_finite_on_closure_Union[OF lf_supp_g[OF that], symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> {i \\<in> N. a i = \\<alpha>} \\<Longrightarrow>\n       closure (support_on carrier (g i)) \\<subseteq> carrier", "using closure_mono[OF g_supp_le_V] V_subset_W"], ["proof (prove)\nusing this:\n  ?i3 \\<in> N \\<Longrightarrow>\n  closure (support_on carrier (g ?i3)) \\<subseteq> closure (V ?i3)\n  ?i2 \\<in> N \\<Longrightarrow> closure (V ?i2) \\<subseteq> W ?i2\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> {i \\<in> N. a i = \\<alpha>} \\<Longrightarrow>\n       closure (support_on carrier (g i)) \\<subseteq> carrier", "by (force simp: carrier_W)"], ["proof (state)\nthis:\n  closure\n   (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n       support_on carrier (g i)) \\<inter>\n  carrier =\n  (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n      closure (support_on carrier (g i)))\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "also"], ["proof (state)\nthis:\n  closure\n   (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n       support_on carrier (g i)) \\<inter>\n  carrier =\n  (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n      closure (support_on carrier (g i)))\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "have \"\\<dots> \\<subseteq> (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}. W i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n        closure (support_on carrier (g i)))\n    \\<subseteq> \\<Union> (W ` {i \\<in> N. a i = \\<alpha>})", "apply (rule UN_mono)"], ["proof (prove)\ngoal (2 subgoals):\n 1. {i \\<in> N. a i = \\<alpha>} \\<subseteq> {i \\<in> N. a i = \\<alpha>}\n 2. \\<And>i.\n       i \\<in> {i \\<in> N. a i = \\<alpha>} \\<Longrightarrow>\n       closure (support_on carrier (g i)) \\<subseteq> W i", "using clsupp_g_le_W"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow>\n  closure (support_on carrier (g ?i2)) \\<subseteq> W ?i2\n\ngoal (2 subgoals):\n 1. {i \\<in> N. a i = \\<alpha>} \\<subseteq> {i \\<in> N. a i = \\<alpha>}\n 2. \\<And>i.\n       i \\<in> {i \\<in> N. a i = \\<alpha>} \\<Longrightarrow>\n       closure (support_on carrier (g i)) \\<subseteq> W i", "by auto"], ["proof (state)\nthis:\n  (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n      closure (support_on carrier (g i)))\n  \\<subseteq> \\<Union> (W ` {i \\<in> N. a i = \\<alpha>})\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "also"], ["proof (state)\nthis:\n  (\\<Union>i\\<in>{i \\<in> N. a i = \\<alpha>}.\n      closure (support_on carrier (g i)))\n  \\<subseteq> \\<Union> (W ` {i \\<in> N. a i = \\<alpha>})\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "have \"\\<dots> \\<subseteq> X \\<alpha>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (W ` {i \\<in> N. a i = \\<alpha>}) \\<subseteq> X \\<alpha>", "using a"], ["proof (prove)\nusing this:\n  ?i2 \\<in> N \\<Longrightarrow> W ?i2 \\<subseteq> X (a ?i2)\n  ?i2 \\<in> N \\<Longrightarrow> a ?i2 \\<in> A\n\ngoal (1 subgoal):\n 1. \\<Union> (W ` {i \\<in> N. a i = \\<alpha>}) \\<subseteq> X \\<alpha>", "by auto"], ["proof (state)\nthis:\n  \\<Union> (W ` {i \\<in> N. a i = \\<alpha>}) \\<subseteq> X \\<alpha>\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "finally"], ["proof (chain)\npicking this:\n  csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n  \\<subseteq> X \\<alpha>", "show ?thesis"], ["proof (prove)\nusing this:\n  csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n  \\<subseteq> X \\<alpha>\n\ngoal (1 subgoal):\n 1. csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n    \\<subseteq> X \\<alpha>", "."], ["proof (state)\nthis:\n  csupport_on carrier (\\<phi> \\<alpha>) \\<inter> carrier\n  \\<subseteq> X \\<alpha>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow>\n  csupport_on carrier (\\<phi> ?\\<alpha>2) \\<inter> carrier\n  \\<subseteq> X ?\\<alpha>2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow>\n  csupport_on carrier (\\<phi> ?\\<alpha>2) \\<inter> carrier\n  \\<subseteq> X ?\\<alpha>2\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"locally_finite_on carrier A (\\<lambda>i. support_on carrier (\\<phi> i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. locally_finite_on carrier A (\\<lambda>i. support_on carrier (\\<phi> i))", "proof (rule locally_finite_onI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>N.\n          p \\<in> N \\<and>\n          open N \\<and>\n          finite\n           {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> N \\<noteq> {}}", "fix p"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>N.\n          p \\<in> N \\<and>\n          open N \\<and>\n          finite\n           {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> N \\<noteq> {}}", "assume \"p \\<in> carrier\""], ["proof (state)\nthis:\n  p \\<in> carrier\n\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>N.\n          p \\<in> N \\<and>\n          open N \\<and>\n          finite\n           {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> N \\<noteq> {}}", "from locally_finite_onE[OF lfW this]"], ["proof (chain)\npicking this:\n  (\\<And>Na.\n      \\<lbrakk>p \\<in> Na; open Na;\n       finite {i \\<in> N. W i \\<inter> Na \\<noteq> {}}\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain Nhd where Nhd: \"p \\<in> Nhd\" \"open Nhd\" \"finite {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}}\""], ["proof (prove)\nusing this:\n  (\\<And>Na.\n      \\<lbrakk>p \\<in> Na; open Na;\n       finite {i \\<in> N. W i \\<inter> Na \\<noteq> {}}\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>Nhd.\n        \\<lbrakk>p \\<in> Nhd; open Nhd;\n         finite {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "."], ["proof (state)\nthis:\n  p \\<in> Nhd\n  open Nhd\n  finite {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}}\n\ngoal (1 subgoal):\n 1. \\<And>p.\n       p \\<in> carrier \\<Longrightarrow>\n       \\<exists>N.\n          p \\<in> N \\<and>\n          open N \\<and>\n          finite\n           {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> N \\<noteq> {}}", "show \"\\<exists>Nhd. p \\<in> Nhd \\<and> open Nhd \\<and> finite {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> Nhd \\<noteq> {}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>Nhd.\n       p \\<in> Nhd \\<and>\n       open Nhd \\<and>\n       finite\n        {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> Nhd \\<noteq> {}}", "apply (rule exI[where x=Nhd])"], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> Nhd \\<and>\n    open Nhd \\<and>\n    finite\n     {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> Nhd \\<noteq> {}}", "apply (auto simp: Nhd)"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite\n     {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> Nhd \\<noteq> {}}", "apply (rule finite_subset[where B=\"a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}}\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> Nhd \\<noteq> {}}\n    \\<subseteq> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}}\n 2. finite (a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}})", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> Nhd \\<noteq> {}}\n    \\<subseteq> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}}", "apply (auto simp: support_on_def \\<phi>_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> A;\n        x \\<notin> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}};\n        xa \\<in> Nhd; xa \\<in> carrier;\n        (\\<Sum>i | i \\<in> N \\<and> a i = x \\<and> xa \\<in> W i.\n           g i xa) \\<noteq>\n        0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subst (asm) sum_nonneg_eq_0_iff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> A;\n        x \\<notin> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}};\n        xa \\<in> Nhd; xa \\<in> carrier\\<rbrakk>\n       \\<Longrightarrow> finite {i \\<in> N. a i = x \\<and> xa \\<in> W i}\n 2. \\<And>x xa xb.\n       \\<lbrakk>x \\<in> A;\n        x \\<notin> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}};\n        xa \\<in> Nhd; xa \\<in> carrier;\n        xb \\<in> {i \\<in> N. a i = x \\<and> xa \\<in> W i}\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> g xb xa\n 3. \\<And>x xa.\n       \\<lbrakk>x \\<in> A;\n        x \\<notin> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}};\n        xa \\<in> Nhd; xa \\<in> carrier;\n        \\<not> (\\<forall>x\\<in>{i \\<in> N. a i = x \\<and> xa \\<in> W i}.\n                   g x xa = 0)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (auto simp: intro!: g_nonneg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> A;\n        x \\<notin> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}};\n        xa \\<in> Nhd; xa \\<in> carrier\\<rbrakk>\n       \\<Longrightarrow> finite {i \\<in> N. a i = x \\<and> xa \\<in> W i}", "using _ finite_W"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  ?y2 \\<in> carrier \\<Longrightarrow> finite {j \\<in> N. ?y2 \\<in> W j}\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> A;\n        x \\<notin> a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}};\n        xa \\<in> Nhd; xa \\<in> carrier\\<rbrakk>\n       \\<Longrightarrow> finite {i \\<in> N. a i = x \\<and> xa \\<in> W i}", "by (rule finite_subset) auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (a ` {i \\<in> N. W i \\<inter> Nhd \\<noteq> {}})", "by (rule finite_imageI) fact"], ["proof (state)\nthis:\n  \\<exists>Nhd.\n     p \\<in> Nhd \\<and>\n     open Nhd \\<and>\n     finite\n      {i \\<in> A. support_on carrier (\\<phi> i) \\<inter> Nhd \\<noteq> {}}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  locally_finite_on carrier A (\\<lambda>i. support_on carrier (\\<phi> i))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  locally_finite_on carrier A (\\<lambda>i. support_on carrier (\\<phi> i))", "have \"locally_finite_on carrier A (\\<lambda>i. csupport_on carrier (\\<phi> i))\""], ["proof (prove)\nusing this:\n  locally_finite_on carrier A (\\<lambda>i. support_on carrier (\\<phi> i))\n\ngoal (1 subgoal):\n 1. locally_finite_on carrier A (\\<lambda>i. csupport_on carrier (\\<phi> i))", "unfolding csupport_on_def"], ["proof (prove)\nusing this:\n  locally_finite_on carrier A (\\<lambda>i. support_on carrier (\\<phi> i))\n\ngoal (1 subgoal):\n 1. locally_finite_on carrier A\n     (\\<lambda>i. closure (support_on carrier (\\<phi> i)))", "by (rule locally_finite_on_closure)"], ["proof (state)\nthis:\n  locally_finite_on carrier A (\\<lambda>i. csupport_on carrier (\\<phi> i))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> A \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> A; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> A \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> A \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> X i;\n         locally_finite_on carrier A\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow> diff_fun k charts (\\<phi> ?\\<alpha>2)\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> ?\\<alpha>2 ?x2\n  \\<lbrakk>?\\<alpha>2 \\<in> A; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> \\<phi> ?\\<alpha>2 ?x2 \\<le> 1\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> ?x2 \\<noteq> 0.\n     \\<phi> \\<alpha> ?x2) =\n  1\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow>\n  csupport_on carrier (\\<phi> ?\\<alpha>2) \\<inter> carrier\n  \\<subseteq> X ?\\<alpha>2\n  locally_finite_on carrier A (\\<lambda>i. csupport_on carrier (\\<phi> i))", "show ?thesis"], ["proof (prove)\nusing this:\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow> diff_fun k charts (\\<phi> ?\\<alpha>2)\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> ?\\<alpha>2 ?x2\n  \\<lbrakk>?\\<alpha>2 \\<in> A; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> \\<phi> ?\\<alpha>2 ?x2 \\<le> 1\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  (\\<Sum>\\<alpha> | \\<alpha> \\<in> A \\<and> \\<phi> \\<alpha> ?x2 \\<noteq> 0.\n     \\<phi> \\<alpha> ?x2) =\n  1\n  ?\\<alpha>2 \\<in> A \\<Longrightarrow>\n  csupport_on carrier (\\<phi> ?\\<alpha>2) \\<inter> carrier\n  \\<subseteq> X ?\\<alpha>2\n  locally_finite_on carrier A (\\<lambda>i. csupport_on carrier (\\<phi> i))\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Given \\<open>A \\<subseteq> U \\<subseteq> carrier\\<close>, where \\<open>A\\<close> is closed and \\<open>U\\<close> is open, there exists\n  a differentiable function \\<open>\\<psi>\\<close> such that \\<open>0 \\<le> \\<psi> \\<le> 1\\<close>, \\<open>\\<psi> = 1\\<close> on \\<open>A\\<close>, and the\n  support of \\<open>\\<psi>\\<close> is contained in \\<open>U\\<close>.\\<close>"], ["", "lemma smooth_bump_functionE:\n  assumes \"closedin (top_of_set carrier) A\"\n    and \"A \\<subseteq> U\" \"U \\<subseteq> carrier\" \"open U\"\n  obtains \\<psi>::\"'a \\<Rightarrow> real\" where\n    \"diff_fun k charts \\<psi>\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1\"\n    \"csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define V where \"V x = (if x = 0 then U else carrier - A)\" for x::nat"], ["proof (state)\nthis:\n  V ?x = (if ?x = 0 then U else carrier - A)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"open (carrier - A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (carrier - A)", "using assms"], ["proof (prove)\nusing this:\n  closedin (top_of_set carrier) A\n  A \\<subseteq> U\n  U \\<subseteq> carrier\n  open U\n\ngoal (1 subgoal):\n 1. open (carrier - A)", "by (metis closedin_def open_Int open_carrier openin_open topspace_euclidean_subtopology)"], ["proof (state)\nthis:\n  open (carrier - A)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  open (carrier - A)", "have V: \"carrier \\<subseteq> (\\<Union>i\\<in>{0, 1}. V i)\" \"i \\<in> {0, 1} \\<Longrightarrow> open (V i)\" for i"], ["proof (prove)\nusing this:\n  open (carrier - A)\n\ngoal (1 subgoal):\n 1. carrier \\<subseteq> \\<Union> (V ` {0, 1}) &&&\n    (i \\<in> {0, 1} \\<Longrightarrow> open (V i))", "using assms"], ["proof (prove)\nusing this:\n  open (carrier - A)\n  closedin (top_of_set carrier) A\n  A \\<subseteq> U\n  U \\<subseteq> carrier\n  open U\n\ngoal (1 subgoal):\n 1. carrier \\<subseteq> \\<Union> (V ` {0, 1}) &&&\n    (i \\<in> {0, 1} \\<Longrightarrow> open (V i))", "by (auto simp: V_def)"], ["proof (state)\nthis:\n  carrier \\<subseteq> \\<Union> (V ` {0, 1})\n  ?i2 \\<in> {0, 1} \\<Longrightarrow> open (V ?i2)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "obtain \\<phi>::\"nat \\<Rightarrow> 'a \\<Rightarrow> real\" where \\<phi>:\n    \"(\\<And>i. i \\<in> {0, 1} \\<Longrightarrow> diff_fun k charts (\\<phi> i))\"\n    \"(\\<And>i x. i \\<in> {0, 1} \\<Longrightarrow> x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> i x)\"\n    \"(\\<And>i x. i \\<in> {0, 1} \\<Longrightarrow> x \\<in> carrier \\<Longrightarrow> \\<phi> i x \\<le> 1)\"\n    \"(\\<And>x. x \\<in> carrier \\<Longrightarrow> (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) = 1)\"\n    \"(\\<And>i. i \\<in> {0, 1} \\<Longrightarrow> csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> V i)\"\n    \"locally_finite_on carrier {0, 1} (\\<lambda>i. csupport_on carrier (\\<phi> i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>\\<And>i.\n                    i \\<in> {0, 1} \\<Longrightarrow>\n                    diff_fun k charts (\\<phi> i);\n         \\<And>i x.\n            \\<lbrakk>i \\<in> {0, 1}; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> 0 \\<le> \\<phi> i x;\n         \\<And>i x.\n            \\<lbrakk>i \\<in> {0, 1}; x \\<in> carrier\\<rbrakk>\n            \\<Longrightarrow> \\<phi> i x \\<le> 1;\n         \\<And>x.\n            x \\<in> carrier \\<Longrightarrow>\n            (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0.\n               \\<phi> i x) =\n            1;\n         \\<And>i.\n            i \\<in> {0, 1} \\<Longrightarrow>\n            csupport_on carrier (\\<phi> i) \\<inter> carrier \\<subseteq> V i;\n         locally_finite_on carrier {0, 1}\n          (\\<lambda>i. csupport_on carrier (\\<phi> i))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (rule partitions_of_unityE[OF V]) auto"], ["proof (state)\nthis:\n  ?i2 \\<in> {0, 1} \\<Longrightarrow> diff_fun k charts (\\<phi> ?i2)\n  \\<lbrakk>?i2 \\<in> {0, 1}; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<phi> ?i2 ?x2\n  \\<lbrakk>?i2 \\<in> {0, 1}; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> \\<phi> ?i2 ?x2 \\<le> 1\n  ?x2 \\<in> carrier \\<Longrightarrow>\n  (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i ?x2 \\<noteq> 0. \\<phi> i ?x2) =\n  1\n  ?i2 \\<in> {0, 1} \\<Longrightarrow>\n  csupport_on carrier (\\<phi> ?i2) \\<inter> carrier \\<subseteq> V ?i2\n  locally_finite_on carrier {0, 1}\n   (\\<lambda>i. csupport_on carrier (\\<phi> i))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from this(1-3,5)[of 0] this(6)"], ["proof (chain)\npicking this:\n  0 \\<in> {0, 1} \\<Longrightarrow> diff_fun k charts (\\<phi> 0)\n  \\<lbrakk>0 \\<in> {0, 1}; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<phi> 0 ?x2\n  \\<lbrakk>0 \\<in> {0, 1}; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> \\<phi> 0 ?x2 \\<le> 1\n  0 \\<in> {0, 1} \\<Longrightarrow>\n  csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> V 0\n  locally_finite_on carrier {0, 1}\n   (\\<lambda>i. csupport_on carrier (\\<phi> i))", "have \"diff_fun k charts (\\<phi> 0)\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> 0 x\"\n    \"\\<And>x. x \\<in> carrier \\<Longrightarrow> \\<phi> 0 x \\<le> 1\"\n    \"csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> U\""], ["proof (prove)\nusing this:\n  0 \\<in> {0, 1} \\<Longrightarrow> diff_fun k charts (\\<phi> 0)\n  \\<lbrakk>0 \\<in> {0, 1}; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> 0 \\<le> \\<phi> 0 ?x2\n  \\<lbrakk>0 \\<in> {0, 1}; ?x2 \\<in> carrier\\<rbrakk>\n  \\<Longrightarrow> \\<phi> 0 ?x2 \\<le> 1\n  0 \\<in> {0, 1} \\<Longrightarrow>\n  csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> V 0\n  locally_finite_on carrier {0, 1}\n   (\\<lambda>i. csupport_on carrier (\\<phi> i))\n\ngoal (1 subgoal):\n 1. (diff_fun k charts (\\<phi> 0) &&&\n     (\\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> 0 x)) &&&\n    (\\<And>x. x \\<in> carrier \\<Longrightarrow> \\<phi> 0 x \\<le> 1) &&&\n    csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> U", "by (auto simp: V_def)"], ["proof (state)\nthis:\n  diff_fun k charts (\\<phi> 0)\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> 0 ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> \\<phi> 0 ?x2 \\<le> 1\n  csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> U\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  diff_fun k charts (\\<phi> 0)\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> 0 ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> \\<phi> 0 ?x2 \\<le> 1\n  csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> U\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<phi> 0 x = 1\" if \"x \\<in> A\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "from that"], ["proof (chain)\npicking this:\n  x \\<in> A", "have \"x \\<in> carrier\""], ["proof (prove)\nusing this:\n  x \\<in> A\n\ngoal (1 subgoal):\n 1. x \\<in> carrier", "using assms"], ["proof (prove)\nusing this:\n  x \\<in> A\n  closedin (top_of_set carrier) A\n  A \\<subseteq> U\n  U \\<subseteq> carrier\n  open U\n\ngoal (1 subgoal):\n 1. x \\<in> carrier", "by auto"], ["proof (state)\nthis:\n  x \\<in> carrier\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "from \\<phi>(4)[OF this]"], ["proof (chain)\npicking this:\n  (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) = 1", "have \"1 = (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x)\""], ["proof (prove)\nusing this:\n  (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x) = 1\n\ngoal (1 subgoal):\n 1. 1 = (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x)", "by auto"], ["proof (state)\nthis:\n  1 = (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x)\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "moreover"], ["proof (state)\nthis:\n  1 = (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x)\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "have \"{i. i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0} =\n      (if \\<phi> 0 x \\<noteq> 0 then {0} else {}) \\<union> (if \\<phi> 1 x \\<noteq> 0 then {1} else {})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {i \\<in> {0, 1}. \\<phi> i x \\<noteq> 0} =\n    (if \\<phi> 0 x \\<noteq> 0 then {0} else {}) \\<union>\n    (if \\<phi> 1 x \\<noteq> 0 then {1} else {})", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>\\<phi> 0 x = 0; \\<phi> (Suc 0) x = 0;\n        \\<phi> xa x \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> 0 < xa", "using neq0_conv"], ["proof (prove)\nusing this:\n  (?n \\<noteq> 0) = (0 < ?n)\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>\\<phi> 0 x = 0; \\<phi> (Suc 0) x = 0;\n        \\<phi> xa x \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> 0 < xa", "by blast"], ["proof (state)\nthis:\n  {i \\<in> {0, 1}. \\<phi> i x \\<noteq> 0} =\n  (if \\<phi> 0 x \\<noteq> 0 then {0} else {}) \\<union>\n  (if \\<phi> 1 x \\<noteq> 0 then {1} else {})\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "moreover"], ["proof (state)\nthis:\n  {i \\<in> {0, 1}. \\<phi> i x \\<noteq> 0} =\n  (if \\<phi> 0 x \\<noteq> 0 then {0} else {}) \\<union>\n  (if \\<phi> 1 x \\<noteq> 0 then {1} else {})\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "have \"x \\<notin> V 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<notin> V 1", "using that"], ["proof (prove)\nusing this:\n  x \\<in> A\n\ngoal (1 subgoal):\n 1. x \\<notin> V 1", "by (auto simp: V_def)"], ["proof (state)\nthis:\n  x \\<notin> V 1\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "then"], ["proof (chain)\npicking this:\n  x \\<notin> V 1", "have \"\\<phi> (Suc 0) x = 0\""], ["proof (prove)\nusing this:\n  x \\<notin> V 1\n\ngoal (1 subgoal):\n 1. \\<phi> (Suc 0) x = 0", "using \\<phi>(5)[of 1] assms that"], ["proof (prove)\nusing this:\n  x \\<notin> V 1\n  1 \\<in> {0, 1} \\<Longrightarrow>\n  csupport_on carrier (\\<phi> 1) \\<inter> carrier \\<subseteq> V 1\n  closedin (top_of_set carrier) A\n  A \\<subseteq> U\n  U \\<subseteq> carrier\n  open U\n  x \\<in> A\n\ngoal (1 subgoal):\n 1. \\<phi> (Suc 0) x = 0", "by (auto simp: support_on_def csupport_on_def)"], ["proof (state)\nthis:\n  \\<phi> (Suc 0) x = 0\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "ultimately"], ["proof (chain)\npicking this:\n  1 = (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x)\n  {i \\<in> {0, 1}. \\<phi> i x \\<noteq> 0} =\n  (if \\<phi> 0 x \\<noteq> 0 then {0} else {}) \\<union>\n  (if \\<phi> 1 x \\<noteq> 0 then {1} else {})\n  \\<phi> (Suc 0) x = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  1 = (\\<Sum>i | i \\<in> {0, 1} \\<and> \\<phi> i x \\<noteq> 0. \\<phi> i x)\n  {i \\<in> {0, 1}. \\<phi> i x \\<noteq> 0} =\n  (if \\<phi> 0 x \\<noteq> 0 then {0} else {}) \\<union>\n  (if \\<phi> 1 x \\<noteq> 0 then {1} else {})\n  \\<phi> (Suc 0) x = 0\n\ngoal (1 subgoal):\n 1. \\<phi> 0 x = 1", "by (auto split: if_splits)"], ["proof (state)\nthis:\n  \\<phi> 0 x = 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?x2 \\<in> A \\<Longrightarrow> \\<phi> 0 ?x2 = 1\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<lbrakk>diff_fun k charts \\<psi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n         csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  diff_fun k charts (\\<phi> 0)\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> 0 ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> \\<phi> 0 ?x2 \\<le> 1\n  csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> U\n  ?x2 \\<in> A \\<Longrightarrow> \\<phi> 0 ?x2 = 1", "show ?thesis"], ["proof (prove)\nusing this:\n  diff_fun k charts (\\<phi> 0)\n  ?x2 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> 0 ?x2\n  ?x2 \\<in> carrier \\<Longrightarrow> \\<phi> 0 ?x2 \\<le> 1\n  csupport_on carrier (\\<phi> 0) \\<inter> carrier \\<subseteq> U\n  ?x2 \\<in> A \\<Longrightarrow> \\<phi> 0 ?x2 = 1\n\ngoal (1 subgoal):\n 1. thesis", "by (blast intro: that)"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "definition \"diff_fun_on A f \\<longleftrightarrow>\n  (\\<exists>W. A \\<subseteq> W \\<and> W \\<subseteq> carrier \\<and> open W \\<and>\n    (\\<exists>f'. diff_fun k (charts_submanifold W) f' \\<and> (\\<forall>x\\<in>A. f x = f' x)))\""], ["", "lemma diff_fun_onE:\n  assumes \"diff_fun_on A f\"\n  obtains W f' where\n    \"A \\<subseteq> W\" \"W \\<subseteq> carrier\" \"open W\" \"diff_fun k (charts_submanifold W) f'\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>W f'.\n        \\<lbrakk>A \\<subseteq> W; W \\<subseteq> carrier; open W;\n         diff_fun k (charts_submanifold W) f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms"], ["proof (prove)\nusing this:\n  diff_fun_on A f\n\ngoal (1 subgoal):\n 1. (\\<And>W f'.\n        \\<lbrakk>A \\<subseteq> W; W \\<subseteq> carrier; open W;\n         diff_fun k (charts_submanifold W) f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: diff_fun_on_def)"], ["", "lemma diff_fun_onI:\n  assumes  \"A \\<subseteq> W\" \"W \\<subseteq> carrier\" \"open W\" \"diff_fun k (charts_submanifold W) f'\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\"\n  shows \"diff_fun_on A f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun_on A f", "using assms"], ["proof (prove)\nusing this:\n  A \\<subseteq> W\n  W \\<subseteq> carrier\n  open W\n  diff_fun k (charts_submanifold W) f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n\ngoal (1 subgoal):\n 1. diff_fun_on A f", "by (auto simp: diff_fun_on_def)"], ["", "text \\<open>Extension lemma:\n\n  Given \\<open>A \\<subseteq> U \\<subseteq> carrier\\<close>, where \\<open>A\\<close> is closed and \\<open>U\\<close> is open, and a differentiable\n  function \\<open>f\\<close> on \\<open>A\\<close>, there exists a differentiable function \\<open>f'\\<close> agreeing with \\<open>f\\<close>\n  on \\<open>A\\<close>, and where the support of \\<open>f'\\<close> is contained in \\<open>U\\<close>.\\<close>"], ["", "lemma extension_lemmaE:\n  fixes f::\"'a \\<Rightarrow> 'e::euclidean_space\"\n  assumes \"closedin (top_of_set carrier) A\"\n  assumes \"diff_fun_on A f\" \"A \\<subseteq> U\" \"U \\<subseteq> carrier\" \"open U\"\n  obtains f' where\n    \"diff_fun k charts f'\"\n    \"\\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x\"\n    \"csupport_on carrier f' \\<inter> carrier \\<subseteq> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from diff_fun_onE[OF assms(2)]"], ["proof (chain)\npicking this:\n  (\\<And>W f'.\n      \\<lbrakk>A \\<subseteq> W; W \\<subseteq> carrier; open W;\n       diff_fun k (charts_submanifold W) f';\n       \\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain W' f' where W': \"A \\<subseteq> W'\" \"W' \\<subseteq> carrier\" \"open W'\" \"diff_fun k (charts_submanifold W') f'\"\n    \"(\\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x)\""], ["proof (prove)\nusing this:\n  (\\<And>W f'.\n      \\<lbrakk>A \\<subseteq> W; W \\<subseteq> carrier; open W;\n       diff_fun k (charts_submanifold W) f';\n       \\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>W' f'.\n        \\<lbrakk>A \\<subseteq> W'; W' \\<subseteq> carrier; open W';\n         diff_fun k (charts_submanifold W') f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  A \\<subseteq> W'\n  W' \\<subseteq> carrier\n  open W'\n  diff_fun k (charts_submanifold W') f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define W where \"W = W' \\<inter> U\""], ["proof (state)\nthis:\n  W = W' \\<inter> U\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "interpret W': diff_fun k \"charts_submanifold W'\" f'"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold W') f'", "using W'"], ["proof (prove)\nusing this:\n  A \\<subseteq> W'\n  W' \\<subseteq> carrier\n  open W'\n  diff_fun k (charts_submanifold W') f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold W') f'", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have *: \"open (W' \\<inter> U)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (W' \\<inter> U)", "using W' assms"], ["proof (prove)\nusing this:\n  A \\<subseteq> W'\n  W' \\<subseteq> carrier\n  open W'\n  diff_fun k (charts_submanifold W') f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n  closedin (top_of_set carrier) A\n  diff_fun_on A f\n  A \\<subseteq> U\n  U \\<subseteq> carrier\n  open U\n\ngoal (1 subgoal):\n 1. open (W' \\<inter> U)", "by auto"], ["proof (state)\nthis:\n  open (W' \\<inter> U)\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "with W'.diff_fun_submanifold[of W]"], ["proof (chain)\npicking this:\n  open W \\<Longrightarrow> diff_fun k (W'.src.charts_submanifold W) f'\n  open (W' \\<inter> U)", "have \"diff_fun k (W'.src.charts_submanifold (W' \\<inter> U)) f'\""], ["proof (prove)\nusing this:\n  open W \\<Longrightarrow> diff_fun k (W'.src.charts_submanifold W) f'\n  open (W' \\<inter> U)\n\ngoal (1 subgoal):\n 1. diff_fun k (W'.src.charts_submanifold (W' \\<inter> U)) f'", "by (auto simp: W_def)"], ["proof (state)\nthis:\n  diff_fun k (W'.src.charts_submanifold (W' \\<inter> U)) f'\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  diff_fun k (W'.src.charts_submanifold (W' \\<inter> U)) f'\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"W'.src.charts_submanifold (W' \\<inter> U) = charts_submanifold (W' \\<inter> U)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W'.src.charts_submanifold (W' \\<inter> U) =\n    charts_submanifold (W' \\<inter> U)", "unfolding W'.src.charts_submanifold_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. restrict_chart (W' \\<inter> U) ` charts_submanifold W' =\n    charts_submanifold (W' \\<inter> U)", "unfolding charts_submanifold_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. restrict_chart (W' \\<inter> U) ` restrict_chart W' ` charts =\n    restrict_chart (W' \\<inter> U) ` charts", "using W' *"], ["proof (prove)\nusing this:\n  A \\<subseteq> W'\n  W' \\<subseteq> carrier\n  open W'\n  diff_fun k (charts_submanifold W') f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n  open (W' \\<inter> U)\n\ngoal (1 subgoal):\n 1. restrict_chart (W' \\<inter> U) ` restrict_chart W' ` charts =\n    restrict_chart (W' \\<inter> U) ` charts", "by (auto simp: image_image restrict_chart_restrict_chart ac_simps)"], ["proof (state)\nthis:\n  W'.src.charts_submanifold (W' \\<inter> U) =\n  charts_submanifold (W' \\<inter> U)\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "finally"], ["proof (chain)\npicking this:\n  diff_fun k (charts_submanifold (W' \\<inter> U)) f'", "have \"diff_fun k (charts_submanifold (W' \\<inter> U)) f'\""], ["proof (prove)\nusing this:\n  diff_fun k (charts_submanifold (W' \\<inter> U)) f'\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (W' \\<inter> U)) f'", "."], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (W' \\<inter> U)) f'\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "with W' assms"], ["proof (chain)\npicking this:\n  A \\<subseteq> W'\n  W' \\<subseteq> carrier\n  open W'\n  diff_fun k (charts_submanifold W') f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n  closedin (top_of_set carrier) A\n  diff_fun_on A f\n  A \\<subseteq> U\n  U \\<subseteq> carrier\n  open U\n  diff_fun k (charts_submanifold (W' \\<inter> U)) f'", "have W: \"A \\<subseteq> W\" \"W \\<subseteq> carrier\" \"open W\" \"diff_fun k (charts_submanifold W) f'\"\n    \"(\\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x)\""], ["proof (prove)\nusing this:\n  A \\<subseteq> W'\n  W' \\<subseteq> carrier\n  open W'\n  diff_fun k (charts_submanifold W') f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n  closedin (top_of_set carrier) A\n  diff_fun_on A f\n  A \\<subseteq> U\n  U \\<subseteq> carrier\n  open U\n  diff_fun k (charts_submanifold (W' \\<inter> U)) f'\n\ngoal (1 subgoal):\n 1. (A \\<subseteq> W &&& W \\<subseteq> carrier) &&&\n    open W &&&\n    diff_fun k (charts_submanifold W) f' &&&\n    (\\<And>x. x \\<in> A \\<Longrightarrow> f x = f' x)", "by (auto simp: W_def)"], ["proof (state)\nthis:\n  A \\<subseteq> W\n  W \\<subseteq> carrier\n  open W\n  diff_fun k (charts_submanifold W) f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "interpret submanifold _ _ W"], ["proof (prove)\ngoal (1 subgoal):\n 1. submanifold charts k W", "by unfold_locales fact"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "interpret W: diff_fun k \"(charts_submanifold W)\" f'"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold W) f'", "using W"], ["proof (prove)\nusing this:\n  A \\<subseteq> W\n  W \\<subseteq> carrier\n  open W\n  diff_fun k (charts_submanifold W) f'\n  ?x3 \\<in> A \\<Longrightarrow> f ?x3 = f' ?x3\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold W) f'", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have [simp]: \"sub.carrier = W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sub.carrier = W", "using \\<open>W \\<subseteq> carrier\\<close>"], ["proof (prove)\nusing this:\n  W \\<subseteq> carrier\n\ngoal (1 subgoal):\n 1. sub.carrier = W", "by auto"], ["proof (state)\nthis:\n  sub.carrier = W\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"W \\<subseteq> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. W \\<subseteq> U", "by (auto simp: W_def)"], ["proof (state)\nthis:\n  W \\<subseteq> U\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from smooth_bump_functionE[OF assms(1) \\<open>A \\<subseteq> W\\<close> \\<open>W \\<subseteq> carrier\\<close> \\<open>open W\\<close>]"], ["proof (chain)\npicking this:\n  (\\<And>\\<psi>.\n      \\<lbrakk>diff_fun k charts \\<psi>;\n       \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n       \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n       \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n       csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> W\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain \\<phi>::\"'a\\<Rightarrow>real\" where \\<phi>: \"diff_fun k charts \\<phi>\"\n    \"(\\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> x)\" \"(\\<And>x. x \\<in> carrier \\<Longrightarrow> \\<phi> x \\<le> 1)\" \"(\\<And>x. x \\<in> A \\<Longrightarrow> \\<phi> x = 1)\"\n    \"csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> W\""], ["proof (prove)\nusing this:\n  (\\<And>\\<psi>.\n      \\<lbrakk>diff_fun k charts \\<psi>;\n       \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<psi> x;\n       \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<psi> x \\<le> 1;\n       \\<And>x. x \\<in> A \\<Longrightarrow> \\<psi> x = 1;\n       csupport_on carrier \\<psi> \\<inter> carrier \\<subseteq> W\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>\\<phi>.\n        \\<lbrakk>diff_fun k charts \\<phi>;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> x;\n         \\<And>x. x \\<in> carrier \\<Longrightarrow> \\<phi> x \\<le> 1;\n         \\<And>x. x \\<in> A \\<Longrightarrow> \\<phi> x = 1;\n         csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> W\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  diff_fun k charts \\<phi>\n  ?x3 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> ?x3\n  ?x3 \\<in> carrier \\<Longrightarrow> \\<phi> ?x3 \\<le> 1\n  ?x3 \\<in> A \\<Longrightarrow> \\<phi> ?x3 = 1\n  csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> W\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "interpret \\<phi>: diff_fun k charts \\<phi>"], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts \\<phi>", "by fact"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define g where \"g p = (if p \\<in> W then \\<phi> p *\\<^sub>R f' p else 0)\" for p"], ["proof (state)\nthis:\n  g ?p = (if ?p \\<in> W then \\<phi> ?p *\\<^sub>R f' ?p else (0::'e))\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "thm sub.diff_fun_scaleR"], ["proof (state)\nthis:\n  g ?p = (if ?p \\<in> W then \\<phi> ?p *\\<^sub>R f' ?p else (0::'e))\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"diff_fun k charts g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k charts g", "proof (rule manifold_eucl.diff_open_Un, unfold diff_fun_def[symmetric])"], ["proof (state)\ngoal (5 subgoals):\n 1. diff_fun k (charts_submanifold ?U) g\n 2. diff_fun k (charts_submanifold ?V) g\n 3. open ?U\n 4. open ?V\n 5. carrier \\<subseteq> ?U \\<union> ?V", "have \"diff_fun k (charts_submanifold W) (\\<lambda>p. \\<phi> p *\\<^sub>R f' p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold W) (\\<lambda>p. \\<phi> p *\\<^sub>R f' p)", "by (auto intro!: sub.diff_fun_scaleR \\<phi>.diff_fun_submanifold W)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold W) (\\<lambda>p. \\<phi> p *\\<^sub>R f' p)\n\ngoal (5 subgoals):\n 1. diff_fun k (charts_submanifold ?U) g\n 2. diff_fun k (charts_submanifold ?V) g\n 3. open ?U\n 4. open ?V\n 5. carrier \\<subseteq> ?U \\<union> ?V", "then"], ["proof (chain)\npicking this:\n  diff_fun k (charts_submanifold W) (\\<lambda>p. \\<phi> p *\\<^sub>R f' p)", "show \"diff_fun k (charts_submanifold W) g\""], ["proof (prove)\nusing this:\n  diff_fun k (charts_submanifold W) (\\<lambda>p. \\<phi> p *\\<^sub>R f' p)\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold W) g", "by (rule diff_fun.diff_fun_cong) (auto simp: g_def)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold W) g\n\ngoal (4 subgoals):\n 1. diff_fun k (charts_submanifold ?V) g\n 2. open W\n 3. open ?V\n 4. carrier \\<subseteq> W \\<union> ?V", "interpret C: submanifold _ _ \"carrier - csupport_on carrier \\<phi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. submanifold charts k (carrier - csupport_on carrier \\<phi>)", "by unfold_locales auto"], ["proof (state)\ngoal (4 subgoals):\n 1. diff_fun k (charts_submanifold ?V) g\n 2. open W\n 3. open ?V\n 4. carrier \\<subseteq> W \\<union> ?V", "have sub_carrier[simp]: \"C.sub.carrier = carrier - csupport_on carrier \\<phi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C.sub.carrier = carrier - csupport_on carrier \\<phi>", "by auto"], ["proof (state)\nthis:\n  C.sub.carrier = carrier - csupport_on carrier \\<phi>\n\ngoal (4 subgoals):\n 1. diff_fun k (charts_submanifold ?V) g\n 2. open W\n 3. open ?V\n 4. carrier \\<subseteq> W \\<union> ?V", "have \"diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) 0", "by (rule C.sub.diff_fun_zero)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) 0\n\ngoal (4 subgoals):\n 1. diff_fun k (charts_submanifold ?V) g\n 2. open W\n 3. open ?V\n 4. carrier \\<subseteq> W \\<union> ?V", "then"], ["proof (chain)\npicking this:\n  diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) 0", "show \"diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) g\""], ["proof (prove)\nusing this:\n  diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) 0\n\ngoal (1 subgoal):\n 1. diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) g", "by (rule diff_fun.diff_fun_cong) (auto simp: g_def not_in_csupportD)"], ["proof (state)\nthis:\n  diff_fun k (charts_submanifold (carrier - csupport_on carrier \\<phi>)) g\n\ngoal (3 subgoals):\n 1. open W\n 2. open (carrier - csupport_on carrier \\<phi>)\n 3. carrier \\<subseteq> W \\<union> (carrier - csupport_on carrier \\<phi>)", "show \"open W\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open W", "by fact"], ["proof (state)\nthis:\n  open W\n\ngoal (2 subgoals):\n 1. open (carrier - csupport_on carrier \\<phi>)\n 2. carrier \\<subseteq> W \\<union> (carrier - csupport_on carrier \\<phi>)", "show \"open (carrier - csupport_on carrier \\<phi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (carrier - csupport_on carrier \\<phi>)", "by (auto)"], ["proof (state)\nthis:\n  open (carrier - csupport_on carrier \\<phi>)\n\ngoal (1 subgoal):\n 1. carrier \\<subseteq> W \\<union> (carrier - csupport_on carrier \\<phi>)", "show \"carrier \\<subseteq> W \\<union> (carrier - csupport_on carrier \\<phi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier \\<subseteq> W \\<union> (carrier - csupport_on carrier \\<phi>)", "using \\<phi>"], ["proof (prove)\nusing this:\n  diff_fun k charts \\<phi>\n  ?x3 \\<in> carrier \\<Longrightarrow> 0 \\<le> \\<phi> ?x3\n  ?x3 \\<in> carrier \\<Longrightarrow> \\<phi> ?x3 \\<le> 1\n  ?x3 \\<in> A \\<Longrightarrow> \\<phi> ?x3 = 1\n  csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> W\n\ngoal (1 subgoal):\n 1. carrier \\<subseteq> W \\<union> (carrier - csupport_on carrier \\<phi>)", "by auto"], ["proof (state)\nthis:\n  carrier \\<subseteq> W \\<union> (carrier - csupport_on carrier \\<phi>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  diff_fun k charts g\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  diff_fun k charts g\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<And>x. x \\<in> A \\<Longrightarrow> g x = f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> A \\<Longrightarrow> g x = f x", "using \\<open>A \\<subseteq> W\\<close>"], ["proof (prove)\nusing this:\n  A \\<subseteq> W\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> A \\<Longrightarrow> g x = f x", "by (auto simp: g_def \\<phi> W')"], ["proof (state)\nthis:\n  ?x3 \\<in> A \\<Longrightarrow> g ?x3 = f ?x3\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  ?x3 \\<in> A \\<Longrightarrow> g ?x3 = f ?x3\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"csupport_on carrier g \\<inter> carrier  \\<subseteq> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. csupport_on carrier g \\<inter> carrier \\<subseteq> U", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. csupport_on carrier g \\<inter> carrier \\<subseteq> U", "have \"csupport_on carrier g \\<subseteq> csupport_on carrier \\<phi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. csupport_on carrier g \\<subseteq> csupport_on carrier \\<phi>", "by (rule csupport_on_mono) (auto simp: g_def[abs_def] split: if_splits)"], ["proof (state)\nthis:\n  csupport_on carrier g \\<subseteq> csupport_on carrier \\<phi>\n\ngoal (1 subgoal):\n 1. csupport_on carrier g \\<inter> carrier \\<subseteq> U", "also"], ["proof (state)\nthis:\n  csupport_on carrier g \\<subseteq> csupport_on carrier \\<phi>\n\ngoal (1 subgoal):\n 1. csupport_on carrier g \\<inter> carrier \\<subseteq> U", "have \"\\<dots>  \\<inter> carrier \\<subseteq> U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> U", "using \\<phi>(5) \\<open>W \\<subseteq> U\\<close> \\<open>W \\<subseteq> carrier\\<close> \\<open>U \\<subseteq> carrier\\<close>"], ["proof (prove)\nusing this:\n  csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> W\n  W \\<subseteq> U\n  W \\<subseteq> carrier\n  U \\<subseteq> carrier\n\ngoal (1 subgoal):\n 1. csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> U", "by auto"], ["proof (state)\nthis:\n  csupport_on carrier \\<phi> \\<inter> carrier \\<subseteq> U\n\ngoal (1 subgoal):\n 1. csupport_on carrier g \\<inter> carrier \\<subseteq> U", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<subseteq> y \\<Longrightarrow>\n      x \\<inter> carrier \\<subseteq> y \\<inter> carrier) \\<Longrightarrow>\n  csupport_on carrier g \\<inter> carrier \\<subseteq> U", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<subseteq> y \\<Longrightarrow>\n      x \\<inter> carrier \\<subseteq> y \\<inter> carrier) \\<Longrightarrow>\n  csupport_on carrier g \\<inter> carrier \\<subseteq> U\n\ngoal (1 subgoal):\n 1. csupport_on carrier g \\<inter> carrier \\<subseteq> U", "by auto"], ["proof (state)\nthis:\n  csupport_on carrier g \\<inter> carrier \\<subseteq> U\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  csupport_on carrier g \\<inter> carrier \\<subseteq> U\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>diff_fun k charts f';\n         \\<And>x. x \\<in> A \\<Longrightarrow> f' x = f x;\n         csupport_on carrier f' \\<inter> carrier \\<subseteq> U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  diff_fun k charts g\n  ?x3 \\<in> A \\<Longrightarrow> g ?x3 = f ?x3\n  csupport_on carrier g \\<inter> carrier \\<subseteq> U", "show ?thesis"], ["proof (prove)\nusing this:\n  diff_fun k charts g\n  ?x3 \\<in> A \\<Longrightarrow> g ?x3 = f ?x3\n  csupport_on carrier g \\<inter> carrier \\<subseteq> U\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"]]}