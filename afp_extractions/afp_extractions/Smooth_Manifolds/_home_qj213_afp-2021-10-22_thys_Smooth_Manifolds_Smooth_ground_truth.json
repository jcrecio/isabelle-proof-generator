{"file_name": "/home/qj213/afp-2021-10-22/thys/Smooth_Manifolds/Smooth.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Smooth_Manifolds", "problem_names": ["lemma multivariate_Taylor_integral:\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and Df::\"'a \\<Rightarrow> nat \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"n > 0\"\n  assumes Df_Nil: \"\\<And>a x. Df a 0 H = f a\"\n  assumes Df_Cons: \"\\<And>a i d. a \\<in> closed_segment X (X + H) \\<Longrightarrow> i < n \\<Longrightarrow>\n      ((\\<lambda>a. Df a i H) has_derivative (Df a (Suc i))) (at a within G)\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> G\"\n  defines \"i \\<equiv> \\<lambda>x.\n      ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R Df (X + x *\\<^sub>R H) n H\"\n  shows multivariate_Taylor_has_integral:\n    \"(i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H)) {0..1}\"\n  and multivariate_Taylor:\n    \"f (X + H) = (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\"\n  and multivariate_Taylor_integrable:\n    \"i integrable_on {0..1}\"", "lemma ball_differentiable_atD: \"\\<forall>x\\<in>S. f differentiable at x \\<Longrightarrow> f differentiable_on S\"", "lemma higher_differentiable_on_imp_continuous_on:\n  \"continuous_on S f\" if \"higher_differentiable_on S f n\"", "lemma higher_differentiable_on_imp_differentiable_on:\n  \"f differentiable_on S\" if \"higher_differentiable_on S f k\" \"k > 0\"", "lemma higher_differentiable_on_congI:\n  assumes \"open S\" \"higher_differentiable_on S g n\"\n    and \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  shows \"higher_differentiable_on S f n\"", "lemma higher_differentiable_on_cong:\n  assumes \"open S\" \"S = T\"\n    and \"\\<And>x. x \\<in> T \\<Longrightarrow> f x = g x\"\n  shows \"higher_differentiable_on S f n \\<longleftrightarrow> higher_differentiable_on T g n\"", "lemma higher_differentiable_on_SucD:\n  \"higher_differentiable_on S f n\" if \"higher_differentiable_on S f (Suc n)\"", "lemma higher_differentiable_on_addD:\n  \"higher_differentiable_on S f n\" if \"higher_differentiable_on S f (n + m)\"", "lemma higher_differentiable_on_le:\n  \"higher_differentiable_on S f n\" if \"higher_differentiable_on S f m\" \"n \\<le> m\"", "lemma higher_differentiable_on_open_subsetsI:\n  \"higher_differentiable_on S f n\"\n  if \"\\<And>x. x \\<in> S \\<Longrightarrow> \\<exists>T. x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f n\"", "lemma higher_differentiable_on_const: \"higher_differentiable_on S (\\<lambda>x. c) n\"", "lemma higher_differentiable_on_id: \"higher_differentiable_on S (\\<lambda>x. x) n\"", "lemma higher_differentiable_on_add:\n  \"higher_differentiable_on S (\\<lambda>x. f x + g x) n\"\n  if \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"open S\"", "lemma (in bounded_bilinear) differentiable:\n \"(\\<lambda>x. prod (f x) (g x)) differentiable at x within S\" \n if \"f differentiable at x within S\"\n    \"g differentiable at x within S\"", "lemmas d = bounded_bilinear.differentiable", "lemmas differentiable_inner = bounded_bilinear_inner[THEN d]\n   and differentiable_scaleR = bounded_bilinear_scaleR[THEN d]\n   and differentiable_mult = bounded_bilinear_mult[THEN d]", "lemma (in bounded_bilinear) differentiable_on:\n  \"(\\<lambda>x. prod (f x) (g x)) differentiable_on S\"\n  if \"f differentiable_on S\" \"g differentiable_on S\"", "lemmas do = bounded_bilinear.differentiable_on", "lemmas differentiable_on_inner = bounded_bilinear_inner[THEN do]\n   and differentiable_on_scaleR = bounded_bilinear_scaleR[THEN do]\n   and differentiable_on_mult = bounded_bilinear_mult[THEN do]", "lemma (in bounded_bilinear) higher_differentiable_on:\n  \"higher_differentiable_on S (\\<lambda>x. prod (f x) (g x)) n\"\n  if\n    \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"open S\"", "lemmas hdo = bounded_bilinear.higher_differentiable_on", "lemmas higher_differentiable_on_inner = bounded_bilinear_inner[THEN hdo]\n   and higher_differentiable_on_scaleR = bounded_bilinear_scaleR[THEN hdo]\n   and higher_differentiable_on_mult = bounded_bilinear_mult[THEN hdo]", "lemma higher_differentiable_on_sum:\n  \"higher_differentiable_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x) n\"\n  if \"\\<And>i. i \\<in> F \\<Longrightarrow> finite F \\<Longrightarrow> higher_differentiable_on S (f i) n\" \"open S\"", "lemma higher_differentiable_on_subset:\n  \"higher_differentiable_on S f n\"\n  if \"higher_differentiable_on T f n\" \"S \\<subseteq> T\"", "lemma higher_differentiable_on_compose:\n  \"higher_differentiable_on S (f o g) n\"\n  if \"higher_differentiable_on T f n\" \"higher_differentiable_on S g n\"  \"g ` S \\<subseteq> T\" \"open S\" \"open T\"\n  for g::\"_\\<Rightarrow>_::euclidean_space\"\\<comment>\\<open>TODO: can we get around this restriction?\\<close>", "lemma higher_differentiable_on_uminus:\n  \"higher_differentiable_on S (\\<lambda>x. - f x) n\"\n  if \"higher_differentiable_on S f n\" \"open S\"", "lemma higher_differentiable_on_minus:\n  \"higher_differentiable_on S (\\<lambda>x. f x - g x) n\"\n  if \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"open S\"", "lemma higher_differentiable_on_inverse:\n  \"higher_differentiable_on S (\\<lambda>x. inverse (f x)) n\"\n  if \"higher_differentiable_on S f n\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_\\<Rightarrow>_::real_normed_field\"", "lemma higher_differentiable_on_divide:\n  \"higher_differentiable_on S (\\<lambda>x. f x / g x) n\"\n  if\n    \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> g x \\<noteq> 0\"\n    \"open S\"\n  for f::\"_\\<Rightarrow>_::real_normed_field\"", "lemma differentiable_on_open_Union:\n  \"f differentiable_on \\<Union>S\"\n  if \"\\<And>s. s \\<in> S \\<Longrightarrow> f differentiable_on s\"\n    \"\\<And>s. s \\<in> S \\<Longrightarrow> open s\"", "lemma higher_differentiable_on_open_Union: \"higher_differentiable_on (\\<Union>S) f n\"\n  if \"\\<And>s. s \\<in> S \\<Longrightarrow> higher_differentiable_on s f n\"\n    \"\\<And>s. s \\<in> S \\<Longrightarrow> open s\"", "lemma differentiable_on_open_Un:\n  \"f differentiable_on S \\<union> T\"\n  if \"f differentiable_on S\"\n    \"f differentiable_on T\"\n    \"open S\" \"open T\"", "lemma higher_differentiable_on_open_Un: \"higher_differentiable_on (S \\<union> T) f n\"\n  if \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on T f n\"\n    \"open S\" \"open T\"", "lemma higher_differentiable_on_sqrt: \"higher_differentiable_on S (\\<lambda>x. sqrt (f x)) n\"\n  if \"higher_differentiable_on S f n\" \"0 \\<notin> f ` S\" \"open S\"", "lemma higher_differentiable_on_frechet_derivativeI:\n  \"higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h) i\"\n  if \"higher_differentiable_on X f (Suc i)\" \"open X\" \"x \\<in> X\"", "lemma higher_differentiable_on_norm:\n  \"higher_differentiable_on S (\\<lambda>x. norm (f x)) n\"\n  if \"higher_differentiable_on S f n\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_\\<Rightarrow>_::real_inner\"", "lemma higher_differentiable_on_Pair:\n  \"higher_differentiable_on S f k \\<Longrightarrow> higher_differentiable_on S g k \\<Longrightarrow>\n   higher_differentiable_on S (\\<lambda>x. (f x, g x)) k\"\n  if \"open S\"", "lemma higher_differentiable_on_compose':\n  \"higher_differentiable_on S (\\<lambda>x. f (g x)) n\"\n  if \"higher_differentiable_on T f n\" \"higher_differentiable_on S g n\"  \"g ` S \\<subseteq> T\" \"open S\" \"open T\"\n  for g::\"_\\<Rightarrow>_::euclidean_space\"", "lemma higher_differentiable_on_fst:\n  \"higher_differentiable_on (S \\<times> T) fst k\"", "lemma higher_differentiable_on_snd:\n  \"higher_differentiable_on (S \\<times> T) snd k\"", "lemma higher_differentiable_on_fst_comp:\n  \"higher_differentiable_on S (\\<lambda>x. fst (f x)) k\"\n  if \"higher_differentiable_on S f k\" \"open S\"", "lemma higher_differentiable_on_snd_comp:\n  \"higher_differentiable_on S (\\<lambda>x. snd (f x)) k\"\n  if \"higher_differentiable_on S f k\" \"open S\"", "lemma higher_differentiable_on_Pair':\n  \"higher_differentiable_on S f k \\<Longrightarrow> higher_differentiable_on T g k \\<Longrightarrow>\n   higher_differentiable_on (S \\<times> T) (\\<lambda>x. (f (fst x), g (snd x))) k\"\n  if S: \"open S\" and T: \"open T\"\n  for f::\"_::euclidean_space\\<Rightarrow>_\" and g::\"_::euclidean_space\\<Rightarrow>_\"", "lemma higher_differentiable_on_sin: \"higher_differentiable_on S (\\<lambda>x. sin (f x::real)) n\"\n  and higher_differentiable_on_cos: \"higher_differentiable_on S (\\<lambda>x. cos (f x::real)) n\"\n  if f: \"higher_differentiable_on S f n\" and S: \"open S\"", "lemma frechet_derivative_nth_derivative_commute:\n  \"frechet_derivative (\\<lambda>x. nth_derivative i f x h) (at x) h =\n    nth_derivative i (\\<lambda>x. frechet_derivative f (at x) h) x h\"", "lemma nth_derivative_funpow:\n  \"nth_derivative i f x h = ((\\<lambda>f x. frechet_derivative f (at x) h) ^^ i) f x\"", "lemma nth_derivative_exists:\n  \"\\<exists>f'. ((\\<lambda>x. nth_derivative i f x h) has_derivative f') (at x) \\<and>\n    f' h = nth_derivative (Suc i) f x h\"\n  if \"higher_differentiable_on X f (Suc i)\" \"open X\" \"x \\<in> X\"", "lemma higher_derivatives_exists:\n  assumes \"higher_differentiable_on X f n\" \"open X\"\n  obtains Df where\n    \"\\<And>a h. Df a 0 h = f a\"\n    \"\\<And>a h i. i < n \\<Longrightarrow> a \\<in> X \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative Df a (Suc i)) (at a)\"\n    \"\\<And>a i. i \\<le> n \\<Longrightarrow> a \\<in> X \\<Longrightarrow> Df a i H = nth_derivative i f a H\"", "lemma nth_derivative_differentiable:\n  assumes \"higher_differentiable_on S f (Suc n)\" \"x \\<in> S\"\n  shows \"(\\<lambda>x. nth_derivative n f x v) differentiable at x\"", "lemma higher_differentiable_on_imp_continuous_nth_derivative:\n  assumes \"higher_differentiable_on S f n\"\n  shows \"continuous_on S (\\<lambda>x. nth_derivative n f x v)\"", "lemma frechet_derivative_at_real_eq_scaleR:\n  \"frechet_derivative f (at x) v = v *\\<^sub>R frechet_derivative f (at x) 1\"\n  if \"f differentiable (at x)\" \"NO_MATCH 1 v\"", "lemma higher_differentiable_on_real_Suc:\n  \"higher_differentiable_on S f (Suc n) \\<longleftrightarrow>\n     (\\<forall>x\\<in>S. f differentiable (at x)) \\<and>\n      (higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) 1) n)\"\n  if \"open S\"\n  for S::\"real set\"", "lemma higher_differentiable_on_real_SucI:\n  fixes S::\"real set\"\n  assumes\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> (\\<lambda>x. nth_derivative n f x 1) differentiable at x\"\n    \"continuous_on S (\\<lambda>x. nth_derivative (Suc n) f x 1)\"\n    \"higher_differentiable_on S f n\"\n    and o: \"open S\"\n  shows \"higher_differentiable_on S f (Suc n)\"", "lemma higher_differentiable_on_real_Suc':\n  \"open S \\<Longrightarrow> higher_differentiable_on S f (Suc n) \\<longleftrightarrow>\n    (\\<forall>v. continuous_on S (\\<lambda>x. nth_derivative (Suc n) f x 1)) \\<and>\n    (\\<forall>x\\<in>S. \\<forall>v. (\\<lambda>x. nth_derivative n f x 1) differentiable (at x)) \\<and> higher_differentiable_on S f n\"\n  for S::\"real set\"", "lemma closed_segment_subsetD:\n  \"0 \\<le> x \\<Longrightarrow> x \\<le> 1 \\<Longrightarrow> (X + x *\\<^sub>R H) \\<in> S\"\n  if \"closed_segment X (X + H) \\<subseteq> S\"", "lemma higher_differentiable_Taylor:\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and H::\"'a\"\n    and Df::\"'a \\<Rightarrow> nat \\<Rightarrow> 'a \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"n > 0\"\n  assumes hd: \"higher_differentiable_on S f n\" \"open S\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> S\"\n  defines \"i \\<equiv> \\<lambda>x. ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R nth_derivative n f (X + x *\\<^sub>R H) H\"\n  shows \"(i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H)) {0..1}\" (is ?th1)\n  and \"f (X + H) = (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) + integral {0..1} i\" (is ?th2)\n  and \"i integrable_on {0..1}\" (is ?th3)", "lemma frechet_derivative_componentwise:\n  \"frechet_derivative f (at a) v = (\\<Sum>i\\<in>Basis. (v \\<bullet> i) * (frechet_derivative f (at a) i))\"\n  if \"f differentiable at a\"\n  for f::\"'a::euclidean_space \\<Rightarrow> real\"", "lemma second_derivative_componentwise:\n  \"nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis. (\\<Sum>j\\<in>Basis. frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j) (at a) i * (v \\<bullet> j)) * (v \\<bullet> i))\"\n  if \"higher_differentiable_on S f 2\" and S: \"open S\" \"a \\<in> S\"\n  for f::\"'a::euclidean_space \\<Rightarrow> real\"", "lemma higher_differentiable_Taylor1:\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n  assumes hd: \"higher_differentiable_on S f 2\" \"open S\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> S\"\n  defines \"i \\<equiv> \\<lambda>x. ((1 - x)) *\\<^sub>R nth_derivative 2 f (X + x *\\<^sub>R H) H\"\n  shows \"(i has_integral f (X + H) - (f X + nth_derivative 1 f X H)) {0..1}\"\n    and \"f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} i\"\n    and \"i integrable_on {0..1}\"", "lemma differentiable_on_open_blinfunE:\n  assumes \"f differentiable_on S\" \"open S\"\n  obtains f' where \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative blinfun_apply (f' x)) (at x)\"", "lemma continuous_on_blinfunI1:\n  \"continuous_on X f\"\n  if \"\\<And>i. i \\<in> Basis \\<Longrightarrow> continuous_on X (\\<lambda>x. blinfun_apply (f x) i)\"", "lemma c1_euclidean_blinfunE:\n  fixes f::\"'a::euclidean_space\\<Rightarrow>'b::real_normed_vector\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative f' x) (at x within S)\"\n  assumes \"\\<And>i. i \\<in> Basis \\<Longrightarrow> continuous_on S (\\<lambda>x. f' x i)\"\n  obtains bf' where\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative blinfun_apply (bf' x)) (at x within S)\"\n    \"continuous_on S bf'\"\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> blinfun_apply (bf' x) = f' x\"", "lemma continuous_Sigma:\n  assumes defined: \"y \\<in> Pi T X\"\n  assumes f_cont: \"continuous_on (Sigma T X) (\\<lambda>(t, x). f t x)\"\n  assumes y_cont: \"continuous_on T y\"\n  shows \"continuous_on T (\\<lambda>x. f x (y x))\"", "lemma continuous_on_Times_swap:\n  \"continuous_on (X \\<times> Y) (\\<lambda>(x, y). f x y)\"\n  if \"continuous_on (Y \\<times> X) (\\<lambda>(y, x). f x y)\"", "lemma leibniz_rule':\n  \"\\<And>x. x \\<in> S \\<Longrightarrow>\n      ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n          (at x within S)\"\n  \"(\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\"\n  if \"convex S\"\n    and c1: \"\\<And>t x. t \\<in> cbox a b \\<Longrightarrow> x \\<in> S \\<Longrightarrow> ((\\<lambda>x. f x t) has_derivative fx x t) (at x within S)\"\n    \"\\<And>i. i \\<in> Basis \\<Longrightarrow> continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). fx x t i)\"\n    and i: \"\\<And>x. x \\<in> S \\<Longrightarrow> f x integrable_on cbox a b\"\n  for S::\"'a::euclidean_space set\"\n    and f::\"'a \\<Rightarrow> 'b::euclidean_space \\<Rightarrow> 'c::euclidean_space\"", "lemmas leibniz_rule'_interval = leibniz_rule'[where 'b=\"_::ordered_euclidean_space\",\n    unfolded cbox_interval]", "lemma leibniz_rule'_higher:\n  \"higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) k\"\n  if \"convex S\" \"open S\"\n    and c1: \"higher_differentiable_on (S\\<times>cbox a b) (\\<lambda>(x, t). f x t) k\"\n    \\<comment>\\<open>this condition is actually too strong:\n      it would suffice if higher partial derivatives (w.r.t. x) are continuous w.r.t. t.\n      but it makes the statement short and no need to introduce new constants\\<close>\n  for S::\"'a::euclidean_space set\"\n    and f::\"'a \\<Rightarrow> 'b::euclidean_space \\<Rightarrow> 'c::euclidean_space\"", "lemmas leibniz_rule'_higher_interval = leibniz_rule'_higher[where 'b=\"_::ordered_euclidean_space\",\n    unfolded cbox_interval]", "lemma derivative_is_smooth':\n  assumes \"(k+1)-smooth_on S f\"\n  shows \"k-smooth_on S (\\<lambda>x. frechet_derivative f (at x) v)\"", "lemma derivative_is_smooth: \"smooth_on S f \\<Longrightarrow> smooth_on S (\\<lambda>x. frechet_derivative f (at x) v)\"", "lemma smooth_on_imp_continuous_on: \"continuous_on S f\" if \"k-smooth_on S f\"", "lemma smooth_on_imp_differentiable_on[simp]: \"f differentiable_on S\" if \"k-smooth_on S f\" \"k \\<noteq> 0\"", "lemma smooth_on_cong:\n  assumes \"k-smooth_on S g\" \"open S\"\n    and \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  shows \"k-smooth_on S f\"", "lemma smooth_on_open_Un:\n  \"k-smooth_on S f \\<Longrightarrow> k-smooth_on T f \\<Longrightarrow> open S \\<Longrightarrow> open T \\<Longrightarrow> k-smooth_on (S \\<union> T) f\"", "lemma smooth_on_open_subsetsI:\n  \"k-smooth_on S f\"\n  if \"\\<And>x. x \\<in> S \\<Longrightarrow> \\<exists>T. x \\<in> T \\<and> open T \\<and> k-smooth_on T f\"", "lemma smooth_on_const[intro]: \"k-smooth_on S (\\<lambda>x. c)\"", "lemma smooth_on_id[intro]: \"k-smooth_on S (\\<lambda>x. x)\"", "lemma smooth_on_add_fun: \"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (f + g)\"", "lemmas smooth_on_add = smooth_on_add_fun[unfolded plus_fun_def]", "lemma smooth_on_sum:\n  \"n-smooth_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x)\"\n  if \"\\<And>i. i \\<in> F \\<Longrightarrow> finite F \\<Longrightarrow> n-smooth_on S (f i)\" \"open S\"", "lemma (in bounded_bilinear) smooth_on:\n  includes no_matrix_mult\n  assumes \"k-smooth_on S f\" \"k-smooth_on S g\" \"open S\"\n  shows \"k-smooth_on S (\\<lambda>x. (f x) ** (g x))\"", "lemma smooth_on_compose2:\n  fixes g::\"_\\<Rightarrow>_::euclidean_space\"\n  assumes \"k-smooth_on T f\" \"k-smooth_on S g\" \"open U\" \"open T\" \"g ` U \\<subseteq> T\" \"U \\<subseteq> S\" \n  shows \"k-smooth_on U (f o g)\"", "lemma smooth_on_compose:\n  fixes g::\"_\\<Rightarrow>_::euclidean_space\"\n  assumes \"k-smooth_on T f\" \"k-smooth_on S g\" \"open S\" \"open T\" \"g ` S \\<subseteq> T\"\n  shows \"k-smooth_on S (f o g)\"", "lemma smooth_on_subset:\n  \"k-smooth_on S f\"\n  if \"k-smooth_on T f\" \"S \\<subseteq> T\"", "lemmas s = bounded_bilinear.smooth_on", "lemmas smooth_on_inner = bounded_bilinear_inner[THEN s]\n   and smooth_on_scaleR = bounded_bilinear_scaleR[THEN s]\n   and smooth_on_mult = bounded_bilinear_mult[THEN s]", "lemma smooth_on_divide:\"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow>(\\<And>x. x \\<in> S \\<Longrightarrow> g x \\<noteq> 0) \\<Longrightarrow>\n  k-smooth_on S (\\<lambda>x. f x / g x)\"\n  for f::\"_\\<Rightarrow>_::real_normed_field\"", "lemma smooth_on_scaleR_fun: \"k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (c *\\<^sub>R g)\"", "lemma smooth_on_uminus_fun: \"k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (- g)\"", "lemmas smooth_on_uminus = smooth_on_uminus_fun[unfolded fun_Compl_def]", "lemma smooth_on_minus_fun: \"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (f - g)\"", "lemmas smooth_on_minus = smooth_on_minus_fun[unfolded fun_diff_def]", "lemma smooth_on_times_fun: \"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (f * g)\"\n  for f g::\"_ \\<Rightarrow>_::real_normed_algebra\"", "lemma smooth_on_le:\n  \"l-smooth_on S f\"\n  if \"k-smooth_on S f\" \"l \\<le> k\"", "lemma smooth_on_inverse: \"k-smooth_on S (\\<lambda>x. inverse (f x))\"\n  if \"k-smooth_on S f\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_ \\<Rightarrow>_::real_normed_field\"", "lemma smooth_on_norm: \"k-smooth_on S (\\<lambda>x. norm (f x))\"\n  if \"k-smooth_on S f\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_ \\<Rightarrow>_::real_inner\"", "lemma smooth_on_sqrt: \"k-smooth_on S (\\<lambda>x. sqrt (f x))\"\n  if \"k-smooth_on S f\" \"0 \\<notin> f ` S\" \"open S\"", "lemma smooth_on_frechet_derivative:\n  \"\\<infinity>-smooth_on UNIV (\\<lambda>x. frechet_derivative f (at x) v)\"\n  if \"\\<infinity>-smooth_on UNIV f\"\n    \\<comment>\\<open>TODO: generalize\\<close>", "lemmas smooth_on_frechet_derivivative_comp = smooth_on_compose2[OF smooth_on_frechet_derivative, unfolded o_def]", "lemma smooth_onD: \"higher_differentiable_on S f n\" if \"m-smooth_on S f\" \"enat n \\<le> m\"", "lemma (in bounded_linear) higher_differentiable_on: \"higher_differentiable_on S f n\"", "lemma (in bounded_linear) smooth_on: \"k-smooth_on S f\"", "lemma smooth_on_snd:\n  \"k-smooth_on S (\\<lambda>x. snd (f x))\"\n  if \"k-smooth_on S f\" \"open S\"", "lemma smooth_on_fst:\n  \"k-smooth_on S (\\<lambda>x. fst (f x))\"\n  if \"k-smooth_on S f\" \"open S\"", "lemma smooth_on_sin: \"n-smooth_on S (\\<lambda>x. sin (f x::real))\" if \"n-smooth_on S f\" \"open S\"", "lemma smooth_on_cos: \"n-smooth_on S (\\<lambda>x. cos (f x::real))\" if \"n-smooth_on S f\" \"open S\"", "lemma smooth_on_Taylor2E:\n  fixes f::\"'a::euclidean_space \\<Rightarrow> real\"\n  assumes hd: \"\\<infinity>-smooth_on UNIV f\"\n  obtains g where \"\\<And>Y.\n    f Y = f X + frechet_derivative f (at X) (Y - X) + (\\<Sum>i\\<in>Basis. (\\<Sum>j\\<in>Basis. ((Y - X) \\<bullet> j) * ((Y - X) \\<bullet> i) * g i j Y))\"\n    \"\\<And>i j. i \\<in> Basis \\<Longrightarrow> j \\<in> Basis \\<Longrightarrow> \\<infinity>-smooth_on UNIV (g i j)\"\n    \\<comment>\\<open>TODO: generalize\\<close>", "lemma smooth_on_Pair:\n  \"k-smooth_on S (\\<lambda>x. (f x, g x))\"\n  if \"open S\" \"k-smooth_on S f\" \"k-smooth_on S g\"", "lemma smooth_on_Pair':\n  \"k-smooth_on (S \\<times> T) (\\<lambda>x. (f (fst x), g (snd x)))\"\n  if \"open S\" \"open T\" \"k-smooth_on S f\" \"k-smooth_on T g\"\n  for f::\"_::euclidean_space\\<Rightarrow>_\" and g::\"_::euclidean_space\\<Rightarrow>_\"", "lemma diffeomorphism_imp_homeomorphism:\n  assumes \"diffeomorphism k s t p p'\"\n  shows  \"homeomorphism s t p p'\"", "lemma diffeomorphismD:\n  assumes \"diffeomorphism k S T f g\"\n  shows diffeomorphism_smoothD: \"k-smooth_on S f\" \"k-smooth_on T g\"\n    and diffeomorphism_inverseD: \"\\<And>x. x \\<in> S \\<Longrightarrow> g (f x) = x\" \"\\<And>y. y \\<in> T \\<Longrightarrow> f (g y) = y\"\n    and diffeomorphism_image_eq: \"(f ` S = T)\" \"(g ` T = S)\"", "lemma diffeomorphism_compose:\n  \"diffeomorphism n S T f g \\<Longrightarrow> diffeomorphism n T U h k \\<Longrightarrow> open S \\<Longrightarrow> open T \\<Longrightarrow> open U \\<Longrightarrow>\n    diffeomorphism n S U (h \\<circ> f) (g \\<circ> k)\"\n  for f::\"_\\<Rightarrow>_::euclidean_space\"", "lemma diffeomorphism_add: \"diffeomorphism k UNIV UNIV (\\<lambda>x. x + c) (\\<lambda>x. x - c)\"", "lemma diffeomorphism_scaleR: \"diffeomorphism k UNIV UNIV (\\<lambda>x. c *\\<^sub>R x) (\\<lambda>x. x /\\<^sub>R c)\"\n  if \"c \\<noteq> 0\""], "translations": [["", "lemma multivariate_Taylor_integral:\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and Df::\"'a \\<Rightarrow> nat \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"n > 0\"\n  assumes Df_Nil: \"\\<And>a x. Df a 0 H = f a\"\n  assumes Df_Cons: \"\\<And>a i d. a \\<in> closed_segment X (X + H) \\<Longrightarrow> i < n \\<Longrightarrow>\n      ((\\<lambda>a. Df a i H) has_derivative (Df a (Suc i))) (at a within G)\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> G\"\n  defines \"i \\<equiv> \\<lambda>x.\n      ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R Df (X + x *\\<^sub>R H) n H\"\n  shows multivariate_Taylor_has_integral:\n    \"(i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H)) {0..1}\"\n  and multivariate_Taylor:\n    \"f (X + H) = (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\"\n  and multivariate_Taylor_integrable:\n    \"i integrable_on {0..1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1} &&&\n    f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i &&&\n    i integrable_on {0..1}", "proof goal_cases"], ["proof (state)\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "let ?G = \"closed_segment X (X + H)\""], ["proof (state)\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "define line where \"line t = X + t *\\<^sub>R H\" for t"], ["proof (state)\nthis:\n  line ?t = X + ?t *\\<^sub>R H\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have segment_eq: \"closed_segment X (X + H) = line ` {0 .. 1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed_segment X (X + H) = line ` {0..1}", "by (auto simp: line_def closed_segment_def algebra_simps)"], ["proof (state)\nthis:\n  closed_segment X (X + H) = line ` {0..1}\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have line_deriv: \"\\<And>x. (line has_derivative (\\<lambda>t. t *\\<^sub>R H)) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. (line has_derivative (\\<lambda>t. t *\\<^sub>R H)) (at x)", "by (auto intro!: derivative_eq_intros simp: line_def [abs_def])"], ["proof (state)\nthis:\n  (line has_derivative (\\<lambda>t. t *\\<^sub>R H)) (at ?x)\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "define g where \"g = f o line\""], ["proof (state)\nthis:\n  g = f \\<circ> line\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "define Dg where \"Dg n t = Df (line t) n H\" for n :: nat and t :: real"], ["proof (state)\nthis:\n  Dg ?n ?t = Df (line ?t) ?n H\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "note \\<open>n > 0\\<close>"], ["proof (state)\nthis:\n  0 < n\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "moreover"], ["proof (state)\nthis:\n  0 < n\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have Dg0: \"Dg 0 = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Dg 0 = g", "by (auto simp add: Dg_def Df_Nil g_def)"], ["proof (state)\nthis:\n  Dg 0 = g\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "moreover"], ["proof (state)\nthis:\n  Dg 0 = g\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "have DgSuc: \"(Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})\"\n    if \"m < n\" \"0 \\<le> t\" \"t \\<le> 1\" for m::nat and t::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "from that"], ["proof (chain)\npicking this:\n  m < n\n  0 \\<le> t\n  t \\<le> 1", "have [intro]: \"line t \\<in> ?G\""], ["proof (prove)\nusing this:\n  m < n\n  0 \\<le> t\n  t \\<le> 1\n\ngoal (1 subgoal):\n 1. line t \\<in> closed_segment X (X + H)", "using assms"], ["proof (prove)\nusing this:\n  m < n\n  0 \\<le> t\n  t \\<le> 1\n  0 < n\n  Df ?a 0 H = f ?a\n  \\<lbrakk>?a \\<in> closed_segment X (X + H); ?i < n\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>a. Df a ?i H) has_derivative Df ?a (Suc ?i))\n                     (at ?a within G)\n  closed_segment X (X + H) \\<subseteq> G\n  i \\<equiv>\n  \\<lambda>x.\n     ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R Df (X + x *\\<^sub>R H) n H\n\ngoal (1 subgoal):\n 1. line t \\<in> closed_segment X (X + H)", "by (auto simp: segment_eq)"], ["proof (state)\nthis:\n  line t \\<in> closed_segment X (X + H)\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "note [derivative_intros] = has_derivative_in_compose[OF _ has_derivative_subset[OF Df_Cons]]"], ["proof (state)\nthis:\n  \\<lbrakk>(?f has_derivative ?f') (at ?x within ?s);\n   ?f ?x \\<in> closed_segment X (X + H); ?i2 < n;\n   ?f ` ?s \\<subseteq> G\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. Df (?f x) ?i2 H) has_derivative\n                     (\\<lambda>x. Df (?f ?x) (Suc ?i2) (?f' x)))\n                     (at ?x within ?s)\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "interpret Df: linear \"(\\<lambda>d. Df (line t) (Suc m) d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (Df (line t) (Suc m))", "by (auto intro!: has_derivative_linear derivative_intros \\<open>m < n\\<close>)"], ["proof (state)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "note [derivative_intros] =\n      has_derivative_compose[OF _ line_deriv]"], ["proof (state)\nthis:\n  (?f has_derivative ?f') (at ?x within ?s) \\<Longrightarrow>\n  ((\\<lambda>x. line (?f x)) has_derivative (\\<lambda>x. ?f' x *\\<^sub>R H))\n   (at ?x within ?s)\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "using Df.scaleR \\<open>m < n\\<close>"], ["proof (prove)\nusing this:\n  Df (line t) (Suc m) (?r *\\<^sub>R ?b) =\n  ?r *\\<^sub>R Df (line t) (Suc m) ?b\n  m < n\n\ngoal (1 subgoal):\n 1. (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})", "by (auto simp: Dg_def [abs_def] has_vector_derivative_def g_def segment_eq\n         intro!: derivative_eq_intros subsetD[OF cs])"], ["proof (state)\nthis:\n  (Dg m has_vector_derivative Dg (Suc m) t) (at t within {0..1})\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> (Dg ?m has_vector_derivative Dg (Suc ?m) ?t)\n                     (at ?t within {0..1})\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "ultimately"], ["proof (chain)\npicking this:\n  0 < n\n  Dg 0 = g\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> (Dg ?m has_vector_derivative Dg (Suc ?m) ?t)\n                     (at ?t within {0..1})", "have g_Taylor: \"(i has_integral g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0)) {0 .. 1}\""], ["proof (prove)\nusing this:\n  0 < n\n  Dg 0 = g\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> (Dg ?m has_vector_derivative Dg (Suc ?m) ?t)\n                     (at ?t within {0..1})\n\ngoal (1 subgoal):\n 1. (i has_integral\n     g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n     {0..1}", "unfolding i_def Dg_def [abs_def] line_def"], ["proof (prove)\nusing this:\n  0 < n\n  (\\<lambda>t. Df (X + t *\\<^sub>R H) 0 H) = g\n  \\<lbrakk>?m < n; 0 \\<le> ?t; ?t \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>t.\n                         Df (X + t *\\<^sub>R H) ?m H) has_vector_derivative\n                     Df (X + ?t *\\<^sub>R H) (Suc ?m) H)\n                     (at ?t within {0..1})\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n         Df (X + x *\\<^sub>R H) n H) has_integral\n     g 1 -\n     (\\<Sum>i<n.\n         ((1 - 0) ^ i / fact i) *\\<^sub>R Df (X + 0 *\\<^sub>R H) i H))\n     {0..1}", "by (rule Taylor_has_integral) auto"], ["proof (state)\nthis:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 3. i integrable_on {0..1}", "then"], ["proof (chain)\npicking this:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}", "show c: ?case"], ["proof (prove)\nusing this:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}\n\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}", "using \\<open>n > 0\\<close>"], ["proof (prove)\nusing this:\n  (i has_integral\n   g 1 - (\\<Sum>i<n. ((1 - 0) ^ i / fact i) *\\<^sub>R Dg i 0))\n   {0..1}\n  0 < n\n\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}", "by (auto simp: g_def line_def Dg_def)"], ["proof (state)\nthis:\n  (i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n   {0..1}\n\ngoal (2 subgoals):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 2. i integrable_on {0..1}", "case 2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n 2. i integrable_on {0..1}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i", "using c"], ["proof (prove)\nusing this:\n  (i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n   {0..1}\n\ngoal (1 subgoal):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i", "by (simp add: integral_unique add.commute)"], ["proof (state)\nthis:\n  f (X + H) =\n  (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) + integral {0..1} i\n\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "case 3"], ["proof (state)\nthis:\n  \n\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "using c"], ["proof (prove)\nusing this:\n  (i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n   {0..1}\n\ngoal (1 subgoal):\n 1. i integrable_on {0..1}", "by force"], ["proof (state)\nthis:\n  i integrable_on {0..1}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Higher-order differentiable\\<close>"], ["", "fun higher_differentiable_on ::\n  \"'a::real_normed_vector set \\<Rightarrow> ('a \\<Rightarrow> 'b::real_normed_vector) \\<Rightarrow> nat \\<Rightarrow> bool\" where\n  \"higher_differentiable_on S f 0 \\<longleftrightarrow> continuous_on S f\"\n| \"higher_differentiable_on S f (Suc n) \\<longleftrightarrow>\n   (\\<forall>x\\<in>S. f differentiable (at x)) \\<and>\n   (\\<forall>v. higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v) n)\""], ["", "lemma ball_differentiable_atD: \"\\<forall>x\\<in>S. f differentiable at x \\<Longrightarrow> f differentiable_on S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S. f differentiable at x \\<Longrightarrow>\n    f differentiable_on S", "by (auto simp: differentiable_on_def differentiable_at_withinI)"], ["", "lemma higher_differentiable_on_imp_continuous_on:\n  \"continuous_on S f\" if \"higher_differentiable_on S f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on S f", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. continuous_on S f", "by (cases n) (auto simp: differentiable_imp_continuous_on ball_differentiable_atD)"], ["", "lemma higher_differentiable_on_imp_differentiable_on:\n  \"f differentiable_on S\" if \"higher_differentiable_on S f k\" \"k > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f differentiable_on S", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f k\n  0 < k\n\ngoal (1 subgoal):\n 1. f differentiable_on S", "by (cases k) (auto simp: ball_differentiable_atD)"], ["", "lemma higher_differentiable_on_congI:\n  assumes \"open S\" \"higher_differentiable_on S g n\"\n    and \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  shows \"higher_differentiable_on S f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using assms(2,3)"], ["proof (prove)\nusing this:\n  higher_differentiable_on S g n\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "proof (induction n arbitrary: f g)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S g 0;\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f 0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on S g 0\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S g 0;\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f 0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S g 0\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S g 0\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 0", "by auto"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on S ?g n;\n   \\<And>x. x \\<in> S \\<Longrightarrow> ?f x = ?g x\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S ?f n\n  higher_differentiable_on S g (Suc n)\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "have 1: \"\\<forall>x\\<in>S. g differentiable (at x)\" and\n       2: \"higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v) n\" for v"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S. g differentiable at x &&&\n    higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v) n", "using Suc"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S ?g n;\n   \\<And>x. x \\<in> S \\<Longrightarrow> ?f x = ?g x\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S ?f n\n  higher_differentiable_on S g (Suc n)\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S. g differentiable at x &&&\n    higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v) n", "by auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>S. g differentiable at x\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) ?v) n\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "have 3: \"\\<forall>x\\<in>S. f differentiable (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S. f differentiable at x", "using 1 Suc(3) assms(1)"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>S. g differentiable at x\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n  open S\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S. f differentiable at x", "by (metis differentiable_eqI)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>S. f differentiable at x\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "have 4: \"frechet_derivative f (at x) v = frechet_derivative g (at x) v\" if \"x \\<in> S\" for x v"], ["proof (prove)\ngoal (1 subgoal):\n 1. frechet_derivative f (at x) v = frechet_derivative g (at x) v", "using \"3\" Suc.prems(2) assms(1) frechet_derivative_transform_within_open_ext that"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>S. f differentiable at x\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n  open S\n  \\<lbrakk>?f differentiable at ?xa; open ?X; ?xa \\<in> ?X;\n   \\<And>x. x \\<in> ?X \\<Longrightarrow> ?f x = ?g x\\<rbrakk>\n  \\<Longrightarrow> frechet_derivative ?f (at ?xa) ?x =\n                    frechet_derivative ?g (at ?xa) ?x\n  x \\<in> S\n\ngoal (1 subgoal):\n 1. frechet_derivative f (at x) v = frechet_derivative g (at x) v", "by blast"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  frechet_derivative f (at ?x) ?v = frechet_derivative g (at ?x) ?v\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S g n;\n                    \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f n;\n        higher_differentiable_on S g (Suc n);\n        \\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "from 2 3 4"], ["proof (chain)\npicking this:\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) ?v) n\n  \\<forall>x\\<in>S. f differentiable at x\n  ?x \\<in> S \\<Longrightarrow>\n  frechet_derivative f (at ?x) ?v = frechet_derivative g (at ?x) ?v", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) ?v) n\n  \\<forall>x\\<in>S. f differentiable at x\n  ?x \\<in> S \\<Longrightarrow>\n  frechet_derivative f (at ?x) ?v = frechet_derivative g (at ?x) ?v\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "using Suc.IH[OF 2 4]"], ["proof (prove)\nusing this:\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) ?v) n\n  \\<forall>x\\<in>S. f differentiable at x\n  ?x \\<in> S \\<Longrightarrow>\n  frechet_derivative f (at ?x) ?v = frechet_derivative g (at ?x) ?v\n  (\\<And>x. x \\<in> S \\<Longrightarrow> x \\<in> S) \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>a. frechet_derivative f (at a) ?v3) n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "by auto"], ["proof (state)\nthis:\n  higher_differentiable_on S f (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_differentiable_on_cong:\n  assumes \"open S\" \"S = T\"\n    and \"\\<And>x. x \\<in> T \\<Longrightarrow> f x = g x\"\n  shows \"higher_differentiable_on S f n \\<longleftrightarrow> higher_differentiable_on T g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n = higher_differentiable_on T g n", "using higher_differentiable_on_congI assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>open ?S; higher_differentiable_on ?S ?g ?n;\n   \\<And>x. x \\<in> ?S \\<Longrightarrow> ?f x = ?g x\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on ?S ?f ?n\n  open S\n  S = T\n  ?x \\<in> T \\<Longrightarrow> f ?x = g ?x\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n = higher_differentiable_on T g n", "by auto"], ["", "lemma higher_differentiable_on_SucD:\n  \"higher_differentiable_on S f n\" if \"higher_differentiable_on S f (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by (induction n arbitrary: f) (auto simp: differentiable_imp_continuous_on ball_differentiable_atD)"], ["", "lemma higher_differentiable_on_addD:\n  \"higher_differentiable_on S f n\" if \"higher_differentiable_on S f (n + m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (n + m)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by (induction m arbitrary: f n)\n    (auto simp del: higher_differentiable_on.simps dest!: higher_differentiable_on_SucD)"], ["", "lemma higher_differentiable_on_le:\n  \"higher_differentiable_on S f n\" if \"higher_differentiable_on S f m\" \"n \\<le> m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using higher_differentiable_on_addD[of S f n \"m - n\"] that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (n + (m - n)) \\<Longrightarrow>\n  higher_differentiable_on S f n\n  higher_differentiable_on S f m\n  n \\<le> m\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by auto"], ["", "lemma higher_differentiable_on_open_subsetsI:\n  \"higher_differentiable_on S f n\"\n  if \"\\<And>x. x \\<in> S \\<Longrightarrow> \\<exists>T. x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using that"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  \\<exists>T. ?x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "proof (induction n arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       (\\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and>\n              higher_differentiable_on T f 0) \\<Longrightarrow>\n       higher_differentiable_on S f 0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   (\\<And>x.\n                       x \\<in> S \\<Longrightarrow>\n                       \\<exists>T.\n                          x \\<in> T \\<and>\n                          open T \\<and>\n                          higher_differentiable_on T f n) \\<Longrightarrow>\n                   higher_differentiable_on S f n;\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and> higher_differentiable_on T f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "case 0"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  \\<exists>T. ?x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f 0\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       (\\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and>\n              higher_differentiable_on T f 0) \\<Longrightarrow>\n       higher_differentiable_on S f 0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   (\\<And>x.\n                       x \\<in> S \\<Longrightarrow>\n                       \\<exists>T.\n                          x \\<in> T \\<and>\n                          open T \\<and>\n                          higher_differentiable_on T f n) \\<Longrightarrow>\n                   higher_differentiable_on S f n;\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and> higher_differentiable_on T f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 0", "by (force simp: continuous_on_def\n        dest!: 0\n        dest: at_within_open\n        intro!: Lim_at_imp_Lim_at_within[where S=S])"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   (\\<And>x.\n                       x \\<in> S \\<Longrightarrow>\n                       \\<exists>T.\n                          x \\<in> T \\<and>\n                          open T \\<and>\n                          higher_differentiable_on T f n) \\<Longrightarrow>\n                   higher_differentiable_on S f n;\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and> higher_differentiable_on T f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   (\\<And>x.\n                       x \\<in> S \\<Longrightarrow>\n                       \\<exists>T.\n                          x \\<in> T \\<and>\n                          open T \\<and>\n                          higher_differentiable_on T f n) \\<Longrightarrow>\n                   higher_differentiable_on S f n;\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and> higher_differentiable_on T f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  (\\<And>x.\n      x \\<in> S \\<Longrightarrow>\n      \\<exists>T.\n         x \\<in> T \\<and>\n         open T \\<and> higher_differentiable_on T ?f n) \\<Longrightarrow>\n  higher_differentiable_on S ?f n\n  ?x \\<in> S \\<Longrightarrow>\n  \\<exists>T.\n     ?x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f (Suc n)\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   (\\<And>x.\n                       x \\<in> S \\<Longrightarrow>\n                       \\<exists>T.\n                          x \\<in> T \\<and>\n                          open T \\<and>\n                          higher_differentiable_on T f n) \\<Longrightarrow>\n                   higher_differentiable_on S f n;\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and> higher_differentiable_on T f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "have \"f differentiable at x\" if \"x \\<in> S\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. f differentiable at x", "using Suc.prems[OF \\<open>x \\<in> S\\<close>]"], ["proof (prove)\nusing this:\n  \\<exists>T.\n     x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f (Suc n)\n\ngoal (1 subgoal):\n 1. f differentiable at x", "by (auto simp: differentiable_on_def dest: at_within_open dest!: bspec)"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   (\\<And>x.\n                       x \\<in> S \\<Longrightarrow>\n                       \\<exists>T.\n                          x \\<in> T \\<and>\n                          open T \\<and>\n                          higher_differentiable_on T f n) \\<Longrightarrow>\n                   higher_differentiable_on S f n;\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and> higher_differentiable_on T f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "then"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x", "have \"f differentiable_on S\""], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n\ngoal (1 subgoal):\n 1. f differentiable_on S", "by (auto simp: differentiable_on_def intro!: differentiable_at_withinI[where s=S])"], ["proof (state)\nthis:\n  f differentiable_on S\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   (\\<And>x.\n                       x \\<in> S \\<Longrightarrow>\n                       \\<exists>T.\n                          x \\<in> T \\<and>\n                          open T \\<and>\n                          higher_differentiable_on T f n) \\<Longrightarrow>\n                   higher_differentiable_on S f n;\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           \\<exists>T.\n              x \\<in> T \\<and>\n              open T \\<and> higher_differentiable_on T f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc n)", "with Suc"], ["proof (chain)\npicking this:\n  (\\<And>x.\n      x \\<in> S \\<Longrightarrow>\n      \\<exists>T.\n         x \\<in> T \\<and>\n         open T \\<and> higher_differentiable_on T ?f n) \\<Longrightarrow>\n  higher_differentiable_on S ?f n\n  ?x \\<in> S \\<Longrightarrow>\n  \\<exists>T.\n     ?x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f (Suc n)\n  f differentiable_on S", "show ?case"], ["proof (prove)\nusing this:\n  (\\<And>x.\n      x \\<in> S \\<Longrightarrow>\n      \\<exists>T.\n         x \\<in> T \\<and>\n         open T \\<and> higher_differentiable_on T ?f n) \\<Longrightarrow>\n  higher_differentiable_on S ?f n\n  ?x \\<in> S \\<Longrightarrow>\n  \\<exists>T.\n     ?x \\<in> T \\<and> open T \\<and> higher_differentiable_on T f (Suc n)\n  f differentiable_on S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "by fastforce"], ["proof (state)\nthis:\n  higher_differentiable_on S f (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_differentiable_on_const: \"higher_differentiable_on S (\\<lambda>x. c) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. c) n", "by (induction n arbitrary: c) (auto simp: continuous_intros frechet_derivative_const)"], ["", "lemma higher_differentiable_on_id: \"higher_differentiable_on S (\\<lambda>x. x) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. x) n", "by (cases n) (auto simp: frechet_derivative_works higher_differentiable_on_const)"], ["", "lemma higher_differentiable_on_add:\n  \"higher_differentiable_on S (\\<lambda>x. f x + g x) n\"\n  if \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x + g x) n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n  higher_differentiable_on S g n\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x + g x) n", "proof (induction n arbitrary: f g)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S f 0;\n        higher_differentiable_on S g 0; open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x + g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          (Suc n)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n  open S\n\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S f 0;\n        higher_differentiable_on S g 0; open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x + g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x + g x) 0", "by (auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. f x + g x) 0\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x + g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x + g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on S ?f n; higher_differentiable_on S ?g n;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. ?f x + ?g x) n\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  open S\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x + g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          (Suc n)", "from Suc.prems"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  open S", "have\n    f: \"\\<And>x. x\\<in>S \\<Longrightarrow> f differentiable (at x)\"\n    and hf: \"higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v) n\"\n    and g: \"\\<And>x. x\\<in>S \\<Longrightarrow> g differentiable (at x)\"\n    and hg: \"higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v) n\"\n    for v"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  open S\n\ngoal (1 subgoal):\n 1. ((\\<And>x. x \\<in> S \\<Longrightarrow> f differentiable at x) &&&\n     higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v)\n      n) &&&\n    (\\<And>x. x \\<in> S \\<Longrightarrow> g differentiable at x) &&&\n    higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v) n", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) ?v) n\n  ?x \\<in> S \\<Longrightarrow> g differentiable at ?x\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) ?v) n\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x + g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x + g x)\n                          (Suc n)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x + g x) (Suc n)", "using f g \\<open>open S\\<close>"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n  ?x \\<in> S \\<Longrightarrow> g differentiable at ?x\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x + g x) (Suc n)", "by (auto simp: frechet_derivative_plus\n        intro!: derivative_intros f g Suc.IH hf hg\n        cong: higher_differentiable_on_cong)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. f x + g x) (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in bounded_bilinear) differentiable:\n \"(\\<lambda>x. prod (f x) (g x)) differentiable at x within S\" \n if \"f differentiable at x within S\"\n    \"g differentiable at x within S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. f x ** g x) differentiable at x within S", "by (blast intro: differentiableI frechet_derivative_worksI that FDERIV)"], ["", "context begin"], ["", "private"], ["", "lemmas d = bounded_bilinear.differentiable"], ["", "lemmas differentiable_inner = bounded_bilinear_inner[THEN d]\n   and differentiable_scaleR = bounded_bilinear_scaleR[THEN d]\n   and differentiable_mult = bounded_bilinear_mult[THEN d]"], ["", "end"], ["", "lemma (in bounded_bilinear) differentiable_on:\n  \"(\\<lambda>x. prod (f x) (g x)) differentiable_on S\"\n  if \"f differentiable_on S\" \"g differentiable_on S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. f x ** g x) differentiable_on S", "using that"], ["proof (prove)\nusing this:\n  f differentiable_on S\n  g differentiable_on S\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. f x ** g x) differentiable_on S", "by (auto simp: differentiable_on_def differentiable)"], ["", "context begin"], ["", "private"], ["", "lemmas do = bounded_bilinear.differentiable_on"], ["", "lemmas differentiable_on_inner = bounded_bilinear_inner[THEN do]\n   and differentiable_on_scaleR = bounded_bilinear_scaleR[THEN do]\n   and differentiable_on_mult = bounded_bilinear_mult[THEN do]"], ["", "end"], ["", "lemma (in bounded_bilinear) higher_differentiable_on:\n  \"higher_differentiable_on S (\\<lambda>x. prod (f x) (g x)) n\"\n  if\n    \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x ** g x) n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n  higher_differentiable_on S g n\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x ** g x) n", "proof (induction n arbitrary: f g)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S f 0;\n        higher_differentiable_on S g 0; open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x ** g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          (Suc n)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n  open S\n\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S f 0;\n        higher_differentiable_on S g 0; open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x ** g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x ** g x) 0", "by (auto intro!: continuous_intros continuous_on)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. f x ** g x) 0\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x ** g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x ** g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on S ?f n; higher_differentiable_on S ?g n;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. ?f x ** ?g x) n\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  open S\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x ** g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          (Suc n)", "from Suc.prems"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  open S", "have\n    f: \"\\<And>x. x\\<in>S \\<Longrightarrow> f differentiable (at x)\"\n    and hf: \"higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v) n\"\n    and g: \"\\<And>x. x\\<in>S \\<Longrightarrow> g differentiable (at x)\"\n    and hg: \"higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v) n\"\n    for v"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  open S\n\ngoal (1 subgoal):\n 1. ((\\<And>x. x \\<in> S \\<Longrightarrow> f differentiable at x) &&&\n     higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v)\n      n) &&&\n    (\\<And>x. x \\<in> S \\<Longrightarrow> g differentiable at x) &&&\n    higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v) n", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) ?v) n\n  ?x \\<in> S \\<Longrightarrow> g differentiable at ?x\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) ?v) n\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    higher_differentiable_on S g n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. f x ** g x) n;\n        higher_differentiable_on S f (Suc n);\n        higher_differentiable_on S g (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. f x ** g x)\n                          (Suc n)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x ** g x) (Suc n)", "using f g \\<open>open S\\<close> Suc"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n  ?x \\<in> S \\<Longrightarrow> g differentiable at ?x\n  open S\n  \\<lbrakk>higher_differentiable_on S ?f n; higher_differentiable_on S ?g n;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. ?f x ** ?g x) n\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x ** g x) (Suc n)", "by (auto simp: frechet_derivative\n        intro!: derivative_intros f g differentiable higher_differentiable_on_add Suc.IH\n        intro: higher_differentiable_on_SucD\n        cong: higher_differentiable_on_cong)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. f x ** g x) (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "context begin"], ["", "private"], ["", "lemmas hdo = bounded_bilinear.higher_differentiable_on"], ["", "lemmas higher_differentiable_on_inner = bounded_bilinear_inner[THEN hdo]\n   and higher_differentiable_on_scaleR = bounded_bilinear_scaleR[THEN hdo]\n   and higher_differentiable_on_mult = bounded_bilinear_mult[THEN hdo]"], ["", "end"], ["", "lemma higher_differentiable_on_sum:\n  \"higher_differentiable_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x) n\"\n  if \"\\<And>i. i \\<in> F \\<Longrightarrow> finite F \\<Longrightarrow> higher_differentiable_on S (f i) n\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x) n", "using that"], ["proof (prove)\nusing this:\n  \\<lbrakk>?i \\<in> F; finite F\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (f ?i) n\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x) n", "by (induction F rule: infinite_finite_induct)\n    (auto intro!: higher_differentiable_on_const higher_differentiable_on_add)"], ["", "lemma higher_differentiable_on_subset:\n  \"higher_differentiable_on S f n\"\n  if \"higher_differentiable_on T f n\" \"S \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on T f n\n  S \\<subseteq> T\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by (induction n arbitrary: f) (auto intro: continuous_on_subset differentiable_on_subset)"], ["", "lemma higher_differentiable_on_compose:\n  \"higher_differentiable_on S (f o g) n\"\n  if \"higher_differentiable_on T f n\" \"higher_differentiable_on S g n\"  \"g ` S \\<subseteq> T\" \"open S\" \"open T\"\n  for g::\"_\\<Rightarrow>_::euclidean_space\"\\<comment>\\<open>TODO: can we get around this restriction?\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (f \\<circ> g) n", "using that(1-3)"], ["proof (prove)\nusing this:\n  higher_differentiable_on T f n\n  higher_differentiable_on S g n\n  g ` S \\<subseteq> T\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (f \\<circ> g) n", "proof (induction n arbitrary: f g)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on T f 0;\n        higher_differentiable_on S g 0; g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) 0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on T f n;\n                    higher_differentiable_on S g n;\n                    g ` S \\<subseteq> T\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(f \\<circ> g) n;\n        higher_differentiable_on T f (Suc n);\n        higher_differentiable_on S g (Suc n); g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) (Suc n)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on T f 0\n  higher_differentiable_on S g 0\n  g ` S \\<subseteq> T\n\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on T f 0;\n        higher_differentiable_on S g 0; g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) 0\n 2. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on T f n;\n                    higher_differentiable_on S g n;\n                    g ` S \\<subseteq> T\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(f \\<circ> g) n;\n        higher_differentiable_on T f (Suc n);\n        higher_differentiable_on S g (Suc n); g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on T f 0\n  higher_differentiable_on S g 0\n  g ` S \\<subseteq> T", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on T f 0\n  higher_differentiable_on S g 0\n  g ` S \\<subseteq> T\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (f \\<circ> g) 0", "using that(4-)"], ["proof (prove)\nusing this:\n  higher_differentiable_on T f 0\n  higher_differentiable_on S g 0\n  g ` S \\<subseteq> T\n  open S\n  open T\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (f \\<circ> g) 0", "by (auto simp: continuous_on_compose2)"], ["proof (state)\nthis:\n  higher_differentiable_on S (f \\<circ> g) 0\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on T f n;\n                    higher_differentiable_on S g n;\n                    g ` S \\<subseteq> T\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(f \\<circ> g) n;\n        higher_differentiable_on T f (Suc n);\n        higher_differentiable_on S g (Suc n); g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on T f n;\n                    higher_differentiable_on S g n;\n                    g ` S \\<subseteq> T\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(f \\<circ> g) n;\n        higher_differentiable_on T f (Suc n);\n        higher_differentiable_on S g (Suc n); g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on T ?f n; higher_differentiable_on S ?g n;\n   ?g ` S \\<subseteq> T\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (?f \\<circ> ?g) n\n  higher_differentiable_on T f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  g ` S \\<subseteq> T\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on T f n;\n                    higher_differentiable_on S g n;\n                    g ` S \\<subseteq> T\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(f \\<circ> g) n;\n        higher_differentiable_on T f (Suc n);\n        higher_differentiable_on S g (Suc n); g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) (Suc n)", "from Suc.prems"], ["proof (chain)\npicking this:\n  higher_differentiable_on T f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  g ` S \\<subseteq> T", "have\n    f: \"\\<And>x. x \\<in> T \\<Longrightarrow> f differentiable (at x)\"\n    and g: \"\\<And>x. x \\<in> S \\<Longrightarrow> g differentiable (at x)\"\n    and hf: \"higher_differentiable_on T (\\<lambda>x. frechet_derivative f (at x) v) n\"\n    and hg: \"higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) w) n\"\n    for v w"], ["proof (prove)\nusing this:\n  higher_differentiable_on T f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  g ` S \\<subseteq> T\n\ngoal (1 subgoal):\n 1. ((\\<And>x. x \\<in> T \\<Longrightarrow> f differentiable at x) &&&\n     (\\<And>x. x \\<in> S \\<Longrightarrow> g differentiable at x)) &&&\n    higher_differentiable_on T (\\<lambda>x. frechet_derivative f (at x) v)\n     n &&&\n    higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) w) n", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> T \\<Longrightarrow> f differentiable at ?x\n  ?x \\<in> S \\<Longrightarrow> g differentiable at ?x\n  higher_differentiable_on T (\\<lambda>x. frechet_derivative f (at x) ?v) n\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) ?w) n\n\ngoal (1 subgoal):\n 1. \\<And>n f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on T f n;\n                    higher_differentiable_on S g n;\n                    g ` S \\<subseteq> T\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(f \\<circ> g) n;\n        higher_differentiable_on T f (Suc n);\n        higher_differentiable_on S g (Suc n); g ` S \\<subseteq> T\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) (Suc n)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (f \\<circ> g) (Suc n)", "using \\<open>g ` _ \\<subseteq> _\\<close> \\<open>open S\\<close> f g \\<open>open T\\<close> Suc\n      Suc.IH[where f=\"\\<lambda>x. frechet_derivative f (at x) v\"\n        and g = \"\\<lambda>x. g x\" for v, unfolded o_def]\n      higher_differentiable_on_SucD[OF Suc.prems(2)]"], ["proof (prove)\nusing this:\n  g ` S \\<subseteq> T\n  open S\n  ?x \\<in> T \\<Longrightarrow> f differentiable at ?x\n  ?x \\<in> S \\<Longrightarrow> g differentiable at ?x\n  open T\n  \\<lbrakk>higher_differentiable_on T ?f n; higher_differentiable_on S ?g n;\n   ?g ` S \\<subseteq> T\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (?f \\<circ> ?g) n\n  higher_differentiable_on T f (Suc n)\n  higher_differentiable_on S g (Suc n)\n  g ` S \\<subseteq> T\n  \\<lbrakk>higher_differentiable_on T\n            (\\<lambda>a. frechet_derivative f (at a) ?v2) n;\n   higher_differentiable_on S g n; g ` S \\<subseteq> T\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S\n                     (\\<lambda>a. frechet_derivative f (at (g a)) ?v2) n\n  higher_differentiable_on S g n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (f \\<circ> g) (Suc n)", "by (auto\n        simp: frechet_derivative_compose_eucl subset_iff\n        simp del: o_apply\n        intro!: differentiable_chain_within higher_differentiable_on_sum\n          higher_differentiable_on_scaleR higher_differentiable_on_inner\n          higher_differentiable_on_const\n        intro: differentiable_at_withinI\n        cong: higher_differentiable_on_cong)"], ["proof (state)\nthis:\n  higher_differentiable_on S (f \\<circ> g) (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_differentiable_on_uminus:\n  \"higher_differentiable_on S (\\<lambda>x. - f x) n\"\n  if \"higher_differentiable_on S f n\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. - f x) n", "using higher_differentiable_on_scaleR[of S \"\\<lambda>x. -1\" n f] that"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S (\\<lambda>x. - 1) n;\n   higher_differentiable_on S f n; open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S\n                     (\\<lambda>x. - 1 *\\<^sub>R f x) n\n  higher_differentiable_on S f n\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. - f x) n", "by (auto simp: higher_differentiable_on_const)"], ["", "lemma higher_differentiable_on_minus:\n  \"higher_differentiable_on S (\\<lambda>x. f x - g x) n\"\n  if \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x - g x) n", "using higher_differentiable_on_add[OF _ higher_differentiable_on_uminus, OF that(1,2,3,3)]"], ["proof (prove)\nusing this:\n  higher_differentiable_on S (\\<lambda>x. f x + - g x) n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x - g x) n", "by simp"], ["", "lemma higher_differentiable_on_inverse:\n  \"higher_differentiable_on S (\\<lambda>x. inverse (f x)) n\"\n  if \"higher_differentiable_on S f n\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_\\<Rightarrow>_::real_normed_field\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. inverse (f x)) n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. inverse (f x)) n", "proof (induction n arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>higher_differentiable_on S f 0; (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) 0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. inverse (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) (Suc n)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>higher_differentiable_on S f 0; (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) 0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. inverse (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f 0\n  (0::'d) \\<notin> f ` S\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 0\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. inverse (f x)) 0", "by (auto simp: continuous_on_inverse)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. inverse (f x)) 0\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. inverse (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. inverse (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on S ?f n; (0::'d) \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. inverse (?f x))\n                     n\n  higher_differentiable_on S f (Suc n)\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. inverse (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) (Suc n)", "from Suc.prems(1)"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f (Suc n)", "have fn: \"higher_differentiable_on S f n\""], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by (rule higher_differentiable_on_SucD)"], ["proof (state)\nthis:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. inverse (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. inverse (f x)) (Suc n)", "from Suc"], ["proof (chain)\npicking this:\n  \\<lbrakk>higher_differentiable_on S ?f n; (0::'d) \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. inverse (?f x))\n                     n\n  higher_differentiable_on S f (Suc n)\n  (0::'d) \\<notin> f ` S\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S ?f n; (0::'d) \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. inverse (?f x))\n                     n\n  higher_differentiable_on S f (Suc n)\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. inverse (f x)) (Suc n)", "by (auto simp: continuous_on_inverse image_iff power2_eq_square\n        frechet_derivative_inverse divide_inverse\n        intro!: differentiable_inverse higher_differentiable_on_uminus higher_differentiable_on_mult\n          Suc.IH fn\n        cong: higher_differentiable_on_cong)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. inverse (f x)) (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_differentiable_on_divide:\n  \"higher_differentiable_on S (\\<lambda>x. f x / g x) n\"\n  if\n    \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S g n\"\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> g x \\<noteq> 0\"\n    \"open S\"\n  for f::\"_\\<Rightarrow>_::real_normed_field\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x / g x) n", "using higher_differentiable_on_mult[OF _ higher_differentiable_on_inverse, OF that(1,2) _ that(4,4)]\n    that(3)"], ["proof (prove)\nusing this:\n  (0::'d) \\<notin> g ` S \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. f x * inverse (g x)) n\n  ?x \\<in> S \\<Longrightarrow> g ?x \\<noteq> (0::'d)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f x / g x) n", "by (auto simp: divide_inverse image_iff)"], ["", "lemma differentiable_on_open_Union:\n  \"f differentiable_on \\<Union>S\"\n  if \"\\<And>s. s \\<in> S \\<Longrightarrow> f differentiable_on s\"\n    \"\\<And>s. s \\<in> S \\<Longrightarrow> open s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f differentiable_on \\<Union> S", "using that"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow> f differentiable_on ?s\n  ?s \\<in> S \\<Longrightarrow> open ?s\n\ngoal (1 subgoal):\n 1. f differentiable_on \\<Union> S", "unfolding differentiable_on_def"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow>\n  \\<forall>x\\<in>?s. f differentiable at x within ?s\n  ?s \\<in> S \\<Longrightarrow> open ?s\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>\\<Union> S. f differentiable at x within \\<Union> S", "by (metis Union_iff at_within_open open_Union)"], ["", "lemma higher_differentiable_on_open_Union: \"higher_differentiable_on (\\<Union>S) f n\"\n  if \"\\<And>s. s \\<in> S \\<Longrightarrow> higher_differentiable_on s f n\"\n    \"\\<And>s. s \\<in> S \\<Longrightarrow> open s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (\\<Union> S) f n", "using that"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow> higher_differentiable_on ?s f n\n  ?s \\<in> S \\<Longrightarrow> open ?s\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (\\<Union> S) f n", "proof (induction n arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>\\<And>s.\n                   s \\<in> S \\<Longrightarrow>\n                   higher_differentiable_on s f 0;\n        \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f 0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>s.\n                               s \\<in> S \\<Longrightarrow>\n                               higher_differentiable_on s f n;\n                    \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f\nn;\n        \\<And>s.\n           s \\<in> S \\<Longrightarrow> higher_differentiable_on s f (Suc n);\n        \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f (Suc n)", "case 0"], ["proof (state)\nthis:\n  ?s \\<in> S \\<Longrightarrow> higher_differentiable_on ?s f 0\n  ?s \\<in> S \\<Longrightarrow> open ?s\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>\\<And>s.\n                   s \\<in> S \\<Longrightarrow>\n                   higher_differentiable_on s f 0;\n        \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f 0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>s.\n                               s \\<in> S \\<Longrightarrow>\n                               higher_differentiable_on s f n;\n                    \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f\nn;\n        \\<And>s.\n           s \\<in> S \\<Longrightarrow> higher_differentiable_on s f (Suc n);\n        \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f (Suc n)", "then"], ["proof (chain)\npicking this:\n  ?s \\<in> S \\<Longrightarrow> higher_differentiable_on ?s f 0\n  ?s \\<in> S \\<Longrightarrow> open ?s", "show ?case"], ["proof (prove)\nusing this:\n  ?s \\<in> S \\<Longrightarrow> higher_differentiable_on ?s f 0\n  ?s \\<in> S \\<Longrightarrow> open ?s\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (\\<Union> S) f 0", "by (auto simp: continuous_on_open_Union)"], ["proof (state)\nthis:\n  higher_differentiable_on (\\<Union> S) f 0\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>s.\n                               s \\<in> S \\<Longrightarrow>\n                               higher_differentiable_on s f n;\n                    \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f\nn;\n        \\<And>s.\n           s \\<in> S \\<Longrightarrow> higher_differentiable_on s f (Suc n);\n        \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>s.\n                               s \\<in> S \\<Longrightarrow>\n                               higher_differentiable_on s f n;\n                    \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f\nn;\n        \\<And>s.\n           s \\<in> S \\<Longrightarrow> higher_differentiable_on s f (Suc n);\n        \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<And>s.\n              s \\<in> S \\<Longrightarrow> higher_differentiable_on s ?f n;\n   \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on (\\<Union> S) ?f n\n  ?s \\<in> S \\<Longrightarrow> higher_differentiable_on ?s f (Suc n)\n  ?s \\<in> S \\<Longrightarrow> open ?s\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>s.\n                               s \\<in> S \\<Longrightarrow>\n                               higher_differentiable_on s f n;\n                    \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f\nn;\n        \\<And>s.\n           s \\<in> S \\<Longrightarrow> higher_differentiable_on s f (Suc n);\n        \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on (\\<Union> S) f (Suc n)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>s.\n              s \\<in> S \\<Longrightarrow> higher_differentiable_on s ?f n;\n   \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on (\\<Union> S) ?f n\n  ?s \\<in> S \\<Longrightarrow> higher_differentiable_on ?s f (Suc n)\n  ?s \\<in> S \\<Longrightarrow> open ?s", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>s.\n              s \\<in> S \\<Longrightarrow> higher_differentiable_on s ?f n;\n   \\<And>s. s \\<in> S \\<Longrightarrow> open s\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on (\\<Union> S) ?f n\n  ?s \\<in> S \\<Longrightarrow> higher_differentiable_on ?s f (Suc n)\n  ?s \\<in> S \\<Longrightarrow> open ?s\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (\\<Union> S) f (Suc n)", "by (auto simp: differentiable_on_open_Union)"], ["proof (state)\nthis:\n  higher_differentiable_on (\\<Union> S) f (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma differentiable_on_open_Un:\n  \"f differentiable_on S \\<union> T\"\n  if \"f differentiable_on S\"\n    \"f differentiable_on T\"\n    \"open S\" \"open T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f differentiable_on S \\<union> T", "using that differentiable_on_open_Union[of \"{S, T}\" f]"], ["proof (prove)\nusing this:\n  f differentiable_on S\n  f differentiable_on T\n  open S\n  open T\n  \\<lbrakk>\\<And>s. s \\<in> {S, T} \\<Longrightarrow> f differentiable_on s;\n   \\<And>s. s \\<in> {S, T} \\<Longrightarrow> open s\\<rbrakk>\n  \\<Longrightarrow> f differentiable_on \\<Union> {S, T}\n\ngoal (1 subgoal):\n 1. f differentiable_on S \\<union> T", "by auto"], ["", "lemma higher_differentiable_on_open_Un: \"higher_differentiable_on (S \\<union> T) f n\"\n  if \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on T f n\"\n    \"open S\" \"open T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<union> T) f n", "using higher_differentiable_on_open_Union[of \"{S, T}\" f n] that"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>s.\n              s \\<in> {S, T} \\<Longrightarrow>\n              higher_differentiable_on s f n;\n   \\<And>s. s \\<in> {S, T} \\<Longrightarrow> open s\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on (\\<Union> {S, T}) f n\n  higher_differentiable_on S f n\n  higher_differentiable_on T f n\n  open S\n  open T\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<union> T) f n", "by auto"], ["", "lemma higher_differentiable_on_sqrt: \"higher_differentiable_on S (\\<lambda>x. sqrt (f x)) n\"\n  if \"higher_differentiable_on S f n\" \"0 \\<notin> f ` S\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sqrt (f x)) n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n  0 \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sqrt (f x)) n", "proof (induction n arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>higher_differentiable_on S f 0; 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n  0 \\<notin> f ` S\n  open S\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>higher_differentiable_on S f 0; 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f 0\n  0 \\<notin> f ` S\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 0\n  0 \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sqrt (f x)) 0", "by (auto simp: continuous_intros)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. sqrt (f x)) 0\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on S ?f n; 0 \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (?f x)) n\n  higher_differentiable_on S f (Suc n)\n  0 \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "from Suc.prems(1)"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f (Suc n)", "have fn: \"higher_differentiable_on S f n\""], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by (rule higher_differentiable_on_SucD)"], ["proof (state)\nthis:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f n", "have \"continuous_on S f\""], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. continuous_on S f", "by (rule higher_differentiable_on_imp_continuous_on)"], ["proof (state)\nthis:\n  continuous_on S f\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "with \\<open>open S\\<close>"], ["proof (chain)\npicking this:\n  open S\n  continuous_on S f", "have op: \"open (S \\<inter> f -` {0<..})\" (is \"open ?op\")"], ["proof (prove)\nusing this:\n  open S\n  continuous_on S f\n\ngoal (1 subgoal):\n 1. open (S \\<inter> f -` {0<..})", "by (rule open_continuous_vimage') simp"], ["proof (state)\nthis:\n  open (S \\<inter> f -` {0<..})\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "from \\<open>open S\\<close> \\<open>continuous_on S f\\<close>"], ["proof (chain)\npicking this:\n  open S\n  continuous_on S f", "have on: \"open (S \\<inter> f -` {..<0})\" (is \"open ?on\")"], ["proof (prove)\nusing this:\n  open S\n  continuous_on S f\n\ngoal (1 subgoal):\n 1. open (S \\<inter> f -` {..<0})", "by (rule open_continuous_vimage') simp"], ["proof (state)\nthis:\n  open (S \\<inter> f -` {..<0})\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "have op': \"higher_differentiable_on ?op (\\<lambda>x. 1) n\" and on': \"higher_differentiable_on ?on (\\<lambda>x. -1) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<inter> f -` {0<..}) (\\<lambda>x. 1::'b)\n     n &&&\n    higher_differentiable_on (S \\<inter> f -` {..<0})\n     (\\<lambda>x. - (1::'c)) n", "by (rule higher_differentiable_on_const)+"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<inter> f -` {0<..}) (\\<lambda>x. 1::?'b1) n\n  higher_differentiable_on (S \\<inter> f -` {..<0})\n   (\\<lambda>x. - (1::?'c1)) n\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on (S \\<inter> f -` {0<..}) (\\<lambda>x. 1::?'b1) n\n  higher_differentiable_on (S \\<inter> f -` {..<0})\n   (\\<lambda>x. - (1::?'c1)) n", "have i: \"higher_differentiable_on (?op \\<union> ?on) (\\<lambda>x. if 0 < f x then 1::real else - 1) n\""], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<inter> f -` {0<..}) (\\<lambda>x. 1::?'b1) n\n  higher_differentiable_on (S \\<inter> f -` {..<0})\n   (\\<lambda>x. - (1::?'c1)) n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on\n     (S \\<inter> f -` {0<..} \\<union> S \\<inter> f -` {..<0})\n     (\\<lambda>x. if 0 < f x then 1 else - 1) n", "by (auto intro!: higher_differentiable_on_open_Un op on\n          higher_differentiable_on_congI[OF _ op'] higher_differentiable_on_congI[OF _ on'])"], ["proof (state)\nthis:\n  higher_differentiable_on\n   (S \\<inter> f -` {0<..} \\<union> S \\<inter> f -` {..<0})\n   (\\<lambda>x. if 0 < f x then 1 else - 1) n\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "also"], ["proof (state)\nthis:\n  higher_differentiable_on\n   (S \\<inter> f -` {0<..} \\<union> S \\<inter> f -` {..<0})\n   (\\<lambda>x. if 0 < f x then 1 else - 1) n\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "have \"?op \\<union> ?on = S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<inter> f -` {0<..} \\<union> S \\<inter> f -` {..<0} = S", "using Suc"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S ?f n; 0 \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (?f x)) n\n  higher_differentiable_on S f (Suc n)\n  0 \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. S \\<inter> f -` {0<..} \\<union> S \\<inter> f -` {..<0} = S", "by auto"], ["proof (state)\nthis:\n  S \\<inter> f -` {0<..} \\<union> S \\<inter> f -` {..<0} = S\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "finally"], ["proof (chain)\npicking this:\n  higher_differentiable_on S (\\<lambda>x. if 0 < f x then 1 else - 1) n", "have i: \"higher_differentiable_on S (\\<lambda>x. if 0 < f x then 1::real else - 1) n\""], ["proof (prove)\nusing this:\n  higher_differentiable_on S (\\<lambda>x. if 0 < f x then 1 else - 1) n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. if 0 < f x then 1 else - 1) n", "."], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. if 0 < f x then 1 else - 1) n\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    0 \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. sqrt (f x)) n;\n        higher_differentiable_on S f (Suc n); 0 \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (f x))\n                          (Suc n)", "from fn i Suc"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f n\n  higher_differentiable_on S (\\<lambda>x. if 0 < f x then 1 else - 1) n\n  \\<lbrakk>higher_differentiable_on S ?f n; 0 \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (?f x)) n\n  higher_differentiable_on S f (Suc n)\n  0 \\<notin> f ` S\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n  higher_differentiable_on S (\\<lambda>x. if 0 < f x then 1 else - 1) n\n  \\<lbrakk>higher_differentiable_on S ?f n; 0 \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sqrt (?f x)) n\n  higher_differentiable_on S f (Suc n)\n  0 \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sqrt (f x)) (Suc n)", "by (auto simp: sqrt_differentiable_on image_iff frechet_derivative_sqrt\n        intro!: sqrt_differentiable higher_differentiable_on_mult higher_differentiable_on_inverse\n          higher_differentiable_on_divide higher_differentiable_on_const\n        cong: higher_differentiable_on_cong)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. sqrt (f x)) (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_differentiable_on_frechet_derivativeI:\n  \"higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h) i\"\n  if \"higher_differentiable_on X f (Suc i)\" \"open X\" \"x \\<in> X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h) i", "using that(1)"], ["proof (prove)\nusing this:\n  higher_differentiable_on X f (Suc i)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h) i", "by (induction i arbitrary: f h) auto"], ["", "lemma higher_differentiable_on_norm:\n  \"higher_differentiable_on S (\\<lambda>x. norm (f x)) n\"\n  if \"higher_differentiable_on S f n\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_\\<Rightarrow>_::real_inner\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. norm (f x)) n", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. norm (f x)) n", "proof (induction n arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>higher_differentiable_on S f 0; (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. norm (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          (Suc n)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>higher_differentiable_on S f 0; (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          0\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. norm (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f 0\n  (0::'d) \\<notin> f ` S\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 0\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. norm (f x)) 0", "by (auto simp: continuous_on_norm)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. norm (f x)) 0\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. norm (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. norm (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on S ?f n; (0::'d) \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (?f x)) n\n  higher_differentiable_on S f (Suc n)\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. norm (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          (Suc n)", "from Suc.prems(1)"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f (Suc n)", "have fn: \"higher_differentiable_on S f n\""], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by (rule higher_differentiable_on_SucD)"], ["proof (state)\nthis:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>higher_differentiable_on S f n;\n                    (0::'d) \\<notin> f ` S; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. norm (f x)) n;\n        higher_differentiable_on S f (Suc n); (0::'d) \\<notin> f ` S;\n        open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (f x))\n                          (Suc n)", "from Suc"], ["proof (chain)\npicking this:\n  \\<lbrakk>higher_differentiable_on S ?f n; (0::'d) \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (?f x)) n\n  higher_differentiable_on S f (Suc n)\n  (0::'d) \\<notin> f ` S\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S ?f n; (0::'d) \\<notin> ?f ` S;\n   open S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. norm (?f x)) n\n  higher_differentiable_on S f (Suc n)\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. norm (f x)) (Suc n)", "by (auto simp: continuous_on_norm frechet_derivative_norm image_iff sgn_div_norm\n        cong: higher_differentiable_on_cong\n        intro!: differentiable_norm_compose_at higher_differentiable_on_inner\n          higher_differentiable_on_inverse\n          higher_differentiable_on_mult Suc.IH fn)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. norm (f x)) (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "declare higher_differentiable_on.simps [simp del]"], ["", "lemma higher_differentiable_on_Pair:\n  \"higher_differentiable_on S f k \\<Longrightarrow> higher_differentiable_on S g k \\<Longrightarrow>\n   higher_differentiable_on S (\\<lambda>x. (f x, g x)) k\"\n  if \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>higher_differentiable_on S f k;\n     higher_differentiable_on S g k\\<rbrakk>\n    \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x)) k", "proof (induction k arbitrary: f g)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S f 0;\n        higher_differentiable_on S g 0\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x))\n                          0\n 2. \\<And>k f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f k;\n                    higher_differentiable_on S g k\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. (f x, g x)) k;\n        higher_differentiable_on S f (Suc k);\n        higher_differentiable_on S g (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x))\n                          (Suc k)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n\ngoal (2 subgoals):\n 1. \\<And>f g.\n       \\<lbrakk>higher_differentiable_on S f 0;\n        higher_differentiable_on S g 0\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x))\n                          0\n 2. \\<And>k f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f k;\n                    higher_differentiable_on S g k\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. (f x, g x)) k;\n        higher_differentiable_on S f (Suc k);\n        higher_differentiable_on S g (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x))\n                          (Suc k)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 0\n  higher_differentiable_on S g 0\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. (f x, g x)) 0", "unfolding higher_differentiable_on.simps"], ["proof (prove)\nusing this:\n  continuous_on S f\n  continuous_on S g\n\ngoal (1 subgoal):\n 1. continuous_on S (\\<lambda>x. (f x, g x))", "by (auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. (f x, g x)) 0\n\ngoal (1 subgoal):\n 1. \\<And>k f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f k;\n                    higher_differentiable_on S g k\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. (f x, g x)) k;\n        higher_differentiable_on S f (Suc k);\n        higher_differentiable_on S g (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x))\n                          (Suc k)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f k;\n                    higher_differentiable_on S g k\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. (f x, g x)) k;\n        higher_differentiable_on S f (Suc k);\n        higher_differentiable_on S g (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x))\n                          (Suc k)", "case (Suc k)"], ["proof (state)\nthis:\n  \\<lbrakk>higher_differentiable_on S ?f k;\n   higher_differentiable_on S ?g k\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (?f x, ?g x)) k\n  higher_differentiable_on S f (Suc k)\n  higher_differentiable_on S g (Suc k)\n\ngoal (1 subgoal):\n 1. \\<And>k f g.\n       \\<lbrakk>\\<And>f g.\n                   \\<lbrakk>higher_differentiable_on S f k;\n                    higher_differentiable_on S g k\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S\n(\\<lambda>x. (f x, g x)) k;\n        higher_differentiable_on S f (Suc k);\n        higher_differentiable_on S g (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (f x, g x))\n                          (Suc k)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>higher_differentiable_on S ?f k;\n   higher_differentiable_on S ?g k\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (?f x, ?g x)) k\n  higher_differentiable_on S f (Suc k)\n  higher_differentiable_on S g (Suc k)", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S ?f k;\n   higher_differentiable_on S ?g k\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (?f x, ?g x)) k\n  higher_differentiable_on S f (Suc k)\n  higher_differentiable_on S g (Suc k)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. (f x, g x)) (Suc k)", "using that"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S ?f k;\n   higher_differentiable_on S ?g k\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (?f x, ?g x)) k\n  higher_differentiable_on S f (Suc k)\n  higher_differentiable_on S g (Suc k)\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. (f x, g x)) (Suc k)", "unfolding higher_differentiable_on.simps"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on S ?f k;\n   higher_differentiable_on S ?g k\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. (?f x, ?g x)) k\n  (\\<forall>x\\<in>S. f differentiable at x) \\<and>\n  (\\<forall>v.\n      higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v)\n       k)\n  (\\<forall>x\\<in>S. g differentiable at x) \\<and>\n  (\\<forall>v.\n      higher_differentiable_on S (\\<lambda>x. frechet_derivative g (at x) v)\n       k)\n  open S\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>S. (\\<lambda>x. (f x, g x)) differentiable at x) \\<and>\n    (\\<forall>v.\n        higher_differentiable_on S\n         (\\<lambda>x. frechet_derivative (\\<lambda>x. (f x, g x)) (at x) v)\n         k)", "by (auto simp: frechet_derivative_pair[of f _ g] cong: higher_differentiable_on_cong)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. (f x, g x)) (Suc k)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_differentiable_on_compose':\n  \"higher_differentiable_on S (\\<lambda>x. f (g x)) n\"\n  if \"higher_differentiable_on T f n\" \"higher_differentiable_on S g n\"  \"g ` S \\<subseteq> T\" \"open S\" \"open T\"\n  for g::\"_\\<Rightarrow>_::euclidean_space\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f (g x)) n", "using higher_differentiable_on_compose[of T f n S g] comp_def that"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on T f n; higher_differentiable_on S g n;\n   g ` S \\<subseteq> T; open S; open T\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S (f \\<circ> g) n\n  ?f \\<circ> ?g = (\\<lambda>x. ?f (?g x))\n  higher_differentiable_on T f n\n  higher_differentiable_on S g n\n  g ` S \\<subseteq> T\n  open S\n  open T\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. f (g x)) n", "by (metis (no_types, lifting) higher_differentiable_on_cong)"], ["", "lemma higher_differentiable_on_fst:\n  \"higher_differentiable_on (S \\<times> T) fst k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> T) fst k", "proof (induction k)"], ["proof (state)\ngoal (2 subgoals):\n 1. higher_differentiable_on (S \\<times> T) fst 0\n 2. \\<And>k.\n       higher_differentiable_on (S \\<times> T) fst k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T) fst (Suc k)", "case (Suc k)"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<times> T) fst k\n\ngoal (2 subgoals):\n 1. higher_differentiable_on (S \\<times> T) fst 0\n 2. \\<And>k.\n       higher_differentiable_on (S \\<times> T) fst k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T) fst (Suc k)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on (S \\<times> T) fst k", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> T) fst k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> T) fst (Suc k)", "unfolding higher_differentiable_on.simps"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> T) fst k\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>S \\<times> T. fst differentiable at x) \\<and>\n    (\\<forall>v.\n        higher_differentiable_on (S \\<times> T)\n         (\\<lambda>x. frechet_derivative fst (at x) v) k)", "by (auto simp: differentiable_at_fst frechet_derivative_fst frechet_derivative_id higher_differentiable_on_const)"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<times> T) fst (Suc k)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> T) fst 0", "qed (auto simp: higher_differentiable_on.simps continuous_on_fst)"], ["", "lemma higher_differentiable_on_snd:\n  \"higher_differentiable_on (S \\<times> T) snd k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> T) snd k", "proof (induction k)"], ["proof (state)\ngoal (2 subgoals):\n 1. higher_differentiable_on (S \\<times> T) snd 0\n 2. \\<And>k.\n       higher_differentiable_on (S \\<times> T) snd k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T) snd (Suc k)", "case (Suc k)"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<times> T) snd k\n\ngoal (2 subgoals):\n 1. higher_differentiable_on (S \\<times> T) snd 0\n 2. \\<And>k.\n       higher_differentiable_on (S \\<times> T) snd k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T) snd (Suc k)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on (S \\<times> T) snd k", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> T) snd k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> T) snd (Suc k)", "unfolding higher_differentiable_on.simps"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> T) snd k\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>S \\<times> T. snd differentiable at x) \\<and>\n    (\\<forall>v.\n        higher_differentiable_on (S \\<times> T)\n         (\\<lambda>x. frechet_derivative snd (at x) v) k)", "by (auto intro!: continuous_intros\n        simp: differentiable_at_snd frechet_derivative_snd frechet_derivative_id higher_differentiable_on_const)"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<times> T) snd (Suc k)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> T) snd 0", "qed (auto simp: higher_differentiable_on.simps continuous_on_snd)"], ["", "lemma higher_differentiable_on_fst_comp:\n  \"higher_differentiable_on S (\\<lambda>x. fst (f x)) k\"\n  if \"higher_differentiable_on S f k\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. fst (f x)) k", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f k\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. fst (f x)) k", "by (induction k arbitrary: f)\n    (auto intro!: continuous_intros differentiable_at_fst\n      cong: higher_differentiable_on_cong\n      simp: higher_differentiable_on.simps frechet_derivative_fst)"], ["", "lemma higher_differentiable_on_snd_comp:\n  \"higher_differentiable_on S (\\<lambda>x. snd (f x)) k\"\n  if \"higher_differentiable_on S f k\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. snd (f x)) k", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f k\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. snd (f x)) k", "by (induction k arbitrary: f)\n    (auto intro!: continuous_intros differentiable_at_snd\n      cong: higher_differentiable_on_cong\n      simp: higher_differentiable_on.simps frechet_derivative_snd)"], ["", "lemma higher_differentiable_on_Pair':\n  \"higher_differentiable_on S f k \\<Longrightarrow> higher_differentiable_on T g k \\<Longrightarrow>\n   higher_differentiable_on (S \\<times> T) (\\<lambda>x. (f (fst x), g (snd x))) k\"\n  if S: \"open S\" and T: \"open T\"\n  for f::\"_::euclidean_space\\<Rightarrow>_\" and g::\"_::euclidean_space\\<Rightarrow>_\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>higher_differentiable_on S f k;\n     higher_differentiable_on T g k\\<rbrakk>\n    \\<Longrightarrow> higher_differentiable_on (S \\<times> T)\n                       (\\<lambda>x. (f (fst x), g (snd x))) k", "by (auto intro!: higher_differentiable_on_Pair open_Times S T\n      higher_differentiable_on_fst\n      higher_differentiable_on_snd\n      higher_differentiable_on_compose'[where f=f and T=S]\n      higher_differentiable_on_compose'[where f=g and T=T])"], ["", "lemma higher_differentiable_on_sin: \"higher_differentiable_on S (\\<lambda>x. sin (f x::real)) n\"\n  and higher_differentiable_on_cos: \"higher_differentiable_on S (\\<lambda>x. cos (f x::real)) n\"\n  if f: \"higher_differentiable_on S f n\" and S: \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sin (f x)) n &&&\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) n", "unfolding atomize_conj"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) n", "using f"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) n", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. higher_differentiable_on S f 0 \\<Longrightarrow>\n    higher_differentiable_on S (\\<lambda>x. sin (f x)) 0 \\<and>\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) 0\n 2. \\<And>n.\n       \\<lbrakk>higher_differentiable_on S f n \\<Longrightarrow>\n                higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n                higher_differentiable_on S (\\<lambda>x. cos (f x)) n;\n        higher_differentiable_on S f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sin (f x))\n                          (Suc n) \\<and>\n                         higher_differentiable_on S (\\<lambda>x. cos (f x))\n                          (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  higher_differentiable_on S f n \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  higher_differentiable_on S f (Suc n)\n\ngoal (2 subgoals):\n 1. higher_differentiable_on S f 0 \\<Longrightarrow>\n    higher_differentiable_on S (\\<lambda>x. sin (f x)) 0 \\<and>\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) 0\n 2. \\<And>n.\n       \\<lbrakk>higher_differentiable_on S f n \\<Longrightarrow>\n                higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n                higher_differentiable_on S (\\<lambda>x. cos (f x)) n;\n        higher_differentiable_on S f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sin (f x))\n                          (Suc n) \\<and>\n                         higher_differentiable_on S (\\<lambda>x. cos (f x))\n                          (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f n \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  higher_differentiable_on S f (Suc n)", "have \"higher_differentiable_on S f n\"\n    \"higher_differentiable_on S (\\<lambda>x. sin (f x)) n\"\n    \"higher_differentiable_on S (\\<lambda>x. cos (f x)) n\"\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> f differentiable at x\""], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  higher_differentiable_on S f (Suc n)\n\ngoal (1 subgoal):\n 1. (higher_differentiable_on S f n &&&\n     higher_differentiable_on S (\\<lambda>x. sin (f x)) n) &&&\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) n &&&\n    (\\<And>x. x \\<in> S \\<Longrightarrow> f differentiable at x)", "using higher_differentiable_on_SucD"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on ?S ?f (Suc ?n) \\<Longrightarrow>\n  higher_differentiable_on ?S ?f ?n\n\ngoal (1 subgoal):\n 1. (higher_differentiable_on S f n &&&\n     higher_differentiable_on S (\\<lambda>x. sin (f x)) n) &&&\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) n &&&\n    (\\<And>x. x \\<in> S \\<Longrightarrow> f differentiable at x)", "by (auto simp: higher_differentiable_on.simps)"], ["proof (state)\nthis:\n  higher_differentiable_on S f n\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n\ngoal (2 subgoals):\n 1. higher_differentiable_on S f 0 \\<Longrightarrow>\n    higher_differentiable_on S (\\<lambda>x. sin (f x)) 0 \\<and>\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) 0\n 2. \\<And>n.\n       \\<lbrakk>higher_differentiable_on S f n \\<Longrightarrow>\n                higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n                higher_differentiable_on S (\\<lambda>x. cos (f x)) n;\n        higher_differentiable_on S f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S (\\<lambda>x. sin (f x))\n                          (Suc n) \\<and>\n                         higher_differentiable_on S (\\<lambda>x. cos (f x))\n                          (Suc n)", "with Suc"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f n \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S f n\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n \\<and>\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  higher_differentiable_on S f (Suc n)\n  higher_differentiable_on S f n\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) n\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) n\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. sin (f x)) (Suc n) \\<and>\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) (Suc n)", "by (auto simp: higher_differentiable_on.simps sin_differentiable_at cos_differentiable_at\n        frechet_derivative_sin frechet_derivative_cos S\n        intro!: higher_differentiable_on_mult higher_differentiable_on_uminus\n        cong: higher_differentiable_on_cong[OF S])"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. sin (f x)) (Suc n) \\<and>\n  higher_differentiable_on S (\\<lambda>x. cos (f x)) (Suc n)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 0 \\<Longrightarrow>\n    higher_differentiable_on S (\\<lambda>x. sin (f x)) 0 \\<and>\n    higher_differentiable_on S (\\<lambda>x. cos (f x)) 0", "qed (auto simp: higher_differentiable_on.simps intro!: continuous_intros)"], ["", "subsection \\<open>Higher directional derivatives\\<close>"], ["", "primrec nth_derivative :: \"nat \\<Rightarrow> ('a::real_normed_vector \\<Rightarrow> 'b::real_normed_vector) \\<Rightarrow> 'a \\<Rightarrow> 'a \\<Rightarrow> 'b\" where\n  \"nth_derivative 0 f x h = f x\"\n| \"nth_derivative (Suc i) f x h = nth_derivative i (\\<lambda>x. frechet_derivative f (at x) h) x h\""], ["", "lemma frechet_derivative_nth_derivative_commute:\n  \"frechet_derivative (\\<lambda>x. nth_derivative i f x h) (at x) h =\n    nth_derivative i (\\<lambda>x. frechet_derivative f (at x) h) x h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. frechet_derivative (\\<lambda>x. nth_derivative i f x h) (at x) h =\n    nth_derivative i (\\<lambda>x. frechet_derivative f (at x) h) x h", "by (induction i arbitrary: f) auto"], ["", "lemma nth_derivative_funpow:\n  \"nth_derivative i f x h = ((\\<lambda>f x. frechet_derivative f (at x) h) ^^ i) f x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. nth_derivative i f x h =\n    ((\\<lambda>f x. frechet_derivative f (at x) h) ^^ i) f x", "by (induction i arbitrary: f) (auto simp del: funpow.simps simp: funpow_Suc_right)"], ["", "lemma nth_derivative_exists:\n  \"\\<exists>f'. ((\\<lambda>x. nth_derivative i f x h) has_derivative f') (at x) \\<and>\n    f' h = nth_derivative (Suc i) f x h\"\n  if \"higher_differentiable_on X f (Suc i)\" \"open X\" \"x \\<in> X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f'.\n       ((\\<lambda>x. nth_derivative i f x h) has_derivative f')\n        (at x) \\<and>\n       f' h = nth_derivative (Suc i) f x h", "using that(1)"], ["proof (prove)\nusing this:\n  higher_differentiable_on X f (Suc i)\n\ngoal (1 subgoal):\n 1. \\<exists>f'.\n       ((\\<lambda>x. nth_derivative i f x h) has_derivative f')\n        (at x) \\<and>\n       f' h = nth_derivative (Suc i) f x h", "proof (induction i arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       higher_differentiable_on X f (Suc 0) \\<Longrightarrow>\n       \\<exists>f'.\n          ((\\<lambda>x. nth_derivative 0 f x h) has_derivative f')\n           (at x) \\<and>\n          f' h = nth_derivative (Suc 0) f x h\n 2. \\<And>i f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on X f (Suc i) \\<Longrightarrow>\n                   \\<exists>f'.\n                      ((\\<lambda>x. nth_derivative i f x h) has_derivative\n                       f')\n                       (at x) \\<and>\n                      f' h = nth_derivative (Suc i) f x h;\n        higher_differentiable_on X f (Suc (Suc i))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f'.\n                            ((\\<lambda>x.\n                                 nth_derivative (Suc i) f x\n                                  h) has_derivative\n                             f')\n                             (at x) \\<and>\n                            f' h = nth_derivative (Suc (Suc i)) f x h", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on X f (Suc 0)\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       higher_differentiable_on X f (Suc 0) \\<Longrightarrow>\n       \\<exists>f'.\n          ((\\<lambda>x. nth_derivative 0 f x h) has_derivative f')\n           (at x) \\<and>\n          f' h = nth_derivative (Suc 0) f x h\n 2. \\<And>i f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on X f (Suc i) \\<Longrightarrow>\n                   \\<exists>f'.\n                      ((\\<lambda>x. nth_derivative i f x h) has_derivative\n                       f')\n                       (at x) \\<and>\n                      f' h = nth_derivative (Suc i) f x h;\n        higher_differentiable_on X f (Suc (Suc i))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f'.\n                            ((\\<lambda>x.\n                                 nth_derivative (Suc i) f x\n                                  h) has_derivative\n                             f')\n                             (at x) \\<and>\n                            f' h = nth_derivative (Suc (Suc i)) f x h", "with that"], ["proof (chain)\npicking this:\n  higher_differentiable_on X f (Suc i)\n  open X\n  x \\<in> X\n  higher_differentiable_on X f (Suc 0)", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on X f (Suc i)\n  open X\n  x \\<in> X\n  higher_differentiable_on X f (Suc 0)\n\ngoal (1 subgoal):\n 1. \\<exists>f'.\n       ((\\<lambda>x. nth_derivative 0 f x h) has_derivative f')\n        (at x) \\<and>\n       f' h = nth_derivative (Suc 0) f x h", "by (auto simp: higher_differentiable_on.simps that dest!: frechet_derivative_worksI)"], ["proof (state)\nthis:\n  \\<exists>f'.\n     ((\\<lambda>x. nth_derivative 0 f x h) has_derivative f') (at x) \\<and>\n     f' h = nth_derivative (Suc 0) f x h\n\ngoal (1 subgoal):\n 1. \\<And>i f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on X f (Suc i) \\<Longrightarrow>\n                   \\<exists>f'.\n                      ((\\<lambda>x. nth_derivative i f x h) has_derivative\n                       f')\n                       (at x) \\<and>\n                      f' h = nth_derivative (Suc i) f x h;\n        higher_differentiable_on X f (Suc (Suc i))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f'.\n                            ((\\<lambda>x.\n                                 nth_derivative (Suc i) f x\n                                  h) has_derivative\n                             f')\n                             (at x) \\<and>\n                            f' h = nth_derivative (Suc (Suc i)) f x h", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on X f (Suc i) \\<Longrightarrow>\n                   \\<exists>f'.\n                      ((\\<lambda>x. nth_derivative i f x h) has_derivative\n                       f')\n                       (at x) \\<and>\n                      f' h = nth_derivative (Suc i) f x h;\n        higher_differentiable_on X f (Suc (Suc i))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f'.\n                            ((\\<lambda>x.\n                                 nth_derivative (Suc i) f x\n                                  h) has_derivative\n                             f')\n                             (at x) \\<and>\n                            f' h = nth_derivative (Suc (Suc i)) f x h", "case (Suc i)"], ["proof (state)\nthis:\n  higher_differentiable_on X ?f (Suc i) \\<Longrightarrow>\n  \\<exists>f'.\n     ((\\<lambda>x. nth_derivative i ?f x h) has_derivative f') (at x) \\<and>\n     f' h = nth_derivative (Suc i) ?f x h\n  higher_differentiable_on X f (Suc (Suc i))\n\ngoal (1 subgoal):\n 1. \\<And>i f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on X f (Suc i) \\<Longrightarrow>\n                   \\<exists>f'.\n                      ((\\<lambda>x. nth_derivative i f x h) has_derivative\n                       f')\n                       (at x) \\<and>\n                      f' h = nth_derivative (Suc i) f x h;\n        higher_differentiable_on X f (Suc (Suc i))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f'.\n                            ((\\<lambda>x.\n                                 nth_derivative (Suc i) f x\n                                  h) has_derivative\n                             f')\n                             (at x) \\<and>\n                            f' h = nth_derivative (Suc (Suc i)) f x h", "from Suc.prems"], ["proof (chain)\npicking this:\n  higher_differentiable_on X f (Suc (Suc i))", "have \"\\<And>x. x \\<in> X \\<Longrightarrow> f differentiable at x\" \"higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h) (Suc i)\""], ["proof (prove)\nusing this:\n  higher_differentiable_on X f (Suc (Suc i))\n\ngoal (1 subgoal):\n 1. (\\<And>x. x \\<in> X \\<Longrightarrow> f differentiable at x) &&&\n    higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h)\n     (Suc i)", "unfolding higher_differentiable_on.simps(2)[where n = \"Suc i\"]"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>X. f differentiable at x) \\<and>\n  (\\<forall>v.\n      higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) v)\n       (Suc i))\n\ngoal (1 subgoal):\n 1. (\\<And>x. x \\<in> X \\<Longrightarrow> f differentiable at x) &&&\n    higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h)\n     (Suc i)", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> X \\<Longrightarrow> f differentiable at ?x\n  higher_differentiable_on X (\\<lambda>x. frechet_derivative f (at x) h)\n   (Suc i)\n\ngoal (1 subgoal):\n 1. \\<And>i f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on X f (Suc i) \\<Longrightarrow>\n                   \\<exists>f'.\n                      ((\\<lambda>x. nth_derivative i f x h) has_derivative\n                       f')\n                       (at x) \\<and>\n                      f' h = nth_derivative (Suc i) f x h;\n        higher_differentiable_on X f (Suc (Suc i))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f'.\n                            ((\\<lambda>x.\n                                 nth_derivative (Suc i) f x\n                                  h) has_derivative\n                             f')\n                             (at x) \\<and>\n                            f' h = nth_derivative (Suc (Suc i)) f x h", "from Suc.IH[OF this(2)]"], ["proof (chain)\npicking this:\n  \\<exists>f'.\n     ((\\<lambda>x.\n          nth_derivative i (\\<lambda>a. frechet_derivative f (at a) h) x\n           h) has_derivative\n      f')\n      (at x) \\<and>\n     f' h =\n     nth_derivative (Suc i) (\\<lambda>a. frechet_derivative f (at a) h) x h", "show ?case"], ["proof (prove)\nusing this:\n  \\<exists>f'.\n     ((\\<lambda>x.\n          nth_derivative i (\\<lambda>a. frechet_derivative f (at a) h) x\n           h) has_derivative\n      f')\n      (at x) \\<and>\n     f' h =\n     nth_derivative (Suc i) (\\<lambda>a. frechet_derivative f (at a) h) x h\n\ngoal (1 subgoal):\n 1. \\<exists>f'.\n       ((\\<lambda>x. nth_derivative (Suc i) f x h) has_derivative f')\n        (at x) \\<and>\n       f' h = nth_derivative (Suc (Suc i)) f x h", "by auto"], ["proof (state)\nthis:\n  \\<exists>f'.\n     ((\\<lambda>x. nth_derivative (Suc i) f x h) has_derivative f')\n      (at x) \\<and>\n     f' h = nth_derivative (Suc (Suc i)) f x h\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_derivatives_exists:\n  assumes \"higher_differentiable_on X f n\" \"open X\"\n  obtains Df where\n    \"\\<And>a h. Df a 0 h = f a\"\n    \"\\<And>a h i. i < n \\<Longrightarrow> a \\<in> X \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative Df a (Suc i)) (at a)\"\n    \"\\<And>a i. i \\<le> n \\<Longrightarrow> a \\<in> X \\<Longrightarrow> Df a i H = nth_derivative i f a H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"higher_differentiable_on X f (Suc i)\" if \"i < n\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on X f (Suc i)", "apply (rule higher_differentiable_on_le[OF assms(1)])"], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc i \\<le> n", "using that"], ["proof (prove)\nusing this:\n  i < n\n\ngoal (1 subgoal):\n 1. Suc i \\<le> n", "by simp"], ["proof (state)\nthis:\n  ?i < n \\<Longrightarrow> higher_differentiable_on X f (Suc ?i)\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from nth_derivative_exists[OF this assms(2)]"], ["proof (chain)\npicking this:\n  \\<lbrakk>?i < n; ?x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> \\<exists>f'.\n                       ((\\<lambda>x.\n                            nth_derivative ?i f x ?h) has_derivative\n                        f')\n                        (at ?x) \\<and>\n                       f' ?h = nth_derivative (Suc ?i) f ?x ?h", "have \"\\<forall>i\\<in>{..<n}. \\<forall>x \\<in> X. \\<exists>f'. ((\\<lambda>x. nth_derivative i f x H) has_derivative f') (at x) \\<and> f' H = nth_derivative (Suc i) f x H\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?i < n; ?x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> \\<exists>f'.\n                       ((\\<lambda>x.\n                            nth_derivative ?i f x ?h) has_derivative\n                        f')\n                        (at ?x) \\<and>\n                       f' ?h = nth_derivative (Suc ?i) f ?x ?h\n\ngoal (1 subgoal):\n 1. \\<forall>i\\<in>{..<n}.\n       \\<forall>x\\<in>X.\n          \\<exists>f'.\n             ((\\<lambda>x. nth_derivative i f x H) has_derivative f')\n              (at x) \\<and>\n             f' H = nth_derivative (Suc i) f x H", "by blast"], ["proof (state)\nthis:\n  \\<forall>i\\<in>{..<n}.\n     \\<forall>x\\<in>X.\n        \\<exists>f'.\n           ((\\<lambda>x. nth_derivative i f x H) has_derivative f')\n            (at x) \\<and>\n           f' H = nth_derivative (Suc i) f x H\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from this[unfolded bchoice_iff]"], ["proof (chain)\npicking this:\n  \\<exists>fa.\n     \\<forall>i\\<in>{..<n}.\n        \\<forall>x\\<in>X.\n           ((\\<lambda>x. nth_derivative i f x H) has_derivative fa i x)\n            (at x) \\<and>\n           fa i x H = nth_derivative (Suc i) f x H", "obtain f' where f': \"i < n \\<Longrightarrow> x \\<in> X \\<Longrightarrow> ((\\<lambda>x. nth_derivative i f x H) has_derivative f' x i) (at x)\"\n    \"i < n \\<Longrightarrow> x \\<in> X \\<Longrightarrow> f' x i H = nth_derivative (Suc i) f x H\" for x i"], ["proof (prove)\nusing this:\n  \\<exists>fa.\n     \\<forall>i\\<in>{..<n}.\n        \\<forall>x\\<in>X.\n           ((\\<lambda>x. nth_derivative i f x H) has_derivative fa i x)\n            (at x) \\<and>\n           fa i x H = nth_derivative (Suc i) f x H\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        \\<lbrakk>\\<And>x i.\n                    \\<lbrakk>i < n; x \\<in> X\\<rbrakk>\n                    \\<Longrightarrow> ((\\<lambda>x.\n     nth_derivative i f x H) has_derivative\n f' x i)\n (at x);\n         \\<And>x i.\n            \\<lbrakk>i < n; x \\<in> X\\<rbrakk>\n            \\<Longrightarrow> f' x i H =\n                              nth_derivative (Suc i) f x H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  \\<lbrakk>?i < n; ?x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. nth_derivative ?i f x H) has_derivative\n                     f' ?x ?i)\n                     (at ?x)\n  \\<lbrakk>?i < n; ?x \\<in> X\\<rbrakk>\n  \\<Longrightarrow> f' ?x ?i H = nth_derivative (Suc ?i) f ?x H\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define Df where \"Df a i h = (if i = 0 then f a else f' a (i - 1) h)\" for a i h"], ["proof (state)\nthis:\n  Df ?a ?i ?h = (if ?i = 0 then f ?a else f' ?a (?i - 1) ?h)\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"Df a 0 h = f a\" for a h"], ["proof (prove)\ngoal (1 subgoal):\n 1. Df a 0 h = f a", "by (auto simp: Df_def)"], ["proof (state)\nthis:\n  Df ?a 0 ?h = f ?a\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  Df ?a 0 ?h = f ?a\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"i < n \\<Longrightarrow> a \\<in> X \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative Df a (Suc i)) (at a)\"\n    for i a"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n    \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative Df a (Suc i))\n                       (at a)", "apply (auto simp: Df_def[abs_def])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n    \\<Longrightarrow> ((\\<lambda>a.\n                           if i = 0 then f a\n                           else f' a (i - 1) H) has_derivative\n                       f' a i)\n                       (at a)", "using _ \\<open>open X\\<close>"], ["proof (prove)\nusing this:\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  open X\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n    \\<Longrightarrow> ((\\<lambda>a.\n                           if i = 0 then f a\n                           else f' a (i - 1) H) has_derivative\n                       f' a i)\n                       (at a)", "apply (rule has_derivative_transform_within_open)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n    \\<Longrightarrow> (?f2 has_derivative f' a i) (at a)\n 2. \\<lbrakk>i < n; a \\<in> X\\<rbrakk> \\<Longrightarrow> a \\<in> X\n 3. \\<And>x.\n       \\<lbrakk>i < n; a \\<in> X; x \\<in> X\\<rbrakk>\n       \\<Longrightarrow> ?f2 x = (if i = 0 then f x else f' x (i - 1) H)", "apply (rule f')"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>i < n; a \\<in> X\\<rbrakk> \\<Longrightarrow> i < n\n 2. \\<lbrakk>i < n; a \\<in> X\\<rbrakk> \\<Longrightarrow> a \\<in> X\n 3. \\<lbrakk>i < n; a \\<in> X\\<rbrakk> \\<Longrightarrow> a \\<in> X\n 4. \\<And>x.\n       \\<lbrakk>i < n; a \\<in> X; x \\<in> X\\<rbrakk>\n       \\<Longrightarrow> nth_derivative i f x H =\n                         (if i = 0 then f x else f' x (i - 1) H)", "apply (auto simp: f')"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<lbrakk>?i < n; ?a \\<in> X\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>a. Df a ?i H) has_derivative Df ?a (Suc ?i))\n                     (at ?a)\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>?i < n; ?a \\<in> X\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>a. Df a ?i H) has_derivative Df ?a (Suc ?i))\n                     (at ?a)\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"i \\<le> n \\<Longrightarrow> a \\<in> X \\<Longrightarrow> Df a i H = nth_derivative i f a H\" for i a"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n    \\<Longrightarrow> Df a i H = nth_derivative i f a H", "by (auto simp: Df_def f')"], ["proof (state)\nthis:\n  \\<lbrakk>?i \\<le> n; ?a \\<in> X\\<rbrakk>\n  \\<Longrightarrow> Df ?a ?i H = nth_derivative ?i f ?a H\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> X\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  Df ?a 0 ?h = f ?a\n  \\<lbrakk>?i < n; ?a \\<in> X\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>a. Df a ?i H) has_derivative Df ?a (Suc ?i))\n                     (at ?a)\n  \\<lbrakk>?i \\<le> n; ?a \\<in> X\\<rbrakk>\n  \\<Longrightarrow> Df ?a ?i H = nth_derivative ?i f ?a H", "show ?thesis"], ["proof (prove)\nusing this:\n  Df ?a 0 ?h = f ?a\n  \\<lbrakk>?i < n; ?a \\<in> X\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>a. Df a ?i H) has_derivative Df ?a (Suc ?i))\n                     (at ?a)\n  \\<lbrakk>?i \\<le> n; ?a \\<in> X\\<rbrakk>\n  \\<Longrightarrow> Df ?a ?i H = nth_derivative ?i f ?a H\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma nth_derivative_differentiable:\n  assumes \"higher_differentiable_on S f (Suc n)\" \"x \\<in> S\"\n  shows \"(\\<lambda>x. nth_derivative n f x v) differentiable at x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. nth_derivative n f x v) differentiable at x", "using assms"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n  x \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. nth_derivative n f x v) differentiable at x", "by (induction n arbitrary: f) (auto simp: higher_differentiable_on.simps)"], ["", "lemma higher_differentiable_on_imp_continuous_nth_derivative:\n  assumes \"higher_differentiable_on S f n\"\n  shows \"continuous_on S (\\<lambda>x. nth_derivative n f x v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on S (\\<lambda>x. nth_derivative n f x v)", "using assms"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. continuous_on S (\\<lambda>x. nth_derivative n f x v)", "by (induction n arbitrary: f) (auto simp: higher_differentiable_on.simps)"], ["", "lemma frechet_derivative_at_real_eq_scaleR:\n  \"frechet_derivative f (at x) v = v *\\<^sub>R frechet_derivative f (at x) 1\"\n  if \"f differentiable (at x)\" \"NO_MATCH 1 v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. frechet_derivative f (at x) v =\n    v *\\<^sub>R frechet_derivative f (at x) 1", "by (simp add: frechet_derivative_eq_vector_derivative that)"], ["", "lemma higher_differentiable_on_real_Suc:\n  \"higher_differentiable_on S f (Suc n) \\<longleftrightarrow>\n     (\\<forall>x\\<in>S. f differentiable (at x)) \\<and>\n      (higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) 1) n)\"\n  if \"open S\"\n  for S::\"real set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n) =\n    ((\\<forall>x\\<in>S. f differentiable at x) \\<and>\n     higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) 1)\n      n)", "using \\<open>open S\\<close>"], ["proof (prove)\nusing this:\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n) =\n    ((\\<forall>x\\<in>S. f differentiable at x) \\<and>\n     higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) 1)\n      n)", "by (auto simp: higher_differentiable_on.simps frechet_derivative_at_real_eq_scaleR\n      intro!: higher_differentiable_on_scaleR higher_differentiable_on_const\n      cong: higher_differentiable_on_cong)"], ["", "lemma higher_differentiable_on_real_SucI:\n  fixes S::\"real set\"\n  assumes\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> (\\<lambda>x. nth_derivative n f x 1) differentiable at x\"\n    \"continuous_on S (\\<lambda>x. nth_derivative (Suc n) f x 1)\"\n    \"higher_differentiable_on S f n\"\n    and o: \"open S\"\n  shows \"higher_differentiable_on S f (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "using assms"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. nth_derivative n f x 1) differentiable at ?x\n  continuous_on S (\\<lambda>x. nth_derivative (Suc n) f x 1)\n  higher_differentiable_on S f n\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "proof (induction n arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> S \\<Longrightarrow>\n                   (\\<lambda>x. nth_derivative 0 f x 1) differentiable at x;\n        continuous_on S (\\<lambda>x. nth_derivative (Suc 0) f x 1);\n        higher_differentiable_on S f 0; open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc 0)\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>x.\n                               x \\<in> S \\<Longrightarrow>\n                               (\\<lambda>x.\n                                   nth_derivative n f x 1) differentiable\n                               at x;\n                    continuous_on S\n                     (\\<lambda>x. nth_derivative (Suc n) f x 1);\n                    higher_differentiable_on S f n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f (Suc n);\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           (\\<lambda>x. nth_derivative (Suc n) f x 1) differentiable at x;\n        continuous_on S (\\<lambda>x. nth_derivative (Suc (Suc n)) f x 1);\n        higher_differentiable_on S f (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc (Suc n))", "case 0"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. nth_derivative 0 f x 1) differentiable at ?x\n  continuous_on S (\\<lambda>x. nth_derivative (Suc 0) f x 1)\n  higher_differentiable_on S f 0\n  open S\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>\\<And>x.\n                   x \\<in> S \\<Longrightarrow>\n                   (\\<lambda>x. nth_derivative 0 f x 1) differentiable at x;\n        continuous_on S (\\<lambda>x. nth_derivative (Suc 0) f x 1);\n        higher_differentiable_on S f 0; open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc 0)\n 2. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>x.\n                               x \\<in> S \\<Longrightarrow>\n                               (\\<lambda>x.\n                                   nth_derivative n f x 1) differentiable\n                               at x;\n                    continuous_on S\n                     (\\<lambda>x. nth_derivative (Suc n) f x 1);\n                    higher_differentiable_on S f n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f (Suc n);\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           (\\<lambda>x. nth_derivative (Suc n) f x 1) differentiable at x;\n        continuous_on S (\\<lambda>x. nth_derivative (Suc (Suc n)) f x 1);\n        higher_differentiable_on S f (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc (Suc n))", "then"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. nth_derivative 0 f x 1) differentiable at ?x\n  continuous_on S (\\<lambda>x. nth_derivative (Suc 0) f x 1)\n  higher_differentiable_on S f 0\n  open S", "show ?case"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. nth_derivative 0 f x 1) differentiable at ?x\n  continuous_on S (\\<lambda>x. nth_derivative (Suc 0) f x 1)\n  higher_differentiable_on S f 0\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc 0)", "by (auto simp: higher_differentiable_on_real_Suc higher_differentiable_on.simps(1) o)"], ["proof (state)\nthis:\n  higher_differentiable_on S f (Suc 0)\n\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<And>f.\n                   \\<lbrakk>\\<And>x.\n                               x \\<in> S \\<Longrightarrow>\n                               (\\<lambda>x.\n                                   nth_derivative n f x 1) differentiable\n                               at x;\n                    continuous_on S\n                     (\\<lambda>x. nth_derivative (Suc n) f x 1);\n                    higher_differentiable_on S f n; open S\\<rbrakk>\n                   \\<Longrightarrow> higher_differentiable_on S f (Suc n);\n        \\<And>x.\n           x \\<in> S \\<Longrightarrow>\n           (\\<lambda>x. nth_derivative (Suc n) f x 1) differentiable at x;\n        continuous_on S (\\<lambda>x. nth_derivative (Suc (Suc n)) f x 1);\n        higher_differentiable_on S f (Suc n); open S\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S f (Suc (Suc n))", "qed (fastforce simp: higher_differentiable_on_real_Suc)"], ["", "lemma higher_differentiable_on_real_Suc':\n  \"open S \\<Longrightarrow> higher_differentiable_on S f (Suc n) \\<longleftrightarrow>\n    (\\<forall>v. continuous_on S (\\<lambda>x. nth_derivative (Suc n) f x 1)) \\<and>\n    (\\<forall>x\\<in>S. \\<forall>v. (\\<lambda>x. nth_derivative n f x 1) differentiable (at x)) \\<and> higher_differentiable_on S f n\"\n  for S::\"real set\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open S \\<Longrightarrow>\n    higher_differentiable_on S f (Suc n) =\n    ((\\<forall>v.\n         continuous_on S (\\<lambda>x. nth_derivative (Suc n) f x 1)) \\<and>\n     (\\<forall>x\\<in>S.\n         \\<forall>v.\n            (\\<lambda>x. nth_derivative n f x 1) differentiable at x) \\<and>\n     higher_differentiable_on S f n)", "apply (auto simp: nth_derivative_differentiable\n      dest: higher_differentiable_on_SucD\n      intro: higher_differentiable_on_real_SucI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>open S; higher_differentiable_on S f (Suc n)\\<rbrakk>\n    \\<Longrightarrow> continuous_on S\n                       (\\<lambda>x.\n                           nth_derivative n\n                            (\\<lambda>x. frechet_derivative f (at x) 1) x 1)", "by (auto simp: higher_differentiable_on_real_Suc higher_differentiable_on.simps(1)\n      higher_differentiable_on_imp_continuous_nth_derivative)"], ["", "lemma closed_segment_subsetD:\n  \"0 \\<le> x \\<Longrightarrow> x \\<le> 1 \\<Longrightarrow> (X + x *\\<^sub>R H) \\<in> S\"\n  if \"closed_segment X (X + H) \\<subseteq> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> X + x *\\<^sub>R H \\<in> S", "using that"], ["proof (prove)\nusing this:\n  closed_segment X (X + H) \\<subseteq> S\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> x; x \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> X + x *\\<^sub>R H \\<in> S", "by (rule subsetD) (auto simp: closed_segment_def algebra_simps intro!: exI[where x=x])"], ["", "lemma higher_differentiable_Taylor:\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n    and H::\"'a\"\n    and Df::\"'a \\<Rightarrow> nat \\<Rightarrow> 'a \\<Rightarrow> 'a \\<Rightarrow> 'b\"\n  assumes \"n > 0\"\n  assumes hd: \"higher_differentiable_on S f n\" \"open S\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> S\"\n  defines \"i \\<equiv> \\<lambda>x. ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R nth_derivative n f (X + x *\\<^sub>R H) H\"\n  shows \"(i has_integral f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H)) {0..1}\" (is ?th1)\n  and \"f (X + H) = (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) + integral {0..1} i\" (is ?th2)\n  and \"i integrable_on {0..1}\" (is ?th3)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n     {0..1} &&&\n    f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i &&&\n    i integrable_on {0..1}", "proof -"], ["proof (state)\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i\n 3. i integrable_on {0..1}", "from higher_derivatives_exists[OF hd]"], ["proof (chain)\npicking this:\n  (\\<And>Df.\n      \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n       \\<And>a h i.\n          \\<lbrakk>i < n; a \\<in> S\\<rbrakk>\n          \\<Longrightarrow> ((\\<lambda>a. Df a i ?H) has_derivative\n                             Df a (Suc i))\n                             (at a);\n       \\<And>a i.\n          \\<lbrakk>i \\<le> n; a \\<in> S\\<rbrakk>\n          \\<Longrightarrow> Df a i ?H = nth_derivative i f a ?H\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain Df where Df: \"(\\<And>a h. Df a 0 h = f a)\"\n    \"(\\<And>a h i. i < n \\<Longrightarrow> a \\<in> S \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative Df a (Suc i)) (at a))\"\n    \"\\<And>a i. i \\<le> n \\<Longrightarrow> a \\<in> S \\<Longrightarrow> Df a i H = nth_derivative i f a H\""], ["proof (prove)\nusing this:\n  (\\<And>Df.\n      \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n       \\<And>a h i.\n          \\<lbrakk>i < n; a \\<in> S\\<rbrakk>\n          \\<Longrightarrow> ((\\<lambda>a. Df a i ?H) has_derivative\n                             Df a (Suc i))\n                             (at a);\n       \\<And>a i.\n          \\<lbrakk>i \\<le> n; a \\<in> S\\<rbrakk>\n          \\<Longrightarrow> Df a i ?H = nth_derivative i f a ?H\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>Df.\n        \\<lbrakk>\\<And>a h. Df a 0 h = f a;\n         \\<And>a h i.\n            \\<lbrakk>i < n; a \\<in> S\\<rbrakk>\n            \\<Longrightarrow> ((\\<lambda>a. Df a i H) has_derivative\n                               Df a (Suc i))\n                               (at a);\n         \\<And>a i.\n            \\<lbrakk>i \\<le> n; a \\<in> S\\<rbrakk>\n            \\<Longrightarrow> Df a i H = nth_derivative i f a H\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  Df ?a1 0 ?h1 = f ?a1\n  \\<lbrakk>?i1 < n; ?a1 \\<in> S\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>a. Df a ?i1 H) has_derivative\n                     Df ?a1 (Suc ?i1))\n                     (at ?a1)\n  \\<lbrakk>?i1 \\<le> n; ?a1 \\<in> S\\<rbrakk>\n  \\<Longrightarrow> Df ?a1 ?i1 H = nth_derivative ?i1 f ?a1 H\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i\n 3. i integrable_on {0..1}", "from multivariate_Taylor_integral[OF \\<open>n > 0\\<close>, of Df H f X, OF Df(1,2)] cs"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>a i d.\n              \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n              \\<Longrightarrow> i < n;\n   \\<And>a i d.\n      \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n      \\<Longrightarrow> a \\<in> S;\n   closed_segment X (X + H) \\<subseteq> UNIV\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x.\n                         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n                         Df (X + x *\\<^sub>R H) n H) has_integral\n                     f (X + H) -\n                     (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n                     {0..1}\n  \\<lbrakk>\\<And>a i d.\n              \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n              \\<Longrightarrow> i < n;\n   \\<And>a i d.\n      \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n      \\<Longrightarrow> a \\<in> S;\n   closed_segment X (X + H) \\<subseteq> UNIV\\<rbrakk>\n  \\<Longrightarrow> f (X + H) =\n                    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) +\n                    integral {0..1}\n                     (\\<lambda>x.\n                         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n                         Df (X + x *\\<^sub>R H) n H)\n  \\<lbrakk>\\<And>a i d.\n              \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n              \\<Longrightarrow> i < n;\n   \\<And>a i d.\n      \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n      \\<Longrightarrow> a \\<in> S;\n   closed_segment X (X + H) \\<subseteq> UNIV\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>x.\n                        ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n                        Df (X + x *\\<^sub>R H) n H) integrable_on\n                    {0..1}\n  closed_segment X (X + H) \\<subseteq> S", "have mt: \"((\\<lambda>x. ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R Df (X + x *\\<^sub>R H) n H) has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>a i d.\n              \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n              \\<Longrightarrow> i < n;\n   \\<And>a i d.\n      \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n      \\<Longrightarrow> a \\<in> S;\n   closed_segment X (X + H) \\<subseteq> UNIV\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x.\n                         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n                         Df (X + x *\\<^sub>R H) n H) has_integral\n                     f (X + H) -\n                     (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n                     {0..1}\n  \\<lbrakk>\\<And>a i d.\n              \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n              \\<Longrightarrow> i < n;\n   \\<And>a i d.\n      \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n      \\<Longrightarrow> a \\<in> S;\n   closed_segment X (X + H) \\<subseteq> UNIV\\<rbrakk>\n  \\<Longrightarrow> f (X + H) =\n                    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H) +\n                    integral {0..1}\n                     (\\<lambda>x.\n                         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n                         Df (X + x *\\<^sub>R H) n H)\n  \\<lbrakk>\\<And>a i d.\n              \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n              \\<Longrightarrow> i < n;\n   \\<And>a i d.\n      \\<lbrakk>a \\<in> closed_segment X (X + H); i < n\\<rbrakk>\n      \\<Longrightarrow> a \\<in> S;\n   closed_segment X (X + H) \\<subseteq> UNIV\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>x.\n                        ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n                        Df (X + x *\\<^sub>R H) n H) integrable_on\n                    {0..1}\n  closed_segment X (X + H) \\<subseteq> S\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n         Df (X + x *\\<^sub>R H) n H) has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n     {0..1}", "by force"], ["proof (state)\nthis:\n  ((\\<lambda>x.\n       ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n       Df (X + x *\\<^sub>R H) n H) has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n   {0..1}\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i\n 3. i integrable_on {0..1}", "from cs"], ["proof (chain)\npicking this:\n  closed_segment X (X + H) \\<subseteq> S", "have \"X \\<in> S\""], ["proof (prove)\nusing this:\n  closed_segment X (X + H) \\<subseteq> S\n\ngoal (1 subgoal):\n 1. X \\<in> S", "by auto"], ["proof (state)\nthis:\n  X \\<in> S\n\ngoal (3 subgoals):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n     {0..1}\n 2. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i\n 3. i integrable_on {0..1}", "show ?th1"], ["proof (prove)\ngoal (1 subgoal):\n 1. (i has_integral\n     f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n     {0..1}", "apply (rule has_integral_eq_rhs)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (i has_integral ?j) {0..1}\n 2. f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) =\n    ?j", "unfolding i_def"], ["proof (prove)\ngoal (2 subgoals):\n 1. ((\\<lambda>x.\n         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n         nth_derivative n f (X + x *\\<^sub>R H) H) has_integral\n     ?j)\n     {0..1}\n 2. f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) =\n    ?j", "using negligible_empty _ mt"], ["proof (prove)\nusing this:\n  negligible {}\n  PROP ?psi \\<Longrightarrow> PROP ?psi\n  ((\\<lambda>x.\n       ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n       Df (X + x *\\<^sub>R H) n H) has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H))\n   {0..1}\n\ngoal (2 subgoals):\n 1. ((\\<lambda>x.\n         ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n         nth_derivative n f (X + x *\\<^sub>R H) H) has_integral\n     ?j)\n     {0..1}\n 2. f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) =\n    ?j", "apply (rule has_integral_spike)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> {0..1} - {} \\<Longrightarrow>\n       ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n       nth_derivative n f (X + x *\\<^sub>R H) H =\n       ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n       Df (X + x *\\<^sub>R H) n H\n 2. f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) =\n    f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H)", "using closed_segment_subsetD[OF cs]"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?x; ?x \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> X + ?x *\\<^sub>R H \\<in> S\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> {0..1} - {} \\<Longrightarrow>\n       ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n       nth_derivative n f (X + x *\\<^sub>R H) H =\n       ((1 - x) ^ (n - 1) / fact (n - 1)) *\\<^sub>R\n       Df (X + x *\\<^sub>R H) n H\n 2. f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) =\n    f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R Df X i H)", "by (auto simp: Df \\<open>X \\<in> S\\<close>)"], ["proof (state)\nthis:\n  (i has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n   {0..1}\n\ngoal (2 subgoals):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i\n 2. i integrable_on {0..1}", "then"], ["proof (chain)\npicking this:\n  (i has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n   {0..1}", "show ?th2 ?th3"], ["proof (prove)\nusing this:\n  (i has_integral\n   f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n   {0..1}\n\ngoal (1 subgoal):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i &&&\n    i integrable_on {0..1}", "unfolding has_integral_iff"], ["proof (prove)\nusing this:\n  i integrable_on {0..1} \\<and>\n  integral {0..1} i =\n  f (X + H) - (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H)\n\ngoal (1 subgoal):\n 1. f (X + H) =\n    (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n    integral {0..1} i &&&\n    i integrable_on {0..1}", "by auto"], ["proof (state)\nthis:\n  f (X + H) =\n  (\\<Sum>i<n. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n  integral {0..1} i\n  i integrable_on {0..1}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma frechet_derivative_componentwise:\n  \"frechet_derivative f (at a) v = (\\<Sum>i\\<in>Basis. (v \\<bullet> i) * (frechet_derivative f (at a) i))\"\n  if \"f differentiable at a\"\n  for f::\"'a::euclidean_space \\<Rightarrow> real\""], ["proof (prove)\ngoal (1 subgoal):\n 1. frechet_derivative f (at a) v =\n    (\\<Sum>i\\<in>Basis. v \\<bullet> i * frechet_derivative f (at a) i)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. frechet_derivative f (at a) v =\n    (\\<Sum>i\\<in>Basis. v \\<bullet> i * frechet_derivative f (at a) i)", "have \"linear (frechet_derivative f (at a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. linear (frechet_derivative f (at a))", "using that"], ["proof (prove)\nusing this:\n  f differentiable at a\n\ngoal (1 subgoal):\n 1. linear (frechet_derivative f (at a))", "by (rule linear_frechet_derivative)"], ["proof (state)\nthis:\n  linear (frechet_derivative f (at a))\n\ngoal (1 subgoal):\n 1. frechet_derivative f (at a) v =\n    (\\<Sum>i\\<in>Basis. v \\<bullet> i * frechet_derivative f (at a) i)", "from Linear_Algebra.linear_componentwise[OF this, of v 1]"], ["proof (chain)\npicking this:\n  frechet_derivative f (at a) v \\<bullet> 1 =\n  (\\<Sum>i\\<in>Basis.\n     v \\<bullet> i * (frechet_derivative f (at a) i \\<bullet> 1))", "show ?thesis"], ["proof (prove)\nusing this:\n  frechet_derivative f (at a) v \\<bullet> 1 =\n  (\\<Sum>i\\<in>Basis.\n     v \\<bullet> i * (frechet_derivative f (at a) i \\<bullet> 1))\n\ngoal (1 subgoal):\n 1. frechet_derivative f (at a) v =\n    (\\<Sum>i\\<in>Basis. v \\<bullet> i * frechet_derivative f (at a) i)", "by simp"], ["proof (state)\nthis:\n  frechet_derivative f (at a) v =\n  (\\<Sum>i\\<in>Basis. v \\<bullet> i * frechet_derivative f (at a) i)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma second_derivative_componentwise:\n  \"nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis. (\\<Sum>j\\<in>Basis. frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j) (at a) i * (v \\<bullet> j)) * (v \\<bullet> i))\"\n  if \"higher_differentiable_on S f 2\" and S: \"open S\" \"a \\<in> S\"\n  for f::\"'a::euclidean_space \\<Rightarrow> real\""], ["proof (prove)\ngoal (1 subgoal):\n 1. nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "have diff: \"(\\<lambda>x. frechet_derivative f (at x) v) differentiable at a\" for v"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x. frechet_derivative f (at x) v) differentiable at a", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 2\n  open S\n  a \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. frechet_derivative f (at x) v) differentiable at a", "by (auto simp: numeral_2_eq_2 higher_differentiable_on.simps differentiable_on_openD\n        dest!: spec[where x=v])"], ["proof (state)\nthis:\n  (\\<lambda>x. frechet_derivative f (at x) ?v) differentiable at a\n\ngoal (1 subgoal):\n 1. nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "have d1: \"x \\<in> S \\<Longrightarrow> f differentiable at x\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> S \\<Longrightarrow> f differentiable at x", "using that"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 2\n  open S\n  a \\<in> S\n\ngoal (1 subgoal):\n 1. x \\<in> S \\<Longrightarrow> f differentiable at x", "by (auto simp: numeral_2_eq_2 higher_differentiable_on.simps dest!: differentiable_on_openD)"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow> f differentiable at ?x\n\ngoal (1 subgoal):\n 1. nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "have eq: \"\\<And>x. x \\<in> Basis \\<Longrightarrow>\n         frechet_derivative\n          (\\<lambda>x. \\<Sum>i\\<in>Basis. v \\<bullet> i * frechet_derivative f (at x) i) (at a) x =\n         (\\<Sum>j\\<in>Basis. frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j) (at a) x * (v \\<bullet> j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       frechet_derivative\n        (\\<lambda>x.\n            \\<Sum>i\\<in>Basis.\n              v \\<bullet> i * frechet_derivative f (at x) i)\n        (at a) x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (subst frechet_derivative_sum)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x i.\n       \\<lbrakk>x \\<in> Basis; i \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x.\n                             v \\<bullet> i *\n                             frechet_derivative f (at x) i) differentiable\n                         at a\n 2. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       (\\<Sum>i\\<in>Basis.\n          frechet_derivative\n           (\\<lambda>x. v \\<bullet> i * frechet_derivative f (at x) i)\n           (at a) x) =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x_ \\<in> Basis; i_ \\<in> Basis\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x.\n                          v \\<bullet> i_ *\n                          frechet_derivative f (at x) i_) differentiable\n                      at a", "by (auto intro!: differentiable_mult diff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       (\\<Sum>i\\<in>Basis.\n          frechet_derivative\n           (\\<lambda>x. v \\<bullet> i * frechet_derivative f (at x) i)\n           (at a) x) =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (rule sum.cong)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> Basis \\<Longrightarrow> Basis = Basis\n 2. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> frechet_derivative\n                          (\\<lambda>x.\n                              v \\<bullet> xa *\n                              frechet_derivative f (at x) xa)\n                          (at a) x =\n                         frechet_derivative\n                          (\\<lambda>a. frechet_derivative f (at a) xa)\n                          (at a) x *\n                         (v \\<bullet> xa)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> frechet_derivative\n                          (\\<lambda>x.\n                              v \\<bullet> xa *\n                              frechet_derivative f (at x) xa)\n                          (at a) x =\n                         frechet_derivative\n                          (\\<lambda>a. frechet_derivative f (at a) xa)\n                          (at a) x *\n                         (v \\<bullet> xa)", "apply (subst frechet_derivative_times)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x. v \\<bullet> xa) differentiable at a\n 2. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x.\n                             frechet_derivative f (at x) xa) differentiable\n                         at a\n 3. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> v \\<bullet> xa *\n                         frechet_derivative\n                          (\\<lambda>x. frechet_derivative f (at x) xa)\n                          (at a) x +\n                         frechet_derivative (\\<lambda>x. v \\<bullet> xa)\n                          (at a) x *\n                         frechet_derivative f (at a) xa =\n                         frechet_derivative\n                          (\\<lambda>a. frechet_derivative f (at a) xa)\n                          (at a) x *\n                         (v \\<bullet> xa)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x_ \\<in> Basis; xa_ \\<in> Basis\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x. v \\<bullet> xa_) differentiable at a", "by simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x.\n                             frechet_derivative f (at x) xa) differentiable\n                         at a\n 2. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> v \\<bullet> xa *\n                         frechet_derivative\n                          (\\<lambda>x. frechet_derivative f (at x) xa)\n                          (at a) x +\n                         frechet_derivative (\\<lambda>x. v \\<bullet> xa)\n                          (at a) x *\n                         frechet_derivative f (at a) xa =\n                         frechet_derivative\n                          (\\<lambda>a. frechet_derivative f (at a) xa)\n                          (at a) x *\n                         (v \\<bullet> xa)", "subgoal"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x_ \\<in> Basis; xa_ \\<in> Basis\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x.\n                          frechet_derivative f (at x) xa_) differentiable\n                      at a", "by (rule diff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> Basis\\<rbrakk>\n       \\<Longrightarrow> v \\<bullet> xa *\n                         frechet_derivative\n                          (\\<lambda>x. frechet_derivative f (at x) xa)\n                          (at a) x +\n                         frechet_derivative (\\<lambda>x. v \\<bullet> xa)\n                          (at a) x *\n                         frechet_derivative f (at a) xa =\n                         frechet_derivative\n                          (\\<lambda>a. frechet_derivative f (at a) xa)\n                          (at a) x *\n                         (v \\<bullet> xa)", "by (simp add: frechet_derivative_const)"], ["proof (state)\nthis:\n  ?x \\<in> Basis \\<Longrightarrow>\n  frechet_derivative\n   (\\<lambda>x.\n       \\<Sum>i\\<in>Basis. v \\<bullet> i * frechet_derivative f (at x) i)\n   (at a) ?x =\n  (\\<Sum>j\\<in>Basis.\n     frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j) (at a)\n      ?x *\n     (v \\<bullet> j))\n\ngoal (1 subgoal):\n 1. nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. nth_derivative 2 f a v =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "apply (simp add: numeral_2_eq_2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v) (at a)\n     v =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "apply (subst frechet_derivative_componentwise[OF diff])"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>Basis.\n       v \\<bullet> i *\n       frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v) (at a)\n        i) =\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) i *\n          (v \\<bullet> j)) *\n       (v \\<bullet> i))", "apply (rule sum.cong)"], ["proof (prove)\ngoal (2 subgoals):\n 1. Basis = Basis\n 2. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       v \\<bullet> x *\n       frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v) (at a)\n        x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j)) *\n       (v \\<bullet> x)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       v \\<bullet> x *\n       frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v) (at a)\n        x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j)) *\n       (v \\<bullet> x)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       v \\<bullet> x = 0 \\<or>\n       frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v) (at a)\n        x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (rule disjI2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v) (at a)\n        x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (rule trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v) (at a)\n        x =\n       ?s6 x\n 2. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       ?s6 x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (rule frechet_derivative_transform_within_open_ext [OF _ S frechet_derivative_componentwise])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       (\\<lambda>x. frechet_derivative f (at x) v) differentiable at a\n 2. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> S\\<rbrakk>\n       \\<Longrightarrow> f differentiable at xa\n 3. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       frechet_derivative\n        (\\<lambda>x.\n            \\<Sum>i\\<in>Basis.\n              v \\<bullet> i * frechet_derivative f (at x) i)\n        (at a) x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (simp add: diff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>x \\<in> Basis; xa \\<in> S\\<rbrakk>\n       \\<Longrightarrow> f differentiable at xa\n 2. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       frechet_derivative\n        (\\<lambda>x.\n            \\<Sum>i\\<in>Basis.\n              v \\<bullet> i * frechet_derivative f (at x) i)\n        (at a) x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (rule d1, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> Basis \\<Longrightarrow>\n       frechet_derivative\n        (\\<lambda>x.\n            \\<Sum>i\\<in>Basis.\n              v \\<bullet> i * frechet_derivative f (at x) i)\n        (at a) x =\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at a) x *\n          (v \\<bullet> j))", "apply (simp add: eq)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  nth_derivative 2 f a v =\n  (\\<Sum>i\\<in>Basis.\n     (\\<Sum>j\\<in>Basis.\n        frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n         (at a) i *\n        (v \\<bullet> j)) *\n     (v \\<bullet> i))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_differentiable_Taylor1:\n  fixes f::\"'a::real_normed_vector \\<Rightarrow> 'b::banach\"\n  assumes hd: \"higher_differentiable_on S f 2\" \"open S\"\n  assumes cs: \"closed_segment X (X + H) \\<subseteq> S\"\n  defines \"i \\<equiv> \\<lambda>x. ((1 - x)) *\\<^sub>R nth_derivative 2 f (X + x *\\<^sub>R H) H\"\n  shows \"(i has_integral f (X + H) - (f X + nth_derivative 1 f X H)) {0..1}\"\n    and \"f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} i\"\n    and \"i integrable_on {0..1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (i has_integral f (X + H) - (f X + nth_derivative 1 f X H)) {0..1} &&&\n    f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} i &&&\n    i integrable_on {0..1}", "using higher_differentiable_Taylor[OF _ hd cs]"], ["proof (prove)\nusing this:\n  0 < 2 \\<Longrightarrow>\n  ((\\<lambda>x.\n       ((1 - x) ^ (2 - 1) / fact (2 - 1)) *\\<^sub>R\n       nth_derivative 2 f (X + x *\\<^sub>R H) H) has_integral\n   f (X + H) - (\\<Sum>i<2. (1 / fact i) *\\<^sub>R nth_derivative i f X H))\n   {0..1}\n  0 < 2 \\<Longrightarrow>\n  f (X + H) =\n  (\\<Sum>i<2. (1 / fact i) *\\<^sub>R nth_derivative i f X H) +\n  integral {0..1}\n   (\\<lambda>x.\n       ((1 - x) ^ (2 - 1) / fact (2 - 1)) *\\<^sub>R\n       nth_derivative 2 f (X + x *\\<^sub>R H) H)\n  0 < 2 \\<Longrightarrow>\n  (\\<lambda>x.\n      ((1 - x) ^ (2 - 1) / fact (2 - 1)) *\\<^sub>R\n      nth_derivative 2 f (X + x *\\<^sub>R H) H) integrable_on\n  {0..1}\n\ngoal (1 subgoal):\n 1. (i has_integral f (X + H) - (f X + nth_derivative 1 f X H)) {0..1} &&&\n    f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} i &&&\n    i integrable_on {0..1}", "by (auto simp: numeral_2_eq_2 i_def)"], ["", "lemma differentiable_on_open_blinfunE:\n  assumes \"f differentiable_on S\" \"open S\"\n  obtains f' where \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative blinfun_apply (f' x)) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "assume \"x \\<in> S\""], ["proof (state)\nthis:\n  x \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "with assms"], ["proof (chain)\npicking this:\n  f differentiable_on S\n  open S\n  x \\<in> S", "obtain f' where f': \"(f has_derivative f') (at x)\""], ["proof (prove)\nusing this:\n  f differentiable_on S\n  open S\n  x \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (f has_derivative f') (at x) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (auto dest!: differentiable_on_openD simp: differentiable_def)"], ["proof (state)\nthis:\n  (f has_derivative f') (at x)\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  (f has_derivative f') (at x)", "have \"bounded_linear f'\""], ["proof (prove)\nusing this:\n  (f has_derivative f') (at x)\n\ngoal (1 subgoal):\n 1. bounded_linear f'", "by (rule has_derivative_bounded_linear)"], ["proof (state)\nthis:\n  bounded_linear f'\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  bounded_linear f'", "obtain bf' where \"f' = blinfun_apply bf'\""], ["proof (prove)\nusing this:\n  bounded_linear f'\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        f' = blinfun_apply bf' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis bounded_linear_Blinfun_apply)"], ["proof (state)\nthis:\n  f' = blinfun_apply bf'\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  f' = blinfun_apply bf'", "have \"\\<exists>bf'. (f has_derivative blinfun_apply bf') (at x)\""], ["proof (prove)\nusing this:\n  f' = blinfun_apply bf'\n\ngoal (1 subgoal):\n 1. \\<exists>bf'. (f has_derivative blinfun_apply bf') (at x)", "using f'"], ["proof (prove)\nusing this:\n  f' = blinfun_apply bf'\n  (f has_derivative f') (at x)\n\ngoal (1 subgoal):\n 1. \\<exists>bf'. (f has_derivative blinfun_apply bf') (at x)", "by blast"], ["proof (state)\nthis:\n  \\<exists>bf'. (f has_derivative blinfun_apply bf') (at x)\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "}"], ["proof (state)\nthis:\n  ?x2 \\<in> S \\<Longrightarrow>\n  \\<exists>bf'. (f has_derivative blinfun_apply bf') (at ?x2)\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  ?x2 \\<in> S \\<Longrightarrow>\n  \\<exists>bf'. (f has_derivative blinfun_apply bf') (at ?x2)", "obtain f' where \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative blinfun_apply (f' x)) (at x)\""], ["proof (prove)\nusing this:\n  ?x2 \\<in> S \\<Longrightarrow>\n  \\<exists>bf'. (f has_derivative blinfun_apply bf') (at ?x2)\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  (f has_derivative blinfun_apply (f' ?x)) (at ?x)\n\ngoal (1 subgoal):\n 1. (\\<And>f'.\n        (\\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            (f has_derivative blinfun_apply (f' x))\n             (at x)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow>\n  (f has_derivative blinfun_apply (f' ?x)) (at ?x)", "show ?thesis"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  (f has_derivative blinfun_apply (f' ?x)) (at ?x)\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma continuous_on_blinfunI1:\n  \"continuous_on X f\"\n  if \"\\<And>i. i \\<in> Basis \\<Longrightarrow> continuous_on X (\\<lambda>x. blinfun_apply (f x) i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on X f", "using that"], ["proof (prove)\nusing this:\n  ?i \\<in> Basis \\<Longrightarrow>\n  continuous_on X (\\<lambda>x. blinfun_apply (f x) ?i)\n\ngoal (1 subgoal):\n 1. continuous_on X f", "by (auto simp: continuous_on_def intro: tendsto_componentwise1)"], ["", "lemma c1_euclidean_blinfunE:\n  fixes f::\"'a::euclidean_space\\<Rightarrow>'b::real_normed_vector\"\n  assumes \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative f' x) (at x within S)\"\n  assumes \"\\<And>i. i \\<in> Basis \\<Longrightarrow> continuous_on S (\\<lambda>x. f' x i)\"\n  obtains bf' where\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative blinfun_apply (bf' x)) (at x within S)\"\n    \"continuous_on S bf'\"\n    \"\\<And>x. x \\<in> S \\<Longrightarrow> blinfun_apply (bf' x) = f' x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from assms"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow> (f has_derivative f' ?x) (at ?x within S)\n  ?i \\<in> Basis \\<Longrightarrow> continuous_on S (\\<lambda>x. f' x ?i)", "have \"bounded_linear (f' x)\" if \"x \\<in> S\" for x"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> (f has_derivative f' ?x) (at ?x within S)\n  ?i \\<in> Basis \\<Longrightarrow> continuous_on S (\\<lambda>x. f' x ?i)\n\ngoal (1 subgoal):\n 1. bounded_linear (f' x)", "by (auto intro!: has_derivative_bounded_linear that)"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow> bounded_linear (f' ?x)\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "then"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow> bounded_linear (f' ?x)", "obtain bf' where bf': \"\\<forall>x \\<in> S. f' x = blinfun_apply (bf' x)\""], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> bounded_linear (f' ?x)\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<forall>x\\<in>S. f' x = blinfun_apply (bf' x) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "apply atomize_elim"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x.\n        x \\<in> S \\<Longrightarrow> bounded_linear (f' x)) \\<Longrightarrow>\n    \\<exists>bf'. \\<forall>x\\<in>S. f' x = blinfun_apply (bf' x)", "apply (rule bchoice)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x.\n        x \\<in> S \\<Longrightarrow> bounded_linear (f' x)) \\<Longrightarrow>\n    \\<forall>x\\<in>S. \\<exists>y. f' x = blinfun_apply y", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>x. x \\<in> S \\<Longrightarrow> bounded_linear (f' x);\n        x \\<in> S\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y. f' x = blinfun_apply y", "by (metis bounded_linear_Blinfun_apply)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>S. f' x = blinfun_apply (bf' x)\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "with assms"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow> (f has_derivative f' ?x) (at ?x within S)\n  ?i \\<in> Basis \\<Longrightarrow> continuous_on S (\\<lambda>x. f' x ?i)\n  \\<forall>x\\<in>S. f' x = blinfun_apply (bf' x)", "have \"\\<And>x. x \\<in> S \\<Longrightarrow> (f has_derivative blinfun_apply (bf' x)) (at x within S)\""], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> (f has_derivative f' ?x) (at ?x within S)\n  ?i \\<in> Basis \\<Longrightarrow> continuous_on S (\\<lambda>x. f' x ?i)\n  \\<forall>x\\<in>S. f' x = blinfun_apply (bf' x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       (f has_derivative blinfun_apply (bf' x)) (at x within S)", "by simp"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  (f has_derivative blinfun_apply (bf' ?x)) (at ?x within S)\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  (f has_derivative blinfun_apply (bf' ?x)) (at ?x within S)\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have f_tendsto: \"((\\<lambda>n. f' n j) \\<longlongrightarrow> f' x j) (at x within S)\"\n    if \"x \\<in> S\" \"j \\<in> Basis\"\n    for x j"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>n. f' n j) \\<longlongrightarrow> f' x j) (at x within S)", "using assms"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> (f has_derivative f' ?x) (at ?x within S)\n  ?i \\<in> Basis \\<Longrightarrow> continuous_on S (\\<lambda>x. f' x ?i)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>n. f' n j) \\<longlongrightarrow> f' x j) (at x within S)", "by (auto simp: continuous_on_def that)"], ["proof (state)\nthis:\n  \\<lbrakk>?x \\<in> S; ?j \\<in> Basis\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>n. f' n ?j) \\<longlongrightarrow> f' ?x ?j)\n                     (at ?x within S)\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"continuous_on S bf'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on S bf'", "by (rule continuous_on_blinfunI1) (simp add: bf'[rule_format, symmetric] assms)"], ["proof (state)\nthis:\n  continuous_on S bf'\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  continuous_on S bf'\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<And>x. x \\<in> S \\<Longrightarrow> blinfun_apply (bf' x) = f' x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> S \\<Longrightarrow> blinfun_apply (bf' x) = f' x", "using bf'"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>S. f' x = blinfun_apply (bf' x)\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> S \\<Longrightarrow> blinfun_apply (bf' x) = f' x", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow> blinfun_apply (bf' ?x) = f' ?x\n\ngoal (1 subgoal):\n 1. (\\<And>bf'.\n        \\<lbrakk>\\<And>x.\n                    x \\<in> S \\<Longrightarrow>\n                    (f has_derivative blinfun_apply (bf' x))\n                     (at x within S);\n         continuous_on S bf';\n         \\<And>x.\n            x \\<in> S \\<Longrightarrow>\n            blinfun_apply (bf' x) = f' x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow>\n  (f has_derivative blinfun_apply (bf' ?x)) (at ?x within S)\n  continuous_on S bf'\n  ?x \\<in> S \\<Longrightarrow> blinfun_apply (bf' ?x) = f' ?x", "show ?thesis"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  (f has_derivative blinfun_apply (bf' ?x)) (at ?x within S)\n  continuous_on S bf'\n  ?x \\<in> S \\<Longrightarrow> blinfun_apply (bf' ?x) = f' ?x\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma continuous_Sigma:\n  assumes defined: \"y \\<in> Pi T X\"\n  assumes f_cont: \"continuous_on (Sigma T X) (\\<lambda>(t, x). f t x)\"\n  assumes y_cont: \"continuous_on T y\"\n  shows \"continuous_on T (\\<lambda>x. f x (y x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on T (\\<lambda>x. f x (y x))", "using\n    defined\n    continuous_on_compose2[OF\n      continuous_on_subset[where t=\"(\\<lambda>x. (x, y x)) ` T\", OF f_cont]\n      continuous_on_Pair[OF continuous_on_id y_cont]]"], ["proof (prove)\nusing this:\n  y \\<in> Pi T X\n  \\<lbrakk>(\\<lambda>x. (x, y x)) ` T \\<subseteq> Sigma T X;\n   (\\<lambda>x. (x, y x)) ` T\n   \\<subseteq> (\\<lambda>x. (x, y x)) ` T\\<rbrakk>\n  \\<Longrightarrow> continuous_on T\n                     (\\<lambda>x.\n                         case (x, y x) of (t, x) \\<Rightarrow> f t x)\n\ngoal (1 subgoal):\n 1. continuous_on T (\\<lambda>x. f x (y x))", "by auto"], ["", "lemma continuous_on_Times_swap:\n  \"continuous_on (X \\<times> Y) (\\<lambda>(x, y). f x y)\"\n  if \"continuous_on (Y \\<times> X) (\\<lambda>(y, x). f x y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (X \\<times> Y) (\\<lambda>(x, y). f x y)", "using continuous_on_compose2[OF that continuous_on_swap, where s=\"X \\<times> Y\"]"], ["proof (prove)\nusing this:\n  prod.swap ` (X \\<times> Y) \\<subseteq> Y \\<times> X \\<Longrightarrow>\n  continuous_on (X \\<times> Y)\n   (\\<lambda>x. case prod.swap x of (y, x) \\<Rightarrow> f x y)\n\ngoal (1 subgoal):\n 1. continuous_on (X \\<times> Y) (\\<lambda>(x, y). f x y)", "by (auto simp: split_beta' product_swap)"], ["", "lemma leibniz_rule':\n  \"\\<And>x. x \\<in> S \\<Longrightarrow>\n      ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n          (at x within S)\"\n  \"(\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\"\n  if \"convex S\"\n    and c1: \"\\<And>t x. t \\<in> cbox a b \\<Longrightarrow> x \\<in> S \\<Longrightarrow> ((\\<lambda>x. f x t) has_derivative fx x t) (at x within S)\"\n    \"\\<And>i. i \\<in> Basis \\<Longrightarrow> continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). fx x t i)\"\n    and i: \"\\<And>x. x \\<in> S \\<Longrightarrow> f x integrable_on cbox a b\"\n  for S::\"'a::euclidean_space set\"\n    and f::\"'a \\<Rightarrow> 'b::euclidean_space \\<Rightarrow> 'c::euclidean_space\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x.\n        x \\<in> S \\<Longrightarrow>\n        ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n         (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n         (at x within S)) &&&\n    (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "have fx1: \"continuous_on S (\\<lambda>x. fx x t i)\" if \"t \\<in> cbox a b\" \"i \\<in> Basis\" for i t"], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on S (\\<lambda>x. fx x t i)", "by (rule continuous_Sigma[OF _ c1(2), where y=\"\\<lambda>_. t\"]) (auto simp: continuous_intros that)"], ["proof (state)\nthis:\n  \\<lbrakk>?t \\<in> cbox a b; ?i \\<in> Basis\\<rbrakk>\n  \\<Longrightarrow> continuous_on S (\\<lambda>x. fx x ?t ?i)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "{"], ["proof (state)\nthis:\n  \\<lbrakk>?t \\<in> cbox a b; ?i \\<in> Basis\\<rbrakk>\n  \\<Longrightarrow> continuous_on S (\\<lambda>x. fx x ?t ?i)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "assume \"x \\<in> S\""], ["proof (state)\nthis:\n  x \\<in> S\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "have fx2: \"continuous_on (cbox a b) (\\<lambda>t. fx x t i)\" if \"i \\<in> Basis\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (cbox a b) (\\<lambda>t. fx x t i)", "by (rule continuous_Sigma[OF _ continuous_on_Times_swap[OF c1(2)]])\n        (auto simp: continuous_intros that \\<open>x \\<in> S\\<close>)"], ["proof (state)\nthis:\n  ?i \\<in> Basis \\<Longrightarrow>\n  continuous_on (cbox a b) (\\<lambda>t. fx x t ?i)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "{"], ["proof (state)\nthis:\n  ?i \\<in> Basis \\<Longrightarrow>\n  continuous_on (cbox a b) (\\<lambda>t. fx x t ?i)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "fix t"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "assume \"t \\<in> cbox a b\""], ["proof (state)\nthis:\n  t \\<in> cbox a b\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "have \"\\<exists>f'. (\\<forall>x \\<in> S. ((\\<lambda>x. f x t) has_derivative blinfun_apply (f' x)) (at x within S) \\<and>\n      blinfun_apply (f' x) = fx x t) \\<and>\n      continuous_on S f'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f'.\n       (\\<forall>x\\<in>S.\n           ((\\<lambda>x. f x t) has_derivative blinfun_apply (f' x))\n            (at x within S) \\<and>\n           blinfun_apply (f' x) = fx x t) \\<and>\n       continuous_on S f'", "by (rule c1_euclidean_blinfunE[OF c1(1)[OF \\<open>t \\<in> _\\<close>] fx1[OF \\<open>t \\<in> _\\<close>]]) (auto, metis)"], ["proof (state)\nthis:\n  \\<exists>f'.\n     (\\<forall>x\\<in>S.\n         ((\\<lambda>x. f x t) has_derivative blinfun_apply (f' x))\n          (at x within S) \\<and>\n         blinfun_apply (f' x) = fx x t) \\<and>\n     continuous_on S f'\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "}"], ["proof (state)\nthis:\n  ?t2 \\<in> cbox a b \\<Longrightarrow>\n  \\<exists>f'.\n     (\\<forall>x\\<in>S.\n         ((\\<lambda>x. f x ?t2) has_derivative blinfun_apply (f' x))\n          (at x within S) \\<and>\n         blinfun_apply (f' x) = fx x ?t2) \\<and>\n     continuous_on S f'\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "then"], ["proof (chain)\npicking this:\n  ?t2 \\<in> cbox a b \\<Longrightarrow>\n  \\<exists>f'.\n     (\\<forall>x\\<in>S.\n         ((\\<lambda>x. f x ?t2) has_derivative blinfun_apply (f' x))\n          (at x within S) \\<and>\n         blinfun_apply (f' x) = fx x ?t2) \\<and>\n     continuous_on S f'", "obtain fx' where\n      fx':\n      \"\\<And>t x. t \\<in> cbox a b \\<Longrightarrow> x \\<in> S \\<Longrightarrow> ((\\<lambda>x. f x t) has_derivative blinfun_apply (fx' t x)) (at x within S)\"\n      \"\\<And>t x. t \\<in> cbox a b \\<Longrightarrow> x \\<in> S \\<Longrightarrow> blinfun_apply (fx' t x) = fx x t\"\n      \"\\<And>t. t \\<in> cbox a b \\<Longrightarrow> continuous_on S (fx' t)\""], ["proof (prove)\nusing this:\n  ?t2 \\<in> cbox a b \\<Longrightarrow>\n  \\<exists>f'.\n     (\\<forall>x\\<in>S.\n         ((\\<lambda>x. f x ?t2) has_derivative blinfun_apply (f' x))\n          (at x within S) \\<and>\n         blinfun_apply (f' x) = fx x ?t2) \\<and>\n     continuous_on S f'\n\ngoal (1 subgoal):\n 1. (\\<And>fx'.\n        \\<lbrakk>\\<And>t x.\n                    \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n                    \\<Longrightarrow> ((\\<lambda>x. f x t) has_derivative\n blinfun_apply (fx' t x))\n (at x within S);\n         \\<And>t x.\n            \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n            \\<Longrightarrow> blinfun_apply (fx' t x) = fx x t;\n         \\<And>t.\n            t \\<in> cbox a b \\<Longrightarrow>\n            continuous_on S (fx' t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  \\<lbrakk>?t \\<in> cbox a b; ?x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. f x ?t) has_derivative\n                     blinfun_apply (fx' ?t ?x))\n                     (at ?x within S)\n  \\<lbrakk>?t \\<in> cbox a b; ?x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> blinfun_apply (fx' ?t ?x) = fx ?x ?t\n  ?t \\<in> cbox a b \\<Longrightarrow> continuous_on S (fx' ?t)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "have c: \"continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). fx' t x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). fx' t x)", "apply (rule continuous_on_blinfunI1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> Basis \\<Longrightarrow>\n       continuous_on (S \\<times> cbox a b)\n        (\\<lambda>x.\n            blinfun_apply (case x of (x, t) \\<Rightarrow> fx' t x) i)", "using c1(2)"], ["proof (prove)\nusing this:\n  ?i \\<in> Basis \\<Longrightarrow>\n  continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). fx x t ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> Basis \\<Longrightarrow>\n       continuous_on (S \\<times> cbox a b)\n        (\\<lambda>x.\n            blinfun_apply (case x of (x, t) \\<Rightarrow> fx' t x) i)", "apply (rule continuous_on_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i. i \\<in> Basis \\<Longrightarrow> ?i3 i \\<in> Basis\n 2. \\<And>i x.\n       \\<lbrakk>i \\<in> Basis; x \\<in> S \\<times> cbox a b\\<rbrakk>\n       \\<Longrightarrow> (case x of (x, t) \\<Rightarrow> fx x t (?i3 i)) =\n                         blinfun_apply\n                          (case x of (x, t) \\<Rightarrow> fx' t x) i", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i x.\n       \\<lbrakk>i \\<in> Basis; x \\<in> S \\<times> cbox a b\\<rbrakk>\n       \\<Longrightarrow> (case x of (x, t) \\<Rightarrow> fx x t i) =\n                         blinfun_apply\n                          (case x of (x, t) \\<Rightarrow> fx' t x) i", "by (auto simp: fx' split_beta')"], ["proof (state)\nthis:\n  continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). fx' t x)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "from leibniz_rule[of S a b f \"\\<lambda>x t. fx' t x\" x, OF fx'(1) i c \\<open>x \\<in> S\\<close> \\<open>convex S\\<close>]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x t.\n              \\<lbrakk>x \\<in> S; t \\<in> cbox a b\\<rbrakk>\n              \\<Longrightarrow> t \\<in> cbox a b;\n   \\<And>x t.\n      \\<lbrakk>x \\<in> S; t \\<in> cbox a b\\<rbrakk>\n      \\<Longrightarrow> x \\<in> S;\n   \\<And>x. x \\<in> S \\<Longrightarrow> x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n                     blinfun_apply\n                      (integral (cbox a b) (\\<lambda>t. fx' t x)))\n                     (at x within S)", "have \"((\\<lambda>x. integral (cbox a b) (f x)) has_derivative blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x))) (at x within S)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x t.\n              \\<lbrakk>x \\<in> S; t \\<in> cbox a b\\<rbrakk>\n              \\<Longrightarrow> t \\<in> cbox a b;\n   \\<And>x t.\n      \\<lbrakk>x \\<in> S; t \\<in> cbox a b\\<rbrakk>\n      \\<Longrightarrow> x \\<in> S;\n   \\<And>x. x \\<in> S \\<Longrightarrow> x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n                     blinfun_apply\n                      (integral (cbox a b) (\\<lambda>t. fx' t x)))\n                     (at x within S)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n     blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)))\n     (at x within S)", "by auto"], ["proof (state)\nthis:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)))\n   (at x within S)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "then"], ["proof (chain)\npicking this:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)))\n   (at x within S)", "have \"((\\<lambda>x. integral (cbox a b) (f x)) has_derivative blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x))) (at x within S)\""], ["proof (prove)\nusing this:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)))\n   (at x within S)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n     blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)))\n     (at x within S)", "by auto"], ["proof (state)\nthis:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)))\n   (at x within S)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "also"], ["proof (state)\nthis:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)))\n   (at x within S)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "have fx'xi: \"(\\<lambda>t. fx' t x) integrable_on cbox a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>t. fx' t x) integrable_on cbox a b", "apply (rule integrable_continuous)"], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (cbox a b) (\\<lambda>t. fx' t x)", "apply (rule continuous_on_blinfunI1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       i \\<in> Basis \\<Longrightarrow>\n       continuous_on (cbox a b) (\\<lambda>xa. blinfun_apply (fx' xa x) i)", "by (simp add: fx' \\<open>x \\<in> S\\<close> fx2)"], ["proof (state)\nthis:\n  (\\<lambda>t. fx' t x) integrable_on cbox a b\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "have \"blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)) = (\\<lambda>v. integral (cbox a b) (\\<lambda>xb. fx x xb v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)) =\n    (\\<lambda>v. integral (cbox a b) (\\<lambda>xb. fx x xb v))", "apply (rule ext)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v.\n       blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)) v =\n       integral (cbox a b) (\\<lambda>xb. fx x xb v)", "apply (subst blinfun_apply_integral)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>v. (\\<lambda>t. fx' t x) integrable_on cbox a b\n 2. \\<And>v.\n       integral (cbox a b) (\\<lambda>y. blinfun_apply (fx' y x) v) =\n       integral (cbox a b) (\\<lambda>xb. fx x xb v)", "apply (rule fx'xi)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v.\n       integral (cbox a b) (\\<lambda>y. blinfun_apply (fx' y x) v) =\n       integral (cbox a b) (\\<lambda>xb. fx x xb v)", "by (simp add: \\<open>x \\<in> S\\<close> fx' cong: integral_cong)"], ["proof (state)\nthis:\n  blinfun_apply (integral (cbox a b) (\\<lambda>t. fx' t x)) =\n  (\\<lambda>v. integral (cbox a b) (\\<lambda>xb. fx x xb v))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> S \\<Longrightarrow>\n       ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n        (\\<lambda>v. integral (cbox a b) (\\<lambda>t. fx x t v)))\n        (at x within S)\n 2. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "finally"], ["proof (chain)\npicking this:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx x xb c)))\n   (at x within S)", "show \"((\\<lambda>x. integral (cbox a b) (f x)) has_derivative (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx x xb c))) (at x within S)\""], ["proof (prove)\nusing this:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx x xb c)))\n   (at x within S)\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n     (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx x xb c)))\n     (at x within S)", "by simp"], ["proof (state)\nthis:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx x xb c)))\n   (at x within S)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "}"], ["proof (state)\nthis:\n  ?x2 \\<in> S \\<Longrightarrow>\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx ?x2 xb c)))\n   (at ?x2 within S)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "then"], ["proof (chain)\npicking this:\n  ?x2 \\<in> S \\<Longrightarrow>\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx ?x2 xb c)))\n   (at ?x2 within S)", "show \"(\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\""], ["proof (prove)\nusing this:\n  ?x2 \\<in> S \\<Longrightarrow>\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>c. integral (cbox a b) (\\<lambda>xb. fx ?x2 xb c)))\n   (at ?x2 within S)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "by (auto simp: differentiable_on_def differentiable_def)"], ["proof (state)\nthis:\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas leibniz_rule'_interval = leibniz_rule'[where 'b=\"_::ordered_euclidean_space\",\n    unfolded cbox_interval]"], ["", "lemma leibniz_rule'_higher:\n  \"higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) k\"\n  if \"convex S\" \"open S\"\n    and c1: \"higher_differentiable_on (S\\<times>cbox a b) (\\<lambda>(x, t). f x t) k\"\n    \\<comment>\\<open>this condition is actually too strong:\n      it would suffice if higher partial derivatives (w.r.t. x) are continuous w.r.t. t.\n      but it makes the statement short and no need to introduce new constants\\<close>\n  for S::\"'a::euclidean_space set\"\n    and f::\"'a \\<Rightarrow> 'b::euclidean_space \\<Rightarrow> 'c::euclidean_space\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) k", "using c1"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> cbox a b) (\\<lambda>(x, t). f x t) k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) k", "proof (induction k arbitrary: f)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>f.\n       higher_differentiable_on (S \\<times> cbox a b)\n        (\\<lambda>(x, y). f x y) 0 \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) 0\n 2. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "case 0"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>a. case a of (a, b) \\<Rightarrow> f a b) 0\n\ngoal (2 subgoals):\n 1. \\<And>f.\n       higher_differentiable_on (S \\<times> cbox a b)\n        (\\<lambda>(x, y). f x y) 0 \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) 0\n 2. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>a. case a of (a, b) \\<Rightarrow> f a b) 0", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>a. case a of (a, b) \\<Rightarrow> f a b) 0\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) 0", "by (auto simp: higher_differentiable_on.simps intro!: integral_continuous_on_param)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) 0\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "case (Suc k)"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>a. case a of (a, b) \\<Rightarrow> ?f a b) k \\<Longrightarrow>\n  higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (?f x)) k\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>a. case a of (a, b) \\<Rightarrow> f a b) (Suc k)\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "define D where \"D x = frechet_derivative (\\<lambda>(x, y). f x y) (at x)\" for x"], ["proof (state)\nthis:\n  D ?x = frechet_derivative (\\<lambda>(x, y). f x y) (at ?x)\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "note [continuous_intros] =\n    Suc.prems[THEN higher_differentiable_on_imp_continuous_on, THEN continuous_on_compose2,\n      of _ \"\\<lambda>x. (f x, g x)\" for f g, unfolded split_beta' fst_conv snd_conv]"], ["proof (state)\nthis:\n  \\<lbrakk>continuous_on ?s (\\<lambda>x. (?fb4 x, ?g4 x));\n   (\\<lambda>x. (?fb4 x, ?g4 x)) ` ?s\n   \\<subseteq> S \\<times> cbox a b\\<rbrakk>\n  \\<Longrightarrow> continuous_on ?s (\\<lambda>x. f (?fb4 x) (?g4 x))\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "from Suc.prems"], ["proof (chain)\npicking this:\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>a. case a of (a, b) \\<Rightarrow> f a b) (Suc k)", "have prems:\n    \"\\<And>xt. xt \\<in> S \\<times> cbox a b \\<Longrightarrow> (\\<lambda>(x, y). f x y) differentiable at xt\"\n    \"higher_differentiable_on (S \\<times> cbox a b) (\\<lambda>x. D x (dx, dt)) k\"\n    for dx dt"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>a. case a of (a, b) \\<Rightarrow> f a b) (Suc k)\n\ngoal (1 subgoal):\n 1. (\\<And>xt.\n        xt \\<in> S \\<times> cbox a b \\<Longrightarrow>\n        (\\<lambda>(x, y). f x y) differentiable at xt) &&&\n    higher_differentiable_on (S \\<times> cbox a b)\n     (\\<lambda>x. D x (dx, dt)) k", "by (auto simp: higher_differentiable_on.simps D_def)"], ["proof (state)\nthis:\n  ?xt \\<in> S \\<times> cbox a b \\<Longrightarrow>\n  (\\<lambda>(x, y). f x y) differentiable at ?xt\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>x. D x (?dx, ?dt)) k\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "from frechet_derivative_worksI[OF this(1), folded D_def]"], ["proof (chain)\npicking this:\n  ?xt1 \\<in> S \\<times> cbox a b \\<Longrightarrow>\n  ((\\<lambda>(x, y). f x y) has_derivative D ?xt1) (at ?xt1)", "have D: \"x \\<in> S \\<Longrightarrow> t \\<in> cbox a b \\<Longrightarrow> ((\\<lambda>(x, y). f x y) has_derivative D (x, t)) (at (x, t))\" for x t"], ["proof (prove)\nusing this:\n  ?xt1 \\<in> S \\<times> cbox a b \\<Longrightarrow>\n  ((\\<lambda>(x, y). f x y) has_derivative D ?xt1) (at ?xt1)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; t \\<in> cbox a b\\<rbrakk>\n    \\<Longrightarrow> ((\\<lambda>(x, y). f x y) has_derivative D (x, t))\n                       (at (x, t))", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>?x \\<in> S; ?t \\<in> cbox a b\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>(x, y). f x y) has_derivative D (?x, ?t))\n                     (at (?x, ?t))\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "have p1: \"((\\<lambda>x. (x, t::'b)) has_derivative (\\<lambda>h. (h, 0))) (at x within S)\" for x t"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. (x, t)) has_derivative (\\<lambda>h. (h, 0::'b)))\n     (at x within S)", "by (auto intro!: derivative_eq_intros)"], ["proof (state)\nthis:\n  ((\\<lambda>x. (x, ?t)) has_derivative (\\<lambda>h. (h, 0::'b)))\n   (at ?x within S)\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "have Dx: \"x \\<in> S \\<Longrightarrow> t \\<in> cbox a b \\<Longrightarrow> ((\\<lambda>x. f x t) has_derivative (\\<lambda>dx. D (x, t) (dx, 0))) (at x within S)\" for x t"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; t \\<in> cbox a b\\<rbrakk>\n    \\<Longrightarrow> ((\\<lambda>x. f x t) has_derivative\n                       (\\<lambda>dx. D (x, t) (dx, 0::'b)))\n                       (at x within S)", "by (drule has_derivative_compose[OF p1 D], assumption) auto"], ["proof (state)\nthis:\n  \\<lbrakk>?x \\<in> S; ?t \\<in> cbox a b\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. f x ?t) has_derivative\n                     (\\<lambda>dx. D (?x, ?t) (dx, 0::'b)))\n                     (at ?x within S)\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "have cD: \"continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). D (x, t) v)\" for v"], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). D (x, t) v)", "apply (rule higher_differentiable_on_imp_continuous_on[where n=k])"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> cbox a b)\n     (\\<lambda>(x, t). D (x, t) v) k", "using prems(2)[of \"fst v\" \"snd v\"]"], ["proof (prove)\nusing this:\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>x. D x (fst v, snd v)) k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> cbox a b)\n     (\\<lambda>(x, t). D (x, t) v) k", "by (auto simp: split_beta')"], ["proof (state)\nthis:\n  continuous_on (S \\<times> cbox a b) (\\<lambda>(x, t). D (x, t) ?v)\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "have fi: \"x \\<in> S \\<Longrightarrow> f x integrable_on cbox a b\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> S \\<Longrightarrow> f x integrable_on cbox a b", "by (rule integrable_continuous) (auto intro!: continuous_intros)"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow> f ?x integrable_on cbox a b\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "from leibniz_rule'[OF \\<open>convex S\\<close> Dx cD fi]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>t x.\n              \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n              \\<Longrightarrow> x \\<in> S;\n   \\<And>t x.\n      \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n      \\<Longrightarrow> t \\<in> cbox a b;\n   \\<And>x. x \\<in> S \\<Longrightarrow> x \\<in> S; ?x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n                     (\\<lambda>v.\n                         integral (cbox a b)\n                          (\\<lambda>t. D (?x, t) (v, 0::'b))))\n                     (at ?x within S)\n  \\<lbrakk>\\<And>t x.\n              \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n              \\<Longrightarrow> x \\<in> S;\n   \\<And>t x.\n      \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n      \\<Longrightarrow> t \\<in> cbox a b;\n   \\<And>x. x \\<in> S \\<Longrightarrow> x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>x.\n                        integral (cbox a b) (f x)) differentiable_on\n                    S", "have ihd: \"x \\<in> S \\<Longrightarrow> ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0))))\n     (at x within S)\"\n    and \"(\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\"\n    for x"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>t x.\n              \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n              \\<Longrightarrow> x \\<in> S;\n   \\<And>t x.\n      \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n      \\<Longrightarrow> t \\<in> cbox a b;\n   \\<And>x. x \\<in> S \\<Longrightarrow> x \\<in> S; ?x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n                     (\\<lambda>v.\n                         integral (cbox a b)\n                          (\\<lambda>t. D (?x, t) (v, 0::'b))))\n                     (at ?x within S)\n  \\<lbrakk>\\<And>t x.\n              \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n              \\<Longrightarrow> x \\<in> S;\n   \\<And>t x.\n      \\<lbrakk>t \\<in> cbox a b; x \\<in> S\\<rbrakk>\n      \\<Longrightarrow> t \\<in> cbox a b;\n   \\<And>x. x \\<in> S \\<Longrightarrow> x \\<in> S\\<rbrakk>\n  \\<Longrightarrow> (\\<lambda>x.\n                        integral (cbox a b) (f x)) differentiable_on\n                    S\n\ngoal (1 subgoal):\n 1. (x \\<in> S \\<Longrightarrow>\n     ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n      (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0::'b))))\n      (at x within S)) &&&\n    (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (?x, t) (v, 0::'b))))\n   (at ?x within S)\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "then"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow>\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (?x, t) (v, 0::'b))))\n   (at ?x within S)\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S", "have \"x \\<in> S \\<Longrightarrow> (\\<lambda>x. integral (cbox a b) (f x)) differentiable at x\" for x"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (?x, t) (v, 0::'b))))\n   (at ?x within S)\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\n\ngoal (1 subgoal):\n 1. x \\<in> S \\<Longrightarrow>\n    (\\<lambda>x. integral (cbox a b) (f x)) differentiable at x", "using \\<open>open S\\<close>"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (?x, t) (v, 0::'b))))\n   (at ?x within S)\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable_on S\n  open S\n\ngoal (1 subgoal):\n 1. x \\<in> S \\<Longrightarrow>\n    (\\<lambda>x. integral (cbox a b) (f x)) differentiable at x", "by (auto simp: differentiable_on_openD)"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable at ?x\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "moreover"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable at ?x\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "have \"higher_differentiable_on S (\\<lambda>x. frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x) v) k\" for v"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S\n     (\\<lambda>x.\n         frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x)\n          v)\n     k", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. higher_differentiable_on S\n     (\\<lambda>x.\n         frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x)\n          v)\n     k", "have *: \"frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x) =\n      (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0)))\"\n      if \"x \\<in> S\"\n      for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x) =\n    (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0::'b)))", "apply (rule frechet_derivative_at')"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n     (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0::'b))))\n     (at x)", "using ihd(1)[OF that] at_within_open[OF that \\<open>open S\\<close>]"], ["proof (prove)\nusing this:\n  ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n   (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0::'b))))\n   (at x within S)\n  at x within S = at x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. integral (cbox a b) (f x)) has_derivative\n     (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0::'b))))\n     (at x)", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> S \\<Longrightarrow>\n  frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at ?x) =\n  (\\<lambda>v. integral (cbox a b) (\\<lambda>t. D (?x, t) (v, 0::'b)))\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S\n     (\\<lambda>x.\n         frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x)\n          v)\n     k", "have **: \"higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0))) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S\n     (\\<lambda>x. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0::'b))) k", "apply (rule Suc.IH)"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> cbox a b)\n     (\\<lambda>a. case a of (a, b) \\<Rightarrow> D (a, b) (v, 0::'b)) k", "using prems"], ["proof (prove)\nusing this:\n  ?xt \\<in> S \\<times> cbox a b \\<Longrightarrow>\n  (\\<lambda>(x, y). f x y) differentiable at ?xt\n  higher_differentiable_on (S \\<times> cbox a b)\n   (\\<lambda>x. D x (?dx, ?dt)) k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> cbox a b)\n     (\\<lambda>a. case a of (a, b) \\<Rightarrow> D (a, b) (v, 0::'b)) k", "by auto"], ["proof (state)\nthis:\n  higher_differentiable_on S\n   (\\<lambda>x. integral (cbox a b) (\\<lambda>t. D (x, t) (v, 0::'b))) k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S\n     (\\<lambda>x.\n         frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x)\n          v)\n     k", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S\n     (\\<lambda>x.\n         frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x)\n          v)\n     k", "using \\<open>open S\\<close>"], ["proof (prove)\nusing this:\n  open S\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S\n     (\\<lambda>x.\n         frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x)\n          v)\n     k", "by (auto simp: * ** cong: higher_differentiable_on_cong)"], ["proof (state)\nthis:\n  higher_differentiable_on S\n   (\\<lambda>x.\n       frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x) v)\n   k\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  higher_differentiable_on S\n   (\\<lambda>x.\n       frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x) ?v)\n   k\n\ngoal (1 subgoal):\n 1. \\<And>k f.\n       \\<lbrakk>\\<And>f.\n                   higher_differentiable_on (S \\<times> cbox a b)\n                    (\\<lambda>(x, y). f x y) k \\<Longrightarrow>\n                   higher_differentiable_on S\n                    (\\<lambda>x. integral (cbox a b) (f x)) k;\n        higher_differentiable_on (S \\<times> cbox a b)\n         (\\<lambda>(x, y). f x y) (Suc k)\\<rbrakk>\n       \\<Longrightarrow> higher_differentiable_on S\n                          (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)", "ultimately"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable at ?x\n  higher_differentiable_on S\n   (\\<lambda>x.\n       frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x) ?v)\n   k", "show ?case"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  (\\<lambda>x. integral (cbox a b) (f x)) differentiable at ?x\n  higher_differentiable_on S\n   (\\<lambda>x.\n       frechet_derivative (\\<lambda>x. integral (cbox a b) (f x)) (at x) ?v)\n   k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x))\n     (Suc k)", "by (auto simp: higher_differentiable_on.simps)"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. integral (cbox a b) (f x)) (Suc k)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemmas leibniz_rule'_higher_interval = leibniz_rule'_higher[where 'b=\"_::ordered_euclidean_space\",\n    unfolded cbox_interval]"], ["", "subsection \\<open>Smoothness\\<close>"], ["", "definition k_smooth_on :: \"enat \\<Rightarrow>'a::real_normed_vector set \\<Rightarrow> ('a \\<Rightarrow> 'b::real_normed_vector) \\<Rightarrow> bool\"\n  (\"_-smooth'_on\" [1000]) where\n smooth_on_def: \"k-smooth_on S f = (\\<forall>n\\<le>k. higher_differentiable_on S f n)\""], ["", "abbreviation \"smooth_on S f \\<equiv> \\<infinity>-smooth_on S f\""], ["", "lemma derivative_is_smooth':\n  assumes \"(k+1)-smooth_on S f\"\n  shows \"k-smooth_on S (\\<lambda>x. frechet_derivative f (at x) v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. frechet_derivative f (at x) v)", "unfolding smooth_on_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>n.\n       enat n \\<le> k \\<longrightarrow>\n       higher_differentiable_on S\n        (\\<lambda>x. frechet_derivative f (at x) v) n", "proof (intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S\n        (\\<lambda>x. frechet_derivative f (at x) v) n", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S\n        (\\<lambda>x. frechet_derivative f (at x) v) n", "assume \"enat n \\<le> k\""], ["proof (state)\nthis:\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S\n        (\\<lambda>x. frechet_derivative f (at x) v) n", "then"], ["proof (chain)\npicking this:\n  enat n \\<le> k", "have \"Suc n \\<le> k + 1\""], ["proof (prove)\nusing this:\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. enat (Suc n) \\<le> k + 1", "unfolding plus_1_eSuc"], ["proof (prove)\nusing this:\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. enat (Suc n) \\<le> eSuc k", "by (auto simp: eSuc_def split: enat.splits)"], ["proof (state)\nthis:\n  enat (Suc n) \\<le> k + 1\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S\n        (\\<lambda>x. frechet_derivative f (at x) v) n", "then"], ["proof (chain)\npicking this:\n  enat (Suc n) \\<le> k + 1", "have \"higher_differentiable_on S f (Suc n)\""], ["proof (prove)\nusing this:\n  enat (Suc n) \\<le> k + 1\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "using assms(1)"], ["proof (prove)\nusing this:\n  enat (Suc n) \\<le> k + 1\n  (k + 1)-smooth_on S f\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "by (auto simp: smooth_on_def)"], ["proof (state)\nthis:\n  higher_differentiable_on S f (Suc n)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S\n        (\\<lambda>x. frechet_derivative f (at x) v) n", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f (Suc n)", "show \"higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v) n\""], ["proof (prove)\nusing this:\n  higher_differentiable_on S f (Suc n)\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v) n", "by (auto simp: higher_differentiable_on.simps(2))"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. frechet_derivative f (at x) v) n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma derivative_is_smooth: \"smooth_on S f \\<Longrightarrow> smooth_on S (\\<lambda>x. frechet_derivative f (at x) v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. smooth_on S f \\<Longrightarrow>\n    smooth_on S (\\<lambda>x. frechet_derivative f (at x) v)", "using derivative_is_smooth'[of \\<infinity> S f]"], ["proof (prove)\nusing this:\n  (\\<infinity> + 1)-smooth_on S f \\<Longrightarrow>\n  smooth_on S (\\<lambda>x. frechet_derivative f (at x) ?v)\n\ngoal (1 subgoal):\n 1. smooth_on S f \\<Longrightarrow>\n    smooth_on S (\\<lambda>x. frechet_derivative f (at x) v)", "by simp"], ["", "lemma smooth_on_imp_continuous_on: \"continuous_on S f\" if \"k-smooth_on S f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on S f", "apply (rule higher_differentiable_on_imp_continuous_on[where n=0])"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 0", "using that"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 0", "by (simp add: smooth_on_def enat_0)"], ["", "lemma smooth_on_imp_differentiable_on[simp]: \"f differentiable_on S\" if \"k-smooth_on S f\" \"k \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f differentiable_on S", "using that"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. f differentiable_on S", "by (auto simp: smooth_on_def Suc_ile_eq enat_0\n      dest!: spec[where x=1]\n      intro!: higher_differentiable_on_imp_differentiable_on[where k=1])"], ["", "lemma smooth_on_cong:\n  assumes \"k-smooth_on S g\" \"open S\"\n    and \"\\<And>x. x \\<in> S \\<Longrightarrow> f x = g x\"\n  shows \"k-smooth_on S f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S f", "using assms"], ["proof (prove)\nusing this:\n  k-smooth_on S g\n  open S\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n\ngoal (1 subgoal):\n 1. k-smooth_on S f", "unfolding smooth_on_def"], ["proof (prove)\nusing this:\n  \\<forall>n.\n     enat n \\<le> k \\<longrightarrow> higher_differentiable_on S g n\n  open S\n  ?x \\<in> S \\<Longrightarrow> f ?x = g ?x\n\ngoal (1 subgoal):\n 1. \\<forall>n.\n       enat n \\<le> k \\<longrightarrow> higher_differentiable_on S f n", "by (auto cong: higher_differentiable_on_cong)"], ["", "lemma smooth_on_open_Un:\n  \"k-smooth_on S f \\<Longrightarrow> k-smooth_on T f \\<Longrightarrow> open S \\<Longrightarrow> open T \\<Longrightarrow> k-smooth_on (S \\<union> T) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on T f; open S; open T\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on (S \\<union> T) f", "by (auto simp: smooth_on_def higher_differentiable_on_open_Un)"], ["", "lemma smooth_on_open_subsetsI:\n  \"k-smooth_on S f\"\n  if \"\\<And>x. x \\<in> S \\<Longrightarrow> \\<exists>T. x \\<in> T \\<and> open T \\<and> k-smooth_on T f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S f", "using that"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  \\<exists>T. ?x \\<in> T \\<and> open T \\<and> k-smooth_on T f\n\ngoal (1 subgoal):\n 1. k-smooth_on S f", "unfolding smooth_on_def"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow>\n  \\<exists>T.\n     ?x \\<in> T \\<and>\n     open T \\<and>\n     (\\<forall>n.\n         enat n \\<le> k \\<longrightarrow> higher_differentiable_on T f n)\n\ngoal (1 subgoal):\n 1. \\<forall>n.\n       enat n \\<le> k \\<longrightarrow> higher_differentiable_on S f n", "by (force intro: higher_differentiable_on_open_subsetsI)"], ["", "lemma smooth_on_const[intro]: \"k-smooth_on S (\\<lambda>x. c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. c)", "by (auto simp: smooth_on_def higher_differentiable_on_const)"], ["", "lemma smooth_on_id[intro]: \"k-smooth_on S (\\<lambda>x. x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. x)", "by (auto simp: smooth_on_def higher_differentiable_on_id)"], ["", "lemma smooth_on_add_fun: \"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (f + g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (f + g)", "by (auto simp: smooth_on_def higher_differentiable_on_add plus_fun_def)"], ["", "lemmas smooth_on_add = smooth_on_add_fun[unfolded plus_fun_def]"], ["", "lemma smooth_on_sum:\n  \"n-smooth_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x)\"\n  if \"\\<And>i. i \\<in> F \\<Longrightarrow> finite F \\<Longrightarrow> n-smooth_on S (f i)\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n-smooth_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x)", "using that"], ["proof (prove)\nusing this:\n  \\<lbrakk>?i \\<in> F; finite F\\<rbrakk>\n  \\<Longrightarrow> n-smooth_on S (f ?i)\n  open S\n\ngoal (1 subgoal):\n 1. n-smooth_on S (\\<lambda>x. \\<Sum>i\\<in>F. f i x)", "by (auto simp: smooth_on_def higher_differentiable_on_sum)"], ["", "lemma (in bounded_bilinear) smooth_on:\n  includes no_matrix_mult\n  assumes \"k-smooth_on S f\" \"k-smooth_on S g\" \"open S\"\n  shows \"k-smooth_on S (\\<lambda>x. (f x) ** (g x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. f x ** g x)", "using assms"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  k-smooth_on S g\n  open S\n\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. f x ** g x)", "by (auto simp: smooth_on_def higher_differentiable_on)"], ["", "lemma smooth_on_compose2:\n  fixes g::\"_\\<Rightarrow>_::euclidean_space\"\n  assumes \"k-smooth_on T f\" \"k-smooth_on S g\" \"open U\" \"open T\" \"g ` U \\<subseteq> T\" \"U \\<subseteq> S\" \n  shows \"k-smooth_on U (f o g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on U (f \\<circ> g)", "using assms"], ["proof (prove)\nusing this:\n  k-smooth_on T f\n  k-smooth_on S g\n  open U\n  open T\n  g ` U \\<subseteq> T\n  U \\<subseteq> S\n\ngoal (1 subgoal):\n 1. k-smooth_on U (f \\<circ> g)", "by (auto simp: smooth_on_def intro!: higher_differentiable_on_compose intro: higher_differentiable_on_subset)"], ["", "lemma smooth_on_compose:\n  fixes g::\"_\\<Rightarrow>_::euclidean_space\"\n  assumes \"k-smooth_on T f\" \"k-smooth_on S g\" \"open S\" \"open T\" \"g ` S \\<subseteq> T\"\n  shows \"k-smooth_on S (f o g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (f \\<circ> g)", "using assms"], ["proof (prove)\nusing this:\n  k-smooth_on T f\n  k-smooth_on S g\n  open S\n  open T\n  g ` S \\<subseteq> T\n\ngoal (1 subgoal):\n 1. k-smooth_on S (f \\<circ> g)", "by (rule smooth_on_compose2) auto"], ["", "lemma smooth_on_subset:\n  \"k-smooth_on S f\"\n  if \"k-smooth_on T f\" \"S \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S f", "using higher_differentiable_on_subset[of T f _ S] that"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on T f ?n; S \\<subseteq> T\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on S f ?n\n  k-smooth_on T f\n  S \\<subseteq> T\n\ngoal (1 subgoal):\n 1. k-smooth_on S f", "by (auto simp: smooth_on_def)"], ["", "context begin"], ["", "private"], ["", "lemmas s = bounded_bilinear.smooth_on"], ["", "lemmas smooth_on_inner = bounded_bilinear_inner[THEN s]\n   and smooth_on_scaleR = bounded_bilinear_scaleR[THEN s]\n   and smooth_on_mult = bounded_bilinear_mult[THEN s]"], ["", "end"], ["", "lemma smooth_on_divide:\"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow>(\\<And>x. x \\<in> S \\<Longrightarrow> g x \\<noteq> 0) \\<Longrightarrow>\n  k-smooth_on S (\\<lambda>x. f x / g x)\"\n  for f::\"_\\<Rightarrow>_::real_normed_field\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S;\n     \\<And>x. x \\<in> S \\<Longrightarrow> g x \\<noteq> (0::'d)\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (\\<lambda>x. f x / g x)", "by (auto simp: smooth_on_def higher_differentiable_on_divide)"], ["", "lemma smooth_on_scaleR_fun: \"k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (c *\\<^sub>R g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (c *\\<^sub>R g)", "by (auto simp: scaleR_fun_def intro!: smooth_on_scaleR )"], ["", "lemma smooth_on_uminus_fun: \"k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (- g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (- g)", "using smooth_on_scaleR_fun[where c=\"-1\", of k S g]"], ["proof (prove)\nusing this:\n  \\<lbrakk>k-smooth_on S g; open S\\<rbrakk>\n  \\<Longrightarrow> k-smooth_on S (- 1 *\\<^sub>R g)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (- g)", "by auto"], ["", "lemmas smooth_on_uminus = smooth_on_uminus_fun[unfolded fun_Compl_def]"], ["", "lemma smooth_on_minus_fun: \"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (f - g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (f - g)", "unfolding diff_conv_add_uminus"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (f + - g)", "apply (rule smooth_on_add_fun)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S f\n 2. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (- g)\n 3. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> open S", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (- g)\n 2. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> open S", "apply (rule smooth_on_uminus_fun)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S g\n 2. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> open S\n 3. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> open S", "by auto"], ["", "lemmas smooth_on_minus = smooth_on_minus_fun[unfolded fun_diff_def]"], ["", "lemma smooth_on_times_fun: \"k-smooth_on S f \\<Longrightarrow> k-smooth_on S g \\<Longrightarrow> open S \\<Longrightarrow> k-smooth_on S (f * g)\"\n  for f g::\"_ \\<Rightarrow>_::real_normed_algebra\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k-smooth_on S f; k-smooth_on S g; open S\\<rbrakk>\n    \\<Longrightarrow> k-smooth_on S (f * g)", "by (auto simp: times_fun_def intro!: smooth_on_mult)"], ["", "lemma smooth_on_le:\n  \"l-smooth_on S f\"\n  if \"k-smooth_on S f\" \"l \\<le> k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l-smooth_on S f", "using that"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  l \\<le> k\n\ngoal (1 subgoal):\n 1. l-smooth_on S f", "by (auto simp: smooth_on_def)"], ["", "lemma smooth_on_inverse: \"k-smooth_on S (\\<lambda>x. inverse (f x))\"\n  if \"k-smooth_on S f\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_ \\<Rightarrow>_::real_normed_field\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. inverse (f x))", "using that"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. inverse (f x))", "by (auto simp: smooth_on_def intro!: higher_differentiable_on_inverse)"], ["", "lemma smooth_on_norm: \"k-smooth_on S (\\<lambda>x. norm (f x))\"\n  if \"k-smooth_on S f\" \"0 \\<notin> f ` S\" \"open S\"\n  for f::\"_ \\<Rightarrow>_::real_inner\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. norm (f x))", "using that"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  (0::'d) \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. norm (f x))", "by (auto simp: smooth_on_def intro!: higher_differentiable_on_norm)"], ["", "lemma smooth_on_sqrt: \"k-smooth_on S (\\<lambda>x. sqrt (f x))\"\n  if \"k-smooth_on S f\" \"0 \\<notin> f ` S\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. sqrt (f x))", "using that"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  0 \\<notin> f ` S\n  open S\n\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. sqrt (f x))", "by (auto simp: smooth_on_def intro!: higher_differentiable_on_sqrt)"], ["", "lemma smooth_on_frechet_derivative:\n  \"\\<infinity>-smooth_on UNIV (\\<lambda>x. frechet_derivative f (at x) v)\"\n  if \"\\<infinity>-smooth_on UNIV f\"\n    \\<comment>\\<open>TODO: generalize\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. smooth_on UNIV (\\<lambda>x. frechet_derivative f (at x) v)", "using that"], ["proof (prove)\nusing this:\n  smooth_on UNIV f\n\ngoal (1 subgoal):\n 1. smooth_on UNIV (\\<lambda>x. frechet_derivative f (at x) v)", "apply (auto simp: smooth_on_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>n. higher_differentiable_on UNIV f n \\<Longrightarrow>\n       higher_differentiable_on UNIV\n        (\\<lambda>x. frechet_derivative f (at x) v) n", "apply (rule higher_differentiable_on_frechet_derivativeI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<forall>n. higher_differentiable_on UNIV f n \\<Longrightarrow>\n       higher_differentiable_on UNIV f (Suc n)\n 2. \\<And>n.\n       \\<forall>n. higher_differentiable_on UNIV f n \\<Longrightarrow>\n       open UNIV\n 3. \\<And>n.\n       \\<forall>n. higher_differentiable_on UNIV f n \\<Longrightarrow>\n       ?x4 n \\<in> UNIV", "by auto"], ["", "lemmas smooth_on_frechet_derivivative_comp = smooth_on_compose2[OF smooth_on_frechet_derivative, unfolded o_def]"], ["", "lemma smooth_onD: \"higher_differentiable_on S f n\" if \"m-smooth_on S f\" \"enat n \\<le> m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using that"], ["proof (prove)\nusing this:\n  m-smooth_on S f\n  enat n \\<le> m\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by (auto simp: smooth_on_def)"], ["", "lemma (in bounded_linear) higher_differentiable_on: \"higher_differentiable_on S f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. higher_differentiable_on S f 0\n 2. \\<And>n.\n       higher_differentiable_on S f n \\<Longrightarrow>\n       higher_differentiable_on S f (Suc n)", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. higher_differentiable_on S f 0\n 2. \\<And>n.\n       higher_differentiable_on S f n \\<Longrightarrow>\n       higher_differentiable_on S f (Suc n)", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 0", "by (auto simp: higher_differentiable_on.simps linear_continuous_on bounded_linear_axioms)"], ["proof (state)\nthis:\n  higher_differentiable_on S f 0\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       higher_differentiable_on S f n \\<Longrightarrow>\n       higher_differentiable_on S f (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       higher_differentiable_on S f n \\<Longrightarrow>\n       higher_differentiable_on S f (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       higher_differentiable_on S f n \\<Longrightarrow>\n       higher_differentiable_on S f (Suc n)", "then"], ["proof (chain)\npicking this:\n  higher_differentiable_on S f n", "show ?case"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f (Suc n)", "apply (auto simp: higher_differentiable_on.simps frechet_derivative higher_differentiable_on_const)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>higher_differentiable_on S f n; x \\<in> S\\<rbrakk>\n       \\<Longrightarrow> f differentiable at x", "using bounded_linear_axioms"], ["proof (prove)\nusing this:\n  bounded_linear f\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>higher_differentiable_on S f n; x \\<in> S\\<rbrakk>\n       \\<Longrightarrow> f differentiable at x", "apply (rule bounded_linear_imp_differentiable)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  higher_differentiable_on S f (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in bounded_linear) smooth_on: \"k-smooth_on S f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S f", "by (auto simp: smooth_on_def higher_differentiable_on)"], ["", "lemma smooth_on_snd:\n  \"k-smooth_on S (\\<lambda>x. snd (f x))\"\n  if \"k-smooth_on S f\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. snd (f x))", "using higher_differentiable_on_snd_comp that"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on ?S ?f ?k; open ?S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on ?S (\\<lambda>x. snd (?f x)) ?k\n  k-smooth_on S f\n  open S\n\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. snd (f x))", "by (auto simp: smooth_on_def)"], ["", "lemma smooth_on_fst:\n  \"k-smooth_on S (\\<lambda>x. fst (f x))\"\n  if \"k-smooth_on S f\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. fst (f x))", "using higher_differentiable_on_fst_comp that"], ["proof (prove)\nusing this:\n  \\<lbrakk>higher_differentiable_on ?S ?f ?k; open ?S\\<rbrakk>\n  \\<Longrightarrow> higher_differentiable_on ?S (\\<lambda>x. fst (?f x)) ?k\n  k-smooth_on S f\n  open S\n\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. fst (f x))", "by (auto simp: smooth_on_def)"], ["", "lemma smooth_on_sin: \"n-smooth_on S (\\<lambda>x. sin (f x::real))\" if \"n-smooth_on S f\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n-smooth_on S (\\<lambda>x. sin (f x))", "using that"], ["proof (prove)\nusing this:\n  n-smooth_on S f\n  open S\n\ngoal (1 subgoal):\n 1. n-smooth_on S (\\<lambda>x. sin (f x))", "by (auto simp: smooth_on_def intro!: higher_differentiable_on_sin)"], ["", "lemma smooth_on_cos: \"n-smooth_on S (\\<lambda>x. cos (f x::real))\" if \"n-smooth_on S f\" \"open S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n-smooth_on S (\\<lambda>x. cos (f x))", "using that"], ["proof (prove)\nusing this:\n  n-smooth_on S f\n  open S\n\ngoal (1 subgoal):\n 1. n-smooth_on S (\\<lambda>x. cos (f x))", "by (auto simp: smooth_on_def intro!: higher_differentiable_on_cos)"], ["", "lemma smooth_on_Taylor2E:\n  fixes f::\"'a::euclidean_space \\<Rightarrow> real\"\n  assumes hd: \"\\<infinity>-smooth_on UNIV f\"\n  obtains g where \"\\<And>Y.\n    f Y = f X + frechet_derivative f (at X) (Y - X) + (\\<Sum>i\\<in>Basis. (\\<Sum>j\\<in>Basis. ((Y - X) \\<bullet> j) * ((Y - X) \\<bullet> i) * g i j Y))\"\n    \"\\<And>i j. i \\<in> Basis \\<Longrightarrow> j \\<in> Basis \\<Longrightarrow> \\<infinity>-smooth_on UNIV (g i j)\"\n    \\<comment>\\<open>TODO: generalize\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define S::\"'a set\" where \"S = UNIV\""], ["proof (state)\nthis:\n  S = UNIV\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"open S\" and \"convex S\" \"X \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open S &&& convex S &&& X \\<in> S", "by (auto simp: S_def)"], ["proof (state)\nthis:\n  open S\n  convex S\n  X \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have hd: \"\\<infinity>-smooth_on S f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. smooth_on S f", "using hd"], ["proof (prove)\nusing this:\n  smooth_on UNIV f\n\ngoal (1 subgoal):\n 1. smooth_on S f", "by (auto simp: S_def)"], ["proof (state)\nthis:\n  smooth_on S f\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define i where \"i H x = ((1 - x)) *\\<^sub>R nth_derivative 2 f (X + x *\\<^sub>R H) H\" for x H"], ["proof (state)\nthis:\n  i ?H ?x = (1 - ?x) *\\<^sub>R nth_derivative 2 f (X + ?x *\\<^sub>R ?H) ?H\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define d2 where \"d2 v v' = (\\<lambda>x. frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v') (at x) v)\" for v v'"], ["proof (state)\nthis:\n  d2 ?v ?v' =\n  (\\<lambda>x.\n      frechet_derivative (\\<lambda>x. frechet_derivative f (at x) ?v')\n       (at x) ?v)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define g where \"g H x i j = d2 i j (X + x *\\<^sub>R H)\" for i j x H"], ["proof (state)\nthis:\n  g ?H ?x ?i ?j = d2 ?i ?j (X + ?x *\\<^sub>R ?H)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define g' where  \"g' i j H = integral {0 .. 1} (\\<lambda>x. (1 - x) * g H x i j)\" for i j H"], ["proof (state)\nthis:\n  g' ?i ?j ?H = integral {0..1} (\\<lambda>x. (1 - x) * g ?H x ?i ?j)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"higher_differentiable_on S f 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 2", "using hd(1)"], ["proof (prove)\nusing this:\n  smooth_on S f\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f 2", "by (auto simp: smooth_on_def dest!: spec[where x=2])"], ["proof (state)\nthis:\n  higher_differentiable_on S f 2\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note hd2 = this \\<open>open S\\<close>"], ["proof (state)\nthis:\n  higher_differentiable_on S f 2\n  open S\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have d2_cont: \"continuous_on S (d2 i j)\" for i j"], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on S (d2 i j)", "using hd2(1)"], ["proof (prove)\nusing this:\n  higher_differentiable_on S f 2\n\ngoal (1 subgoal):\n 1. continuous_on S (d2 i j)", "by (auto simp: g_def numeral_2_eq_2 higher_differentiable_on.simps d2_def)"], ["proof (state)\nthis:\n  continuous_on S (d2 ?i ?j)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note [continuous_intros] = continuous_on_compose2[OF d2_cont]"], ["proof (state)\nthis:\n  \\<lbrakk>continuous_on ?s ?f; ?f ` ?s \\<subseteq> S\\<rbrakk>\n  \\<Longrightarrow> continuous_on ?s (\\<lambda>x. d2 ?i1 ?j1 (?f x))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have hdiff2: \"\\<infinity>-smooth_on S (d2 v v')\" for v v'"], ["proof (prove)\ngoal (1 subgoal):\n 1. smooth_on S (d2 v v')", "apply (auto simp: d2_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. smooth_on S\n     (\\<lambda>x.\n         frechet_derivative (\\<lambda>x. frechet_derivative f (at x) v')\n          (at x) v)", "apply (rule smooth_on_frechet_derivivative_comp)"], ["proof (prove)\ngoal (6 subgoals):\n 1. smooth_on UNIV (\\<lambda>x. frechet_derivative f (at x) v')\n 2. smooth_on ?S (\\<lambda>x. x)\n 3. open S\n 4. open UNIV\n 5. (\\<lambda>x. x) ` S \\<subseteq> UNIV\n 6. S \\<subseteq> ?S", "apply (rule smooth_on_frechet_derivivative_comp)"], ["proof (prove)\ngoal (11 subgoals):\n 1. smooth_on UNIV f\n 2. smooth_on ?S7 (\\<lambda>x. x)\n 3. open UNIV\n 4. open UNIV\n 5. range (\\<lambda>x. x) \\<subseteq> UNIV\n 6. UNIV \\<subseteq> ?S7\n 7. smooth_on ?S (\\<lambda>x. x)\n 8. open S\n 9. open UNIV\n 10. (\\<lambda>x. x) ` S \\<subseteq> UNIV\nA total of 11 subgoals...", "by (auto simp: S_def assms)"], ["proof (state)\nthis:\n  smooth_on S (d2 ?v ?v')\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "{"], ["proof (state)\nthis:\n  smooth_on S (d2 ?v ?v')\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "fix Y"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "assume \"Y \\<in> S\""], ["proof (state)\nthis:\n  Y \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define H where \"H = Y - X\""], ["proof (state)\nthis:\n  H = Y - X\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from \\<open>Y \\<in> S\\<close>"], ["proof (chain)\npicking this:\n  Y \\<in> S", "have \"X + H \\<in> S\""], ["proof (prove)\nusing this:\n  Y \\<in> S\n\ngoal (1 subgoal):\n 1. X + H \\<in> S", "by (simp add: H_def)"], ["proof (state)\nthis:\n  X + H \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "with \\<open>X \\<in> S\\<close>"], ["proof (chain)\npicking this:\n  X \\<in> S\n  X + H \\<in> S", "have cs: \"closed_segment X (X + H) \\<subseteq> S\""], ["proof (prove)\nusing this:\n  X \\<in> S\n  X + H \\<in> S\n\ngoal (1 subgoal):\n 1. closed_segment X (X + H) \\<subseteq> S", "using \\<open>convex S\\<close>"], ["proof (prove)\nusing this:\n  X \\<in> S\n  X + H \\<in> S\n  convex S\n\ngoal (1 subgoal):\n 1. closed_segment X (X + H) \\<subseteq> S", "by (rule closed_segment_subset)"], ["proof (state)\nthis:\n  closed_segment X (X + H) \\<subseteq> S\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have i: \"(i H has_integral f (X + H) - (f X + nth_derivative 1 f X H)) {0..1}\"\n      \"f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} (i H)\"\n      \"i H integrable_on {0..1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (i H has_integral f (X + H) - (f X + nth_derivative 1 f X H)) {0..1} &&&\n    f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} (i H) &&&\n    i H integrable_on {0..1}", "unfolding i_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         (1 - x) *\\<^sub>R\n         nth_derivative 2 f (X + x *\\<^sub>R H) H) has_integral\n     f (X + H) - (f X + nth_derivative 1 f X H))\n     {0..1} &&&\n    f (X + H) =\n    f X + nth_derivative 1 f X H +\n    integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\\<^sub>R nth_derivative 2 f (X + x *\\<^sub>R H) H) &&&\n    (\\<lambda>x.\n        (1 - x) *\\<^sub>R\n        nth_derivative 2 f (X + x *\\<^sub>R H) H) integrable_on\n    {0..1}", "using higher_differentiable_Taylor1[OF hd2 cs]"], ["proof (prove)\nusing this:\n  ((\\<lambda>x.\n       (1 - x) *\\<^sub>R\n       nth_derivative 2 f (X + x *\\<^sub>R H) H) has_integral\n   f (X + H) - (f X + nth_derivative 1 f X H))\n   {0..1}\n  f (X + H) =\n  f X + nth_derivative 1 f X H +\n  integral {0..1}\n   (\\<lambda>x. (1 - x) *\\<^sub>R nth_derivative 2 f (X + x *\\<^sub>R H) H)\n  (\\<lambda>x.\n      (1 - x) *\\<^sub>R\n      nth_derivative 2 f (X + x *\\<^sub>R H) H) integrable_on\n  {0..1}\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         (1 - x) *\\<^sub>R\n         nth_derivative 2 f (X + x *\\<^sub>R H) H) has_integral\n     f (X + H) - (f X + nth_derivative 1 f X H))\n     {0..1} &&&\n    f (X + H) =\n    f X + nth_derivative 1 f X H +\n    integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\\<^sub>R nth_derivative 2 f (X + x *\\<^sub>R H) H) &&&\n    (\\<lambda>x.\n        (1 - x) *\\<^sub>R\n        nth_derivative 2 f (X + x *\\<^sub>R H) H) integrable_on\n    {0..1}", "by auto"], ["proof (state)\nthis:\n  (i H has_integral f (X + H) - (f X + nth_derivative 1 f X H)) {0..1}\n  f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} (i H)\n  i H integrable_on {0..1}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note i(2)"], ["proof (state)\nthis:\n  f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} (i H)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  f (X + H) = f X + nth_derivative 1 f X H + integral {0..1} (i H)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have integrable: \"(\\<lambda>x. \\<Sum>n\\<in>Basis. (1 - x) * (g H x a n * (H \\<bullet> n) * (H \\<bullet> a))) integrable_on {0..1}\"\n      \"(\\<lambda>x. (1 - x) * (g H x n a * (H \\<bullet> a) * (H \\<bullet> n))) integrable_on {0..1}\" \n      for a n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        \\<Sum>n\\<in>Basis.\n          (1 - x) *\n          (g H x a n * (H \\<bullet> n) * (H \\<bullet> a))) integrable_on\n    {0..1} &&&\n    (\\<lambda>x.\n        (1 - x) *\n        (g H x n a * (H \\<bullet> a) * (H \\<bullet> n))) integrable_on\n    {0..1}", "by (auto intro!: integrable_continuous_interval continuous_intros closed_segment_subsetD\n          cs simp: g_def)"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      \\<Sum>n\\<in>Basis.\n        (1 - x) *\n        (g H x ?a n * (H \\<bullet> n) * (H \\<bullet> ?a))) integrable_on\n  {0..1}\n  (\\<lambda>x.\n      (1 - x) *\n      (g H x ?n ?a * (H \\<bullet> ?a) * (H \\<bullet> ?n))) integrable_on\n  {0..1}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have i_eq: \"i H x = (1 - x) *\\<^sub>R (\\<Sum>i\\<in>Basis. (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) * (H \\<bullet> i))\"\n      if \"0 \\<le> x\" \"x \\<le> 1\"\n      for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. i H x =\n    (1 - x) *\\<^sub>R\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) * (H \\<bullet> i))", "unfolding i_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (1 - x) *\\<^sub>R nth_derivative 2 f (X + x *\\<^sub>R H) H =\n    (1 - x) *\\<^sub>R\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) * (H \\<bullet> i))", "apply (subst second_derivative_componentwise[OF hd2])"], ["proof (prove)\ngoal (2 subgoals):\n 1. X + x *\\<^sub>R H \\<in> S\n 2. (1 - x) *\\<^sub>R\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at (X + x *\\<^sub>R H)) i *\n          (H \\<bullet> j)) *\n       (H \\<bullet> i)) =\n    (1 - x) *\\<^sub>R\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) * (H \\<bullet> i))", "apply (rule closed_segment_subsetD, rule cs, rule that, rule that)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (1 - x) *\\<^sub>R\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis.\n          frechet_derivative (\\<lambda>a. frechet_derivative f (at a) j)\n           (at (X + x *\\<^sub>R H)) i *\n          (H \\<bullet> j)) *\n       (H \\<bullet> i)) =\n    (1 - x) *\\<^sub>R\n    (\\<Sum>i\\<in>Basis.\n       (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) * (H \\<bullet> i))", "by (simp add: g_def d2_def)"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?x; ?x \\<le> 1\\<rbrakk>\n  \\<Longrightarrow> i H ?x =\n                    (1 - ?x) *\\<^sub>R\n                    (\\<Sum>i\\<in>Basis.\n                       (\\<Sum>j\\<in>Basis. g H ?x i j * (H \\<bullet> j)) *\n                       (H \\<bullet> i))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"integral {0 .. 1} (i H) = integral {0..1} (\\<lambda>x. (1 - x) * (\\<Sum>i\\<in>Basis. (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) * (H \\<bullet> i)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..1} (i H) =\n    integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\n         (\\<Sum>i\\<in>Basis.\n            (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n            (H \\<bullet> i)))", "apply (subst integral_spike[OF negligible_empty])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> {0..1} - {} \\<Longrightarrow> ?g x = i H x\n 2. integral {0..1} ?g =\n    integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\n         (\\<Sum>i\\<in>Basis.\n            (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n            (H \\<bullet> i)))", "apply (rule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x. x \\<in> {0..1} - {} \\<Longrightarrow> i H x = ?g x\n 2. integral {0..1} ?g =\n    integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\n         (\\<Sum>i\\<in>Basis.\n            (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n            (H \\<bullet> i)))", "apply (rule i_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x. x \\<in> {0..1} - {} \\<Longrightarrow> 0 \\<le> x\n 2. \\<And>x. x \\<in> {0..1} - {} \\<Longrightarrow> x \\<le> 1\n 3. integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\\<^sub>R\n         (\\<Sum>i\\<in>Basis.\n            (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n            (H \\<bullet> i))) =\n    integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\n         (\\<Sum>i\\<in>Basis.\n            (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n            (H \\<bullet> i)))", "by (auto simp: that)"], ["proof (state)\nthis:\n  integral {0..1} (i H) =\n  integral {0..1}\n   (\\<lambda>x.\n       (1 - x) *\n       (\\<Sum>i\\<in>Basis.\n          (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n          (H \\<bullet> i)))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  integral {0..1} (i H) =\n  integral {0..1}\n   (\\<lambda>x.\n       (1 - x) *\n       (\\<Sum>i\\<in>Basis.\n          (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n          (H \\<bullet> i)))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<dots> = (\\<Sum>i\\<in>Basis. (\\<Sum>j\\<in>Basis. (H \\<bullet> j) * (H \\<bullet> i) * g' i j H))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. integral {0..1}\n     (\\<lambda>x.\n         (1 - x) *\n         (\\<Sum>i\\<in>Basis.\n            (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n            (H \\<bullet> i))) =\n    (\\<Sum>i\\<in>Basis.\n       \\<Sum>j\\<in>Basis. H \\<bullet> j * (H \\<bullet> i) * g' i j H)", "apply (simp add: sum_distrib_left sum_distrib_right integral_sum integrable g'_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n\\<in>Basis.\n       \\<Sum>na\\<in>Basis.\n         integral {0..1}\n          (\\<lambda>x.\n              (1 - x) *\n              (g H x n na * (H \\<bullet> na) * (H \\<bullet> n)))) =\n    (\\<Sum>i\\<in>Basis.\n       \\<Sum>j\\<in>Basis.\n         H \\<bullet> j * (H \\<bullet> i) *\n         integral {0..1} (\\<lambda>x. (1 - x) * g H x i j))", "apply (simp add: integral_mult_right[symmetric] del: integral_mult_right)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>n\\<in>Basis.\n       \\<Sum>na\\<in>Basis.\n         integral {0..1}\n          (\\<lambda>x.\n              (1 - x) *\n              (g H x n na * (H \\<bullet> na) * (H \\<bullet> n)))) =\n    (\\<Sum>i\\<in>Basis.\n       \\<Sum>j\\<in>Basis.\n         integral {0..1}\n          (\\<lambda>x.\n              H \\<bullet> j * (H \\<bullet> i) * ((1 - x) * g H x i j)))", "by (simp only: ac_simps)"], ["proof (state)\nthis:\n  integral {0..1}\n   (\\<lambda>x.\n       (1 - x) *\n       (\\<Sum>i\\<in>Basis.\n          (\\<Sum>j\\<in>Basis. g H x i j * (H \\<bullet> j)) *\n          (H \\<bullet> i))) =\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis. H \\<bullet> j * (H \\<bullet> i) * g' i j H)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "finally"], ["proof (chain)\npicking this:\n  f (X + H) =\n  f X + nth_derivative 1 f X H +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis. H \\<bullet> j * (H \\<bullet> i) * g' i j H)", "have \"f (X + H) = f X + nth_derivative 1 f X H + (\\<Sum>i\\<in>Basis. \\<Sum>j\\<in>Basis. H \\<bullet> j * (H \\<bullet> i) * g' i j H)\""], ["proof (prove)\nusing this:\n  f (X + H) =\n  f X + nth_derivative 1 f X H +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis. H \\<bullet> j * (H \\<bullet> i) * g' i j H)\n\ngoal (1 subgoal):\n 1. f (X + H) =\n    f X + nth_derivative 1 f X H +\n    (\\<Sum>i\\<in>Basis.\n       \\<Sum>j\\<in>Basis. H \\<bullet> j * (H \\<bullet> i) * g' i j H)", "."], ["proof (state)\nthis:\n  f (X + H) =\n  f X + nth_derivative 1 f X H +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis. H \\<bullet> j * (H \\<bullet> i) * g' i j H)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "}"], ["proof (state)\nthis:\n  ?Y2 \\<in> S \\<Longrightarrow>\n  f (X + (?Y2 - X)) =\n  f X + nth_derivative 1 f X (?Y2 - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (?Y2 - X) \\<bullet> j * ((?Y2 - X) \\<bullet> i) * g' i j (?Y2 - X))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note * = this"], ["proof (state)\nthis:\n  ?Y2 \\<in> S \\<Longrightarrow>\n  f (X + (?Y2 - X)) =\n  f X + nth_derivative 1 f X (?Y2 - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (?Y2 - X) \\<bullet> j * ((?Y2 - X) \\<bullet> i) * g' i j (?Y2 - X))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"f Y = f X + frechet_derivative f (at X) (Y - X) + (\\<Sum>i\\<in>Basis. \\<Sum>j\\<in>Basis. (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) * g' i j (Y - X))\"\n    for Y"], ["proof (prove)\ngoal (1 subgoal):\n 1. f Y =\n    f X + frechet_derivative f (at X) (Y - X) +\n    (\\<Sum>i\\<in>Basis.\n       \\<Sum>j\\<in>Basis.\n         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) * g' i j (Y - X))", "using *[of Y]"], ["proof (prove)\nusing this:\n  Y \\<in> S \\<Longrightarrow>\n  f (X + (Y - X)) =\n  f X + nth_derivative 1 f X (Y - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) * g' i j (Y - X))\n\ngoal (1 subgoal):\n 1. f Y =\n    f X + frechet_derivative f (at X) (Y - X) +\n    (\\<Sum>i\\<in>Basis.\n       \\<Sum>j\\<in>Basis.\n         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) * g' i j (Y - X))", "by (auto simp: S_def)"], ["proof (state)\nthis:\n  f ?Y =\n  f X + frechet_derivative f (at X) (?Y - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (?Y - X) \\<bullet> j * ((?Y - X) \\<bullet> i) * g' i j (?Y - X))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "moreover"], ["proof (state)\nthis:\n  f ?Y =\n  f X + frechet_derivative f (at X) (?Y - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (?Y - X) \\<bullet> j * ((?Y - X) \\<bullet> i) * g' i j (?Y - X))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "define T::\"real set\" where \"T = {- 1<..<2}\""], ["proof (state)\nthis:\n  T = {- 1<..<2}\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"open T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open T", "by (auto simp: T_def)"], ["proof (state)\nthis:\n  open T\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"{0 .. 1} \\<subseteq> T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0..1} \\<subseteq> T", "by (auto simp: T_def)"], ["proof (state)\nthis:\n  {0..1} \\<subseteq> T\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have T_small: \"a \\<in> S \\<Longrightarrow> b \\<in> T \\<Longrightarrow> X + b *\\<^sub>R (a - X) \\<in> S\" for a b"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> S; b \\<in> T\\<rbrakk>\n    \\<Longrightarrow> X + b *\\<^sub>R (a - X) \\<in> S", "by (auto simp: S_def)"], ["proof (state)\nthis:\n  \\<lbrakk>?a \\<in> S; ?b \\<in> T\\<rbrakk>\n  \\<Longrightarrow> X + ?b *\\<^sub>R (?a - X) \\<in> S\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"open (S \\<times> T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. open (S \\<times> T)", "by (auto intro: open_Times \\<open>open S\\<close> \\<open>open T\\<close>)"], ["proof (state)\nthis:\n  open (S \\<times> T)\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"smooth_on S (\\<lambda>Y. g' i j (Y - X))\" if i: \"i \\<in> Basis\" and j: \"j \\<in> Basis\" for i j"], ["proof (prove)\ngoal (1 subgoal):\n 1. smooth_on S (\\<lambda>Y. g' i j (Y - X))", "unfolding smooth_on_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>n.\n       enat n \\<le> \\<infinity> \\<longrightarrow>\n       higher_differentiable_on S (\\<lambda>Y. g' i j (Y - X)) n", "apply safe"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> \\<infinity> \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>Y. g' i j (Y - X)) n", "apply (simp add: g'_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       higher_differentiable_on S\n        (\\<lambda>Y.\n            integral {0..1} (\\<lambda>x. (1 - x) * g (Y - X) x i j))\n        n", "apply (rule leibniz_rule'_higher_interval)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n. convex S\n 2. \\<And>n. open S\n 3. \\<And>n.\n       higher_differentiable_on (S \\<times> {0..1})\n        (\\<lambda>(Y, t). (1 - t) * g (Y - X) t i j) n", "apply fact"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n. open S\n 2. \\<And>n.\n       higher_differentiable_on (S \\<times> {0..1})\n        (\\<lambda>(Y, t). (1 - t) * g (Y - X) t i j) n", "apply fact"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       higher_differentiable_on (S \\<times> {0..1})\n        (\\<lambda>(Y, t). (1 - t) * g (Y - X) t i j) n", "apply (rule higher_differentiable_on_subset[where T=\"S \\<times> T\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>(Y, t). (1 - t) * g (Y - X) t i j) n\n 2. \\<And>n. S \\<times> {0..1} \\<subseteq> S \\<times> T", "apply (auto intro!: higher_differentiable_on_mult simp: split_beta')"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       higher_differentiable_on (S \\<times> T) (\\<lambda>x. 1 - snd x) n\n 2. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 3. open (S \\<times> T)\n 4. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (subst diff_conv_add_uminus)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       higher_differentiable_on (S \\<times> T) (\\<lambda>x. 1 + - snd x) n\n 2. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 3. open (S \\<times> T)\n 4. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule higher_differentiable_on_add)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n. higher_differentiable_on (S \\<times> T) (\\<lambda>x. 1) n\n 2. \\<And>n. higher_differentiable_on (S \\<times> T) (\\<lambda>x. - snd x) n\n 3. \\<And>n. open (S \\<times> T)\n 4. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 5. open (S \\<times> T)\n 6. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule higher_differentiable_on_const)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n. higher_differentiable_on (S \\<times> T) (\\<lambda>x. - snd x) n\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 4. open (S \\<times> T)\n 5. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (subst scaleR_minus1_left[symmetric])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. - 1 *\\<^sub>R snd x) n\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 4. open (S \\<times> T)\n 5. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule higher_differentiable_on_scaleR)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>n. higher_differentiable_on (S \\<times> T) (\\<lambda>x. - 1) n\n 2. \\<And>n. higher_differentiable_on (S \\<times> T) snd n\n 3. \\<And>n. open (S \\<times> T)\n 4. \\<And>n. open (S \\<times> T)\n 5. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 6. open (S \\<times> T)\n 7. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule higher_differentiable_on_const)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n. higher_differentiable_on (S \\<times> T) snd n\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n. open (S \\<times> T)\n 4. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 5. open (S \\<times> T)\n 6. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule higher_differentiable_on_snd_comp)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>n. higher_differentiable_on (S \\<times> T) (\\<lambda>x. x) n\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n. open (S \\<times> T)\n 4. \\<And>n. open (S \\<times> T)\n 5. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 6. open (S \\<times> T)\n 7. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule higher_differentiable_on_id)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n. open (S \\<times> T)\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n. open (S \\<times> T)\n 4. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 5. open (S \\<times> T)\n 6. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply fact"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n. open (S \\<times> T)\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 4. open (S \\<times> T)\n 5. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply fact"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n. open (S \\<times> T)\n 2. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 3. open (S \\<times> T)\n 4. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply fact"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. g (fst x - X) (snd x) i j) n\n 2. open (S \\<times> T)\n 3. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (auto simp: g_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. d2 i j (X + snd x *\\<^sub>R (fst x - X))) n\n 2. open (S \\<times> T)\n 3. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule smooth_onD)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       (?m46 n)-smooth_on (S \\<times> T)\n        (\\<lambda>x. d2 i j (X + snd x *\\<^sub>R (fst x - X)))\n 2. \\<And>n. enat n \\<le> ?m46 n\n 3. open (S \\<times> T)\n 4. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "apply (rule smooth_on_compose2[OF hdiff2, unfolded o_def])"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>n.\n       smooth_on (?S49 n) (\\<lambda>x. X + snd x *\\<^sub>R (fst x - X))\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n. open S\n 4. \\<And>n.\n       (\\<lambda>x. X + snd x *\\<^sub>R (fst x - X)) ` (S \\<times> T)\n       \\<subseteq> S\n 5. \\<And>n. S \\<times> T \\<subseteq> ?S49 n\n 6. \\<And>n. enat n \\<le> \\<infinity>\n 7. open (S \\<times> T)\n 8. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "using \\<open>open S\\<close> \\<open>open T\\<close>"], ["proof (prove)\nusing this:\n  open S\n  open T\n\ngoal (8 subgoals):\n 1. \\<And>n.\n       smooth_on (?S49 n) (\\<lambda>x. X + snd x *\\<^sub>R (fst x - X))\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n. open S\n 4. \\<And>n.\n       (\\<lambda>x. X + snd x *\\<^sub>R (fst x - X)) ` (S \\<times> T)\n       \\<subseteq> S\n 5. \\<And>n. S \\<times> T \\<subseteq> ?S49 n\n 6. \\<And>n. enat n \\<le> \\<infinity>\n 7. open (S \\<times> T)\n 8. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "using T_small \\<open>_ \\<subseteq> T\\<close>"], ["proof (prove)\nusing this:\n  open S\n  open T\n  \\<lbrakk>?a \\<in> S; ?b \\<in> T\\<rbrakk>\n  \\<Longrightarrow> X + ?b *\\<^sub>R (?a - X) \\<in> S\n  {0..1} \\<subseteq> T\n\ngoal (8 subgoals):\n 1. \\<And>n.\n       smooth_on (?S49 n) (\\<lambda>x. X + snd x *\\<^sub>R (fst x - X))\n 2. \\<And>n. open (S \\<times> T)\n 3. \\<And>n. open S\n 4. \\<And>n.\n       (\\<lambda>x. X + snd x *\\<^sub>R (fst x - X)) ` (S \\<times> T)\n       \\<subseteq> S\n 5. \\<And>n. S \\<times> T \\<subseteq> ?S49 n\n 6. \\<And>n. enat n \\<le> \\<infinity>\n 7. open (S \\<times> T)\n 8. \\<And>a b.\n       \\<lbrakk>a \\<in> S; 0 \\<le> b; b \\<le> 1\\<rbrakk>\n       \\<Longrightarrow> b \\<in> T", "by (auto intro!: open_Times smooth_on_add smooth_on_scaleR smooth_on_snd\n        smooth_on_minus smooth_on_fst)"], ["proof (state)\nthis:\n  \\<lbrakk>?i \\<in> Basis; ?j \\<in> Basis\\<rbrakk>\n  \\<Longrightarrow> smooth_on S (\\<lambda>Y. g' ?i ?j (Y - X))\n\ngoal (1 subgoal):\n 1. (\\<And>g.\n        \\<lbrakk>\\<And>Y.\n                    f Y =\n                    f X + frechet_derivative f (at X) (Y - X) +\n                    (\\<Sum>i\\<in>Basis.\n                       \\<Sum>j\\<in>Basis.\n                         (Y - X) \\<bullet> j * ((Y - X) \\<bullet> i) *\n                         g i j Y);\n         \\<And>i j.\n            \\<lbrakk>i \\<in> Basis; j \\<in> Basis\\<rbrakk>\n            \\<Longrightarrow> smooth_on UNIV (g i j)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "ultimately"], ["proof (chain)\npicking this:\n  f ?Y =\n  f X + frechet_derivative f (at X) (?Y - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (?Y - X) \\<bullet> j * ((?Y - X) \\<bullet> i) * g' i j (?Y - X))\n  \\<lbrakk>?i \\<in> Basis; ?j \\<in> Basis\\<rbrakk>\n  \\<Longrightarrow> smooth_on S (\\<lambda>Y. g' ?i ?j (Y - X))", "show ?thesis"], ["proof (prove)\nusing this:\n  f ?Y =\n  f X + frechet_derivative f (at X) (?Y - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (?Y - X) \\<bullet> j * ((?Y - X) \\<bullet> i) * g' i j (?Y - X))\n  \\<lbrakk>?i \\<in> Basis; ?j \\<in> Basis\\<rbrakk>\n  \\<Longrightarrow> smooth_on S (\\<lambda>Y. g' ?i ?j (Y - X))\n\ngoal (1 subgoal):\n 1. thesis", "unfolding S_def"], ["proof (prove)\nusing this:\n  f ?Y =\n  f X + frechet_derivative f (at X) (?Y - X) +\n  (\\<Sum>i\\<in>Basis.\n     \\<Sum>j\\<in>Basis.\n       (?Y - X) \\<bullet> j * ((?Y - X) \\<bullet> i) * g' i j (?Y - X))\n  \\<lbrakk>?i \\<in> Basis; ?j \\<in> Basis\\<rbrakk>\n  \\<Longrightarrow> smooth_on UNIV (\\<lambda>Y. g' ?i ?j (Y - X))\n\ngoal (1 subgoal):\n 1. thesis", ".."], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma smooth_on_Pair:\n  \"k-smooth_on S (\\<lambda>x. (f x, g x))\"\n  if \"open S\" \"k-smooth_on S f\" \"k-smooth_on S g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on S (\\<lambda>x. (f x, g x))", "proof (auto simp: smooth_on_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>x. (f x, g x)) n", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>x. (f x, g x)) n", "assume n: \"enat n \\<le> k\""], ["proof (state)\nthis:\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>x. (f x, g x)) n", "have 1: \"higher_differentiable_on S f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using that(2) n"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "unfolding smooth_on_def"], ["proof (prove)\nusing this:\n  \\<forall>n.\n     enat n \\<le> k \\<longrightarrow> higher_differentiable_on S f n\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by auto"], ["proof (state)\nthis:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>x. (f x, g x)) n", "have 2: \"higher_differentiable_on S g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S g n", "using that(3) n"], ["proof (prove)\nusing this:\n  k-smooth_on S g\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S g n", "unfolding smooth_on_def"], ["proof (prove)\nusing this:\n  \\<forall>n.\n     enat n \\<le> k \\<longrightarrow> higher_differentiable_on S g n\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S g n", "by auto"], ["proof (state)\nthis:\n  higher_differentiable_on S g n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on S (\\<lambda>x. (f x, g x)) n", "show \"higher_differentiable_on S (\\<lambda>x. (f x, g x)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S (\\<lambda>x. (f x, g x)) n", "by (rule higher_differentiable_on_Pair [OF that(1) 1 2])"], ["proof (state)\nthis:\n  higher_differentiable_on S (\\<lambda>x. (f x, g x)) n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma smooth_on_Pair':\n  \"k-smooth_on (S \\<times> T) (\\<lambda>x. (f (fst x), g (snd x)))\"\n  if \"open S\" \"open T\" \"k-smooth_on S f\" \"k-smooth_on T g\"\n  for f::\"_::euclidean_space\\<Rightarrow>_\" and g::\"_::euclidean_space\\<Rightarrow>_\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k-smooth_on (S \\<times> T) (\\<lambda>x. (f (fst x), g (snd x)))", "proof (auto simp: smooth_on_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. (f (fst x), g (snd x))) n", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. (f (fst x), g (snd x))) n", "assume n: \"enat n \\<le> k\""], ["proof (state)\nthis:\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. (f (fst x), g (snd x))) n", "have 1: \"higher_differentiable_on S f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "using that(3) n"], ["proof (prove)\nusing this:\n  k-smooth_on S f\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "unfolding smooth_on_def"], ["proof (prove)\nusing this:\n  \\<forall>n.\n     enat n \\<le> k \\<longrightarrow> higher_differentiable_on S f n\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on S f n", "by auto"], ["proof (state)\nthis:\n  higher_differentiable_on S f n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. (f (fst x), g (snd x))) n", "have 2: \"higher_differentiable_on T g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on T g n", "using that(4) n"], ["proof (prove)\nusing this:\n  k-smooth_on T g\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on T g n", "unfolding smooth_on_def"], ["proof (prove)\nusing this:\n  \\<forall>n.\n     enat n \\<le> k \\<longrightarrow> higher_differentiable_on T g n\n  enat n \\<le> k\n\ngoal (1 subgoal):\n 1. higher_differentiable_on T g n", "by auto"], ["proof (state)\nthis:\n  higher_differentiable_on T g n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       enat n \\<le> k \\<Longrightarrow>\n       higher_differentiable_on (S \\<times> T)\n        (\\<lambda>x. (f (fst x), g (snd x))) n", "show \"higher_differentiable_on (S \\<times> T) (\\<lambda>x. (f (fst x), g (snd x))) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. higher_differentiable_on (S \\<times> T)\n     (\\<lambda>x. (f (fst x), g (snd x))) n", "by (rule higher_differentiable_on_Pair'[OF that(1,2) 1 2])"], ["proof (state)\nthis:\n  higher_differentiable_on (S \\<times> T)\n   (\\<lambda>x. (f (fst x), g (snd x))) n\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Diffeomorphism\\<close>"], ["", "definition \"diffeomorphism k S T p p' \\<longleftrightarrow>\n  k-smooth_on S p \\<and> k-smooth_on T p' \\<and> homeomorphism S T p p'\""], ["", "lemma diffeomorphism_imp_homeomorphism:\n  assumes \"diffeomorphism k s t p p'\"\n  shows  \"homeomorphism s t p p'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homeomorphism s t p p'", "using assms"], ["proof (prove)\nusing this:\n  diffeomorphism k s t p p'\n\ngoal (1 subgoal):\n 1. homeomorphism s t p p'", "by (auto simp: diffeomorphism_def)"], ["", "lemma diffeomorphismD:\n  assumes \"diffeomorphism k S T f g\"\n  shows diffeomorphism_smoothD: \"k-smooth_on S f\" \"k-smooth_on T g\"\n    and diffeomorphism_inverseD: \"\\<And>x. x \\<in> S \\<Longrightarrow> g (f x) = x\" \"\\<And>y. y \\<in> T \\<Longrightarrow> f (g y) = y\"\n    and diffeomorphism_image_eq: \"(f ` S = T)\" \"(g ` T = S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (k-smooth_on S f &&& k-smooth_on T g) &&&\n    ((\\<And>x. x \\<in> S \\<Longrightarrow> g (f x) = x) &&&\n     (\\<And>y. y \\<in> T \\<Longrightarrow> f (g y) = y)) &&&\n    f ` S = T &&& g ` T = S", "using assms"], ["proof (prove)\nusing this:\n  diffeomorphism k S T f g\n\ngoal (1 subgoal):\n 1. (k-smooth_on S f &&& k-smooth_on T g) &&&\n    ((\\<And>x. x \\<in> S \\<Longrightarrow> g (f x) = x) &&&\n     (\\<And>y. y \\<in> T \\<Longrightarrow> f (g y) = y)) &&&\n    f ` S = T &&& g ` T = S", "by (auto simp: diffeomorphism_def homeomorphism_def)"], ["", "lemma diffeomorphism_compose:\n  \"diffeomorphism n S T f g \\<Longrightarrow> diffeomorphism n T U h k \\<Longrightarrow> open S \\<Longrightarrow> open T \\<Longrightarrow> open U \\<Longrightarrow>\n    diffeomorphism n S U (h \\<circ> f) (g \\<circ> k)\"\n  for f::\"_\\<Rightarrow>_::euclidean_space\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>diffeomorphism n S T f g; diffeomorphism n T U h k; open S;\n     open T; open U\\<rbrakk>\n    \\<Longrightarrow> diffeomorphism n S U (h \\<circ> f) (g \\<circ> k)", "by (auto simp: diffeomorphism_def intro!: smooth_on_compose homeomorphism_compose)\n    (auto simp: homeomorphism_def)"], ["", "lemma diffeomorphism_add: \"diffeomorphism k UNIV UNIV (\\<lambda>x. x + c) (\\<lambda>x. x - c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diffeomorphism k UNIV UNIV (\\<lambda>x. x + c) (\\<lambda>x. x - c)", "by (auto simp: diffeomorphism_def homeomorphism_add intro!: smooth_on_minus smooth_on_add)"], ["", "lemma diffeomorphism_scaleR: \"diffeomorphism k UNIV UNIV (\\<lambda>x. c *\\<^sub>R x) (\\<lambda>x. x /\\<^sub>R c)\"\n  if \"c \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. diffeomorphism k UNIV UNIV ((*\\<^sub>R) c) (\\<lambda>x. x /\\<^sub>R c)", "by (auto simp: that diffeomorphism_def homeomorphism_scaleR\n      intro!: smooth_on_minus smooth_on_scaleR)"], ["", "end"]]}