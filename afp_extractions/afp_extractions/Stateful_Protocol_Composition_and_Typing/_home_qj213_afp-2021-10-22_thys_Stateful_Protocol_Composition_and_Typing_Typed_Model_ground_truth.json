{"file_name": "/home/qj213/afp-2021-10-22/thys/Stateful_Protocol_Composition_and_Typing/Typed_Model.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Stateful_Protocol_Composition_and_Typing", "problem_names": ["lemma tfr\\<^sub>s\\<^sub>t\\<^sub>p_list_all_alt_def:\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<longleftrightarrow>\n    ((\\<forall>a t t'. Equality a t t' \\<in> set S \\<and> (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow> \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F. Inequality X F \\<in> set S \\<longrightarrow> \n      (\\<forall>x \\<in> fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X. \\<exists>a. \\<Gamma> (Var x) = TAtom a)\n    \\<or> (\\<forall>f T. Fun f T \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F) \\<longrightarrow> T = [] \\<or> (\\<exists>s \\<in> set T. s \\<notin> Var ` set X))))\"\n  (is \"?P S \\<longleftrightarrow> ?Q S\")", "lemma \\<Gamma>_wf': \"wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> t)\"", "lemma fun_type_inv: assumes \"\\<Gamma> t = TComp f T\" shows \"arity f > 0\" \"public f\"", "lemma fun_type_inv_wf: assumes \"\\<Gamma> t = TComp f T\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" shows \"arity f = length T\"", "lemma const_type_inv: \"\\<Gamma> (Fun c X) = TAtom a \\<Longrightarrow> arity c = 0\"", "lemma const_type_inv_wf: assumes \"\\<Gamma> (Fun c X) = TAtom a\" and \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c X)\" shows \"X = []\"", "lemma const_type': \"\\<forall>c \\<in> \\<C>. \\<exists>a \\<in> \\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun c X) = TAtom a\"", "lemma fun_type': \"\\<forall>f \\<in> \\<Sigma>\\<^sub>f. \\<forall>X. \\<Gamma> (Fun f X) = TComp f (map \\<Gamma> X)\"", "lemma infinite_public_consts[simp]: \"infinite {c. public c \\<and> arity c = 0}\"", "lemma infinite_fun_syms[simp]:\n  \"infinite {c. public c \\<and> arity c > 0} \\<Longrightarrow> infinite \\<Sigma>\\<^sub>f\"\n  \"infinite \\<C>\" \"infinite \\<C>\\<^sub>p\\<^sub>u\\<^sub>b\" \"infinite (UNIV::'fun set)\"", "lemma id_univ_proper_subset[simp]: \"\\<Sigma>\\<^sub>f \\<subset> UNIV\" \"(\\<exists>f. arity f > 0) \\<Longrightarrow> \\<C> \\<subset> UNIV\"", "lemma exists_fun_notin_funs_term: \"\\<exists>f::'fun. f \\<notin> funs_term t\"", "lemma exists_fun_notin_funs_terms:\n  assumes \"finite M\" shows \"\\<exists>f::'fun. f \\<notin> \\<Union>(funs_term ` M)\"", "lemma exists_notin_funs\\<^sub>s\\<^sub>t: \"\\<exists>f. f \\<notin> funs\\<^sub>s\\<^sub>t (S::('fun,'var) strand)\"", "lemma infinite_typed_consts': \"infinite {c. \\<Gamma> (Fun c []) = TAtom a \\<and> public c \\<and> arity c = 0}\"", "lemma atypes_inhabited: \"\\<exists>c. \\<Gamma> (Fun c []) = TAtom a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and> public c \\<and> arity c = 0\"", "lemma atype_ground_term_ex: \"\\<exists>t. fv t = {} \\<and> \\<Gamma> t = TAtom a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\"", "lemma fun_type_id_eq: \"\\<Gamma> (Fun f X) = TComp g Y \\<Longrightarrow> f = g\"", "lemma fun_type_length_eq: \"\\<Gamma> (Fun f X) = TComp g Y \\<Longrightarrow> length X = length Y\"", "lemma type_ground_inhabited: \"\\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'\"", "lemma type_wfttype_inhabited:\n  assumes \"\\<And>f T. Fun f T \\<sqsubseteq> \\<tau> \\<Longrightarrow> 0 < arity f\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m \\<tau>\"\n  shows \"\\<exists>t. \\<Gamma> t = \\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\"", "lemma type_pgwt_inhabited: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow> \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\"", "lemma pgwt_type_map: \n  assumes \"public_ground_wf_term t\"\n  shows \"\\<Gamma> t = TAtom a \\<Longrightarrow> \\<exists>f. t = Fun f []\" \"\\<Gamma> t = TComp g Y \\<Longrightarrow> \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y\"", "lemma wt_subst_Var[simp]: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\"", "lemma wt_subst_trm: \"(\\<And>v. v \\<in> fv t \\<Longrightarrow> \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)) \\<Longrightarrow> \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<theta>)\"", "lemma wt_subst_trm': \"\\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>; \\<Gamma> s = \\<Gamma> t\\<rbrakk> \\<Longrightarrow> \\<Gamma> (s \\<cdot> \\<sigma>) = \\<Gamma> (t \\<cdot> \\<sigma>)\"", "lemma wt_subst_trm'': \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma> \\<Longrightarrow> \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>)\"", "lemma wt_subst_compose:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta> \\<circ>\\<^sub>s \\<delta>)\"", "lemma wt_subst_TAtom_Var_cases:\n  assumes \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"\n  and x: \"\\<Gamma> (Var x) = TAtom a\"\n  shows \"(\\<exists>y. \\<theta> x = Var y) \\<or> (\\<exists>c. \\<theta> x = Fun c [])\"", "lemma wt_subst_TAtom_fv:\n  assumes \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\"\n  and \"\\<forall>x \\<in> fv t - X. \\<exists>a. \\<Gamma> (Var x) = TAtom a\"\n  shows \"\\<forall>x \\<in> fv (t \\<cdot> \\<theta>) - fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X). \\<exists>a. \\<Gamma> (Var x) = TAtom a\"", "lemma wt_subst_TAtom_subterms_subst:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"\\<forall>x \\<in> fv t. \\<exists>a. \\<Gamma> (Var x) = TAtom a\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv t)\"\n  shows \"subterms (t \\<cdot> \\<theta>) = subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\"", "lemma wt_subst_TAtom_subterms_set_subst: \n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"\\<forall>x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t M. \\<exists>a. \\<Gamma> (Var x) = TAtom a\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv\\<^sub>s\\<^sub>e\\<^sub>t M)\"\n  shows \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>) = subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\"", "lemma wt_subst_subst_upd:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\"\n    and \"\\<Gamma> (Var x) = \\<Gamma> t\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta>(x := t))\"", "lemma wt_subst_const_fv_type_eq:\n  assumes \"\\<forall>x \\<in> fv t. \\<exists>a. \\<Gamma> (Var x) = TAtom a\"\n    and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n  shows \"\\<forall>x \\<in> fv (t \\<cdot> \\<delta>). \\<exists>y \\<in> fv t. \\<Gamma> (Var x) = \\<Gamma> (Var y)\"", "lemma TComp_term_cases:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> t = TComp f T\"\n  shows \"(\\<exists>v. t = Var v) \\<or> (\\<exists>T'. t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])\"", "lemma TAtom_term_cases:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> t = TAtom \\<tau>\"\n  shows \"(\\<exists>v. t = Var v) \\<or> (\\<exists>f. t = Fun f [])\"", "lemma subtermeq_imp_subtermtypeeq:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"s \\<sqsubseteq> t\"\n  shows \"\\<Gamma> s \\<sqsubseteq> \\<Gamma> t\"", "lemma subterm_funs_term_in_type:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"Fun f T \\<sqsubseteq> t\" \"\\<Gamma> (Fun f T) = TComp f (map \\<Gamma> T)\"\n  shows \"f \\<in> funs_term (\\<Gamma> t)\"", "lemma wt_subst_fv_termtype_subterm:\n  assumes \"x \\<in> fv (\\<theta> y)\"\n    and \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> y)\"\n  shows \"\\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\"", "lemma wt_subst_fv\\<^sub>s\\<^sub>e\\<^sub>t_termtype_subterm:\n  assumes \"x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` Y)\"\n    and \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"\n  shows \"\\<exists>y \\<in> Y. \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\"", "lemma funs_term_type_iff:\n  assumes t: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"\n    and f: \"arity f > 0\"\n  shows \"f \\<in> funs_term (\\<Gamma> t) \\<longleftrightarrow> (f \\<in> funs_term t \\<or> (\\<exists>x \\<in> fv t. f \\<in> funs_term (\\<Gamma> (Var x))))\"\n    (is \"?P t \\<longleftrightarrow> ?Q t\")", "lemma funs_term_type_iff':\n  assumes M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and f: \"arity f > 0\"\n  shows \"f \\<in> \\<Union>(funs_term ` \\<Gamma> ` M) \\<longleftrightarrow>\n        (f \\<in> \\<Union>(funs_term ` M) \\<or> (\\<exists>x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t M. f \\<in> funs_term (\\<Gamma> (Var x))))\" (is \"?A \\<longleftrightarrow> ?B\")", "lemma Ana_subterm_type:\n  assumes \"Ana t = (K,M)\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"\n    and \"m \\<in> set M\"\n  shows \"\\<Gamma> m \\<sqsubseteq> \\<Gamma> t\"", "lemma wf_trm_TAtom_subterms:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> t = TAtom \\<tau>\"\n  shows \"subterms t = {t}\"", "lemma wf_trm_TComp_subterm:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"t \\<sqsubset> s\"\n  obtains f T where \"\\<Gamma> s = TComp f T\"", "lemma SMP_empty[simp]: \"SMP {} = {}\"", "lemma SMP_I:\n  assumes \"s \\<in> M\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"t \\<sqsubseteq> s \\<cdot> \\<delta>\" \"\\<And>v. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> v)\"\n  shows \"t \\<in> SMP M\"", "lemma SMP_wf_trm:\n  assumes \"t \\<in> SMP M\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n  shows \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"", "lemma SMP_ikI[intro]: \"t \\<in> ik\\<^sub>s\\<^sub>t S \\<Longrightarrow> t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\"", "lemma MP_setI[intro]: \"x \\<in> set S \\<Longrightarrow> trms\\<^sub>s\\<^sub>t\\<^sub>p x \\<subseteq> trms\\<^sub>s\\<^sub>t S\"", "lemma SMP_setI[intro]: \"x \\<in> set S \\<Longrightarrow> trms\\<^sub>s\\<^sub>t\\<^sub>p x \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S)\"", "lemma SMP_subset_I:\n  assumes M: \"\\<forall>t \\<in> M. \\<exists>s \\<delta>. s \\<in> N \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = s \\<cdot> \\<delta>\"\n  shows \"SMP M \\<subseteq> SMP N\"", "lemma SMP_union: \"SMP (A \\<union> B) = SMP A \\<union> SMP B\"", "lemma SMP_append[simp]: \"SMP (trms\\<^sub>s\\<^sub>t (S@S')) = SMP (trms\\<^sub>s\\<^sub>t S) \\<union> SMP (trms\\<^sub>s\\<^sub>t S')\" (is \"?A = ?B\")", "lemma SMP_mono: \"A \\<subseteq> B \\<Longrightarrow> SMP A \\<subseteq> SMP B\"", "lemma SMP_Union: \"SMP (\\<Union>m \\<in> M. f m) = (\\<Union>m \\<in> M. SMP (f m))\"", "lemma SMP_singleton_ex:\n  \"t \\<in> SMP M \\<Longrightarrow> (\\<exists>m \\<in> M. t \\<in> SMP {m})\"\n  \"m \\<in> M \\<Longrightarrow> t \\<in> SMP {m} \\<Longrightarrow> t \\<in> SMP M\"", "lemma SMP_Cons: \"SMP (trms\\<^sub>s\\<^sub>t (x#S)) = SMP (trms\\<^sub>s\\<^sub>t [x]) \\<union> SMP (trms\\<^sub>s\\<^sub>t S)\"", "lemma SMP_Nil[simp]: \"SMP (trms\\<^sub>s\\<^sub>t []) = {}\"", "lemma SMP_subset_union_eq: assumes \"M \\<subseteq> SMP N\" shows \"SMP N = SMP (M \\<union> N)\"", "lemma SMP_subterms_subset: \"subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<subseteq> SMP M\"", "lemma SMP_SMP_subset: \"N \\<subseteq> SMP M \\<Longrightarrow> SMP N \\<subseteq> SMP M\"", "lemma wt_subst_rm_vars: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<Longrightarrow> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (rm_vars X \\<delta>)\"", "lemma wt_subst_SMP_subset:\n  assumes \"trms\\<^sub>s\\<^sub>t S \\<subseteq> SMP S'\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n  shows \"trms\\<^sub>s\\<^sub>t (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>) \\<subseteq> SMP S'\"", "lemma MP_subset_SMP: \"\\<Union>(trms\\<^sub>s\\<^sub>t\\<^sub>p ` set S) \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S)\" \"trms\\<^sub>s\\<^sub>t S \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S)\" \"M \\<subseteq> SMP M\"", "lemma SMP_fun_map_snd_subset: \"SMP (trms\\<^sub>s\\<^sub>t (map Send X)) \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t [Send (Fun f X)])\"", "lemma SMP_wt_subst_subset:\n  assumes \"t \\<in> SMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>)\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\"\n  shows \"t \\<in> SMP M\"", "lemma SMP_wt_instances_subset:\n  assumes \"\\<forall>t \\<in> M. \\<exists>s \\<in> N. \\<exists>\\<delta>. t = s \\<cdot> \\<delta> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n    and \"t \\<in> SMP M\"\n  shows \"t \\<in> SMP N\"", "lemma SMP_consts:\n  assumes \"\\<forall>t \\<in> M. \\<exists>c. t = Fun c []\"\n    and \"\\<forall>t \\<in> M. Ana t = ([], [])\"\n  shows \"SMP M = M\"", "lemma SMP_subterms_eq:\n  \"SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) = SMP M\"", "lemma SMP_funs_term:\n  assumes t: \"t \\<in> SMP M\" \"f \\<in> funs_term t \\<or> (\\<exists>x \\<in> fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\"\n    and f: \"arity f > 0\"\n    and M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and Ana_f: \"\\<And>s K T. Ana s = (K,T) \\<Longrightarrow> f \\<in> \\<Union>(funs_term ` set K) \\<Longrightarrow> f \\<in> funs_term s\"\n  shows \"f \\<in> \\<Union>(funs_term ` M) \\<or> (\\<exists>x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t M. f \\<in> funs_term (\\<Gamma> (Var x)))\"", "lemma id_type_eq:\n  assumes \"\\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\"\n  shows \"f \\<in> \\<C> \\<Longrightarrow> g \\<in> \\<C>\" \"f \\<in> \\<Sigma>\\<^sub>f \\<Longrightarrow> g \\<in> \\<Sigma>\\<^sub>f\"", "lemma fun_type_arg_cong:\n  assumes \"f \\<in> \\<Sigma>\\<^sub>f\" \"g \\<in> \\<Sigma>\\<^sub>f\" \"\\<Gamma> (Fun f (x#X)) = \\<Gamma> (Fun g (y#Y))\"\n  shows \"\\<Gamma> x = \\<Gamma> y\" \"\\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\"", "lemma fun_type_arg_cong':\n  assumes \"f \\<in> \\<Sigma>\\<^sub>f\" \"g \\<in> \\<Sigma>\\<^sub>f\" \"\\<Gamma> (Fun f (X@x#X')) = \\<Gamma> (Fun g (Y@y#Y'))\" \"length X = length Y\"\n  shows \"\\<Gamma> x = \\<Gamma> y\"", "lemma fun_type_param_idx: \"\\<Gamma> (Fun f T) = Fun g S \\<Longrightarrow> i < length T \\<Longrightarrow> \\<Gamma> (T ! i) = S ! i\"", "lemma fun_type_param_ex:\n  assumes \"\\<Gamma> (Fun f T) = Fun g (map \\<Gamma> S)\" \"t \\<in> set S\"\n  shows \"\\<exists>s \\<in> set T. \\<Gamma> s = \\<Gamma> t\"", "lemma tfr_stp_all_split:\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x#S) \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [x]\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x#S) \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S') \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S') \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S'\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@x#S') \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S')\"", "lemma tfr_stp_all_append:\n  assumes \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\" \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S'\"\n  shows \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S')\"", "lemma tfr_stp_all_wt_subst_apply:\n  assumes \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\"\n    and \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"\n           \"bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> = {}\"\n  shows \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\"", "lemma tfr_stp_all_same_type:\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@Equality a t t'#S') \\<Longrightarrow> Unifier \\<delta> t t' \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t'\"", "lemma tfr_subset:\n  \"\\<And>A B. tfr\\<^sub>s\\<^sub>e\\<^sub>t (A \\<union> B) \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\"\n  \"\\<And>A B. tfr\\<^sub>s\\<^sub>e\\<^sub>t B \\<Longrightarrow> A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\"\n  \"\\<And>A B. tfr\\<^sub>s\\<^sub>e\\<^sub>t B \\<Longrightarrow> SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\"", "lemma tfr_empty[simp]: \"tfr\\<^sub>s\\<^sub>e\\<^sub>t {}\"", "lemma tfr_consts_mono:\n  assumes \"\\<forall>t \\<in> M. \\<exists>c. t = Fun c []\"\n    and \"\\<forall>t \\<in> M. Ana t = ([], [])\"\n    and \"tfr\\<^sub>s\\<^sub>e\\<^sub>t N\"\n  shows \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)\"", "lemma dual\\<^sub>s\\<^sub>t_tfr\\<^sub>s\\<^sub>t\\<^sub>p: \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\"", "lemma subst_var_inv_wt:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst_var_inv \\<delta> X)\"", "lemma subst_var_inv_wf_trms:\n  \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (subst_var_inv \\<delta> X))\"", "lemma unify_list_wt_if_same_type:\n  assumes \"Unification.unify E B = Some U\" \"\\<forall>(s,t) \\<in> set E. wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\"\n  and \"\\<forall>(v,t) \\<in> set B. \\<Gamma> (Var v) = \\<Gamma> t\"\n  shows \"\\<forall>(v,t) \\<in> set U. \\<Gamma> (Var v) = \\<Gamma> t\"", "lemma mgu_wt_if_same_type:\n  assumes \"mgu s t = Some \\<sigma>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> s = \\<Gamma> t\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\"", "lemma wt_Unifier_if_Unifier:\n  assumes s_t: \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> s = \\<Gamma> t\"\n    and \\<delta>: \"Unifier \\<delta> s t\"\n  shows \"\\<exists>\\<theta>. Unifier \\<theta> s t \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"", "lemma less_Suc_max_var_set:\n  assumes z: \"z \\<in> X\"\n    and X: \"finite X\"\n  shows \"snd z < Suc (max_var_set X)\"", "lemma (in typed_model) finite_SMP_representationD:\n  assumes \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n    and \"has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\"\n    and \"is_TComp_var_instance_closed \\<Gamma> M\"", "lemma (in typed_model) is_wt_instance_of_condD:\n  assumes t_instance_s: \"is_wt_instance_of_cond \\<Gamma> t s\"\n  obtains \\<delta> where\n    \"\\<Gamma> t = \\<Gamma> s\" \"mgu t s = Some \\<delta>\"\n    \"inj_on \\<delta> (fv t)\" \"\\<delta> ` (fv t) \\<subseteq> range Var\"", "lemma (in typed_model) is_wt_instance_of_condD':\n  assumes t_wf_trm: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"\n    and s_wf_trm: \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\"\n    and t_instance_s: \"is_wt_instance_of_cond \\<Gamma> t s\"\n  shows \"\\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = s \\<cdot> \\<delta>\"", "lemma (in typed_model) is_wt_instance_of_condD'':\n  assumes s_wf_trm: \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\"\n    and t_instance_s: \"is_wt_instance_of_cond \\<Gamma> t s\"\n    and t_var: \"t = Var x\"\n  shows \"\\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)\"", "lemma (in typed_model) has_all_wt_instances_ofD:\n  assumes N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"t \\<in> N\"\n  obtains s \\<delta> where\n    \"s \\<in> M\" \"\\<Gamma> t = \\<Gamma> s\" \"mgu t s = Some \\<delta>\"\n    \"inj_on \\<delta> (fv t)\" \"\\<delta> ` (fv t) \\<subseteq> range Var\"", "lemma (in typed_model) has_all_wt_instances_ofD':\n  assumes N_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\"\n    and M_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"t \\<in> N\"\n  shows \"\\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t \\<in> M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\"", "lemma (in typed_model) has_all_wt_instances_ofD'':\n  assumes N_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\"\n    and M_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"Var x \\<in> N\"\n  shows \"\\<exists>y. Var y \\<in> M \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)\"", "lemma (in typed_model) has_all_instances_of_if_subset:\n  assumes \"N \\<subseteq> M\"\n  shows \"has_all_wt_instances_of \\<Gamma> N M\"", "lemma (in typed_model) SMP_I':\n  assumes N_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\"\n    and M_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"t \\<in> N\"\n  shows \"t \\<in> SMP M\"", "lemma var_rename_inv_comp: \"t \\<cdot> (var_rename n \\<circ>\\<^sub>s var_rename_inv n) = t\"", "lemma var_rename_fv_disjoint:\n  \"fv s \\<inter> fv (t \\<cdot> var_rename (max_var s)) = {}\"", "lemma var_rename_fv_set_disjoint:\n  assumes \"finite M\" \"s \\<in> M\"\n  shows \"fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) = {}\"", "lemma var_rename_fv_set_disjoint':\n  assumes \"finite M\"\n  shows \"fv\\<^sub>s\\<^sub>e\\<^sub>t M \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) = {}\"", "lemma var_rename_is_renaming[simp]:\n  \"subst_range (var_rename n) \\<subseteq> range Var\"\n  \"subst_range (var_rename_inv n) \\<subseteq> range Var\"", "lemma var_rename_wt[simp]:\n  \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename n)\"\n  \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename_inv n)\"", "lemma var_rename_wt':\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"s = m \\<cdot> \\<delta>\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename_inv n \\<circ>\\<^sub>s \\<delta>)\" \"s = m \\<cdot> var_rename n \\<cdot> var_rename_inv n \\<circ>\\<^sub>s \\<delta>\"", "lemma var_rename_wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s_range[simp]:\n  \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename n))\"\n  \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename_inv n))\"", "lemma Fun_range_case:\n  \"(\\<forall>f T. Fun f T \\<in> M \\<longrightarrow> P f T) \\<longleftrightarrow> (\\<forall>u \\<in> M. case u of Fun f T \\<Rightarrow> P f T | _ \\<Rightarrow> True)\"\n  \"(\\<forall>f T. Fun f T \\<in> M \\<longrightarrow> P f T) \\<longleftrightarrow> (\\<forall>u \\<in> M. is_Fun u \\<longrightarrow> P (the_Fun u) (args u))\"", "lemma is_TComp_var_instance_closedD:\n  assumes x: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\" \"\\<Gamma> (Var x) = TComp f T\"\n    and closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n  shows \"\\<exists>g U. Fun g U \\<in> set M \\<and> \\<Gamma> (Fun g U) = \\<Gamma> (Var x) \\<and> (\\<forall>u \\<in> set U. is_Var u) \\<and> distinct U\"", "lemma is_TComp_var_instance_closedD':\n  assumes \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\" \"TComp f T \\<sqsubseteq> \\<Gamma> (Var x)\"\n    and closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n  shows \"\\<exists>g U. Fun g U \\<in> set M \\<and> \\<Gamma> (Fun g U) = TComp f T \\<and> (\\<forall>u \\<in> set U. is_Var u) \\<and> distinct U\"", "lemma TComp_var_instance_wt_subst_exists:\n  assumes gT: \"\\<Gamma> (Fun g T) = TComp g (map \\<Gamma> U)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\"\n    and U: \"\\<forall>u \\<in> set U. \\<exists>y. u = Var y\" \"distinct U\"\n  shows \"\\<exists>\\<theta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and> Fun g T = Fun g U \\<cdot> \\<theta>\"", "lemma TComp_var_instance_closed_has_Var:\n  assumes closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and wf_\\<delta>x: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\"\n    and y_ex: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\"\n    and t: \"t \\<sqsubseteq> \\<delta> x\"\n    and \\<delta>_wt: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\"\n  shows \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var y) = \\<Gamma> t\"", "lemma TComp_var_instance_closed_has_Fun:\n  assumes closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and wf_\\<delta>x: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\"\n    and y_ex: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\"\n    and t: \"t \\<sqsubseteq> \\<delta> x\"\n    and \\<delta>_wt: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\"\n    and t_\\<Gamma>: \"\\<Gamma> t = TComp g T\"\n    and t_fun: \"is_Fun t\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<theta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and> t = m \\<cdot> \\<theta> \\<and> is_Fun m\"", "lemma TComp_var_and_subterm_instance_closed_has_subterms_instances:\n  assumes M_var_inst_cl: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and M_subterms_cl: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n    and M_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and t: \"t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M\"\n    and s: \"s \\<sqsubseteq> t \\<cdot> \\<delta>\"\n    and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<theta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and> s = m \\<cdot> \\<theta>\"", "lemma SMP_D_aux1:\n  assumes \"t \\<in> SMP (set M)\"\n    and closed: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n                \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n  shows \"\\<forall>x \\<in> fv t. \\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var y) = \\<Gamma> (Var x)\"", "lemma SMP_D_aux2:\n  fixes t::\"('fun, ('fun, 'atom) term \\<times> nat) term\"\n  assumes t_SMP: \"t \\<in> SMP (set M)\"\n    and t_Var: \"\\<exists>x. t = Var x\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>\"", "lemma SMP_D_aux3:\n  assumes hyps: \"t' \\<sqsubseteq> t\" and wf_t: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" and prems: \"is_Fun t'\"\n    and IH:\n      \"((\\<exists>f. t = Fun f []) \\<and> (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>)) \\<or>\n       (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta> \\<and> is_Fun m)\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"((\\<exists>f. t' = Fun f []) \\<and> (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t' = m \\<cdot> \\<delta>)) \\<or>\n         (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\"", "lemma SMP_D:\n  assumes \"t \\<in> SMP (set M)\" \"is_Fun t\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"((\\<exists>f. t = Fun f []) \\<and> (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>)) \\<or>\n         (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta> \\<and> is_Fun m)\"", "lemma SMP_D':\n  fixes M\n  defines \"\\<delta> \\<equiv> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)))\"\n  assumes M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n    and s: \"s \\<in> SMP (set M)\" \"is_Fun s\" \"\\<nexists>f. s = Fun f []\"\n    and t: \"t \\<in> SMP (set M)\" \"is_Fun t\" \"\\<nexists>f. t = Fun f []\"\n  obtains \\<sigma> s0 \\<theta> t0\n  where \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>)\" \"s0 \\<in> set M\" \"is_Fun s0\" \"s = s0 \\<cdot> \\<sigma>\" \"\\<Gamma> s = \\<Gamma> s0\"\n    and \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\" \"t0 \\<in> set M\" \"is_Fun t0\" \"t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>\" \"\\<Gamma> t = \\<Gamma> t0\"", "lemma SMP_D'':\n  fixes t::\"('fun, ('fun, 'atom) term \\<times> nat) term\"\n  assumes t_SMP: \"t \\<in> SMP (set M)\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>\"", "lemma tfr\\<^sub>s\\<^sub>e\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t:\n  assumes \"comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\"\n  shows \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)\"", "lemma tfr\\<^sub>s\\<^sub>e\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t':\n  assumes \"let N = SMP0 Ana \\<Gamma> M in set M \\<subseteq> set N \\<and> comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> N\"\n  shows \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)\"", "lemma tfr\\<^sub>s\\<^sub>t\\<^sub>p_is_comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p: \"tfr\\<^sub>s\\<^sub>t\\<^sub>p a = comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\"", "lemma tfr\\<^sub>s\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>t:\n  assumes \"comp_tfr\\<^sub>s\\<^sub>t arity Ana \\<Gamma> M S\"\n  shows \"tfr\\<^sub>s\\<^sub>t S\"", "lemma tfr\\<^sub>s\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>t':\n  assumes \"comp_tfr\\<^sub>s\\<^sub>t arity Ana \\<Gamma> (SMP0 Ana \\<Gamma> (trms_list\\<^sub>s\\<^sub>t S)) S\"\n  shows \"tfr\\<^sub>s\\<^sub>t S\"", "lemma ground_SMP_disjointI_aux1:\n  fixes M::\"('fun, ('fun, 'atom) term \\<times> nat) term set\"\n  assumes f_def: \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and g_def: \"g \\<equiv> \\<lambda>M. {t \\<in> M. fv t = {}}\"\n  shows \"f (SMP M) = g (SMP M)\"", "lemma ground_SMP_disjointI_aux2:\n  fixes M::\"('fun, ('fun, 'atom) term \\<times> nat) term list\"\n  assumes f_def: \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"f (set M) = f (SMP (set M))\"", "lemma ground_SMP_disjointI_aux3:\n  fixes A B C::\"('fun, ('fun, 'atom) term \\<times> nat) term set\"\n  defines \"P \\<equiv> \\<lambda>t s. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> Unifier \\<delta> t s\"\n  assumes f_def: \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and Q_def: \"Q \\<equiv> \\<lambda>t. intruder_synth' public arity {} t\"\n    and R_def: \"R \\<equiv> \\<lambda>t. \\<exists>u \\<in> C. is_wt_instance_of_cond \\<Gamma> t u\"\n    and AB: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s A\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s B\" \"fv\\<^sub>s\\<^sub>e\\<^sub>t A \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t B = {}\"\n    and C: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s C\"\n    and ABC: \"\\<forall>t \\<in> A. \\<forall>s \\<in> B. P t s \\<longrightarrow> (Q t \\<and> Q s) \\<or> (R t \\<and> R s)\"\n  shows \"f A \\<inter> f B \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"", "lemma ground_SMP_disjointI:\n  fixes A B::\"('fun, ('fun, 'atom) term \\<times> nat) term list\" and C\n  defines \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and \"g \\<equiv> \\<lambda>M. {t \\<in> M. fv t = {}}\"\n    and \"Q \\<equiv> \\<lambda>t. intruder_synth' public arity {} t\"\n    and \"R \\<equiv> \\<lambda>t. \\<exists>u \\<in> C. is_wt_instance_of_cond \\<Gamma> t u\"\n  assumes AB_fv_disj: \"fv\\<^sub>s\\<^sub>e\\<^sub>t (set A) \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t (set B) = {}\"\n    and A_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> A\"\n    and B_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> B\"\n    and C_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s C\"\n    and ABC: \"\\<forall>t \\<in> set A. \\<forall>s \\<in> set B. \\<Gamma> t = \\<Gamma> s \\<and> mgu t s \\<noteq> None \\<longrightarrow> (Q t \\<and> Q s) \\<or> (R t \\<and> R s)\"\n  shows \"g (SMP (set A)) \\<inter> g (SMP (set B)) \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], "translations": [["", "lemma tfr\\<^sub>s\\<^sub>t\\<^sub>p_list_all_alt_def:\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<longleftrightarrow>\n    ((\\<forall>a t t'. Equality a t t' \\<in> set S \\<and> (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow> \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F. Inequality X F \\<in> set S \\<longrightarrow> \n      (\\<forall>x \\<in> fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X. \\<exists>a. \\<Gamma> (Var x) = TAtom a)\n    \\<or> (\\<forall>f T. Fun f T \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F) \\<longrightarrow> T = [] \\<or> (\\<exists>s \\<in> set T. s \\<notin> Var ` set X))))\"\n  (is \"?P S \\<longleftrightarrow> ?Q S\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S =\n    ((\\<forall>a t t'.\n         \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n         \\<in> set S \\<and>\n         (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n         \\<Gamma> t = \\<Gamma> t') \\<and>\n     (\\<forall>X F.\n         \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n         \\<in> set S \\<longrightarrow>\n         (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                         set X.\n             \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n         (\\<forall>f T.\n             Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n             trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n              F \\<longrightarrow>\n             T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n    (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n 2. (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or>\n            (\\<exists>s\\<in>set T.\n                s \\<notin> Var ` set X))) \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "show \"?P S \\<Longrightarrow> ?Q S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n    (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))", "proof (induction S)"], ["proof (state)\ngoal (2 subgoals):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n 2. \\<And>a S.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                (\\<forall>a t t'.\n                    \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<and>\n                    (\\<exists>\\<delta>.\n                        Unifier \\<delta> t t') \\<longrightarrow>\n                    \\<Gamma> t = \\<Gamma> t') \\<and>\n                (\\<forall>X F.\n                    \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<longrightarrow>\n                    (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     F -\n                                    set X.\n                        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n                    (\\<forall>f T.\n                        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                         F \\<longrightarrow>\n                        T = [] \\<or>\n                        (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)));\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>aa t t'.\n                             \\<langle>aa: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n                             \\<in> set (a # S) \\<and>\n                             (\\<exists>\\<delta>.\n                                 Unifier \\<delta> t t') \\<longrightarrow>\n                             \\<Gamma> t = \\<Gamma> t') \\<and>\n                         (\\<forall>X F.\n                             \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n                             \\<in> set (a # S) \\<longrightarrow>\n                             (\\<forall>x\n \\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n                                 \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n                             (\\<forall>f T.\n                                 Fun f\n                                  T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                                 trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                  F \\<longrightarrow>\n                                 T = [] \\<or>\n                                 (\\<exists>s\\<in>set T.\n                                     s \\<notin> Var ` set X)))", "case (Cons x S)"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set S \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n\ngoal (2 subgoals):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n 2. \\<And>a S.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                (\\<forall>a t t'.\n                    \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<and>\n                    (\\<exists>\\<delta>.\n                        Unifier \\<delta> t t') \\<longrightarrow>\n                    \\<Gamma> t = \\<Gamma> t') \\<and>\n                (\\<forall>X F.\n                    \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<longrightarrow>\n                    (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     F -\n                                    set X.\n                        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n                    (\\<forall>f T.\n                        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                         F \\<longrightarrow>\n                        T = [] \\<or>\n                        (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)));\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>aa t t'.\n                             \\<langle>aa: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n                             \\<in> set (a # S) \\<and>\n                             (\\<exists>\\<delta>.\n                                 Unifier \\<delta> t t') \\<longrightarrow>\n                             \\<Gamma> t = \\<Gamma> t') \\<and>\n                         (\\<forall>X F.\n                             \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n                             \\<in> set (a # S) \\<longrightarrow>\n                             (\\<forall>x\n \\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n                                 \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n                             (\\<forall>f T.\n                                 Fun f\n                                  T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                                 trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                  F \\<longrightarrow>\n                                 T = [] \\<or>\n                                 (\\<exists>s\\<in>set T.\n                                     s \\<notin> Var ` set X)))", "thus ?case"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set S \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n\ngoal (1 subgoal):\n 1. (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set (x # S) \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set (x # S) \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))", "by (cases x) auto"], ["proof (state)\nthis:\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set (x # S) \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set (x # S) \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))", "qed simp"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set S \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n\ngoal (1 subgoal):\n 1. (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or>\n            (\\<exists>s\\<in>set T.\n                s \\<notin> Var ` set X))) \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "show \"?Q S \\<Longrightarrow> ?P S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set S \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or>\n            (\\<exists>s\\<in>set T.\n                s \\<notin> Var ` set X))) \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "proof (induction S)"], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or>\n            (\\<exists>s\\<in>set T.\n                s \\<notin> Var ` set X))) \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p []\n 2. \\<And>a S.\n       \\<lbrakk>(\\<forall>a t t'.\n                    \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<and>\n                    (\\<exists>\\<delta>.\n                        Unifier \\<delta> t t') \\<longrightarrow>\n                    \\<Gamma> t = \\<Gamma> t') \\<and>\n                (\\<forall>X F.\n                    \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<longrightarrow>\n                    (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     F -\n                                    set X.\n                        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n                    (\\<forall>f T.\n                        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                         F \\<longrightarrow>\n                        T = [] \\<or>\n                        (\\<exists>s\\<in>set T.\n                            s \\<notin> Var ` set X))) \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n        (\\<forall>aa t t'.\n            \\<langle>aa: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n            \\<in> set (a # S) \\<and>\n            (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n            \\<Gamma> t = \\<Gamma> t') \\<and>\n        (\\<forall>X F.\n            \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n            \\<in> set (a # S) \\<longrightarrow>\n            (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                            set X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n            (\\<forall>f T.\n                Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                 F \\<longrightarrow>\n                T = [] \\<or>\n                (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)", "case (Cons x S)"], ["proof (state)\nthis:\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set S \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or>\n          (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))) \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set (x # S) \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set (x # S) \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n\ngoal (2 subgoals):\n 1. (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or>\n            (\\<exists>s\\<in>set T.\n                s \\<notin> Var ` set X))) \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p []\n 2. \\<And>a S.\n       \\<lbrakk>(\\<forall>a t t'.\n                    \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<and>\n                    (\\<exists>\\<delta>.\n                        Unifier \\<delta> t t') \\<longrightarrow>\n                    \\<Gamma> t = \\<Gamma> t') \\<and>\n                (\\<forall>X F.\n                    \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n                    \\<in> set S \\<longrightarrow>\n                    (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     F -\n                                    set X.\n                        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n                    (\\<forall>f T.\n                        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                         F \\<longrightarrow>\n                        T = [] \\<or>\n                        (\\<exists>s\\<in>set T.\n                            s \\<notin> Var ` set X))) \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n        (\\<forall>aa t t'.\n            \\<langle>aa: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n            \\<in> set (a # S) \\<and>\n            (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n            \\<Gamma> t = \\<Gamma> t') \\<and>\n        (\\<forall>X F.\n            \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n            \\<in> set (a # S) \\<longrightarrow>\n            (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                            set X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n            (\\<forall>f T.\n                Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n                trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                 F \\<longrightarrow>\n                T = [] \\<or>\n                (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)", "thus ?case"], ["proof (prove)\nusing this:\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set S \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or>\n          (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))) \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set (x # S) \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set (x # S) \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)", "by (cases x) auto"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n\ngoal (1 subgoal):\n 1. (\\<forall>a t t'.\n        \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<and>\n        (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n        \\<Gamma> t = \\<Gamma> t') \\<and>\n    (\\<forall>X F.\n        \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n        \\<in> set [] \\<longrightarrow>\n        (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F -\n                        set X.\n            \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n        (\\<forall>f T.\n            Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n            trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n            T = [] \\<or>\n            (\\<exists>s\\<in>set T.\n                s \\<notin> Var ` set X))) \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p []", "qed simp"], ["proof (state)\nthis:\n  (\\<forall>a t t'.\n      \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S \\<and>\n      (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n      \\<Gamma> t = \\<Gamma> t') \\<and>\n  (\\<forall>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set S \\<longrightarrow>\n      (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n      (\\<forall>f T.\n          Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n          trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n          T = [] \\<or>\n          (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))) \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma \\<Gamma>_wf': \"wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> t)", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set T; wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> ?x2a2)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "hence *: \"arity f = length T\" \"\\<And>t. t \\<in> set T \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> t)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T; wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> ?x2a2)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n\ngoal (1 subgoal):\n 1. arity f = length T &&&\n    (\\<And>t.\n        t \\<in> set T \\<Longrightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> t))", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T;\n   \\<forall>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<longrightarrow>\n      length T = arity f\\<rbrakk>\n  \\<Longrightarrow> \\<forall>f T.\n                       Fun f T \\<sqsubseteq>\n                       \\<Gamma> ?x2a2 \\<longrightarrow>\n                       length T = arity f\n  \\<forall>fa Ta.\n     Fun fa Ta \\<sqsubseteq> Fun f T \\<longrightarrow> length Ta = arity fa\n\ngoal (1 subgoal):\n 1. arity f = length T &&&\n    (\\<And>t.\n        t \\<in> set T \\<Longrightarrow>\n        \\<forall>f T.\n           Fun f T \\<sqsubseteq> \\<Gamma> t \\<longrightarrow>\n           length T = arity f)", "by auto"], ["proof (state)\nthis:\n  arity f = length T\n  ?t2 \\<in> set T \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> ?t2)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "{"], ["proof (state)\nthis:\n  arity f = length T\n  ?t2 \\<in> set T \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> ?t2)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "assume \"arity f = 0\""], ["proof (state)\nthis:\n  arity f = 0\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "hence ?case"], ["proof (prove)\nusing this:\n  arity f = 0\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))", "using const_type[of f]"], ["proof (prove)\nusing this:\n  arity f = 0\n  arity f = 0 \\<Longrightarrow>\n  \\<exists>a. \\<forall>T. \\<Gamma> (Fun f T) = Var a\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "}"], ["proof (state)\nthis:\n  arity f = 0 \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "moreover"], ["proof (state)\nthis:\n  arity f = 0 \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "{"], ["proof (state)\nthis:\n  arity f = 0 \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "assume \"arity f > 0\""], ["proof (state)\nthis:\n  0 < arity f\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "hence ?case"], ["proof (prove)\nusing this:\n  0 < arity f\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))", "using fun_type[of f] *"], ["proof (prove)\nusing this:\n  0 < arity f\n  0 < arity f \\<Longrightarrow>\n  \\<Gamma> (Fun f ?T) = Fun f (map \\<Gamma> ?T)\n  arity f = length T\n  ?t2 \\<in> set T \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> ?t2)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))", "by force"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "}"], ["proof (state)\nthis:\n  0 < arity f \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m\n(\\<Gamma> x2a);\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun x1a x2))", "ultimately"], ["proof (chain)\npicking this:\n  arity f = 0 \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n  0 < arity f \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))", "show ?case"], ["proof (prove)\nusing this:\n  arity f = 0 \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n  0 < arity f \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Fun f T))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> (Var x))", "qed (metis \\<Gamma>_wf(2))"], ["", "lemma fun_type_inv: assumes \"\\<Gamma> t = TComp f T\" shows \"arity f > 0\" \"public f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity f &&& public f", "using \\<Gamma>_wf(1)[of f T t] assms"], ["proof (prove)\nusing this:\n  Fun f T \\<sqsubseteq> \\<Gamma> t \\<Longrightarrow> 0 < arity f\n  \\<Gamma> t = Fun f T\n\ngoal (1 subgoal):\n 1. 0 < arity f &&& public f", "by simp_all"], ["", "lemma fun_type_inv_wf: assumes \"\\<Gamma> t = TComp f T\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" shows \"arity f = length T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. arity f = length T", "using \\<Gamma>_wf'[OF assms(2)] assms(1)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> t)\n  \\<Gamma> t = Fun f T\n\ngoal (1 subgoal):\n 1. arity f = length T", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<forall>f T.\n     Fun f T \\<sqsubseteq> \\<Gamma> t \\<longrightarrow> length T = arity f\n  \\<Gamma> t = Fun f T\n\ngoal (1 subgoal):\n 1. arity f = length T", "by auto"], ["", "lemma const_type_inv: \"\\<Gamma> (Fun c X) = TAtom a \\<Longrightarrow> arity c = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun c X) = Var a \\<Longrightarrow> arity c = 0", "by (rule ccontr, simp add: fun_type)"], ["", "lemma const_type_inv_wf: assumes \"\\<Gamma> (Fun c X) = TAtom a\" and \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c X)\" shows \"X = []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X = []", "by (metis assms const_type_inv length_0_conv subtermeqI' wf\\<^sub>t\\<^sub>r\\<^sub>m_def)"], ["", "lemma const_type': \"\\<forall>c \\<in> \\<C>. \\<exists>a \\<in> \\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun c X) = TAtom a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>c\\<in>\\<C>.\n       \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun c X) = Var a", "using const_type"], ["proof (prove)\nusing this:\n  arity ?c = 0 \\<Longrightarrow>\n  \\<exists>a. \\<forall>T. \\<Gamma> (Fun ?c T) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>c\\<in>\\<C>.\n       \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun c X) = Var a", "by simp"], ["", "lemma fun_type': \"\\<forall>f \\<in> \\<Sigma>\\<^sub>f. \\<forall>X. \\<Gamma> (Fun f X) = TComp f (map \\<Gamma> X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f\\<in>\\<Union> (range \\<Sigma>n) - \\<C>.\n       \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)", "using fun_type"], ["proof (prove)\nusing this:\n  0 < arity ?f \\<Longrightarrow>\n  \\<Gamma> (Fun ?f ?T) = Fun ?f (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. \\<forall>f\\<in>\\<Union> (range \\<Sigma>n) - \\<C>.\n       \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)", "by simp"], ["", "lemma infinite_public_consts[simp]: \"infinite {c. public c \\<and> arity c = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "fix a::'atom"], ["proof (state)\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "define A where \"A \\<equiv> {c. \\<Gamma> (Fun c []) = TAtom a \\<and> public c}\""], ["proof (state)\nthis:\n  A \\<equiv> {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "define B where \"B \\<equiv> {c. public c \\<and> arity c = 0}\""], ["proof (state)\nthis:\n  B \\<equiv> {c. public c \\<and> arity c = 0}\n\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "have \"arity c = 0\" when c: \"c \\<in> A\" for c"], ["proof (prove)\ngoal (1 subgoal):\n 1. arity c = 0", "using c const_type_inv"], ["proof (prove)\nusing this:\n  c \\<in> A\n  \\<Gamma> (Fun ?c ?X) = Var ?a \\<Longrightarrow> arity ?c = 0\n\ngoal (1 subgoal):\n 1. arity c = 0", "unfolding A_def"], ["proof (prove)\nusing this:\n  c \\<in> {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n  \\<Gamma> (Fun ?c ?X) = Var ?a \\<Longrightarrow> arity ?c = 0\n\ngoal (1 subgoal):\n 1. arity c = 0", "by blast"], ["proof (state)\nthis:\n  ?c2 \\<in> A \\<Longrightarrow> arity ?c2 = 0\n\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "hence \"A \\<subseteq> B\""], ["proof (prove)\nusing this:\n  ?c2 \\<in> A \\<Longrightarrow> arity ?c2 = 0\n\ngoal (1 subgoal):\n 1. A \\<subseteq> B", "unfolding A_def B_def"], ["proof (prove)\nusing this:\n  ?c2\n  \\<in> {c. \\<Gamma> (Fun c []) = Var a \\<and> public c} \\<Longrightarrow>\n  arity ?c2 = 0\n\ngoal (1 subgoal):\n 1. {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n    \\<subseteq> {c. public c \\<and> arity c = 0}", "by blast"], ["proof (state)\nthis:\n  A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "hence \"infinite B\""], ["proof (prove)\nusing this:\n  A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. infinite B", "using infinite_typed_consts[of a, unfolded A_def[symmetric]]"], ["proof (prove)\nusing this:\n  A \\<subseteq> B\n  infinite A\n\ngoal (1 subgoal):\n 1. infinite B", "by (metis infinite_super)"], ["proof (state)\nthis:\n  infinite B\n\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "thus ?thesis"], ["proof (prove)\nusing this:\n  infinite B\n\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "unfolding B_def"], ["proof (prove)\nusing this:\n  infinite {c. public c \\<and> arity c = 0}\n\ngoal (1 subgoal):\n 1. infinite {c. public c \\<and> arity c = 0}", "by blast"], ["proof (state)\nthis:\n  infinite {c. public c \\<and> arity c = 0}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma infinite_fun_syms[simp]:\n  \"infinite {c. public c \\<and> arity c > 0} \\<Longrightarrow> infinite \\<Sigma>\\<^sub>f\"\n  \"infinite \\<C>\" \"infinite \\<C>\\<^sub>p\\<^sub>u\\<^sub>b\" \"infinite (UNIV::'fun set)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((infinite {c. public c \\<and> 0 < arity c} \\<Longrightarrow>\n      infinite (\\<Union> (range \\<Sigma>n) - \\<C>)) &&&\n     infinite \\<C>) &&&\n    infinite ({f. public f} \\<inter> \\<C>) &&& infinite UNIV", "by (metis \\<Sigma>\\<^sub>f_unfold finite_Collect_conjI,\n    metis infinite_public_consts finite_Collect_conjI,\n    use infinite_public_consts \\<C>pub_unfold in \\<open>force simp add: Collect_conj_eq\\<close>,\n    metis UNIV_I finite_subset subsetI infinite_public_consts(1))"], ["", "lemma id_univ_proper_subset[simp]: \"\\<Sigma>\\<^sub>f \\<subset> UNIV\" \"(\\<exists>f. arity f > 0) \\<Longrightarrow> \\<C> \\<subset> UNIV\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (range \\<Sigma>n) - \\<C> \\<subset> UNIV &&&\n    (\\<exists>f. 0 < arity f \\<Longrightarrow> \\<C> \\<subset> UNIV)", "by (metis finite.emptyI inf_top.right_neutral top.not_eq_extremum disjoint_fun_syms\n          infinite_fun_syms(2) inf_commute)\n   (metis top.not_eq_extremum UNIV_I const_arity_eq_zero less_irrefl)"], ["", "lemma exists_fun_notin_funs_term: \"\\<exists>f::'fun. f \\<notin> funs_term t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f. f \\<notin> funs_term t", "by (metis UNIV_eq_I finite_fun_symbols infinite_fun_syms(4))"], ["", "lemma exists_fun_notin_funs_terms:\n  assumes \"finite M\" shows \"\\<exists>f::'fun. f \\<notin> \\<Union>(funs_term ` M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f. f \\<notin> \\<Union> (funs_term ` M)", "by (metis assms finite_fun_symbols infinite_fun_syms(4) ex_new_if_finite finite_UN)"], ["", "lemma exists_notin_funs\\<^sub>s\\<^sub>t: \"\\<exists>f. f \\<notin> funs\\<^sub>s\\<^sub>t (S::('fun,'var) strand)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f. f \\<notin> funs\\<^sub>s\\<^sub>t S", "by (metis UNIV_eq_I finite_funs\\<^sub>s\\<^sub>t infinite_fun_syms(4))"], ["", "lemma infinite_typed_consts': \"infinite {c. \\<Gamma> (Fun c []) = TAtom a \\<and> public c \\<and> arity c = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "fix c"], ["proof (state)\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "assume \"\\<Gamma> (Fun c []) = TAtom a\" \"public c\""], ["proof (state)\nthis:\n  \\<Gamma> (Fun c []) = Var a\n  public c\n\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "hence \"arity c = 0\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun c []) = Var a\n  public c\n\ngoal (1 subgoal):\n 1. arity c = 0", "using const_type[of c] fun_type[of c \"[]\"]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun c []) = Var a\n  public c\n  arity c = 0 \\<Longrightarrow>\n  \\<exists>a. \\<forall>T. \\<Gamma> (Fun c T) = Var a\n  0 < arity c \\<Longrightarrow>\n  \\<Gamma> (Fun c []) = Fun c (map \\<Gamma> [])\n\ngoal (1 subgoal):\n 1. arity c = 0", "by auto"], ["proof (state)\nthis:\n  arity c = 0\n\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "}"], ["proof (state)\nthis:\n  \\<lbrakk>\\<Gamma> (Fun ?c4 []) = Var a; public ?c4\\<rbrakk>\n  \\<Longrightarrow> arity ?c4 = 0\n\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "hence \"{c. \\<Gamma> (Fun c []) = TAtom a \\<and> public c \\<and> arity c = 0} =\n           {c. \\<Gamma> (Fun c []) = TAtom a \\<and> public c}\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<Gamma> (Fun ?c4 []) = Var a; public ?c4\\<rbrakk>\n  \\<Longrightarrow> arity ?c4 = 0\n\ngoal (1 subgoal):\n 1. {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0} =\n    {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}", "by auto"], ["proof (state)\nthis:\n  {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0} =\n  {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "thus \"infinite {c. \\<Gamma> (Fun c []) = TAtom a \\<and> public c \\<and> arity c = 0}\""], ["proof (prove)\nusing this:\n  {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0} =\n  {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "using infinite_typed_consts[of a]"], ["proof (prove)\nusing this:\n  {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0} =\n  {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n  infinite {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n\ngoal (1 subgoal):\n 1. infinite\n     {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}", "by metis"], ["proof (state)\nthis:\n  infinite\n   {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma atypes_inhabited: \"\\<exists>c. \\<Gamma> (Fun c []) = TAtom a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and> public c \\<and> arity c = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c.\n       \\<Gamma> (Fun c []) = Var a \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and>\n       public c \\<and> arity c = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c.\n       \\<Gamma> (Fun c []) = Var a \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and>\n       public c \\<and> arity c = 0", "obtain c where \"\\<Gamma> (Fun c []) = TAtom a\" \"public c\" \"arity c = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c.\n        \\<lbrakk>\\<Gamma> (Fun c []) = Var a; public c; arity c = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using infinite_typed_consts'(1)[of a] not_finite_existsD"], ["proof (prove)\nusing this:\n  infinite\n   {c. \\<Gamma> (Fun c []) = Var a \\<and> public c \\<and> arity c = 0}\n  infinite {a. ?P a} \\<Longrightarrow> \\<exists>a. ?P a\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        \\<lbrakk>\\<Gamma> (Fun c []) = Var a; public c; arity c = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<Gamma> (Fun c []) = Var a\n  public c\n  arity c = 0\n\ngoal (1 subgoal):\n 1. \\<exists>c.\n       \\<Gamma> (Fun c []) = Var a \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and>\n       public c \\<and> arity c = 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun c []) = Var a\n  public c\n  arity c = 0\n\ngoal (1 subgoal):\n 1. \\<exists>c.\n       \\<Gamma> (Fun c []) = Var a \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and>\n       public c \\<and> arity c = 0", "using const_type_inv[OF \\<open>\\<Gamma> (Fun c []) = TAtom a\\<close>]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun c []) = Var a\n  public c\n  arity c = 0\n  arity c = 0\n\ngoal (1 subgoal):\n 1. \\<exists>c.\n       \\<Gamma> (Fun c []) = Var a \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and>\n       public c \\<and> arity c = 0", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun c []) = Var a\n  public c\n  arity c = 0\n  arity c = 0\n\ngoal (1 subgoal):\n 1. \\<exists>c.\n       \\<Gamma> (Fun c []) = Var a \\<and>\n       (\\<forall>f T.\n           Fun f T \\<sqsubseteq> Fun c [] \\<longrightarrow>\n           length T = arity f) \\<and>\n       public c \\<and> arity c = 0", "by auto"], ["proof (state)\nthis:\n  \\<exists>c.\n     \\<Gamma> (Fun c []) = Var a \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and>\n     public c \\<and> arity c = 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma atype_ground_term_ex: \"\\<exists>t. fv t = {} \\<and> \\<Gamma> t = TAtom a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t.\n       fv t = {} \\<and>\n       \\<Gamma> t = Var a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using atypes_inhabited[of a]"], ["proof (prove)\nusing this:\n  \\<exists>c.\n     \\<Gamma> (Fun c []) = Var a \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c []) \\<and>\n     public c \\<and> arity c = 0\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       fv t = {} \\<and>\n       \\<Gamma> t = Var a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by force"], ["", "lemma fun_type_id_eq: \"\\<Gamma> (Fun f X) = TComp g Y \\<Longrightarrow> f = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f X) = Fun g Y \\<Longrightarrow> f = g", "by (metis const_type fun_type neq0_conv \"term.inject\"(2) \"term.simps\"(4))"], ["", "lemma fun_type_length_eq: \"\\<Gamma> (Fun f X) = TComp g Y \\<Longrightarrow> length X = length Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f X) = Fun g Y \\<Longrightarrow> length X = length Y", "by (metis fun_type fun_type_id_eq fun_type_inv(1) length_map term.inject(2))"], ["", "lemma type_ground_inhabited: \"\\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "fix \\<tau>::\"('fun, 'atom) term_type\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "assume \"\\<And>f T. Fun f T \\<sqsubseteq> \\<tau> \\<Longrightarrow> 0 < arity f\""], ["proof (state)\nthis:\n  Fun ?f2 ?T2 \\<sqsubseteq> \\<tau> \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "hence \"\\<exists>t'. fv t' = {} \\<and> \\<tau> = \\<Gamma> t'\""], ["proof (prove)\nusing this:\n  Fun ?f2 ?T2 \\<sqsubseteq> \\<tau> \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<tau> = \\<Gamma> t'", "proof (induction \\<tau>)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>f T.\n           Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n           0 < arity f) \\<Longrightarrow>\n       \\<exists>t'. fv t' = {} \\<and> Var x = \\<Gamma> t'\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow>\n           0 < arity f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            fv t' = {} \\<and> Fun x1a x2 = \\<Gamma> t'", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set T;\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f T \\<Longrightarrow> 0 < arity ?f2\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>f T.\n           Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n           0 < arity f) \\<Longrightarrow>\n       \\<exists>t'. fv t' = {} \\<and> Var x = \\<Gamma> t'\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow>\n           0 < arity f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            fv t' = {} \\<and> Fun x1a x2 = \\<Gamma> t'", "hence \"arity f > 0\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T;\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f T \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. 0 < arity f", "by auto"], ["proof (state)\nthis:\n  0 < arity f\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>f T.\n           Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n           0 < arity f) \\<Longrightarrow>\n       \\<exists>t'. fv t' = {} \\<and> Var x = \\<Gamma> t'\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow>\n           0 < arity f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            fv t' = {} \\<and> Fun x1a x2 = \\<Gamma> t'", "from Fun.IH Fun.prems(1)"], ["proof (chain)\npicking this:\n  \\<lbrakk>?x2a2 \\<in> set T;\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f T \\<Longrightarrow> 0 < arity ?f2", "have \"\\<exists>Y. map \\<Gamma> Y = T \\<and> (\\<forall>x \\<in> set Y. fv x = {})\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T;\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f T \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. \\<exists>Y. map \\<Gamma> Y = T \\<and> (\\<forall>x\\<in>set Y. fv x = {})", "proof (induction T)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "case (Cons x X)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<And>x2a.\n              \\<lbrakk>x2a \\<in> set X;\n               \\<And>f T.\n                  Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                  0 < arity f\\<rbrakk>\n              \\<Longrightarrow> \\<exists>t'.\n                                   fv t' = {} \\<and> x2a = \\<Gamma> t';\n   \\<And>fa T.\n      Fun fa T \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity fa\\<rbrakk>\n  \\<Longrightarrow> \\<exists>Y.\n                       map \\<Gamma> Y = X \\<and>\n                       (\\<forall>x\\<in>set Y. fv x = {})\n  \\<lbrakk>?x2a2 \\<in> set (x # X);\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f (x # X) \\<Longrightarrow> 0 < arity ?f2\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "hence \"\\<And>g Y. Fun g Y \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity g\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x2a.\n              \\<lbrakk>x2a \\<in> set X;\n               \\<And>f T.\n                  Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                  0 < arity f\\<rbrakk>\n              \\<Longrightarrow> \\<exists>t'.\n                                   fv t' = {} \\<and> x2a = \\<Gamma> t';\n   \\<And>fa T.\n      Fun fa T \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity fa\\<rbrakk>\n  \\<Longrightarrow> \\<exists>Y.\n                       map \\<Gamma> Y = X \\<and>\n                       (\\<forall>x\\<in>set Y. fv x = {})\n  \\<lbrakk>?x2a2 \\<in> set (x # X);\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f (x # X) \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. \\<And>g Y. Fun g Y \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity g", "by auto"], ["proof (state)\nthis:\n  Fun ?g2 ?Y2 \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity ?g2\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "hence \"\\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})\""], ["proof (prove)\nusing this:\n  Fun ?g2 ?Y2 \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity ?g2\n\ngoal (1 subgoal):\n 1. \\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})", "using Cons"], ["proof (prove)\nusing this:\n  Fun ?g2 ?Y2 \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity ?g2\n  \\<lbrakk>\\<And>x2a.\n              \\<lbrakk>x2a \\<in> set X;\n               \\<And>f T.\n                  Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                  0 < arity f\\<rbrakk>\n              \\<Longrightarrow> \\<exists>t'.\n                                   fv t' = {} \\<and> x2a = \\<Gamma> t';\n   \\<And>fa T.\n      Fun fa T \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity fa\\<rbrakk>\n  \\<Longrightarrow> \\<exists>Y.\n                       map \\<Gamma> Y = X \\<and>\n                       (\\<forall>x\\<in>set Y. fv x = {})\n  \\<lbrakk>?x2a2 \\<in> set (x # X);\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f (x # X) \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. \\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})", "by auto"], ["proof (state)\nthis:\n  \\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "moreover"], ["proof (state)\nthis:\n  \\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "have \"\\<exists>t'. fv t' = {} \\<and> x = \\<Gamma> t'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> x = \\<Gamma> t'", "using Cons"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x2a.\n              \\<lbrakk>x2a \\<in> set X;\n               \\<And>f T.\n                  Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                  0 < arity f\\<rbrakk>\n              \\<Longrightarrow> \\<exists>t'.\n                                   fv t' = {} \\<and> x2a = \\<Gamma> t';\n   \\<And>fa T.\n      Fun fa T \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity fa\\<rbrakk>\n  \\<Longrightarrow> \\<exists>Y.\n                       map \\<Gamma> Y = X \\<and>\n                       (\\<forall>x\\<in>set Y. fv x = {})\n  \\<lbrakk>?x2a2 \\<in> set (x # X);\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f (x # X) \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> x = \\<Gamma> t'", "by auto"], ["proof (state)\nthis:\n  \\<exists>t'. fv t' = {} \\<and> x = \\<Gamma> t'\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "ultimately"], ["proof (chain)\npicking this:\n  \\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n  \\<exists>t'. fv t' = {} \\<and> x = \\<Gamma> t'", "obtain y Y where\n            \"fv y = {}\" \"\\<Gamma> y = x\" \"map \\<Gamma> Y = X\" \"\\<forall>x\\<in>set Y. fv x = {}\""], ["proof (prove)\nusing this:\n  \\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n  \\<exists>t'. fv t' = {} \\<and> x = \\<Gamma> t'\n\ngoal (1 subgoal):\n 1. (\\<And>y Y.\n        \\<lbrakk>fv y = {}; \\<Gamma> y = x; map \\<Gamma> Y = X;\n         \\<forall>x\\<in>set Y. fv x = {}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Cons"], ["proof (prove)\nusing this:\n  \\<exists>Y. map \\<Gamma> Y = X \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n  \\<exists>t'. fv t' = {} \\<and> x = \\<Gamma> t'\n  \\<lbrakk>\\<And>x2a.\n              \\<lbrakk>x2a \\<in> set X;\n               \\<And>f T.\n                  Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                  0 < arity f\\<rbrakk>\n              \\<Longrightarrow> \\<exists>t'.\n                                   fv t' = {} \\<and> x2a = \\<Gamma> t';\n   \\<And>fa T.\n      Fun fa T \\<sqsubseteq> Fun f X \\<Longrightarrow> 0 < arity fa\\<rbrakk>\n  \\<Longrightarrow> \\<exists>Y.\n                       map \\<Gamma> Y = X \\<and>\n                       (\\<forall>x\\<in>set Y. fv x = {})\n  \\<lbrakk>?x2a2 \\<in> set (x # X);\n   \\<And>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'. fv t' = {} \\<and> ?x2a2 = \\<Gamma> t'\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f (x # X) \\<Longrightarrow> 0 < arity ?f2\n\ngoal (1 subgoal):\n 1. (\\<And>y Y.\n        \\<lbrakk>fv y = {}; \\<Gamma> y = x; map \\<Gamma> Y = X;\n         \\<forall>x\\<in>set Y. fv x = {}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  fv y = {}\n  \\<Gamma> y = x\n  map \\<Gamma> Y = X\n  \\<forall>x\\<in>set Y. fv x = {}\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "hence \"map \\<Gamma> (y#Y) = x#X \\<and> (\\<forall>x\\<in>set (y#Y). fv x = {})\""], ["proof (prove)\nusing this:\n  fv y = {}\n  \\<Gamma> y = x\n  map \\<Gamma> Y = X\n  \\<forall>x\\<in>set Y. fv x = {}\n\ngoal (1 subgoal):\n 1. map \\<Gamma> (y # Y) = x # X \\<and>\n    (\\<forall>x\\<in>set (y # Y). fv x = {})", "by auto"], ["proof (state)\nthis:\n  map \\<Gamma> (y # Y) = x # X \\<and>\n  (\\<forall>x\\<in>set (y # Y). fv x = {})\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})\n 2. \\<And>a T.\n       \\<lbrakk>\\<lbrakk>\\<And>x2a.\n                            \\<lbrakk>x2a \\<in> set T;\n                             \\<And>f T.\n                                Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                                0 < arity f\\<rbrakk>\n                            \\<Longrightarrow> \\<exists>t'.\n           fv t' = {} \\<and> x2a = \\<Gamma> t';\n                 \\<And>fa Ta.\n                    Fun fa Ta \\<sqsubseteq> Fun f T \\<Longrightarrow>\n                    0 < arity fa\\<rbrakk>\n                \\<Longrightarrow> \\<exists>Y.\n                                     map \\<Gamma> Y = T \\<and>\n                                     (\\<forall>x\\<in>set Y. fv x = {});\n        \\<And>x2a.\n           \\<lbrakk>x2a \\<in> set (a # T);\n            \\<And>f T.\n               Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n               0 < arity f\\<rbrakk>\n           \\<Longrightarrow> \\<exists>t'.\n                                fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>fa Ta.\n           Fun fa Ta \\<sqsubseteq> Fun f (a # T) \\<Longrightarrow>\n           0 < arity fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>Y.\n                            map \\<Gamma> Y = a # T \\<and>\n                            (\\<forall>x\\<in>set Y. fv x = {})", "thus ?case"], ["proof (prove)\nusing this:\n  map \\<Gamma> (y # Y) = x # X \\<and>\n  (\\<forall>x\\<in>set (y # Y). fv x = {})\n\ngoal (1 subgoal):\n 1. \\<exists>Y.\n       map \\<Gamma> Y = x # X \\<and> (\\<forall>x\\<in>set Y. fv x = {})", "by meson"], ["proof (state)\nthis:\n  \\<exists>Y.\n     map \\<Gamma> Y = x # X \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set [];\n                 \\<And>f T.\n                    Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                    0 < arity f\\<rbrakk>\n                \\<Longrightarrow> \\<exists>t'.\n                                     fv t' = {} \\<and> x2a = \\<Gamma> t';\n     \\<And>fa T.\n        Fun fa T \\<sqsubseteq> Fun f [] \\<Longrightarrow>\n        0 < arity fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>Y.\n                         map \\<Gamma> Y = [] \\<and>\n                         (\\<forall>x\\<in>set Y. fv x = {})", "qed simp"], ["proof (state)\nthis:\n  \\<exists>Y. map \\<Gamma> Y = T \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>f T.\n           Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n           0 < arity f) \\<Longrightarrow>\n       \\<exists>t'. fv t' = {} \\<and> Var x = \\<Gamma> t'\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow>\n           0 < arity f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            fv t' = {} \\<and> Fun x1a x2 = \\<Gamma> t'", "then"], ["proof (chain)\npicking this:\n  \\<exists>Y. map \\<Gamma> Y = T \\<and> (\\<forall>x\\<in>set Y. fv x = {})", "obtain Y where \"map \\<Gamma> Y = T\" \"\\<forall>x \\<in> set Y. fv x = {}\""], ["proof (prove)\nusing this:\n  \\<exists>Y. map \\<Gamma> Y = T \\<and> (\\<forall>x\\<in>set Y. fv x = {})\n\ngoal (1 subgoal):\n 1. (\\<And>Y.\n        \\<lbrakk>map \\<Gamma> Y = T;\n         \\<forall>x\\<in>set Y. fv x = {}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  map \\<Gamma> Y = T\n  \\<forall>x\\<in>set Y. fv x = {}\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>f T.\n           Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n           0 < arity f) \\<Longrightarrow>\n       \\<exists>t'. fv t' = {} \\<and> Var x = \\<Gamma> t'\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow>\n           0 < arity f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            fv t' = {} \\<and> Fun x1a x2 = \\<Gamma> t'", "hence \"fv (Fun f Y) = {}\" \"\\<Gamma> (Fun f Y) = TComp f T\""], ["proof (prove)\nusing this:\n  map \\<Gamma> Y = T\n  \\<forall>x\\<in>set Y. fv x = {}\n\ngoal (1 subgoal):\n 1. fv (Fun f Y) = {} &&& \\<Gamma> (Fun f Y) = Fun f T", "using fun_type[OF \\<open>arity f > 0\\<close>]"], ["proof (prove)\nusing this:\n  map \\<Gamma> Y = T\n  \\<forall>x\\<in>set Y. fv x = {}\n  \\<Gamma> (Fun f ?T) = Fun f (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. fv (Fun f Y) = {} &&& \\<Gamma> (Fun f Y) = Fun f T", "by auto"], ["proof (state)\nthis:\n  fv (Fun f Y) = {}\n  \\<Gamma> (Fun f Y) = Fun f T\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>f T.\n           Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n           0 < arity f) \\<Longrightarrow>\n       \\<exists>t'. fv t' = {} \\<and> Var x = \\<Gamma> t'\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  fv t' = {} \\<and> x2a = \\<Gamma> t';\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow>\n           0 < arity f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            fv t' = {} \\<and> Fun x1a x2 = \\<Gamma> t'", "thus ?case"], ["proof (prove)\nusing this:\n  fv (Fun f Y) = {}\n  \\<Gamma> (Fun f Y) = Fun f T\n\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> Fun f T = \\<Gamma> t'", "by (metis exI[of \"\\<lambda>t. fv t = {} \\<and> \\<Gamma> t = TComp f T\" \"Fun f Y\"])"], ["proof (state)\nthis:\n  \\<exists>t'. fv t' = {} \\<and> Fun f T = \\<Gamma> t'\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<And>f T.\n           Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n           0 < arity f) \\<Longrightarrow>\n       \\<exists>t'. fv t' = {} \\<and> Var x = \\<Gamma> t'", "qed (metis atype_ground_term_ex)"], ["proof (state)\nthis:\n  \\<exists>t'. fv t' = {} \\<and> \\<tau> = \\<Gamma> t'\n\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "}"], ["proof (state)\nthis:\n  (\\<And>f T.\n      Fun f T \\<sqsubseteq> ?\\<tau>4 \\<Longrightarrow>\n      0 < arity f) \\<Longrightarrow>\n  \\<exists>t'. fv t' = {} \\<and> ?\\<tau>4 = \\<Gamma> t'\n\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>f T.\n      Fun f T \\<sqsubseteq> ?\\<tau>4 \\<Longrightarrow>\n      0 < arity f) \\<Longrightarrow>\n  \\<exists>t'. fv t' = {} \\<and> ?\\<tau>4 = \\<Gamma> t'\n\ngoal (1 subgoal):\n 1. \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'", "by (metis \\<Gamma>_wf(1))"], ["proof (state)\nthis:\n  \\<exists>t'. fv t' = {} \\<and> \\<Gamma> t = \\<Gamma> t'\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma type_wfttype_inhabited:\n  assumes \"\\<And>f T. Fun f T \\<sqsubseteq> \\<tau> \\<Longrightarrow> 0 < arity f\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m \\<tau>\"\n  shows \"\\<exists>t. \\<Gamma> t = \\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = \\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using assms"], ["proof (prove)\nusing this:\n  Fun ?f2 ?T2 \\<sqsubseteq> \\<tau> \\<Longrightarrow> 0 < arity ?f2\n  wf\\<^sub>t\\<^sub>r\\<^sub>m \\<tau>\n\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = \\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "proof (induction \\<tau>)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>f T.\n                   Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n                   0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Var x \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t.\n  \\<Gamma> t = x2a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow> 0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Fun x1a x2 \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t", "case (Fun f Y)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set Y;\n   \\<And>f T. Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?x2a2 \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f Y \\<Longrightarrow> 0 < arity ?f2\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f Y)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>f T.\n                   Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n                   0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Var x \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t.\n  \\<Gamma> t = x2a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow> 0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Fun x1a x2 \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t", "have IH: \"\\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\" when y: \"y \\<in> set Y \" for y"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "have \"wf\\<^sub>t\\<^sub>r\\<^sub>m y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m y", "using Fun y"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set Y;\n   \\<And>f T. Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?x2a2 \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f Y \\<Longrightarrow> 0 < arity ?f2\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f Y)\n  y \\<in> set Y\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m y", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set Y;\n   \\<And>f T. Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f;\n   \\<forall>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<longrightarrow>\n      length T = arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?x2a2 \\<and>\n                       (\\<forall>f T.\n                           Fun f T \\<sqsubseteq> t \\<longrightarrow>\n                           length T = arity f)\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f Y \\<Longrightarrow> 0 < arity ?f2\n  \\<forall>fa T.\n     Fun fa T \\<sqsubseteq> Fun f Y \\<longrightarrow> length T = arity fa\n  y \\<in> set Y\n\ngoal (1 subgoal):\n 1. \\<forall>f T.\n       Fun f T \\<sqsubseteq> y \\<longrightarrow> length T = arity f", "by (metis Fun_param_is_subterm term.le_less_trans)"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m y\n\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "moreover"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m y\n\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "have \"Fun g Z \\<sqsubseteq> y \\<Longrightarrow> 0 < arity g\" for g Z"], ["proof (prove)\ngoal (1 subgoal):\n 1. Fun g Z \\<sqsubseteq> y \\<Longrightarrow> 0 < arity g", "using Fun y"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set Y;\n   \\<And>f T. Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?x2a2 \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f Y \\<Longrightarrow> 0 < arity ?f2\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f Y)\n  y \\<in> set Y\n\ngoal (1 subgoal):\n 1. Fun g Z \\<sqsubseteq> y \\<Longrightarrow> 0 < arity g", "by auto"], ["proof (state)\nthis:\n  Fun ?g2 ?Z2 \\<sqsubseteq> y \\<Longrightarrow> 0 < arity ?g2\n\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "ultimately"], ["proof (chain)\npicking this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m y\n  Fun ?g2 ?Z2 \\<sqsubseteq> y \\<Longrightarrow> 0 < arity ?g2", "show ?thesis"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m y\n  Fun ?g2 ?Z2 \\<sqsubseteq> y \\<Longrightarrow> 0 < arity ?g2\n\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using Fun.IH[OF y]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m y\n  Fun ?g2 ?Z2 \\<sqsubseteq> y \\<Longrightarrow> 0 < arity ?g2\n  \\<lbrakk>\\<And>f T. Fun f T \\<sqsubseteq> y \\<Longrightarrow> 0 < arity f;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m y\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by auto"], ["proof (state)\nthis:\n  \\<exists>t. \\<Gamma> t = y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?y2 \\<in> set Y \\<Longrightarrow>\n  \\<exists>t. \\<Gamma> t = ?y2 \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>f T.\n                   Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n                   0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Var x \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t.\n  \\<Gamma> t = x2a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow> 0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Fun x1a x2 \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t", "from Fun"], ["proof (chain)\npicking this:\n  \\<lbrakk>?x2a2 \\<in> set Y;\n   \\<And>f T. Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?x2a2 \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f Y \\<Longrightarrow> 0 < arity ?f2\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f Y)", "have \"arity f = length Y\" \"arity f > 0\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set Y;\n   \\<And>f T. Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?x2a2 \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f Y \\<Longrightarrow> 0 < arity ?f2\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f Y)\n\ngoal (1 subgoal):\n 1. arity f = length Y &&& 0 < arity f", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set Y;\n   \\<And>f T. Fun f T \\<sqsubseteq> ?x2a2 \\<Longrightarrow> 0 < arity f;\n   \\<forall>f T.\n      Fun f T \\<sqsubseteq> ?x2a2 \\<longrightarrow>\n      length T = arity f\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?x2a2 \\<and>\n                       (\\<forall>f T.\n                           Fun f T \\<sqsubseteq> t \\<longrightarrow>\n                           length T = arity f)\n  Fun ?f2 ?T2 \\<sqsubseteq> Fun f Y \\<Longrightarrow> 0 < arity ?f2\n  \\<forall>fa T.\n     Fun fa T \\<sqsubseteq> Fun f Y \\<longrightarrow> length T = arity fa\n\ngoal (1 subgoal):\n 1. arity f = length Y &&& 0 < arity f", "by force+"], ["proof (state)\nthis:\n  arity f = length Y\n  0 < arity f\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>f T.\n                   Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n                   0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Var x \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t.\n  \\<Gamma> t = x2a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow> 0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Fun x1a x2 \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t", "moreover"], ["proof (state)\nthis:\n  arity f = length Y\n  0 < arity f\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>f T.\n                   Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n                   0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Var x \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t.\n  \\<Gamma> t = x2a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow> 0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Fun x1a x2 \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t", "from IH"], ["proof (chain)\npicking this:\n  ?y2 \\<in> set Y \\<Longrightarrow>\n  \\<exists>t. \\<Gamma> t = ?y2 \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "have \"\\<exists>X. map \\<Gamma> X = Y \\<and> (\\<forall>x \\<in> set X. wf\\<^sub>t\\<^sub>r\\<^sub>m x)\""], ["proof (prove)\nusing this:\n  ?y2 \\<in> set Y \\<Longrightarrow>\n  \\<exists>t. \\<Gamma> t = ?y2 \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<exists>X.\n       map \\<Gamma> X = Y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set X)", "by (induct Y, simp_all, metis list.simps(9) set_ConsD)"], ["proof (state)\nthis:\n  \\<exists>X.\n     map \\<Gamma> X = Y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set X)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>f T.\n                   Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n                   0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Var x \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>f T.\n                       Fun f T \\<sqsubseteq> x2a \\<Longrightarrow>\n                       0 < arity f;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t.\n  \\<Gamma> t = x2a \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n        \\<And>f T.\n           Fun f T \\<sqsubseteq> Fun x1a x2 \\<Longrightarrow> 0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Fun x1a x2 \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t", "ultimately"], ["proof (chain)\npicking this:\n  arity f = length Y\n  0 < arity f\n  \\<exists>X.\n     map \\<Gamma> X = Y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set X)", "show ?case"], ["proof (prove)\nusing this:\n  arity f = length Y\n  0 < arity f\n  \\<exists>X.\n     map \\<Gamma> X = Y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set X)\n\ngoal (1 subgoal):\n 1. \\<exists>t. \\<Gamma> t = Fun f Y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by (metis fun_type length_map wf_trmI)"], ["proof (state)\nthis:\n  \\<exists>t. \\<Gamma> t = Fun f Y \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>f T.\n                   Fun f T \\<sqsubseteq> Var x \\<Longrightarrow>\n                   0 < arity f;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t.\n                            \\<Gamma> t = Var x \\<and>\n                            wf\\<^sub>t\\<^sub>r\\<^sub>m t", "qed (use atypes_inhabited wf\\<^sub>t\\<^sub>r\\<^sub>m_def in blast)"], ["", "lemma type_pgwt_inhabited: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow> \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "assume \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "{"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "fix \\<tau>"], ["proof (state)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "assume \"\\<Gamma> t = \\<tau>\""], ["proof (state)\nthis:\n  \\<Gamma> t = \\<tau>\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "hence \"\\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\""], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<tau>\n\ngoal (1 subgoal):\n 1. \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "using \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<close>"], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "proof (induction \\<tau> arbitrary: t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x t.\n       \\<lbrakk>\\<Gamma> t = Var x; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'\n 2. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "case (Var a t)"], ["proof (state)\nthis:\n  \\<Gamma> t = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (2 subgoals):\n 1. \\<And>x t.\n       \\<lbrakk>\\<Gamma> t = Var x; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'\n 2. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> t = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t", "obtain c where \"\\<Gamma> t = \\<Gamma> (Fun c [])\" \"arity c = 0\" \"public c\""], ["proof (prove)\nusing this:\n  \\<Gamma> t = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        \\<lbrakk>\\<Gamma> t = \\<Gamma> (Fun c []); arity c = 0;\n         public c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using const_type_inv[of _ \"[]\" a] infinite_typed_consts(1)[of a]  not_finite_existsD"], ["proof (prove)\nusing this:\n  \\<Gamma> t = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> (Fun ?c []) = Var a \\<Longrightarrow> arity ?c = 0\n  infinite {c. \\<Gamma> (Fun c []) = Var a \\<and> public c}\n  infinite {a. ?P a} \\<Longrightarrow> \\<exists>a. ?P a\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        \\<lbrakk>\\<Gamma> t = \\<Gamma> (Fun c []); arity c = 0;\n         public c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  \\<Gamma> t = \\<Gamma> (Fun c [])\n  arity c = 0\n  public c\n\ngoal (2 subgoals):\n 1. \\<And>x t.\n       \\<lbrakk>\\<Gamma> t = Var x; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'\n 2. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "thus ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<Gamma> (Fun c [])\n  arity c = 0\n  public c\n\ngoal (1 subgoal):\n 1. \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "using PGWT[OF \\<open>public c\\<close>, of \"[]\"]"], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<Gamma> (Fun c [])\n  arity c = 0\n  public c\n  \\<lbrakk>arity c = length [];\n   \\<And>t.\n      t \\<in> set [] \\<Longrightarrow> public_ground_wf_term t\\<rbrakk>\n  \\<Longrightarrow> public_ground_wf_term (Fun c [])\n\ngoal (1 subgoal):\n 1. \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "by auto"], ["proof (state)\nthis:\n  \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "case (Fun f Y t)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set Y; \\<Gamma> ?t2 = ?x2a2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?t2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'.\n                       \\<Gamma> ?t2 = \\<Gamma> t' \\<and>\n                       public_ground_wf_term t'\n  \\<Gamma> t = Fun f Y\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "have *: \"arity f > 0\" \"public f\" \"arity f = length Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity f &&& public f &&& arity f = length Y", "using fun_type_inv[OF \\<open>\\<Gamma> t = TComp f Y\\<close>] fun_type_inv_wf[OF \\<open>\\<Gamma> t = TComp f Y\\<close> \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<close>]"], ["proof (prove)\nusing this:\n  0 < arity f\n  public f\n  arity f = length Y\n\ngoal (1 subgoal):\n 1. 0 < arity f &&& public f &&& arity f = length Y", "by auto"], ["proof (state)\nthis:\n  0 < arity f\n  public f\n  arity f = length Y\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "have \"\\<And>y. y \\<in> set Y \\<Longrightarrow> \\<exists>t'. y = \\<Gamma> t' \\<and> public_ground_wf_term t'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       y \\<in> set Y \\<Longrightarrow>\n       \\<exists>t'. y = \\<Gamma> t' \\<and> public_ground_wf_term t'", "using Fun.prems(1) Fun.IH \\<Gamma>_wf(1)[of _ _ t] \\<Gamma>_wf'[OF \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<close>] type_wfttype_inhabited"], ["proof (prove)\nusing this:\n  \\<Gamma> t = Fun f Y\n  \\<lbrakk>?x2a2 \\<in> set Y; \\<Gamma> ?t2 = ?x2a2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?t2\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t'.\n                       \\<Gamma> ?t2 = \\<Gamma> t' \\<and>\n                       public_ground_wf_term t'\n  Fun ?f ?T \\<sqsubseteq> \\<Gamma> t \\<Longrightarrow> 0 < arity ?f\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<Gamma> t)\n  \\<lbrakk>\\<And>f T.\n              Fun f T \\<sqsubseteq> ?\\<tau> \\<Longrightarrow> 0 < arity f;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?\\<tau>\\<rbrakk>\n  \\<Longrightarrow> \\<exists>t.\n                       \\<Gamma> t = ?\\<tau> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       y \\<in> set Y \\<Longrightarrow>\n       \\<exists>t'. y = \\<Gamma> t' \\<and> public_ground_wf_term t'", "by (metis Fun_param_is_subterm term.order_trans wf_trm_subtermeq)"], ["proof (state)\nthis:\n  ?y2 \\<in> set Y \\<Longrightarrow>\n  \\<exists>t'. ?y2 = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "hence \"\\<exists>X. map \\<Gamma> X = Y \\<and> (\\<forall>x \\<in> set X. public_ground_wf_term x)\""], ["proof (prove)\nusing this:\n  ?y2 \\<in> set Y \\<Longrightarrow>\n  \\<exists>t'. ?y2 = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal (1 subgoal):\n 1. \\<exists>X. map \\<Gamma> X = Y \\<and> Ball (set X) public_ground_wf_term", "by (induct Y, simp_all, metis list.simps(9) set_ConsD)"], ["proof (state)\nthis:\n  \\<exists>X. map \\<Gamma> X = Y \\<and> Ball (set X) public_ground_wf_term\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "then"], ["proof (chain)\npicking this:\n  \\<exists>X. map \\<Gamma> X = Y \\<and> Ball (set X) public_ground_wf_term", "obtain X where X: \"map \\<Gamma> X = Y\" \"\\<And>x. x \\<in> set X \\<Longrightarrow> public_ground_wf_term x\""], ["proof (prove)\nusing this:\n  \\<exists>X. map \\<Gamma> X = Y \\<and> Ball (set X) public_ground_wf_term\n\ngoal (1 subgoal):\n 1. (\\<And>X.\n        \\<lbrakk>map \\<Gamma> X = Y;\n         \\<And>x.\n            x \\<in> set X \\<Longrightarrow> public_ground_wf_term x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  map \\<Gamma> X = Y\n  ?x2 \\<in> set X \\<Longrightarrow> public_ground_wf_term ?x2\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "hence \"arity f = length X\""], ["proof (prove)\nusing this:\n  map \\<Gamma> X = Y\n  ?x2 \\<in> set X \\<Longrightarrow> public_ground_wf_term ?x2\n\ngoal (1 subgoal):\n 1. arity f = length X", "using *(3)"], ["proof (prove)\nusing this:\n  map \\<Gamma> X = Y\n  ?x2 \\<in> set X \\<Longrightarrow> public_ground_wf_term ?x2\n  arity f = length Y\n\ngoal (1 subgoal):\n 1. arity f = length X", "by auto"], ["proof (state)\nthis:\n  arity f = length X\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "have \"\\<Gamma> t = \\<Gamma> (Fun f X)\" \"public_ground_wf_term (Fun f X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> t = \\<Gamma> (Fun f X) &&& public_ground_wf_term (Fun f X)", "using fun_type[OF *(1), of X] Fun.prems(1) X(1)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)\n  \\<Gamma> t = Fun f Y\n  map \\<Gamma> X = Y\n\ngoal (1 subgoal):\n 1. \\<Gamma> t = \\<Gamma> (Fun f X) &&& public_ground_wf_term (Fun f X)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. public_ground_wf_term (Fun f X)", "using PGWT[OF *(2) \\<open>arity f = length X\\<close> X(2)]"], ["proof (prove)\nusing this:\n  (\\<And>t. t \\<in> set X \\<Longrightarrow> t \\<in> set X) \\<Longrightarrow>\n  public_ground_wf_term (Fun f X)\n\ngoal (1 subgoal):\n 1. public_ground_wf_term (Fun f X)", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> t = \\<Gamma> (Fun f X)\n  public_ground_wf_term (Fun f X)\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 t.\n       \\<lbrakk>\\<And>x2a t.\n                   \\<lbrakk>x2a \\<in> set x2; \\<Gamma> t = x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>t'.\n  \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t';\n        \\<Gamma> t = Fun x1a x2; wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>t'.\n                            \\<Gamma> t = \\<Gamma> t' \\<and>\n                            public_ground_wf_term t'", "thus ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<Gamma> (Fun f X)\n  public_ground_wf_term (Fun f X)\n\ngoal (1 subgoal):\n 1. \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "by metis"], ["proof (state)\nthis:\n  \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "}"], ["proof (state)\nthis:\n  \\<Gamma> t = ?\\<tau>4 \\<Longrightarrow>\n  \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n    \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> t = ?\\<tau>4 \\<Longrightarrow>\n  \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal (1 subgoal):\n 1. \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "using \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<close>"], ["proof (prove)\nusing this:\n  \\<Gamma> t = ?\\<tau>4 \\<Longrightarrow>\n  \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'", "by auto"], ["proof (state)\nthis:\n  \\<exists>t'. \\<Gamma> t = \\<Gamma> t' \\<and> public_ground_wf_term t'\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma pgwt_type_map: \n  assumes \"public_ground_wf_term t\"\n  shows \"\\<Gamma> t = TAtom a \\<Longrightarrow> \\<exists>f. t = Fun f []\" \"\\<Gamma> t = TComp g Y \\<Longrightarrow> \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Gamma> t = Var a \\<Longrightarrow> \\<exists>f. t = Fun f []) &&&\n    (\\<Gamma> t = Fun g Y \\<Longrightarrow>\n     \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y)", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<Gamma> t = Var a \\<Longrightarrow> \\<exists>f. t = Fun f []\n 2. \\<Gamma> t = Fun g Y \\<Longrightarrow>\n    \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y", "let ?A = \"\\<Gamma> t = TAtom a \\<longrightarrow> (\\<exists>f. t = Fun f [])\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<Gamma> t = Var a \\<Longrightarrow> \\<exists>f. t = Fun f []\n 2. \\<Gamma> t = Fun g Y \\<Longrightarrow>\n    \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y", "let ?B = \"\\<Gamma> t = TComp g Y \\<longrightarrow> (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y)\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<Gamma> t = Var a \\<Longrightarrow> \\<exists>f. t = Fun f []\n 2. \\<Gamma> t = Fun g Y \\<Longrightarrow>\n    \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y", "have \"?A \\<and> ?B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n    (\\<Gamma> t = Fun g Y \\<longrightarrow>\n     (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "proof (cases \"\\<Gamma> t\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "case (Var a)"], ["proof (state)\nthis:\n  \\<Gamma> t = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "obtain f X where \"t = Fun f X\" \"arity f = length X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f X.\n        \\<lbrakk>t = Fun f X; arity f = length X\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using pgwt_fun[OF assms(1)] pgwt_arity[OF assms(1)]"], ["proof (prove)\nusing this:\n  \\<exists>f T. t = Fun f T\n  Fun ?f ?T \\<sqsubseteq> t \\<Longrightarrow> arity ?f = length ?T\n\ngoal (1 subgoal):\n 1. (\\<And>f X.\n        \\<lbrakk>t = Fun f X; arity f = length X\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce+"], ["proof (state)\nthis:\n  t = Fun f X\n  arity f = length X\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "thus ?thesis"], ["proof (prove)\nusing this:\n  t = Fun f X\n  arity f = length X\n\ngoal (1 subgoal):\n 1. (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n    (\\<Gamma> t = Fun g Y \\<longrightarrow>\n     (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "using const_type_inv \\<open>\\<Gamma> t = TAtom a\\<close>"], ["proof (prove)\nusing this:\n  t = Fun f X\n  arity f = length X\n  \\<Gamma> (Fun ?c ?X) = Var ?a \\<Longrightarrow> arity ?c = 0\n  \\<Gamma> t = Var a\n\ngoal (1 subgoal):\n 1. (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n    (\\<Gamma> t = Fun g Y \\<longrightarrow>\n     (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "by auto"], ["proof (state)\nthis:\n  (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n  (\\<Gamma> t = Fun g Y \\<longrightarrow>\n   (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "case (Fun g Y)"], ["proof (state)\nthis:\n  \\<Gamma> t = Fun g Y\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "obtain f X where *: \"t = Fun f X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f X. t = Fun f X \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using pgwt_fun[OF assms(1)]"], ["proof (prove)\nusing this:\n  \\<exists>f T. t = Fun f T\n\ngoal (1 subgoal):\n 1. (\\<And>f X. t = Fun f X \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  t = Fun f X\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "hence \"f = g\" \"map \\<Gamma> X = Y\""], ["proof (prove)\nusing this:\n  t = Fun f X\n\ngoal (1 subgoal):\n 1. f = g &&& map \\<Gamma> X = Y", "using fun_type_id_eq \\<open>\\<Gamma> t = TComp g Y\\<close> fun_type[OF fun_type_inv(1)[OF \\<open>\\<Gamma> t = TComp g Y\\<close>]]"], ["proof (prove)\nusing this:\n  t = Fun f X\n  \\<Gamma> (Fun ?f ?X) = Fun ?g ?Y \\<Longrightarrow> ?f = ?g\n  \\<Gamma> t = Fun g Y\n  \\<Gamma> (Fun g ?T) = Fun g (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. f = g &&& map \\<Gamma> X = Y", "by fastforce+"], ["proof (state)\nthis:\n  f = g\n  map \\<Gamma> X = Y\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<Gamma> t = Var a \\<longrightarrow>\n        (\\<exists>f. t = Fun f [])) \\<and>\n       (\\<Gamma> t = Fun g Y \\<longrightarrow>\n        (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "thus ?thesis"], ["proof (prove)\nusing this:\n  f = g\n  map \\<Gamma> X = Y\n\ngoal (1 subgoal):\n 1. (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n    (\\<Gamma> t = Fun g Y \\<longrightarrow>\n     (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "using *(1) \\<open>\\<Gamma> t = TComp g Y\\<close>"], ["proof (prove)\nusing this:\n  f = g\n  map \\<Gamma> X = Y\n  t = Fun f X\n  \\<Gamma> t = Fun g Y\n\ngoal (1 subgoal):\n 1. (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n    (\\<Gamma> t = Fun g Y \\<longrightarrow>\n     (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))", "by auto"], ["proof (state)\nthis:\n  (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n  (\\<Gamma> t = Fun g Y \\<longrightarrow>\n   (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n  (\\<Gamma> t = Fun g Y \\<longrightarrow>\n   (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))\n\ngoal (2 subgoals):\n 1. \\<Gamma> t = Var a \\<Longrightarrow> \\<exists>f. t = Fun f []\n 2. \\<Gamma> t = Fun g Y \\<Longrightarrow>\n    \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y", "thus \"\\<Gamma> t = TAtom a \\<Longrightarrow> \\<exists>f. t = Fun f []\" \"\\<Gamma> t = TComp g Y \\<Longrightarrow> \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y\""], ["proof (prove)\nusing this:\n  (\\<Gamma> t = Var a \\<longrightarrow> (\\<exists>f. t = Fun f [])) \\<and>\n  (\\<Gamma> t = Fun g Y \\<longrightarrow>\n   (\\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y))\n\ngoal (1 subgoal):\n 1. (\\<Gamma> t = Var a \\<Longrightarrow> \\<exists>f. t = Fun f []) &&&\n    (\\<Gamma> t = Fun g Y \\<Longrightarrow>\n     \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> t = Var a \\<Longrightarrow> \\<exists>f. t = Fun f []\n  \\<Gamma> t = Fun g Y \\<Longrightarrow>\n  \\<exists>X. t = Fun g X \\<and> map \\<Gamma> X = Y\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wt_subst_Var[simp]: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var", "by (metis wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def)"], ["", "lemma wt_subst_trm: \"(\\<And>v. v \\<in> fv t \\<Longrightarrow> \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)) \\<Longrightarrow> \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>v.\n        v \\<in> fv t \\<Longrightarrow>\n        \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)) \\<Longrightarrow>\n    \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<theta>)", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>v.\n           v \\<in> fv (Var x) \\<Longrightarrow>\n           \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)) \\<Longrightarrow>\n       \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<theta>)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>v.\n                       v \\<in> fv x2a \\<Longrightarrow>\n                       \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x2a =\n                                     \\<Gamma> (x2a \\<cdot> \\<theta>);\n        \\<And>v.\n           v \\<in> fv (Fun x1a x2) \\<Longrightarrow>\n           \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> (Fun x1a x2) =\n                         \\<Gamma> (Fun x1a x2 \\<cdot> \\<theta>)", "case (Fun f X)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set X;\n   \\<And>v.\n      v \\<in> fv ?x2a2 \\<Longrightarrow>\n      \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> ?x2a2 = \\<Gamma> (?x2a2 \\<cdot> \\<theta>)\n  ?v2 \\<in> fv (Fun f X) \\<Longrightarrow>\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>v.\n           v \\<in> fv (Var x) \\<Longrightarrow>\n           \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)) \\<Longrightarrow>\n       \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<theta>)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>v.\n                       v \\<in> fv x2a \\<Longrightarrow>\n                       \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x2a =\n                                     \\<Gamma> (x2a \\<cdot> \\<theta>);\n        \\<And>v.\n           v \\<in> fv (Fun x1a x2) \\<Longrightarrow>\n           \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> (Fun x1a x2) =\n                         \\<Gamma> (Fun x1a x2 \\<cdot> \\<theta>)", "hence *: \"\\<And>x. x \\<in> set X \\<Longrightarrow> \\<Gamma> x = \\<Gamma> (x \\<cdot> \\<theta>)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set X;\n   \\<And>v.\n      v \\<in> fv ?x2a2 \\<Longrightarrow>\n      \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> ?x2a2 = \\<Gamma> (?x2a2 \\<cdot> \\<theta>)\n  ?v2 \\<in> fv (Fun f X) \\<Longrightarrow>\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> set X \\<Longrightarrow>\n       \\<Gamma> x = \\<Gamma> (x \\<cdot> \\<theta>)", "by auto"], ["proof (state)\nthis:\n  ?x2 \\<in> set X \\<Longrightarrow>\n  \\<Gamma> ?x2 = \\<Gamma> (?x2 \\<cdot> \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       (\\<And>v.\n           v \\<in> fv (Var x) \\<Longrightarrow>\n           \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)) \\<Longrightarrow>\n       \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<theta>)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<And>v.\n                       v \\<in> fv x2a \\<Longrightarrow>\n                       \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x2a =\n                                     \\<Gamma> (x2a \\<cdot> \\<theta>);\n        \\<And>v.\n           v \\<in> fv (Fun x1a x2) \\<Longrightarrow>\n           \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> (Fun x1a x2) =\n                         \\<Gamma> (Fun x1a x2 \\<cdot> \\<theta>)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "proof (cases \"f \\<in> \\<Sigma>\\<^sub>f\")"], ["proof (state)\ngoal (2 subgoals):\n 1. f \\<in> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)\n 2. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "case True"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (2 subgoals):\n 1. f \\<in> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)\n 2. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "hence \"\\<forall>X. \\<Gamma> (Fun f X) = TComp f (map \\<Gamma> X)\""], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (1 subgoal):\n 1. \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)", "using fun_type'"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<forall>f\\<in>\\<Union> (range \\<Sigma>n) - \\<C>.\n     \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)\n\ngoal (1 subgoal):\n 1. \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)", "by auto"], ["proof (state)\nthis:\n  \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)\n\ngoal (2 subgoals):\n 1. f \\<in> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)\n 2. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "using *"], ["proof (prove)\nusing this:\n  \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)\n  ?x2 \\<in> set X \\<Longrightarrow>\n  \\<Gamma> ?x2 = \\<Gamma> (?x2 \\<cdot> \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)\n\ngoal (1 subgoal):\n 1. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "case False"], ["proof (state)\nthis:\n  f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (1 subgoal):\n 1. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "hence \"\\<exists>a \\<in> \\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun f X) = TAtom a\""], ["proof (prove)\nusing this:\n  f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (1 subgoal):\n 1. \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun f X) = Var a", "using const_type'"], ["proof (prove)\nusing this:\n  f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<forall>c\\<in>\\<C>.\n     \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun c X) = Var a\n\ngoal (1 subgoal):\n 1. \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun f X) = Var a", "by auto"], ["proof (state)\nthis:\n  \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun f X) = Var a\n\ngoal (1 subgoal):\n 1. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun f X) = Var a\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f X) = \\<Gamma> (Fun f X \\<cdot> \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       (\\<And>v.\n           v \\<in> fv (Var x) \\<Longrightarrow>\n           \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)) \\<Longrightarrow>\n       \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<theta>)", "qed auto"], ["", "lemma wt_subst_trm': \"\\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>; \\<Gamma> s = \\<Gamma> t\\<rbrakk> \\<Longrightarrow> \\<Gamma> (s \\<cdot> \\<sigma>) = \\<Gamma> (t \\<cdot> \\<sigma>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n     \\<Gamma> s = \\<Gamma> t\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> (s \\<cdot> \\<sigma>) =\n                      \\<Gamma> (t \\<cdot> \\<sigma>)", "by (metis wt_subst_trm wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def)"], ["", "lemma wt_subst_trm'': \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma> \\<Longrightarrow> \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma> \\<Longrightarrow>\n    \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>)", "by (metis wt_subst_trm wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def)"], ["", "lemma wt_subst_compose:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta> \\<circ>\\<^sub>s \\<delta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>)", "have \"\\<And>v. \\<Gamma> (\\<theta> v) = \\<Gamma> (\\<theta> v \\<cdot> \\<delta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v. \\<Gamma> (\\<theta> v) = \\<Gamma> (\\<theta> v \\<cdot> \\<delta>)", "using wt_subst_trm \\<open>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\\<close>"], ["proof (prove)\nusing this:\n  (\\<And>v.\n      v \\<in> fv ?t \\<Longrightarrow>\n      \\<Gamma> (Var v) = \\<Gamma> (?\\<theta> v)) \\<Longrightarrow>\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> ?\\<theta>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>v. \\<Gamma> (\\<theta> v) = \\<Gamma> (\\<theta> v \\<cdot> \\<delta>)", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  (\\<And>v.\n      v \\<in> fv ?t \\<Longrightarrow>\n      \\<Gamma> (Var v) = \\<Gamma> (?\\<theta> v)) \\<Longrightarrow>\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> ?\\<theta>)\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<delta> v)\n\ngoal (1 subgoal):\n 1. \\<And>v. \\<Gamma> (\\<theta> v) = \\<Gamma> (\\<theta> v \\<cdot> \\<delta>)", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> (\\<theta> ?v2) = \\<Gamma> (\\<theta> ?v2 \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>)", "moreover"], ["proof (state)\nthis:\n  \\<Gamma> (\\<theta> ?v2) = \\<Gamma> (\\<theta> ?v2 \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>)", "have \"\\<And>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)", "using \\<open>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\\<close>"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\n\ngoal (1 subgoal):\n 1. \\<And>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>)", "ultimately"], ["proof (chain)\npicking this:\n  \\<Gamma> (\\<theta> ?v2) = \\<Gamma> (\\<theta> ?v2 \\<cdot> \\<delta>)\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2)", "have \"\\<And>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v \\<cdot> \\<delta>)\""], ["proof (prove)\nusing this:\n  \\<Gamma> (\\<theta> ?v2) = \\<Gamma> (\\<theta> ?v2 \\<cdot> \\<delta>)\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2)\n\ngoal (1 subgoal):\n 1. \\<And>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v \\<cdot> \\<delta>)", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2 \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2 \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>)", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def subst_compose_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var ?v2) = \\<Gamma> (\\<theta> ?v2 \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v \\<cdot> \\<delta>)", "by metis"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wt_subst_TAtom_Var_cases:\n  assumes \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"\n  and x: \"\\<Gamma> (Var x) = TAtom a\"\n  shows \"(\\<exists>y. \\<theta> x = Var y) \\<or> (\\<exists>c. \\<theta> x = Fun c [])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "proof (cases \"(\\<exists>y. \\<theta> x = Var y)\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])\n 2. \\<nexists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "case False"], ["proof (state)\nthis:\n  \\<nexists>y. \\<theta> x = Var y\n\ngoal (2 subgoals):\n 1. \\<exists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])\n 2. \\<nexists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "then"], ["proof (chain)\npicking this:\n  \\<nexists>y. \\<theta> x = Var y", "obtain c T where c: \"\\<theta> x = Fun c T\""], ["proof (prove)\nusing this:\n  \\<nexists>y. \\<theta> x = Var y\n\ngoal (1 subgoal):\n 1. (\\<And>c T.\n        \\<theta> x = Fun c T \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases \"\\<theta> x\") simp_all"], ["proof (state)\nthis:\n  \\<theta> x = Fun c T\n\ngoal (2 subgoals):\n 1. \\<exists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])\n 2. \\<nexists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "hence \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c T)\""], ["proof (prove)\nusing this:\n  \\<theta> x = Fun c T\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c T)", "using \\<theta>(2)"], ["proof (prove)\nusing this:\n  \\<theta> x = Fun c T\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c T)", "by fastforce"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c T)\n\ngoal (2 subgoals):\n 1. \\<exists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])\n 2. \\<nexists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "hence \"T = []\""], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c T)\n\ngoal (1 subgoal):\n 1. T = []", "using const_type_inv_wf[of c T a] x c wt_subst_trm''[OF \\<theta>(1), of \"Var x\"]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c T)\n  \\<lbrakk>\\<Gamma> (Fun c T) = Var a;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun c T)\\<rbrakk>\n  \\<Longrightarrow> T = []\n  \\<Gamma> (Var x) = Var a\n  \\<theta> x = Fun c T\n  \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<theta>)\n\ngoal (1 subgoal):\n 1. T = []", "by fastforce"], ["proof (state)\nthis:\n  T = []\n\ngoal (2 subgoals):\n 1. \\<exists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])\n 2. \\<nexists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "thus ?thesis"], ["proof (prove)\nusing this:\n  T = []\n\ngoal (1 subgoal):\n 1. (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "using c"], ["proof (prove)\nusing this:\n  T = []\n  \\<theta> x = Fun c T\n\ngoal (1 subgoal):\n 1. (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "by blast"], ["proof (state)\nthis:\n  (\\<exists>y. \\<theta> x = Var y) \\<or> (\\<exists>c. \\<theta> x = Fun c [])\n\ngoal (1 subgoal):\n 1. \\<exists>y. \\<theta> x = Var y \\<Longrightarrow>\n    (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "qed simp"], ["", "lemma wt_subst_TAtom_fv:\n  assumes \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\"\n  and \"\\<forall>x \\<in> fv t - X. \\<exists>a. \\<Gamma> (Var x) = TAtom a\"\n  shows \"\\<forall>x \\<in> fv (t \\<cdot> \\<theta>) - fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X). \\<exists>a. \\<Gamma> (Var x) = TAtom a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "using assms(3)"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv t - X. \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<forall>x\\<in>fv (Var x) - X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a - X.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>x\n        \\<in>fv (x2a \\<cdot> \\<theta>) -\n             fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n  \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv (Fun x1a x2) - X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (Fun x1a x2 \\<cdot> \\<theta>) -\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "case (Var x)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Var x) - X. \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<forall>x\\<in>fv (Var x) - X.\n          \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a - X.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>x\n        \\<in>fv (x2a \\<cdot> \\<theta>) -\n             fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n  \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv (Fun x1a x2) - X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (Fun x1a x2 \\<cdot> \\<theta>) -\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "thus ?case"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv (Var x) - X. \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "proof (cases \"x \\<in> X\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<in> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<notin> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a", "case False"], ["proof (state)\nthis:\n  x \\<notin> X\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<in> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<notin> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a", "with Var"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>fv (Var x) - X. \\<exists>a. \\<Gamma> (Var x) = Var a\n  x \\<notin> X", "obtain a where \"\\<Gamma> (Var x) = TAtom a\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv (Var x) - X. \\<exists>a. \\<Gamma> (Var x) = Var a\n  x \\<notin> X\n\ngoal (1 subgoal):\n 1. (\\<And>a.\n        \\<Gamma> (Var x) = Var a \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<in> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<notin> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a", "hence *: \"\\<Gamma> (\\<theta> x) = TAtom a\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<Gamma> (\\<theta> x) = Var a &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)", "using \\<theta>"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Var a\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  \\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (\\<theta> x) = Var a &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Var a\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\n  \\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (\\<theta> x) = Var a &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (\\<theta> x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<in> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<notin> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "proof (cases \"\\<theta> x\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<theta> x = Var x1 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>x21 x22.\n       \\<theta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a", "case (Var y)"], ["proof (state)\nthis:\n  \\<theta> x = Var y\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<theta> x = Var x1 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>x21 x22.\n       \\<theta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<theta> x = Var y\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "using *"], ["proof (prove)\nusing this:\n  \\<theta> x = Var y\n  \\<Gamma> (\\<theta> x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "by auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                 fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<theta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<theta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<theta> x = Fun f T\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<theta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a", "hence \"T = []\""], ["proof (prove)\nusing this:\n  \\<theta> x = Fun f T\n\ngoal (1 subgoal):\n 1. T = []", "using * const_type_inv[of f T a]"], ["proof (prove)\nusing this:\n  \\<theta> x = Fun f T\n  \\<Gamma> (\\<theta> x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)\n  \\<Gamma> (Fun f T) = Var a \\<Longrightarrow> arity f = 0\n\ngoal (1 subgoal):\n 1. T = []", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<theta> x = Fun f T\n  \\<Gamma> (\\<theta> x) = Var a\n  \\<forall>f T.\n     Fun f T \\<sqsubseteq> \\<theta> x \\<longrightarrow> length T = arity f\n  \\<Gamma> (Fun f T) = Var a \\<Longrightarrow> arity f = 0\n\ngoal (1 subgoal):\n 1. T = []", "by auto"], ["proof (state)\nthis:\n  T = []\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<theta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                      fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n          \\<exists>a. \\<Gamma> (Var x) = Var a", "thus ?thesis"], ["proof (prove)\nusing this:\n  T = []\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "using Fun"], ["proof (prove)\nusing this:\n  T = []\n  \\<theta> x = Fun f T\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                   fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "by auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                 fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                 fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x\\<in>fv (Var x) - X.\n                \\<exists>a. \\<Gamma> (Var x) = Var a;\n     x \\<in> X\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                                     fv\\<^sub>s\\<^sub>e\\<^sub>t\n(\\<theta> ` X).\n                         \\<exists>a. \\<Gamma> (Var x) = Var a", "qed auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Var x \\<cdot> \\<theta>) -\n                 fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a - X.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>x\n        \\<in>fv (x2a \\<cdot> \\<theta>) -\n             fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n  \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv (Fun x1a x2) - X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (Fun x1a x2 \\<cdot> \\<theta>) -\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` X).\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "qed fastforce"], ["", "lemma wt_subst_TAtom_subterms_subst:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"\\<forall>x \\<in> fv t. \\<exists>a. \\<Gamma> (Var x) = TAtom a\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv t)\"\n  shows \"subterms (t \\<cdot> \\<theta>) = subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms (t \\<cdot> \\<theta>) =\n    subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "using assms(2,3)"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv t. \\<exists>a. \\<Gamma> (Var x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv t)\n\ngoal (1 subgoal):\n 1. subterms (t \\<cdot> \\<theta>) =\n    subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x\\<in>fv (Var x).\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Var x))\\<rbrakk>\n       \\<Longrightarrow> subterms (Var x \\<cdot> \\<theta>) =\n                         subterms (Var x) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "case (Var x)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Var x). \\<exists>a. \\<Gamma> (Var x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Var x))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x\\<in>fv (Var x).\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Var x))\\<rbrakk>\n       \\<Longrightarrow> subterms (Var x \\<cdot> \\<theta>) =\n                         subterms (Var x) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "obtain a where a: \"\\<Gamma> (Var x) = TAtom a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a.\n        \\<Gamma> (Var x) = Var a \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Var.prems(1)"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv (Var x). \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. (\\<And>a.\n        \\<Gamma> (Var x) = Var a \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x\\<in>fv (Var x).\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Var x))\\<rbrakk>\n       \\<Longrightarrow> subterms (Var x \\<cdot> \\<theta>) =\n                         subterms (Var x) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "hence \"\\<Gamma> (\\<theta> x) = TAtom a\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<Gamma> (\\<theta> x) = Var a", "using wt_subst_trm''[OF assms(1), of \"Var x\"]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Var a\n  \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (\\<theta> x) = Var a", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> (\\<theta> x) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x\\<in>fv (Var x).\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Var x))\\<rbrakk>\n       \\<Longrightarrow> subterms (Var x \\<cdot> \\<theta>) =\n                         subterms (Var x) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "hence \"(\\<exists>y. \\<theta> x = Var y) \\<or> (\\<exists>c. \\<theta> x = Fun c [])\""], ["proof (prove)\nusing this:\n  \\<Gamma> (\\<theta> x) = Var a\n\ngoal (1 subgoal):\n 1. (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "using const_type_inv_wf Var.prems(2)"], ["proof (prove)\nusing this:\n  \\<Gamma> (\\<theta> x) = Var a\n  \\<lbrakk>\\<Gamma> (Fun ?c ?X) = Var ?a;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun ?c ?X)\\<rbrakk>\n  \\<Longrightarrow> ?X = []\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Var x))\n\ngoal (1 subgoal):\n 1. (\\<exists>y. \\<theta> x = Var y) \\<or>\n    (\\<exists>c. \\<theta> x = Fun c [])", "by (cases \"\\<theta> x\") auto"], ["proof (state)\nthis:\n  (\\<exists>y. \\<theta> x = Var y) \\<or> (\\<exists>c. \\<theta> x = Fun c [])\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x\\<in>fv (Var x).\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Var x))\\<rbrakk>\n       \\<Longrightarrow> subterms (Var x \\<cdot> \\<theta>) =\n                         subterms (Var x) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "thus ?case"], ["proof (prove)\nusing this:\n  (\\<exists>y. \\<theta> x = Var y) \\<or> (\\<exists>c. \\<theta> x = Fun c [])\n\ngoal (1 subgoal):\n 1. subterms (Var x \\<cdot> \\<theta>) =\n    subterms (Var x) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "by auto"], ["proof (state)\nthis:\n  subterms (Var x \\<cdot> \\<theta>) =\n  subterms (Var x) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set T;\n   \\<forall>x\\<in>fv ?x2a2. \\<exists>a. \\<Gamma> (Var x) = Var a;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv ?x2a2)\\<rbrakk>\n  \\<Longrightarrow> subterms (?x2a2 \\<cdot> \\<theta>) =\n                    subterms ?x2a2 \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n  \\<forall>x\\<in>fv (Fun f T). \\<exists>a. \\<Gamma> (Var x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Fun f T))\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "have \"subterms (t \\<cdot> \\<theta>) = subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\" when \"t \\<in> set T\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms (t \\<cdot> \\<theta>) =\n    subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "using that Fun.prems(1,2) Fun.IH[OF that]"], ["proof (prove)\nusing this:\n  t \\<in> set T\n  \\<forall>x\\<in>fv (Fun f T). \\<exists>a. \\<Gamma> (Var x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv (Fun f T))\n  \\<lbrakk>\\<forall>x\\<in>fv t. \\<exists>a. \\<Gamma> (Var x) = Var a;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv t)\\<rbrakk>\n  \\<Longrightarrow> subterms (t \\<cdot> \\<theta>) =\n                    subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. subterms (t \\<cdot> \\<theta>) =\n    subterms t \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "by auto"], ["proof (state)\nthis:\n  ?t2 \\<in> set T \\<Longrightarrow>\n  subterms (?t2 \\<cdot> \\<theta>) =\n  subterms ?t2 \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                     (\\<theta> ` fv x2a)\\<rbrakk>\n                   \\<Longrightarrow> subterms (x2a \\<cdot> \\<theta>) =\n                                     subterms\nx2a \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                                     \\<theta>;\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n         (\\<theta> ` fv (Fun x1a x2))\\<rbrakk>\n       \\<Longrightarrow> subterms (Fun x1a x2 \\<cdot> \\<theta>) =\n                         subterms\n                          (Fun x1a x2) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                         \\<theta>", "thus ?case"], ["proof (prove)\nusing this:\n  ?t2 \\<in> set T \\<Longrightarrow>\n  subterms (?t2 \\<cdot> \\<theta>) =\n  subterms ?t2 \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. subterms (Fun f T \\<cdot> \\<theta>) =\n    subterms (Fun f T) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "by auto"], ["proof (state)\nthis:\n  subterms (Fun f T \\<cdot> \\<theta>) =\n  subterms (Fun f T) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wt_subst_TAtom_subterms_set_subst: \n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"\\<forall>x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t M. \\<exists>a. \\<Gamma> (Var x) = TAtom a\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv\\<^sub>s\\<^sub>e\\<^sub>t M)\"\n  shows \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>) = subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>) =\n    subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<theta>", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)\n    \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                 M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                \\<theta>\n 2. subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<theta>\n    \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                 (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)", "show \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>) \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)\n    \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                 M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                \\<theta>", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta> \\<Longrightarrow>\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta>", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta> \\<Longrightarrow>\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta>", "assume \"t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)\""], ["proof (state)\nthis:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n  M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta> \\<Longrightarrow>\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta>", "then"], ["proof (chain)\npicking this:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n  M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "obtain s where s: \"s \\<in> M\" \"t \\<in> subterms (s \\<cdot> \\<theta>)\""], ["proof (prove)\nusing this:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n  M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> M; t \\<sqsubseteq> s \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  s \\<in> M\n  t \\<sqsubseteq> s \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta> \\<Longrightarrow>\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta>", "thus \"t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\""], ["proof (prove)\nusing this:\n  s \\<in> M\n  t \\<sqsubseteq> s \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n             M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n            \\<theta>", "using assms(2,3) wt_subst_TAtom_subterms_subst[OF assms(1), of s]"], ["proof (prove)\nusing this:\n  s \\<in> M\n  t \\<sqsubseteq> s \\<cdot> \\<theta>\n  \\<forall>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<theta> ` fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  \\<lbrakk>\\<forall>x\\<in>fv s. \\<exists>a. \\<Gamma> (Var x) = Var a;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv s)\\<rbrakk>\n  \\<Longrightarrow> subterms (s \\<cdot> \\<theta>) =\n                    subterms s \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n             M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n            \\<theta>", "by auto"], ["proof (state)\nthis:\n  t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          \\<theta>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)\n  \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n               M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              \\<theta>\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<theta>\n    \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                 (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)", "show \"subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta> \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<theta>\n    \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                 (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta> \\<Longrightarrow>\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta> \\<Longrightarrow>\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "assume \"t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\""], ["proof (state)\nthis:\n  t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta> \\<Longrightarrow>\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "then"], ["proof (chain)\npicking this:\n  t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          \\<theta>", "obtain s where s: \"s \\<in> M\" \"t \\<in> subterms s \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\""], ["proof (prove)\nusing this:\n  t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          \\<theta>\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> M;\n         t \\<in> subterms s \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  s \\<in> M\n  t \\<in> subterms s \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               \\<theta> \\<Longrightarrow>\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "thus \"t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)\""], ["proof (prove)\nusing this:\n  s \\<in> M\n  t \\<in> subterms s \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n    M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "using assms(2,3) wt_subst_TAtom_subterms_subst[OF assms(1), of s]"], ["proof (prove)\nusing this:\n  s \\<in> M\n  t \\<in> subterms s \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n  \\<forall>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<theta> ` fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  \\<lbrakk>\\<forall>x\\<in>fv s. \\<exists>a. \\<Gamma> (Var x) = Var a;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<theta> ` fv s)\\<rbrakk>\n  \\<Longrightarrow> subterms (s \\<cdot> \\<theta>) =\n                    subterms s \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n    M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "by auto"], ["proof (state)\nthis:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n  M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<theta>\n  \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n               (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wt_subst_subst_upd:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\"\n    and \"\\<Gamma> (Var x) = \\<Gamma> t\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta>(x := t))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta>(x := t))", "using assms"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  \\<Gamma> (Var x) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta>(x := t))", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)\n  \\<Gamma> (Var x) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> ((\\<theta>(x := t)) v)", "by (metis fun_upd_other fun_upd_same)"], ["", "lemma wt_subst_const_fv_type_eq:\n  assumes \"\\<forall>x \\<in> fv t. \\<exists>a. \\<Gamma> (Var x) = TAtom a\"\n    and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n  shows \"\\<forall>x \\<in> fv (t \\<cdot> \\<delta>). \\<exists>y \\<in> fv t. \\<Gamma> (Var x) = \\<Gamma> (Var y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n       \\<exists>y\\<in>fv t. \\<Gamma> (Var x) = \\<Gamma> (Var y)", "using assms(1)"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv t. \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n       \\<exists>y\\<in>fv t. \\<Gamma> (Var x) = \\<Gamma> (Var y)", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<forall>x\\<in>fv (Var x).\n          \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>x\n        \\<in>fv (x2a \\<cdot> \\<delta>).\n  \\<exists>y\\<in>fv x2a. \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (Fun x1a x2 \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv (Fun x1a x2).\n                               \\<Gamma> (Var x) = \\<Gamma> (Var y)", "case (Var x)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Var x). \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<forall>x\\<in>fv (Var x).\n          \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>x\n        \\<in>fv (x2a \\<cdot> \\<delta>).\n  \\<exists>y\\<in>fv x2a. \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (Fun x1a x2 \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv (Fun x1a x2).\n                               \\<Gamma> (Var x) = \\<Gamma> (Var y)", "then"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>fv (Var x). \\<exists>a. \\<Gamma> (Var x) = Var a", "obtain a where a: \"\\<Gamma> (Var x) = TAtom a\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv (Var x). \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. (\\<And>a.\n        \\<Gamma> (Var x) = Var a \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<forall>x\\<in>fv (Var x).\n          \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>x\n        \\<in>fv (x2a \\<cdot> \\<delta>).\n  \\<exists>y\\<in>fv x2a. \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (Fun x1a x2 \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv (Fun x1a x2).\n                               \\<Gamma> (Var x) = \\<Gamma> (Var y)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n       \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)", "proof (cases \"\\<delta> x\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<delta> x = Var x1 \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n 2. \\<And>x21 x22.\n       \\<delta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<delta> x = Fun f T\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<delta> x = Var x1 \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n 2. \\<And>x21 x22.\n       \\<delta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)", "hence \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\" \"\\<Gamma> (Fun f T) = TAtom a\""], ["proof (prove)\nusing this:\n  \\<delta> x = Fun f T\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T) &&& \\<Gamma> (Fun f T) = Var a", "using a wt_subst_trm''[OF \\<delta>(1), of \"Var x\"] \\<delta>(2)"], ["proof (prove)\nusing this:\n  \\<delta> x = Fun f T\n  \\<Gamma> (Var x) = Var a\n  \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T) &&& \\<Gamma> (Fun f T) = Var a", "by fastforce+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n  \\<Gamma> (Fun f T) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<delta> x = Var x1 \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n 2. \\<And>x21 x22.\n       \\<delta> x = Fun x21 x22 \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)", "thus ?thesis"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n  \\<Gamma> (Fun f T) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n       \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)", "using const_type_inv_wf Fun"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n  \\<Gamma> (Fun f T) = Var a\n  \\<lbrakk>\\<Gamma> (Fun ?c ?X) = Var ?a;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun ?c ?X)\\<rbrakk>\n  \\<Longrightarrow> ?X = []\n  \\<delta> x = Fun f T\n\ngoal (1 subgoal):\n 1. \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n       \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)", "by fastforce"], ["proof (state)\nthis:\n  \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n     \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       \\<delta> x = Var x1 \\<Longrightarrow>\n       \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n          \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)", "qed (use a wt_subst_trm''[OF \\<delta>(1), of \"Var x\"] in simp)"], ["proof (state)\nthis:\n  \\<forall>xa\\<in>fv (Var x \\<cdot> \\<delta>).\n     \\<exists>y\\<in>fv (Var x). \\<Gamma> (Var xa) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    \\<forall>x\\<in>fv x2a.\n                       \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>x\n        \\<in>fv (x2a \\<cdot> \\<delta>).\n  \\<exists>y\\<in>fv x2a. \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv (Fun x1a x2).\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (Fun x1a x2 \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv (Fun x1a x2).\n                               \\<Gamma> (Var x) = \\<Gamma> (Var y)", "qed fastforce"], ["", "lemma TComp_term_cases:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> t = TComp f T\"\n  shows \"(\\<exists>v. t = Var v) \\<or> (\\<exists>T'. t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])", "proof (cases \"\\<exists>v. t = Var v\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>v. t = Var v \\<Longrightarrow>\n    (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])\n 2. \\<nexists>v. t = Var v \\<Longrightarrow>\n    (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])", "case False"], ["proof (state)\nthis:\n  \\<nexists>v. t = Var v\n\ngoal (2 subgoals):\n 1. \\<exists>v. t = Var v \\<Longrightarrow>\n    (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])\n 2. \\<nexists>v. t = Var v \\<Longrightarrow>\n    (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])", "then"], ["proof (chain)\npicking this:\n  \\<nexists>v. t = Var v", "obtain T' where T': \"t = Fun f T'\" \"T = map \\<Gamma> T'\""], ["proof (prove)\nusing this:\n  \\<nexists>v. t = Var v\n\ngoal (1 subgoal):\n 1. (\\<And>T'.\n        \\<lbrakk>t = Fun f T'; T = map \\<Gamma> T'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms fun_type[OF fun_type_inv(1)[OF assms(2)]] fun_type_id_eq"], ["proof (prove)\nusing this:\n  \\<nexists>v. t = Var v\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> t = Fun f T\n  \\<Gamma> (Fun f ?T) = Fun f (map \\<Gamma> ?T)\n  \\<Gamma> (Fun ?f ?X) = Fun ?g ?Y \\<Longrightarrow> ?f = ?g\n\ngoal (1 subgoal):\n 1. (\\<And>T'.\n        \\<lbrakk>t = Fun f T'; T = map \\<Gamma> T'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases t) force+"], ["proof (state)\nthis:\n  t = Fun f T'\n  T = map \\<Gamma> T'\n\ngoal (2 subgoals):\n 1. \\<exists>v. t = Var v \\<Longrightarrow>\n    (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])\n 2. \\<nexists>v. t = Var v \\<Longrightarrow>\n    (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])", "thus ?thesis"], ["proof (prove)\nusing this:\n  t = Fun f T'\n  T = map \\<Gamma> T'\n\ngoal (1 subgoal):\n 1. (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])", "using assms fun_type_inv(1) fun_type_inv_wf"], ["proof (prove)\nusing this:\n  t = Fun f T'\n  T = map \\<Gamma> T'\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> t = Fun f T\n  \\<Gamma> ?t = Fun ?f ?T \\<Longrightarrow> 0 < arity ?f\n  \\<lbrakk>\\<Gamma> ?t = Fun ?f ?T; wf\\<^sub>t\\<^sub>r\\<^sub>m ?t\\<rbrakk>\n  \\<Longrightarrow> arity ?f = length ?T\n\ngoal (1 subgoal):\n 1. (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])", "by fastforce"], ["proof (state)\nthis:\n  (\\<exists>v. t = Var v) \\<or>\n  (\\<exists>T'.\n      t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])\n\ngoal (1 subgoal):\n 1. \\<exists>v. t = Var v \\<Longrightarrow>\n    (\\<exists>v. t = Var v) \\<or>\n    (\\<exists>T'.\n        t = Fun f T' \\<and> T = map \\<Gamma> T' \\<and> T' \\<noteq> [])", "qed metis"], ["", "lemma TAtom_term_cases:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> t = TAtom \\<tau>\"\n  shows \"(\\<exists>v. t = Var v) \\<or> (\\<exists>f. t = Fun f [])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>v. t = Var v) \\<or> (\\<exists>f. t = Fun f [])", "using assms const_type_inv"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> t = Var \\<tau>\n  \\<Gamma> (Fun ?c ?X) = Var ?a \\<Longrightarrow> arity ?c = 0\n\ngoal (1 subgoal):\n 1. (\\<exists>v. t = Var v) \\<or> (\\<exists>f. t = Fun f [])", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<forall>f T. Fun f T \\<sqsubseteq> t \\<longrightarrow> length T = arity f\n  \\<Gamma> t = Var \\<tau>\n  \\<Gamma> (Fun ?c ?X) = Var ?a \\<Longrightarrow> arity ?c = 0\n\ngoal (1 subgoal):\n 1. (\\<exists>v. t = Var v) \\<or> (\\<exists>f. t = Fun f [])", "by (cases t) auto"], ["", "lemma subtermeq_imp_subtermtypeeq:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"s \\<sqsubseteq> t\"\n  shows \"\\<Gamma> s \\<sqsubseteq> \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> s \\<sqsubseteq> \\<Gamma> t", "using assms(2,1)"], ["proof (prove)\nusing this:\n  s \\<sqsubseteq> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s \\<sqsubseteq> \\<Gamma> t", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>s \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Var x)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; s \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n        s \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun x1a x2)", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set T; s \\<sqsubseteq> ?x2a2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> ?x2a2\n  s \\<sqsubseteq> Fun f T\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>s \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Var x)\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; s \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n        s \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun x1a x2)", "thus ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T; s \\<sqsubseteq> ?x2a2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> ?x2a2\n  s \\<sqsubseteq> Fun f T\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n\ngoal (1 subgoal):\n 1. \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "proof (cases \"s = Fun f T\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n 2. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s \\<noteq> Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "case False"], ["proof (state)\nthis:\n  s \\<noteq> Fun f T\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n 2. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s \\<noteq> Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "then"], ["proof (chain)\npicking this:\n  s \\<noteq> Fun f T", "obtain x where x: \"x \\<in> set T\" \"s \\<sqsubseteq> x\""], ["proof (prove)\nusing this:\n  s \\<noteq> Fun f T\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> set T; s \\<sqsubseteq> x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Fun.prems(1)"], ["proof (prove)\nusing this:\n  s \\<noteq> Fun f T\n  s \\<sqsubseteq> Fun f T\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> set T; s \\<sqsubseteq> x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x \\<in> set T\n  s \\<sqsubseteq> x\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n 2. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s \\<noteq> Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "hence \"wf\\<^sub>t\\<^sub>r\\<^sub>m x\""], ["proof (prove)\nusing this:\n  x \\<in> set T\n  s \\<sqsubseteq> x\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m x", "using wf_trm_subtermeq[OF Fun.prems(2)] Fun_param_is_subterm[of _ T f]"], ["proof (prove)\nusing this:\n  x \\<in> set T\n  s \\<sqsubseteq> x\n  ?s \\<sqsubseteq> Fun f T \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?s\n  ?x \\<in> set T \\<Longrightarrow> ?x \\<sqsubset> Fun f T\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m x", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m x\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n 2. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s \\<noteq> Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "hence \"\\<Gamma> s \\<sqsubseteq> \\<Gamma> x\""], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m x\n\ngoal (1 subgoal):\n 1. \\<Gamma> s \\<sqsubseteq> \\<Gamma> x", "using Fun.IH[OF x]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m x\n  wf\\<^sub>t\\<^sub>r\\<^sub>m x \\<Longrightarrow>\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> x\n\ngoal (1 subgoal):\n 1. \\<Gamma> s \\<sqsubseteq> \\<Gamma> x", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> x\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n 2. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s \\<noteq> Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "moreover"], ["proof (state)\nthis:\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> x\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n 2. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s \\<noteq> Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "have \"arity f > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity f", "using x fun_type_inv_wf Fun.prems"], ["proof (prove)\nusing this:\n  x \\<in> set T\n  s \\<sqsubseteq> x\n  \\<lbrakk>\\<Gamma> ?t = Fun ?f ?T; wf\\<^sub>t\\<^sub>r\\<^sub>m ?t\\<rbrakk>\n  \\<Longrightarrow> arity ?f = length ?T\n  s \\<sqsubseteq> Fun f T\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n\ngoal (1 subgoal):\n 1. 0 < arity f", "by (metis length_pos_if_in_set term.order_refl wf\\<^sub>t\\<^sub>r\\<^sub>m_def)"], ["proof (state)\nthis:\n  0 < arity f\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n 2. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s \\<noteq> Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "ultimately"], ["proof (chain)\npicking this:\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> x\n  0 < arity f", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> x\n  0 < arity f\n\ngoal (1 subgoal):\n 1. \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "using x Fun.prems fun_type[of f T]"], ["proof (prove)\nusing this:\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> x\n  0 < arity f\n  x \\<in> set T\n  s \\<sqsubseteq> x\n  s \\<sqsubseteq> Fun f T\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n  0 < arity f \\<Longrightarrow> \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\n\ngoal (1 subgoal):\n 1. \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x2a.\n                \\<lbrakk>x2a \\<in> set T; s \\<sqsubseteq> x2a;\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> x2a;\n     s \\<sqsubseteq> Fun f T; wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T);\n     s = Fun f T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)", "qed simp"], ["proof (state)\nthis:\n  \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Fun f T)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>s \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s \\<sqsubseteq> \\<Gamma> (Var x)", "qed simp"], ["", "lemma subterm_funs_term_in_type:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"Fun f T \\<sqsubseteq> t\" \"\\<Gamma> (Fun f T) = TComp f (map \\<Gamma> T)\"\n  shows \"f \\<in> funs_term (\\<Gamma> t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> t)", "using assms(2,1,3)"], ["proof (prove)\nusing this:\n  Fun f T \\<sqsubseteq> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> t)", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "case (Fun f' T')"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set T'; Fun f T \\<sqsubseteq> ?x2a2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2;\n   \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> ?x2a2)\n  Fun f T \\<sqsubseteq> Fun f' T'\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f' T')\n  \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "hence [simp]: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T'; Fun f T \\<sqsubseteq> ?x2a2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2;\n   \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> ?x2a2)\n  Fun f T \\<sqsubseteq> Fun f' T'\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f' T')\n  \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)", "by (metis wf_trm_subtermeq)"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "{"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f T)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "fix a"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "assume \\<tau>: \"\\<Gamma> (Fun f' T') = TAtom a\""], ["proof (state)\nthis:\n  \\<Gamma> (Fun f' T') = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "hence \"Fun f T = Fun f' T'\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Var a\n\ngoal (1 subgoal):\n 1. Fun f T = Fun f' T'", "using Fun TAtom_term_cases subtermeq_Var_const"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Var a\n  \\<lbrakk>?x2a2 \\<in> set T'; Fun f T \\<sqsubseteq> ?x2a2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2;\n   \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> ?x2a2)\n  Fun f T \\<sqsubseteq> Fun f' T'\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f' T')\n  \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; \\<Gamma> ?t = Var ?\\<tau>\\<rbrakk>\n  \\<Longrightarrow> (\\<exists>v. ?t = Var v) \\<or>\n                    (\\<exists>f. ?t = Fun f [])\n  \\<lbrakk>?s \\<sqsubseteq> ?t; ?t = Var ?v\\<rbrakk>\n  \\<Longrightarrow> ?s = Var ?v\n  \\<lbrakk>?s \\<sqsubseteq> ?t; ?t = Fun ?f []\\<rbrakk>\n  \\<Longrightarrow> ?s = Fun ?f []\n\ngoal (1 subgoal):\n 1. Fun f T = Fun f' T'", "by metis"], ["proof (state)\nthis:\n  Fun f T = Fun f' T'\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "hence False"], ["proof (prove)\nusing this:\n  Fun f T = Fun f' T'\n\ngoal (1 subgoal):\n 1. False", "using Fun.prems(3) \\<tau>"], ["proof (prove)\nusing this:\n  Fun f T = Fun f' T'\n  \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\n  \\<Gamma> (Fun f' T') = Var a\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "}"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f' T') = Var ?a4 \\<Longrightarrow> False\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "moreover"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f' T') = Var ?a4 \\<Longrightarrow> False\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "{"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f' T') = Var ?a4 \\<Longrightarrow> False\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "fix g S"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "assume \\<tau>: \"\\<Gamma> (Fun f' T') = TComp g S\""], ["proof (state)\nthis:\n  \\<Gamma> (Fun f' T') = Fun g S\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "hence \"g = f'\" \"S = map \\<Gamma> T'\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Fun g S\n\ngoal (1 subgoal):\n 1. g = f' &&& S = map \\<Gamma> T'", "using Fun.prems(2) fun_type_id_eq[OF \\<tau>] fun_type[OF fun_type_inv(1)[OF \\<tau>]]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Fun g S\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f' T')\n  f' = g\n  \\<Gamma> (Fun g ?T) = Fun g (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. g = f' &&& S = map \\<Gamma> T'", "by auto"], ["proof (state)\nthis:\n  g = f'\n  S = map \\<Gamma> T'\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "hence \\<tau>': \"\\<Gamma> (Fun f' T') = TComp f' (map \\<Gamma> T')\""], ["proof (prove)\nusing this:\n  g = f'\n  S = map \\<Gamma> T'\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f' T') = Fun f' (map \\<Gamma> T')", "using \\<tau>"], ["proof (prove)\nusing this:\n  g = f'\n  S = map \\<Gamma> T'\n  \\<Gamma> (Fun f' T') = Fun g S\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f' T') = Fun f' (map \\<Gamma> T')", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f' T') = Fun f' (map \\<Gamma> T')\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "hence \"g \\<in> funs_term (\\<Gamma> (Fun f' T'))\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Fun f' (map \\<Gamma> T')\n\ngoal (1 subgoal):\n 1. g \\<in> funs_term (\\<Gamma> (Fun f' T'))", "using \\<tau>"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Fun f' (map \\<Gamma> T')\n  \\<Gamma> (Fun f' T') = Fun g S\n\ngoal (1 subgoal):\n 1. g \\<in> funs_term (\\<Gamma> (Fun f' T'))", "by auto"], ["proof (state)\nthis:\n  g \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "moreover"], ["proof (state)\nthis:\n  g \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "{"], ["proof (state)\nthis:\n  g \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "assume \"Fun f T \\<noteq> Fun f' T'\""], ["proof (state)\nthis:\n  Fun f T \\<noteq> Fun f' T'\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "then"], ["proof (chain)\npicking this:\n  Fun f T \\<noteq> Fun f' T'", "obtain x where \"x \\<in> set T'\" \"Fun f T \\<sqsubseteq> x\""], ["proof (prove)\nusing this:\n  Fun f T \\<noteq> Fun f' T'\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> set T'; Fun f T \\<sqsubseteq> x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Fun.prems(1)"], ["proof (prove)\nusing this:\n  Fun f T \\<noteq> Fun f' T'\n  Fun f T \\<sqsubseteq> Fun f' T'\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> set T'; Fun f T \\<sqsubseteq> x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x \\<in> set T'\n  Fun f T \\<sqsubseteq> x\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "hence \"f \\<in> funs_term (\\<Gamma> x)\""], ["proof (prove)\nusing this:\n  x \\<in> set T'\n  Fun f T \\<sqsubseteq> x\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> x)", "using Fun.IH[OF _ _ _ Fun.prems(3), of x] wf_trm_subtermeq[OF \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f' T')\\<close>, of x]"], ["proof (prove)\nusing this:\n  x \\<in> set T'\n  Fun f T \\<sqsubseteq> x\n  \\<lbrakk>x \\<in> set T'; Fun f T \\<sqsubseteq> x;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m x\\<rbrakk>\n  \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x)\n  x \\<sqsubseteq> Fun f' T' \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m x\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> x)", "by force"], ["proof (state)\nthis:\n  f \\<in> funs_term (\\<Gamma> x)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "moreover"], ["proof (state)\nthis:\n  f \\<in> funs_term (\\<Gamma> x)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "have \"\\<Gamma> x \\<in> set (map \\<Gamma> T')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> x \\<in> set (map \\<Gamma> T')", "using \\<tau>' \\<open>x \\<in> set T'\\<close>"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Fun f' (map \\<Gamma> T')\n  x \\<in> set T'\n\ngoal (1 subgoal):\n 1. \\<Gamma> x \\<in> set (map \\<Gamma> T')", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> x \\<in> set (map \\<Gamma> T')\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "ultimately"], ["proof (chain)\npicking this:\n  f \\<in> funs_term (\\<Gamma> x)\n  \\<Gamma> x \\<in> set (map \\<Gamma> T')", "have \"f \\<in> funs_term (\\<Gamma> (Fun f' T'))\""], ["proof (prove)\nusing this:\n  f \\<in> funs_term (\\<Gamma> x)\n  \\<Gamma> x \\<in> set (map \\<Gamma> T')\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> (Fun f' T'))", "using \\<tau>'"], ["proof (prove)\nusing this:\n  f \\<in> funs_term (\\<Gamma> x)\n  \\<Gamma> x \\<in> set (map \\<Gamma> T')\n  \\<Gamma> (Fun f' T') = Fun f' (map \\<Gamma> T')\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> (Fun f' T'))", "by auto"], ["proof (state)\nthis:\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "}"], ["proof (state)\nthis:\n  Fun f T \\<noteq> Fun f' T' \\<Longrightarrow>\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "ultimately"], ["proof (chain)\npicking this:\n  g \\<in> funs_term (\\<Gamma> (Fun f' T'))\n  Fun f T \\<noteq> Fun f' T' \\<Longrightarrow>\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))", "have ?case"], ["proof (prove)\nusing this:\n  g \\<in> funs_term (\\<Gamma> (Fun f' T'))\n  Fun f T \\<noteq> Fun f' T' \\<Longrightarrow>\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> (Fun f' T'))", "by (cases \"Fun f T = Fun f' T'\") (auto simp add: \\<open>g = f'\\<close>)"], ["proof (state)\nthis:\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "}"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f' T') = Fun ?g4 ?S4 \\<Longrightarrow>\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2; Fun f T \\<sqsubseteq> x2a;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a;\n                    \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n                   \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> x2a);\n        Fun f T \\<sqsubseteq> Fun x1a x2;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Fun x1a x2))", "ultimately"], ["proof (chain)\npicking this:\n  \\<Gamma> (Fun f' T') = Var ?a4 \\<Longrightarrow> False\n  \\<Gamma> (Fun f' T') = Fun ?g4 ?S4 \\<Longrightarrow>\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))", "show ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f' T') = Var ?a4 \\<Longrightarrow> False\n  \\<Gamma> (Fun f' T') = Fun ?g4 ?S4 \\<Longrightarrow>\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> (Fun f' T'))", "by (cases \"\\<Gamma> (Fun f' T')\") auto"], ["proof (state)\nthis:\n  f \\<in> funs_term (\\<Gamma> (Fun f' T'))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Fun f T \\<sqsubseteq> Var x;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x);\n        \\<Gamma> (Fun f T) = Fun f (map \\<Gamma> T)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> funs_term (\\<Gamma> (Var x))", "qed simp"], ["", "lemma wt_subst_fv_termtype_subterm:\n  assumes \"x \\<in> fv (\\<theta> y)\"\n    and \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> y)\"\n  shows \"\\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)", "using subtermeq_imp_subtermtypeeq[OF assms(3) var_is_subterm[OF assms(1)]]\n      wt_subst_trm''[OF assms(2), of \"Var y\"]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (\\<theta> y)\n  \\<Gamma> (Var y) = \\<Gamma> (Var y \\<cdot> \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)", "by auto"], ["", "lemma wt_subst_fv\\<^sub>s\\<^sub>e\\<^sub>t_termtype_subterm:\n  assumes \"x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` Y)\"\n    and \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"\n  shows \"\\<exists>y \\<in> Y. \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>Y. \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)", "using wt_subst_fv_termtype_subterm[OF _ assms(2), of x] assms(1,3)"], ["proof (prove)\nusing this:\n  \\<lbrakk>x \\<in> fv (\\<theta> ?y);\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> ?y)\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var ?y)\n  x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (\\<theta> ` Y)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>Y. \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)", "by fastforce"], ["", "lemma funs_term_type_iff:\n  assumes t: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"\n    and f: \"arity f > 0\"\n  shows \"f \\<in> funs_term (\\<Gamma> t) \\<longleftrightarrow> (f \\<in> funs_term t \\<or> (\\<exists>x \\<in> fv t. f \\<in> funs_term (\\<Gamma> (Var x))))\"\n    (is \"?P t \\<longleftrightarrow> ?Q t\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> t)) =\n    (f \\<in> funs_term t \\<or>\n     (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x))))", "using t"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> t)) =\n    (f \\<in> funs_term t \\<or>\n     (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x))))", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       (f \\<in> funs_term (\\<Gamma> (Var x))) =\n       (f \\<in> funs_term (Var x) \\<or>\n        (\\<exists>x\\<in>fv (Var x). f \\<in> funs_term (\\<Gamma> (Var x))))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> x2a)) =\n                                     (f \\<in> funs_term x2a \\<or>\n(\\<exists>x\\<in>fv x2a. f \\<in> funs_term (\\<Gamma> (Var x))));\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> (Fun x1a x2))) =\n                         (f \\<in> funs_term (Fun x1a x2) \\<or>\n                          (\\<exists>x\\<in>fv (Fun x1a x2).\n                              f \\<in> funs_term (\\<Gamma> (Var x))))", "case (Fun g T)"], ["proof (state)\nthis:\n  \\<lbrakk>?x2a2 \\<in> set T; wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> ?x2a2)) =\n                    (f \\<in> funs_term ?x2a2 \\<or>\n                     (\\<exists>x\\<in>fv ?x2a2.\n                         f \\<in> funs_term (\\<Gamma> (Var x))))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       (f \\<in> funs_term (\\<Gamma> (Var x))) =\n       (f \\<in> funs_term (Var x) \\<or>\n        (\\<exists>x\\<in>fv (Var x). f \\<in> funs_term (\\<Gamma> (Var x))))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> x2a)) =\n                                     (f \\<in> funs_term x2a \\<or>\n(\\<exists>x\\<in>fv x2a. f \\<in> funs_term (\\<Gamma> (Var x))));\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> (Fun x1a x2))) =\n                         (f \\<in> funs_term (Fun x1a x2) \\<or>\n                          (\\<exists>x\\<in>fv (Fun x1a x2).\n                              f \\<in> funs_term (\\<Gamma> (Var x))))", "hence IH: \"?P s \\<longleftrightarrow> ?Q s\" when \"s \\<in> set T\" for s"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T; wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> ?x2a2)) =\n                    (f \\<in> funs_term ?x2a2 \\<or>\n                     (\\<exists>x\\<in>fv ?x2a2.\n                         f \\<in> funs_term (\\<Gamma> (Var x))))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\n\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> s)) =\n    (f \\<in> funs_term s \\<or>\n     (\\<exists>x\\<in>fv s. f \\<in> funs_term (\\<Gamma> (Var x))))", "using that wf_trm_subterm[OF _ Fun_param_is_subterm]"], ["proof (prove)\nusing this:\n  \\<lbrakk>?x2a2 \\<in> set T; wf\\<^sub>t\\<^sub>r\\<^sub>m ?x2a2\\<rbrakk>\n  \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> ?x2a2)) =\n                    (f \\<in> funs_term ?x2a2 \\<or>\n                     (\\<exists>x\\<in>fv ?x2a2.\n                         f \\<in> funs_term (\\<Gamma> (Var x))))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\n  s \\<in> set T\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun ?f1 ?X1);\n   ?s \\<in> set ?X1\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?s\n\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> s)) =\n    (f \\<in> funs_term s \\<or>\n     (\\<exists>x\\<in>fv s. f \\<in> funs_term (\\<Gamma> (Var x))))", "by blast"], ["proof (state)\nthis:\n  ?s2 \\<in> set T \\<Longrightarrow>\n  (f \\<in> funs_term (\\<Gamma> ?s2)) =\n  (f \\<in> funs_term ?s2 \\<or>\n   (\\<exists>x\\<in>fv ?s2. f \\<in> funs_term (\\<Gamma> (Var x))))\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       (f \\<in> funs_term (\\<Gamma> (Var x))) =\n       (f \\<in> funs_term (Var x) \\<or>\n        (\\<exists>x\\<in>fv (Var x). f \\<in> funs_term (\\<Gamma> (Var x))))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> x2a)) =\n                                     (f \\<in> funs_term x2a \\<or>\n(\\<exists>x\\<in>fv x2a. f \\<in> funs_term (\\<Gamma> (Var x))));\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> (Fun x1a x2))) =\n                         (f \\<in> funs_term (Fun x1a x2) \\<or>\n                          (\\<exists>x\\<in>fv (Fun x1a x2).\n                              f \\<in> funs_term (\\<Gamma> (Var x))))", "have 0: \"arity g = length T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. arity g = length T", "using Fun.prems"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\n\ngoal (1 subgoal):\n 1. arity g = length T", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<forall>f Ta.\n     Fun f Ta \\<sqsubseteq> Fun g T \\<longrightarrow> length Ta = arity f\n\ngoal (1 subgoal):\n 1. arity g = length T", "by auto"], ["proof (state)\nthis:\n  arity g = length T\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       (f \\<in> funs_term (\\<Gamma> (Var x))) =\n       (f \\<in> funs_term (Var x) \\<or>\n        (\\<exists>x\\<in>fv (Var x). f \\<in> funs_term (\\<Gamma> (Var x))))\n 2. \\<And>x1a x2.\n       \\<lbrakk>\\<And>x2a.\n                   \\<lbrakk>x2a \\<in> set x2;\n                    wf\\<^sub>t\\<^sub>r\\<^sub>m x2a\\<rbrakk>\n                   \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> x2a)) =\n                                     (f \\<in> funs_term x2a \\<or>\n(\\<exists>x\\<in>fv x2a. f \\<in> funs_term (\\<Gamma> (Var x))));\n        wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun x1a x2)\\<rbrakk>\n       \\<Longrightarrow> (f \\<in> funs_term (\\<Gamma> (Fun x1a x2))) =\n                         (f \\<in> funs_term (Fun x1a x2) \\<or>\n                          (\\<exists>x\\<in>fv (Fun x1a x2).\n                              f \\<in> funs_term (\\<Gamma> (Var x))))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "proof (cases \"f = g\")"], ["proof (state)\ngoal (2 subgoals):\n 1. f = g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))\n 2. f \\<noteq> g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "case True"], ["proof (state)\nthis:\n  f = g\n\ngoal (2 subgoals):\n 1. f = g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))\n 2. f \\<noteq> g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "thus ?thesis"], ["proof (prove)\nusing this:\n  f = g\n\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "using fun_type[OF f]"], ["proof (prove)\nusing this:\n  f = g\n  \\<Gamma> (Fun f ?T) = Fun f (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "by simp"], ["proof (state)\nthis:\n  (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n  (f \\<in> funs_term (Fun g T) \\<or>\n   (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "case False"], ["proof (state)\nthis:\n  f \\<noteq> g\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "have \"?P (Fun g T) \\<longleftrightarrow> (\\<exists>s \\<in> set T. ?P s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (\\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. f \\<in> funs_term (\\<Gamma> (Fun g T)) \\<Longrightarrow>\n    \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n 2. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s) \\<Longrightarrow>\n    f \\<in> funs_term (\\<Gamma> (Fun g T))", "assume *: \"?P (Fun g T)\""], ["proof (state)\nthis:\n  f \\<in> funs_term (\\<Gamma> (Fun g T))\n\ngoal (2 subgoals):\n 1. f \\<in> funs_term (\\<Gamma> (Fun g T)) \\<Longrightarrow>\n    \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n 2. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s) \\<Longrightarrow>\n    f \\<in> funs_term (\\<Gamma> (Fun g T))", "hence \"\\<Gamma> (Fun g T) = TComp g (map \\<Gamma> T)\""], ["proof (prove)\nusing this:\n  f \\<in> funs_term (\\<Gamma> (Fun g T))\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)", "using const_type[of g] fun_type[of g]"], ["proof (prove)\nusing this:\n  f \\<in> funs_term (\\<Gamma> (Fun g T))\n  arity g = 0 \\<Longrightarrow>\n  \\<exists>a. \\<forall>T. \\<Gamma> (Fun g T) = Var a\n  0 < arity g \\<Longrightarrow>\n  \\<Gamma> (Fun g ?T) = Fun g (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)", "by force"], ["proof (state)\nthis:\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)\n\ngoal (2 subgoals):\n 1. f \\<in> funs_term (\\<Gamma> (Fun g T)) \\<Longrightarrow>\n    \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n 2. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s) \\<Longrightarrow>\n    f \\<in> funs_term (\\<Gamma> (Fun g T))", "thus \"\\<exists>s \\<in> set T. ?P s\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)", "using False *"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)\n  f \\<noteq> g\n  f \\<in> funs_term (\\<Gamma> (Fun g T))\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)", "by force"], ["proof (state)\nthis:\n  \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s) \\<Longrightarrow>\n    f \\<in> funs_term (\\<Gamma> (Fun g T))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s) \\<Longrightarrow>\n    f \\<in> funs_term (\\<Gamma> (Fun g T))", "assume *: \"\\<exists>s \\<in> set T. ?P s\""], ["proof (state)\nthis:\n  \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s) \\<Longrightarrow>\n    f \\<in> funs_term (\\<Gamma> (Fun g T))", "hence \"\\<Gamma> (Fun g T) = TComp g (map \\<Gamma> T)\""], ["proof (prove)\nusing this:\n  \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)", "using 0 const_type[of g] fun_type[of g]"], ["proof (prove)\nusing this:\n  \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n  arity g = length T\n  arity g = 0 \\<Longrightarrow>\n  \\<exists>a. \\<forall>T. \\<Gamma> (Fun g T) = Var a\n  0 < arity g \\<Longrightarrow>\n  \\<Gamma> (Fun g ?T) = Fun g (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)", "by force"], ["proof (state)\nthis:\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s) \\<Longrightarrow>\n    f \\<in> funs_term (\\<Gamma> (Fun g T))", "thus \"?P (Fun g T)\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> (Fun g T))", "using False *"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> T)\n  f \\<noteq> g\n  \\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s)\n\ngoal (1 subgoal):\n 1. f \\<in> funs_term (\\<Gamma> (Fun g T))", "by force"], ["proof (state)\nthis:\n  f \\<in> funs_term (\\<Gamma> (Fun g T))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n  (\\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s))\n\ngoal (1 subgoal):\n 1. f \\<noteq> g \\<Longrightarrow>\n    (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "thus ?thesis"], ["proof (prove)\nusing this:\n  (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n  (\\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s))\n\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "using False f IH"], ["proof (prove)\nusing this:\n  (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n  (\\<exists>s\\<in>set T. f \\<in> funs_term (\\<Gamma> s))\n  f \\<noteq> g\n  0 < arity f\n  ?s2 \\<in> set T \\<Longrightarrow>\n  (f \\<in> funs_term (\\<Gamma> ?s2)) =\n  (f \\<in> funs_term ?s2 \\<or>\n   (\\<exists>x\\<in>fv ?s2. f \\<in> funs_term (\\<Gamma> (Var x))))\n\ngoal (1 subgoal):\n 1. (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n    (f \\<in> funs_term (Fun g T) \\<or>\n     (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))", "by auto"], ["proof (state)\nthis:\n  (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n  (f \\<in> funs_term (Fun g T) \\<or>\n   (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (f \\<in> funs_term (\\<Gamma> (Fun g T))) =\n  (f \\<in> funs_term (Fun g T) \\<or>\n   (\\<exists>x\\<in>fv (Fun g T). f \\<in> funs_term (\\<Gamma> (Var x))))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m (Var x) \\<Longrightarrow>\n       (f \\<in> funs_term (\\<Gamma> (Var x))) =\n       (f \\<in> funs_term (Var x) \\<or>\n        (\\<exists>x\\<in>fv (Var x). f \\<in> funs_term (\\<Gamma> (Var x))))", "qed simp"], ["", "lemma funs_term_type_iff':\n  assumes M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and f: \"arity f > 0\"\n  shows \"f \\<in> \\<Union>(funs_term ` \\<Gamma> ` M) \\<longleftrightarrow>\n        (f \\<in> \\<Union>(funs_term ` M) \\<or> (\\<exists>x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t M. f \\<in> funs_term (\\<Gamma> (Var x))))\" (is \"?A \\<longleftrightarrow> ?B\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)) =\n    (f \\<in> \\<Union> (funs_term ` M) \\<or>\n     (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n         f \\<in> funs_term (\\<Gamma> (Var x))))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "assume ?A"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)\n\ngoal (2 subgoals):\n 1. f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "then"], ["proof (chain)\npicking this:\n  f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "obtain t where \"t \\<in> M\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"f \\<in> funs_term (\\<Gamma> t)\""], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)\n\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>t \\<in> M; wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n         f \\<in> funs_term (\\<Gamma> t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using M"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\n\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>t \\<in> M; wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n         f \\<in> funs_term (\\<Gamma> t)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t \\<in> M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  f \\<in> funs_term (\\<Gamma> t)\n\ngoal (2 subgoals):\n 1. f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "thus ?B"], ["proof (prove)\nusing this:\n  t \\<in> M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  f \\<in> funs_term (\\<Gamma> t)\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "using funs_term_type_iff[OF _ f, of t]"], ["proof (prove)\nusing this:\n  t \\<in> M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  f \\<in> funs_term (\\<Gamma> t)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n  (f \\<in> funs_term (\\<Gamma> t)) =\n  (f \\<in> funs_term t \\<or>\n   (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x))))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "by auto"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "assume ?B"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "then"], ["proof (chain)\npicking this:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))", "obtain t where \"t \\<in> M\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"f \\<in> funs_term t \\<or> (\\<exists>x \\<in> fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\""], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>t \\<in> M; wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n         f \\<in> funs_term t \\<or>\n         (\\<exists>x\\<in>fv t.\n             f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using M"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\n\ngoal (1 subgoal):\n 1. (\\<And>t.\n        \\<lbrakk>t \\<in> M; wf\\<^sub>t\\<^sub>r\\<^sub>m t;\n         f \\<in> funs_term t \\<or>\n         (\\<exists>x\\<in>fv t.\n             f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  t \\<in> M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n    f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "thus ?A"], ["proof (prove)\nusing this:\n  t \\<in> M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "using funs_term_type_iff[OF _ f, of t]"], ["proof (prove)\nusing this:\n  t \\<in> M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n  (f \\<in> funs_term (\\<Gamma> t)) =\n  (f \\<in> funs_term t \\<or>\n   (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x))))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)", "by blast"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (funs_term ` \\<Gamma> ` M)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Ana_subterm_type:\n  assumes \"Ana t = (K,M)\"\n    and \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"\n    and \"m \\<in> set M\"\n  shows \"\\<Gamma> m \\<sqsubseteq> \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> m \\<sqsubseteq> \\<Gamma> t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Gamma> m \\<sqsubseteq> \\<Gamma> t", "have \"m \\<sqsubseteq> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<sqsubseteq> t", "using Ana_subterm[OF assms(1)] assms(3)"], ["proof (prove)\nusing this:\n  set M \\<subset> subterms t\n  m \\<in> set M\n\ngoal (1 subgoal):\n 1. m \\<sqsubseteq> t", "by auto"], ["proof (state)\nthis:\n  m \\<sqsubseteq> t\n\ngoal (1 subgoal):\n 1. \\<Gamma> m \\<sqsubseteq> \\<Gamma> t", "thus ?thesis"], ["proof (prove)\nusing this:\n  m \\<sqsubseteq> t\n\ngoal (1 subgoal):\n 1. \\<Gamma> m \\<sqsubseteq> \\<Gamma> t", "using subtermeq_imp_subtermtypeeq[OF assms(2)]"], ["proof (prove)\nusing this:\n  m \\<sqsubseteq> t\n  ?s \\<sqsubseteq> t \\<Longrightarrow> \\<Gamma> ?s \\<sqsubseteq> \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<Gamma> m \\<sqsubseteq> \\<Gamma> t", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> m \\<sqsubseteq> \\<Gamma> t\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wf_trm_TAtom_subterms:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> t = TAtom \\<tau>\"\n  shows \"subterms t = {t}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms t = {t}", "using assms const_type_inv"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> t = Var \\<tau>\n  \\<Gamma> (Fun ?c ?X) = Var ?a \\<Longrightarrow> arity ?c = 0\n\ngoal (1 subgoal):\n 1. subterms t = {t}", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  \\<forall>f T. Fun f T \\<sqsubseteq> t \\<longrightarrow> length T = arity f\n  \\<Gamma> t = Var \\<tau>\n  \\<Gamma> (Fun ?c ?X) = Var ?a \\<Longrightarrow> arity ?c = 0\n\ngoal (1 subgoal):\n 1. subterms t = {t}", "by (cases t) force+"], ["", "lemma wf_trm_TComp_subterm:\n  assumes \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"t \\<sqsubset> s\"\n  obtains f T where \"\\<Gamma> s = TComp f T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f T.\n        \\<Gamma> s = Fun f T \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof (cases s)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Var x1\\<rbrakk>\n       \\<Longrightarrow> thesis\n 2. \\<And>x21 x22.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Fun x21 x22\\<rbrakk>\n       \\<Longrightarrow> thesis", "case (Var x)"], ["proof (state)\nthis:\n  s = Var x\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Var x1\\<rbrakk>\n       \\<Longrightarrow> thesis\n 2. \\<And>x21 x22.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Fun x21 x22\\<rbrakk>\n       \\<Longrightarrow> thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  s = Var x\n\ngoal (1 subgoal):\n 1. thesis", "using \\<open>t \\<sqsubset> s\\<close>"], ["proof (prove)\nusing this:\n  s = Var x\n  t \\<sqsubset> s\n\ngoal (1 subgoal):\n 1. thesis", "by simp"], ["proof (state)\nthis:\n  thesis\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Fun x21 x22\\<rbrakk>\n       \\<Longrightarrow> thesis", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Fun x21 x22\\<rbrakk>\n       \\<Longrightarrow> thesis", "case (Fun g S)"], ["proof (state)\nthis:\n  s = Fun g S\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Fun x21 x22\\<rbrakk>\n       \\<Longrightarrow> thesis", "hence \"length S > 0\""], ["proof (prove)\nusing this:\n  s = Fun g S\n\ngoal (1 subgoal):\n 1. 0 < length S", "using assms Fun_subterm_inside_params[of t g S]"], ["proof (prove)\nusing this:\n  s = Fun g S\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  t \\<sqsubset> s\n  (t \\<sqsubset> Fun g S) = (t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set S)\n\ngoal (1 subgoal):\n 1. 0 < length S", "by auto"], ["proof (state)\nthis:\n  0 < length S\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Fun x21 x22\\<rbrakk>\n       \\<Longrightarrow> thesis", "hence \"arity g > 0\""], ["proof (prove)\nusing this:\n  0 < length S\n\ngoal (1 subgoal):\n 1. 0 < arity g", "by (metis \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m s\\<close> \\<open>s = Fun g S\\<close> term.order_refl wf\\<^sub>t\\<^sub>r\\<^sub>m_def)"], ["proof (state)\nthis:\n  0 < arity g\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<lbrakk>\\<And>f T. \\<Gamma> s = Fun f T \\<Longrightarrow> thesis;\n        s = Fun x21 x22\\<rbrakk>\n       \\<Longrightarrow> thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  0 < arity g\n\ngoal (1 subgoal):\n 1. thesis", "using fun_type \\<open>s = Fun g S\\<close> that"], ["proof (prove)\nusing this:\n  0 < arity g\n  0 < arity ?f \\<Longrightarrow>\n  \\<Gamma> (Fun ?f ?T) = Fun ?f (map \\<Gamma> ?T)\n  s = Fun g S\n  \\<Gamma> s = Fun ?f2 ?T2 \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. thesis", "by auto"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_empty[simp]: \"SMP {} = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP {} = {}", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP {} \\<noteq> {} \\<Longrightarrow> False", "assume \"SMP {} \\<noteq> {}\""], ["proof (state)\nthis:\n  SMP {} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. SMP {} \\<noteq> {} \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  SMP {} \\<noteq> {}", "obtain t where \"t \\<in> SMP {}\""], ["proof (prove)\nusing this:\n  SMP {} \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (\\<And>t. t \\<in> SMP {} \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  t \\<in> SMP {}\n\ngoal (1 subgoal):\n 1. SMP {} \\<noteq> {} \\<Longrightarrow> False", "thus False"], ["proof (prove)\nusing this:\n  t \\<in> SMP {}\n\ngoal (1 subgoal):\n 1. False", "by (induct t rule: SMP.induct) auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_I:\n  assumes \"s \\<in> M\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"t \\<sqsubseteq> s \\<cdot> \\<delta>\" \"\\<And>v. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> v)\"\n  shows \"t \\<in> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "using SMP.Substitution[OF SMP.MP[OF assms(1)] assms(2)] SMP.Subterm[of \"s \\<cdot> \\<delta>\" M t] assms(3,4)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range \\<delta>) \\<Longrightarrow>\n  s \\<cdot> \\<delta> \\<in> SMP M\n  \\<lbrakk>s \\<cdot> \\<delta> \\<in> SMP M;\n   t \\<sqsubseteq> s \\<cdot> \\<delta>\\<rbrakk>\n  \\<Longrightarrow> t \\<in> SMP M\n  t \\<sqsubseteq> s \\<cdot> \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> ?v2)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "by (cases \"t = s \\<cdot> \\<delta>\") simp_all"], ["", "lemma SMP_wf_trm:\n  assumes \"t \\<in> SMP M\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n  shows \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using assms(1)"], ["proof (prove)\nusing this:\n  t \\<in> SMP M\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by (induct t rule: SMP.induct)\n   (use assms(2) in blast,\n    use wf_trm_subtermeq in blast,\n    use wf_trm_subst in blast,\n    use Ana_keys_wf' in blast)"], ["", "lemma SMP_ikI[intro]: \"t \\<in> ik\\<^sub>s\\<^sub>t S \\<Longrightarrow> t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> ik\\<^sub>s\\<^sub>t S \\<Longrightarrow>\n    t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)", "by force"], ["", "lemma MP_setI[intro]: \"x \\<in> set S \\<Longrightarrow> trms\\<^sub>s\\<^sub>t\\<^sub>p x \\<subseteq> trms\\<^sub>s\\<^sub>t S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> set S \\<Longrightarrow>\n    trms\\<^sub>s\\<^sub>t\\<^sub>p x \\<subseteq> trms\\<^sub>s\\<^sub>t S", "by force"], ["", "lemma SMP_setI[intro]: \"x \\<in> set S \\<Longrightarrow> trms\\<^sub>s\\<^sub>t\\<^sub>p x \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> set S \\<Longrightarrow>\n    trms\\<^sub>s\\<^sub>t\\<^sub>p x \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S)", "by force"], ["", "lemma SMP_subset_I:\n  assumes M: \"\\<forall>t \\<in> M. \\<exists>s \\<delta>. s \\<in> N \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = s \\<cdot> \\<delta>\"\n  shows \"SMP M \\<subseteq> SMP N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP M \\<subseteq> SMP N", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> SMP M \\<Longrightarrow> x \\<in> SMP N", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> SMP M \\<Longrightarrow> x \\<in> SMP N", "show \"t \\<in> SMP M \\<Longrightarrow> t \\<in> SMP N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP M \\<Longrightarrow> t \\<in> SMP N", "proof (induction t rule: SMP.induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> M \\<Longrightarrow> t \\<in> SMP N\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP N\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N;\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta> \\<in> SMP N\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; Ana t = (K, T);\n        k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP N", "case (MP t)"], ["proof (state)\nthis:\n  t \\<in> M\n\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> M \\<Longrightarrow> t \\<in> SMP N\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP N\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N;\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta> \\<in> SMP N\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; Ana t = (K, T);\n        k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP N", "then"], ["proof (chain)\npicking this:\n  t \\<in> M", "obtain s \\<delta> where s: \"s \\<in> N\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\" \"t = s \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  t \\<in> M\n\ngoal (1 subgoal):\n 1. (\\<And>s \\<delta>.\n        \\<lbrakk>s \\<in> N;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n         t = s \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using M"], ["proof (prove)\nusing this:\n  t \\<in> M\n  \\<forall>t\\<in>M.\n     \\<exists>s \\<delta>.\n        s \\<in> N \\<and>\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n        t = s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>s \\<delta>.\n        \\<lbrakk>s \\<in> N;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n         t = s \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  s \\<in> N\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = s \\<cdot> \\<delta>\n\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> M \\<Longrightarrow> t \\<in> SMP N\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP N\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N;\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta> \\<in> SMP N\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; Ana t = (K, T);\n        k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP N", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "using SMP_I[OF s(1,2), of \"s \\<cdot> \\<delta>\"] s(3,4) wf_trm_subst_range_iff"], ["proof (prove)\nusing this:\n  \\<lbrakk>s \\<cdot> \\<delta> \\<sqsubseteq> s \\<cdot> \\<delta>;\n   \\<And>v. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> v)\\<rbrakk>\n  \\<Longrightarrow> s \\<cdot> \\<delta> \\<in> SMP N\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = s \\<cdot> \\<delta>\n  (\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<theta> x)) =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<theta>)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "by fast"], ["proof (state)\nthis:\n  t \\<in> SMP N\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP N\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N;\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta> \\<in> SMP N\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> SMP N; Ana t = (K, T);\n        k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP N", "qed (auto intro!: SMP.Substitution[of _ N])"], ["proof (state)\nthis:\n  t \\<in> SMP M \\<Longrightarrow> t \\<in> SMP N\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_union: \"SMP (A \\<union> B) = SMP A \\<union> SMP B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (A \\<union> B) = SMP A \\<union> SMP B", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. SMP (A \\<union> B) \\<subseteq> SMP A \\<union> SMP B\n 2. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "show \"SMP (A \\<union> B) \\<subseteq> SMP A \\<union> SMP B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (A \\<union> B) \\<subseteq> SMP A \\<union> SMP B", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (A \\<union> B) \\<Longrightarrow>\n       x \\<in> SMP A \\<union> SMP B", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (A \\<union> B) \\<Longrightarrow>\n       x \\<in> SMP A \\<union> SMP B", "assume \"t \\<in> SMP (A \\<union> B)\""], ["proof (state)\nthis:\n  t \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (A \\<union> B) \\<Longrightarrow>\n       x \\<in> SMP A \\<union> SMP B", "thus \"t \\<in> SMP A \\<union> SMP B\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP A \\<union> SMP B", "by (induct rule: SMP.induct) blast+"], ["proof (state)\nthis:\n  t \\<in> SMP A \\<union> SMP B\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  SMP (A \\<union> B) \\<subseteq> SMP A \\<union> SMP B\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "{"], ["proof (state)\nthis:\n  SMP (A \\<union> B) \\<subseteq> SMP A \\<union> SMP B\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "assume \"t \\<in> SMP A\""], ["proof (state)\nthis:\n  t \\<in> SMP A\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "hence \"t \\<in> SMP (A \\<union> B)\""], ["proof (prove)\nusing this:\n  t \\<in> SMP A\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (A \\<union> B)", "by (induct rule: SMP.induct) blast+"], ["proof (state)\nthis:\n  t \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "}"], ["proof (state)\nthis:\n  ?t4 \\<in> SMP A \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "moreover"], ["proof (state)\nthis:\n  ?t4 \\<in> SMP A \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "{"], ["proof (state)\nthis:\n  ?t4 \\<in> SMP A \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "assume \"t \\<in> SMP B\""], ["proof (state)\nthis:\n  t \\<in> SMP B\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "hence \"t \\<in> SMP (A \\<union> B)\""], ["proof (prove)\nusing this:\n  t \\<in> SMP B\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (A \\<union> B)", "by (induct rule: SMP.induct) blast+"], ["proof (state)\nthis:\n  t \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "}"], ["proof (state)\nthis:\n  ?t4 \\<in> SMP B \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "ultimately"], ["proof (chain)\npicking this:\n  ?t4 \\<in> SMP A \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)\n  ?t4 \\<in> SMP B \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)", "show \"SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)\""], ["proof (prove)\nusing this:\n  ?t4 \\<in> SMP A \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)\n  ?t4 \\<in> SMP B \\<Longrightarrow> ?t4 \\<in> SMP (A \\<union> B)\n\ngoal (1 subgoal):\n 1. SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)", "by blast"], ["proof (state)\nthis:\n  SMP A \\<union> SMP B \\<subseteq> SMP (A \\<union> B)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_append[simp]: \"SMP (trms\\<^sub>s\\<^sub>t (S@S')) = SMP (trms\\<^sub>s\\<^sub>t S) \\<union> SMP (trms\\<^sub>s\\<^sub>t S')\" (is \"?A = ?B\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t (S @ S')) =\n    SMP (trms\\<^sub>s\\<^sub>t S) \\<union> SMP (trms\\<^sub>s\\<^sub>t S')", "using SMP_union"], ["proof (prove)\nusing this:\n  SMP (?A \\<union> ?B) = SMP ?A \\<union> SMP ?B\n\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t (S @ S')) =\n    SMP (trms\\<^sub>s\\<^sub>t S) \\<union> SMP (trms\\<^sub>s\\<^sub>t S')", "by simp"], ["", "lemma SMP_mono: \"A \\<subseteq> B \\<Longrightarrow> SMP A \\<subseteq> SMP B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> SMP A \\<subseteq> SMP B", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> SMP A \\<subseteq> SMP B", "assume \"A \\<subseteq> B\""], ["proof (state)\nthis:\n  A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> SMP A \\<subseteq> SMP B", "then"], ["proof (chain)\npicking this:\n  A \\<subseteq> B", "obtain C where \"B = A \\<union> C\""], ["proof (prove)\nusing this:\n  A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. (\\<And>C. B = A \\<union> C \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  B = A \\<union> C\n\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> SMP A \\<subseteq> SMP B", "thus \"SMP A \\<subseteq> SMP B\""], ["proof (prove)\nusing this:\n  B = A \\<union> C\n\ngoal (1 subgoal):\n 1. SMP A \\<subseteq> SMP B", "by (simp add: SMP_union)"], ["proof (state)\nthis:\n  SMP A \\<subseteq> SMP B\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_Union: \"SMP (\\<Union>m \\<in> M. f m) = (\\<Union>m \\<in> M. SMP (f m))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (\\<Union> (f ` M)) = (\\<Union>m\\<in>M. SMP (f m))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. SMP (\\<Union> (f ` M)) \\<subseteq> (\\<Union>m\\<in>M. SMP (f m))\n 2. (\\<Union>m\\<in>M. SMP (f m)) \\<subseteq> SMP (\\<Union> (f ` M))", "show \"SMP (\\<Union>m\\<in>M. f m) \\<subseteq> (\\<Union>m\\<in>M. SMP (f m))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (\\<Union> (f ` M)) \\<subseteq> (\\<Union>m\\<in>M. SMP (f m))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (\\<Union> (f ` M)) \\<Longrightarrow>\n       x \\<in> (\\<Union>m\\<in>M. SMP (f m))", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (\\<Union> (f ` M)) \\<Longrightarrow>\n       x \\<in> (\\<Union>m\\<in>M. SMP (f m))", "assume \"t \\<in> SMP (\\<Union>m\\<in>M. f m)\""], ["proof (state)\nthis:\n  t \\<in> SMP (\\<Union> (f ` M))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (\\<Union> (f ` M)) \\<Longrightarrow>\n       x \\<in> (\\<Union>m\\<in>M. SMP (f m))", "thus \"t \\<in> (\\<Union>m\\<in>M. SMP (f m))\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (\\<Union> (f ` M))\n\ngoal (1 subgoal):\n 1. t \\<in> (\\<Union>m\\<in>M. SMP (f m))", "by (induct t rule: SMP.induct) force+"], ["proof (state)\nthis:\n  t \\<in> (\\<Union>m\\<in>M. SMP (f m))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  SMP (\\<Union> (f ` M)) \\<subseteq> (\\<Union>m\\<in>M. SMP (f m))\n\ngoal (1 subgoal):\n 1. (\\<Union>m\\<in>M. SMP (f m)) \\<subseteq> SMP (\\<Union> (f ` M))", "show \"(\\<Union>m\\<in>M. SMP (f m)) \\<subseteq> SMP (\\<Union>m\\<in>M. f m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>m\\<in>M. SMP (f m)) \\<subseteq> SMP (\\<Union> (f ` M))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (\\<Union>m\\<in>M. SMP (f m)) \\<Longrightarrow>\n       x \\<in> SMP (\\<Union> (f ` M))", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (\\<Union>m\\<in>M. SMP (f m)) \\<Longrightarrow>\n       x \\<in> SMP (\\<Union> (f ` M))", "assume \"t \\<in> (\\<Union>m\\<in>M. SMP (f m))\""], ["proof (state)\nthis:\n  t \\<in> (\\<Union>m\\<in>M. SMP (f m))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (\\<Union>m\\<in>M. SMP (f m)) \\<Longrightarrow>\n       x \\<in> SMP (\\<Union> (f ` M))", "then"], ["proof (chain)\npicking this:\n  t \\<in> (\\<Union>m\\<in>M. SMP (f m))", "obtain m where \"m \\<in> M\" \"t \\<in> SMP (f m)\""], ["proof (prove)\nusing this:\n  t \\<in> (\\<Union>m\\<in>M. SMP (f m))\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> M; t \\<in> SMP (f m)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  m \\<in> M\n  t \\<in> SMP (f m)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> (\\<Union>m\\<in>M. SMP (f m)) \\<Longrightarrow>\n       x \\<in> SMP (\\<Union> (f ` M))", "thus \"t \\<in> SMP (\\<Union>m\\<in>M. f m)\""], ["proof (prove)\nusing this:\n  m \\<in> M\n  t \\<in> SMP (f m)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (\\<Union> (f ` M))", "using SMP_mono[of \"f m\" \"\\<Union>m\\<in>M. f m\"]"], ["proof (prove)\nusing this:\n  m \\<in> M\n  t \\<in> SMP (f m)\n  f m \\<subseteq> \\<Union> (f ` M) \\<Longrightarrow>\n  SMP (f m) \\<subseteq> SMP (\\<Union> (f ` M))\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (\\<Union> (f ` M))", "by auto"], ["proof (state)\nthis:\n  t \\<in> SMP (\\<Union> (f ` M))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Union>m\\<in>M. SMP (f m)) \\<subseteq> SMP (\\<Union> (f ` M))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_singleton_ex:\n  \"t \\<in> SMP M \\<Longrightarrow> (\\<exists>m \\<in> M. t \\<in> SMP {m})\"\n  \"m \\<in> M \\<Longrightarrow> t \\<in> SMP {m} \\<Longrightarrow> t \\<in> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (t \\<in> SMP M \\<Longrightarrow> \\<exists>m\\<in>M. t \\<in> SMP {m}) &&&\n    (\\<lbrakk>m \\<in> M; t \\<in> SMP {m}\\<rbrakk>\n     \\<Longrightarrow> t \\<in> SMP M)", "using SMP_Union[of \"\\<lambda>t. {t}\" M]"], ["proof (prove)\nusing this:\n  SMP (\\<Union>m\\<in>M. {m}) = (\\<Union>m\\<in>M. SMP {m})\n\ngoal (1 subgoal):\n 1. (t \\<in> SMP M \\<Longrightarrow> \\<exists>m\\<in>M. t \\<in> SMP {m}) &&&\n    (\\<lbrakk>m \\<in> M; t \\<in> SMP {m}\\<rbrakk>\n     \\<Longrightarrow> t \\<in> SMP M)", "by auto"], ["", "lemma SMP_Cons: \"SMP (trms\\<^sub>s\\<^sub>t (x#S)) = SMP (trms\\<^sub>s\\<^sub>t [x]) \\<union> SMP (trms\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t (x # S)) =\n    SMP (trms\\<^sub>s\\<^sub>t [x]) \\<union> SMP (trms\\<^sub>s\\<^sub>t S)", "using SMP_append[of \"[x]\" S]"], ["proof (prove)\nusing this:\n  SMP (trms\\<^sub>s\\<^sub>t ([x] @ S)) =\n  SMP (trms\\<^sub>s\\<^sub>t [x]) \\<union> SMP (trms\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t (x # S)) =\n    SMP (trms\\<^sub>s\\<^sub>t [x]) \\<union> SMP (trms\\<^sub>s\\<^sub>t S)", "by auto"], ["", "lemma SMP_Nil[simp]: \"SMP (trms\\<^sub>s\\<^sub>t []) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "assume \"t \\<in> SMP (trms\\<^sub>s\\<^sub>t [])\""], ["proof (state)\nthis:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t [])\n\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "hence False"], ["proof (prove)\nusing this:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t [])\n\ngoal (1 subgoal):\n 1. False", "by induct auto"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "}"], ["proof (state)\nthis:\n  ?t4 \\<in> SMP (trms\\<^sub>s\\<^sub>t []) \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "thus ?thesis"], ["proof (prove)\nusing this:\n  ?t4 \\<in> SMP (trms\\<^sub>s\\<^sub>t []) \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t []) = {}", "by blast"], ["proof (state)\nthis:\n  SMP (trms\\<^sub>s\\<^sub>t []) = {}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_subset_union_eq: assumes \"M \\<subseteq> SMP N\" shows \"SMP N = SMP (M \\<union> N)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "assume \"t \\<in> SMP (M \\<union> N)\""], ["proof (state)\nthis:\n  t \\<in> SMP (M \\<union> N)\n\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "hence \"t \\<in> SMP N\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (M \\<union> N)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "using assms"], ["proof (prove)\nusing this:\n  t \\<in> SMP (M \\<union> N)\n  M \\<subseteq> SMP N\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "by (induction rule: SMP.induct) blast+"], ["proof (state)\nthis:\n  t \\<in> SMP N\n\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "}"], ["proof (state)\nthis:\n  ?t4 \\<in> SMP (M \\<union> N) \\<Longrightarrow> ?t4 \\<in> SMP N\n\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "thus ?thesis"], ["proof (prove)\nusing this:\n  ?t4 \\<in> SMP (M \\<union> N) \\<Longrightarrow> ?t4 \\<in> SMP N\n\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "using SMP_union"], ["proof (prove)\nusing this:\n  ?t4 \\<in> SMP (M \\<union> N) \\<Longrightarrow> ?t4 \\<in> SMP N\n  SMP (?A \\<union> ?B) = SMP ?A \\<union> SMP ?B\n\ngoal (1 subgoal):\n 1. SMP N = SMP (M \\<union> N)", "by auto"], ["proof (state)\nthis:\n  SMP N = SMP (M \\<union> N)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_subterms_subset: \"subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<subseteq> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<subseteq> SMP M", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t M \\<Longrightarrow>\n       x \\<in> SMP M", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t M \\<Longrightarrow>\n       x \\<in> SMP M", "assume \"t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t M\""], ["proof (state)\nthis:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t M\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t M \\<Longrightarrow>\n       x \\<in> SMP M", "then"], ["proof (chain)\npicking this:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t M", "obtain m where \"m \\<in> M\" \"t \\<sqsubseteq> m\""], ["proof (prove)\nusing this:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t M\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> M; t \\<sqsubseteq> m\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  m \\<in> M\n  t \\<sqsubseteq> m\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t M \\<Longrightarrow>\n       x \\<in> SMP M", "thus \"t \\<in> SMP M\""], ["proof (prove)\nusing this:\n  m \\<in> M\n  t \\<sqsubseteq> m\n\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "using SMP_I[of _ _ Var]"], ["proof (prove)\nusing this:\n  m \\<in> M\n  t \\<sqsubseteq> m\n  \\<lbrakk>?s \\<in> ?M; wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var;\n   ?t \\<sqsubseteq> ?s \\<cdot> Var;\n   \\<And>v. wf\\<^sub>t\\<^sub>r\\<^sub>m (Var v)\\<rbrakk>\n  \\<Longrightarrow> ?t \\<in> SMP ?M\n\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "by auto"], ["proof (state)\nthis:\n  t \\<in> SMP M\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_SMP_subset: \"N \\<subseteq> SMP M \\<Longrightarrow> SMP N \\<subseteq> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. N \\<subseteq> SMP M \\<Longrightarrow> SMP N \\<subseteq> SMP M", "by (metis SMP_mono SMP_subset_union_eq Un_commute Un_upper2)"], ["", "lemma wt_subst_rm_vars: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<Longrightarrow> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (rm_vars X \\<delta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<Longrightarrow>\n    wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (rm_vars X \\<delta>)", "using rm_vars_dom"], ["proof (prove)\nusing this:\n  subst_domain (rm_vars ?V ?s) = subst_domain ?s - ?V\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<Longrightarrow>\n    wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (rm_vars X \\<delta>)", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  subst_domain (rm_vars ?V ?s) = subst_domain ?s - ?V\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<delta> v) \\<Longrightarrow>\n    \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (rm_vars X \\<delta> v)", "by auto"], ["", "lemma wt_subst_SMP_subset:\n  assumes \"trms\\<^sub>s\\<^sub>t S \\<subseteq> SMP S'\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n  shows \"trms\\<^sub>s\\<^sub>t (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>) \\<subseteq> SMP S'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. trms\\<^sub>s\\<^sub>t (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>)\n    \\<subseteq> SMP S'", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> trms\\<^sub>s\\<^sub>t\n                (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>) \\<Longrightarrow>\n       x \\<in> SMP S'", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> trms\\<^sub>s\\<^sub>t\n                (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>) \\<Longrightarrow>\n       x \\<in> SMP S'", "assume *: \"t \\<in> trms\\<^sub>s\\<^sub>t (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>)\""], ["proof (state)\nthis:\n  t \\<in> trms\\<^sub>s\\<^sub>t (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> trms\\<^sub>s\\<^sub>t\n                (S \\<cdot>\\<^sub>s\\<^sub>t \\<delta>) \\<Longrightarrow>\n       x \\<in> SMP S'", "show \"t \\<in> SMP S'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP S'", "using trm_strand_subst_cong(2)[OF *]"], ["proof (prove)\nusing this:\n  (\\<exists>t'.\n      t = t' \\<cdot> \\<delta> \\<and> t' \\<in> trms\\<^sub>s\\<^sub>t S) \\<or>\n  (\\<exists>X F.\n      \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n      \\<in> set S \\<and>\n      (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n          t = t' \\<cdot> rm_vars (set X) \\<delta>))\n\ngoal (1 subgoal):\n 1. t \\<in> SMP S'", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>t'.\n       t = t' \\<cdot> \\<delta> \\<and>\n       t' \\<in> trms\\<^sub>s\\<^sub>t S \\<Longrightarrow>\n    t \\<in> SMP S'\n 2. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "assume \"\\<exists>t'. t = t' \\<cdot> \\<delta> \\<and> t' \\<in> trms\\<^sub>s\\<^sub>t S\""], ["proof (state)\nthis:\n  \\<exists>t'.\n     t = t' \\<cdot> \\<delta> \\<and> t' \\<in> trms\\<^sub>s\\<^sub>t S\n\ngoal (2 subgoals):\n 1. \\<exists>t'.\n       t = t' \\<cdot> \\<delta> \\<and>\n       t' \\<in> trms\\<^sub>s\\<^sub>t S \\<Longrightarrow>\n    t \\<in> SMP S'\n 2. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "thus \"t \\<in> SMP S'\""], ["proof (prove)\nusing this:\n  \\<exists>t'.\n     t = t' \\<cdot> \\<delta> \\<and> t' \\<in> trms\\<^sub>s\\<^sub>t S\n\ngoal (1 subgoal):\n 1. t \\<in> SMP S'", "using assms SMP.Substitution"], ["proof (prove)\nusing this:\n  \\<exists>t'.\n     t = t' \\<cdot> \\<delta> \\<and> t' \\<in> trms\\<^sub>s\\<^sub>t S\n  trms\\<^sub>s\\<^sub>t S \\<subseteq> SMP S'\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  \\<lbrakk>?t \\<in> SMP ?M;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<delta>)\\<rbrakk>\n  \\<Longrightarrow> ?t \\<cdot> ?\\<delta> \\<in> SMP ?M\n\ngoal (1 subgoal):\n 1. t \\<in> SMP S'", "by auto"], ["proof (state)\nthis:\n  t \\<in> SMP S'\n\ngoal (1 subgoal):\n 1. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "assume \"\\<exists>X F. Inequality X F \\<in> set S \\<and> (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F. t = t' \\<cdot> rm_vars (set X) \\<delta>)\""], ["proof (state)\nthis:\n  \\<exists>X F.\n     \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n     \\<in> set S \\<and>\n     (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n         t = t' \\<cdot> rm_vars (set X) \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "then"], ["proof (chain)\npicking this:\n  \\<exists>X F.\n     \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n     \\<in> set S \\<and>\n     (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n         t = t' \\<cdot> rm_vars (set X) \\<delta>)", "obtain X F t' where **:\n        \"Inequality X F \\<in> set S\" \"t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F\" \"t = t' \\<cdot> rm_vars (set X) \\<delta>\""], ["proof (prove)\nusing this:\n  \\<exists>X F.\n     \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n     \\<in> set S \\<and>\n     (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n         t = t' \\<cdot> rm_vars (set X) \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>X F t'.\n        \\<lbrakk>\\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n                 \\<in> set S;\n         t' \\<in> trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F;\n         t = t' \\<cdot> rm_vars (set X) \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S\n  t' \\<in> trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F\n  t = t' \\<cdot> rm_vars (set X) \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "then"], ["proof (chain)\npicking this:\n  \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S\n  t' \\<in> trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F\n  t = t' \\<cdot> rm_vars (set X) \\<delta>", "obtain s where s: \"s \\<in> trms\\<^sub>s\\<^sub>t\\<^sub>p (Inequality X F)\" \"t = s \\<cdot> rm_vars (set X) \\<delta>\""], ["proof (prove)\nusing this:\n  \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S\n  t' \\<in> trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F\n  t = t' \\<cdot> rm_vars (set X) \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> trms\\<^sub>s\\<^sub>t\\<^sub>p\n                          \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t;\n         t = s \\<cdot> rm_vars (set X) \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  s \\<in> trms\\<^sub>s\\<^sub>t\\<^sub>p\n           \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  t = s \\<cdot> rm_vars (set X) \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "hence \"s \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\nusing this:\n  s \\<in> trms\\<^sub>s\\<^sub>t\\<^sub>p\n           \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  t = s \\<cdot> rm_vars (set X) \\<delta>\n\ngoal (1 subgoal):\n 1. s \\<in> SMP (trms\\<^sub>s\\<^sub>t S)", "using **(1)"], ["proof (prove)\nusing this:\n  s \\<in> trms\\<^sub>s\\<^sub>t\\<^sub>p\n           \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  t = s \\<cdot> rm_vars (set X) \\<delta>\n  \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t \\<in> set S\n\ngoal (1 subgoal):\n 1. s \\<in> SMP (trms\\<^sub>s\\<^sub>t S)", "by force"], ["proof (state)\nthis:\n  s \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "hence \"t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\nusing this:\n  s \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)", "using SMP.Substitution[OF _ wt_subst_rm_vars[OF assms(2)] wf_trms_subst_rm_vars'[OF assms(3)]]"], ["proof (prove)\nusing this:\n  s \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\n  ?t \\<in> SMP ?M \\<Longrightarrow>\n  ?t \\<cdot> rm_vars ?X1 \\<delta> \\<in> SMP ?M\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)", "unfolding s(2)"], ["proof (prove)\nusing this:\n  s \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\n  ?t \\<in> SMP ?M \\<Longrightarrow>\n  ?t \\<cdot> rm_vars ?X1 \\<delta> \\<in> SMP ?M\n\ngoal (1 subgoal):\n 1. s \\<cdot> rm_vars (set X) \\<delta> \\<in> SMP (trms\\<^sub>s\\<^sub>t S)", "by blast"], ["proof (state)\nthis:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. \\<exists>X F.\n       \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n       \\<in> set S \\<and>\n       (\\<exists>t'\\<in>trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F.\n           t = t' \\<cdot> rm_vars (set X) \\<delta>) \\<Longrightarrow>\n    t \\<in> SMP S'", "thus \"t \\<in> SMP S'\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP S'", "by (metis SMP_union SMP_subset_union_eq UnCI assms(1))"], ["proof (state)\nthis:\n  t \\<in> SMP S'\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  t \\<in> SMP S'\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma MP_subset_SMP: \"\\<Union>(trms\\<^sub>s\\<^sub>t\\<^sub>p ` set S) \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S)\" \"trms\\<^sub>s\\<^sub>t S \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S)\" \"M \\<subseteq> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> (trms\\<^sub>s\\<^sub>t\\<^sub>p ` set S)\n    \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S) &&&\n    trms\\<^sub>s\\<^sub>t S \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t S) &&&\n    M \\<subseteq> SMP M", "by auto"], ["", "lemma SMP_fun_map_snd_subset: \"SMP (trms\\<^sub>s\\<^sub>t (map Send X)) \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t [Send (Fun f X)])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (trms\\<^sub>s\\<^sub>t (map Send X))\n    \\<subseteq> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X)) \\<Longrightarrow>\n       x \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                     [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X)) \\<Longrightarrow>\n       x \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                     [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "assume \"t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X))\""], ["proof (state)\nthis:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X)) \\<Longrightarrow>\n       x \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                     [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "thus \"t \\<in> SMP (trms\\<^sub>s\\<^sub>t [Send (Fun f X)])\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X))\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "proof (induction t rule: SMP.induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>t.\n       t \\<in> trms\\<^sub>s\\<^sub>t (map Send X) \\<Longrightarrow>\n       t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                     [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP (trms\\<^sub>s\\<^sub>t\n  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta>\n                         \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                                     [send\\<langle>Fun f\n              X\\<rangle>\\<^sub>s\\<^sub>t])\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP (trms\\<^sub>s\\<^sub>t\n [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "case (MP t)"], ["proof (state)\nthis:\n  t \\<in> trms\\<^sub>s\\<^sub>t (map Send X)\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       t \\<in> trms\\<^sub>s\\<^sub>t (map Send X) \\<Longrightarrow>\n       t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                     [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP (trms\\<^sub>s\\<^sub>t\n  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta>\n                         \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                                     [send\\<langle>Fun f\n              X\\<rangle>\\<^sub>s\\<^sub>t])\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP (trms\\<^sub>s\\<^sub>t\n [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "hence \"t \\<in> set X\""], ["proof (prove)\nusing this:\n  t \\<in> trms\\<^sub>s\\<^sub>t (map Send X)\n\ngoal (1 subgoal):\n 1. t \\<in> set X", "by auto"], ["proof (state)\nthis:\n  t \\<in> set X\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       t \\<in> trms\\<^sub>s\\<^sub>t (map Send X) \\<Longrightarrow>\n       t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                     [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP (trms\\<^sub>s\\<^sub>t\n  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta>\n                         \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                                     [send\\<langle>Fun f\n              X\\<rangle>\\<^sub>s\\<^sub>t])\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP (trms\\<^sub>s\\<^sub>t\n [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "hence \"t \\<sqsubset> Fun f X\""], ["proof (prove)\nusing this:\n  t \\<in> set X\n\ngoal (1 subgoal):\n 1. t \\<sqsubset> Fun f X", "by (metis subtermI')"], ["proof (state)\nthis:\n  t \\<sqsubset> Fun f X\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       t \\<in> trms\\<^sub>s\\<^sub>t (map Send X) \\<Longrightarrow>\n       t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                     [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP (trms\\<^sub>s\\<^sub>t\n  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta>\n                         \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                                     [send\\<langle>Fun f\n              X\\<rangle>\\<^sub>s\\<^sub>t])\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP (trms\\<^sub>s\\<^sub>t\n [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "thus ?case"], ["proof (prove)\nusing this:\n  t \\<sqsubset> Fun f X\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "using SMP.Subterm[of \"Fun f X\" \"trms\\<^sub>s\\<^sub>t [Send (Fun f X)]\" t]"], ["proof (prove)\nusing this:\n  t \\<sqsubset> Fun f X\n  \\<lbrakk>Fun f X\n           \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                       [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n   t \\<sqsubseteq> Fun f X\\<rbrakk>\n  \\<Longrightarrow> t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                                  [send\\<langle>Fun f\n           X\\<rangle>\\<^sub>s\\<^sub>t])\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "using SMP.MP"], ["proof (prove)\nusing this:\n  t \\<sqsubset> Fun f X\n  \\<lbrakk>Fun f X\n           \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                       [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n   t \\<sqsubseteq> Fun f X\\<rbrakk>\n  \\<Longrightarrow> t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                                  [send\\<langle>Fun f\n           X\\<rangle>\\<^sub>s\\<^sub>t])\n  ?t \\<in> ?M \\<Longrightarrow> ?t \\<in> SMP ?M\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "by auto"], ["proof (state)\nthis:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> SMP (trms\\<^sub>s\\<^sub>t\n  [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta>\n                         \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                                     [send\\<langle>Fun f\n              X\\<rangle>\\<^sub>s\\<^sub>t])\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (trms\\<^sub>s\\<^sub>t (map Send X));\n        t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                      [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t]);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> SMP (trms\\<^sub>s\\<^sub>t\n [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])", "qed blast+"], ["proof (state)\nthis:\n  t \\<in> SMP (trms\\<^sub>s\\<^sub>t\n                [send\\<langle>Fun f X\\<rangle>\\<^sub>s\\<^sub>t])\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_wt_subst_subset:\n  assumes \"t \\<in> SMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>)\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\"\n  shows \"t \\<in> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "using assms wf_trm_subst_range_iff[of \\<I>]"], ["proof (prove)\nusing this:\n  t \\<in> SMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\n  (\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<I> x)) =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "by (induct t rule: SMP.induct) blast+"], ["", "lemma SMP_wt_instances_subset:\n  assumes \"\\<forall>t \\<in> M. \\<exists>s \\<in> N. \\<exists>\\<delta>. t = s \\<cdot> \\<delta> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n    and \"t \\<in> SMP M\"\n  shows \"t \\<in> SMP N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "obtain m where m: \"m \\<in> M\" \"t \\<in> SMP {m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> M; t \\<in> SMP {m}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using SMP_singleton_ex(1)[OF assms(2)]"], ["proof (prove)\nusing this:\n  \\<exists>m\\<in>M. t \\<in> SMP {m}\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> M; t \\<in> SMP {m}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  m \\<in> M\n  t \\<in> SMP {m}\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "then"], ["proof (chain)\npicking this:\n  m \\<in> M\n  t \\<in> SMP {m}", "obtain n \\<delta> where n: \"n \\<in> N\" \"m = n \\<cdot> \\<delta>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\""], ["proof (prove)\nusing this:\n  m \\<in> M\n  t \\<in> SMP {m}\n\ngoal (1 subgoal):\n 1. (\\<And>n \\<delta>.\n        \\<lbrakk>n \\<in> N; m = n \\<cdot> \\<delta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(1)"], ["proof (prove)\nusing this:\n  m \\<in> M\n  t \\<in> SMP {m}\n  \\<forall>t\\<in>M.\n     \\<exists>s\\<in>N.\n        \\<exists>\\<delta>.\n           t = s \\<cdot> \\<delta> \\<and>\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>n \\<delta>.\n        \\<lbrakk>n \\<in> N; m = n \\<cdot> \\<delta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fast"], ["proof (state)\nthis:\n  n \\<in> N\n  m = n \\<cdot> \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "have \"t \\<in> SMP (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>)", "using n(1,2) SMP_singleton_ex(2)[of m \"N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\", OF _ m(2)]"], ["proof (prove)\nusing this:\n  n \\<in> N\n  m = n \\<cdot> \\<delta>\n  m \\<in> N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta> \\<Longrightarrow>\n  t \\<in> SMP (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>)", "by fast"], ["proof (state)\nthis:\n  t \\<in> SMP (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "thus ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> SMP (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "using SMP_wt_subst_subset[OF _ n(3,4)]"], ["proof (prove)\nusing this:\n  t \\<in> SMP (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>)\n  ?t \\<in> SMP (?M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                \\<delta>) \\<Longrightarrow>\n  ?t \\<in> SMP ?M\n\ngoal (1 subgoal):\n 1. t \\<in> SMP N", "by blast"], ["proof (state)\nthis:\n  t \\<in> SMP N\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_consts:\n  assumes \"\\<forall>t \\<in> M. \\<exists>c. t = Fun c []\"\n    and \"\\<forall>t \\<in> M. Ana t = ([], [])\"\n  shows \"SMP M = M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP M = M", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. SMP M \\<subseteq> M\n 2. M \\<subseteq> SMP M", "show \"SMP M \\<subseteq> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP M \\<subseteq> M", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> SMP M \\<Longrightarrow> x \\<in> M", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> SMP M \\<Longrightarrow> x \\<in> M", "show \"t \\<in> SMP M \\<Longrightarrow> t \\<in> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP M \\<Longrightarrow> t \\<in> M", "apply (induction t rule: SMP.induct)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>t. t \\<in> M \\<Longrightarrow> t \\<in> M\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> M; t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> t' \\<in> M\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> M;\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> t \\<cdot> \\<delta> \\<in> M\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M; t \\<in> M; Ana t = (K, T);\n        k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> k \\<in> M", "by (use assms in auto)"], ["proof (state)\nthis:\n  t \\<in> SMP M \\<Longrightarrow> t \\<in> M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  SMP M \\<subseteq> M\n\ngoal (1 subgoal):\n 1. M \\<subseteq> SMP M", "qed auto"], ["", "lemma SMP_subterms_eq:\n  \"SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) = SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) = SMP M", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<subseteq> SMP M\n 2. SMP M \\<subseteq> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M)", "show \"SMP M \\<subseteq> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP M \\<subseteq> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M)", "using SMP_mono[of M \"subterms\\<^sub>s\\<^sub>e\\<^sub>t M\"]"], ["proof (prove)\nusing this:\n  M \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t M \\<Longrightarrow>\n  SMP M \\<subseteq> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M)\n\ngoal (1 subgoal):\n 1. SMP M \\<subseteq> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M)", "by blast"], ["proof (state)\nthis:\n  SMP M \\<subseteq> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M)\n\ngoal (1 subgoal):\n 1. SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<subseteq> SMP M", "show \"SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<subseteq> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<subseteq> SMP M", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<Longrightarrow>\n       x \\<in> SMP M", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<Longrightarrow>\n       x \\<in> SMP M", "show \"t \\<in> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<Longrightarrow> t \\<in> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<Longrightarrow>\n    t \\<in> SMP M", "by (induction t rule: SMP.induct) blast+"], ["proof (state)\nthis:\n  t \\<in> SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<Longrightarrow>\n  t \\<in> SMP M\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  SMP (subterms\\<^sub>s\\<^sub>e\\<^sub>t M) \\<subseteq> SMP M\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_funs_term:\n  assumes t: \"t \\<in> SMP M\" \"f \\<in> funs_term t \\<or> (\\<exists>x \\<in> fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\"\n    and f: \"arity f > 0\"\n    and M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and Ana_f: \"\\<And>s K T. Ana s = (K,T) \\<Longrightarrow> f \\<in> \\<Union>(funs_term ` set K) \\<Longrightarrow> f \\<in> funs_term s\"\n  shows \"f \\<in> \\<Union>(funs_term ` M) \\<or> (\\<exists>x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t M. f \\<in> funs_term (\\<Gamma> (Var x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "using t"], ["proof (prove)\nusing this:\n  t \\<in> SMP M\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "proof (induction t rule: SMP.induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        t' \\<sqsubseteq> t;\n        f \\<in> funs_term t' \\<or>\n        (\\<exists>x\\<in>fv t'.\n            f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        f \\<in> funs_term (t \\<cdot> \\<delta>) \\<or>\n        (\\<exists>x\\<in>fv (t \\<cdot> \\<delta>).\n            f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "case (Subterm t t')"], ["proof (state)\nthis:\n  t \\<in> SMP M\n  t' \\<sqsubseteq> t\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t.\n      f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> funs_term t' \\<or>\n  (\\<exists>x\\<in>fv t'. f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        t' \\<sqsubseteq> t;\n        f \\<in> funs_term t' \\<or>\n        (\\<exists>x\\<in>fv t'.\n            f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        f \\<in> funs_term (t \\<cdot> \\<delta>) \\<or>\n        (\\<exists>x\\<in>fv (t \\<cdot> \\<delta>).\n            f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "thus ?case"], ["proof (prove)\nusing this:\n  t \\<in> SMP M\n  t' \\<sqsubseteq> t\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t.\n      f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> funs_term t' \\<or>\n  (\\<exists>x\\<in>fv t'. f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "by (metis UN_I vars_iff_subtermeq funs_term_subterms_eq(1) term.order_trans)"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (3 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        f \\<in> funs_term (t \\<cdot> \\<delta>) \\<or>\n        (\\<exists>x\\<in>fv (t \\<cdot> \\<delta>).\n            f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        f \\<in> funs_term (t \\<cdot> \\<delta>) \\<or>\n        (\\<exists>x\\<in>fv (t \\<cdot> \\<delta>).\n            f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "case (Substitution t \\<delta>)"], ["proof (state)\nthis:\n  t \\<in> SMP M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t.\n      f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> funs_term (t \\<cdot> \\<delta>) \\<or>\n  (\\<exists>x\\<in>fv (t \\<cdot> \\<delta>).\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (3 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        f \\<in> funs_term (t \\<cdot> \\<delta>) \\<or>\n        (\\<exists>x\\<in>fv (t \\<cdot> \\<delta>).\n            f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "using M SMP_wf_trm[OF Substitution.hyps(1)] wf_trm_subst[of \\<delta> t, OF Substitution.hyps(3)]\n          funs_term_type_iff[OF _ f] wt_subst_trm''[OF Substitution.hyps(2), of t]\n          Substitution.prems Substitution.IH"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (t \\<cdot> \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t \\<Longrightarrow>\n  (f \\<in> funs_term (\\<Gamma> ?t)) =\n  (f \\<in> funs_term ?t \\<or>\n   (\\<exists>x\\<in>fv ?t. f \\<in> funs_term (\\<Gamma> (Var x))))\n  \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<delta>)\n  f \\<in> funs_term (t \\<cdot> \\<delta>) \\<or>\n  (\\<exists>x\\<in>fv (t \\<cdot> \\<delta>).\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t.\n      f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "by metis"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "case (Ana t K T t')"], ["proof (state)\nthis:\n  t \\<in> SMP M\n  Ana t = (K, T)\n  t' \\<in> set K\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t.\n      f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> funs_term t' \\<or>\n  (\\<exists>x\\<in>fv t'. f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (2 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t.\n            f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n        f \\<in> \\<Union> (funs_term ` M) \\<or>\n        (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n            f \\<in> funs_term (\\<Gamma> (Var x)));\n        Ana t = (K, T); k \\<in> set K;\n        f \\<in> funs_term k \\<or>\n        (\\<exists>x\\<in>fv k. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "thus ?case"], ["proof (prove)\nusing this:\n  t \\<in> SMP M\n  Ana t = (K, T)\n  t' \\<in> set K\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t.\n      f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> funs_term t' \\<or>\n  (\\<exists>x\\<in>fv t'. f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "using Ana_f[OF Ana.hyps(2)] Ana_keys_fv[OF Ana.hyps(2)]"], ["proof (prove)\nusing this:\n  t \\<in> SMP M\n  Ana t = (K, T)\n  t' \\<in> set K\n  f \\<in> funs_term t \\<or>\n  (\\<exists>x\\<in>fv t.\n      f \\<in> funs_term (\\<Gamma> (Var x))) \\<Longrightarrow>\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> funs_term t' \\<or>\n  (\\<exists>x\\<in>fv t'. f \\<in> funs_term (\\<Gamma> (Var x)))\n  f \\<in> \\<Union> (funs_term ` set K) \\<Longrightarrow> f \\<in> funs_term t\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set K) \\<subseteq> fv t\n\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (funs_term ` M) \\<or>\n    (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n        f \\<in> funs_term (\\<Gamma> (Var x)))", "by fastforce"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (funs_term ` M) \\<or>\n  (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n      f \\<in> funs_term (\\<Gamma> (Var x)))\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> M;\n        f \\<in> funs_term t \\<or>\n        (\\<exists>x\\<in>fv t. f \\<in> funs_term (\\<Gamma> (Var x)))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> \\<Union> (funs_term ` M) \\<or>\n                         (\\<exists>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t M.\n                             f \\<in> funs_term (\\<Gamma> (Var x)))", "qed auto"], ["", "lemma id_type_eq:\n  assumes \"\\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\"\n  shows \"f \\<in> \\<C> \\<Longrightarrow> g \\<in> \\<C>\" \"f \\<in> \\<Sigma>\\<^sub>f \\<Longrightarrow> g \\<in> \\<Sigma>\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (f \\<in> \\<C> \\<Longrightarrow> g \\<in> \\<C>) &&&\n    (f \\<in> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n     g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>)", "using assms const_type' fun_type' id_union_univ(1)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\n  \\<forall>c\\<in>\\<C>.\n     \\<exists>a\\<in>\\<TT>\\<^sub>a. \\<forall>X. \\<Gamma> (Fun c X) = Var a\n  \\<forall>f\\<in>\\<Union> (range \\<Sigma>n) - \\<C>.\n     \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)\n  \\<Union> (range \\<Sigma>n) - \\<C> \\<union> \\<C> = UNIV\n\ngoal (1 subgoal):\n 1. (f \\<in> \\<C> \\<Longrightarrow> g \\<in> \\<C>) &&&\n    (f \\<in> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow>\n     g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>)", "by (metis UNIV_I UnE \"term.distinct\"(1))+"], ["", "lemma fun_type_arg_cong:\n  assumes \"f \\<in> \\<Sigma>\\<^sub>f\" \"g \\<in> \\<Sigma>\\<^sub>f\" \"\\<Gamma> (Fun f (x#X)) = \\<Gamma> (Fun g (y#Y))\"\n  shows \"\\<Gamma> x = \\<Gamma> y\" \"\\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y &&& \\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)", "using assms fun_type'"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f (x # X)) = \\<Gamma> (Fun g (y # Y))\n  \\<forall>f\\<in>\\<Union> (range \\<Sigma>n) - \\<C>.\n     \\<forall>X. \\<Gamma> (Fun f X) = Fun f (map \\<Gamma> X)\n\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y &&& \\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)", "by auto"], ["", "lemma fun_type_arg_cong':\n  assumes \"f \\<in> \\<Sigma>\\<^sub>f\" \"g \\<in> \\<Sigma>\\<^sub>f\" \"\\<Gamma> (Fun f (X@x#X')) = \\<Gamma> (Fun g (Y@y#Y'))\" \"length X = length Y\"\n  shows \"\\<Gamma> x = \\<Gamma> y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y", "using assms"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'))\n  length X = length Y\n\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y", "proof (induction X arbitrary: Y)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>Y.\n       \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ([] @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length [] = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y\n 2. \\<And>a X Y.\n       \\<lbrakk>\\<And>Y.\n                   \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    \\<Gamma> (Fun f (X @ x # X')) =\n                    \\<Gamma> (Fun g (Y @ y # Y'));\n                    length X = length Y\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y;\n        f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ((a # X) @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length (a # X) = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y", "case Nil"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f ([] @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'))\n  length [] = length Y\n\ngoal (2 subgoals):\n 1. \\<And>Y.\n       \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ([] @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length [] = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y\n 2. \\<And>a X Y.\n       \\<lbrakk>\\<And>Y.\n                   \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    \\<Gamma> (Fun f (X @ x # X')) =\n                    \\<Gamma> (Fun g (Y @ y # Y'));\n                    length X = length Y\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y;\n        f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ((a # X) @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length (a # X) = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y", "thus ?case"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f ([] @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'))\n  length [] = length Y\n\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y", "using fun_type_arg_cong(1)[of f g x X' y Y']"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f ([] @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'))\n  length [] = length Y\n  \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   \\<Gamma> (Fun f (x # X')) = \\<Gamma> (Fun g (y # Y'))\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y\n\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> x = \\<Gamma> y\n\ngoal (1 subgoal):\n 1. \\<And>a X Y.\n       \\<lbrakk>\\<And>Y.\n                   \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    \\<Gamma> (Fun f (X @ x # X')) =\n                    \\<Gamma> (Fun g (Y @ y # Y'));\n                    length X = length Y\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y;\n        f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ((a # X) @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length (a # X) = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a X Y.\n       \\<lbrakk>\\<And>Y.\n                   \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    \\<Gamma> (Fun f (X @ x # X')) =\n                    \\<Gamma> (Fun g (Y @ y # Y'));\n                    length X = length Y\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y;\n        f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ((a # X) @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length (a # X) = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y", "case (Cons x' X Y'')"], ["proof (state)\nthis:\n  \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (?Y2 @ y # Y'));\n   length X = length ?Y2\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f ((x' # X) @ x # X')) = \\<Gamma> (Fun g (Y'' @ y # Y'))\n  length (x' # X) = length Y''\n\ngoal (1 subgoal):\n 1. \\<And>a X Y.\n       \\<lbrakk>\\<And>Y.\n                   \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    \\<Gamma> (Fun f (X @ x # X')) =\n                    \\<Gamma> (Fun g (Y @ y # Y'));\n                    length X = length Y\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y;\n        f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ((a # X) @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length (a # X) = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (?Y2 @ y # Y'));\n   length X = length ?Y2\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f ((x' # X) @ x # X')) = \\<Gamma> (Fun g (Y'' @ y # Y'))\n  length (x' # X) = length Y''", "obtain y' Y where \"Y'' = y'#Y\""], ["proof (prove)\nusing this:\n  \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (?Y2 @ y # Y'));\n   length X = length ?Y2\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f ((x' # X) @ x # X')) = \\<Gamma> (Fun g (Y'' @ y # Y'))\n  length (x' # X) = length Y''\n\ngoal (1 subgoal):\n 1. (\\<And>y' Y. Y'' = y' # Y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis length_Suc_conv)"], ["proof (state)\nthis:\n  Y'' = y' # Y\n\ngoal (1 subgoal):\n 1. \\<And>a X Y.\n       \\<lbrakk>\\<And>Y.\n                   \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    \\<Gamma> (Fun f (X @ x # X')) =\n                    \\<Gamma> (Fun g (Y @ y # Y'));\n                    length X = length Y\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y;\n        f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ((a # X) @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length (a # X) = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y", "hence \"\\<Gamma> (Fun f (X@x#X')) = \\<Gamma> (Fun g (Y@y#Y'))\" \"length X = length Y\""], ["proof (prove)\nusing this:\n  Y'' = y' # Y\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y')) &&&\n    length X = length Y", "using Cons.prems(3,4) fun_type_arg_cong(2)[OF Cons.prems(1,2), of x' \"X@x#X'\"]"], ["proof (prove)\nusing this:\n  Y'' = y' # Y\n  \\<Gamma> (Fun f ((x' # X) @ x # X')) = \\<Gamma> (Fun g (Y'' @ y # Y'))\n  length (x' # X) = length Y''\n  \\<Gamma> (Fun f (x' # X @ x # X')) =\n  \\<Gamma> (Fun g (?y # ?Y)) \\<Longrightarrow>\n  \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g ?Y)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y')) &&&\n    length X = length Y", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'))\n  length X = length Y\n\ngoal (1 subgoal):\n 1. \\<And>a X Y.\n       \\<lbrakk>\\<And>Y.\n                   \\<lbrakk>f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n                    \\<Gamma> (Fun f (X @ x # X')) =\n                    \\<Gamma> (Fun g (Y @ y # Y'));\n                    length X = length Y\\<rbrakk>\n                   \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y;\n        f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n        \\<Gamma> (Fun f ((a # X) @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'));\n        length (a # X) = length Y\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'))\n  length X = length Y\n\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y", "using Cons.IH[OF Cons.prems(1,2)]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (Y @ y # Y'))\n  length X = length Y\n  \\<lbrakk>\\<Gamma> (Fun f (X @ x # X')) = \\<Gamma> (Fun g (?Y2 @ y # Y'));\n   length X = length ?Y2\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> x = \\<Gamma> y\n\ngoal (1 subgoal):\n 1. \\<Gamma> x = \\<Gamma> y", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> x = \\<Gamma> y\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma fun_type_param_idx: \"\\<Gamma> (Fun f T) = Fun g S \\<Longrightarrow> i < length T \\<Longrightarrow> \\<Gamma> (T ! i) = S ! i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<Gamma> (Fun f T) = Fun g S; i < length T\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> (T ! i) = S ! i", "by (metis fun_type fun_type_id_eq fun_type_inv(1) nth_map term.inject(2))"], ["", "lemma fun_type_param_ex:\n  assumes \"\\<Gamma> (Fun f T) = Fun g (map \\<Gamma> S)\" \"t \\<in> set S\"\n  shows \"\\<exists>s \\<in> set T. \\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. \\<Gamma> s = \\<Gamma> t", "using fun_type_length_eq[OF assms(1)] length_map[of \\<Gamma> S] assms(2)\n      fun_type_param_idx[OF assms(1)] nth_map in_set_conv_nth"], ["proof (prove)\nusing this:\n  length T = length (map \\<Gamma> S)\n  length (map \\<Gamma> S) = length S\n  t \\<in> set S\n  ?i < length T \\<Longrightarrow> \\<Gamma> (T ! ?i) = map \\<Gamma> S ! ?i\n  ?n < length ?xs \\<Longrightarrow> map ?f ?xs ! ?n = ?f (?xs ! ?n)\n  (?x \\<in> set ?xs) = (\\<exists>i<length ?xs. ?xs ! i = ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>set T. \\<Gamma> s = \\<Gamma> t", "by metis"], ["", "lemma tfr_stp_all_split:\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x#S) \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [x]\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x#S) \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S') \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S') \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S'\"\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@x#S') \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S) \\<Longrightarrow>\n      list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [x]) &&&\n     (list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S) \\<Longrightarrow>\n      list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S)) &&&\n    (list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S @ S') \\<Longrightarrow>\n     list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S) &&&\n    (list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S @ S') \\<Longrightarrow>\n     list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S') &&&\n    (list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S @ x # S') \\<Longrightarrow>\n     list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S @ S'))", "by fastforce+"], ["", "lemma tfr_stp_all_append:\n  assumes \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\" \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S'\"\n  shows \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@S')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S @ S')", "using assms"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S'\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S @ S')", "by fastforce"], ["", "lemma tfr_stp_all_wt_subst_apply:\n  assumes \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\"\n    and \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"\n           \"bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> = {}\"\n  shows \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "using assms(1,4)"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n  bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> = {}\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "proof (induction S)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [];\n     bvars\\<^sub>s\\<^sub>t [] \\<inter> range_vars \\<theta> = {}\\<rbrakk>\n    \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                       ([] \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>a S.\n       \\<lbrakk>\\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n                 bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> =\n                 {}\\<rbrakk>\n                \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                                   (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S);\n        bvars\\<^sub>s\\<^sub>t (a # S) \\<inter> range_vars \\<theta> =\n        {}\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (a # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "case (Cons x S)"], ["proof (state)\nthis:\n  \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n   bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> = {}\\<rbrakk>\n  \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n  bvars\\<^sub>s\\<^sub>t (x # S) \\<inter> range_vars \\<theta> = {}\n\ngoal (2 subgoals):\n 1. \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [];\n     bvars\\<^sub>s\\<^sub>t [] \\<inter> range_vars \\<theta> = {}\\<rbrakk>\n    \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                       ([] \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>a S.\n       \\<lbrakk>\\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n                 bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> =\n                 {}\\<rbrakk>\n                \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                                   (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S);\n        bvars\\<^sub>s\\<^sub>t (a # S) \\<inter> range_vars \\<theta> =\n        {}\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (a # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "hence IH: \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n   bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> = {}\\<rbrakk>\n  \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n  bvars\\<^sub>s\\<^sub>t (x # S) \\<inter> range_vars \\<theta> = {}\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "using tfr_stp_all_split(2)[of x S]"], ["proof (prove)\nusing this:\n  \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n   bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> = {}\\<rbrakk>\n  \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n  bvars\\<^sub>s\\<^sub>t (x # S) \\<inter> range_vars \\<theta> = {}\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S) \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "unfolding range_vars_alt_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n   bvars\\<^sub>s\\<^sub>t S \\<inter>\n   fv\\<^sub>s\\<^sub>e\\<^sub>t (subst_range \\<theta>) =\n   {}\\<rbrakk>\n  \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n  bvars\\<^sub>s\\<^sub>t (x # S) \\<inter>\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (subst_range \\<theta>) =\n  {}\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S) \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "by fastforce"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [];\n     bvars\\<^sub>s\\<^sub>t [] \\<inter> range_vars \\<theta> = {}\\<rbrakk>\n    \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                       ([] \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>a S.\n       \\<lbrakk>\\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S;\n                 bvars\\<^sub>s\\<^sub>t S \\<inter> range_vars \\<theta> =\n                 {}\\<rbrakk>\n                \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                                   (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S);\n        bvars\\<^sub>s\\<^sub>t (a # S) \\<inter> range_vars \\<theta> =\n        {}\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (a # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "thus ?case"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "proof (cases x)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "case (Equality a t t')"], ["proof (state)\nthis:\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "hence \"(\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow> \\<Gamma> t = \\<Gamma> t'\""], ["proof (prove)\nusing this:\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n    \\<Gamma> t = \\<Gamma> t'", "using Cons.prems"], ["proof (prove)\nusing this:\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n  bvars\\<^sub>s\\<^sub>t (x # S) \\<inter> range_vars \\<theta> = {}\n\ngoal (1 subgoal):\n 1. (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n    \\<Gamma> t = \\<Gamma> t'", "by auto"], ["proof (state)\nthis:\n  (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n  \\<Gamma> t = \\<Gamma> t'\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "hence \"(\\<exists>\\<delta>. Unifier \\<delta> (t \\<cdot> \\<theta>) (t' \\<cdot> \\<theta>)) \\<longrightarrow> \\<Gamma> (t \\<cdot> \\<theta>) = \\<Gamma> (t' \\<cdot> \\<theta>)\""], ["proof (prove)\nusing this:\n  (\\<exists>\\<delta>. Unifier \\<delta> t t') \\<longrightarrow>\n  \\<Gamma> t = \\<Gamma> t'\n\ngoal (1 subgoal):\n 1. (\\<exists>\\<delta>.\n        Unifier \\<delta> (t \\<cdot> \\<theta>)\n         (t' \\<cdot> \\<theta>)) \\<longrightarrow>\n    \\<Gamma> (t \\<cdot> \\<theta>) = \\<Gamma> (t' \\<cdot> \\<theta>)", "by (metis Unifier_comp' wt_subst_trm'[OF assms(2)])"], ["proof (state)\nthis:\n  (\\<exists>\\<delta>.\n      Unifier \\<delta> (t \\<cdot> \\<theta>)\n       (t' \\<cdot> \\<theta>)) \\<longrightarrow>\n  \\<Gamma> (t \\<cdot> \\<theta>) = \\<Gamma> (t' \\<cdot> \\<theta>)\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "moreover"], ["proof (state)\nthis:\n  (\\<exists>\\<delta>.\n      Unifier \\<delta> (t \\<cdot> \\<theta>)\n       (t' \\<cdot> \\<theta>)) \\<longrightarrow>\n  \\<Gamma> (t \\<cdot> \\<theta>) = \\<Gamma> (t' \\<cdot> \\<theta>)\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "have \"(x#S) \\<cdot>\\<^sub>s\\<^sub>t \\<theta> = Equality a (t \\<cdot> \\<theta>) (t' \\<cdot> \\<theta>)#(S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n    \\<langle>a: (t \\<cdot>\n                 \\<theta>) \\<doteq> t' \\<cdot>\n                                    \\<theta>\\<rangle>\\<^sub>s\\<^sub>t #\n    (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "using \\<open>x = Equality a t t'\\<close>"], ["proof (prove)\nusing this:\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n    \\<langle>a: (t \\<cdot>\n                 \\<theta>) \\<doteq> t' \\<cdot>\n                                    \\<theta>\\<rangle>\\<^sub>s\\<^sub>t #\n    (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "by auto"], ["proof (state)\nthis:\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<langle>a: (t \\<cdot>\n               \\<theta>) \\<doteq> t' \\<cdot>\n                                  \\<theta>\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "ultimately"], ["proof (chain)\npicking this:\n  (\\<exists>\\<delta>.\n      Unifier \\<delta> (t \\<cdot> \\<theta>)\n       (t' \\<cdot> \\<theta>)) \\<longrightarrow>\n  \\<Gamma> (t \\<cdot> \\<theta>) = \\<Gamma> (t' \\<cdot> \\<theta>)\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<langle>a: (t \\<cdot>\n               \\<theta>) \\<doteq> t' \\<cdot>\n                                  \\<theta>\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<exists>\\<delta>.\n      Unifier \\<delta> (t \\<cdot> \\<theta>)\n       (t' \\<cdot> \\<theta>)) \\<longrightarrow>\n  \\<Gamma> (t \\<cdot> \\<theta>) = \\<Gamma> (t' \\<cdot> \\<theta>)\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<langle>a: (t \\<cdot>\n               \\<theta>) \\<doteq> t' \\<cdot>\n                                  \\<theta>\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "using IH"], ["proof (prove)\nusing this:\n  (\\<exists>\\<delta>.\n      Unifier \\<delta> (t \\<cdot> \\<theta>)\n       (t' \\<cdot> \\<theta>)) \\<longrightarrow>\n  \\<Gamma> (t \\<cdot> \\<theta>) = \\<Gamma> (t' \\<cdot> \\<theta>)\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<langle>a: (t \\<cdot>\n               \\<theta>) \\<doteq> t' \\<cdot>\n                                  \\<theta>\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "by auto"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n   (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "case (Inequality X F)"], ["proof (state)\nthis:\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "let ?\\<sigma> = \"rm_vars (set X) \\<theta>\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "let ?G = \"F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s ?\\<sigma>\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "let ?P = \"\\<lambda>F X. \\<forall>x \\<in> fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X. \\<exists>a. \\<Gamma> (Var x) = TAtom a\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "let ?Q = \"\\<lambda>F X.\n      \\<forall>f T. Fun f T \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F) \\<longrightarrow> T = [] \\<or> (\\<exists>s \\<in> set T. s \\<notin> Var ` set X)\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "have 0: \"set X \\<inter> range_vars ?\\<sigma> = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set X \\<inter> range_vars (rm_vars (set X) \\<theta>) = {}", "using Cons.prems(2) Inequality rm_vars_img_subset[of \"set X\"]"], ["proof (prove)\nusing this:\n  bvars\\<^sub>s\\<^sub>t (x # S) \\<inter> range_vars \\<theta> = {}\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  subst_range (rm_vars (set X) ?s) \\<subseteq> subst_range ?s\n\ngoal (1 subgoal):\n 1. set X \\<inter> range_vars (rm_vars (set X) \\<theta>) = {}", "by (auto simp add: subst_domain_def range_vars_alt_def)"], ["proof (state)\nthis:\n  set X \\<inter> range_vars (rm_vars (set X) \\<theta>) = {}\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "have 1: \"?P F X \\<or> ?Q F X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n    (\\<forall>f T.\n        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n        T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))", "using Inequality Cons.prems"], ["proof (prove)\nusing this:\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n  bvars\\<^sub>s\\<^sub>t (x # S) \\<inter> range_vars \\<theta> = {}\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n    (\\<forall>f T.\n        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n        T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))", "by simp"], ["proof (state)\nthis:\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "have 2: \"fv\\<^sub>s\\<^sub>e\\<^sub>t (?\\<sigma> ` set X) = set X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv\\<^sub>s\\<^sub>e\\<^sub>t (rm_vars (set X) \\<theta> ` set X) = set X", "by auto"], ["proof (state)\nthis:\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (rm_vars (set X) \\<theta> ` set X) = set X\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "have \"?P ?G X\" when \"?P F X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "using that"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "proof (induction F)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s [] - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n    \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    ([] \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>a F.\n       \\<lbrakk>\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                F -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n                \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                 rm_vars (set X) \\<theta>) -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (a # F) -\n                       set X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   (a # F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n    rm_vars (set X) \\<theta>) -\n  set X.\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "case (Cons g G)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s G - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (g # G) - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s [] - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n    \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    ([] \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>a F.\n       \\<lbrakk>\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                F -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n                \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                 rm_vars (set X) \\<theta>) -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (a # F) -\n                       set X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   (a # F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n    rm_vars (set X) \\<theta>) -\n  set X.\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "obtain t t' where g: \"g = (t,t')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>t t'. g = (t, t') \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis surj_pair)"], ["proof (state)\nthis:\n  g = (t, t')\n\ngoal (2 subgoals):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s [] - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n    \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    ([] \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>a F.\n       \\<lbrakk>\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                F -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n                \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                 rm_vars (set X) \\<theta>) -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (a # F) -\n                       set X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   (a # F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n    rm_vars (set X) \\<theta>) -\n  set X.\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "have \"\\<forall>x \\<in> (fv (t \\<cdot> ?\\<sigma>) \\<union> fv (t' \\<cdot> ?\\<sigma>)) - set X. \\<exists>a. \\<Gamma> (Var x) = Var a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                   fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                   fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "have *: \"\\<forall>x \\<in> fv t - set X. \\<exists>a. \\<Gamma> (Var x) = Var a\"\n               \"\\<forall>x \\<in> fv t' - set X. \\<exists>a. \\<Gamma> (Var x) = Var a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv t - set X. \\<exists>a. \\<Gamma> (Var x) = Var a &&&\n    \\<forall>x\\<in>fv t' - set X. \\<exists>a. \\<Gamma> (Var x) = Var a", "using g Cons.prems"], ["proof (prove)\nusing this:\n  g = (t, t')\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (g # G) - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv t - set X. \\<exists>a. \\<Gamma> (Var x) = Var a &&&\n    \\<forall>x\\<in>fv t' - set X. \\<exists>a. \\<Gamma> (Var x) = Var a", "by simp_all"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv t - set X. \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<forall>x\\<in>fv t' - set X. \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                   fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "have **: \"\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<sigma> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (rm_vars (set X) \\<theta> x)", "using \\<theta>(2) wf_trm_subst_range_iff[of \\<theta>] wf_trm_subst_rm_vars'[of \\<theta> _ \"set X\"]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  (\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> x)) =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<theta> ?v) \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (rm_vars (set X) \\<theta> ?v)\n\ngoal (1 subgoal):\n 1. \\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (rm_vars (set X) \\<theta> x)", "by simp"], ["proof (state)\nthis:\n  \\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (rm_vars (set X) \\<theta> x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                   fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                   fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "using wt_subst_TAtom_fv[OF wt_subst_rm_vars[OF \\<theta>(1)] ** *(1)]\n                wt_subst_TAtom_fv[OF wt_subst_rm_vars[OF \\<theta>(1)] ** *(2)]\n                wt_subst_trm'[OF wt_subst_rm_vars[OF \\<theta>(1), of \"set X\"]] 2"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) -\n                 fv\\<^sub>s\\<^sub>e\\<^sub>t\n                  (rm_vars (set X) \\<theta> ` set X).\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<forall>x\\<in>fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                 fv\\<^sub>s\\<^sub>e\\<^sub>t\n                  (rm_vars (set X) \\<theta> ` set X).\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<Gamma> ?s = \\<Gamma> ?t \\<Longrightarrow>\n  \\<Gamma> (?s \\<cdot> rm_vars (set X) \\<theta>) =\n  \\<Gamma> (?t \\<cdot> rm_vars (set X) \\<theta>)\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (rm_vars (set X) \\<theta> ` set X) = set X\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                   fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "by blast"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                 fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                 fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s [] - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n    \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    ([] \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>a F.\n       \\<lbrakk>\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                F -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n                \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                 rm_vars (set X) \\<theta>) -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (a # F) -\n                       set X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   (a # F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n    rm_vars (set X) \\<theta>) -\n  set X.\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "moreover"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                 fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s [] - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n    \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    ([] \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>a F.\n       \\<lbrakk>\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                F -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n                \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                 rm_vars (set X) \\<theta>) -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (a # F) -\n                       set X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   (a # F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n    rm_vars (set X) \\<theta>) -\n  set X.\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "have \"\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s ?\\<sigma>) - set X. \\<exists>a. \\<Gamma> (Var x) = Var a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "using Cons"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s G - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (g # G) - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "by auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s [] - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n    \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    ([] \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a\n 2. \\<And>a F.\n       \\<lbrakk>\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                F -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n                \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                 rm_vars (set X) \\<theta>) -\n                               set X.\n                   \\<exists>a. \\<Gamma> (Var x) = Var a;\n        \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s (a # F) -\n                       set X.\n           \\<exists>a. \\<Gamma> (Var x) = Var a\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   (a # F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n    rm_vars (set X) \\<theta>) -\n  set X.\n                            \\<exists>a. \\<Gamma> (Var x) = Var a", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                 fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                 fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    (g # G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "using g"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv (t \\<cdot> rm_vars (set X) \\<theta>) \\<union>\n                 fv (t' \\<cdot> rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  g = (t, t')\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    (g # G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "by (auto simp add: subst_apply_pairs_def)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (g # G \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s [] - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n    \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    ([] \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     rm_vars (set X) \\<theta>) -\n                   set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a", "qed (simp add: subst_apply_pairs_def)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "hence \"?P ?G X \\<or> ?Q ?G X\""], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                      rm_vars (set X) \\<theta>) -\n                    set X.\n        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n    (\\<forall>f T.\n        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n         (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n          rm_vars (set X) \\<theta>) \\<longrightarrow>\n        T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))", "using 1 ineq_subterm_inj_cond_subst[OF 0, of \"trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F\"] trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s_subst[of F ?\\<sigma>]"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a \\<Longrightarrow>\n  \\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                  (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   rm_vars (set X) \\<theta>) -\n                 set X.\n     \\<exists>a. \\<Gamma> (Var x) = Var a\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n  \\<forall>f T.\n     Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n     trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n     T = [] \\<or>\n     (\\<exists>u\\<in>set T. u \\<notin> Var ` set X) \\<Longrightarrow>\n  \\<forall>f T.\n     Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n     trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n      F \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n     rm_vars (set X) \\<theta> \\<longrightarrow>\n     T = [] \\<or> (\\<exists>u\\<in>set T. u \\<notin> Var ` set X)\n  trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n    rm_vars (set X) \\<theta>) =\n  trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n   F \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  rm_vars (set X) \\<theta>\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                     (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                      rm_vars (set X) \\<theta>) -\n                    set X.\n        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n    (\\<forall>f T.\n        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n         (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n          rm_vars (set X) \\<theta>) \\<longrightarrow>\n        T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))", "by presburger"], ["proof (state)\nthis:\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    rm_vars (set X) \\<theta>) -\n                  set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n       (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n        rm_vars (set X) \\<theta>) \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "moreover"], ["proof (state)\nthis:\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    rm_vars (set X) \\<theta>) -\n                  set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n       (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n        rm_vars (set X) \\<theta>) \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "have \"(x#S) \\<cdot>\\<^sub>s\\<^sub>t \\<theta> = Inequality X (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s ?\\<sigma>)#(S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n    \\<forall>X\\<langle>\\<or>\\<noteq>: (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n rm_vars (set X) \\<theta>)\\<rangle>\\<^sub>s\\<^sub>t #\n    (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "using \\<open>x = Inequality X F\\<close>"], ["proof (prove)\nusing this:\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n    \\<forall>X\\<langle>\\<or>\\<noteq>: (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n rm_vars (set X) \\<theta>)\\<rangle>\\<^sub>s\\<^sub>t #\n    (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "by auto"], ["proof (state)\nthis:\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<forall>X\\<langle>\\<or>\\<noteq>: (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     rm_vars (set X)\n\\<theta>)\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "ultimately"], ["proof (chain)\npicking this:\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    rm_vars (set X) \\<theta>) -\n                  set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n       (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n        rm_vars (set X) \\<theta>) \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<forall>X\\<langle>\\<or>\\<noteq>: (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     rm_vars (set X)\n\\<theta>)\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    rm_vars (set X) \\<theta>) -\n                  set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n       (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n        rm_vars (set X) \\<theta>) \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<forall>X\\<langle>\\<or>\\<noteq>: (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     rm_vars (set X)\n\\<theta>)\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "using IH"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                   (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                    rm_vars (set X) \\<theta>) -\n                  set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n       (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n        rm_vars (set X) \\<theta>) \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n  x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta> =\n  \\<forall>X\\<langle>\\<or>\\<noteq>: (F \\<cdot>\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s\n                                     rm_vars (set X)\n\\<theta>)\\<rangle>\\<^sub>s\\<^sub>t #\n  (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n     (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "by simp"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n   (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "qed auto"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n   (x # S \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [];\n     bvars\\<^sub>s\\<^sub>t [] \\<inter> range_vars \\<theta> = {}\\<rbrakk>\n    \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                       ([] \\<cdot>\\<^sub>s\\<^sub>t \\<theta>)", "qed simp"], ["", "lemma tfr_stp_all_same_type:\n  \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (S@Equality a t t'#S') \\<Longrightarrow> Unifier \\<delta> t t' \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n              (S @ \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t # S');\n     Unifier \\<delta> t t'\\<rbrakk>\n    \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t'", "by force+"], ["", "lemma tfr_subset:\n  \"\\<And>A B. tfr\\<^sub>s\\<^sub>e\\<^sub>t (A \\<union> B) \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\"\n  \"\\<And>A B. tfr\\<^sub>s\\<^sub>e\\<^sub>t B \\<Longrightarrow> A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\"\n  \"\\<And>A B. tfr\\<^sub>s\\<^sub>e\\<^sub>t B \\<Longrightarrow> SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A B.\n        tfr\\<^sub>s\\<^sub>e\\<^sub>t (A \\<union> B) \\<Longrightarrow>\n        tfr\\<^sub>s\\<^sub>e\\<^sub>t A) &&&\n    (\\<And>A B.\n        \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B; A \\<subseteq> B\\<rbrakk>\n        \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A) &&&\n    (\\<And>A B.\n        \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B;\n         SMP A \\<subseteq> SMP B\\<rbrakk>\n        \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A)", "proof -"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>A B.\n       tfr\\<^sub>s\\<^sub>e\\<^sub>t (A \\<union> B) \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n 2. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B; A \\<subseteq> B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n 3. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B;\n        SMP A \\<subseteq> SMP B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "show 1: \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (A \\<union> B) \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\" for A B"], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (A \\<union> B) \\<Longrightarrow>\n    tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "using SMP_union[of A B]"], ["proof (prove)\nusing this:\n  SMP (A \\<union> B) = SMP A \\<union> SMP B\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (A \\<union> B) \\<Longrightarrow>\n    tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "unfolding tfr\\<^sub>s\\<^sub>e\\<^sub>t_def"], ["proof (prove)\nusing this:\n  SMP (A \\<union> B) = SMP A \\<union> SMP B\n\ngoal (1 subgoal):\n 1. \\<forall>s\\<in>SMP (A \\<union> B) - range Var.\n       \\<forall>t\\<in>SMP (A \\<union> B) - range Var.\n          (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n          \\<Gamma> s = \\<Gamma> t \\<Longrightarrow>\n    \\<forall>s\\<in>SMP A - range Var.\n       \\<forall>t\\<in>SMP A - range Var.\n          (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n          \\<Gamma> s = \\<Gamma> t", "by simp"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (?A2 \\<union> ?B2) \\<Longrightarrow>\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t ?A2\n\ngoal (2 subgoals):\n 1. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B; A \\<subseteq> B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n 2. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B;\n        SMP A \\<subseteq> SMP B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "fix A B"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B; A \\<subseteq> B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n 2. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B;\n        SMP A \\<subseteq> SMP B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "assume B: \"tfr\\<^sub>s\\<^sub>e\\<^sub>t B\""], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t B\n\ngoal (2 subgoals):\n 1. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B; A \\<subseteq> B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n 2. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B;\n        SMP A \\<subseteq> SMP B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "show \"A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "assume \"A \\<subseteq> B\""], ["proof (state)\nthis:\n  A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "then"], ["proof (chain)\npicking this:\n  A \\<subseteq> B", "obtain C where \"B = A \\<union> C\""], ["proof (prove)\nusing this:\n  A \\<subseteq> B\n\ngoal (1 subgoal):\n 1. (\\<And>C. B = A \\<union> C \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  B = A \\<union> C\n\ngoal (1 subgoal):\n 1. A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "thus ?thesis"], ["proof (prove)\nusing this:\n  B = A \\<union> C\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "using B 1"], ["proof (prove)\nusing this:\n  B = A \\<union> C\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t B\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (?A2 \\<union> ?B2) \\<Longrightarrow>\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t ?A2\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "by blast"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  A \\<subseteq> B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       \\<lbrakk>tfr\\<^sub>s\\<^sub>e\\<^sub>t B;\n        SMP A \\<subseteq> SMP B\\<rbrakk>\n       \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "show \"SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "assume \"SMP A \\<subseteq> SMP B\""], ["proof (state)\nthis:\n  SMP A \\<subseteq> SMP B\n\ngoal (1 subgoal):\n 1. SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "then"], ["proof (chain)\npicking this:\n  SMP A \\<subseteq> SMP B", "obtain C where \"SMP B = SMP A \\<union> C\""], ["proof (prove)\nusing this:\n  SMP A \\<subseteq> SMP B\n\ngoal (1 subgoal):\n 1. (\\<And>C.\n        SMP B = SMP A \\<union> C \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  SMP B = SMP A \\<union> C\n\ngoal (1 subgoal):\n 1. SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "thus ?thesis"], ["proof (prove)\nusing this:\n  SMP B = SMP A \\<union> C\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "using B"], ["proof (prove)\nusing this:\n  SMP B = SMP A \\<union> C\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t B\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t A", "unfolding tfr\\<^sub>s\\<^sub>e\\<^sub>t_def"], ["proof (prove)\nusing this:\n  SMP B = SMP A \\<union> C\n  \\<forall>s\\<in>SMP B - range Var.\n     \\<forall>t\\<in>SMP B - range Var.\n        (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n        \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>s\\<in>SMP A - range Var.\n       \\<forall>t\\<in>SMP A - range Var.\n          (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n          \\<Gamma> s = \\<Gamma> t", "by blast"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  SMP A \\<subseteq> SMP B \\<Longrightarrow> tfr\\<^sub>s\\<^sub>e\\<^sub>t A\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma tfr_empty[simp]: \"tfr\\<^sub>s\\<^sub>e\\<^sub>t {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t {}", "unfolding tfr\\<^sub>s\\<^sub>e\\<^sub>t_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s\\<in>SMP {} - range Var.\n       \\<forall>t\\<in>SMP {} - range Var.\n          (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n          \\<Gamma> s = \\<Gamma> t", "by simp"], ["", "lemma tfr_consts_mono:\n  assumes \"\\<forall>t \\<in> M. \\<exists>c. t = Fun c []\"\n    and \"\\<forall>t \\<in> M. Ana t = ([], [])\"\n    and \"tfr\\<^sub>s\\<^sub>e\\<^sub>t N\"\n  shows \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "fix s t"], ["proof (state)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "assume *: \"s \\<in> SMP (N \\<union> M) - range Var\" \"t \\<in> SMP (N \\<union> M) - range Var\" \"\\<exists>\\<delta>. Unifier \\<delta> s t\""], ["proof (state)\nthis:\n  s \\<in> SMP (N \\<union> M) - range Var\n  t \\<in> SMP (N \\<union> M) - range Var\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "hence **: \"is_Fun s\" \"is_Fun t\" \"s \\<in> SMP N \\<or> s \\<in> M\" \"t \\<in> SMP N \\<or> t \\<in> M\""], ["proof (prove)\nusing this:\n  s \\<in> SMP (N \\<union> M) - range Var\n  t \\<in> SMP (N \\<union> M) - range Var\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n\ngoal (1 subgoal):\n 1. (is_Fun s &&& is_Fun t) &&&\n    s \\<in> SMP N \\<or> s \\<in> M &&& t \\<in> SMP N \\<or> t \\<in> M", "using assms(3) SMP_consts[OF assms(1,2)] SMP_union[of N M]"], ["proof (prove)\nusing this:\n  s \\<in> SMP (N \\<union> M) - range Var\n  t \\<in> SMP (N \\<union> M) - range Var\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t N\n  SMP M = M\n  SMP (N \\<union> M) = SMP N \\<union> SMP M\n\ngoal (1 subgoal):\n 1. (is_Fun s &&& is_Fun t) &&&\n    s \\<in> SMP N \\<or> s \\<in> M &&& t \\<in> SMP N \\<or> t \\<in> M", "by auto"], ["proof (state)\nthis:\n  is_Fun s\n  is_Fun t\n  s \\<in> SMP N \\<or> s \\<in> M\n  t \\<in> SMP N \\<or> t \\<in> M\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "moreover"], ["proof (state)\nthis:\n  is_Fun s\n  is_Fun t\n  s \\<in> SMP N \\<or> s \\<in> M\n  t \\<in> SMP N \\<or> t \\<in> M\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "have \"\\<Gamma> s = \\<Gamma> t\" when \"s \\<in> SMP N\" \"t \\<in> SMP N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "using that assms(3) *(3) **(1,2)"], ["proof (prove)\nusing this:\n  s \\<in> SMP N\n  t \\<in> SMP N\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t N\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n  is_Fun s\n  is_Fun t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "unfolding tfr\\<^sub>s\\<^sub>e\\<^sub>t_def"], ["proof (prove)\nusing this:\n  s \\<in> SMP N\n  t \\<in> SMP N\n  \\<forall>s\\<in>SMP N - range Var.\n     \\<forall>t\\<in>SMP N - range Var.\n        (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n        \\<Gamma> s = \\<Gamma> t\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n  is_Fun s\n  is_Fun t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "by blast"], ["proof (state)\nthis:\n  \\<lbrakk>s \\<in> SMP N; t \\<in> SMP N\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>s \\<in> SMP N; t \\<in> SMP N\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "have \"\\<Gamma> s = \\<Gamma> t\" when st: \"s \\<in> M\" \"t \\<in> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "obtain c d where \"s = Fun c []\" \"t = Fun d []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c d.\n        \\<lbrakk>s = Fun c []; t = Fun d []\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using st assms(1)"], ["proof (prove)\nusing this:\n  s \\<in> M\n  t \\<in> M\n  \\<forall>t\\<in>M. \\<exists>c. t = Fun c []\n\ngoal (1 subgoal):\n 1. (\\<And>c d.\n        \\<lbrakk>s = Fun c []; t = Fun d []\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  s = Fun c []\n  t = Fun d []\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "hence \"s = t\""], ["proof (prove)\nusing this:\n  s = Fun c []\n  t = Fun d []\n\ngoal (1 subgoal):\n 1. s = t", "using *(3)"], ["proof (prove)\nusing this:\n  s = Fun c []\n  t = Fun d []\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n\ngoal (1 subgoal):\n 1. s = t", "by fast"], ["proof (state)\nthis:\n  s = t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "thus ?thesis"], ["proof (prove)\nusing this:\n  s = t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> s = \\<Gamma> t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>s \\<in> M; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>s \\<in> M; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "have \"\\<Gamma> s = \\<Gamma> t\" when st: \"s \\<in> SMP N\" \"t \\<in> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "obtain c where \"t = Fun c []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c. t = Fun c [] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using st assms(1)"], ["proof (prove)\nusing this:\n  s \\<in> SMP N\n  t \\<in> M\n  \\<forall>t\\<in>M. \\<exists>c. t = Fun c []\n\ngoal (1 subgoal):\n 1. (\\<And>c. t = Fun c [] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t = Fun c []\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "hence \"s = t\""], ["proof (prove)\nusing this:\n  t = Fun c []\n\ngoal (1 subgoal):\n 1. s = t", "using *(3) **(1,2)"], ["proof (prove)\nusing this:\n  t = Fun c []\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n  is_Fun s\n  is_Fun t\n\ngoal (1 subgoal):\n 1. s = t", "by auto"], ["proof (state)\nthis:\n  s = t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "thus ?thesis"], ["proof (prove)\nusing this:\n  s = t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> s = \\<Gamma> t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>s \\<in> SMP N; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>s \\<in> SMP N; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "have \"\\<Gamma> s = \\<Gamma> t\" when st: \"s \\<in> M\" \"t \\<in> SMP N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "obtain c where \"s = Fun c []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c. s = Fun c [] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using st assms(1)"], ["proof (prove)\nusing this:\n  s \\<in> M\n  t \\<in> SMP N\n  \\<forall>t\\<in>M. \\<exists>c. t = Fun c []\n\ngoal (1 subgoal):\n 1. (\\<And>c. s = Fun c [] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  s = Fun c []\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "hence \"s = t\""], ["proof (prove)\nusing this:\n  s = Fun c []\n\ngoal (1 subgoal):\n 1. s = t", "using *(3) **(1,2)"], ["proof (prove)\nusing this:\n  s = Fun c []\n  \\<exists>\\<delta>. Unifier \\<delta> s t\n  is_Fun s\n  is_Fun t\n\ngoal (1 subgoal):\n 1. s = t", "by auto"], ["proof (state)\nthis:\n  s = t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "thus ?thesis"], ["proof (prove)\nusing this:\n  s = t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> s = \\<Gamma> t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>s \\<in> M; t \\<in> SMP N\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "ultimately"], ["proof (chain)\npicking this:\n  is_Fun s\n  is_Fun t\n  s \\<in> SMP N \\<or> s \\<in> M\n  t \\<in> SMP N \\<or> t \\<in> M\n  \\<lbrakk>s \\<in> SMP N; t \\<in> SMP N\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n  \\<lbrakk>s \\<in> M; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n  \\<lbrakk>s \\<in> SMP N; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n  \\<lbrakk>s \\<in> M; t \\<in> SMP N\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t", "have \"\\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\nusing this:\n  is_Fun s\n  is_Fun t\n  s \\<in> SMP N \\<or> s \\<in> M\n  t \\<in> SMP N \\<or> t \\<in> M\n  \\<lbrakk>s \\<in> SMP N; t \\<in> SMP N\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n  \\<lbrakk>s \\<in> M; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n  \\<lbrakk>s \\<in> SMP N; t \\<in> M\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n  \\<lbrakk>s \\<in> M; t \\<in> SMP N\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?s4 \\<in> SMP (N \\<union> M) - range Var;\n   ?t4 \\<in> SMP (N \\<union> M) - range Var;\n   \\<exists>\\<delta>. Unifier \\<delta> ?s4 ?t4\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> ?s4 = \\<Gamma> ?t4\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?s4 \\<in> SMP (N \\<union> M) - range Var;\n   ?t4 \\<in> SMP (N \\<union> M) - range Var;\n   \\<exists>\\<delta>. Unifier \\<delta> ?s4 ?t4\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> ?s4 = \\<Gamma> ?t4\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)", "by (metis tfr\\<^sub>s\\<^sub>e\\<^sub>t_def)"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (N \\<union> M)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma dual\\<^sub>s\\<^sub>t_tfr\\<^sub>s\\<^sub>t\\<^sub>p: \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)", "proof (induction S)"], ["proof (state)\ngoal (2 subgoals):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t [])\n 2. \\<And>a S.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (a # S))", "case (Cons x S)"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n\ngoal (2 subgoals):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t [])\n 2. \\<And>a S.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (a # S))", "have \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "using Cons.prems"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "by simp"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n\ngoal (2 subgoals):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t [])\n 2. \\<And>a S.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (a # S))", "hence IH: \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)", "using Cons.IH"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)", "by metis"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n\ngoal (2 subgoals):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t [])\n 2. \\<And>a S.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (a # S)\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (a # S))", "from Cons"], ["proof (chain)\npicking this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)", "show ?case"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))", "proof (cases x)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "case (Equality a t t')"], ["proof (state)\nthis:\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "hence \"(\\<exists>\\<delta>. Unifier \\<delta> t t') \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t'\""], ["proof (prove)\nusing this:\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>. Unifier \\<delta> t t' \\<Longrightarrow>\n    \\<Gamma> t = \\<Gamma> t'", "using Cons"], ["proof (prove)\nusing this:\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>. Unifier \\<delta> t t' \\<Longrightarrow>\n    \\<Gamma> t = \\<Gamma> t'", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<delta>. Unifier \\<delta> t t' \\<Longrightarrow>\n  \\<Gamma> t = \\<Gamma> t'\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x31 x32 x33.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 4. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>\\<delta>. Unifier \\<delta> t t' \\<Longrightarrow>\n  \\<Gamma> t = \\<Gamma> t'\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))", "using Equality IH"], ["proof (prove)\nusing this:\n  \\<exists>\\<delta>. Unifier \\<delta> t t' \\<Longrightarrow>\n  \\<Gamma> t = \\<Gamma> t'\n  x = \\<langle>a: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))", "by fastforce"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "case (Inequality X F)"], ["proof (state)\nthis:\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "have \"set (dual\\<^sub>s\\<^sub>t (x#S)) = insert x (set (dual\\<^sub>s\\<^sub>t S))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set (dual\\<^sub>s\\<^sub>t (x # S)) =\n    insert x (set (dual\\<^sub>s\\<^sub>t S))", "using Inequality"], ["proof (prove)\nusing this:\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. set (dual\\<^sub>s\\<^sub>t (x # S)) =\n    insert x (set (dual\\<^sub>s\\<^sub>t S))", "by auto"], ["proof (state)\nthis:\n  set (dual\\<^sub>s\\<^sub>t (x # S)) =\n  insert x (set (dual\\<^sub>s\\<^sub>t S))\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "moreover"], ["proof (state)\nthis:\n  set (dual\\<^sub>s\\<^sub>t (x # S)) =\n  insert x (set (dual\\<^sub>s\\<^sub>t S))\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "have \"(\\<forall>x \\<in> fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X. \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n            (\\<forall>f T. Fun f T \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F) \\<longrightarrow> T = [] \\<or> (\\<exists>s \\<in> set T. s \\<notin> Var ` set X))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n    (\\<forall>f T.\n        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n        T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))", "using Cons.prems Inequality"], ["proof (prove)\nusing this:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S)\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n        \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n    (\\<forall>f T.\n        Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n        trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n        T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))", "by auto"], ["proof (state)\nthis:\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 3. \\<And>x41 x42.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x =\n        \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "ultimately"], ["proof (chain)\npicking this:\n  set (dual\\<^sub>s\\<^sub>t (x # S)) =\n  insert x (set (dual\\<^sub>s\\<^sub>t S))\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))", "show ?thesis"], ["proof (prove)\nusing this:\n  set (dual\\<^sub>s\\<^sub>t (x # S)) =\n  insert x (set (dual\\<^sub>s\\<^sub>t S))\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))", "using Inequality IH"], ["proof (prove)\nusing this:\n  set (dual\\<^sub>s\\<^sub>t (x # S)) =\n  insert x (set (dual\\<^sub>s\\<^sub>t S))\n  (\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n      \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X))\n  x = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))", "by auto"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))\n 2. \\<And>x2.\n       \\<lbrakk>list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S \\<Longrightarrow>\n                list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                 (dual\\<^sub>s\\<^sub>t S);\n        list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (x # S);\n        x = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t\\<rbrakk>\n       \\<Longrightarrow> list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p\n                          (dual\\<^sub>s\\<^sub>t (x # S))", "qed auto"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t (x # S))\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p [] \\<Longrightarrow>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (dual\\<^sub>s\\<^sub>t [])", "qed simp"], ["", "lemma subst_var_inv_wt:\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst_var_inv \\<delta> X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst_var_inv \\<delta> X)", "using assms f_inv_into_f[of _ \\<delta> X]"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  ?y \\<in> \\<delta> ` X \\<Longrightarrow>\n  \\<delta> (inv_into X \\<delta> ?y) = ?y\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst_var_inv \\<delta> X)", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def subst_var_inv_def"], ["proof (prove)\nusing this:\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<delta> v)\n  ?y \\<in> \\<delta> ` X \\<Longrightarrow>\n  \\<delta> (inv_into X \\<delta> ?y) = ?y\n\ngoal (1 subgoal):\n 1. \\<forall>v.\n       \\<Gamma> (Var v) =\n       \\<Gamma>\n        (if Var v \\<in> \\<delta> ` X then Var (inv_into X \\<delta> (Var v))\n         else Var v)", "by presburger"], ["", "lemma subst_var_inv_wf_trms:\n  \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (subst_var_inv \\<delta> X))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (subst_range (subst_var_inv \\<delta> X))", "using f_inv_into_f[of _ \\<delta> X]"], ["proof (prove)\nusing this:\n  ?y \\<in> \\<delta> ` X \\<Longrightarrow>\n  \\<delta> (inv_into X \\<delta> ?y) = ?y\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (subst_range (subst_var_inv \\<delta> X))", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def subst_var_inv_def"], ["proof (prove)\nusing this:\n  ?y \\<in> \\<delta> ` X \\<Longrightarrow>\n  \\<delta> (inv_into X \\<delta> ?y) = ?y\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (subst_range\n       (\\<lambda>x.\n           if Var x \\<in> \\<delta> ` X\n           then Var (inv_into X \\<delta> (Var x)) else Var x))", "by auto"], ["", "lemma unify_list_wt_if_same_type:\n  assumes \"Unification.unify E B = Some U\" \"\\<forall>(s,t) \\<in> set E. wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\"\n  and \"\\<forall>(v,t) \\<in> set B. \\<Gamma> (Var v) = \\<Gamma> t\"\n  shows \"\\<forall>(v,t) \\<in> set U. \\<Gamma> (Var v) = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(v, t)\\<in>set U. \\<Gamma> (Var v) = \\<Gamma> t", "using assms"], ["proof (prove)\nusing this:\n  unify E B = Some U\n  \\<forall>(s, t)\\<in>set E.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>(v, t)\\<in>set B. \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(v, t)\\<in>set U. \\<Gamma> (Var v) = \\<Gamma> t", "proof (induction E B arbitrary: U rule: Unification.unify.induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>f ss g ts E bs U.\n       \\<lbrakk>\\<And>x2 U.\n                   \\<lbrakk>decompose (Fun f ss) (Fun g ts) = Some x2;\n                    unify (x2 @ E) bs = Some U;\n                    \\<forall>(s, t)\\<in>set (x2 @ E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun f ss, Fun g ts) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun f ss, Fun g ts) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 4. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "case (2 f X g Y E B U)"], ["proof (state)\nthis:\n  \\<lbrakk>decompose (Fun f X) (Fun g Y) = Some ?x2.2;\n   unify (?x2.2 @ E) B = Some ?U2;\n   \\<forall>a\\<in>set (?x2.2 @ E).\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set B.\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  unify ((Fun f X, Fun g Y) # E) B = Some U\n  \\<forall>a\\<in>set ((Fun f X, Fun g Y) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (4 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>f ss g ts E bs U.\n       \\<lbrakk>\\<And>x2 U.\n                   \\<lbrakk>decompose (Fun f ss) (Fun g ts) = Some x2;\n                    unify (x2 @ E) bs = Some U;\n                    \\<forall>(s, t)\\<in>set (x2 @ E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun f ss, Fun g ts) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun f ss, Fun g ts) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 4. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "hence \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g Y)\" \"\\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>decompose (Fun f X) (Fun g Y) = Some ?x2.2;\n   unify (?x2.2 @ E) B = Some ?U2;\n   \\<forall>a\\<in>set (?x2.2 @ E).\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set B.\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  unify ((Fun f X, Fun g Y) # E) B = Some U\n  \\<forall>a\\<in>set ((Fun f X, Fun g Y) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g Y) &&&\n    \\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g Y)\n  \\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\n\ngoal (4 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>f ss g ts E bs U.\n       \\<lbrakk>\\<And>x2 U.\n                   \\<lbrakk>decompose (Fun f ss) (Fun g ts) = Some x2;\n                    unify (x2 @ E) bs = Some U;\n                    \\<forall>(s, t)\\<in>set (x2 @ E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun f ss, Fun g ts) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun f ss, Fun g ts) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 4. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "from \"2.prems\"(1)"], ["proof (chain)\npicking this:\n  unify ((Fun f X, Fun g Y) # E) B = Some U", "obtain E' where *: \"decompose (Fun f X) (Fun g Y) = Some E'\"\n    and [simp]: \"f = g\" \"length X = length Y\" \"E' = zip X Y\"\n    and **: \"Unification.unify (E'@E) B = Some U\""], ["proof (prove)\nusing this:\n  unify ((Fun f X, Fun g Y) # E) B = Some U\n\ngoal (1 subgoal):\n 1. (\\<And>E'.\n        \\<lbrakk>decompose (Fun f X) (Fun g Y) = Some E'; f = g;\n         length X = length Y; E' = zip X Y;\n         unify (E' @ E) B = Some U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto split: option.splits)"], ["proof (state)\nthis:\n  decompose (Fun f X) (Fun g Y) = Some E'\n  f = g\n  length X = length Y\n  E' = zip X Y\n  unify (E' @ E) B = Some U\n\ngoal (4 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>f ss g ts E bs U.\n       \\<lbrakk>\\<And>x2 U.\n                   \\<lbrakk>decompose (Fun f ss) (Fun g ts) = Some x2;\n                    unify (x2 @ E) bs = Some U;\n                    \\<forall>(s, t)\\<in>set (x2 @ E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun f ss, Fun g ts) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun f ss, Fun g ts) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 4. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "have \"\\<forall>(s,t) \\<in> set E'. wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "fix s t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "assume \"(s,t) \\<in> set E'\""], ["proof (state)\nthis:\n  (s, t) \\<in> set E'\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "then"], ["proof (chain)\npicking this:\n  (s, t) \\<in> set E'", "obtain X' X'' Y' Y'' where \"X = X'@s#X''\" \"Y = Y'@t#Y''\" \"length X' = length Y'\""], ["proof (prove)\nusing this:\n  (s, t) \\<in> set E'\n\ngoal (1 subgoal):\n 1. (\\<And>X' X'' Y' Y''.\n        \\<lbrakk>X = X' @ s # X''; Y = Y' @ t # Y'';\n         length X' = length Y'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using zip_arg_subterm_split[of s t X Y] \\<open>E' = zip X Y\\<close>"], ["proof (prove)\nusing this:\n  (s, t) \\<in> set E'\n  \\<lbrakk>(s, t) \\<in> set (zip X Y);\n   \\<And>xs' xs'' ys' ys''.\n      \\<lbrakk>X = xs' @ s # xs''; Y = ys' @ t # ys'';\n       length xs' = length ys'\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n  E' = zip X Y\n\ngoal (1 subgoal):\n 1. (\\<And>X' X'' Y' Y''.\n        \\<lbrakk>X = X' @ s # X''; Y = Y' @ t # Y'';\n         length X' = length Y'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  X = X' @ s # X''\n  Y = Y' @ t # Y''\n  length X' = length Y'\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "hence \"\\<Gamma> (Fun f (X'@s#X'')) = \\<Gamma> (Fun g (Y'@t#Y''))\""], ["proof (prove)\nusing this:\n  X = X' @ s # X''\n  Y = Y' @ t # Y''\n  length X' = length Y'\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f (X' @ s # X'')) = \\<Gamma> (Fun g (Y' @ t # Y''))", "by (metis \\<open>\\<Gamma> (Fun f X) = \\<Gamma> (Fun g Y)\\<close>)"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f (X' @ s # X'')) = \\<Gamma> (Fun g (Y' @ t # Y''))\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "from \\<open>E' = zip X Y\\<close>"], ["proof (chain)\npicking this:\n  E' = zip X Y", "have \"\\<forall>(s,t) \\<in> set E'. s \\<sqsubset> Fun f X \\<and> t \\<sqsubset> Fun g Y\""], ["proof (prove)\nusing this:\n  E' = zip X Y\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       s \\<sqsubset> Fun f X \\<and> t \\<sqsubset> Fun g Y", "using zip_arg_subterm[of _ _ X Y]"], ["proof (prove)\nusing this:\n  E' = zip X Y\n  (?s, ?t) \\<in> set (zip X Y) \\<Longrightarrow> ?s \\<sqsubset> Fun ?f X\n  (?s, ?t) \\<in> set (zip X Y) \\<Longrightarrow> ?t \\<sqsubset> Fun ?g Y\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       s \\<sqsubset> Fun f X \\<and> t \\<sqsubset> Fun g Y", "by blast"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set E'.\n     s \\<sqsubset> Fun f X \\<and> t \\<sqsubset> Fun g Y\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "with \\<open>(s,t) \\<in> set E'\\<close>"], ["proof (chain)\npicking this:\n  (s, t) \\<in> set E'\n  \\<forall>(s, t)\\<in>set E'.\n     s \\<sqsubset> Fun f X \\<and> t \\<sqsubset> Fun g Y", "have \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\nusing this:\n  (s, t) \\<in> set E'\n  \\<forall>(s, t)\\<in>set E'.\n     s \\<sqsubset> Fun f X \\<and> t \\<sqsubset> Fun g Y\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m s &&& wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using wf_trm_subterm \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\\<close> \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g Y)\\<close>"], ["proof (prove)\nusing this:\n  (s, t) \\<in> set E'\n  \\<forall>(s, t)\\<in>set E'.\n     s \\<sqsubset> Fun f X \\<and> t \\<sqsubset> Fun g Y\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; ?s \\<sqsubset> ?t\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g Y)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m s &&& wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by (blast,blast)"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "moreover"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "have \"f \\<in> \\<Sigma>\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow> False", "assume \"f \\<notin> \\<Sigma>\\<^sub>f\""], ["proof (state)\nthis:\n  f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (1 subgoal):\n 1. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow> False", "hence \"f \\<in> \\<C>\" \"arity f = 0\""], ["proof (prove)\nusing this:\n  f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (1 subgoal):\n 1. f \\<in> \\<C> &&& arity f = 0", "using const_arity_eq_zero[of f]"], ["proof (prove)\nusing this:\n  f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C>\n  f \\<in> \\<C> \\<Longrightarrow> arity f = 0\n\ngoal (1 subgoal):\n 1. f \\<in> \\<C> &&& arity f = 0", "by simp_all"], ["proof (state)\nthis:\n  f \\<in> \\<C>\n  arity f = 0\n\ngoal (1 subgoal):\n 1. f \\<notin> \\<Union> (range \\<Sigma>n) - \\<C> \\<Longrightarrow> False", "thus False"], ["proof (prove)\nusing this:\n  f \\<in> \\<C>\n  arity f = 0\n\ngoal (1 subgoal):\n 1. False", "using \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\\<close> * \\<open>(s,t) \\<in> set E'\\<close>"], ["proof (prove)\nusing this:\n  f \\<in> \\<C>\n  arity f = 0\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\n  decompose (Fun f X) (Fun g Y) = Some E'\n  (s, t) \\<in> set E'\n\ngoal (1 subgoal):\n 1. False", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  f \\<in> \\<C>\n  arity f = 0\n  \\<forall>fa T.\n     Fun fa T \\<sqsubseteq> Fun f X \\<longrightarrow> length T = arity fa\n  decompose (Fun f X) (Fun g Y) = Some E'\n  (s, t) \\<in> set E'\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "hence \"\\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "using fun_type_arg_cong' \\<open>f \\<in> \\<Sigma>\\<^sub>f\\<close> \\<open>\\<Gamma> (Fun f (X'@s#X'')) = \\<Gamma> (Fun g (Y'@t#Y''))\\<close>\n              \\<open>length X' = length Y'\\<close> \\<open>f = g\\<close>"], ["proof (prove)\nusing this:\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<lbrakk>?f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   ?g \\<in> \\<Union> (range \\<Sigma>n) - \\<C>;\n   \\<Gamma> (Fun ?f (?X @ ?x # ?X')) = \\<Gamma> (Fun ?g (?Y @ ?y # ?Y'));\n   length ?X = length ?Y\\<rbrakk>\n  \\<Longrightarrow> \\<Gamma> ?x = \\<Gamma> ?y\n  f \\<in> \\<Union> (range \\<Sigma>n) - \\<C>\n  \\<Gamma> (Fun f (X' @ s # X'')) = \\<Gamma> (Fun g (Y' @ t # Y''))\n  length X' = length Y'\n  f = g\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "by metis"], ["proof (state)\nthis:\n  \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "ultimately"], ["proof (chain)\npicking this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> s = \\<Gamma> t", "have \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m s &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m t &&& \\<Gamma> s = \\<Gamma> t", "by metis+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "}"], ["proof (state)\nthis:\n  (?s4, ?t4) \\<in> set E' \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?s4\n  (?s4, ?t4) \\<in> set E' \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?t4\n  (?s4, ?t4) \\<in> set E' \\<Longrightarrow> \\<Gamma> ?s4 = \\<Gamma> ?t4\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "thus ?thesis"], ["proof (prove)\nusing this:\n  (?s4, ?t4) \\<in> set E' \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?s4\n  (?s4, ?t4) \\<in> set E' \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?t4\n  (?s4, ?t4) \\<in> set E' \\<Longrightarrow> \\<Gamma> ?s4 = \\<Gamma> ?t4\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E'.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "by blast"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set E'.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set E'.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (4 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>f ss g ts E bs U.\n       \\<lbrakk>\\<And>x2 U.\n                   \\<lbrakk>decompose (Fun f ss) (Fun g ts) = Some x2;\n                    unify (x2 @ E) bs = Some U;\n                    \\<forall>(s, t)\\<in>set (x2 @ E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun f ss, Fun g ts) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun f ss, Fun g ts) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 4. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "moreover"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set E'.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (4 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>f ss g ts E bs U.\n       \\<lbrakk>\\<And>x2 U.\n                   \\<lbrakk>decompose (Fun f ss) (Fun g ts) = Some x2;\n                    unify (x2 @ E) bs = Some U;\n                    \\<forall>(s, t)\\<in>set (x2 @ E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun f ss, Fun g ts) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun f ss, Fun g ts) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 4. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "have \"\\<forall>(s,t) \\<in> set E. wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "using \"2.prems\"(2)"], ["proof (prove)\nusing this:\n  \\<forall>a\\<in>set ((Fun f X, Fun g Y) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set E.\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "by auto"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set E.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (4 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>f ss g ts E bs U.\n       \\<lbrakk>\\<And>x2 U.\n                   \\<lbrakk>decompose (Fun f ss) (Fun g ts) = Some x2;\n                    unify (x2 @ E) bs = Some U;\n                    \\<forall>(s, t)\\<in>set (x2 @ E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun f ss, Fun g ts) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun f ss, Fun g ts) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 4. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>(s, t)\\<in>set E'.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>(s, t)\\<in>set E.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>(s, t)\\<in>set E'.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>(s, t)\\<in>set E.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "using \"2.IH\"[OF * ** _ \"2.prems\"(3)]"], ["proof (prove)\nusing this:\n  \\<forall>(s, t)\\<in>set E'.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>(s, t)\\<in>set E.\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set (E' @ E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n       \\<Gamma> s = \\<Gamma> t \\<Longrightarrow>\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "by fastforce"], ["proof (state)\nthis:\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (3 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "case (3 v t E B U)"], ["proof (state)\nthis:\n  \\<lbrakk>t = Var v; unify E B = Some ?U2;\n   \\<forall>a\\<in>set E.\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set B.\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  \\<lbrakk>t \\<noteq> Var v; v \\<notin> fv t;\n   unify (subst_list (subst v t) E) ((v, t) # B) = Some ?U2;\n   \\<forall>a\\<in>set (subst_list (subst v t) E).\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set ((v, t) # B).\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  unify ((Var v, t) # E) B = Some U\n  \\<forall>a\\<in>set ((Var v, t) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (3 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "hence \"\\<Gamma> (Var v) = \\<Gamma> t\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\nusing this:\n  \\<lbrakk>t = Var v; unify E B = Some ?U2;\n   \\<forall>a\\<in>set E.\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set B.\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  \\<lbrakk>t \\<noteq> Var v; v \\<notin> fv t;\n   unify (subst_list (subst v t) E) ((v, t) # B) = Some ?U2;\n   \\<forall>a\\<in>set (subst_list (subst v t) E).\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set ((v, t) # B).\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  unify ((Var v, t) # E) B = Some U\n  \\<forall>a\\<in>set ((Var v, t) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> t &&& wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Var v) = \\<Gamma> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (3 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "hence \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v t)\"\n      and *: \"\\<forall>(v, t) \\<in> set ((v,t)#B). \\<Gamma> (Var v) = \\<Gamma> t\"\n             \"\\<And>t t'. (t,t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t'\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v t) &&&\n    \\<forall>(v, t)\\<in>set ((v, t) # B). \\<Gamma> (Var v) = \\<Gamma> t &&&\n    (\\<And>t t'.\n        (t, t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t')", "using \"3.prems\"(2,3)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>a\\<in>set ((Var v, t) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v t) &&&\n    \\<forall>(v, t)\\<in>set ((v, t) # B). \\<Gamma> (Var v) = \\<Gamma> t &&&\n    (\\<And>t t'.\n        (t, t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t')", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def subst_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>a\\<in>set ((Var v, t) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>va. \\<Gamma> (Var va) = \\<Gamma> ((Var(v := t)) va) &&&\n    \\<forall>(v, t)\\<in>set ((v, t) # B). \\<Gamma> (Var v) = \\<Gamma> t &&&\n    (\\<And>t t'.\n        (t, t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t')", "by auto"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v t)\n  \\<forall>(v, t)\\<in>set ((v, t) # B). \\<Gamma> (Var v) = \\<Gamma> t\n  (?t2, ?t'2) \\<in> set E \\<Longrightarrow> \\<Gamma> ?t2 = \\<Gamma> ?t'2\n\ngoal (3 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>x t E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>t = Var x; unify E bs = Some U;\n                    \\<forall>(s, t)\\<in>set E.\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set bs.\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        \\<And>U.\n           \\<lbrakk>t \\<noteq> Var x; x \\<notin> fv t;\n            unify (subst_list (subst x t) E) ((x, t) # bs) = Some U;\n            \\<forall>(s, t)\\<in>set (subst_list (subst x t) E).\n               wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n            \\<forall>(v, t)\\<in>set ((x, t) # bs).\n               \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n           \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                                \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Var x, t) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Var x, t) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 3. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "proof (cases \"t = Var v\")"], ["proof (state)\ngoal (2 subgoals):\n 1. t = Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n 2. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "assume \"t = Var v\""], ["proof (state)\nthis:\n  t = Var v\n\ngoal (2 subgoals):\n 1. t = Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n 2. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "thus ?case"], ["proof (prove)\nusing this:\n  t = Var v\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "using 3"], ["proof (prove)\nusing this:\n  t = Var v\n  \\<lbrakk>t = Var v; unify E B = Some ?U2;\n   \\<forall>a\\<in>set E.\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set B.\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  \\<lbrakk>t \\<noteq> Var v; v \\<notin> fv t;\n   unify (subst_list (subst v t) E) ((v, t) # B) = Some ?U2;\n   \\<forall>a\\<in>set (subst_list (subst v t) E).\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set ((v, t) # B).\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  unify ((Var v, t) # E) B = Some U\n  \\<forall>a\\<in>set ((Var v, t) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "by auto"], ["proof (state)\nthis:\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "assume \"t \\<noteq> Var v\""], ["proof (state)\nthis:\n  t \\<noteq> Var v\n\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "hence \"v \\<notin> fv t\""], ["proof (prove)\nusing this:\n  t \\<noteq> Var v\n\ngoal (1 subgoal):\n 1. v \\<notin> fv t", "using \"3.prems\"(1)"], ["proof (prove)\nusing this:\n  t \\<noteq> Var v\n  unify ((Var v, t) # E) B = Some U\n\ngoal (1 subgoal):\n 1. v \\<notin> fv t", "by auto"], ["proof (state)\nthis:\n  v \\<notin> fv t\n\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "hence **: \"Unification.unify (subst_list (subst v t) E) ((v, t)#B) = Some U\""], ["proof (prove)\nusing this:\n  v \\<notin> fv t\n\ngoal (1 subgoal):\n 1. unify (subst_list (subst v t) E) ((v, t) # B) = Some U", "using Unification.unify.simps(3)[of v t E B] \"3.prems\"(1) \\<open>t \\<noteq> Var v\\<close>"], ["proof (prove)\nusing this:\n  v \\<notin> fv t\n  unify ((Var v, t) # E) B =\n  (if t = Var v then unify E B\n   else if v \\<in> fv t then None\n        else unify (subst_list (subst v t) E) ((v, t) # B))\n  unify ((Var v, t) # E) B = Some U\n  t \\<noteq> Var v\n\ngoal (1 subgoal):\n 1. unify (subst_list (subst v t) E) ((v, t) # B) = Some U", "by auto"], ["proof (state)\nthis:\n  unify (subst_list (subst v t) E) ((v, t) # B) = Some U\n\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "have \"\\<forall>(s, t) \\<in> set (subst_list (subst v t) E). wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using wf_trm_subst_singleton[OF _ \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m t\\<close>] \"3.prems\"(2)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (?t \\<cdot> Var(?v := t))\n  \\<forall>a\\<in>set ((Var v, t) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "unfolding subst_list_def subst_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (?t \\<cdot> Var(?v := t))\n  \\<forall>a\\<in>set ((Var v, t) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\n             \\<in>set (map (\\<lambda>p.\n                               (fst p \\<cdot> Var(v := t),\n                                snd p \\<cdot> Var(v := t)))\n                        E).\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by auto"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "moreover"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "have \"\\<forall>(s, t) \\<in> set (subst_list (subst v t) E). \\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n       \\<Gamma> s = \\<Gamma> t", "using *(2)[THEN wt_subst_trm'[OF \\<open>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v t)\\<close>]]"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> set E \\<Longrightarrow>\n  \\<Gamma> (?s \\<cdot> subst v t) = \\<Gamma> (?t \\<cdot> subst v t)\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n       \\<Gamma> s = \\<Gamma> t", "by (simp add: subst_list_def)"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. t \\<noteq> Var v \\<Longrightarrow>\n    \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     \\<Gamma> s = \\<Gamma> t", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "using \"3.IH\"(2)[OF \\<open>t \\<noteq> Var v\\<close> \\<open>v \\<notin> fv t\\<close> ** _ *(1)]"], ["proof (prove)\nusing this:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>(s, t)\\<in>set (subst_list (subst v t) E).\n     \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set (subst_list (subst v t) E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n       \\<Gamma> s = \\<Gamma> t \\<Longrightarrow>\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "by auto"], ["proof (state)\nthis:\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "case (4 f X v E B U)"], ["proof (state)\nthis:\n  \\<lbrakk>v \\<notin> fv (Fun f X);\n   unify (subst_list (subst v (Fun f X)) E) ((v, Fun f X) # B) = Some ?U2;\n   \\<forall>a\\<in>set (subst_list (subst v (Fun f X)) E).\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set ((v, Fun f X) # B).\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  unify ((Fun f X, Var v) # E) B = Some U\n  \\<forall>a\\<in>set ((Fun f X, Var v) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "hence \"\\<Gamma> (Var v) = \\<Gamma> (Fun f X)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>v \\<notin> fv (Fun f X);\n   unify (subst_list (subst v (Fun f X)) E) ((v, Fun f X) # B) = Some ?U2;\n   \\<forall>a\\<in>set (subst_list (subst v (Fun f X)) E).\n      case a of\n      (s, t) \\<Rightarrow>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>a\\<in>set ((v, Fun f X) # B).\n      case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>a\\<in>set ?U2.\n                       case a of\n                       (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  unify ((Fun f X, Var v) # E) B = Some U\n  \\<forall>a\\<in>set ((Fun f X, Var v) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> (Fun f X) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Var v) = \\<Gamma> (Fun f X)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "hence \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v (Fun f X))\"\n      and *: \"\\<forall>(v, t) \\<in> set ((v,(Fun f X))#B). \\<Gamma> (Var v) = \\<Gamma> t\"\n             \"\\<And>t t'. (t,t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t'\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> (Fun f X)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v (Fun f X)) &&&\n    \\<forall>(v, t)\\<in>set ((v, Fun f X) # B).\n       \\<Gamma> (Var v) = \\<Gamma> t &&&\n    (\\<And>t t'.\n        (t, t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t')", "using \"4.prems\"(2,3)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> (Fun f X)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\n  \\<forall>a\\<in>set ((Fun f X, Var v) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v (Fun f X)) &&&\n    \\<forall>(v, t)\\<in>set ((v, Fun f X) # B).\n       \\<Gamma> (Var v) = \\<Gamma> t &&&\n    (\\<And>t t'.\n        (t, t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t')", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def subst_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> (Fun f X)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\n  \\<forall>a\\<in>set ((Fun f X, Var v) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set B.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>va. \\<Gamma> (Var va) = \\<Gamma> ((Var(v := Fun f X)) va) &&&\n    \\<forall>(v, t)\\<in>set ((v, Fun f X) # B).\n       \\<Gamma> (Var v) = \\<Gamma> t &&&\n    (\\<And>t t'.\n        (t, t') \\<in> set E \\<Longrightarrow> \\<Gamma> t = \\<Gamma> t')", "by auto"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v (Fun f X))\n  \\<forall>(v, t)\\<in>set ((v, Fun f X) # B). \\<Gamma> (Var v) = \\<Gamma> t\n  (?t2, ?t'2) \\<in> set E \\<Longrightarrow> \\<Gamma> ?t2 = \\<Gamma> ?t'2\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "have \"v \\<notin> fv (Fun f X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v \\<notin> fv (Fun f X)", "using \"4.prems\"(1)"], ["proof (prove)\nusing this:\n  unify ((Fun f X, Var v) # E) B = Some U\n\ngoal (1 subgoal):\n 1. v \\<notin> fv (Fun f X)", "by force"], ["proof (state)\nthis:\n  v \\<notin> fv (Fun f X)\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "hence **: \"Unification.unify (subst_list (subst v (Fun f X)) E) ((v, (Fun f X))#B) = Some U\""], ["proof (prove)\nusing this:\n  v \\<notin> fv (Fun f X)\n\ngoal (1 subgoal):\n 1. unify (subst_list (subst v (Fun f X)) E) ((v, Fun f X) # B) = Some U", "using Unification.unify.simps(3)[of v \"Fun f X\" E B] \"4.prems\"(1)"], ["proof (prove)\nusing this:\n  v \\<notin> fv (Fun f X)\n  unify ((Var v, Fun f X) # E) B =\n  (if Fun f X = Var v then unify E B\n   else if v \\<in> fv (Fun f X) then None\n        else unify (subst_list (subst v (Fun f X)) E) ((v, Fun f X) # B))\n  unify ((Fun f X, Var v) # E) B = Some U\n\ngoal (1 subgoal):\n 1. unify (subst_list (subst v (Fun f X)) E) ((v, Fun f X) # B) = Some U", "by auto"], ["proof (state)\nthis:\n  unify (subst_list (subst v (Fun f X)) E) ((v, Fun f X) # B) = Some U\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "have \"\\<forall>(s, t) \\<in> set (subst_list (subst v (Fun f X)) E). wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using wf_trm_subst_singleton[OF _ \\<open>wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun f X)\\<close>] \"4.prems\"(2)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (?t \\<cdot> Var(?v := Fun f X))\n  \\<forall>a\\<in>set ((Fun f X, Var v) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "unfolding subst_list_def subst_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (?t \\<cdot> Var(?v := Fun f X))\n  \\<forall>a\\<in>set ((Fun f X, Var v) # E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\n             \\<in>set (map (\\<lambda>p.\n                               (fst p \\<cdot> Var(v := Fun f X),\n                                snd p \\<cdot> Var(v := Fun f X)))\n                        E).\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by auto"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "moreover"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "have \"\\<forall>(s, t) \\<in> set (subst_list (subst v (Fun f X)) E). \\<Gamma> s = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n       \\<Gamma> s = \\<Gamma> t", "using *(2)[THEN wt_subst_trm'[OF \\<open>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (subst v (Fun f X))\\<close>]]"], ["proof (prove)\nusing this:\n  (?s, ?t) \\<in> set E \\<Longrightarrow>\n  \\<Gamma> (?s \\<cdot> subst v (Fun f X)) =\n  \\<Gamma> (?t \\<cdot> subst v (Fun f X))\n\ngoal (1 subgoal):\n 1. \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n       \\<Gamma> s = \\<Gamma> t", "by (simp add: subst_list_def)"], ["proof (state)\nthis:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     \\<Gamma> s = \\<Gamma> t\n\ngoal (2 subgoals):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t\n 2. \\<And>v va x E bs U.\n       \\<lbrakk>\\<And>U.\n                   \\<lbrakk>x \\<notin> fv (Fun v va);\n                    unify (subst_list (subst x (Fun v va)) E)\n                     ((x, Fun v va) # bs) =\n                    Some U;\n                    \\<forall>(s, t)\n                             \\<in>set (subst_list (subst x (Fun v va)) E).\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n                       \\<Gamma> s = \\<Gamma> t;\n                    \\<forall>(v, t)\\<in>set ((x, Fun v va) # bs).\n                       \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n  \\<Gamma> (Var v) = \\<Gamma> t;\n        unify ((Fun v va, Var x) # E) bs = Some U;\n        \\<forall>(s, t)\\<in>set ((Fun v va, Var x) # E).\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     \\<Gamma> s = \\<Gamma> t", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "using \"4.IH\"[OF \\<open>v \\<notin> fv (Fun f X)\\<close> ** _ *(1)]"], ["proof (prove)\nusing this:\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<forall>(s, t)\\<in>set (subst_list (subst v (Fun f X)) E).\n     \\<Gamma> s = \\<Gamma> t\n  \\<forall>a\\<in>set (subst_list (subst v (Fun f X)) E).\n     case a of\n     (s, t) \\<Rightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and>\n       \\<Gamma> s = \\<Gamma> t \\<Longrightarrow>\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>set U.\n       case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t", "by auto"], ["proof (state)\nthis:\n  \\<forall>a\\<in>set U.\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<And>bs U.\n       \\<lbrakk>unify [] bs = Some U;\n        \\<forall>(s, t)\\<in>set [].\n           wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n        \\<forall>(v, t)\\<in>set bs. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>(v, t)\\<in>set U.\n                            \\<Gamma> (Var v) = \\<Gamma> t", "qed auto"], ["", "lemma mgu_wt_if_same_type:\n  assumes \"mgu s t = Some \\<sigma>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> s = \\<Gamma> t\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>", "let ?fv_disj = \"\\<lambda>v t S. \\<not>(\\<exists>(v',t') \\<in> S - {(v,t)}. (insert v (fv t)) \\<inter> (insert v' (fv t')) \\<noteq> {})\""], ["proof (state)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>", "from assms(1)"], ["proof (chain)\npicking this:\n  mgu s t = Some \\<sigma>", "obtain \\<sigma>' where \"Unification.unify [(s,t)] [] = Some \\<sigma>'\" \"subst_of \\<sigma>' = \\<sigma>\""], ["proof (prove)\nusing this:\n  mgu s t = Some \\<sigma>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma>'.\n        \\<lbrakk>unify [(s, t)] [] = Some \\<sigma>';\n         subst_of \\<sigma>' = \\<sigma>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto split: option.splits)"], ["proof (state)\nthis:\n  unify [(s, t)] [] = Some \\<sigma>'\n  subst_of \\<sigma>' = \\<sigma>\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>", "hence \"\\<forall>(v,t) \\<in> set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\" \"distinct (map fst \\<sigma>')\""], ["proof (prove)\nusing this:\n  unify [(s, t)] [] = Some \\<sigma>'\n  subst_of \\<sigma>' = \\<sigma>\n\ngoal (1 subgoal):\n 1. \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t &&&\n    distinct (map fst \\<sigma>')", "using assms(2,3,4) unify_list_wt_if_same_type unify_list_distinct[of \"[(s,t)]\"]"], ["proof (prove)\nusing this:\n  unify [(s, t)] [] = Some \\<sigma>'\n  subst_of \\<sigma>' = \\<sigma>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<Gamma> s = \\<Gamma> t\n  \\<lbrakk>unify ?E ?B = Some ?U;\n   \\<forall>(s, t)\\<in>set ?E.\n      wf\\<^sub>t\\<^sub>r\\<^sub>m s \\<and>\n      wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<and> \\<Gamma> s = \\<Gamma> t;\n   \\<forall>(v, t)\\<in>set ?B. \\<Gamma> (Var v) = \\<Gamma> t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>(v, t)\\<in>set ?U.\n                       \\<Gamma> (Var v) = \\<Gamma> t\n  \\<lbrakk>unify [(s, t)] ?B = Some ?U; distinct (map fst ?B);\n   (\\<Union>x\\<in>set [(s, t)]. fv (fst x) \\<union> fv (snd x)) \\<inter>\n   set (map fst ?B) =\n   {}\\<rbrakk>\n  \\<Longrightarrow> distinct (map fst ?U)\n\ngoal (1 subgoal):\n 1. \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t &&&\n    distinct (map fst \\<sigma>')", "by auto"], ["proof (state)\nthis:\n  \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst \\<sigma>')\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>", "thus \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\""], ["proof (prove)\nusing this:\n  \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst \\<sigma>')\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>", "using \\<open>subst_of \\<sigma>' = \\<sigma>\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst \\<sigma>')\n  subst_of \\<sigma>' = \\<sigma>\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst \\<sigma>')\n  subst_of \\<sigma>' = \\<sigma>\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "proof (induction \\<sigma>' arbitrary: \\<sigma> rule: List.rev_induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "case (snoc tt \\<sigma>' \\<sigma>)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<forall>a\\<in>set \\<sigma>'.\n              case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t;\n   distinct (map fst \\<sigma>'); subst_of \\<sigma>' = ?\\<sigma>3\\<rbrakk>\n  \\<Longrightarrow> \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (?\\<sigma>3 v)\n  \\<forall>a\\<in>set (\\<sigma>' @ [tt]).\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst (\\<sigma>' @ [tt]))\n  subst_of (\\<sigma>' @ [tt]) = \\<sigma>\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<forall>a\\<in>set \\<sigma>'.\n              case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t;\n   distinct (map fst \\<sigma>'); subst_of \\<sigma>' = ?\\<sigma>3\\<rbrakk>\n  \\<Longrightarrow> \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (?\\<sigma>3 v)\n  \\<forall>a\\<in>set (\\<sigma>' @ [tt]).\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst (\\<sigma>' @ [tt]))\n  subst_of (\\<sigma>' @ [tt]) = \\<sigma>", "obtain v t where tt: \"tt = (v,t)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<forall>a\\<in>set \\<sigma>'.\n              case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t;\n   distinct (map fst \\<sigma>'); subst_of \\<sigma>' = ?\\<sigma>3\\<rbrakk>\n  \\<Longrightarrow> \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (?\\<sigma>3 v)\n  \\<forall>a\\<in>set (\\<sigma>' @ [tt]).\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst (\\<sigma>' @ [tt]))\n  subst_of (\\<sigma>' @ [tt]) = \\<sigma>\n\ngoal (1 subgoal):\n 1. (\\<And>v t. tt = (v, t) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis surj_pair)"], ["proof (state)\nthis:\n  tt = (v, t)\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "hence \\<sigma>: \"\\<sigma> = subst v t \\<circ>\\<^sub>s subst_of \\<sigma>'\""], ["proof (prove)\nusing this:\n  tt = (v, t)\n\ngoal (1 subgoal):\n 1. \\<sigma> = subst v t \\<circ>\\<^sub>s subst_of \\<sigma>'", "using snoc.prems(3)"], ["proof (prove)\nusing this:\n  tt = (v, t)\n  subst_of (\\<sigma>' @ [tt]) = \\<sigma>\n\ngoal (1 subgoal):\n 1. \\<sigma> = subst v t \\<circ>\\<^sub>s subst_of \\<sigma>'", "by simp"], ["proof (state)\nthis:\n  \\<sigma> = subst v t \\<circ>\\<^sub>s subst_of \\<sigma>'\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "have \"\\<forall>(v,t) \\<in> set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\" \"distinct (map fst \\<sigma>')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t &&&\n    distinct (map fst \\<sigma>')", "using snoc.prems(1,2)"], ["proof (prove)\nusing this:\n  \\<forall>a\\<in>set (\\<sigma>' @ [tt]).\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst (\\<sigma>' @ [tt]))\n\ngoal (1 subgoal):\n 1. \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t &&&\n    distinct (map fst \\<sigma>')", "by auto"], ["proof (state)\nthis:\n  \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst \\<sigma>')\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "then"], ["proof (chain)\npicking this:\n  \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst \\<sigma>')", "obtain \\<sigma>'' where \\<sigma>'': \"subst_of \\<sigma>' = \\<sigma>''\" \"\\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\""], ["proof (prove)\nusing this:\n  \\<forall>(v, t)\\<in>set \\<sigma>'. \\<Gamma> (Var v) = \\<Gamma> t\n  distinct (map fst \\<sigma>')\n\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma>'''.\n        \\<lbrakk>subst_of \\<sigma>' = \\<sigma>''';\n         \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>''' v)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis snoc.IH)"], ["proof (state)\nthis:\n  subst_of \\<sigma>' = \\<sigma>''\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "hence \"\\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')\" for t"], ["proof (prove)\nusing this:\n  subst_of \\<sigma>' = \\<sigma>''\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n\ngoal (1 subgoal):\n 1. \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')", "using wt_subst_trm"], ["proof (prove)\nusing this:\n  subst_of \\<sigma>' = \\<sigma>''\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n  (\\<And>v.\n      v \\<in> fv ?t \\<Longrightarrow>\n      \\<Gamma> (Var v) = \\<Gamma> (?\\<theta> v)) \\<Longrightarrow>\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> ?\\<theta>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')", "by blast"], ["proof (state)\nthis:\n  \\<Gamma> ?t3 = \\<Gamma> (?t3 \\<cdot> \\<sigma>'')\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "hence \"\\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\" \"\\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')\""], ["proof (prove)\nusing this:\n  \\<Gamma> ?t3 = \\<Gamma> (?t3 \\<cdot> \\<sigma>'')\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v) &&&\n    \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')", "using \\<sigma>''(2)"], ["proof (prove)\nusing this:\n  \\<Gamma> ?t3 = \\<Gamma> (?t3 \\<cdot> \\<sigma>'')\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v) &&&\n    \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n  \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "moreover"], ["proof (state)\nthis:\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n  \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "have \"\\<Gamma> (Var v) = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> t", "using snoc.prems(1) tt"], ["proof (prove)\nusing this:\n  \\<forall>a\\<in>set (\\<sigma>' @ [tt]).\n     case a of (v, t) \\<Rightarrow> \\<Gamma> (Var v) = \\<Gamma> t\n  tt = (v, t)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> t", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "moreover"], ["proof (state)\nthis:\n  \\<Gamma> (Var v) = \\<Gamma> t\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "have \\<sigma>2: \"\\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>'' \""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>''", "using \\<sigma> \\<sigma>''(1)"], ["proof (prove)\nusing this:\n  \\<sigma> = subst v t \\<circ>\\<^sub>s subst_of \\<sigma>'\n  subst_of \\<sigma>' = \\<sigma>''\n\ngoal (1 subgoal):\n 1. \\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>''", "unfolding subst_def"], ["proof (prove)\nusing this:\n  \\<sigma> = Var(v := t) \\<circ>\\<^sub>s subst_of \\<sigma>'\n  subst_of \\<sigma>' = \\<sigma>''\n\ngoal (1 subgoal):\n 1. \\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>''", "by simp"], ["proof (state)\nthis:\n  \\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>''\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "ultimately"], ["proof (chain)\npicking this:\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n  \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')\n  \\<Gamma> (Var v) = \\<Gamma> t\n  \\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>''", "have \"\\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n  \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')\n  \\<Gamma> (Var v) = \\<Gamma> t\n  \\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>''\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "unfolding subst_compose_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n  \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<sigma>'')\n  \\<Gamma> (Var v) = \\<Gamma> t\n  \\<sigma> = (\\<lambda>x. (Var(v := t)) x \\<cdot> \\<sigma>'')\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "have \"subst_domain (subst v t) \\<subseteq> {v}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subst_domain (subst v t) \\<subseteq> {v}", "unfolding subst_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. subst_domain (Var(v := t)) \\<subseteq> {v}", "by (auto simp add: subst_domain_def)"], ["proof (state)\nthis:\n  subst_domain (subst v t) \\<subseteq> {v}\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "hence *: \"subst_domain \\<sigma> \\<subseteq> insert v (subst_domain \\<sigma>'')\""], ["proof (prove)\nusing this:\n  subst_domain (subst v t) \\<subseteq> {v}\n\ngoal (1 subgoal):\n 1. subst_domain \\<sigma> \\<subseteq> insert v (subst_domain \\<sigma>'')", "using tt \\<sigma> \\<sigma>''(1) snoc.prems(2) subst_domain_compose[of _ \\<sigma>'']"], ["proof (prove)\nusing this:\n  subst_domain (subst v t) \\<subseteq> {v}\n  tt = (v, t)\n  \\<sigma> = subst v t \\<circ>\\<^sub>s subst_of \\<sigma>'\n  subst_of \\<sigma>' = \\<sigma>''\n  distinct (map fst (\\<sigma>' @ [tt]))\n  subst_domain (?\\<sigma> \\<circ>\\<^sub>s \\<sigma>'')\n  \\<subseteq> subst_domain ?\\<sigma> \\<union> subst_domain \\<sigma>''\n\ngoal (1 subgoal):\n 1. subst_domain \\<sigma> \\<subseteq> insert v (subst_domain \\<sigma>'')", "by (auto simp add: subst_domain_def)"], ["proof (state)\nthis:\n  subst_domain \\<sigma> \\<subseteq> insert v (subst_domain \\<sigma>'')\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "have \"v \\<notin> set (map fst \\<sigma>')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v \\<notin> set (map fst \\<sigma>')", "using tt snoc.prems(2)"], ["proof (prove)\nusing this:\n  tt = (v, t)\n  distinct (map fst (\\<sigma>' @ [tt]))\n\ngoal (1 subgoal):\n 1. v \\<notin> set (map fst \\<sigma>')", "by auto"], ["proof (state)\nthis:\n  v \\<notin> set (map fst \\<sigma>')\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "hence \"v \\<notin> subst_domain \\<sigma>''\""], ["proof (prove)\nusing this:\n  v \\<notin> set (map fst \\<sigma>')\n\ngoal (1 subgoal):\n 1. v \\<notin> subst_domain \\<sigma>''", "using \\<sigma>''(1) subst_of_dom_subset[of \\<sigma>']"], ["proof (prove)\nusing this:\n  v \\<notin> set (map fst \\<sigma>')\n  subst_of \\<sigma>' = \\<sigma>''\n  subst_domain (subst_of \\<sigma>') \\<subseteq> set (map fst \\<sigma>')\n\ngoal (1 subgoal):\n 1. v \\<notin> subst_domain \\<sigma>''", "by auto"], ["proof (state)\nthis:\n  v \\<notin> subst_domain \\<sigma>''\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "{"], ["proof (state)\nthis:\n  v \\<notin> subst_domain \\<sigma>''\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "fix w"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "assume \"w \\<in> subst_domain \\<sigma>''\""], ["proof (state)\nthis:\n  w \\<in> subst_domain \\<sigma>''\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "hence \"\\<sigma> w = \\<sigma>'' w\""], ["proof (prove)\nusing this:\n  w \\<in> subst_domain \\<sigma>''\n\ngoal (1 subgoal):\n 1. \\<sigma> w = \\<sigma>'' w", "using \\<sigma>2 \\<sigma>''(1) \\<open>v \\<notin> subst_domain \\<sigma>''\\<close>"], ["proof (prove)\nusing this:\n  w \\<in> subst_domain \\<sigma>''\n  \\<sigma> = Var(v := t) \\<circ>\\<^sub>s \\<sigma>''\n  subst_of \\<sigma>' = \\<sigma>''\n  v \\<notin> subst_domain \\<sigma>''\n\ngoal (1 subgoal):\n 1. \\<sigma> w = \\<sigma>'' w", "unfolding subst_compose_def"], ["proof (prove)\nusing this:\n  w \\<in> subst_domain \\<sigma>''\n  \\<sigma> = (\\<lambda>x. (Var(v := t)) x \\<cdot> \\<sigma>'')\n  subst_of \\<sigma>' = \\<sigma>''\n  v \\<notin> subst_domain \\<sigma>''\n\ngoal (1 subgoal):\n 1. \\<sigma> w = \\<sigma>'' w", "by auto"], ["proof (state)\nthis:\n  \\<sigma> w = \\<sigma>'' w\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "hence \"\\<Gamma> (Var w) = \\<Gamma> (\\<sigma> w)\""], ["proof (prove)\nusing this:\n  \\<sigma> w = \\<sigma>'' w\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var w) = \\<Gamma> (\\<sigma> w)", "using \\<sigma>''(2)"], ["proof (prove)\nusing this:\n  \\<sigma> w = \\<sigma>'' w\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma>'' v)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var w) = \\<Gamma> (\\<sigma> w)", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> (Var w) = \\<Gamma> (\\<sigma> w)\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "}"], ["proof (state)\nthis:\n  ?w5 \\<in> subst_domain \\<sigma>'' \\<Longrightarrow>\n  \\<Gamma> (Var ?w5) = \\<Gamma> (\\<sigma> ?w5)\n\ngoal (2 subgoals):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n 2. \\<And>x xs \\<sigma>.\n       \\<lbrakk>\\<And>\\<sigma>.\n                   \\<lbrakk>\\<forall>(v, t)\\<in>set xs.\n                               \\<Gamma> (Var v) = \\<Gamma> t;\n                    distinct (map fst xs); subst_of xs = \\<sigma>\\<rbrakk>\n                   \\<Longrightarrow> \\<forall>v.\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v);\n        \\<forall>(v, t)\\<in>set (xs @ [x]). \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst (xs @ [x]));\n        subst_of (xs @ [x]) = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "thus ?case"], ["proof (prove)\nusing this:\n  ?w5 \\<in> subst_domain \\<sigma>'' \\<Longrightarrow>\n  \\<Gamma> (Var ?w5) = \\<Gamma> (\\<sigma> ?w5)\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "using \\<open>\\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\\<close> *"], ["proof (prove)\nusing this:\n  ?w5 \\<in> subst_domain \\<sigma>'' \\<Longrightarrow>\n  \\<Gamma> (Var ?w5) = \\<Gamma> (\\<sigma> ?w5)\n  \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n  subst_domain \\<sigma> \\<subseteq> insert v (subst_domain \\<sigma>'')\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "by force"], ["proof (state)\nthis:\n  \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)\n\ngoal (1 subgoal):\n 1. \\<And>\\<sigma>.\n       \\<lbrakk>\\<forall>(v, t)\\<in>set []. \\<Gamma> (Var v) = \\<Gamma> t;\n        distinct (map fst []); subst_of [] = \\<sigma>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v.\n                            \\<Gamma> (Var v) = \\<Gamma> (\\<sigma> v)", "qed simp"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wt_Unifier_if_Unifier:\n  assumes s_t: \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"\\<Gamma> s = \\<Gamma> t\"\n    and \\<delta>: \"Unifier \\<delta> s t\"\n  shows \"\\<exists>\\<theta>. Unifier \\<theta> s t \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       Unifier \\<theta> s t \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)", "using mgu_always_unifies[OF \\<delta>] mgu_gives_MGU[THEN MGU_is_Unifier[of s _ t]]\n      mgu_wt_if_same_type[OF _ s_t] mgu_wf_trm[OF _ s_t(1,2)] wf_trm_subst_range_iff"], ["proof (prove)\nusing this:\n  \\<exists>\\<delta>. mgu s t = Some \\<delta>\n  mgu s t = Some ?\\<sigma> \\<Longrightarrow> Unifier ?\\<sigma> s t\n  mgu s t = Some ?\\<sigma> \\<Longrightarrow>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<sigma>\n  mgu s t = Some ?\\<sigma> \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<sigma> ?v)\n  (\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<theta> x)) =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<theta>)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       Unifier \\<theta> s t \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)", "by fast"], ["", "end"], ["", "subsection \\<open>Automatically Proving Type-Flaw Resistance\\<close>"], ["", "subsubsection \\<open>Definitions: Variable Renaming\\<close>"], ["", "abbreviation \"max_var t \\<equiv> Max (insert 0 (snd ` fv t))\""], ["", "abbreviation \"max_var_set X \\<equiv> Max (insert 0 (snd ` X))\""], ["", "definition \"var_rename n v \\<equiv> Var (fst v, snd v + Suc n)\""], ["", "definition \"var_rename_inv n v \\<equiv> Var (fst v, snd v - Suc n)\""], ["", "subsubsection \\<open>Definitions: Computing a Finite Representation of the Sub-Message Patterns\\<close>"], ["", "text \\<open>A sufficient requirement for a term to be a well-typed instance of another term\\<close>"], ["", "definition is_wt_instance_of_cond where\n  \"is_wt_instance_of_cond \\<Gamma> t s \\<equiv> (\n    \\<Gamma> t = \\<Gamma> s \\<and> (case mgu t s of\n      None \\<Rightarrow> False\n    | Some \\<delta> \\<Rightarrow> inj_on \\<delta> (fv t) \\<and> (\\<forall>x \\<in> fv t. is_Var (\\<delta> x))))\""], ["", "definition has_all_wt_instances_of where\n  \"has_all_wt_instances_of \\<Gamma> N M \\<equiv> \\<forall>t \\<in> N. \\<exists>s \\<in> M. is_wt_instance_of_cond \\<Gamma> t s\""], ["", "text \\<open>This function computes a finite representation of the set of sub-message patterns\\<close>"], ["", "definition SMP0 where\n  \"SMP0 Ana \\<Gamma> M \\<equiv> let\n      f = \\<lambda>t. Fun (the_Fun (\\<Gamma> t)) (map Var (zip (args (\\<Gamma> t)) [0..<length (args (\\<Gamma> t))]));\n      g = \\<lambda>M'. map f (filter (\\<lambda>t. is_Var t \\<and> is_Fun (\\<Gamma> t)) M')@\n               concat (map (fst \\<circ> Ana) M')@concat (map subterms_list M');\n      h = remdups \\<circ> g\n    in while (\\<lambda>A. set (h A) \\<noteq> set A) h M\""], ["", "text \\<open>These definitions are useful to refine an SMP representation set\\<close>"], ["", "fun generalize_term where\n  \"generalize_term _ _ n (Var x) = (Var x, n)\"\n| \"generalize_term \\<Gamma> p n (Fun f T) = (let \\<tau> = \\<Gamma> (Fun f T)\n    in if p \\<tau> then (Var (\\<tau>, n), Suc n)\n       else let (T',n') = foldr (\\<lambda>t (S,m). let (t',m') = generalize_term \\<Gamma> p m t in (t'#S,m'))\n                                T ([],n)\n            in (Fun f T', n'))\""], ["", "definition generalize_terms where\n  \"generalize_terms \\<Gamma> p \\<equiv> map (fst \\<circ> generalize_term \\<Gamma> p 0)\""], ["", "definition remove_superfluous_terms where\n  \"remove_superfluous_terms \\<Gamma> T \\<equiv>\n    let\n      f = \\<lambda>S t R. \\<exists>s \\<in> set S - R. s \\<noteq> t \\<and> is_wt_instance_of_cond \\<Gamma> t s;\n      g = \\<lambda>S t (U,R). if f S t R then (U, insert t R) else (t#U, R);\n      h = \\<lambda>S. remdups (fst (foldr (g S) S ([],{})))\n    in while (\\<lambda>S. h S \\<noteq> S) h T\""], ["", "subsubsection \\<open>Definitions: Checking Type-Flaw Resistance\\<close>"], ["", "definition is_TComp_var_instance_closed where\n  \"is_TComp_var_instance_closed \\<Gamma> M \\<equiv> \\<forall>x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). is_Fun (\\<Gamma> (Var x)) \\<longrightarrow>\n      list_ex (\\<lambda>t. is_Fun t \\<and> \\<Gamma> t = \\<Gamma> (Var x) \\<and> list_all is_Var (args t) \\<and> distinct (args t)) M\""], ["", "definition finite_SMP_representation where\n  \"finite_SMP_representation arity Ana \\<Gamma> M \\<equiv>\n    list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) M \\<and>\n    has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) \\<and>\n    has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) \\<and>\n    is_TComp_var_instance_closed \\<Gamma> M\""], ["", "definition comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t where\n  \"comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M \\<equiv>\n    finite_SMP_representation arity Ana \\<Gamma> M \\<and>\n    (let \\<delta> = var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)))\n     in \\<forall>s \\<in> set M. \\<forall>t \\<in> set M. is_Fun s \\<and> is_Fun t \\<and> \\<Gamma> s \\<noteq> \\<Gamma> t \\<longrightarrow> mgu s (t \\<cdot> \\<delta>) = None)\""], ["", "fun comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p where\n  \"comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> (\\<langle>_: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t) = (mgu t t' \\<noteq> None \\<longrightarrow> \\<Gamma> t = \\<Gamma> t')\"\n| \"comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> (\\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t) = (\n    (\\<forall>x \\<in> fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X. is_Var (\\<Gamma> (Var x))) \\<or>\n    (\\<forall>u \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F).\n      is_Fun u \\<longrightarrow> (args u = [] \\<or> (\\<exists>s \\<in> set (args u). s \\<notin> Var ` set X))))\"\n| \"comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p _ _ = True\""], ["", "definition comp_tfr\\<^sub>s\\<^sub>t where\n  \"comp_tfr\\<^sub>s\\<^sub>t arity Ana \\<Gamma> M S \\<equiv>\n    list_all (comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>) S \\<and>\n    list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) (trms_list\\<^sub>s\\<^sub>t S) \\<and>\n    has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M) \\<and>\n    comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\""], ["", "subsubsection \\<open>Small Lemmata\\<close>"], ["", "lemma less_Suc_max_var_set:\n  assumes z: \"z \\<in> X\"\n    and X: \"finite X\"\n  shows \"snd z < Suc (max_var_set X)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. snd z < Suc (max_var_set X)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. snd z < Suc (max_var_set X)", "have \"snd z \\<in> snd ` X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. snd z \\<in> snd ` X", "using z"], ["proof (prove)\nusing this:\n  z \\<in> X\n\ngoal (1 subgoal):\n 1. snd z \\<in> snd ` X", "by simp"], ["proof (state)\nthis:\n  snd z \\<in> snd ` X\n\ngoal (1 subgoal):\n 1. snd z < Suc (max_var_set X)", "hence \"snd z \\<le> Max (insert 0 (snd ` X))\""], ["proof (prove)\nusing this:\n  snd z \\<in> snd ` X\n\ngoal (1 subgoal):\n 1. snd z \\<le> max_var_set X", "using X"], ["proof (prove)\nusing this:\n  snd z \\<in> snd ` X\n  finite X\n\ngoal (1 subgoal):\n 1. snd z \\<le> max_var_set X", "by simp"], ["proof (state)\nthis:\n  snd z \\<le> max_var_set X\n\ngoal (1 subgoal):\n 1. snd z < Suc (max_var_set X)", "thus ?thesis"], ["proof (prove)\nusing this:\n  snd z \\<le> max_var_set X\n\ngoal (1 subgoal):\n 1. snd z < Suc (max_var_set X)", "using X"], ["proof (prove)\nusing this:\n  snd z \\<le> max_var_set X\n  finite X\n\ngoal (1 subgoal):\n 1. snd z < Suc (max_var_set X)", "by simp"], ["proof (state)\nthis:\n  snd z < Suc (max_var_set X)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in typed_model) finite_SMP_representationD:\n  assumes \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n    and \"has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\"\n    and \"is_TComp_var_instance_closed \\<Gamma> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     has_all_wt_instances_of \\<Gamma>\n      (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "using assms"], ["proof (prove)\nusing this:\n  finite_SMP_representation arity Ana \\<Gamma> M\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     has_all_wt_instances_of \\<Gamma>\n      (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "unfolding finite_SMP_representation_def list_all_iff wf\\<^sub>t\\<^sub>r\\<^sub>m_code"], ["proof (prove)\nusing this:\n  Ball (set M) (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) \\<and>\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. (\\<forall>t\\<in>set M. wf\\<^sub>t\\<^sub>r\\<^sub>m' arity t &&&\n     has_all_wt_instances_of \\<Gamma>\n      (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "by blast+"], ["", "lemma (in typed_model) is_wt_instance_of_condD:\n  assumes t_instance_s: \"is_wt_instance_of_cond \\<Gamma> t s\"\n  obtains \\<delta> where\n    \"\\<Gamma> t = \\<Gamma> s\" \"mgu t s = Some \\<delta>\"\n    \"inj_on \\<delta> (fv t)\" \"\\<delta> ` (fv t) \\<subseteq> range Var\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<delta>.\n        \\<lbrakk>\\<Gamma> t = \\<Gamma> s; mgu t s = Some \\<delta>;\n         inj_on \\<delta> (fv t);\n         \\<delta> ` fv t \\<subseteq> range Var\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using t_instance_s"], ["proof (prove)\nusing this:\n  is_wt_instance_of_cond \\<Gamma> t s\n\ngoal (1 subgoal):\n 1. (\\<And>\\<delta>.\n        \\<lbrakk>\\<Gamma> t = \\<Gamma> s; mgu t s = Some \\<delta>;\n         inj_on \\<delta> (fv t);\n         \\<delta> ` fv t \\<subseteq> range Var\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding is_wt_instance_of_cond_def Let_def"], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<Gamma> s \\<and>\n  (case mgu t s of None \\<Rightarrow> False\n   | Some \\<delta> \\<Rightarrow>\n       inj_on \\<delta> (fv t) \\<and>\n       (\\<forall>x\\<in>fv t. is_Var (\\<delta> x)))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<delta>.\n        \\<lbrakk>\\<Gamma> t = \\<Gamma> s; mgu t s = Some \\<delta>;\n         inj_on \\<delta> (fv t);\n         \\<delta> ` fv t \\<subseteq> range Var\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases \"mgu t s\") fastforce+"], ["", "lemma (in typed_model) is_wt_instance_of_condD':\n  assumes t_wf_trm: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\"\n    and s_wf_trm: \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\"\n    and t_instance_s: \"is_wt_instance_of_cond \\<Gamma> t s\"\n  shows \"\\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = s \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "obtain \\<delta> where s:\n      \"\\<Gamma> t = \\<Gamma> s\" \"mgu t s = Some \\<delta>\"\n      \"inj_on \\<delta> (fv t)\" \"\\<delta> ` (fv t) \\<subseteq> range Var\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<delta>.\n        \\<lbrakk>\\<Gamma> t = \\<Gamma> s; mgu t s = Some \\<delta>;\n         inj_on \\<delta> (fv t);\n         \\<delta> ` fv t \\<subseteq> range Var\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis is_wt_instance_of_condD[OF t_instance_s])"], ["proof (state)\nthis:\n  \\<Gamma> t = \\<Gamma> s\n  mgu t s = Some \\<delta>\n  inj_on \\<delta> (fv t)\n  \\<delta> ` fv t \\<subseteq> range Var\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "have 0: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t &&& wf\\<^sub>t\\<^sub>r\\<^sub>m s", "using s(1) t_wf_trm s_wf_trm"], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<Gamma> s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t &&& wf\\<^sub>t\\<^sub>r\\<^sub>m s", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "note 1 = mgu_wt_if_same_type[OF s(2) 0 s(1)]"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "note 2 = conjunct1[OF mgu_gives_MGU[OF s(2)]]"], ["proof (state)\nthis:\n  Unifier \\<delta> t s\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "using s(1) inj_var_ran_unifiable_has_subst_match[OF 2 s(3,4)]\n          wt_subst_compose[OF 1 subst_var_inv_wt[OF 1, of \"fv t\"]]\n          wf_trms_subst_compose[OF mgu_wf_trms[OF s(2) 0] subst_var_inv_wf_trms[of \\<delta> \"fv t\"]]"], ["proof (prove)\nusing this:\n  \\<Gamma> t = \\<Gamma> s\n  t = s \\<cdot> \\<delta> \\<circ>\\<^sub>s subst_var_inv \\<delta> (fv t)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<delta> \\<circ>\\<^sub>s subst_var_inv \\<delta> (fv t))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<delta> \\<circ>\\<^sub>s subst_var_inv \\<delta> (fv t)))\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t = s \\<cdot> \\<delta>", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     t = s \\<cdot> \\<delta>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in typed_model) is_wt_instance_of_condD'':\n  assumes s_wf_trm: \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\"\n    and t_instance_s: \"is_wt_instance_of_cond \\<Gamma> t s\"\n    and t_var: \"t = Var x\"\n  shows \"\\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "obtain \\<delta> where \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" and s: \"Var x = s \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<delta>.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         Var x = s \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using is_wt_instance_of_condD'[OF _ s_wf_trm t_instance_s] t_var"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     t = s \\<cdot> \\<delta>\n  t = Var x\n\ngoal (1 subgoal):\n 1. (\\<And>\\<delta>.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         Var x = s \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  Var x = s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "obtain y where y: \"s = Var y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y. s = Var y \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "using s"], ["proof (prove)\nusing this:\n  Var x = s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>y. s = Var y \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (cases s) auto"], ["proof (state)\nthis:\n  s = Var y\n\ngoal (1 subgoal):\n 1. \\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using wt_subst_trm''[OF \\<delta>] s y"], ["proof (prove)\nusing this:\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> \\<delta>)\n  Var x = s \\<cdot> \\<delta>\n  s = Var y\n\ngoal (1 subgoal):\n 1. \\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by metis"], ["proof (state)\nthis:\n  \\<exists>y. s = Var y \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in typed_model) has_all_wt_instances_ofD:\n  assumes N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"t \\<in> N\"\n  obtains s \\<delta> where\n    \"s \\<in> M\" \"\\<Gamma> t = \\<Gamma> s\" \"mgu t s = Some \\<delta>\"\n    \"inj_on \\<delta> (fv t)\" \"\\<delta> ` (fv t) \\<subseteq> range Var\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>s \\<delta>.\n        \\<lbrakk>s \\<in> M; \\<Gamma> t = \\<Gamma> s;\n         mgu t s = Some \\<delta>; inj_on \\<delta> (fv t);\n         \\<delta> ` fv t \\<subseteq> range Var\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis t_in_N N_instance_M is_wt_instance_of_condD has_all_wt_instances_of_def)"], ["", "lemma (in typed_model) has_all_wt_instances_ofD':\n  assumes N_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\"\n    and M_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"t \\<in> N\"\n  shows \"\\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t \\<in> M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t \\<in> M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>", "using assms is_wt_instance_of_condD'"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\n  has_all_wt_instances_of \\<Gamma> N M\n  t \\<in> N\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; wf\\<^sub>t\\<^sub>r\\<^sub>m ?s;\n   is_wt_instance_of_cond \\<Gamma> ?t ?s\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<delta>.\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<delta> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<delta>) \\<and>\n                       ?t = ?s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t \\<in> M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>", "unfolding has_all_wt_instances_of_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\n  \\<forall>t\\<in>N. \\<exists>s\\<in>M. is_wt_instance_of_cond \\<Gamma> t s\n  t \\<in> N\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; wf\\<^sub>t\\<^sub>r\\<^sub>m ?s;\n   is_wt_instance_of_cond \\<Gamma> ?t ?s\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<delta>.\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<delta> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<delta>) \\<and>\n                       ?t = ?s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<delta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n       t \\<in> M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>", "by fast"], ["", "lemma (in typed_model) has_all_wt_instances_ofD'':\n  assumes N_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\"\n    and M_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"Var x \\<in> N\"\n  shows \"\\<exists>y. Var y \\<in> M \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y. Var y \\<in> M \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using assms is_wt_instance_of_condD''"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\n  has_all_wt_instances_of \\<Gamma> N M\n  Var x \\<in> N\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?s;\n   is_wt_instance_of_cond \\<Gamma> ?t ?s; ?t = Var ?x\\<rbrakk>\n  \\<Longrightarrow> \\<exists>y.\n                       ?s = Var y \\<and>\n                       \\<Gamma> (Var y) = \\<Gamma> (Var ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>y. Var y \\<in> M \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "unfolding has_all_wt_instances_of_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\n  \\<forall>t\\<in>N. \\<exists>s\\<in>M. is_wt_instance_of_cond \\<Gamma> t s\n  Var x \\<in> N\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?s;\n   is_wt_instance_of_cond \\<Gamma> ?t ?s; ?t = Var ?x\\<rbrakk>\n  \\<Longrightarrow> \\<exists>y.\n                       ?s = Var y \\<and>\n                       \\<Gamma> (Var y) = \\<Gamma> (Var ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>y. Var y \\<in> M \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by fast"], ["", "lemma (in typed_model) has_all_instances_of_if_subset:\n  assumes \"N \\<subseteq> M\"\n  shows \"has_all_wt_instances_of \\<Gamma> N M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_all_wt_instances_of \\<Gamma> N M", "using assms inj_onI mgu_same_empty"], ["proof (prove)\nusing this:\n  N \\<subseteq> M\n  (\\<And>x y.\n      \\<lbrakk>x \\<in> ?A; y \\<in> ?A; ?f x = ?f y\\<rbrakk>\n      \\<Longrightarrow> x = y) \\<Longrightarrow>\n  inj_on ?f ?A\n  mgu ?t ?t = Some Var\n\ngoal (1 subgoal):\n 1. has_all_wt_instances_of \\<Gamma> N M", "unfolding has_all_wt_instances_of_def is_wt_instance_of_cond_def"], ["proof (prove)\nusing this:\n  N \\<subseteq> M\n  (\\<And>x y.\n      \\<lbrakk>x \\<in> ?A; y \\<in> ?A; ?f x = ?f y\\<rbrakk>\n      \\<Longrightarrow> x = y) \\<Longrightarrow>\n  inj_on ?f ?A\n  mgu ?t ?t = Some Var\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>N.\n       \\<exists>s\\<in>M.\n          \\<Gamma> t = \\<Gamma> s \\<and>\n          (case mgu t s of None \\<Rightarrow> False\n           | Some \\<delta> \\<Rightarrow>\n               inj_on \\<delta> (fv t) \\<and>\n               (\\<forall>x\\<in>fv t. is_Var (\\<delta> x)))", "by (smt option.case_eq_if option.discI option.sel subsetD term.discI(1) term.inject(1))"], ["", "lemma (in typed_model) SMP_I':\n  assumes N_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s N\"\n    and M_wf_trms: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s M\"\n    and N_instance_M: \"has_all_wt_instances_of \\<Gamma> N M\"\n    and t_in_N: \"t \\<in> N\"\n  shows \"t \\<in> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "using has_all_wt_instances_ofD'[OF N_wf_trms M_wf_trms N_instance_M t_in_N]\n      SMP.Substitution[OF SMP.MP[of _ M]]"], ["proof (prove)\nusing this:\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     t \\<in> M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n  \\<lbrakk>?t \\<in> M; wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<delta>)\\<rbrakk>\n  \\<Longrightarrow> ?t \\<cdot> ?\\<delta> \\<in> SMP M\n\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "by blast"], ["", "subsubsection \\<open>Lemma: Proving Type-Flaw Resistance\\<close>"], ["", "locale typed_model' = typed_model arity public Ana \\<Gamma>\n  for arity::\"'fun \\<Rightarrow> nat\"\n    and public::\"'fun \\<Rightarrow> bool\"\n    and Ana::\"('fun,(('fun,'atom::finite) term_type \\<times> nat)) term\n              \\<Rightarrow> (('fun,(('fun,'atom) term_type \\<times> nat)) term list\n                 \\<times> ('fun,(('fun,'atom) term_type \\<times> nat)) term list)\"\n    and \\<Gamma>::\"('fun,(('fun,'atom) term_type \\<times> nat)) term \\<Rightarrow> ('fun,'atom) term_type\"\n  +\n  assumes \\<Gamma>_Var_fst: \"\\<And>\\<tau> n m. \\<Gamma> (Var (\\<tau>,n)) = \\<Gamma> (Var (\\<tau>,m))\"\n    and Ana_const: \"\\<And>c T. arity c = 0 \\<Longrightarrow> Ana (Fun c T) = ([],[])\"\n    and Ana_subst'_or_Ana_keys_subterm:\n      \"(\\<forall>f T \\<delta> K R. Ana (Fun f T) = (K,R) \\<longrightarrow> Ana (Fun f T \\<cdot> \\<delta>) = (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)) \\<or>\n       (\\<forall>t K R k. Ana t = (K,R) \\<longrightarrow> k \\<in> set K \\<longrightarrow> k \\<sqsubset> t)\"\nbegin"], ["", "lemma var_rename_inv_comp: \"t \\<cdot> (var_rename n \\<circ>\\<^sub>s var_rename_inv n) = t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = t", "proof (induction t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       Var x \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = Var x\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           x2a \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n           x2a) \\<Longrightarrow>\n       Fun x1a x2 \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n       Fun x1a x2", "case (Fun f T)"], ["proof (state)\nthis:\n  ?x2a2 \\<in> set T \\<Longrightarrow>\n  ?x2a2 \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = ?x2a2\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       Var x \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = Var x\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           x2a \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n           x2a) \\<Longrightarrow>\n       Fun x1a x2 \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n       Fun x1a x2", "hence \"map (\\<lambda>t. t \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n) T = T\""], ["proof (prove)\nusing this:\n  ?x2a2 \\<in> set T \\<Longrightarrow>\n  ?x2a2 \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = ?x2a2\n\ngoal (1 subgoal):\n 1. T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n    var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n    T", "by (simp add: map_idI)"], ["proof (state)\nthis:\n  T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n  var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n  T\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       Var x \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = Var x\n 2. \\<And>x1a x2.\n       (\\<And>x2a.\n           x2a \\<in> set x2 \\<Longrightarrow>\n           x2a \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n           x2a) \\<Longrightarrow>\n       Fun x1a x2 \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n       Fun x1a x2", "thus ?case"], ["proof (prove)\nusing this:\n  T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n  var_rename n \\<circ>\\<^sub>s var_rename_inv n =\n  T\n\ngoal (1 subgoal):\n 1. Fun f T \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = Fun f T", "by (metis subst_apply_term.simps(2))"], ["proof (state)\nthis:\n  Fun f T \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = Fun f T\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       Var x \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = Var x", "qed (simp add: var_rename_def var_rename_inv_def)"], ["", "lemma var_rename_fv_disjoint:\n  \"fv s \\<inter> fv (t \\<cdot> var_rename (max_var s)) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv s))) = {}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv s))) = {}", "have 1: \"\\<forall>v \\<in> fv s. snd v \\<le> max_var s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv s. snd v \\<le> max_var_set (fv s)", "by simp"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv s. snd v \\<le> max_var_set (fv s)\n\ngoal (1 subgoal):\n 1. fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv s))) = {}", "have 2: \"\\<forall>v \\<in> fv (t \\<cdot> var_rename n). snd v > n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv (t \\<cdot> var_rename n). n < snd v", "unfolding var_rename_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv (t \\<cdot> (\\<lambda>v. Var (fst v, snd v + Suc n))).\n       n < snd v", "by (induct t) auto"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv (t \\<cdot> var_rename ?n2). ?n2 < snd v\n\ngoal (1 subgoal):\n 1. fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv s))) = {}", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv s))) = {}", "using 1 2"], ["proof (prove)\nusing this:\n  \\<forall>v\\<in>fv s. snd v \\<le> max_var_set (fv s)\n  \\<forall>v\\<in>fv (t \\<cdot> var_rename ?n2). ?n2 < snd v\n\ngoal (1 subgoal):\n 1. fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv s))) = {}", "by force"], ["proof (state)\nthis:\n  fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv s))) = {}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma var_rename_fv_set_disjoint:\n  assumes \"finite M\" \"s \\<in> M\"\n  shows \"fv s \\<inter> fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv s \\<inter>\n    fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. fv s \\<inter>\n    fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "have 1: \"\\<forall>v \\<in> fv s. snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)", "using assms"], ["proof (prove)\nusing this:\n  finite M\n  s \\<in> M\n\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)", "proof (induction M rule: finite_induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. s \\<in> {} \\<Longrightarrow>\n    \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t {})\n 2. \\<And>x F.\n       \\<lbrakk>finite F; x \\<notin> F;\n        s \\<in> F \\<Longrightarrow>\n        \\<forall>v\\<in>fv s.\n           snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t F);\n        s \\<in> insert x F\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                            snd v\n                            \\<le> max_var_set\n                                   (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert x F))", "case (insert t M)"], ["proof (state)\nthis:\n  finite M\n  t \\<notin> M\n  s \\<in> M \\<Longrightarrow>\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  s \\<in> insert t M\n\ngoal (2 subgoals):\n 1. s \\<in> {} \\<Longrightarrow>\n    \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t {})\n 2. \\<And>x F.\n       \\<lbrakk>finite F; x \\<notin> F;\n        s \\<in> F \\<Longrightarrow>\n        \\<forall>v\\<in>fv s.\n           snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t F);\n        s \\<in> insert x F\\<rbrakk>\n       \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                            snd v\n                            \\<le> max_var_set\n                                   (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert x F))", "thus ?case"], ["proof (prove)\nusing this:\n  finite M\n  t \\<notin> M\n  s \\<in> M \\<Longrightarrow>\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  s \\<in> insert t M\n\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "proof (cases \"t = s\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t = s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n 2. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t \\<noteq> s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "case False"], ["proof (state)\nthis:\n  t \\<noteq> s\n\ngoal (2 subgoals):\n 1. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t = s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n 2. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t \\<noteq> s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "hence \"\\<forall>v \\<in> fv s. snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\""], ["proof (prove)\nusing this:\n  t \\<noteq> s\n\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)", "using insert"], ["proof (prove)\nusing this:\n  t \\<noteq> s\n  finite M\n  t \\<notin> M\n  s \\<in> M \\<Longrightarrow>\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  s \\<in> insert t M\n\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)", "by simp"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t = s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n 2. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t \\<noteq> s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "moreover"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t = s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n 2. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t \\<noteq> s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "have \"max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M) \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n    \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "using insert.hyps(1) insert.prems"], ["proof (prove)\nusing this:\n  finite M\n  s \\<in> insert t M\n\ngoal (1 subgoal):\n 1. max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n    \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "by force"], ["proof (state)\nthis:\n  max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t = s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n 2. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t \\<noteq> s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "by auto"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>finite M; t \\<notin> M;\n     s \\<in> M \\<Longrightarrow>\n     \\<forall>v\\<in>fv s.\n        snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M);\n     s \\<in> insert t M; t = s\\<rbrakk>\n    \\<Longrightarrow> \\<forall>v\\<in>fv s.\n                         snd v\n                         \\<le> max_var_set\n                                (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))", "qed simp"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (insert t M))\n\ngoal (1 subgoal):\n 1. s \\<in> {} \\<Longrightarrow>\n    \\<forall>v\\<in>fv s.\n       snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t {})", "qed simp"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n\ngoal (1 subgoal):\n 1. fv s \\<inter>\n    fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "have 2: \"\\<forall>v \\<in> fv (t \\<cdot> var_rename n). snd v > n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv (t \\<cdot> var_rename n). n < snd v", "unfolding var_rename_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>v\\<in>fv (t \\<cdot> (\\<lambda>v. Var (fst v, snd v + Suc n))).\n       n < snd v", "by (induct t) auto"], ["proof (state)\nthis:\n  \\<forall>v\\<in>fv (t \\<cdot> var_rename ?n2). ?n2 < snd v\n\ngoal (1 subgoal):\n 1. fv s \\<inter>\n    fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. fv s \\<inter>\n    fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "using 1 2"], ["proof (prove)\nusing this:\n  \\<forall>v\\<in>fv s.\n     snd v \\<le> max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M)\n  \\<forall>v\\<in>fv (t \\<cdot> var_rename ?n2). ?n2 < snd v\n\ngoal (1 subgoal):\n 1. fv s \\<inter>\n    fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "by force"], ["proof (state)\nthis:\n  fv s \\<inter>\n  fv (t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n  {}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma var_rename_fv_set_disjoint':\n  assumes \"finite M\"\n  shows \"fv\\<^sub>s\\<^sub>e\\<^sub>t M \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv\\<^sub>s\\<^sub>e\\<^sub>t M \\<inter>\n    fv\\<^sub>s\\<^sub>e\\<^sub>t\n     (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n      var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "using var_rename_fv_set_disjoint[OF assms]"], ["proof (prove)\nusing this:\n  ?s \\<in> M \\<Longrightarrow>\n  fv ?s \\<inter>\n  fv (?t \\<cdot> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n  {}\n\ngoal (1 subgoal):\n 1. fv\\<^sub>s\\<^sub>e\\<^sub>t M \\<inter>\n    fv\\<^sub>s\\<^sub>e\\<^sub>t\n     (N \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n      var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t M))) =\n    {}", "by auto"], ["", "lemma var_rename_is_renaming[simp]:\n  \"subst_range (var_rename n) \\<subseteq> range Var\"\n  \"subst_range (var_rename_inv n) \\<subseteq> range Var\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subst_range (var_rename n) \\<subseteq> range Var &&&\n    subst_range (var_rename_inv n) \\<subseteq> range Var", "unfolding var_rename_def var_rename_inv_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. subst_range (\\<lambda>v. Var (fst v, snd v + Suc n))\n    \\<subseteq> range Var &&&\n    subst_range (\\<lambda>v. Var (fst v, snd v - Suc n))\n    \\<subseteq> range Var", "by auto"], ["", "lemma var_rename_wt[simp]:\n  \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename n)\"\n  \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename_inv n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename n) &&&\n    wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename_inv n)", "by (auto simp add: var_rename_def var_rename_inv_def wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def \\<Gamma>_Var_fst)"], ["", "lemma var_rename_wt':\n  assumes \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"s = m \\<cdot> \\<delta>\"\n  shows \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (var_rename_inv n \\<circ>\\<^sub>s \\<delta>)\" \"s = m \\<cdot> var_rename n \\<cdot> var_rename_inv n \\<circ>\\<^sub>s \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (var_rename_inv n \\<circ>\\<^sub>s \\<delta>) &&&\n    s =\n    m \\<cdot> var_rename n \\<cdot> var_rename_inv n \\<circ>\\<^sub>s \\<delta>", "using assms(2) wt_subst_compose[OF var_rename_wt(2)[of n] assms(1)] var_rename_inv_comp[of m n]"], ["proof (prove)\nusing this:\n  s = m \\<cdot> \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (var_rename_inv n \\<circ>\\<^sub>s \\<delta>)\n  m \\<cdot> var_rename n \\<circ>\\<^sub>s var_rename_inv n = m\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (var_rename_inv n \\<circ>\\<^sub>s \\<delta>) &&&\n    s =\n    m \\<cdot> var_rename n \\<cdot> var_rename_inv n \\<circ>\\<^sub>s \\<delta>", "by force+"], ["", "lemma var_rename_wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s_range[simp]:\n  \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename n))\"\n  \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename_inv n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename n)) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename_inv n))", "using var_rename_is_renaming"], ["proof (prove)\nusing this:\n  subst_range (var_rename ?n) \\<subseteq> range Var\n  subst_range (var_rename_inv ?n) \\<subseteq> range Var\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename n)) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (var_rename_inv n))", "by fastforce+"], ["", "lemma Fun_range_case:\n  \"(\\<forall>f T. Fun f T \\<in> M \\<longrightarrow> P f T) \\<longleftrightarrow> (\\<forall>u \\<in> M. case u of Fun f T \\<Rightarrow> P f T | _ \\<Rightarrow> True)\"\n  \"(\\<forall>f T. Fun f T \\<in> M \\<longrightarrow> P f T) \\<longleftrightarrow> (\\<forall>u \\<in> M. is_Fun u \\<longrightarrow> P (the_Fun u) (args u))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>f T. Fun f T \\<in> M \\<longrightarrow> P f T) =\n    (\\<forall>u\\<in>M.\n        case u of Var v \\<Rightarrow> True\n        | Fun f T \\<Rightarrow> P f T) &&&\n    (\\<forall>f T. Fun f T \\<in> M \\<longrightarrow> P f T) =\n    (\\<forall>u\\<in>M. is_Fun u \\<longrightarrow> P (the_Fun u) (args u))", "by (auto split: \"term.splits\")"], ["", "lemma is_TComp_var_instance_closedD:\n  assumes x: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\" \"\\<Gamma> (Var x) = TComp f T\"\n    and closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n  shows \"\\<exists>g U. Fun g U \\<in> set M \\<and> \\<Gamma> (Fun g U) = \\<Gamma> (Var x) \\<and> (\\<forall>u \\<in> set U. is_Var u) \\<and> distinct U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = \\<Gamma> (Var x) \\<and>\n       (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U", "using assms"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  \\<Gamma> (Var x) = Fun f T\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = \\<Gamma> (Var x) \\<and>\n       (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U", "unfolding is_TComp_var_instance_closed_def list_all_iff list_ex_iff"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  \\<Gamma> (Var x) = Fun f T\n  \\<forall>x\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     is_Fun (\\<Gamma> (Var x)) \\<longrightarrow>\n     (\\<exists>t\\<in>set M.\n         is_Fun t \\<and>\n         \\<Gamma> t = \\<Gamma> (Var x) \\<and>\n         Ball (set (args t)) is_Var \\<and> distinct (args t))\n\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = \\<Gamma> (Var x) \\<and>\n       (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U", "by fastforce"], ["", "lemma is_TComp_var_instance_closedD':\n  assumes \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\" \"TComp f T \\<sqsubseteq> \\<Gamma> (Var x)\"\n    and closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n  shows \"\\<exists>g U. Fun g U \\<in> set M \\<and> \\<Gamma> (Fun g U) = TComp f T \\<and> (\\<forall>u \\<in> set U. is_Var u) \\<and> distinct U\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U", "using assms(1,2)"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U", "proof (induction \"\\<Gamma> (Var x)\" arbitrary: x)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "case (Fun g U)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<Gamma> (Var ?x2) \\<in> set U;\n   \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n      \\<Gamma> (Var ?x2) = \\<Gamma> (Var y);\n   Fun f T \\<sqsubseteq> \\<Gamma> (Var ?x2)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>g U.\n                       Fun g U \\<in> set M \\<and>\n                       \\<Gamma> (Fun g U) = Fun f T \\<and>\n                       Ball (set U) is_Var \\<and> distinct U\n  Fun g U = \\<Gamma> (Var x)\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "note IH = Fun.hyps(1)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<Gamma> (Var ?x2) \\<in> set U;\n   \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n      \\<Gamma> (Var ?x2) = \\<Gamma> (Var y);\n   Fun f T \\<sqsubseteq> \\<Gamma> (Var ?x2)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>g U.\n                       Fun g U \\<in> set M \\<and>\n                       \\<Gamma> (Fun g U) = Fun f T \\<and>\n                       Ball (set U) is_Var \\<and> distinct U\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "have g: \"arity g > 0\" \"public g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity g &&& public g", "using Fun.hyps(2) fun_type_inv[of \"Var x\"] \\<Gamma>_Var_fst"], ["proof (prove)\nusing this:\n  Fun g U = \\<Gamma> (Var x)\n  \\<Gamma> (Var x) = Fun ?f ?T \\<Longrightarrow> 0 < arity ?f\n  \\<Gamma> (Var x) = Fun ?f ?T \\<Longrightarrow> public ?f\n  \\<Gamma> (Var (?\\<tau>, ?n)) = \\<Gamma> (Var (?\\<tau>, ?m))\n\ngoal (1 subgoal):\n 1. 0 < arity g &&& public g", "by simp_all"], ["proof (state)\nthis:\n  0 < arity g\n  public g\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "then"], ["proof (chain)\npicking this:\n  0 < arity g\n  public g", "obtain V where V:\n      \"Fun g V \\<in> set M\" \"\\<Gamma> (Fun g V) = \\<Gamma> (Var x)\" \"\\<forall>v \\<in> set V. \\<exists>x. v = Var x\"\n      \"distinct V\" \"length U = length V\""], ["proof (prove)\nusing this:\n  0 < arity g\n  public g\n\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>Fun g V \\<in> set M; \\<Gamma> (Fun g V) = \\<Gamma> (Var x);\n         \\<forall>v\\<in>set V. \\<exists>x. v = Var x; distinct V;\n         length U = length V\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using is_TComp_var_instance_closedD[OF Fun.prems(1) Fun.hyps(2)[symmetric] closed(1)]"], ["proof (prove)\nusing this:\n  0 < arity g\n  public g\n  \\<exists>g U.\n     Fun g U \\<in> set M \\<and>\n     \\<Gamma> (Fun g U) = \\<Gamma> (Var x) \\<and>\n     (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U\n\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>Fun g V \\<in> set M; \\<Gamma> (Fun g V) = \\<Gamma> (Var x);\n         \\<forall>v\\<in>set V. \\<exists>x. v = Var x; distinct V;\n         length U = length V\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis Fun.hyps(2) fun_type_id_eq fun_type_length_eq is_VarE)"], ["proof (state)\nthis:\n  Fun g V \\<in> set M\n  \\<Gamma> (Fun g V) = \\<Gamma> (Var x)\n  \\<forall>v\\<in>set V. \\<exists>x. v = Var x\n  distinct V\n  length U = length V\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "hence U: \"U = map \\<Gamma> V\""], ["proof (prove)\nusing this:\n  Fun g V \\<in> set M\n  \\<Gamma> (Fun g V) = \\<Gamma> (Var x)\n  \\<forall>v\\<in>set V. \\<exists>x. v = Var x\n  distinct V\n  length U = length V\n\ngoal (1 subgoal):\n 1. U = map \\<Gamma> V", "using fun_type[OF g(1), of V] Fun.hyps(2)"], ["proof (prove)\nusing this:\n  Fun g V \\<in> set M\n  \\<Gamma> (Fun g V) = \\<Gamma> (Var x)\n  \\<forall>v\\<in>set V. \\<exists>x. v = Var x\n  distinct V\n  length U = length V\n  \\<Gamma> (Fun g V) = Fun g (map \\<Gamma> V)\n  Fun g U = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. U = map \\<Gamma> V", "by simp"], ["proof (state)\nthis:\n  U = map \\<Gamma> V\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "hence 1: \"\\<Gamma> v \\<in> set U\" when v: \"v \\<in> set V\" for v"], ["proof (prove)\nusing this:\n  U = map \\<Gamma> V\n\ngoal (1 subgoal):\n 1. \\<Gamma> v \\<in> set U", "using v"], ["proof (prove)\nusing this:\n  U = map \\<Gamma> V\n  v \\<in> set V\n\ngoal (1 subgoal):\n 1. \\<Gamma> v \\<in> set U", "by simp"], ["proof (state)\nthis:\n  ?v2 \\<in> set V \\<Longrightarrow> \\<Gamma> ?v2 \\<in> set U\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "have 2: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var z) = \\<Gamma> (Var y)\" when z: \"Var z \\<in> set V\" for z"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var z) = \\<Gamma> (Var y)", "using V(1) fv_subset_subterms Fun_param_in_subterms[OF z]"], ["proof (prove)\nusing this:\n  Fun g V \\<in> set M\n  ?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t ?M \\<Longrightarrow>\n  fv ?t \\<subseteq> fv\\<^sub>s\\<^sub>e\\<^sub>t ?M\n  Var z \\<sqsubseteq> Fun ?f V\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var z) = \\<Gamma> (Var y)", "by fastforce"], ["proof (state)\nthis:\n  Var ?z2 \\<in> set V \\<Longrightarrow>\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var ?z2) = \\<Gamma> (Var y)\n\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U\n 2. \\<And>x1a x2 x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>\\<Gamma> (Var x) \\<in> set x2;\n                    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var x) = \\<Gamma> (Var y);\n                    Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>g U.\n  Fun g U \\<in> set M \\<and>\n  \\<Gamma> (Fun g U) = Fun f T \\<and> Ball (set U) is_Var \\<and> distinct U;\n        Fun x1a x2 = \\<Gamma> (Var x);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var x) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "proof (cases \"TComp f T = \\<Gamma> (Var x)\")"], ["proof (state)\ngoal (2 subgoals):\n 1. Fun f T = \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U\n 2. Fun f T \\<noteq> \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "case False"], ["proof (state)\nthis:\n  Fun f T \\<noteq> \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. Fun f T = \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U\n 2. Fun f T \\<noteq> \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "then"], ["proof (chain)\npicking this:\n  Fun f T \\<noteq> \\<Gamma> (Var x)", "obtain u where u: \"u \\<in> set U\" \"TComp f T \\<sqsubseteq> u\""], ["proof (prove)\nusing this:\n  Fun f T \\<noteq> \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>u \\<in> set U; Fun f T \\<sqsubseteq> u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Fun.prems(2) Fun.hyps(2)"], ["proof (prove)\nusing this:\n  Fun f T \\<noteq> \\<Gamma> (Var x)\n  Fun f T \\<sqsubseteq> \\<Gamma> (Var x)\n  Fun g U = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>u \\<in> set U; Fun f T \\<sqsubseteq> u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  u \\<in> set U\n  Fun f T \\<sqsubseteq> u\n\ngoal (2 subgoals):\n 1. Fun f T = \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U\n 2. Fun f T \\<noteq> \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "then"], ["proof (chain)\npicking this:\n  u \\<in> set U\n  Fun f T \\<sqsubseteq> u", "obtain y where y: \"Var y \\<in> set V\" \"\\<Gamma> (Var y) = u\""], ["proof (prove)\nusing this:\n  u \\<in> set U\n  Fun f T \\<sqsubseteq> u\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>Var y \\<in> set V; \\<Gamma> (Var y) = u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using U V(3) \\<Gamma>_Var_fst"], ["proof (prove)\nusing this:\n  u \\<in> set U\n  Fun f T \\<sqsubseteq> u\n  U = map \\<Gamma> V\n  \\<forall>v\\<in>set V. \\<exists>x. v = Var x\n  \\<Gamma> (Var (?\\<tau>, ?n)) = \\<Gamma> (Var (?\\<tau>, ?m))\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>Var y \\<in> set V; \\<Gamma> (Var y) = u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  Var y \\<in> set V\n  \\<Gamma> (Var y) = u\n\ngoal (2 subgoals):\n 1. Fun f T = \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U\n 2. Fun f T \\<noteq> \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "using IH[OF _ 2[OF y(1)]] u y(2)"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<Gamma> (Var y) \\<in> set U;\n   Fun f T \\<sqsubseteq> \\<Gamma> (Var y)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>g U.\n                       Fun g U \\<in> set M \\<and>\n                       \\<Gamma> (Fun g U) = Fun f T \\<and>\n                       Ball (set U) is_Var \\<and> distinct U\n  u \\<in> set U\n  Fun f T \\<sqsubseteq> u\n  \\<Gamma> (Var y) = u\n\ngoal (1 subgoal):\n 1. \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "by metis"], ["proof (state)\nthis:\n  \\<exists>g U.\n     Fun g U \\<in> set M \\<and>\n     \\<Gamma> (Fun g U) = Fun f T \\<and>\n     Ball (set U) is_Var \\<and> distinct U\n\ngoal (1 subgoal):\n 1. Fun f T = \\<Gamma> (Var x) \\<Longrightarrow>\n    \\<exists>g U.\n       Fun g U \\<in> set M \\<and>\n       \\<Gamma> (Fun g U) = Fun f T \\<and>\n       Ball (set U) is_Var \\<and> distinct U", "qed (use V in fastforce)"], ["proof (state)\nthis:\n  \\<exists>g U.\n     Fun g U \\<in> set M \\<and>\n     \\<Gamma> (Fun g U) = Fun f T \\<and>\n     Ball (set U) is_Var \\<and> distinct U\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>Var x = \\<Gamma> (Var xa);\n        \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n           \\<Gamma> (Var xa) = \\<Gamma> (Var y);\n        Fun f T \\<sqsubseteq> \\<Gamma> (Var xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g U.\n                            Fun g U \\<in> set M \\<and>\n                            \\<Gamma> (Fun g U) = Fun f T \\<and>\n                            Ball (set U) is_Var \\<and> distinct U", "qed simp"], ["", "lemma TComp_var_instance_wt_subst_exists:\n  assumes gT: \"\\<Gamma> (Fun g T) = TComp g (map \\<Gamma> U)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\"\n    and U: \"\\<forall>u \\<in> set U. \\<exists>y. u = Var y\" \"distinct U\"\n  shows \"\\<exists>\\<theta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and> Fun g T = Fun g U \\<cdot> \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "define the_i where \"the_i \\<equiv> \\<lambda>y. THE x. x < length U \\<and> U ! x = Var y\""], ["proof (state)\nthis:\n  the_i \\<equiv> \\<lambda>y. THE x. x < length U \\<and> U ! x = Var y\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "define \\<theta> where \\<theta>: \"\\<theta> \\<equiv> \\<lambda>y. if Var y \\<in> set U then T ! the_i y else Var y\""], ["proof (state)\nthis:\n  \\<theta> \\<equiv>\n  \\<lambda>y. if Var y \\<in> set U then T ! the_i y else Var y\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "have g: \"arity g > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity g", "using gT(1,2) fun_type_inv(1)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> U)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\n  \\<Gamma> ?t = Fun ?f ?T \\<Longrightarrow> 0 < arity ?f\n\ngoal (1 subgoal):\n 1. 0 < arity g", "by blast"], ["proof (state)\nthis:\n  0 < arity g\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "have UT: \"length U = length T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length U = length T", "using fun_type_length_eq gT(1)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun ?f ?X) = Fun ?g ?Y \\<Longrightarrow> length ?X = length ?Y\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> U)\n\ngoal (1 subgoal):\n 1. length U = length T", "by fastforce"], ["proof (state)\nthis:\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "have 1: \"the_i y < length U \\<and> U ! the_i y = Var y\" when y: \"Var y \\<in> set U\" for y"], ["proof (prove)\ngoal (1 subgoal):\n 1. the_i y < length U \\<and> U ! the_i y = Var y", "using theI'[OF distinct_Ex1[OF U(2) y]]"], ["proof (prove)\nusing this:\n  (THE x. x < length U \\<and> U ! x = Var y) < length U \\<and>\n  U ! (THE x. x < length U \\<and> U ! x = Var y) = Var y\n\ngoal (1 subgoal):\n 1. the_i y < length U \\<and> U ! the_i y = Var y", "unfolding the_i_def"], ["proof (prove)\nusing this:\n  (THE x. x < length U \\<and> U ! x = Var y) < length U \\<and>\n  U ! (THE x. x < length U \\<and> U ! x = Var y) = Var y\n\ngoal (1 subgoal):\n 1. (THE x. x < length U \\<and> U ! x = Var y) < length U \\<and>\n    U ! (THE x. x < length U \\<and> U ! x = Var y) = Var y", "by simp"], ["proof (state)\nthis:\n  Var ?y2 \\<in> set U \\<Longrightarrow>\n  the_i ?y2 < length U \\<and> U ! the_i ?y2 = Var ?y2\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "have 2: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>", "using \\<theta> 1 gT(1) fun_type[OF g] UT"], ["proof (prove)\nusing this:\n  \\<theta> \\<equiv>\n  \\<lambda>y. if Var y \\<in> set U then T ! the_i y else Var y\n  Var ?y2 \\<in> set U \\<Longrightarrow>\n  the_i ?y2 < length U \\<and> U ! the_i ?y2 = Var ?y2\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> U)\n  \\<Gamma> (Fun g ?T) = Fun g (map \\<Gamma> ?T)\n  length U = length T\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>", "unfolding wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<theta> \\<equiv>\n  \\<lambda>y. if Var y \\<in> set U then T ! the_i y else Var y\n  Var ?y2 \\<in> set U \\<Longrightarrow>\n  the_i ?y2 < length U \\<and> U ! the_i ?y2 = Var ?y2\n  \\<Gamma> (Fun g T) = Fun g (map \\<Gamma> U)\n  \\<Gamma> (Fun g ?T) = Fun g (map \\<Gamma> ?T)\n  length U = length T\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> (\\<theta> v)", "by (metis (no_types, lifting) nth_map term.inject(2))"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "have \"\\<forall>i<length T. U ! i \\<cdot> \\<theta> = T ! i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<length T. U ! i \\<cdot> \\<theta> = T ! i", "using \\<theta> 1 U(1) UT distinct_Ex1[OF U(2)] in_set_conv_nth"], ["proof (prove)\nusing this:\n  \\<theta> \\<equiv>\n  \\<lambda>y. if Var y \\<in> set U then T ! the_i y else Var y\n  Var ?y2 \\<in> set U \\<Longrightarrow>\n  the_i ?y2 < length U \\<and> U ! the_i ?y2 = Var ?y2\n  \\<forall>u\\<in>set U. \\<exists>y. u = Var y\n  length U = length T\n  ?x \\<in> set U \\<Longrightarrow>\n  \\<exists>!i. i < length U \\<and> U ! i = ?x\n  (?x \\<in> set ?xs) = (\\<exists>i<length ?xs. ?xs ! i = ?x)\n\ngoal (1 subgoal):\n 1. \\<forall>i<length T. U ! i \\<cdot> \\<theta> = T ! i", "by (metis (no_types, lifting) subst_apply_term.simps(1))"], ["proof (state)\nthis:\n  \\<forall>i<length T. U ! i \\<cdot> \\<theta> = T ! i\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "hence \"T = map (\\<lambda>t. t \\<cdot> \\<theta>) U\""], ["proof (prove)\nusing this:\n  \\<forall>i<length T. U ! i \\<cdot> \\<theta> = T ! i\n\ngoal (1 subgoal):\n 1. T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<theta>", "by (simp add: UT nth_equalityI)"], ["proof (state)\nthis:\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "hence 3: \"Fun g T = Fun g U \\<cdot> \\<theta>\""], ["proof (prove)\nusing this:\n  T = U \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. Fun g T = Fun g U \\<cdot> \\<theta>", "by simp"], ["proof (state)\nthis:\n  Fun g T = Fun g U \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "have \"subst_range \\<theta> \\<subseteq> set T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subst_range \\<theta> \\<subseteq> set T", "using \\<theta> 1 U(1) UT"], ["proof (prove)\nusing this:\n  \\<theta> \\<equiv>\n  \\<lambda>y. if Var y \\<in> set U then T ! the_i y else Var y\n  Var ?y2 \\<in> set U \\<Longrightarrow>\n  the_i ?y2 < length U \\<and> U ! the_i ?y2 = Var ?y2\n  \\<forall>u\\<in>set U. \\<exists>y. u = Var y\n  length U = length T\n\ngoal (1 subgoal):\n 1. subst_range \\<theta> \\<subseteq> set T", "by (auto simp add: subst_domain_def)"], ["proof (state)\nthis:\n  subst_range \\<theta> \\<subseteq> set T\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "hence 4: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\nusing this:\n  subst_range \\<theta> \\<subseteq> set T\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)", "using gT(2) wf_trm_param"], ["proof (prove)\nusing this:\n  subst_range \\<theta> \\<subseteq> set T\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g T)\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun ?f ?T); ?t \\<in> set ?T\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?t\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<theta>.\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n       Fun g T = Fun g U \\<cdot> \\<theta>", "by (metis 2 3 4)"], ["proof (state)\nthis:\n  \\<exists>\\<theta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n     Fun g T = Fun g U \\<cdot> \\<theta>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma TComp_var_instance_closed_has_Var:\n  assumes closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and wf_\\<delta>x: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\"\n    and y_ex: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\"\n    and t: \"t \\<sqsubseteq> \\<delta> x\"\n    and \\<delta>_wt: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\"\n  shows \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var y) = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "proof (cases \"\\<Gamma> (Var x)\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> (Var x) = Var x1 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t\n 2. \\<And>x21 x22.\n       \\<Gamma> (Var x) = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t", "case (Var a)"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> (Var x) = Var x1 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t\n 2. \\<And>x21 x22.\n       \\<Gamma> (Var x) = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t", "hence \"t = \\<delta> x\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Var a\n\ngoal (1 subgoal):\n 1. t = \\<delta> x", "using t wf_\\<delta>x \\<delta>_wt"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Var a\n  t \\<sqsubseteq> \\<delta> x\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. t = \\<delta> x", "by (metis (full_types) const_type_inv_wf fun_if_subterm subtermeq_Var_const(2) wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def)"], ["proof (state)\nthis:\n  t = \\<delta> x\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> (Var x) = Var x1 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t\n 2. \\<And>x21 x22.\n       \\<Gamma> (Var x) = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t", "thus ?thesis"], ["proof (prove)\nusing this:\n  t = \\<delta> x\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "using y_ex wt_subst_trm''[OF \\<delta>_wt, of \"Var x\"]"], ["proof (prove)\nusing this:\n  t = \\<delta> x\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "by fastforce"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> (Var x) = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> (Var x) = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) = Fun f T\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> (Var x) = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t", "hence \\<Gamma>_\\<delta>x: \"\\<Gamma> (\\<delta> x) = TComp f T\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Fun f T\n\ngoal (1 subgoal):\n 1. \\<Gamma> (\\<delta> x) = Fun f T", "using wt_subst_trm''[OF \\<delta>_wt, of \"Var x\"]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = Fun f T\n  \\<Gamma> (Var x) = \\<Gamma> (Var x \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (\\<delta> x) = Fun f T", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (\\<delta> x) = Fun f T\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> (Var x) = Fun x21 x22 \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> t", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "proof (cases \"t = \\<delta> x\")"], ["proof (state)\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "case False"], ["proof (state)\nthis:\n  t \\<noteq> \\<delta> x\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "hence t_subt_\\<delta>x: \"t \\<sqsubset> \\<delta> x\""], ["proof (prove)\nusing this:\n  t \\<noteq> \\<delta> x\n\ngoal (1 subgoal):\n 1. t \\<sqsubset> \\<delta> x", "using t(1) \\<Gamma>_\\<delta>x"], ["proof (prove)\nusing this:\n  t \\<noteq> \\<delta> x\n  t \\<sqsubseteq> \\<delta> x\n  \\<Gamma> (\\<delta> x) = Fun f T\n\ngoal (1 subgoal):\n 1. t \\<sqsubset> \\<delta> x", "by fastforce"], ["proof (state)\nthis:\n  t \\<sqsubset> \\<delta> x\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "obtain T' where T': \"\\<delta> x = Fun f T'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>T'.\n        \\<delta> x = Fun f T' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using \\<Gamma>_\\<delta>x t_subt_\\<delta>x fun_type_id_eq"], ["proof (prove)\nusing this:\n  \\<Gamma> (\\<delta> x) = Fun f T\n  t \\<sqsubset> \\<delta> x\n  \\<Gamma> (Fun ?f ?X) = Fun ?g ?Y \\<Longrightarrow> ?f = ?g\n\ngoal (1 subgoal):\n 1. (\\<And>T'.\n        \\<delta> x = Fun f T' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (cases \"\\<delta> x\") auto"], ["proof (state)\nthis:\n  \\<delta> x = Fun f T'\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "obtain g S where gS: \"Fun g S \\<sqsubseteq> \\<delta> x\" \"t \\<in> set S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>g S.\n        \\<lbrakk>Fun g S \\<sqsubseteq> \\<delta> x; t \\<in> set S\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Fun_ex_if_subterm[OF t_subt_\\<delta>x]"], ["proof (prove)\nusing this:\n  \\<exists>f T. Fun f T \\<sqsubseteq> \\<delta> x \\<and> t \\<in> set T\n\ngoal (1 subgoal):\n 1. (\\<And>g S.\n        \\<lbrakk>Fun g S \\<sqsubseteq> \\<delta> x; t \\<in> set S\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  Fun g S \\<sqsubseteq> \\<delta> x\n  t \\<in> set S\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "have gS_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g S)", "by (rule wf_trm_subtermeq[OF wf_\\<delta>x gS(1)])"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g S)\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "hence \"arity g > 0\""], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g S)\n\ngoal (1 subgoal):\n 1. 0 < arity g", "using gS(2)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun g S)\n  t \\<in> set S\n\ngoal (1 subgoal):\n 1. 0 < arity g", "by (metis length_pos_if_in_set wf_trm_arity)"], ["proof (state)\nthis:\n  0 < arity g\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "hence gS_\\<Gamma>: \"\\<Gamma> (Fun g S) = TComp g (map \\<Gamma> S)\""], ["proof (prove)\nusing this:\n  0 < arity g\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun g S) = Fun g (map \\<Gamma> S)", "using fun_type"], ["proof (prove)\nusing this:\n  0 < arity g\n  0 < arity ?f \\<Longrightarrow>\n  \\<Gamma> (Fun ?f ?T) = Fun ?f (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun g S) = Fun g (map \\<Gamma> S)", "by blast"], ["proof (state)\nthis:\n  \\<Gamma> (Fun g S) = Fun g (map \\<Gamma> S)\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "obtain h U where hU:\n        \"Fun h U \\<in> set M\" \"\\<Gamma> (Fun h U) = Fun g (map \\<Gamma> S)\" \"\\<forall>u \\<in> set U. is_Var u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>h U.\n        \\<lbrakk>Fun h U \\<in> set M;\n         \\<Gamma> (Fun h U) = Fun g (map \\<Gamma> S);\n         \\<forall>u\\<in>set U. is_Var u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using is_TComp_var_instance_closedD'[OF y_ex _ closed wf_M]\n            subtermeq_imp_subtermtypeeq[OF wf_\\<delta>x] gS \\<Gamma>_\\<delta>x Fun gS_\\<Gamma>"], ["proof (prove)\nusing this:\n  Fun ?f ?T \\<sqsubseteq> \\<Gamma> (Var x) \\<Longrightarrow>\n  \\<exists>g U.\n     Fun g U \\<in> set M \\<and>\n     \\<Gamma> (Fun g U) = Fun ?f ?T \\<and>\n     (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U\n  ?s \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n  \\<Gamma> ?s \\<sqsubseteq> \\<Gamma> (\\<delta> x)\n  Fun g S \\<sqsubseteq> \\<delta> x\n  t \\<in> set S\n  \\<Gamma> (\\<delta> x) = Fun f T\n  \\<Gamma> (Var x) = Fun f T\n  \\<Gamma> (Fun g S) = Fun g (map \\<Gamma> S)\n\ngoal (1 subgoal):\n 1. (\\<And>h U.\n        \\<lbrakk>Fun h U \\<in> set M;\n         \\<Gamma> (Fun h U) = Fun g (map \\<Gamma> S);\n         \\<forall>u\\<in>set U. is_Var u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  Fun h U \\<in> set M\n  \\<Gamma> (Fun h U) = Fun g (map \\<Gamma> S)\n  \\<forall>u\\<in>set U. is_Var u\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "obtain y where y: \"Var y \\<in> set U\" \"\\<Gamma> (Var y) = \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>Var y \\<in> set U; \\<Gamma> (Var y) = \\<Gamma> t\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using hU(3) fun_type_param_ex[OF hU(2) gS(2)]"], ["proof (prove)\nusing this:\n  \\<forall>u\\<in>set U. is_Var u\n  \\<exists>s\\<in>set U. \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>Var y \\<in> set U; \\<Gamma> (Var y) = \\<Gamma> t\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fast"], ["proof (state)\nthis:\n  Var y \\<in> set U\n  \\<Gamma> (Var y) = \\<Gamma> t\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "have \"y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "using hU(1) y(1)"], ["proof (prove)\nusing this:\n  Fun h U \\<in> set M\n  Var y \\<in> set U\n\ngoal (1 subgoal):\n 1. y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "by force"], ["proof (state)\nthis:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n\ngoal (2 subgoals):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t\n 2. t \\<noteq> \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "thus ?thesis"], ["proof (prove)\nusing this:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "using y(2) closed"], ["proof (prove)\nusing this:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> t\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "by metis"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. t = \\<delta> x \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> t", "qed (metis y_ex Fun \\<Gamma>_\\<delta>x)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> t\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma TComp_var_instance_closed_has_Fun:\n  assumes closed: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and wf_\\<delta>x: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\"\n    and y_ex: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\"\n    and t: \"t \\<sqsubseteq> \\<delta> x\"\n    and \\<delta>_wt: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\"\n    and t_\\<Gamma>: \"\\<Gamma> t = TComp g T\"\n    and t_fun: \"is_Fun t\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<theta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and> t = m \\<cdot> \\<theta> \\<and> is_Fun m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "obtain T'' where T'': \"t = Fun g T''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>T''. t = Fun g T'' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using t_\\<Gamma> t_fun fun_type_id_eq"], ["proof (prove)\nusing this:\n  \\<Gamma> t = Fun g T\n  is_Fun t\n  \\<Gamma> (Fun ?f ?X) = Fun ?g ?Y \\<Longrightarrow> ?f = ?g\n\ngoal (1 subgoal):\n 1. (\\<And>T''. t = Fun g T'' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  t = Fun g T''\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "have g: \"arity g > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity g", "using t_\\<Gamma> fun_type_inv[of t]"], ["proof (prove)\nusing this:\n  \\<Gamma> t = Fun g T\n  \\<Gamma> t = Fun ?f ?T \\<Longrightarrow> 0 < arity ?f\n  \\<Gamma> t = Fun ?f ?T \\<Longrightarrow> public ?f\n\ngoal (1 subgoal):\n 1. 0 < arity g", "by simp_all"], ["proof (state)\nthis:\n  0 < arity g\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "have \"TComp g T \\<sqsubseteq> \\<Gamma> (Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Fun g T \\<sqsubseteq> \\<Gamma> (Var x)", "using \\<delta>_wt t t_\\<Gamma>"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  t \\<sqsubseteq> \\<delta> x\n  \\<Gamma> t = Fun g T\n\ngoal (1 subgoal):\n 1. Fun g T \\<sqsubseteq> \\<Gamma> (Var x)", "by (metis wf_\\<delta>x subtermeq_imp_subtermtypeeq wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def)"], ["proof (state)\nthis:\n  Fun g T \\<sqsubseteq> \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "then"], ["proof (chain)\npicking this:\n  Fun g T \\<sqsubseteq> \\<Gamma> (Var x)", "obtain U where U:\n      \"Fun g U \\<in> set M\" \"\\<Gamma> (Fun g U) = TComp g T\" \"\\<forall>u \\<in> set U. \\<exists>y. u = Var y\"\n      \"distinct U\" \"length T'' = length U\""], ["proof (prove)\nusing this:\n  Fun g T \\<sqsubseteq> \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>Fun g U \\<in> set M; \\<Gamma> (Fun g U) = Fun g T;\n         \\<forall>u\\<in>set U. \\<exists>y. u = Var y; distinct U;\n         length T'' = length U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using is_TComp_var_instance_closedD'[OF y_ex _ closed wf_M]"], ["proof (prove)\nusing this:\n  Fun g T \\<sqsubseteq> \\<Gamma> (Var x)\n  Fun ?f ?T \\<sqsubseteq> \\<Gamma> (Var x) \\<Longrightarrow>\n  \\<exists>g U.\n     Fun g U \\<in> set M \\<and>\n     \\<Gamma> (Fun g U) = Fun ?f ?T \\<and>\n     (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>Fun g U \\<in> set M; \\<Gamma> (Fun g U) = Fun g T;\n         \\<forall>u\\<in>set U. \\<exists>y. u = Var y; distinct U;\n         length T'' = length U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis t_\\<Gamma> T'' fun_type_id_eq fun_type_length_eq is_VarE)"], ["proof (state)\nthis:\n  Fun g U \\<in> set M\n  \\<Gamma> (Fun g U) = Fun g T\n  \\<forall>u\\<in>set U. \\<exists>y. u = Var y\n  distinct U\n  length T'' = length U\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "hence UT': \"T = map \\<Gamma> U\""], ["proof (prove)\nusing this:\n  Fun g U \\<in> set M\n  \\<Gamma> (Fun g U) = Fun g T\n  \\<forall>u\\<in>set U. \\<exists>y. u = Var y\n  distinct U\n  length T'' = length U\n\ngoal (1 subgoal):\n 1. T = map \\<Gamma> U", "using fun_type[OF g, of U]"], ["proof (prove)\nusing this:\n  Fun g U \\<in> set M\n  \\<Gamma> (Fun g U) = Fun g T\n  \\<forall>u\\<in>set U. \\<exists>y. u = Var y\n  distinct U\n  length T'' = length U\n  \\<Gamma> (Fun g U) = Fun g (map \\<Gamma> U)\n\ngoal (1 subgoal):\n 1. T = map \\<Gamma> U", "by simp"], ["proof (state)\nthis:\n  T = map \\<Gamma> U\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "using TComp_var_instance_wt_subst_exists UT' T'' U(1,3,4) t t_\\<Gamma> wf_\\<delta>x wf_trm_subtermeq"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<Gamma> (Fun ?g ?T) = Fun ?g (map \\<Gamma> ?U);\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun ?g ?T);\n   \\<forall>u\\<in>set ?U. \\<exists>y. u = Var y; distinct ?U\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<theta>.\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<theta> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<theta>) \\<and>\n                       Fun ?g ?T = Fun ?g ?U \\<cdot> \\<theta>\n  T = map \\<Gamma> U\n  t = Fun g T''\n  Fun g U \\<in> set M\n  \\<forall>u\\<in>set U. \\<exists>y. u = Var y\n  distinct U\n  t \\<sqsubseteq> \\<delta> x\n  \\<Gamma> t = Fun g T\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; ?s \\<sqsubseteq> ?t\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?s\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          t = m \\<cdot> \\<theta> \\<and> is_Fun m", "by (metis term.disc(2))"], ["proof (state)\nthis:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<theta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n        t = m \\<cdot> \\<theta> \\<and> is_Fun m\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma TComp_var_and_subterm_instance_closed_has_subterms_instances:\n  assumes M_var_inst_cl: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and M_subterms_cl: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n    and M_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n    and t: \"t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M\"\n    and s: \"s \\<sqsubseteq> t \\<cdot> \\<delta>\"\n    and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<theta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and> s = m \\<cdot> \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "using subterm_subst_unfold[OF s]"], ["proof (prove)\nusing this:\n  (\\<exists>s'. s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta>) \\<or>\n  (\\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>\n 2. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "assume \"\\<exists>s'. s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta>\""], ["proof (state)\nthis:\n  \\<exists>s'. s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>\n 2. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "then"], ["proof (chain)\npicking this:\n  \\<exists>s'. s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta>", "obtain s' where s': \"s' \\<sqsubseteq> t\" \"s = s' \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  \\<exists>s'. s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>s'.\n        \\<lbrakk>s' \\<sqsubseteq> t; s = s' \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  s' \\<sqsubseteq> t\n  s = s' \\<cdot> \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>\n 2. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "then"], ["proof (chain)\npicking this:\n  s' \\<sqsubseteq> t\n  s = s' \\<cdot> \\<delta>", "obtain \\<theta> where \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\" \"s' \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\""], ["proof (prove)\nusing this:\n  s' \\<sqsubseteq> t\n  s = s' \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta>.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         s' \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using t has_all_wt_instances_ofD'[OF wf_trms_subterms[OF M_wf] M_wf M_subterms_cl]\n          term.order_trans[of s' t]"], ["proof (prove)\nusing this:\n  s' \\<sqsubseteq> t\n  s = s' \\<cdot> \\<delta>\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M\n  ?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     ?t \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n  \\<lbrakk>s' \\<sqsubseteq> t; t \\<sqsubseteq> ?z\\<rbrakk>\n  \\<Longrightarrow> s' \\<sqsubseteq> ?z\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta>.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         s' \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  s' \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>\n 2. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "then"], ["proof (chain)\npicking this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  s' \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>", "obtain m where m: \"m \\<in> set M\" \"s' = m \\<cdot> \\<theta>\""], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  s' \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<theta>\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> set M; s' = m \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  m \\<in> set M\n  s' = m \\<cdot> \\<theta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>\n 2. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "have \"s = m \\<cdot> (\\<theta> \\<circ>\\<^sub>s \\<delta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>", "using s'(2) m(2)"], ["proof (prove)\nusing this:\n  s = s' \\<cdot> \\<delta>\n  s' = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. s = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>", "by simp"], ["proof (state)\nthis:\n  s = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> t \\<and> s = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>\n 2. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "thus ?thesis"], ["proof (prove)\nusing this:\n  s = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "using m(1) wt_subst_compose[OF \\<theta>(1) \\<delta>(1)] wf_trms_subst_compose[OF \\<theta>(2) \\<delta>(2)]"], ["proof (prove)\nusing this:\n  s = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "by blast"], ["proof (state)\nthis:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<theta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n        s = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "assume \"\\<exists>x \\<in> fv t. s \\<sqsubset> \\<delta> x\""], ["proof (state)\nthis:\n  \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "then"], ["proof (chain)\npicking this:\n  \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x", "obtain x where x: \"x \\<in> fv t\" \"s \\<sqsubset> \\<delta> x\" \"s \\<sqsubseteq> \\<delta> x\""], ["proof (prove)\nusing this:\n  \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> fv t; s \\<sqsubset> \\<delta> x;\n         s \\<sqsubseteq> \\<delta> x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  x \\<in> fv t\n  s \\<sqsubset> \\<delta> x\n  s \\<sqsubseteq> \\<delta> x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "note 0 = TComp_var_instance_closed_has_Var[OF M_var_inst_cl M_wf]"], ["proof (state)\nthis:\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<delta> ?x);\n   \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n      \\<Gamma> (Var ?x) = \\<Gamma> (Var y);\n   ?t \\<sqsubseteq> ?\\<delta> ?x;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>\\<rbrakk>\n  \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var y) = \\<Gamma> ?t\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "note 1 = has_all_wt_instances_ofD''[OF wf_trms_subterms[OF M_wf] M_wf M_subterms_cl]"], ["proof (state)\nthis:\n  Var ?x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>y. Var y \\<in> set M \\<and> \\<Gamma> (Var y) = \\<Gamma> (Var ?x)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "have \\<delta>x_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\" and s_wf_trm: \"wf\\<^sub>t\\<^sub>r\\<^sub>m s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x) &&& wf\\<^sub>t\\<^sub>r\\<^sub>m s", "using \\<delta>(2) wf_trm_subterm[OF _ x(2)]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x) \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x) &&& wf\\<^sub>t\\<^sub>r\\<^sub>m s", "by fastforce+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "have x_fv_ex: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var x) = \\<Gamma> (Var y)", "using x(1) s fv_subset_subterms[OF t]"], ["proof (prove)\nusing this:\n  x \\<in> fv t\n  s \\<sqsubseteq> t \\<cdot> \\<delta>\n  fv t \\<subseteq> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var x) = \\<Gamma> (Var y)", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "obtain y where y: \"y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\" \"\\<Gamma> (Var y) = \\<Gamma> s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using 0[of \\<delta> x s, OF \\<delta>x_wf x_fv_ex x(3) \\<delta>(1)]"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> s\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> s\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "then"], ["proof (chain)\npicking this:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> s", "obtain z where z: \"Var z \\<in> set M\" \"\\<Gamma> (Var z) = \\<Gamma> s\""], ["proof (prove)\nusing this:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> s\n\ngoal (1 subgoal):\n 1. (\\<And>z.\n        \\<lbrakk>Var z \\<in> set M; \\<Gamma> (Var z) = \\<Gamma> s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using 1[of y] vars_iff_subtermeq_set[of y \"set M\"]"], ["proof (prove)\nusing this:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> s\n  Var y \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>ya.\n     Var ya \\<in> set M \\<and> \\<Gamma> (Var ya) = \\<Gamma> (Var y)\n  (y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)) =\n  (Var y \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M)\n\ngoal (1 subgoal):\n 1. (\\<And>z.\n        \\<lbrakk>Var z \\<in> set M; \\<Gamma> (Var z) = \\<Gamma> s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  Var z \\<in> set M\n  \\<Gamma> (Var z) = \\<Gamma> s\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "define \\<theta> where \"\\<theta> \\<equiv> Var(z := s)::('fun, ('fun, 'atom) term \\<times> nat) subst\""], ["proof (state)\nthis:\n  \\<theta> \\<equiv> Var(z := s)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "have \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\" \"s = Var z \\<cdot> \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) &&&\n    s = Var z \\<cdot> \\<theta>", "using z(2) s_wf_trm"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var z) = \\<Gamma> s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) &&&\n    s = Var z \\<cdot> \\<theta>", "unfolding \\<theta>_def wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var z) = \\<Gamma> s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> ((Var(z := s)) v) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (Var(z := s))) &&&\n    s = Var z \\<cdot> Var(z := s)", "by force+"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  s = Var z \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv t. s \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "thus ?thesis"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  s = Var z \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "using z(1)"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  s = Var z \\<cdot> \\<theta>\n  Var z \\<in> set M\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<theta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n          s = m \\<cdot> \\<theta>", "by blast"], ["proof (state)\nthis:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<theta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n        s = m \\<cdot> \\<theta>\n\ngoal:\nNo subgoals!", "qed"], ["", "context\nbegin"], ["", "private"], ["", "lemma SMP_D_aux1:\n  assumes \"t \\<in> SMP (set M)\"\n    and closed: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n                \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and wf_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n  shows \"\\<forall>x \\<in> fv t. \\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv t.\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using assms(1)"], ["proof (prove)\nusing this:\n  t \\<in> SMP (set M)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv t.\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "proof (induction t rule: SMP.induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>t.\n       t \\<in> set M \\<Longrightarrow>\n       \\<forall>x\\<in>fv t.\n          \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n             \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv t'.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case (MP t)"], ["proof (state)\nthis:\n  t \\<in> set M\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       t \\<in> set M \\<Longrightarrow>\n       \\<forall>x\\<in>fv t.\n          \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n             \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv t'.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv t.\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv t \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv t \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "assume x: \"x \\<in> fv t\""], ["proof (state)\nthis:\n  x \\<in> fv t\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv t \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "hence \"Var x \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)\""], ["proof (prove)\nusing this:\n  x \\<in> fv t\n\ngoal (1 subgoal):\n 1. Var x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M", "using MP.hyps vars_iff_subtermeq"], ["proof (prove)\nusing this:\n  x \\<in> fv t\n  t \\<in> set M\n  (?x \\<in> fv ?t) = (Var ?x \\<sqsubseteq> ?t)\n\ngoal (1 subgoal):\n 1. Var x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M", "by fastforce"], ["proof (state)\nthis:\n  Var x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv t \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "then"], ["proof (chain)\npicking this:\n  Var x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M", "obtain \\<delta> s where \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\"\n        and s: \"s \\<in> set M\" \"Var x = s \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  Var x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M\n\ngoal (1 subgoal):\n 1. (\\<And>\\<delta> s.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n         s \\<in> set M; Var x = s \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using has_all_wt_instances_ofD'[OF wf_trms_subterms[OF wf_M] wf_M closed(1)]"], ["proof (prove)\nusing this:\n  Var x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M\n  ?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     ?t \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<delta> s.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n         s \\<in> set M; Var x = s \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  s \\<in> set M\n  Var x = s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv t \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "then"], ["proof (chain)\npicking this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  s \\<in> set M\n  Var x = s \\<cdot> \\<delta>", "obtain y where y: \"s = Var y\""], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  s \\<in> set M\n  Var x = s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>y. s = Var y \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (cases s) auto"], ["proof (state)\nthis:\n  s = Var y\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv t \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "thus \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\nusing this:\n  s = Var y\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using s wt_subst_trm''[OF \\<delta>(1), of \"Var y\"]"], ["proof (prove)\nusing this:\n  s = Var y\n  s \\<in> set M\n  Var x = s \\<cdot> \\<delta>\n  \\<Gamma> (Var y) = \\<Gamma> (Var y \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by force"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv t'.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv t'.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case (Subterm t t')"], ["proof (state)\nthis:\n  t \\<in> SMP (set M)\n  t' \\<sqsubseteq> t\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv t'.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "hence \"fv t' \\<subseteq> fv t\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (set M)\n  t' \\<sqsubseteq> t\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. fv t' \\<subseteq> fv t", "using subtermeq_vars_subset"], ["proof (prove)\nusing this:\n  t \\<in> SMP (set M)\n  t' \\<sqsubseteq> t\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  ?M \\<sqsubseteq> ?N \\<Longrightarrow> fv ?M \\<subseteq> fv ?N\n\ngoal (1 subgoal):\n 1. fv t' \\<subseteq> fv t", "by auto"], ["proof (state)\nthis:\n  fv t' \\<subseteq> fv t\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        t' \\<sqsubseteq> t\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv t'.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "thus ?case"], ["proof (prove)\nusing this:\n  fv t' \\<subseteq> fv t\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv t'.\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using Subterm.IH"], ["proof (prove)\nusing this:\n  fv t' \\<subseteq> fv t\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv t'.\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv t'.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case (Substitution t \\<delta>)"], ["proof (state)\nthis:\n  t \\<in> SMP (set M)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "note IH = Substitution.IH"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv (t \\<cdot> \\<delta>) \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv (t \\<cdot> \\<delta>) \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "assume x: \"x \\<in> fv (t \\<cdot> \\<delta>)\""], ["proof (state)\nthis:\n  x \\<in> fv (t \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv (t \\<cdot> \\<delta>) \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "then"], ["proof (chain)\npicking this:\n  x \\<in> fv (t \\<cdot> \\<delta>)", "obtain y where y: \"y \\<in> fv t\" \"\\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\""], ["proof (prove)\nusing this:\n  x \\<in> fv (t \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> fv t;\n         \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Substitution.hyps(2,3)"], ["proof (prove)\nusing this:\n  x \\<in> fv (t \\<cdot> \\<delta>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> fv t;\n         \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis subst_apply_img_var subtermeqI' subtermeq_imp_subtermtypeeq\n                vars_iff_subtermeq wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def wf_trm_subst_rangeD)"], ["proof (state)\nthis:\n  y \\<in> fv t\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv (t \\<cdot> \\<delta>) \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "let ?P = \"\\<lambda>x. \\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> fv (t \\<cdot> \\<delta>) \\<Longrightarrow>\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "show \"?P x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using y IH"], ["proof (prove)\nusing this:\n  y \\<in> fv t\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "proof (induction \"\\<Gamma> (Var y)\" arbitrary: y t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>xa y t.\n       \\<lbrakk>Var xa = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>x1a x2 y t.\n       \\<lbrakk>\\<And>y t.\n                   \\<lbrakk>\\<Gamma> (Var y) \\<in> set x2; y \\<in> fv t;\n                    \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n                    \\<forall>x\\<in>fv t.\n                       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                          \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>y\n        \\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n  \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Fun x1a x2 = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case (Var a)"], ["proof (state)\nthis:\n  Var a = \\<Gamma> (Var y)\n  y \\<in> fv t\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. \\<And>xa y t.\n       \\<lbrakk>Var xa = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>x1a x2 y t.\n       \\<lbrakk>\\<And>y t.\n                   \\<lbrakk>\\<Gamma> (Var y) \\<in> set x2; y \\<in> fv t;\n                    \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n                    \\<forall>x\\<in>fv t.\n                       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                          \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>y\n        \\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n  \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Fun x1a x2 = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)", "hence \"\\<Gamma> (Var x) = \\<Gamma> (Var y)\""], ["proof (prove)\nusing this:\n  Var a = \\<Gamma> (Var y)\n  y \\<in> fv t\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) = \\<Gamma> (Var y)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) = \\<Gamma> (Var y)\n\ngoal (2 subgoals):\n 1. \\<And>xa y t.\n       \\<lbrakk>Var xa = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<And>x1a x2 y t.\n       \\<lbrakk>\\<And>y t.\n                   \\<lbrakk>\\<Gamma> (Var y) \\<in> set x2; y \\<in> fv t;\n                    \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n                    \\<forall>x\\<in>fv t.\n                       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                          \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>y\n        \\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n  \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Fun x1a x2 = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)", "thus ?case"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using Var(2,4)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  y \\<in> fv t\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 y t.\n       \\<lbrakk>\\<And>y t.\n                   \\<lbrakk>\\<Gamma> (Var y) \\<in> set x2; y \\<in> fv t;\n                    \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n                    \\<forall>x\\<in>fv t.\n                       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                          \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>y\n        \\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n  \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Fun x1a x2 = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1a x2 y t.\n       \\<lbrakk>\\<And>y t.\n                   \\<lbrakk>\\<Gamma> (Var y) \\<in> set x2; y \\<in> fv t;\n                    \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n                    \\<forall>x\\<in>fv t.\n                       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                          \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>y\n        \\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n  \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Fun x1a x2 = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<Gamma> (Var ?y2) \\<in> set T; ?y2 \\<in> fv ?t2;\n   \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var ?y2);\n   \\<forall>x\\<in>fv ?t2.\n      \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  Fun f T = \\<Gamma> (Var y)\n  y \\<in> fv t\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 y t.\n       \\<lbrakk>\\<And>y t.\n                   \\<lbrakk>\\<Gamma> (Var y) \\<in> set x2; y \\<in> fv t;\n                    \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n                    \\<forall>x\\<in>fv t.\n                       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                          \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>y\n        \\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n  \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Fun x1a x2 = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)", "obtain z where z: \"\\<exists>w \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var z) = \\<Gamma> (Var w)\" \"\\<Gamma> (Var z) = \\<Gamma> (Var y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>z.\n        \\<lbrakk>\\<exists>w\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                    \\<Gamma> (Var z) = \\<Gamma> (Var w);\n         \\<Gamma> (Var z) = \\<Gamma> (Var y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Fun.prems(1,3)"], ["proof (prove)\nusing this:\n  y \\<in> fv t\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>z.\n        \\<lbrakk>\\<exists>w\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                    \\<Gamma> (Var z) = \\<Gamma> (Var w);\n         \\<Gamma> (Var z) = \\<Gamma> (Var y)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<exists>w\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var z) = \\<Gamma> (Var w)\n  \\<Gamma> (Var z) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<And>x1a x2 y t.\n       \\<lbrakk>\\<And>y t.\n                   \\<lbrakk>\\<Gamma> (Var y) \\<in> set x2; y \\<in> fv t;\n                    \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n                    \\<forall>x\\<in>fv t.\n                       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                          \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n                   \\<Longrightarrow> \\<exists>y\n        \\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n  \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Fun x1a x2 = \\<Gamma> (Var y); y \\<in> fv t;\n        \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                            \\<Gamma> (Var y) = \\<Gamma> (Var x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "proof (cases \"\\<Gamma> (Var x) = \\<Gamma> (Var y)\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<Gamma> (Var x) = \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case True"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) = \\<Gamma> (Var y)\n\ngoal (2 subgoals):\n 1. \\<Gamma> (Var x) = \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)\n 2. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using Fun.prems"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  y \\<in> fv t\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case False"], ["proof (state)\nthis:\n  \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y)", "obtain \\<tau> where \\<tau>: \"\\<tau> \\<in> set T\" \"\\<Gamma> (Var x) \\<sqsubseteq> \\<tau>\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> set T;\n         \\<Gamma> (Var x) \\<sqsubseteq> \\<tau>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Fun.prems(2) Fun.hyps(2)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y)\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var y)\n  Fun f T = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<tau>.\n        \\<lbrakk>\\<tau> \\<in> set T;\n         \\<Gamma> (Var x) \\<sqsubseteq> \\<tau>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  \\<tau> \\<in> set T\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<tau>\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "then"], ["proof (chain)\npicking this:\n  \\<tau> \\<in> set T\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<tau>", "obtain U where U:\n            \"Fun f U \\<in> set M\" \"\\<Gamma> (Fun f U) = \\<Gamma> (Var z)\" \"\\<forall>u \\<in> set U. \\<exists>v. u = Var v\" \"distinct U\""], ["proof (prove)\nusing this:\n  \\<tau> \\<in> set T\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<tau>\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>Fun f U \\<in> set M; \\<Gamma> (Fun f U) = \\<Gamma> (Var z);\n         \\<forall>u\\<in>set U. \\<exists>v. u = Var v; distinct U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using is_TComp_var_instance_closedD'[OF z(1) _ closed(2) wf_M] Fun.hyps(2) z(2)"], ["proof (prove)\nusing this:\n  \\<tau> \\<in> set T\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<tau>\n  Fun ?f ?T \\<sqsubseteq> \\<Gamma> (Var z) \\<Longrightarrow>\n  \\<exists>g U.\n     Fun g U \\<in> set M \\<and>\n     \\<Gamma> (Fun g U) = Fun ?f ?T \\<and>\n     (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U\n  Fun f T = \\<Gamma> (Var y)\n  \\<Gamma> (Var z) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. (\\<And>U.\n        \\<lbrakk>Fun f U \\<in> set M; \\<Gamma> (Fun f U) = \\<Gamma> (Var z);\n         \\<forall>u\\<in>set U. \\<exists>v. u = Var v; distinct U\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis fun_type_id_eq subtermeqI' is_VarE)"], ["proof (state)\nthis:\n  Fun f U \\<in> set M\n  \\<Gamma> (Fun f U) = \\<Gamma> (Var z)\n  \\<forall>u\\<in>set U. \\<exists>v. u = Var v\n  distinct U\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "hence 1: \"\\<forall>x \\<in> fv (Fun f U). \\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\nusing this:\n  Fun f U \\<in> set M\n  \\<Gamma> (Fun f U) = \\<Gamma> (Var z)\n  \\<forall>u\\<in>set U. \\<exists>v. u = Var v\n  distinct U\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv (Fun f U).\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by force"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (Fun f U).\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "have \"arity f > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity f", "using U(2) z(2) Fun.hyps(2) fun_type_inv(1)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f U) = \\<Gamma> (Var z)\n  \\<Gamma> (Var z) = \\<Gamma> (Var y)\n  Fun f T = \\<Gamma> (Var y)\n  \\<Gamma> ?t = Fun ?f ?T \\<Longrightarrow> 0 < arity ?f\n\ngoal (1 subgoal):\n 1. 0 < arity f", "by metis"], ["proof (state)\nthis:\n  0 < arity f\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "hence \"\\<Gamma> (Fun f U) = TComp f (map \\<Gamma> U)\""], ["proof (prove)\nusing this:\n  0 < arity f\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f U) = Fun f (map \\<Gamma> U)", "using fun_type"], ["proof (prove)\nusing this:\n  0 < arity f\n  0 < arity ?f \\<Longrightarrow>\n  \\<Gamma> (Fun ?f ?T) = Fun ?f (map \\<Gamma> ?T)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun f U) = Fun f (map \\<Gamma> U)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Fun f U) = Fun f (map \\<Gamma> U)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> (Fun f U) = Fun f (map \\<Gamma> U)", "obtain u where u: \"Var u \\<in> set U\" \"\\<Gamma> (Var u) = \\<tau>\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f U) = Fun f (map \\<Gamma> U)\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>Var u \\<in> set U; \\<Gamma> (Var u) = \\<tau>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using \\<tau>(1) U(2,3) z(2) Fun.hyps(2)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun f U) = Fun f (map \\<Gamma> U)\n  \\<tau> \\<in> set T\n  \\<Gamma> (Fun f U) = \\<Gamma> (Var z)\n  \\<forall>u\\<in>set U. \\<exists>v. u = Var v\n  \\<Gamma> (Var z) = \\<Gamma> (Var y)\n  Fun f T = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>Var u \\<in> set U; \\<Gamma> (Var u) = \\<tau>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  Var u \\<in> set U\n  \\<Gamma> (Var u) = \\<tau>\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var x) \\<noteq> \\<Gamma> (Var y) \\<Longrightarrow>\n    \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using Fun.hyps(1)[of u \"Fun f U\"] u \\<tau> 1"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<Gamma> (Var u) \\<in> set T; u \\<in> fv (Fun f U);\n   \\<Gamma> (Var x) \\<sqsubseteq> \\<Gamma> (Var u);\n   \\<forall>x\\<in>fv (Fun f U).\n      \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n                       \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  Var u \\<in> set U\n  \\<Gamma> (Var u) = \\<tau>\n  \\<tau> \\<in> set T\n  \\<Gamma> (Var x) \\<sqsubseteq> \\<tau>\n  \\<forall>x\\<in>fv (Fun f U).\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by force"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv (t \\<cdot> \\<delta>).\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "case (Ana t K T k)"], ["proof (state)\nthis:\n  t \\<in> SMP (set M)\n  Ana t = (K, T)\n  k \\<in> set K\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "have \"fv k \\<subseteq> fv t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv k \\<subseteq> fv t", "using Ana_keys_fv[OF Ana.hyps(2)] Ana.hyps(3)"], ["proof (prove)\nusing this:\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set K) \\<subseteq> fv t\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. fv k \\<subseteq> fv t", "by auto"], ["proof (state)\nthis:\n  fv k \\<subseteq> fv t\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        \\<forall>x\\<in>fv t.\n           \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var y) = \\<Gamma> (Var x);\n        Ana t = (K, T); k \\<in> set K\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>fv k.\n                            \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t\n      (set M).\n                               \\<Gamma> (Var y) = \\<Gamma> (Var x)", "thus ?case"], ["proof (prove)\nusing this:\n  fv k \\<subseteq> fv t\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv k.\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "using Ana.IH"], ["proof (prove)\nusing this:\n  fv k \\<subseteq> fv t\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>fv k.\n       \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n          \\<Gamma> (Var y) = \\<Gamma> (Var x)", "by auto"], ["proof (state)\nthis:\n  \\<forall>x\\<in>fv k.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma SMP_D_aux2:\n  fixes t::\"('fun, ('fun, 'atom) term \\<times> nat) term\"\n  assumes t_SMP: \"t \\<in> SMP (set M)\"\n    and t_Var: \"\\<exists>x. t = Var x\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have M_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\" \n      and M_var_inst_cl: \"is_TComp_var_instance_closed \\<Gamma> M\"\n      and M_subterms_cl: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n      and M_Ana_cl: \"has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "using finite_SMP_representationD[OF M_SMP_repr]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have M_Ana_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "fix k"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "assume \"k \\<in> \\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)\""], ["proof (state)\nthis:\n  k \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "then"], ["proof (chain)\npicking this:\n  k \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)", "obtain m where m: \"m \\<in> set M\" \"k \\<in> set (fst (Ana m))\""], ["proof (prove)\nusing this:\n  k \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> set M; k \\<in> set (fst (Ana m))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  m \\<in> set M\n  k \\<in> set (fst (Ana m))\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "thus \"wf\\<^sub>t\\<^sub>r\\<^sub>m k\""], ["proof (prove)\nusing this:\n  m \\<in> set M\n  k \\<in> set (fst (Ana m))\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m k", "using M_wf Ana_keys_wf'[of m \"fst (Ana m)\" _ k] surjective_pairing"], ["proof (prove)\nusing this:\n  m \\<in> set M\n  k \\<in> set (fst (Ana m))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  \\<lbrakk>Ana m = (fst (Ana m), ?T); wf\\<^sub>t\\<^sub>r\\<^sub>m m;\n   k \\<in> set (fst (Ana m))\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m k\n  ?t = (fst ?t, snd ?t)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m k", "by blast"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m k\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "note 0 = has_all_wt_instances_ofD'[OF wf_trms_subterms[OF M_wf] M_wf M_subterms_cl]"], ["proof (state)\nthis:\n  ?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     ?t \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "note 1 = has_all_wt_instances_ofD'[OF M_Ana_wf M_wf M_Ana_cl]"], ["proof (state)\nthis:\n  ?t \\<in> \\<Union>\n            ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     ?t \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "obtain x y where x: \"t = Var x\" and y: \"y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\" \"\\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>t = Var x; y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using t_Var SMP_D_aux1[OF t_SMP M_subterms_cl M_var_inst_cl M_wf]"], ["proof (prove)\nusing this:\n  \\<exists>x. t = Var x\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>t = Var x; y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "then"], ["proof (chain)\npicking this:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)", "obtain m \\<delta> where m: \"m \\<in> set M\" \"m \\<cdot> \\<delta> = Var y\" and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\""], ["proof (prove)\nusing this:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M; m \\<cdot> \\<delta> = Var y;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using 0[of \"Var y\"] vars_iff_subtermeq_set[of y \"set M\"]"], ["proof (prove)\nusing this:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  Var y \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     Var y \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n  (y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)) =\n  (Var y \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M)\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M; m \\<cdot> \\<delta> = Var y;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  m \\<in> set M\n  m \\<cdot> \\<delta> = Var y\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "obtain z where z: \"m = Var z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>z. m = Var z \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "using m(2)"], ["proof (prove)\nusing this:\n  m \\<cdot> \\<delta> = Var y\n\ngoal (1 subgoal):\n 1. (\\<And>z. m = Var z \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (cases m) auto"], ["proof (state)\nthis:\n  m = Var z\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "define \\<theta> where \"\\<theta> \\<equiv> Var(z := Var x)::('fun, ('fun, 'atom) term \\<times> nat) subst\""], ["proof (state)\nthis:\n  \\<theta> \\<equiv> Var(z := Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have \"\\<Gamma> (Var z) = \\<Gamma> (Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Var z) = \\<Gamma> (Var x)", "using y(2) m(2) z wt_subst_trm''[OF \\<delta>, of m]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  m \\<cdot> \\<delta> = Var y\n  m = Var z\n  \\<Gamma> m = \\<Gamma> (m \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var z) = \\<Gamma> (Var x)", "by argo"], ["proof (state)\nthis:\n  \\<Gamma> (Var z) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "hence \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var z) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)", "unfolding \\<theta>_def wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var z) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> ((Var(z := Var x)) v) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (Var(z := Var x)))", "by force+"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "moreover"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have \"t = m \\<cdot> \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t = m \\<cdot> \\<theta>", "using x z"], ["proof (prove)\nusing this:\n  t = Var x\n  m = Var z\n\ngoal (1 subgoal):\n 1. t = m \\<cdot> \\<theta>", "unfolding \\<theta>_def"], ["proof (prove)\nusing this:\n  t = Var x\n  m = Var z\n\ngoal (1 subgoal):\n 1. t = m \\<cdot> Var(z := Var x)", "by simp"], ["proof (state)\nthis:\n  t = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "ultimately"], ["proof (chain)\npicking this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t = m \\<cdot> \\<theta>", "show ?thesis"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "using m(1)"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t = m \\<cdot> \\<theta>\n  m \\<in> set M\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "by blast"], ["proof (state)\nthis:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<delta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n        t = m \\<cdot> \\<delta>\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma SMP_D_aux3:\n  assumes hyps: \"t' \\<sqsubseteq> t\" and wf_t: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\" and prems: \"is_Fun t'\"\n    and IH:\n      \"((\\<exists>f. t = Fun f []) \\<and> (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>)) \\<or>\n       (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta> \\<and> is_Fun m)\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"((\\<exists>f. t' = Fun f []) \\<and> (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t' = m \\<cdot> \\<delta>)) \\<or>\n         (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (cases \"\\<exists>f. t = Fun f [] \\<or> t' = Fun f []\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case True"], ["proof (state)\nthis:\n  \\<exists>f. t = Fun f [] \\<or> t' = Fun f []\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have M_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\" \n    and M_var_inst_cl: \"is_TComp_var_instance_closed \\<Gamma> M\"\n    and M_subterms_cl: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n    and M_Ana_cl: \"has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "using finite_SMP_representationD[OF M_SMP_repr]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note 0 = has_all_wt_instances_ofD'[OF wf_trms_subterms[OF M_wf] M_wf M_subterms_cl]"], ["proof (state)\nthis:\n  ?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     ?t \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note 1 = TComp_var_instance_closed_has_Fun[OF M_var_inst_cl M_wf]"], ["proof (state)\nthis:\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<delta> ?x);\n   \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n      \\<Gamma> (Var ?x) = \\<Gamma> (Var y);\n   ?t \\<sqsubseteq> ?\\<delta> ?x;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   \\<Gamma> ?t = Fun ?g ?T; is_Fun ?t\\<rbrakk>\n  \\<Longrightarrow> \\<exists>m\\<in>set M.\n                       \\<exists>\\<theta>.\n                          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                           \\<theta> \\<and>\n                          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                           (subst_range \\<theta>) \\<and>\n                          ?t = m \\<cdot> \\<theta> \\<and> is_Fun m\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note 2 = TComp_var_and_subterm_instance_closed_has_subterms_instances[\n            OF M_var_inst_cl M_subterms_cl M_wf]"], ["proof (state)\nthis:\n  \\<lbrakk>?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M;\n   ?s \\<sqsubseteq> ?t \\<cdot> ?\\<delta>;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<delta>)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>m\\<in>set M.\n                       \\<exists>\\<theta>.\n                          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                           \\<theta> \\<and>\n                          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                           (subst_range \\<theta>) \\<and>\n                          ?s = m \\<cdot> \\<theta>\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have wf_t': \"wf\\<^sub>t\\<^sub>r\\<^sub>m t'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t'", "using hyps wf_t wf_trm_subterm"], ["proof (prove)\nusing this:\n  t' \\<sqsubseteq> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; ?s \\<sqsubset> ?t\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?s\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t'", "by blast"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t'\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "obtain c where \"t = Fun c [] \\<or> t' = Fun c []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c.\n        t = Fun c [] \\<or> t' = Fun c [] \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using True"], ["proof (prove)\nusing this:\n  \\<exists>f. t = Fun f [] \\<or> t' = Fun f []\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        t = Fun c [] \\<or> t' = Fun c [] \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t = Fun c [] \\<or> t' = Fun c []\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  t = Fun c [] \\<or> t' = Fun c []\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. t = Fun c [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. t' = Fun c [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "assume c: \"t' = Fun c []\""], ["proof (state)\nthis:\n  t' = Fun c []\n\ngoal (2 subgoals):\n 1. t = Fun c [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. t' = Fun c [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (cases \"\\<exists>f. t = Fun f []\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case True"], ["proof (state)\nthis:\n  \\<exists>f. t = Fun f []\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence \"t = t'\""], ["proof (prove)\nusing this:\n  \\<exists>f. t = Fun f []\n\ngoal (1 subgoal):\n 1. t = t'", "using c hyps"], ["proof (prove)\nusing this:\n  \\<exists>f. t = Fun f []\n  t' = Fun c []\n  t' \\<sqsubseteq> t\n\ngoal (1 subgoal):\n 1. t = t'", "by force"], ["proof (state)\nthis:\n  t = t'\n\ngoal (2 subgoals):\n 1. \\<exists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  t = t'\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using IH"], ["proof (prove)\nusing this:\n  t = t'\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by fast"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case False"], ["proof (state)\nthis:\n  \\<nexists>f. t = Fun f []\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note F = this"], ["proof (state)\nthis:\n  \\<nexists>f. t = Fun f []\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<nexists>f. t = Fun f []", "obtain m \\<delta> where m: \"m \\<in> set M\" \"t = m \\<cdot> \\<delta>\"\n          and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\""], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f []\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M; t = m \\<cdot> \\<delta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using IH"], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f []\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M; t = m \\<cdot> \\<delta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  m \\<in> set M\n  t = m \\<cdot> \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using subterm_subst_unfold[OF hyps[unfolded m(2)]]"], ["proof (prove)\nusing this:\n  (\\<exists>s'. s' \\<sqsubseteq> m \\<and> t' = s' \\<cdot> \\<delta>) \\<or>\n  (\\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x)\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> m \\<and> t' = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "assume \"\\<exists>m'. m' \\<sqsubseteq> m \\<and> t' = m' \\<cdot> \\<delta>\""], ["proof (state)\nthis:\n  \\<exists>m'. m' \\<sqsubseteq> m \\<and> t' = m' \\<cdot> \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> m \\<and> t' = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<exists>m'. m' \\<sqsubseteq> m \\<and> t' = m' \\<cdot> \\<delta>", "obtain m' where m': \"m' \\<sqsubseteq> m\" \"t' = m' \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  \\<exists>m'. m' \\<sqsubseteq> m \\<and> t' = m' \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>m'.\n        \\<lbrakk>m' \\<sqsubseteq> m; t' = m' \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  m' \\<sqsubseteq> m\n  t' = m' \\<cdot> \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> m \\<and> t' = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "obtain n \\<theta> where n: \"n \\<in> set M\" \"m' = n \\<cdot> \\<theta>\" and \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n \\<theta>.\n        \\<lbrakk>n \\<in> set M; m' = n \\<cdot> \\<theta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using 0[of m'] m(1) m'(1)"], ["proof (prove)\nusing this:\n  m' \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     m' \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n  m \\<in> set M\n  m' \\<sqsubseteq> m\n\ngoal (1 subgoal):\n 1. (\\<And>n \\<theta>.\n        \\<lbrakk>n \\<in> set M; m' = n \\<cdot> \\<theta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  n \\<in> set M\n  m' = n \\<cdot> \\<theta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> m \\<and> t' = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have \"t' = n \\<cdot> (\\<theta> \\<circ>\\<^sub>s \\<delta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t' = n \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>", "using m'(2) n(2)"], ["proof (prove)\nusing this:\n  t' = m' \\<cdot> \\<delta>\n  m' = n \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. t' = n \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>", "by auto"], ["proof (state)\nthis:\n  t' = n \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>s'.\n       s' \\<sqsubseteq> m \\<and> t' = s' \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  t' = n \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using c n(1) wt_subst_compose[OF \\<theta>(1) \\<delta>(1)] wf_trms_subst_compose[OF \\<theta>(2) \\<delta>(2)]"], ["proof (prove)\nusing this:\n  t' = n \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  t' = Fun c []\n  n \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "assume \"\\<exists>x \\<in> fv m. t' \\<sqsubset> \\<delta> x\""], ["proof (state)\nthis:\n  \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x", "obtain x where x: \"x \\<in> fv m\" \"t' \\<sqsubset> \\<delta> x\" \"t' \\<sqsubseteq> \\<delta> x\""], ["proof (prove)\nusing this:\n  \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> fv m; t' \\<sqsubset> \\<delta> x;\n         t' \\<sqsubseteq> \\<delta> x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  x \\<in> fv m\n  t' \\<sqsubset> \\<delta> x\n  t' \\<sqsubseteq> \\<delta> x\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have \\<delta>x_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)", "using \\<delta>(2)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)", "by fastforce"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have x_fv_ex: \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var x) = \\<Gamma> (Var y)", "using x m"], ["proof (prove)\nusing this:\n  x \\<in> fv m\n  t' \\<sqsubset> \\<delta> x\n  t' \\<sqsubseteq> \\<delta> x\n  m \\<in> set M\n  t = m \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n       \\<Gamma> (Var x) = \\<Gamma> (Var y)", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n\ngoal (1 subgoal):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubset> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (cases \"\\<Gamma> t'\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t' = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t' = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta>) \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       \\<Gamma> t' = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t' = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta>) \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case (Var a)"], ["proof (state)\nthis:\n  \\<Gamma> t' = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t' = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t' = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta>) \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       \\<Gamma> t' = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t' = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta>) \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using c m 2[OF _ hyps[unfolded m(2)] \\<delta>]"], ["proof (prove)\nusing this:\n  t' = Fun c []\n  m \\<in> set M\n  t = m \\<cdot> \\<delta>\n  m \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<theta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n        t' = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by fast"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t' = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t' = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta>) \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t' = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t' = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta>) \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case (Fun g S)"], ["proof (state)\nthis:\n  \\<Gamma> t' = Fun g S\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t' = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t' = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta>) \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using c 1[of \\<delta> x t', OF \\<delta>x_wf x_fv_ex x(3) \\<delta>(1) Fun]"], ["proof (prove)\nusing this:\n  t' = Fun c []\n  is_Fun t' \\<Longrightarrow>\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<theta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>) \\<and>\n        t' = m \\<cdot> \\<theta> \\<and> is_Fun m\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. t = Fun c [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "qed (use IH hyps in simp)"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case False"], ["proof (state)\nthis:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note F = False"], ["proof (state)\nthis:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []", "obtain m \\<delta> where m:\n      \"m \\<in> set M\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"t = m \\<cdot> \\<delta>\" \"is_Fun m\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\""], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         t = m \\<cdot> \\<delta>; is_Fun m;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using IH"], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         t = m \\<cdot> \\<delta>; is_Fun m;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  t = m \\<cdot> \\<delta>\n  is_Fun m\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "obtain f T where fT: \"t' = Fun f T\" \"arity f > 0\" \"\\<Gamma> t' = TComp f (map \\<Gamma> T)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>f T.\n        \\<lbrakk>t' = Fun f T; 0 < arity f;\n         \\<Gamma> t' = Fun f (map \\<Gamma> T)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using F prems fun_type wf_trm_subtermeq[OF wf_t hyps]"], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []\n  is_Fun t'\n  0 < arity ?f \\<Longrightarrow>\n  \\<Gamma> (Fun ?f ?T) = Fun ?f (map \\<Gamma> ?T)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t'\n\ngoal (1 subgoal):\n 1. (\\<And>f T.\n        \\<lbrakk>t' = Fun f T; 0 < arity f;\n         \\<Gamma> t' = Fun f (map \\<Gamma> T)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis is_FunE length_greater_0_conv subtermeqI' wf\\<^sub>t\\<^sub>r\\<^sub>m_def)"], ["proof (state)\nthis:\n  t' = Fun f T\n  0 < arity f\n  \\<Gamma> t' = Fun f (map \\<Gamma> T)\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have closed: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n               \"is_TComp_var_instance_closed \\<Gamma> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "using M_SMP_repr"], ["proof (prove)\nusing this:\n  finite_SMP_representation arity Ana \\<Gamma> M\n\ngoal (1 subgoal):\n 1. has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "unfolding finite_SMP_representation_def"], ["proof (prove)\nusing this:\n  list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) M \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) \\<and>\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "by metis+"], ["proof (state)\nthis:\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have M_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)", "using finite_SMP_representationD[OF M_SMP_repr]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)", "by blast"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f [] \\<or> t' = Fun f [] \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (cases \"\\<exists>x \\<in> fv m. t' \\<sqsubseteq> \\<delta> x\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case True"], ["proof (state)\nthis:\n  \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x", "obtain x where x: \"x \\<in> fv m\" \"t' \\<sqsubseteq> \\<delta> x\""], ["proof (prove)\nusing this:\n  \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x \\<in> fv m; t' \\<sqsubseteq> \\<delta> x\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  x \\<in> fv m\n  t' \\<sqsubseteq> \\<delta> x\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have 1: \"x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "using m(1) x(1)"], ["proof (prove)\nusing this:\n  m \\<in> set M\n  x \\<in> fv m\n\ngoal (1 subgoal):\n 1. x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "by auto"], ["proof (state)\nthis:\n  x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have 2: \"is_Fun (\\<delta> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_Fun (\\<delta> x)", "using prems x(2)"], ["proof (prove)\nusing this:\n  is_Fun t'\n  t' \\<sqsubseteq> \\<delta> x\n\ngoal (1 subgoal):\n 1. is_Fun (\\<delta> x)", "by auto"], ["proof (state)\nthis:\n  is_Fun (\\<delta> x)\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have 3: \"wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)", "using m(5)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)", "by (simp add: wf_trm_subst_rangeD)"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have \"\\<not>(\\<exists>f. \\<delta> x = Fun f [])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<nexists>f. \\<delta> x = Fun f []", "using F x(2)"], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []\n  t' \\<sqsubseteq> \\<delta> x\n\ngoal (1 subgoal):\n 1. \\<nexists>f. \\<delta> x = Fun f []", "by auto"], ["proof (state)\nthis:\n  \\<nexists>f. \\<delta> x = Fun f []\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence \"\\<exists>f T. \\<Gamma> (Var x) = TComp f T\""], ["proof (prove)\nusing this:\n  \\<nexists>f. \\<delta> x = Fun f []\n\ngoal (1 subgoal):\n 1. \\<exists>f T. \\<Gamma> (Var x) = Fun f T", "using 2 3 m(2)"], ["proof (prove)\nusing this:\n  \\<nexists>f. \\<delta> x = Fun f []\n  is_Fun (\\<delta> x)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>f T. \\<Gamma> (Var x) = Fun f T", "by (metis (no_types) fun_type is_FunE length_greater_0_conv subtermeqI' wf\\<^sub>t\\<^sub>r\\<^sub>m_def wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def)"], ["proof (state)\nthis:\n  \\<exists>f T. \\<Gamma> (Var x) = Fun f T\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "moreover"], ["proof (state)\nthis:\n  \\<exists>f T. \\<Gamma> (Var x) = Fun f T\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have \"\\<exists>f T. \\<Gamma> t' = Fun f T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f T. \\<Gamma> t' = Fun f T", "using False prems wf_trm_subtermeq[OF wf_t hyps]"], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f [] \\<or> t' = Fun f []\n  is_Fun t'\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t'\n\ngoal (1 subgoal):\n 1. \\<exists>f T. \\<Gamma> t' = Fun f T", "by (metis (no_types) fun_type is_FunE length_greater_0_conv subtermeqI' wf\\<^sub>t\\<^sub>r\\<^sub>m_def)"], ["proof (state)\nthis:\n  \\<exists>f T. \\<Gamma> t' = Fun f T\n\ngoal (2 subgoals):\n 1. \\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "ultimately"], ["proof (chain)\npicking this:\n  \\<exists>f T. \\<Gamma> (Var x) = Fun f T\n  \\<exists>f T. \\<Gamma> t' = Fun f T", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>f T. \\<Gamma> (Var x) = Fun f T\n  \\<exists>f T. \\<Gamma> t' = Fun f T\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using TComp_var_instance_closed_has_Fun 1 x(2) m(2) prems closed 3 M_wf"], ["proof (prove)\nusing this:\n  \\<exists>f T. \\<Gamma> (Var x) = Fun f T\n  \\<exists>f T. \\<Gamma> t' = Fun f T\n  \\<lbrakk>is_TComp_var_instance_closed \\<Gamma> ?M;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set ?M);\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<delta> ?x);\n   \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set ?M).\n      \\<Gamma> (Var ?x) = \\<Gamma> (Var y);\n   ?t \\<sqsubseteq> ?\\<delta> ?x;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   \\<Gamma> ?t = Fun ?g ?T; is_Fun ?t\\<rbrakk>\n  \\<Longrightarrow> \\<exists>m\\<in>set ?M.\n                       \\<exists>\\<theta>.\n                          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                           \\<theta> \\<and>\n                          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                           (subst_range \\<theta>) \\<and>\n                          ?t = m \\<cdot> \\<theta> \\<and> is_Fun m\n  x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  t' \\<sqsubseteq> \\<delta> x\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  is_Fun t'\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (\\<delta> x)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by metis"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case False"], ["proof (state)\nthis:\n  \\<not> (\\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x)\n\ngoal (1 subgoal):\n 1. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<not> (\\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x)", "obtain m' where m': \"m' \\<sqsubseteq> m\" \"t' = m' \\<cdot> \\<delta>\" \"is_Fun m'\""], ["proof (prove)\nusing this:\n  \\<not> (\\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x)\n\ngoal (1 subgoal):\n 1. (\\<And>m'.\n        \\<lbrakk>m' \\<sqsubseteq> m; t' = m' \\<cdot> \\<delta>;\n         is_Fun m'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using hyps m(3) subterm_subst_not_img_subterm"], ["proof (prove)\nusing this:\n  \\<not> (\\<exists>x\\<in>fv m. t' \\<sqsubseteq> \\<delta> x)\n  t' \\<sqsubseteq> t\n  t = m \\<cdot> \\<delta>\n  \\<lbrakk>?t \\<sqsubseteq> ?s \\<cdot> ?\\<I>;\n   \\<not> (\\<exists>w\\<in>fv ?s. ?t \\<sqsubseteq> ?\\<I> w)\\<rbrakk>\n  \\<Longrightarrow> \\<exists>f T.\n                       Fun f T \\<sqsubseteq> ?s \\<and>\n                       ?t = Fun f T \\<cdot> ?\\<I>\n\ngoal (1 subgoal):\n 1. (\\<And>m'.\n        \\<lbrakk>m' \\<sqsubseteq> m; t' = m' \\<cdot> \\<delta>;\n         is_Fun m'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  m' \\<sqsubseteq> m\n  t' = m' \\<cdot> \\<delta>\n  is_Fun m'\n\ngoal (1 subgoal):\n 1. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  m' \\<sqsubseteq> m\n  t' = m' \\<cdot> \\<delta>\n  is_Fun m'", "obtain \\<theta> m'' where \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\" \"m'' \\<in> set M\" \"m' = m'' \\<cdot> \\<theta>\""], ["proof (prove)\nusing this:\n  m' \\<sqsubseteq> m\n  t' = m' \\<cdot> \\<delta>\n  is_Fun m'\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta> m''.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         m'' \\<in> set M; m' = m'' \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using m(1) has_all_wt_instances_ofD'[OF wf_trms_subterms[OF M_wf] M_wf closed(1)]"], ["proof (prove)\nusing this:\n  m' \\<sqsubseteq> m\n  t' = m' \\<cdot> \\<delta>\n  is_Fun m'\n  m \\<in> set M\n  ?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     ?t \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta> m''.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         m'' \\<in> set M; m' = m'' \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  m'' \\<in> set M\n  m' = m'' \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence t'_m'': \"t' = m'' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\""], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  m'' \\<in> set M\n  m' = m'' \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. t' = m'' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>", "using m'(2)"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  m'' \\<in> set M\n  m' = m'' \\<cdot> \\<theta>\n  t' = m' \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. t' = m'' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>", "by fastforce"], ["proof (state)\nthis:\n  t' = m'' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n\ngoal (1 subgoal):\n 1. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note \\<theta>\\<delta> = wt_subst_compose[OF \\<theta>(1) m(2)] wf_trms_subst_compose[OF \\<theta>(2) m(5)]"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. \\<not> (\\<exists>x\\<in>fv m.\n               t' \\<sqsubseteq> \\<delta> x) \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (cases \"is_Fun m''\")"], ["proof (state)\ngoal (2 subgoals):\n 1. is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case True"], ["proof (state)\nthis:\n  is_Fun m''\n\ngoal (2 subgoals):\n 1. is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_Fun m''\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using \\<theta>(3,4) m'(2,3) m(4) fT t'_m'' \\<theta>\\<delta>"], ["proof (prove)\nusing this:\n  is_Fun m''\n  m'' \\<in> set M\n  m' = m'' \\<cdot> \\<theta>\n  t' = m' \\<cdot> \\<delta>\n  is_Fun m'\n  is_Fun m\n  t' = Fun f T\n  0 < arity f\n  \\<Gamma> t' = Fun f (map \\<Gamma> T)\n  t' = m'' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case False"], ["proof (state)\nthis:\n  \\<not> is_Fun m''\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<not> is_Fun m''", "obtain x where x: \"m'' = Var x\""], ["proof (prove)\nusing this:\n  \\<not> is_Fun m''\n\ngoal (1 subgoal):\n 1. (\\<And>x. m'' = Var x \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by moura"], ["proof (state)\nthis:\n  m'' = Var x\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence \"\\<exists>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M). \\<Gamma> (Var x) = \\<Gamma> (Var y)\" \"t' \\<sqsubseteq> (\\<theta> \\<circ>\\<^sub>s \\<delta>) x\"\n            \"\\<Gamma> (Var x) = Fun f (map \\<Gamma> T)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m ((\\<theta> \\<circ>\\<^sub>s \\<delta>) x)\""], ["proof (prove)\nusing this:\n  m'' = Var x\n\ngoal (1 subgoal):\n 1. (\\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var x) = \\<Gamma> (Var y) &&&\n     t' \\<sqsubseteq> (\\<theta> \\<circ>\\<^sub>s \\<delta>) x) &&&\n    \\<Gamma> (Var x) = Fun f (map \\<Gamma> T) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m ((\\<theta> \\<circ>\\<^sub>s \\<delta>) x)", "using \\<theta>\\<delta> t'_m'' \\<theta>(3) fv_subset[OF \\<theta>(3)] fT(3) subst_apply_term.simps(1)[of x \"\\<theta> \\<circ>\\<^sub>s \\<delta>\"]\n              wt_subst_trm''[OF \\<theta>\\<delta>(1), of \"Var x\"]"], ["proof (prove)\nusing this:\n  m'' = Var x\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n  t' = m'' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  m'' \\<in> set M\n  fv m'' \\<subseteq> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> t' = Fun f (map \\<Gamma> T)\n  Var x \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> =\n  (\\<theta> \\<circ>\\<^sub>s \\<delta>) x\n  \\<Gamma> (Var x) =\n  \\<Gamma> (Var x \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var x) = \\<Gamma> (Var y) &&&\n     t' \\<sqsubseteq> (\\<theta> \\<circ>\\<^sub>s \\<delta>) x) &&&\n    \\<Gamma> (Var x) = Fun f (map \\<Gamma> T) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m ((\\<theta> \\<circ>\\<^sub>s \\<delta>) x)", "by (fastforce, blast, argo, fastforce)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  t' \\<sqsubseteq> (\\<theta> \\<circ>\\<^sub>s \\<delta>) x\n  \\<Gamma> (Var x) = Fun f (map \\<Gamma> T)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ((\\<theta> \\<circ>\\<^sub>s \\<delta>) x)\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun m'' \\<Longrightarrow>\n    (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  t' \\<sqsubseteq> (\\<theta> \\<circ>\\<^sub>s \\<delta>) x\n  \\<Gamma> (Var x) = Fun f (map \\<Gamma> T)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ((\\<theta> \\<circ>\\<^sub>s \\<delta>) x)\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using x TComp_var_instance_closed_has_Fun[\n                of M \"\\<theta> \\<circ>\\<^sub>s \\<delta>\" x t' f \"map \\<Gamma> T\", OF closed(2) M_wf _ _ _ \\<theta>\\<delta>(1) fT(3) prems]"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n     \\<Gamma> (Var x) = \\<Gamma> (Var y)\n  t' \\<sqsubseteq> (\\<theta> \\<circ>\\<^sub>s \\<delta>) x\n  \\<Gamma> (Var x) = Fun f (map \\<Gamma> T)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ((\\<theta> \\<circ>\\<^sub>s \\<delta>) x)\n  m'' = Var x\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m\n            ((\\<theta> \\<circ>\\<^sub>s \\<delta>) x);\n   \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n      \\<Gamma> (Var x) = \\<Gamma> (Var y);\n   t' \\<sqsubseteq> (\\<theta> \\<circ>\\<^sub>s \\<delta>) x\\<rbrakk>\n  \\<Longrightarrow> \\<exists>m\\<in>set M.\n                       \\<exists>\\<theta>.\n                          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                           \\<theta> \\<and>\n                          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                           (subst_range \\<theta>) \\<and>\n                          t' = m \\<cdot> \\<theta> \\<and> is_Fun m\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_D:\n  assumes \"t \\<in> SMP (set M)\" \"is_Fun t\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"((\\<exists>f. t = Fun f []) \\<and> (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>)) \\<or>\n         (\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta> \\<and> is_Fun m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<exists>f. t = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have wf_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n      and closed: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n                  \"has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\"\n                  \"is_TComp_var_instance_closed \\<Gamma> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "using finite_SMP_representationD[OF M_SMP_repr]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) &&&\n    is_TComp_var_instance_closed \\<Gamma> M", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using assms(1,2)"], ["proof (prove)\nusing this:\n  t \\<in> SMP (set M)\n  is_Fun t\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (induction t rule: SMP.induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> set M; is_Fun t\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case (MP t)"], ["proof (state)\nthis:\n  t \\<in> set M\n  is_Fun t\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> set M; is_Fun t\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "moreover"], ["proof (state)\nthis:\n  t \\<in> set M\n  is_Fun t\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> set M; is_Fun t\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var)\" \"t = t \\<cdot> Var\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var) &&&\n    t = t \\<cdot> Var", "by simp_all"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var)\n  t = t \\<cdot> Var\n\ngoal (4 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> set M; is_Fun t\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 3. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 4. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "ultimately"], ["proof (chain)\npicking this:\n  t \\<in> set M\n  is_Fun t\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var)\n  t = t \\<cdot> Var", "show ?case"], ["proof (prove)\nusing this:\n  t \\<in> set M\n  is_Fun t\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var)\n  t = t \\<cdot> Var\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case (Subterm t t')"], ["proof (state)\nthis:\n  t \\<in> SMP (set M)\n  t' \\<sqsubseteq> t\n  is_Fun t \\<Longrightarrow>\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  is_Fun t'\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence t_fun: \"is_Fun t\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (set M)\n  t' \\<sqsubseteq> t\n  is_Fun t \\<Longrightarrow>\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  is_Fun t'\n\ngoal (1 subgoal):\n 1. is_Fun t", "by auto"], ["proof (state)\nthis:\n  is_Fun t\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note * = Subterm.hyps(2) SMP_wf_trm[OF Subterm.hyps(1) wf_M(1)]\n             Subterm.prems Subterm.IH[OF t_fun] M_SMP_repr"], ["proof (state)\nthis:\n  t' \\<sqsubseteq> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  is_Fun t'\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  finite_SMP_representation arity Ana \\<Gamma> M\n\ngoal (3 subgoals):\n 1. \\<And>t t'.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        t' \\<sqsubseteq> t; is_Fun t'\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t' = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 3. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t' = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           t' = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by (rule SMP_D_aux3[OF *])"], ["proof (state)\nthis:\n  (\\<exists>f. t' = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t' = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case (Substitution t \\<delta>)"], ["proof (state)\nthis:\n  t \\<in> SMP (set M)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  is_Fun t \\<Longrightarrow>\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  is_Fun (t \\<cdot> \\<delta>)\n\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by (metis Substitution.hyps(1) wf_M(1) SMP_wf_trm)"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence wf': \"wf\\<^sub>t\\<^sub>r\\<^sub>m (t \\<cdot> \\<delta>)\""], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (t \\<cdot> \\<delta>)", "using Substitution.hyps(3) wf_trm_subst"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range ?\\<delta>) \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (?t \\<cdot> ?\\<delta>)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m (t \\<cdot> \\<delta>)", "by blast"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (t \\<cdot> \\<delta>)\n\ngoal (2 subgoals):\n 1. \\<And>t \\<delta>.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n        is_Fun (t \\<cdot> \\<delta>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>') \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>'.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta>' \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>') \\<and>\n                                t \\<cdot> \\<delta> =\n                                m \\<cdot> \\<delta>' \\<and>\n                                is_Fun m)\n 2. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "proof (cases \"\\<Gamma> t\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "case (Var a)"], ["proof (state)\nthis:\n  \\<Gamma> t = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "hence 1: \"\\<Gamma> (t \\<cdot> \\<delta>) = TAtom a\""], ["proof (prove)\nusing this:\n  \\<Gamma> t = Var a\n\ngoal (1 subgoal):\n 1. \\<Gamma> (t \\<cdot> \\<delta>) = Var a", "using Substitution.hyps(2)"], ["proof (prove)\nusing this:\n  \\<Gamma> t = Var a\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<Gamma> (t \\<cdot> \\<delta>) = Var a", "by (metis wt_subst_trm'')"], ["proof (state)\nthis:\n  \\<Gamma> (t \\<cdot> \\<delta>) = Var a\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> (t \\<cdot> \\<delta>) = Var a", "obtain c where c: \"t \\<cdot> \\<delta> = Fun c []\""], ["proof (prove)\nusing this:\n  \\<Gamma> (t \\<cdot> \\<delta>) = Var a\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        t \\<cdot> \\<delta> = Fun c [] \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using TAtom_term_cases[OF wf' 1] Substitution.prems"], ["proof (prove)\nusing this:\n  \\<Gamma> (t \\<cdot> \\<delta>) = Var a\n  (\\<exists>v. t \\<cdot> \\<delta> = Var v) \\<or>\n  (\\<exists>f. t \\<cdot> \\<delta> = Fun f [])\n  is_Fun (t \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        t \\<cdot> \\<delta> = Fun c [] \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  t \\<cdot> \\<delta> = Fun c []\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "hence \"(\\<exists>x. t = Var x) \\<or> t = t \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  t \\<cdot> \\<delta> = Fun c []\n\ngoal (1 subgoal):\n 1. (\\<exists>x. t = Var x) \\<or> t = t \\<cdot> \\<delta>", "by (cases t) auto"], ["proof (state)\nthis:\n  (\\<exists>x. t = Var x) \\<or> t = t \\<cdot> \\<delta>\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       \\<Gamma> t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<exists>x. t = Var x) \\<or> t = t \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. t = t \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "assume t_Var: \"\\<exists>x. t = Var x\""], ["proof (state)\nthis:\n  \\<exists>x. t = Var x\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. t = t \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<exists>x. t = Var x", "obtain x where x: \"t = Var x\" \"\\<delta> x = Fun c []\" \"\\<Gamma> (Var x) = TAtom a\""], ["proof (prove)\nusing this:\n  \\<exists>x. t = Var x\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>t = Var x; \\<delta> x = Fun c [];\n         \\<Gamma> (Var x) = Var a\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using c 1 wt_subst_trm''[OF Substitution.hyps(2), of t]"], ["proof (prove)\nusing this:\n  \\<exists>x. t = Var x\n  t \\<cdot> \\<delta> = Fun c []\n  \\<Gamma> (t \\<cdot> \\<delta>) = Var a\n  \\<Gamma> t = \\<Gamma> (t \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>t = Var x; \\<delta> x = Fun c [];\n         \\<Gamma> (Var x) = Var a\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  t = Var x\n  \\<delta> x = Fun c []\n  \\<Gamma> (Var x) = Var a\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. t = t \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "obtain m \\<theta> where m: \"m \\<in> set M\" \"t = m \\<cdot> \\<theta>\" and \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>m \\<theta>.\n        \\<lbrakk>m \\<in> set M; t = m \\<cdot> \\<theta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using SMP_D_aux2[OF Substitution.hyps(1) t_Var M_SMP_repr]"], ["proof (prove)\nusing this:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<delta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n        t = m \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<theta>.\n        \\<lbrakk>m \\<in> set M; t = m \\<cdot> \\<theta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  m \\<in> set M\n  t = m \\<cdot> \\<theta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. t = t \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "have \"m \\<cdot> (\\<theta> \\<circ>\\<^sub>s \\<delta>) = Fun c []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> = Fun c []", "using c m(2)"], ["proof (prove)\nusing this:\n  t \\<cdot> \\<delta> = Fun c []\n  t = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> = Fun c []", "by auto"], ["proof (state)\nthis:\n  m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> = Fun c []\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. t = t \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> = Fun c []\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "using c m(1) wt_subst_compose[OF \\<theta>(1) Substitution.hyps(2)]\n                wf_trms_subst_compose[OF \\<theta>(2) Substitution.hyps(3)]"], ["proof (prove)\nusing this:\n  m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> = Fun c []\n  t \\<cdot> \\<delta> = Fun c []\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "by metis"], ["proof (state)\nthis:\n  (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. t = t \\<cdot> \\<delta> \\<Longrightarrow>\n    (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "qed (use c Substitution.IH in auto)"], ["proof (state)\nthis:\n  (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "case (Fun f T)"], ["proof (state)\nthis:\n  \\<Gamma> t = Fun f T\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "hence 1: \"\\<Gamma> (t \\<cdot> \\<delta>) = TComp f T\""], ["proof (prove)\nusing this:\n  \\<Gamma> t = Fun f T\n\ngoal (1 subgoal):\n 1. \\<Gamma> (t \\<cdot> \\<delta>) = Fun f T", "using Substitution.hyps(2)"], ["proof (prove)\nusing this:\n  \\<Gamma> t = Fun f T\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. \\<Gamma> (t \\<cdot> \\<delta>) = Fun f T", "by (metis wt_subst_trm'')"], ["proof (state)\nthis:\n  \\<Gamma> (t \\<cdot> \\<delta>) = Fun f T\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "have 2: \"\\<not>(\\<exists>f. t = Fun f [])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f []", "using Fun TComp_term_cases[OF wf]"], ["proof (prove)\nusing this:\n  \\<Gamma> t = Fun f T\n  \\<Gamma> t = Fun ?f ?T \\<Longrightarrow>\n  (\\<exists>v. t = Var v) \\<or>\n  (\\<exists>T'.\n      t = Fun ?f T' \\<and> ?T = map \\<Gamma> T' \\<and> T' \\<noteq> [])\n\ngoal (1 subgoal):\n 1. \\<nexists>f. t = Fun f []", "by auto"], ["proof (state)\nthis:\n  \\<nexists>f. t = Fun f []\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "obtain T'' where T'': \"t \\<cdot> \\<delta> = Fun f T''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>T''.\n        t \\<cdot> \\<delta> = Fun f T'' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using 1 2 fun_type_id_eq Fun Substitution.prems"], ["proof (prove)\nusing this:\n  \\<Gamma> (t \\<cdot> \\<delta>) = Fun f T\n  \\<nexists>f. t = Fun f []\n  \\<Gamma> (Fun ?f ?X) = Fun ?g ?Y \\<Longrightarrow> ?f = ?g\n  \\<Gamma> t = Fun f T\n  is_Fun (t \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>T''.\n        t \\<cdot> \\<delta> = Fun f T'' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  t \\<cdot> \\<delta> = Fun f T''\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "have f: \"arity f > 0\" \"public f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity f &&& public f", "using fun_type_inv[OF 1]"], ["proof (prove)\nusing this:\n  0 < arity f\n  public f\n\ngoal (1 subgoal):\n 1. 0 < arity f &&& public f", "by metis+"], ["proof (state)\nthis:\n  0 < arity f\n  public f\n\ngoal (1 subgoal):\n 1. \\<And>x21 x22.\n       \\<Gamma> t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "proof (cases t)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "case (Fun g U)"], ["proof (state)\nthis:\n  t = Fun g U\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  t = Fun g U", "obtain m \\<theta> where m:\n            \"m \\<in> set M\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"t = m \\<cdot> \\<theta>\" \"is_Fun m\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\nusing this:\n  t = Fun g U\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<theta>.\n        \\<lbrakk>m \\<in> set M;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         t = m \\<cdot> \\<theta>; is_Fun m;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Substitution.IH Fun 2"], ["proof (prove)\nusing this:\n  t = Fun g U\n  is_Fun t \\<Longrightarrow>\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  t = Fun g U\n  \\<nexists>f. t = Fun f []\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<theta>.\n        \\<lbrakk>m \\<in> set M;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         t = m \\<cdot> \\<theta>; is_Fun m;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  t = m \\<cdot> \\<theta>\n  is_Fun m\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "have \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta> \\<circ>\\<^sub>s \\<delta>)\" \"t \\<cdot> \\<delta> = m \\<cdot> (\\<theta> \\<circ>\\<^sub>s \\<delta>)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>) &&&\n    t \\<cdot> \\<delta> = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))", "using wt_subst_compose[OF m(2) Substitution.hyps(2)] m(3)\n                wf_trms_subst_compose[OF m(5) Substitution.hyps(3)]"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  t = m \\<cdot> \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>) &&&\n    t \\<cdot> \\<delta> = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))", "by auto"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  t \\<cdot> \\<delta> = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n 2. \\<And>x21 x22.\n       t = Fun x21 x22 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  t \\<cdot> \\<delta> = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "using m(1,4)"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  t \\<cdot> \\<delta> = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n  m \\<in> set M\n  is_Fun m\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "by metis"], ["proof (state)\nthis:\n  (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "case (Var x)"], ["proof (state)\nthis:\n  t = Var x\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  t = Var x", "obtain y where y: \"y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\" \"\\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\nusing this:\n  t = Var x\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using SMP_D_aux1[OF Substitution.hyps(1) closed(1,3) wf_M] Fun"], ["proof (prove)\nusing this:\n  t = Var x\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  \\<Gamma> t = Fun f T\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "hence 3: \"\\<Gamma> (Var y) = TComp f T\""], ["proof (prove)\nusing this:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var y) = Fun f T", "using Var Fun \\<Gamma>_Var_fst"], ["proof (prove)\nusing this:\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  t = Var x\n  \\<Gamma> t = Fun f T\n  \\<Gamma> (Var (?\\<tau>, ?n)) = \\<Gamma> (Var (?\\<tau>, ?m))\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var y) = Fun f T", "by simp"], ["proof (state)\nthis:\n  \\<Gamma> (Var y) = Fun f T\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "obtain h V where V:\n            \"Fun h V \\<in> set M\" \"\\<Gamma> (Fun h V) = \\<Gamma> (Var y)\" \"\\<forall>u \\<in> set V. \\<exists>z. u = Var z\" \"distinct V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>h V.\n        \\<lbrakk>Fun h V \\<in> set M; \\<Gamma> (Fun h V) = \\<Gamma> (Var y);\n         \\<forall>u\\<in>set V. \\<exists>z. u = Var z; distinct V\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis is_VarE is_TComp_var_instance_closedD[OF _ 3 closed(3)] y(1))"], ["proof (state)\nthis:\n  Fun h V \\<in> set M\n  \\<Gamma> (Fun h V) = \\<Gamma> (Var y)\n  \\<forall>u\\<in>set V. \\<exists>z. u = Var z\n  distinct V\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "moreover"], ["proof (state)\nthis:\n  Fun h V \\<in> set M\n  \\<Gamma> (Fun h V) = \\<Gamma> (Var y)\n  \\<forall>u\\<in>set V. \\<exists>z. u = Var z\n  distinct V\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "have \"length T'' = length V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length T'' = length V", "using 3 V(2) fun_type_length_eq 1 T''"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var y) = Fun f T\n  \\<Gamma> (Fun h V) = \\<Gamma> (Var y)\n  \\<Gamma> (Fun ?f ?X) = Fun ?g ?Y \\<Longrightarrow> length ?X = length ?Y\n  \\<Gamma> (t \\<cdot> \\<delta>) = Fun f T\n  t \\<cdot> \\<delta> = Fun f T''\n\ngoal (1 subgoal):\n 1. length T'' = length V", "by metis"], ["proof (state)\nthis:\n  length T'' = length V\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "ultimately"], ["proof (chain)\npicking this:\n  Fun h V \\<in> set M\n  \\<Gamma> (Fun h V) = \\<Gamma> (Var y)\n  \\<forall>u\\<in>set V. \\<exists>z. u = Var z\n  distinct V\n  length T'' = length V", "have TV: \"T = map \\<Gamma> V\""], ["proof (prove)\nusing this:\n  Fun h V \\<in> set M\n  \\<Gamma> (Fun h V) = \\<Gamma> (Var y)\n  \\<forall>u\\<in>set V. \\<exists>z. u = Var z\n  distinct V\n  length T'' = length V\n\ngoal (1 subgoal):\n 1. T = map \\<Gamma> V", "by (metis fun_type[OF f(1)] 3 fun_type_id_eq term.inject(2))"], ["proof (state)\nthis:\n  T = map \\<Gamma> V\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "obtain \\<theta> where \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\" \"t \\<cdot> \\<delta> = Fun h V \\<cdot> \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<theta>.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t \\<cdot> \\<delta> = Fun h V \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using TComp_var_instance_wt_subst_exists 1 3 T'' TV V(2,3,4) wf'"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<Gamma> (Fun ?g ?T) = Fun ?g (map \\<Gamma> ?U);\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun ?g ?T);\n   \\<forall>u\\<in>set ?U. \\<exists>y. u = Var y; distinct ?U\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<theta>.\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<theta> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<theta>) \\<and>\n                       Fun ?g ?T = Fun ?g ?U \\<cdot> \\<theta>\n  \\<Gamma> (t \\<cdot> \\<delta>) = Fun f T\n  \\<Gamma> (Var y) = Fun f T\n  t \\<cdot> \\<delta> = Fun f T''\n  T = map \\<Gamma> V\n  \\<Gamma> (Fun h V) = \\<Gamma> (Var y)\n  \\<forall>u\\<in>set V. \\<exists>z. u = Var z\n  distinct V\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (t \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta>.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t \\<cdot> \\<delta> = Fun h V \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis fun_type_id_eq)"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t \\<cdot> \\<delta> = Fun h V \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "have 9: \"\\<Gamma> (Fun h V) = \\<Gamma> (\\<delta> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun h V) = \\<Gamma> (\\<delta> x)", "using y(2) Substitution.hyps(2) V(2) 1 3 Var"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  \\<Gamma> (Fun h V) = \\<Gamma> (Var y)\n  \\<Gamma> (t \\<cdot> \\<delta>) = Fun f T\n  \\<Gamma> (Var y) = Fun f T\n  t = Var x\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Fun h V) = \\<Gamma> (\\<delta> x)", "by auto"], ["proof (state)\nthis:\n  \\<Gamma> (Fun h V) = \\<Gamma> (\\<delta> x)\n\ngoal (1 subgoal):\n 1. \\<And>x1.\n       t = Var x1 \\<Longrightarrow>\n       (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n       (\\<exists>m\\<in>set M.\n           \\<exists>\\<delta>'.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>') \\<and>\n              t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "using Var \\<theta> 9 V(1)"], ["proof (prove)\nusing this:\n  t = Var x\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t \\<cdot> \\<delta> = Fun h V \\<cdot> \\<theta>\n  \\<Gamma> (Fun h V) = \\<Gamma> (\\<delta> x)\n  Fun h V \\<in> set M\n\ngoal (1 subgoal):\n 1. (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>'.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n           t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)", "by force"], ["proof (state)\nthis:\n  (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t \\<cdot> \\<delta> = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>') \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>'.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>' \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>') \\<and>\n         t \\<cdot> \\<delta> = m \\<cdot> \\<delta>' \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case (Ana t K T k)"], ["proof (state)\nthis:\n  t \\<in> SMP (set M)\n  Ana t = (K, T)\n  k \\<in> set K\n  is_Fun t \\<Longrightarrow>\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  is_Fun k\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have 1: \"is_Fun t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_Fun t", "using Ana.hyps(2,3)"], ["proof (prove)\nusing this:\n  Ana t = (K, T)\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. is_Fun t", "by auto"], ["proof (state)\nthis:\n  is_Fun t\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  is_Fun t", "obtain f U where U: \"t = Fun f U\""], ["proof (prove)\nusing this:\n  is_Fun t\n\ngoal (1 subgoal):\n 1. (\\<And>f U. t = Fun f U \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t = Fun f U\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have 2: \"fv k \\<subseteq> fv t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv k \\<subseteq> fv t", "using Ana_keys_fv[OF Ana.hyps(2)] Ana.hyps(3)"], ["proof (prove)\nusing this:\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set K) \\<subseteq> fv t\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. fv k \\<subseteq> fv t", "by auto"], ["proof (state)\nthis:\n  fv k \\<subseteq> fv t\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have wf_t: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using SMP_wf_trm[OF Ana.hyps(1)] wf\\<^sub>t\\<^sub>r\\<^sub>m_code wf_M"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t = wf\\<^sub>t\\<^sub>r\\<^sub>m' arity ?t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence wf_k: \"wf\\<^sub>t\\<^sub>r\\<^sub>m k\""], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m k", "using Ana_keys_wf'[OF Ana.hyps(2)] wf\\<^sub>t\\<^sub>r\\<^sub>m_code Ana.hyps(3)"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m t; ?k \\<in> set K\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?k\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t = wf\\<^sub>t\\<^sub>r\\<^sub>m' arity ?t\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m k", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m k\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have wf_M_keys: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "assume \"t \\<in> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M))\""], ["proof (state)\nthis:\n  t \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "then"], ["proof (chain)\npicking this:\n  t \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)", "obtain s where s: \"s \\<in> set M\" \"t \\<in> (set \\<circ> fst \\<circ> Ana) s\""], ["proof (prove)\nusing this:\n  t \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> set M;\n         t \\<in> (set \\<circ> fst \\<circ> Ana) s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  s \\<in> set M\n  t \\<in> (set \\<circ> fst \\<circ> Ana) s\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "obtain K R where KR: \"Ana s = (K,R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>K R. Ana s = (K, R) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis surj_pair)"], ["proof (state)\nthis:\n  Ana s = (K, R)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "hence \"t \\<in> set K\""], ["proof (prove)\nusing this:\n  Ana s = (K, R)\n\ngoal (1 subgoal):\n 1. t \\<in> set K", "using s(2)"], ["proof (prove)\nusing this:\n  Ana s = (K, R)\n  t \\<in> (set \\<circ> fst \\<circ> Ana) s\n\ngoal (1 subgoal):\n 1. t \\<in> set K", "by simp"], ["proof (state)\nthis:\n  t \\<in> set K\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "thus \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\nusing this:\n  t \\<in> set K\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using Ana_keys_wf'[OF KR] wf_M s(1)"], ["proof (prove)\nusing this:\n  t \\<in> set K\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m s; ?k \\<in> set K\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m ?k\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  s \\<in> set M\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by blast"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))\n\ngoal (1 subgoal):\n 1. \\<And>t K T k.\n       \\<lbrakk>t \\<in> SMP (set M);\n        is_Fun t \\<Longrightarrow>\n        (\\<exists>f. t = Fun f []) \\<and>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta>) \\<or>\n        (\\<exists>m\\<in>set M.\n            \\<exists>\\<delta>.\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               t = m \\<cdot> \\<delta> \\<and> is_Fun m);\n        Ana t = (K, T); k \\<in> set K; is_Fun k\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>f. k = Fun f []) \\<and>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta>) \\<or>\n                         (\\<exists>m\\<in>set M.\n                             \\<exists>\\<delta>.\n                                wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                                 \\<delta> \\<and>\n                                wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                                 (subst_range \\<delta>) \\<and>\n                                k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using Ana_subst'_or_Ana_keys_subterm"], ["proof (prove)\nusing this:\n  (\\<forall>f T \\<delta> K R.\n      Ana (Fun f T) = (K, R) \\<longrightarrow>\n      Ana (Fun f T \\<cdot> \\<delta>) =\n      (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n       R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)) \\<or>\n  (\\<forall>t K R k.\n      Ana t = (K, R) \\<longrightarrow>\n      k \\<in> set K \\<longrightarrow> k \\<sqsubset> t)\n\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<forall>t K R k.\n       Ana t = (K, R) \\<longrightarrow>\n       k \\<in> set K \\<longrightarrow> k \\<sqsubset> t \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "assume \"\\<forall>t K T k. Ana t = (K, T) \\<longrightarrow> k \\<in> set K \\<longrightarrow> k \\<sqsubset> t\""], ["proof (state)\nthis:\n  \\<forall>t K T k.\n     Ana t = (K, T) \\<longrightarrow>\n     k \\<in> set K \\<longrightarrow> k \\<sqsubset> t\n\ngoal (2 subgoals):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<forall>t K R k.\n       Ana t = (K, R) \\<longrightarrow>\n       k \\<in> set K \\<longrightarrow> k \\<sqsubset> t \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence *: \"k \\<sqsubseteq> t\""], ["proof (prove)\nusing this:\n  \\<forall>t K T k.\n     Ana t = (K, T) \\<longrightarrow>\n     k \\<in> set K \\<longrightarrow> k \\<sqsubset> t\n\ngoal (1 subgoal):\n 1. k \\<sqsubseteq> t", "using Ana.hyps(2,3)"], ["proof (prove)\nusing this:\n  \\<forall>t K T k.\n     Ana t = (K, T) \\<longrightarrow>\n     k \\<in> set K \\<longrightarrow> k \\<sqsubset> t\n  Ana t = (K, T)\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. k \\<sqsubseteq> t", "by auto"], ["proof (state)\nthis:\n  k \\<sqsubseteq> t\n\ngoal (2 subgoals):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<forall>t K R k.\n       Ana t = (K, R) \\<longrightarrow>\n       k \\<in> set K \\<longrightarrow> k \\<sqsubset> t \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by (rule SMP_D_aux3[OF * wf_t Ana.prems Ana.IH[OF 1] M_SMP_repr])"], ["proof (state)\nthis:\n  (\\<exists>f. k = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "assume Ana_subst':\n          \"\\<forall>f T \\<delta> K M. Ana (Fun f T) = (K, M) \\<longrightarrow> Ana (Fun f T \\<cdot> \\<delta>) = (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>, M \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\""], ["proof (state)\nthis:\n  \\<forall>f T \\<delta> K M.\n     Ana (Fun f T) = (K, M) \\<longrightarrow>\n     Ana (Fun f T \\<cdot> \\<delta>) =\n     (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n      M \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have \"arity f > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < arity f", "using Ana_const[of f U] U Ana.hyps(2,3)"], ["proof (prove)\nusing this:\n  arity f = 0 \\<Longrightarrow> Ana (Fun f U) = ([], [])\n  t = Fun f U\n  Ana t = (K, T)\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. 0 < arity f", "by fastforce"], ["proof (state)\nthis:\n  0 < arity f\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence \"U \\<noteq> []\""], ["proof (prove)\nusing this:\n  0 < arity f\n\ngoal (1 subgoal):\n 1. U \\<noteq> []", "using wf_t U"], ["proof (prove)\nusing this:\n  0 < arity f\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n  t = Fun f U\n\ngoal (1 subgoal):\n 1. U \\<noteq> []", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  0 < arity f\n  \\<forall>f T. Fun f T \\<sqsubseteq> t \\<longrightarrow> length T = arity f\n  t = Fun f U\n\ngoal (1 subgoal):\n 1. U \\<noteq> []", "by force"], ["proof (state)\nthis:\n  U \\<noteq> []\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  U \\<noteq> []", "obtain m \\<delta> where m: \"m \\<in> set M\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\" \"t = m \\<cdot> \\<delta>\" \"is_Fun m\""], ["proof (prove)\nusing this:\n  U \\<noteq> []\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n         t = m \\<cdot> \\<delta>; is_Fun m\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Ana.IH[OF 1] U"], ["proof (prove)\nusing this:\n  U \\<noteq> []\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  t = Fun f U\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>);\n         t = m \\<cdot> \\<delta>; is_Fun m\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = m \\<cdot> \\<delta>\n  is_Fun m\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence \"Ana (t \\<cdot> \\<delta>) = (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\""], ["proof (prove)\nusing this:\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = m \\<cdot> \\<delta>\n  is_Fun m\n\ngoal (1 subgoal):\n 1. Ana (t \\<cdot> \\<delta>) =\n    (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n     T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "using Ana_subst' U Ana.hyps(2)"], ["proof (prove)\nusing this:\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = m \\<cdot> \\<delta>\n  is_Fun m\n  \\<forall>f T \\<delta> K M.\n     Ana (Fun f T) = (K, M) \\<longrightarrow>\n     Ana (Fun f T \\<cdot> \\<delta>) =\n     (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n      M \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n  t = Fun f U\n  Ana t = (K, T)\n\ngoal (1 subgoal):\n 1. Ana (t \\<cdot> \\<delta>) =\n    (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n     T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "by auto"], ["proof (state)\nthis:\n  Ana (t \\<cdot> \\<delta>) =\n  (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n   T \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "obtain Km Tm where Ana_m: \"Ana m = (Km,Tm)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>Km Tm.\n        Ana m = (Km, Tm) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  Ana m = (Km, Tm)\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence \"Ana (m \\<cdot> \\<delta>) = (Km \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,Tm \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\""], ["proof (prove)\nusing this:\n  Ana m = (Km, Tm)\n\ngoal (1 subgoal):\n 1. Ana (m \\<cdot> \\<delta>) =\n    (Km \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n     Tm \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "using Ana_subst' U m(4) is_FunE[OF m(5)] Ana.hyps(2)"], ["proof (prove)\nusing this:\n  Ana m = (Km, Tm)\n  \\<forall>f T \\<delta> K M.\n     Ana (Fun f T) = (K, M) \\<longrightarrow>\n     Ana (Fun f T \\<cdot> \\<delta>) =\n     (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n      M \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n  t = Fun f U\n  t = m \\<cdot> \\<delta>\n  (\\<And>f ts. m = Fun f ts \\<Longrightarrow> ?P) \\<Longrightarrow> ?P\n  Ana t = (K, T)\n\ngoal (1 subgoal):\n 1. Ana (m \\<cdot> \\<delta>) =\n    (Km \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n     Tm \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "by metis"], ["proof (state)\nthis:\n  Ana (m \\<cdot> \\<delta>) =\n  (Km \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n   Tm \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  Ana (m \\<cdot> \\<delta>) =\n  (Km \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n   Tm \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "obtain km where km: \"km \\<in> set Km\" \"k = km \\<cdot> \\<delta>\""], ["proof (prove)\nusing this:\n  Ana (m \\<cdot> \\<delta>) =\n  (Km \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n   Tm \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>km.\n        \\<lbrakk>km \\<in> set Km; k = km \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Ana.hyps(2,3) m(4)"], ["proof (prove)\nusing this:\n  Ana (m \\<cdot> \\<delta>) =\n  (Km \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n   Tm \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n  Ana t = (K, T)\n  k \\<in> set K\n  t = m \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>km.\n        \\<lbrakk>km \\<in> set Km; k = km \\<cdot> \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  km \\<in> set Km\n  k = km \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  km \\<in> set Km\n  k = km \\<cdot> \\<delta>", "obtain \\<theta> km' where \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\"\n          and km': \"km' \\<in> set M\" \"km = km' \\<cdot> \\<theta>\""], ["proof (prove)\nusing this:\n  km \\<in> set Km\n  k = km \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta> km'.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         km' \\<in> set M; km = km' \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Ana_m m(1) has_all_wt_instances_ofD'[OF wf_M_keys wf_M closed(2), of km]"], ["proof (prove)\nusing this:\n  km \\<in> set Km\n  k = km \\<cdot> \\<delta>\n  Ana m = (Km, Tm)\n  m \\<in> set M\n  km \\<in> \\<Union>\n            ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     km \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta> km'.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         km' \\<in> set M; km = km' \\<cdot> \\<theta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  km' \\<in> set M\n  km = km' \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have k\\<theta>\\<delta>: \"k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t (\\<theta> \\<circ>\\<^sub>s \\<delta>)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> &&&\n    wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))", "using km(2) km' wt_subst_compose[OF \\<theta>(1) m(2)] wf_trms_subst_compose[OF \\<theta>(2) m(3)]"], ["proof (prove)\nusing this:\n  k = km \\<cdot> \\<delta>\n  km' \\<in> set M\n  km = km' \\<cdot> \\<theta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> &&&\n    wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n     (\\<theta> \\<circ>\\<^sub>s \\<delta>) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))", "by auto"], ["proof (state)\nthis:\n  k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. \\<forall>f T \\<delta> K R.\n       Ana (Fun f T) = (K, R) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        R \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n        \\<delta>) \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (cases \"is_Fun km'\")"], ["proof (state)\ngoal (2 subgoals):\n 1. is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case True"], ["proof (state)\nthis:\n  is_Fun km'\n\ngoal (2 subgoals):\n 1. is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  is_Fun km'\n\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using k\\<theta>\\<delta> km'(1)"], ["proof (prove)\nusing this:\n  is_Fun km'\n  k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n  km' \\<in> set M\n\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>f. k = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case False"], ["proof (state)\nthis:\n  \\<not> is_Fun km'\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "note F = False"], ["proof (state)\nthis:\n  \\<not> is_Fun km'\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<not> is_Fun km'", "obtain x where x: \"km' = Var x\""], ["proof (prove)\nusing this:\n  \\<not> is_Fun km'\n\ngoal (1 subgoal):\n 1. (\\<And>x. km' = Var x \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  km' = Var x\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence 3: \"x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\""], ["proof (prove)\nusing this:\n  km' = Var x\n\ngoal (1 subgoal):\n 1. x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "using fv_subset[OF km'(1)]"], ["proof (prove)\nusing this:\n  km' = Var x\n  fv km' \\<subseteq> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n\ngoal (1 subgoal):\n 1. x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "by auto"], ["proof (state)\nthis:\n  x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "obtain kf kT where kf: \"k = Fun kf kT\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>kf kT. k = Fun kf kT \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using Ana.prems"], ["proof (prove)\nusing this:\n  is_Fun k\n\ngoal (1 subgoal):\n 1. (\\<And>kf kT. k = Fun kf kT \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  k = Fun kf kT\n\ngoal (1 subgoal):\n 1. \\<not> is_Fun km' \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "proof (cases \"kT = []\")"], ["proof (state)\ngoal (2 subgoals):\n 1. kT = [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case True"], ["proof (state)\nthis:\n  kT = []\n\ngoal (2 subgoals):\n 1. kT = [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n 2. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  kT = []\n\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using k\\<theta>\\<delta>(1) k\\<theta>\\<delta>(2) k\\<theta>\\<delta>(3) kf km'(1)"], ["proof (prove)\nusing this:\n  kT = []\n  k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n  k = Fun kf kT\n  km' \\<in> set M\n\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by blast"], ["proof (state)\nthis:\n  (\\<exists>f. k = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "case False"], ["proof (state)\nthis:\n  kT \\<noteq> []\n\ngoal (1 subgoal):\n 1. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "hence 4: \"arity kf > 0\""], ["proof (prove)\nusing this:\n  kT \\<noteq> []\n\ngoal (1 subgoal):\n 1. 0 < arity kf", "using wf_k kf TAtom_term_cases const_type"], ["proof (prove)\nusing this:\n  kT \\<noteq> []\n  wf\\<^sub>t\\<^sub>r\\<^sub>m k\n  k = Fun kf kT\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; \\<Gamma> ?t = Var ?\\<tau>\\<rbrakk>\n  \\<Longrightarrow> (\\<exists>v. ?t = Var v) \\<or>\n                    (\\<exists>f. ?t = Fun f [])\n  arity ?c = 0 \\<Longrightarrow>\n  \\<exists>a. \\<forall>T. \\<Gamma> (Fun ?c T) = Var a\n\ngoal (1 subgoal):\n 1. 0 < arity kf", "by fastforce"], ["proof (state)\nthis:\n  0 < arity kf\n\ngoal (1 subgoal):\n 1. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  0 < arity kf", "obtain kT' where kT': \"\\<Gamma> k = TComp kf kT'\""], ["proof (prove)\nusing this:\n  0 < arity kf\n\ngoal (1 subgoal):\n 1. (\\<And>kT'.\n        \\<Gamma> k = Fun kf kT' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (simp add: fun_type kf)"], ["proof (state)\nthis:\n  \\<Gamma> k = Fun kf kT'\n\ngoal (1 subgoal):\n 1. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "then"], ["proof (chain)\npicking this:\n  \\<Gamma> k = Fun kf kT'", "obtain V where V:\n              \"Fun kf V \\<in> set M\" \"\\<Gamma> (Fun kf V) = \\<Gamma> (Var x)\" \"\\<forall>u \\<in> set V. \\<exists>v. u = Var v\"\n              \"distinct V\" \"is_Fun (Fun kf V)\""], ["proof (prove)\nusing this:\n  \\<Gamma> k = Fun kf kT'\n\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>Fun kf V \\<in> set M;\n         \\<Gamma> (Fun kf V) = \\<Gamma> (Var x);\n         \\<forall>u\\<in>set V. \\<exists>v. u = Var v; distinct V;\n         is_Fun (Fun kf V)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using is_TComp_var_instance_closedD[OF _ _ closed(3), of x]\n                  x m(2) k\\<theta>\\<delta>(1) 3 wt_subst_trm''[OF k\\<theta>\\<delta>(2)]"], ["proof (prove)\nusing this:\n  \\<Gamma> k = Fun kf kT'\n  \\<lbrakk>\\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n              \\<Gamma> (Var x) = \\<Gamma> (Var y);\n   \\<Gamma> (Var x) = Fun ?f ?T\\<rbrakk>\n  \\<Longrightarrow> \\<exists>g U.\n                       Fun g U \\<in> set M \\<and>\n                       \\<Gamma> (Fun g U) = \\<Gamma> (Var x) \\<and>\n                       (\\<forall>u\\<in>set U. is_Var u) \\<and> distinct U\n  km' = Var x\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  x \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>)\n\ngoal (1 subgoal):\n 1. (\\<And>V.\n        \\<lbrakk>Fun kf V \\<in> set M;\n         \\<Gamma> (Fun kf V) = \\<Gamma> (Var x);\n         \\<forall>u\\<in>set V. \\<exists>v. u = Var v; distinct V;\n         is_Fun (Fun kf V)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis fun_type_id_eq term.disc(2) is_VarE)"], ["proof (state)\nthis:\n  Fun kf V \\<in> set M\n  \\<Gamma> (Fun kf V) = \\<Gamma> (Var x)\n  \\<forall>u\\<in>set V. \\<exists>v. u = Var v\n  distinct V\n  is_Fun (Fun kf V)\n\ngoal (1 subgoal):\n 1. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "have 5: \"kT' = map \\<Gamma> V\""], ["proof (prove)\ngoal (1 subgoal):\n 1. kT' = map \\<Gamma> V", "using fun_type[OF 4] x kT' k\\<theta>\\<delta> m(2) V(2)"], ["proof (prove)\nusing this:\n  \\<Gamma> (Fun kf ?T) = Fun kf (map \\<Gamma> ?T)\n  km' = Var x\n  \\<Gamma> k = Fun kf kT'\n  k = km' \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  \\<Gamma> (Fun kf V) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. kT' = map \\<Gamma> V", "by (metis term.inject(2) wt_subst_trm'')"], ["proof (state)\nthis:\n  kT' = map \\<Gamma> V\n\ngoal (1 subgoal):\n 1. kT \\<noteq> [] \\<Longrightarrow>\n    (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "thus ?thesis"], ["proof (prove)\nusing this:\n  kT' = map \\<Gamma> V\n\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "using TComp_var_instance_wt_subst_exists wf_k kf 4 V(3,4) kT' V(1,5)"], ["proof (prove)\nusing this:\n  kT' = map \\<Gamma> V\n  \\<lbrakk>\\<Gamma> (Fun ?g ?T) = Fun ?g (map \\<Gamma> ?U);\n   wf\\<^sub>t\\<^sub>r\\<^sub>m (Fun ?g ?T);\n   \\<forall>u\\<in>set ?U. \\<exists>y. u = Var y; distinct ?U\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<theta>.\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<theta> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<theta>) \\<and>\n                       Fun ?g ?T = Fun ?g ?U \\<cdot> \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m k\n  k = Fun kf kT\n  0 < arity kf\n  \\<forall>u\\<in>set V. \\<exists>v. u = Var v\n  distinct V\n  \\<Gamma> k = Fun kf kT'\n  Fun kf V \\<in> set M\n  is_Fun (Fun kf V)\n\ngoal (1 subgoal):\n 1. (\\<exists>f. k = Fun f []) \\<and>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta>) \\<or>\n    (\\<exists>m\\<in>set M.\n        \\<exists>\\<delta>.\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           k = m \\<cdot> \\<delta> \\<and> is_Fun m)", "by metis"], ["proof (state)\nthis:\n  (\\<exists>f. k = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. k = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. k = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. k = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         k = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_D':\n  fixes M\n  defines \"\\<delta> \\<equiv> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)))\"\n  assumes M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n    and s: \"s \\<in> SMP (set M)\" \"is_Fun s\" \"\\<nexists>f. s = Fun f []\"\n    and t: \"t \\<in> SMP (set M)\" \"is_Fun t\" \"\\<nexists>f. t = Fun f []\"\n  obtains \\<sigma> s0 \\<theta> t0\n  where \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>)\" \"s0 \\<in> set M\" \"is_Fun s0\" \"s = s0 \\<cdot> \\<sigma>\" \"\\<Gamma> s = \\<Gamma> s0\"\n    and \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\" \"t0 \\<in> set M\" \"is_Fun t0\" \"t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>\" \"\\<Gamma> t = \\<Gamma> t0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0 \\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n         \\<Gamma> s = \\<Gamma> s0;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M; is_Fun t0;\n         t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>;\n         \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0 \\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n         \\<Gamma> s = \\<Gamma> s0;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M; is_Fun t0;\n         t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>;\n         \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "obtain \\<sigma> s0 where\n      s0: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>)\" \"s0 \\<in> set M\" \"s = s0 \\<cdot> \\<sigma>\" \"is_Fun s0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; s = s0 \\<cdot> \\<sigma>; is_Fun s0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using s(3) SMP_D[OF s(1,2) M_SMP_repr]"], ["proof (prove)\nusing this:\n  \\<nexists>f. s = Fun f []\n  (\\<exists>f. s = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         s = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         s = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; s = s0 \\<cdot> \\<sigma>; is_Fun s0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding \\<delta>_def"], ["proof (prove)\nusing this:\n  \\<nexists>f. s = Fun f []\n  (\\<exists>f. s = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         s = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         s = m \\<cdot> \\<delta> \\<and> is_Fun m)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; s = s0 \\<cdot> \\<sigma>; is_Fun s0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>)\n  s0 \\<in> set M\n  s = s0 \\<cdot> \\<sigma>\n  is_Fun s0\n\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0 \\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n         \\<Gamma> s = \\<Gamma> s0;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M; is_Fun t0;\n         t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>;\n         \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "obtain \\<theta> t0 where t0:\n      \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\" \"t0 \\<in> set M\" \"t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>\" \"is_Fun t0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M; t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>;\n         is_Fun t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using t(3) SMP_D[OF t(1,2) M_SMP_repr] var_rename_wt'[of _ t]\n          wf_trms_subst_compose_Var_range(1)[OF _ var_rename_is_renaming(2)]"], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f []\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   t = ?m \\<cdot> ?\\<delta>\\<rbrakk>\n  \\<Longrightarrow> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                     (var_rename_inv ?n \\<circ>\\<^sub>s ?\\<delta>)\n  \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   t = ?m \\<cdot> ?\\<delta>\\<rbrakk>\n  \\<Longrightarrow> t =\n                    ?m \\<cdot> var_rename ?n \\<cdot>\n                    var_rename_inv ?n \\<circ>\\<^sub>s ?\\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range ?\\<theta>) \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (var_rename_inv ?n1 \\<circ>\\<^sub>s ?\\<theta>))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M; t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>;\n         is_Fun t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding \\<delta>_def"], ["proof (prove)\nusing this:\n  \\<nexists>f. t = Fun f []\n  (\\<exists>f. t = Fun f []) \\<and>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta>) \\<or>\n  (\\<exists>m\\<in>set M.\n      \\<exists>\\<delta>.\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n         t = m \\<cdot> \\<delta> \\<and> is_Fun m)\n  \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   t = ?m \\<cdot> ?\\<delta>\\<rbrakk>\n  \\<Longrightarrow> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                     (var_rename_inv ?n \\<circ>\\<^sub>s ?\\<delta>)\n  \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   t = ?m \\<cdot> ?\\<delta>\\<rbrakk>\n  \\<Longrightarrow> t =\n                    ?m \\<cdot> var_rename ?n \\<cdot>\n                    var_rename_inv ?n \\<circ>\\<^sub>s ?\\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range ?\\<theta>) \\<Longrightarrow>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (var_rename_inv ?n1 \\<circ>\\<^sub>s ?\\<theta>))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M;\n         t =\n         t0 \\<cdot>\n         var_rename\n          (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n         \\<theta>;\n         is_Fun t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t0 \\<in> set M\n  t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>\n  is_Fun t0\n\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0 \\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n         \\<Gamma> s = \\<Gamma> s0;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M; is_Fun t0;\n         t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>;\n         \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "have \"\\<Gamma> s = \\<Gamma> s0\" \"\\<Gamma> t = \\<Gamma> (t0 \\<cdot> \\<delta>)\" \"\\<Gamma> (t0 \\<cdot> \\<delta>) = \\<Gamma> t0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> s0 &&&\n    \\<Gamma> t = \\<Gamma> (t0 \\<cdot> \\<delta>) &&&\n    \\<Gamma> (t0 \\<cdot> \\<delta>) = \\<Gamma> t0", "using s0 t0 wt_subst_trm''"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>)\n  s0 \\<in> set M\n  s = s0 \\<cdot> \\<sigma>\n  is_Fun s0\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t0 \\<in> set M\n  t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>\n  is_Fun t0\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<sigma> \\<Longrightarrow>\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> ?\\<sigma>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> s0 &&&\n    \\<Gamma> t = \\<Gamma> (t0 \\<cdot> \\<delta>) &&&\n    \\<Gamma> (t0 \\<cdot> \\<delta>) = \\<Gamma> t0", "by (metis, metis, metis \\<delta>_def var_rename_wt(1))"], ["proof (state)\nthis:\n  \\<Gamma> s = \\<Gamma> s0\n  \\<Gamma> t = \\<Gamma> (t0 \\<cdot> \\<delta>)\n  \\<Gamma> (t0 \\<cdot> \\<delta>) = \\<Gamma> t0\n\ngoal (1 subgoal):\n 1. (\\<And>\\<sigma> s0 \\<theta> t0.\n        \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n         s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n         \\<Gamma> s = \\<Gamma> s0;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n         t0 \\<in> set M; is_Fun t0;\n         t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>;\n         \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Gamma> s = \\<Gamma> s0\n  \\<Gamma> t = \\<Gamma> (t0 \\<cdot> \\<delta>)\n  \\<Gamma> (t0 \\<cdot> \\<delta>) = \\<Gamma> t0\n\ngoal (1 subgoal):\n 1. thesis", "using s0 t0 that"], ["proof (prove)\nusing this:\n  \\<Gamma> s = \\<Gamma> s0\n  \\<Gamma> t = \\<Gamma> (t0 \\<cdot> \\<delta>)\n  \\<Gamma> (t0 \\<cdot> \\<delta>) = \\<Gamma> t0\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>)\n  s0 \\<in> set M\n  s = s0 \\<cdot> \\<sigma>\n  is_Fun s0\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t0 \\<in> set M\n  t = t0 \\<cdot> \\<delta> \\<cdot> \\<theta>\n  is_Fun t0\n  \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<sigma>2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<sigma>2);\n   ?s0.2 \\<in> set M; is_Fun ?s0.2; s = ?s0.2 \\<cdot> ?\\<sigma>2;\n   \\<Gamma> s = \\<Gamma> ?s0.2;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<theta>2;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<theta>2);\n   ?t0.2 \\<in> set M; is_Fun ?t0.2;\n   t = ?t0.2 \\<cdot> \\<delta> \\<cdot> ?\\<theta>2;\n   \\<Gamma> t = \\<Gamma> ?t0.2\\<rbrakk>\n  \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. thesis", "by simp"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SMP_D'':\n  fixes t::\"('fun, ('fun, 'atom) term \\<times> nat) term\"\n  assumes t_SMP: \"t \\<in> SMP (set M)\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"\\<exists>m \\<in> set M. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> t = m \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "proof (cases \"(\\<exists>x. t = Var x) \\<or> (\\<exists>c. t = Fun c [])\")"], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<exists>x. t = Var x) \\<or>\n    (\\<exists>c. t = Fun c []) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<not> ((\\<exists>x. t = Var x) \\<or>\n            (\\<exists>c. t = Fun c [])) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "case True"], ["proof (state)\nthis:\n  (\\<exists>x. t = Var x) \\<or> (\\<exists>c. t = Fun c [])\n\ngoal (2 subgoals):\n 1. (\\<exists>x. t = Var x) \\<or>\n    (\\<exists>c. t = Fun c []) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<not> ((\\<exists>x. t = Var x) \\<or>\n            (\\<exists>c. t = Fun c [])) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have M_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\" \n      and M_var_inst_cl: \"is_TComp_var_instance_closed \\<Gamma> M\"\n      and M_subterms_cl: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n      and M_Ana_cl: \"has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "using finite_SMP_representationD[OF M_SMP_repr]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n\ngoal (2 subgoals):\n 1. (\\<exists>x. t = Var x) \\<or>\n    (\\<exists>c. t = Fun c []) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<not> ((\\<exists>x. t = Var x) \\<or>\n            (\\<exists>c. t = Fun c [])) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have M_Ana_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "fix k"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "assume \"k \\<in> \\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)\""], ["proof (state)\nthis:\n  k \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "then"], ["proof (chain)\npicking this:\n  k \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)", "obtain m where m: \"m \\<in> set M\" \"k \\<in> set (fst (Ana m))\""], ["proof (prove)\nusing this:\n  k \\<in> \\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)\n\ngoal (1 subgoal):\n 1. (\\<And>m.\n        \\<lbrakk>m \\<in> set M; k \\<in> set (fst (Ana m))\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  m \\<in> set M\n  k \\<in> set (fst (Ana m))\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> \\<Union>\n                ((set \\<circ> fst \\<circ> Ana) ` set M) \\<Longrightarrow>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m t", "thus \"wf\\<^sub>t\\<^sub>r\\<^sub>m k\""], ["proof (prove)\nusing this:\n  m \\<in> set M\n  k \\<in> set (fst (Ana m))\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m k", "using M_wf Ana_keys_wf'[of m \"fst (Ana m)\" _ k] surjective_pairing"], ["proof (prove)\nusing this:\n  m \\<in> set M\n  k \\<in> set (fst (Ana m))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  \\<lbrakk>Ana m = (fst (Ana m), ?T); wf\\<^sub>t\\<^sub>r\\<^sub>m m;\n   k \\<in> set (fst (Ana m))\\<rbrakk>\n  \\<Longrightarrow> wf\\<^sub>t\\<^sub>r\\<^sub>m k\n  ?t = (fst ?t, snd ?t)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m k", "by blast"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m k\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M))\n\ngoal (2 subgoals):\n 1. (\\<exists>x. t = Var x) \\<or>\n    (\\<exists>c. t = Fun c []) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<not> ((\\<exists>x. t = Var x) \\<or>\n            (\\<exists>c. t = Fun c [])) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "using True"], ["proof (prove)\nusing this:\n  (\\<exists>x. t = Var x) \\<or> (\\<exists>c. t = Fun c [])\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "assume \"\\<exists>x. t = Var x\""], ["proof (state)\nthis:\n  \\<exists>x. t = Var x\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "then"], ["proof (chain)\npicking this:\n  \\<exists>x. t = Var x", "obtain x y where x: \"t = Var x\" and y: \"y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\" \"\\<Gamma> (Var y) = \\<Gamma> (Var x)\""], ["proof (prove)\nusing this:\n  \\<exists>x. t = Var x\n\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>t = Var x; y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using SMP_D_aux1[OF t_SMP M_subterms_cl M_var_inst_cl M_wf]"], ["proof (prove)\nusing this:\n  \\<exists>x. t = Var x\n  \\<forall>x\\<in>fv t.\n     \\<exists>y\\<in>fv\\<^sub>s\\<^sub>e\\<^sub>t (set M).\n        \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>x y.\n        \\<lbrakk>t = Var x; y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M);\n         \\<Gamma> (Var y) = \\<Gamma> (Var x)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "then"], ["proof (chain)\npicking this:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)", "obtain m \\<delta> where m: \"m \\<in> set M\" \"m \\<cdot> \\<delta> = Var y\" and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\""], ["proof (prove)\nusing this:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M; m \\<cdot> \\<delta> = Var y;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using has_all_wt_instances_ofD'[OF wf_trms_subterms[OF M_wf] M_wf M_subterms_cl, of \"Var y\"]\n            vars_iff_subtermeq_set[of y \"set M\"]"], ["proof (prove)\nusing this:\n  t = Var x\n  y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  Var y \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M \\<Longrightarrow>\n  \\<exists>\\<delta>.\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n     Var y \\<in> set M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>\n  (y \\<in> fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)) =\n  (Var y \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t set M)\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<delta>.\n        \\<lbrakk>m \\<in> set M; m \\<cdot> \\<delta> = Var y;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  m \\<in> set M\n  m \\<cdot> \\<delta> = Var y\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "obtain z where z: \"m = Var z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>z. m = Var z \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "using m(2)"], ["proof (prove)\nusing this:\n  m \\<cdot> \\<delta> = Var y\n\ngoal (1 subgoal):\n 1. (\\<And>z. m = Var z \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (cases m) auto"], ["proof (state)\nthis:\n  m = Var z\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "define \\<theta> where \"\\<theta> \\<equiv> Var(z := Var x)::('fun, ('fun, 'atom) term \\<times> nat) subst\""], ["proof (state)\nthis:\n  \\<theta> \\<equiv> Var(z := Var x)\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have \"\\<Gamma> (Var z) = \\<Gamma> (Var x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Gamma> (Var z) = \\<Gamma> (Var x)", "using y(2) m(2) z wt_subst_trm''[OF \\<delta>, of m]"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var y) = \\<Gamma> (Var x)\n  m \\<cdot> \\<delta> = Var y\n  m = Var z\n  \\<Gamma> m = \\<Gamma> (m \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<Gamma> (Var z) = \\<Gamma> (Var x)", "by argo"], ["proof (state)\nthis:\n  \\<Gamma> (Var z) = \\<Gamma> (Var x)\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "hence \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\nusing this:\n  \\<Gamma> (Var z) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)", "unfolding \\<theta>_def wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<Gamma> (Var z) = \\<Gamma> (Var x)\n\ngoal (1 subgoal):\n 1. \\<forall>v. \\<Gamma> (Var v) = \\<Gamma> ((Var(z := Var x)) v) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range (Var(z := Var x)))", "by force+"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "moreover"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "have \"t = m \\<cdot> \\<theta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t = m \\<cdot> \\<theta>", "using x z"], ["proof (prove)\nusing this:\n  t = Var x\n  m = Var z\n\ngoal (1 subgoal):\n 1. t = m \\<cdot> \\<theta>", "unfolding \\<theta>_def"], ["proof (prove)\nusing this:\n  t = Var x\n  m = Var z\n\ngoal (1 subgoal):\n 1. t = m \\<cdot> Var(z := Var x)", "by simp"], ["proof (state)\nthis:\n  t = m \\<cdot> \\<theta>\n\ngoal (2 subgoals):\n 1. \\<exists>x. t = Var x \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>\n 2. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "ultimately"], ["proof (chain)\npicking this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t = m \\<cdot> \\<theta>", "show ?thesis"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "using m(1)"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  t = m \\<cdot> \\<theta>\n  m \\<in> set M\n\ngoal (1 subgoal):\n 1. \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "by blast"], ["proof (state)\nthis:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<delta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n        t = m \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<exists>c. t = Fun c [] \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "qed (use SMP_D[OF t_SMP _ M_SMP_repr] in blast)"], ["proof (state)\nthis:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<delta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n        t = m \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. \\<not> ((\\<exists>x. t = Var x) \\<or>\n            (\\<exists>c. t = Fun c [])) \\<Longrightarrow>\n    \\<exists>m\\<in>set M.\n       \\<exists>\\<delta>.\n          wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n          wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n          t = m \\<cdot> \\<delta>", "qed (use SMP_D[OF t_SMP _ M_SMP_repr] in blast)"], ["", "end"], ["", "lemma tfr\\<^sub>s\\<^sub>e\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t:\n  assumes \"comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\"\n  shows \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "let ?\\<delta> = \"var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)))\""], ["proof (state)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "have M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite_SMP_representation arity Ana \\<Gamma> M", "by (metis comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t_def assms)"], ["proof (state)\nthis:\n  finite_SMP_representation arity Ana \\<Gamma> M\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "have M_finite: \"finite (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite (set M)", "using assms card_gt_0_iff"], ["proof (prove)\nusing this:\n  comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\n  (0 < card ?A) = (?A \\<noteq> {} \\<and> finite ?A)\n\ngoal (1 subgoal):\n 1. finite (set M)", "unfolding comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t_def"], ["proof (prove)\nusing this:\n  finite_SMP_representation arity Ana \\<Gamma> M \\<and>\n  (let \\<delta> =\n         var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)))\n   in \\<forall>s\\<in>set M.\n         \\<forall>t\\<in>set M.\n            is_Fun s \\<and>\n            is_Fun t \\<and> \\<Gamma> s \\<noteq> \\<Gamma> t \\<longrightarrow>\n            mgu s (t \\<cdot> \\<delta>) = None)\n  (0 < card ?A) = (?A \\<noteq> {} \\<and> finite ?A)\n\ngoal (1 subgoal):\n 1. finite (set M)", "by blast"], ["proof (state)\nthis:\n  finite (set M)\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "proof (unfold tfr\\<^sub>s\\<^sub>e\\<^sub>t_def; intro ballI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>s \\<in> SMP (set M) - range Var;\n        t \\<in> SMP (set M) - range Var;\n        \\<exists>\\<delta>. Unifier \\<delta> s t\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t", "fix s t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>s \\<in> SMP (set M) - range Var;\n        t \\<in> SMP (set M) - range Var;\n        \\<exists>\\<delta>. Unifier \\<delta> s t\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t", "assume \"s \\<in> SMP (set M) - Var`\\<V>\" \"t \\<in> SMP (set M) - Var`\\<V>\""], ["proof (state)\nthis:\n  s \\<in> SMP (set M) - range Var\n  t \\<in> SMP (set M) - range Var\n\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>s \\<in> SMP (set M) - range Var;\n        t \\<in> SMP (set M) - range Var;\n        \\<exists>\\<delta>. Unifier \\<delta> s t\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t", "hence st: \"s \\<in> SMP (set M)\" \"is_Fun s\" \"t \\<in> SMP (set M)\" \"is_Fun t\""], ["proof (prove)\nusing this:\n  s \\<in> SMP (set M) - range Var\n  t \\<in> SMP (set M) - range Var\n\ngoal (1 subgoal):\n 1. (s \\<in> SMP (set M) &&& is_Fun s) &&& t \\<in> SMP (set M) &&& is_Fun t", "by auto"], ["proof (state)\nthis:\n  s \\<in> SMP (set M)\n  is_Fun s\n  t \\<in> SMP (set M)\n  is_Fun t\n\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>s \\<in> SMP (set M) - range Var;\n        t \\<in> SMP (set M) - range Var;\n        \\<exists>\\<delta>. Unifier \\<delta> s t\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t", "have \"\\<not>(\\<exists>\\<delta>. Unifier \\<delta> s t)\" when st_type_neq: \"\\<Gamma> s \\<noteq> \\<Gamma> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<nexists>\\<delta>. Unifier \\<delta> s t", "proof (cases \"\\<exists>f. s = Fun f [] \\<or> t = Fun f []\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t\n 2. \\<nexists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t", "case False"], ["proof (state)\nthis:\n  \\<nexists>f. s = Fun f [] \\<or> t = Fun f []\n\ngoal (2 subgoals):\n 1. \\<exists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t\n 2. \\<nexists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t", "then"], ["proof (chain)\npicking this:\n  \\<nexists>f. s = Fun f [] \\<or> t = Fun f []", "obtain \\<sigma> s0 \\<theta> t0 where\n            s0: \"s0 \\<in> set M\" \"is_Fun s0\" \"s = s0 \\<cdot> \\<sigma>\" \"\\<Gamma> s = \\<Gamma> s0\"\n        and t0: \"t0 \\<in> set M\" \"is_Fun t0\" \"t = t0 \\<cdot> ?\\<delta> \\<cdot> \\<theta>\" \"\\<Gamma> t = \\<Gamma> t0\""], ["proof (prove)\nusing this:\n  \\<nexists>f. s = Fun f [] \\<or> t = Fun f []\n\ngoal (1 subgoal):\n 1. (\\<And>s0 \\<sigma> t0 \\<theta>.\n        \\<lbrakk>s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n         \\<Gamma> s = \\<Gamma> s0; t0 \\<in> set M; is_Fun t0;\n         t =\n         t0 \\<cdot>\n         var_rename\n          (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n         \\<theta>;\n         \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using SMP_D'[OF M_SMP_repr st(1,2) _ st(3,4)]"], ["proof (prove)\nusing this:\n  \\<nexists>f. s = Fun f [] \\<or> t = Fun f []\n  \\<lbrakk>\\<nexists>f. s = Fun f []; \\<nexists>f. t = Fun f [];\n   \\<And>\\<sigma> s0 \\<theta> t0.\n      \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>;\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>);\n       s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n       \\<Gamma> s = \\<Gamma> s0;\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>);\n       t0 \\<in> set M; is_Fun t0;\n       t =\n       t0 \\<cdot>\n       var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n       \\<theta>;\n       \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>s0 \\<sigma> t0 \\<theta>.\n        \\<lbrakk>s0 \\<in> set M; is_Fun s0; s = s0 \\<cdot> \\<sigma>;\n         \\<Gamma> s = \\<Gamma> s0; t0 \\<in> set M; is_Fun t0;\n         t =\n         t0 \\<cdot>\n         var_rename\n          (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n         \\<theta>;\n         \\<Gamma> t = \\<Gamma> t0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  s0 \\<in> set M\n  is_Fun s0\n  s = s0 \\<cdot> \\<sigma>\n  \\<Gamma> s = \\<Gamma> s0\n  t0 \\<in> set M\n  is_Fun t0\n  t =\n  t0 \\<cdot>\n  var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n  \\<theta>\n  \\<Gamma> t = \\<Gamma> t0\n\ngoal (2 subgoals):\n 1. \\<exists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t\n 2. \\<nexists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t", "hence \"\\<not>(\\<exists>\\<delta>. Unifier \\<delta> s0 (t0 \\<cdot> ?\\<delta>))\""], ["proof (prove)\nusing this:\n  s0 \\<in> set M\n  is_Fun s0\n  s = s0 \\<cdot> \\<sigma>\n  \\<Gamma> s = \\<Gamma> s0\n  t0 \\<in> set M\n  is_Fun t0\n  t =\n  t0 \\<cdot>\n  var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n  \\<theta>\n  \\<Gamma> t = \\<Gamma> t0\n\ngoal (1 subgoal):\n 1. \\<nexists>\\<delta>.\n       Unifier \\<delta> s0\n        (t0 \\<cdot>\n         var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))))", "using assms mgu_None_is_subst_neq st_type_neq wt_subst_trm''[OF var_rename_wt(1)]"], ["proof (prove)\nusing this:\n  s0 \\<in> set M\n  is_Fun s0\n  s = s0 \\<cdot> \\<sigma>\n  \\<Gamma> s = \\<Gamma> s0\n  t0 \\<in> set M\n  is_Fun t0\n  t =\n  t0 \\<cdot>\n  var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n  \\<theta>\n  \\<Gamma> t = \\<Gamma> t0\n  comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\n  mgu ?s ?t = None \\<Longrightarrow>\n  ?s \\<cdot> ?\\<delta> \\<noteq> ?t \\<cdot> ?\\<delta>\n  \\<Gamma> s \\<noteq> \\<Gamma> t\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> var_rename ?n1)\n\ngoal (1 subgoal):\n 1. \\<nexists>\\<delta>.\n       Unifier \\<delta> s0\n        (t0 \\<cdot>\n         var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))))", "unfolding comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t_def Let_def"], ["proof (prove)\nusing this:\n  s0 \\<in> set M\n  is_Fun s0\n  s = s0 \\<cdot> \\<sigma>\n  \\<Gamma> s = \\<Gamma> s0\n  t0 \\<in> set M\n  is_Fun t0\n  t =\n  t0 \\<cdot>\n  var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n  \\<theta>\n  \\<Gamma> t = \\<Gamma> t0\n  finite_SMP_representation arity Ana \\<Gamma> M \\<and>\n  (\\<forall>s\\<in>set M.\n      \\<forall>t\\<in>set M.\n         is_Fun s \\<and>\n         is_Fun t \\<and> \\<Gamma> s \\<noteq> \\<Gamma> t \\<longrightarrow>\n         mgu s\n          (t \\<cdot>\n           var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)))) =\n         None)\n  mgu ?s ?t = None \\<Longrightarrow>\n  ?s \\<cdot> ?\\<delta> \\<noteq> ?t \\<cdot> ?\\<delta>\n  \\<Gamma> s \\<noteq> \\<Gamma> t\n  \\<Gamma> ?t = \\<Gamma> (?t \\<cdot> var_rename ?n1)\n\ngoal (1 subgoal):\n 1. \\<nexists>\\<delta>.\n       Unifier \\<delta> s0\n        (t0 \\<cdot>\n         var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))))", "by metis"], ["proof (state)\nthis:\n  \\<nexists>\\<delta>.\n     Unifier \\<delta> s0\n      (t0 \\<cdot>\n       var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))))\n\ngoal (2 subgoals):\n 1. \\<exists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t\n 2. \\<nexists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<nexists>\\<delta>.\n     Unifier \\<delta> s0\n      (t0 \\<cdot>\n       var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))))\n\ngoal (1 subgoal):\n 1. \\<nexists>\\<delta>. Unifier \\<delta> s t", "using vars_term_disjoint_imp_unifier[OF var_rename_fv_set_disjoint[OF M_finite]] s0(1) t0(1)"], ["proof (prove)\nusing this:\n  \\<nexists>\\<delta>.\n     Unifier \\<delta> s0\n      (t0 \\<cdot>\n       var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))))\n  \\<lbrakk>?s \\<in> set M;\n   ?s \\<cdot> ?\\<sigma> =\n   ?t1 \\<cdot>\n   var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n   ?\\<tau>\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<mu>.\n                       ?s \\<cdot> \\<mu> =\n                       ?t1 \\<cdot>\n                       var_rename\n                        (max_var_set\n                          (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n                       \\<mu>\n  s0 \\<in> set M\n  t0 \\<in> set M\n\ngoal (1 subgoal):\n 1. \\<nexists>\\<delta>. Unifier \\<delta> s t", "unfolding s0(3) t0(3)"], ["proof (prove)\nusing this:\n  \\<nexists>\\<delta>.\n     Unifier \\<delta> s0\n      (t0 \\<cdot>\n       var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))))\n  \\<lbrakk>?s \\<in> set M;\n   ?s \\<cdot> ?\\<sigma> =\n   ?t1 \\<cdot>\n   var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n   ?\\<tau>\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<mu>.\n                       ?s \\<cdot> \\<mu> =\n                       ?t1 \\<cdot>\n                       var_rename\n                        (max_var_set\n                          (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n                       \\<mu>\n  s0 \\<in> set M\n  t0 \\<in> set M\n\ngoal (1 subgoal):\n 1. \\<nexists>\\<delta>.\n       Unifier \\<delta> (s0 \\<cdot> \\<sigma>)\n        (t0 \\<cdot>\n         var_rename\n          (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M))) \\<cdot>\n         \\<theta>)", "by (metis (no_types, hide_lams) subst_subst_compose)"], ["proof (state)\nthis:\n  \\<nexists>\\<delta>. Unifier \\<delta> s t\n\ngoal (1 subgoal):\n 1. \\<exists>f. s = Fun f [] \\<or> t = Fun f [] \\<Longrightarrow>\n    \\<nexists>\\<delta>. Unifier \\<delta> s t", "qed (use st_type_neq st(2,4) in auto)"], ["proof (state)\nthis:\n  \\<Gamma> s \\<noteq> \\<Gamma> t \\<Longrightarrow>\n  \\<nexists>\\<delta>. Unifier \\<delta> s t\n\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>s \\<in> SMP (set M) - range Var;\n        t \\<in> SMP (set M) - range Var;\n        \\<exists>\\<delta>. Unifier \\<delta> s t\\<rbrakk>\n       \\<Longrightarrow> \\<Gamma> s = \\<Gamma> t", "thus \"\\<Gamma> s = \\<Gamma> t\" when \"\\<exists>\\<delta>. Unifier \\<delta> s t\""], ["proof (prove)\nusing this:\n  \\<Gamma> s \\<noteq> \\<Gamma> t \\<Longrightarrow>\n  \\<nexists>\\<delta>. Unifier \\<delta> s t\n\ngoal (1 subgoal):\n 1. \\<Gamma> s = \\<Gamma> t", "by (metis that)"], ["proof (state)\nthis:\n  \\<exists>\\<delta>. Unifier \\<delta> s t \\<Longrightarrow>\n  \\<Gamma> s = \\<Gamma> t\n\ngoal (1 subgoal):\n 1. \\<And>s t.\n       \\<lbrakk>s \\<in> SMP (set M) - range Var;\n        t \\<in> SMP (set M) - range Var;\n        \\<exists>\\<delta>. Unifier \\<delta> s t\\<rbrakk>\n       \\<Longrightarrow> \\<exists>\\<delta>. Unifier \\<delta> s t", "qed"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma tfr\\<^sub>s\\<^sub>e\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t':\n  assumes \"let N = SMP0 Ana \\<Gamma> M in set M \\<subseteq> set N \\<and> comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> N\"\n  shows \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (set M)", "by (rule tfr_subset(2)[\n          OF tfr\\<^sub>s\\<^sub>e\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t[OF conjunct2[OF assms[unfolded Let_def]]]\n             conjunct1[OF assms[unfolded Let_def]]])"], ["", "lemma tfr\\<^sub>s\\<^sub>t\\<^sub>p_is_comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p: \"tfr\\<^sub>s\\<^sub>t\\<^sub>p a = comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n    comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "proof (cases a)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x1.\n       a = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 2. \\<And>x2.\n       a = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 3. \\<And>x31 x32 x33.\n       a =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 4. \\<And>x41 x42.\n       a =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "case (Equality ac t t')"], ["proof (state)\nthis:\n  a = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       a = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 2. \\<And>x2.\n       a = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 3. \\<And>x31 x32 x33.\n       a =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 4. \\<And>x41 x42.\n       a =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "thus ?thesis"], ["proof (prove)\nusing this:\n  a = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n    comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "using mgu_always_unifies[of t _ t'] mgu_gives_MGU[of t t']"], ["proof (prove)\nusing this:\n  a = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n  Unifier ?\\<theta> t t' \\<Longrightarrow>\n  \\<exists>\\<delta>. mgu t t' = Some \\<delta>\n  mgu t t' = Some ?\\<theta> \\<Longrightarrow> MGU ?\\<theta> t t'\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n    comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "by auto"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n  comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       a = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 2. \\<And>x2.\n       a = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 3. \\<And>x41 x42.\n       a =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1.\n       a = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 2. \\<And>x2.\n       a = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 3. \\<And>x41 x42.\n       a =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "case (Inequality X F)"], ["proof (state)\nthis:\n  a = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (3 subgoals):\n 1. \\<And>x1.\n       a = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 2. \\<And>x2.\n       a = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 3. \\<And>x41 x42.\n       a =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "thus ?thesis"], ["proof (prove)\nusing this:\n  a = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n    comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "using tfr\\<^sub>s\\<^sub>t\\<^sub>p.simps(2)[of X F]\n          comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p.simps(2)[of \\<Gamma> X F]\n          Fun_range_case(2)[of \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F)\"]"], ["proof (prove)\nusing this:\n  a = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  tfr\\<^sub>s\\<^sub>t\\<^sub>p\n   \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t =\n  ((\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n   (\\<forall>f T.\n       Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n       T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n  comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>\n   \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t =\n  ((\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n       is_Var (\\<Gamma> (Var x))) \\<or>\n   (\\<forall>u\\<in>subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                    (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F).\n       is_Fun u \\<longrightarrow>\n       args u = [] \\<or>\n       (\\<exists>s\\<in>set (args u). s \\<notin> Var ` set X)))\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      ?P f T) =\n  (\\<forall>u\\<in>subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                   (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F).\n      is_Fun u \\<longrightarrow> ?P (the_Fun u) (args u))\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n    comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "unfolding is_Var_def"], ["proof (prove)\nusing this:\n  a = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  tfr\\<^sub>s\\<^sub>t\\<^sub>p\n   \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t =\n  ((\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n       \\<exists>a. \\<Gamma> (Var x) = Var a) \\<or>\n   (\\<forall>f T.\n       Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n       T = [] \\<or> (\\<exists>s\\<in>set T. s \\<notin> Var ` set X)))\n  comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>\n   \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t =\n  ((\\<forall>x\\<in>fv\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F - set X.\n       \\<exists>x1. \\<Gamma> (Var x) = Var x1) \\<or>\n   (\\<forall>u\\<in>subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                    (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F).\n       (\\<nexists>x1. u = Var x1) \\<longrightarrow>\n       args u = [] \\<or>\n       (\\<exists>s\\<in>set (args u). s \\<notin> Var ` set X)))\n  (\\<forall>f T.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F \\<longrightarrow>\n      ?P f T) =\n  (\\<forall>u\\<in>subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                   (trms\\<^sub>p\\<^sub>a\\<^sub>i\\<^sub>r\\<^sub>s F).\n      (\\<nexists>x1. u = Var x1) \\<longrightarrow> ?P (the_Fun u) (args u))\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n    comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "by auto"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n  comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n\ngoal (2 subgoals):\n 1. \\<And>x1.\n       a = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a\n 2. \\<And>x2.\n       a = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       tfr\\<^sub>s\\<^sub>t\\<^sub>p a =\n       comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma> a", "qed auto"], ["", "lemma tfr\\<^sub>s\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>t:\n  assumes \"comp_tfr\\<^sub>s\\<^sub>t arity Ana \\<Gamma> M S\"\n  shows \"tfr\\<^sub>s\\<^sub>t S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t S", "unfolding tfr\\<^sub>s\\<^sub>t_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S) \\<and>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S)\n 2. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "have comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t_M: \"comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M", "using assms"], ["proof (prove)\nusing this:\n  comp_tfr\\<^sub>s\\<^sub>t arity Ana \\<Gamma> M S\n\ngoal (1 subgoal):\n 1. comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M", "unfolding comp_tfr\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  list_all (comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>) S \\<and>\n  list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity)\n   (trms_list\\<^sub>s\\<^sub>t S) \\<and>\n  has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M) \\<and>\n  comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\n\ngoal (1 subgoal):\n 1. comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M", "by blast"], ["proof (state)\nthis:\n  comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t arity Ana \\<Gamma> M\n\ngoal (2 subgoals):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S)\n 2. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "have wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s_M: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\"\n      and wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s_S: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>s\\<^sub>t S)\"\n      and S_trms_instance_M: \"has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>s\\<^sub>t S) &&&\n    has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M)", "using assms wf\\<^sub>t\\<^sub>r\\<^sub>m_code trms_list\\<^sub>s\\<^sub>t_is_trms\\<^sub>s\\<^sub>t"], ["proof (prove)\nusing this:\n  comp_tfr\\<^sub>s\\<^sub>t arity Ana \\<Gamma> M S\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t = wf\\<^sub>t\\<^sub>r\\<^sub>m' arity ?t\n  trms\\<^sub>s\\<^sub>t ?S = set (trms_list\\<^sub>s\\<^sub>t ?S)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>s\\<^sub>t S) &&&\n    has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M)", "unfolding comp_tfr\\<^sub>s\\<^sub>t_def comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t_def finite_SMP_representation_def list_all_iff"], ["proof (prove)\nusing this:\n  Ball (set S) (comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>) \\<and>\n  Ball (set (trms_list\\<^sub>s\\<^sub>t S))\n   (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) \\<and>\n  has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M) \\<and>\n  (Ball (set M) (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) \\<and>\n   has_all_wt_instances_of \\<Gamma>\n    (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) \\<and>\n   has_all_wt_instances_of \\<Gamma>\n    (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M) \\<and>\n   is_TComp_var_instance_closed \\<Gamma> M) \\<and>\n  (let \\<delta> =\n         var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set M)))\n   in \\<forall>s\\<in>set M.\n         \\<forall>t\\<in>set M.\n            is_Fun s \\<and>\n            is_Fun t \\<and> \\<Gamma> s \\<noteq> \\<Gamma> t \\<longrightarrow>\n            mgu s (t \\<cdot> \\<delta>) = None)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t = wf\\<^sub>t\\<^sub>r\\<^sub>m' arity ?t\n  trms\\<^sub>s\\<^sub>t ?S = set (trms_list\\<^sub>s\\<^sub>t ?S)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>s\\<^sub>t S) &&&\n    has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M)", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>s\\<^sub>t S)\n  has_all_wt_instances_of \\<Gamma> (trms\\<^sub>s\\<^sub>t S) (set M)\n\ngoal (2 subgoals):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S)\n 2. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "show \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S)", "using tfr_subset(3)[OF tfr\\<^sub>s\\<^sub>e\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t[OF comp_tfr\\<^sub>s\\<^sub>e\\<^sub>t_M] SMP_SMP_subset]\n          SMP_I'[OF wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s_S wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s_M S_trms_instance_M]"], ["proof (prove)\nusing this:\n  ?A \\<subseteq> SMP (set M) \\<Longrightarrow>\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t ?A\n  ?t \\<in> trms\\<^sub>s\\<^sub>t S \\<Longrightarrow> ?t \\<in> SMP (set M)\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S)", "by blast"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>s\\<^sub>t S)\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "have \"list_all (comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>) S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all (comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>) S", "by (metis assms comp_tfr\\<^sub>s\\<^sub>t_def)"], ["proof (state)\nthis:\n  list_all (comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>) S\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "thus \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\""], ["proof (prove)\nusing this:\n  list_all (comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p \\<Gamma>) S\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S", "by (induct S) (simp_all add: tfr\\<^sub>s\\<^sub>t\\<^sub>p_is_comp_tfr\\<^sub>s\\<^sub>t\\<^sub>p)"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p S\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma tfr\\<^sub>s\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>t':\n  assumes \"comp_tfr\\<^sub>s\\<^sub>t arity Ana \\<Gamma> (SMP0 Ana \\<Gamma> (trms_list\\<^sub>s\\<^sub>t S)) S\"\n  shows \"tfr\\<^sub>s\\<^sub>t S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>t S", "by (rule tfr\\<^sub>s\\<^sub>t_if_comp_tfr\\<^sub>s\\<^sub>t[OF assms])"], ["", "subsubsection \\<open>Lemmata for Checking Ground SMP (GSMP) Disjointness\\<close>"], ["", "context\nbegin"], ["", "private"], ["", "lemma ground_SMP_disjointI_aux1:\n  fixes M::\"('fun, ('fun, 'atom) term \\<times> nat) term set\"\n  assumes f_def: \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and g_def: \"g \\<equiv> \\<lambda>M. {t \\<in> M. fv t = {}}\"\n  shows \"f (SMP M) = g (SMP M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (SMP M) = g (SMP M)", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. f (SMP M) \\<subseteq> g (SMP M)\n 2. g (SMP M) \\<subseteq> f (SMP M)", "have \"t \\<in> f (SMP M)\" when t: \"t \\<in> SMP M\" \"fv t = {}\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> f (SMP M)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<in> f (SMP M)", "define \\<delta> where \"\\<delta> \\<equiv> Var::('fun, ('fun, 'atom) term \\<times> nat) subst\""], ["proof (state)\nthis:\n  \\<delta> \\<equiv> Var\n\ngoal (1 subgoal):\n 1. t \\<in> f (SMP M)", "have \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\" \"t = t \\<cdot> \\<delta>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) &&&\n    t = t \\<cdot> \\<delta>", "using subst_apply_term_empty[of t] that(2) wt_subst_Var wf_trm_subst_range_Var"], ["proof (prove)\nusing this:\n  t \\<cdot> Var = t\n  fv t = {}\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) &&&\n    t = t \\<cdot> \\<delta>", "unfolding \\<delta>_def"], ["proof (prove)\nusing this:\n  t \\<cdot> Var = t\n  fv t = {}\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var)\n\ngoal (1 subgoal):\n 1. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t Var &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range Var) &&&\n    t = t \\<cdot> Var", "by auto"], ["proof (state)\nthis:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = t \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. t \\<in> f (SMP M)", "thus ?thesis"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = t \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. t \\<in> f (SMP M)", "using SMP.Substitution[OF t(1), of \\<delta>] t(2)"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = t \\<cdot> \\<delta>\n  \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n  \\<Longrightarrow> t \\<cdot> \\<delta> \\<in> SMP M\n  fv t = {}\n\ngoal (1 subgoal):\n 1. t \\<in> f (SMP M)", "unfolding f_def"], ["proof (prove)\nusing this:\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n  t = t \\<cdot> \\<delta>\n  \\<lbrakk>wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n  \\<Longrightarrow> t \\<cdot> \\<delta> \\<in> SMP M\n  fv t = {}\n\ngoal (1 subgoal):\n 1. t \\<in> {t \\<cdot> \\<delta> |t \\<delta>.\n             t \\<in> SMP M \\<and>\n             wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n             wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n              (subst_range \\<delta>) \\<and>\n             fv (t \\<cdot> \\<delta>) = {}}", "by fastforce"], ["proof (state)\nthis:\n  t \\<in> f (SMP M)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?t2 \\<in> SMP M; fv ?t2 = {}\\<rbrakk>\n  \\<Longrightarrow> ?t2 \\<in> f (SMP M)\n\ngoal (2 subgoals):\n 1. f (SMP M) \\<subseteq> g (SMP M)\n 2. g (SMP M) \\<subseteq> f (SMP M)", "thus \"g (SMP M) \\<subseteq> f (SMP M)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?t2 \\<in> SMP M; fv ?t2 = {}\\<rbrakk>\n  \\<Longrightarrow> ?t2 \\<in> f (SMP M)\n\ngoal (1 subgoal):\n 1. g (SMP M) \\<subseteq> f (SMP M)", "unfolding g_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>?t2 \\<in> SMP M; fv ?t2 = {}\\<rbrakk>\n  \\<Longrightarrow> ?t2 \\<in> f (SMP M)\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP M. fv t = {}} \\<subseteq> f (SMP M)", "by blast"], ["proof (state)\nthis:\n  g (SMP M) \\<subseteq> f (SMP M)\n\ngoal (1 subgoal):\n 1. f (SMP M) \\<subseteq> g (SMP M)", "qed (use f_def g_def in blast)"], ["", "private"], ["", "lemma ground_SMP_disjointI_aux2:\n  fixes M::\"('fun, ('fun, 'atom) term \\<times> nat) term list\"\n  assumes f_def: \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and M_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> M\"\n  shows \"f (set M) = f (SMP (set M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (set M) = f (SMP (set M))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. f (set M) \\<subseteq> f (SMP (set M))\n 2. f (SMP (set M)) \\<subseteq> f (set M)", "have M_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\" \n      and M_var_inst_cl: \"is_TComp_var_instance_closed \\<Gamma> M\"\n      and M_subterms_cl: \"has_all_wt_instances_of \\<Gamma> (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\"\n      and M_Ana_cl: \"has_all_wt_instances_of \\<Gamma> (\\<Union>((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "using finite_SMP_representationD[OF M_SMP_repr]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M) &&&\n     is_TComp_var_instance_closed \\<Gamma> M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M) &&&\n    has_all_wt_instances_of \\<Gamma>\n     (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set M)\n  is_TComp_var_instance_closed \\<Gamma> M\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set M)) (set M)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set M)) (set M)\n\ngoal (2 subgoals):\n 1. f (set M) \\<subseteq> f (SMP (set M))\n 2. f (SMP (set M)) \\<subseteq> f (set M)", "show \"f (SMP (set M)) \\<subseteq> f (set M)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (SMP (set M)) \\<subseteq> f (set M)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> f (SMP (set M)) \\<Longrightarrow> x \\<in> f (set M)", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> f (SMP (set M)) \\<Longrightarrow> x \\<in> f (set M)", "assume \"t \\<in> f (SMP (set M))\""], ["proof (state)\nthis:\n  t \\<in> f (SMP (set M))\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> f (SMP (set M)) \\<Longrightarrow> x \\<in> f (set M)", "then"], ["proof (chain)\npicking this:\n  t \\<in> f (SMP (set M))", "obtain s \\<delta> where s: \"t = s \\<cdot> \\<delta>\" \"s \\<in> SMP (set M)\" \"fv (s \\<cdot> \\<delta>) = {}\"\n        and \\<delta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\""], ["proof (prove)\nusing this:\n  t \\<in> f (SMP (set M))\n\ngoal (1 subgoal):\n 1. (\\<And>s \\<delta>.\n        \\<lbrakk>t = s \\<cdot> \\<delta>; s \\<in> SMP (set M);\n         fv (s \\<cdot> \\<delta>) = {};\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding f_def"], ["proof (prove)\nusing this:\n  t \\<in> {t \\<cdot> \\<delta> |t \\<delta>.\n           t \\<in> SMP (set M) \\<and>\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           fv (t \\<cdot> \\<delta>) = {}}\n\ngoal (1 subgoal):\n 1. (\\<And>s \\<delta>.\n        \\<lbrakk>t = s \\<cdot> \\<delta>; s \\<in> SMP (set M);\n         fv (s \\<cdot> \\<delta>) = {};\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  t = s \\<cdot> \\<delta>\n  s \\<in> SMP (set M)\n  fv (s \\<cdot> \\<delta>) = {}\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>)\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> f (SMP (set M)) \\<Longrightarrow> x \\<in> f (set M)", "have t_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "using SMP_wf_trm[OF s(2) M_wf] s(1) wf_trm_subst[OF \\<delta>(2)]"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m s\n  t = s \\<cdot> \\<delta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ?t =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m (?t \\<cdot> \\<delta>)\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m t", "by blast"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> f (SMP (set M)) \\<Longrightarrow> x \\<in> f (set M)", "obtain m \\<theta> where m: \"m \\<in> set M\" \"s = m \\<cdot> \\<theta>\" and \\<theta>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>m \\<theta>.\n        \\<lbrakk>m \\<in> set M; s = m \\<cdot> \\<theta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using SMP_D''[OF s(2) M_SMP_repr]"], ["proof (prove)\nusing this:\n  \\<exists>m\\<in>set M.\n     \\<exists>\\<delta>.\n        wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n        wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n        s = m \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>m \\<theta>.\n        \\<lbrakk>m \\<in> set M; s = m \\<cdot> \\<theta>;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  m \\<in> set M\n  s = m \\<cdot> \\<theta>\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> f (SMP (set M)) \\<Longrightarrow> x \\<in> f (set M)", "have \"t = m \\<cdot> (\\<theta> \\<circ>\\<^sub>s \\<delta>)\" \"fv (m \\<cdot> (\\<theta> \\<circ>\\<^sub>s \\<delta>)) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> &&&\n    fv (m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>) = {}", "using s(1,3) m(2)"], ["proof (prove)\nusing this:\n  t = s \\<cdot> \\<delta>\n  fv (s \\<cdot> \\<delta>) = {}\n  s = m \\<cdot> \\<theta>\n\ngoal (1 subgoal):\n 1. t = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta> &&&\n    fv (m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>) = {}", "by simp_all"], ["proof (state)\nthis:\n  t = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  fv (m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>) = {}\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> f (SMP (set M)) \\<Longrightarrow> x \\<in> f (set M)", "thus \"t \\<in> f (set M)\""], ["proof (prove)\nusing this:\n  t = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  fv (m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>) = {}\n\ngoal (1 subgoal):\n 1. t \\<in> f (set M)", "using m(1) wt_subst_compose[OF \\<theta>(1) \\<delta>(1)] wf_trms_subst_compose[OF \\<theta>(2) \\<delta>(2)]"], ["proof (prove)\nusing this:\n  t = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  fv (m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>) = {}\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. t \\<in> f (set M)", "unfolding f_def"], ["proof (prove)\nusing this:\n  t = m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>\n  fv (m \\<cdot> \\<theta> \\<circ>\\<^sub>s \\<delta>) = {}\n  m \\<in> set M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<theta> \\<circ>\\<^sub>s \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<theta> \\<circ>\\<^sub>s \\<delta>))\n\ngoal (1 subgoal):\n 1. t \\<in> {t \\<cdot> \\<delta> |t \\<delta>.\n             t \\<in> set M \\<and>\n             wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n             wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n              (subst_range \\<delta>) \\<and>\n             fv (t \\<cdot> \\<delta>) = {}}", "by blast"], ["proof (state)\nthis:\n  t \\<in> f (set M)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f (SMP (set M)) \\<subseteq> f (set M)\n\ngoal (1 subgoal):\n 1. f (set M) \\<subseteq> f (SMP (set M))", "qed (auto simp add: f_def)"], ["", "private"], ["", "lemma ground_SMP_disjointI_aux3:\n  fixes A B C::\"('fun, ('fun, 'atom) term \\<times> nat) term set\"\n  defines \"P \\<equiv> \\<lambda>t s. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> Unifier \\<delta> t s\"\n  assumes f_def: \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and Q_def: \"Q \\<equiv> \\<lambda>t. intruder_synth' public arity {} t\"\n    and R_def: \"R \\<equiv> \\<lambda>t. \\<exists>u \\<in> C. is_wt_instance_of_cond \\<Gamma> t u\"\n    and AB: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s A\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s B\" \"fv\\<^sub>s\\<^sub>e\\<^sub>t A \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t B = {}\"\n    and C: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s C\"\n    and ABC: \"\\<forall>t \\<in> A. \\<forall>s \\<in> B. P t s \\<longrightarrow> (Q t \\<and> Q s) \\<or> (R t \\<and> R s)\"\n  shows \"f A \\<inter> f B \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f A \\<inter> f B \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> f A \\<inter> f B \\<Longrightarrow>\n       x \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> f A \\<inter> f B \\<Longrightarrow>\n       x \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "assume \"t \\<in> f A \\<inter> f B\""], ["proof (state)\nthis:\n  t \\<in> f A \\<inter> f B\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> f A \\<inter> f B \\<Longrightarrow>\n       x \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "then"], ["proof (chain)\npicking this:\n  t \\<in> f A \\<inter> f B", "obtain ta tb \\<delta>a \\<delta>b where\n          ta: \"t = ta \\<cdot> \\<delta>a\" \"ta \\<in> A\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>a\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>a)\" \"fv (ta \\<cdot> \\<delta>a) = {}\"\n      and tb: \"t = tb \\<cdot> \\<delta>b\" \"tb \\<in> B\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>b\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>b)\" \"fv (tb \\<cdot> \\<delta>b) = {}\""], ["proof (prove)\nusing this:\n  t \\<in> f A \\<inter> f B\n\ngoal (1 subgoal):\n 1. (\\<And>ta \\<delta>a tb \\<delta>b.\n        \\<lbrakk>t = ta \\<cdot> \\<delta>a; ta \\<in> A;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>a;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>a);\n         fv (ta \\<cdot> \\<delta>a) = {}; t = tb \\<cdot> \\<delta>b;\n         tb \\<in> B; wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>b;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>b);\n         fv (tb \\<cdot> \\<delta>b) = {}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding f_def"], ["proof (prove)\nusing this:\n  t \\<in> {t \\<cdot> \\<delta> |t \\<delta>.\n           t \\<in> A \\<and>\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           fv (t \\<cdot> \\<delta>) = {}} \\<inter>\n          {t \\<cdot> \\<delta> |t \\<delta>.\n           t \\<in> B \\<and>\n           wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n           wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n           fv (t \\<cdot> \\<delta>) = {}}\n\ngoal (1 subgoal):\n 1. (\\<And>ta \\<delta>a tb \\<delta>b.\n        \\<lbrakk>t = ta \\<cdot> \\<delta>a; ta \\<in> A;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>a;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>a);\n         fv (ta \\<cdot> \\<delta>a) = {}; t = tb \\<cdot> \\<delta>b;\n         tb \\<in> B; wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>b;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>b);\n         fv (tb \\<cdot> \\<delta>b) = {}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  t = ta \\<cdot> \\<delta>a\n  ta \\<in> A\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>a)\n  fv (ta \\<cdot> \\<delta>a) = {}\n  t = tb \\<cdot> \\<delta>b\n  tb \\<in> B\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta>b\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>b)\n  fv (tb \\<cdot> \\<delta>b) = {}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> f A \\<inter> f B \\<Longrightarrow>\n       x \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "have ta_tb_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m ta\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m tb\" \"fv ta \\<inter> fv tb = {}\" \"\\<Gamma> ta = \\<Gamma> tb\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m ta &&& wf\\<^sub>t\\<^sub>r\\<^sub>m tb) &&&\n    fv ta \\<inter> fv tb = {} &&& \\<Gamma> ta = \\<Gamma> tb", "using ta(1,2) tb(1,2) AB fv_subset_subterms\n          wt_subst_trm''[OF ta(3), of ta] wt_subst_trm''[OF tb(3), of tb]"], ["proof (prove)\nusing this:\n  t = ta \\<cdot> \\<delta>a\n  ta \\<in> A\n  t = tb \\<cdot> \\<delta>b\n  tb \\<in> B\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s A\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s B\n  fv\\<^sub>s\\<^sub>e\\<^sub>t A \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t B = {}\n  ?t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t ?M \\<Longrightarrow>\n  fv ?t \\<subseteq> fv\\<^sub>s\\<^sub>e\\<^sub>t ?M\n  \\<Gamma> ta = \\<Gamma> (ta \\<cdot> \\<delta>a)\n  \\<Gamma> tb = \\<Gamma> (tb \\<cdot> \\<delta>b)\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m ta &&& wf\\<^sub>t\\<^sub>r\\<^sub>m tb) &&&\n    fv ta \\<inter> fv tb = {} &&& \\<Gamma> ta = \\<Gamma> tb", "by (fast, fast, blast, simp)"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ta\n  wf\\<^sub>t\\<^sub>r\\<^sub>m tb\n  fv ta \\<inter> fv tb = {}\n  \\<Gamma> ta = \\<Gamma> tb\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> f A \\<inter> f B \\<Longrightarrow>\n       x \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "obtain \\<theta> where \\<theta>: \"Unifier \\<theta> ta tb\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<theta>.\n        \\<lbrakk>Unifier \\<theta> ta tb;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using vars_term_disjoint_imp_unifier[OF ta_tb_wf(3), of \\<delta>a \\<delta>b]\n          ta(1) tb(1) wt_Unifier_if_Unifier[OF ta_tb_wf(1,2,4)]"], ["proof (prove)\nusing this:\n  ta \\<cdot> \\<delta>a = tb \\<cdot> \\<delta>b \\<Longrightarrow>\n  \\<exists>\\<mu>. Unifier \\<mu> ta tb\n  t = ta \\<cdot> \\<delta>a\n  t = tb \\<cdot> \\<delta>b\n  Unifier ?\\<delta> ta tb \\<Longrightarrow>\n  \\<exists>\\<theta>.\n     Unifier \\<theta> ta tb \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<theta>.\n        \\<lbrakk>Unifier \\<theta> ta tb;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  Unifier \\<theta> ta tb\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> f A \\<inter> f B \\<Longrightarrow>\n       x \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "hence \"(Q ta \\<and> Q tb) \\<or> (R ta \\<and> R tb)\""], ["proof (prove)\nusing this:\n  Unifier \\<theta> ta tb\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n\ngoal (1 subgoal):\n 1. Q ta \\<and> Q tb \\<or> R ta \\<and> R tb", "using ABC ta(2) tb(2)"], ["proof (prove)\nusing this:\n  Unifier \\<theta> ta tb\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  \\<forall>t\\<in>A.\n     \\<forall>s\\<in>B.\n        P t s \\<longrightarrow> Q t \\<and> Q s \\<or> R t \\<and> R s\n  ta \\<in> A\n  tb \\<in> B\n\ngoal (1 subgoal):\n 1. Q ta \\<and> Q tb \\<or> R ta \\<and> R tb", "unfolding P_def"], ["proof (prove)\nusing this:\n  Unifier \\<theta> ta tb\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  \\<forall>t\\<in>A.\n     \\<forall>s\\<in>B.\n        (\\<exists>\\<delta>.\n            wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n            wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n            Unifier \\<delta> t s) \\<longrightarrow>\n        Q t \\<and> Q s \\<or> R t \\<and> R s\n  ta \\<in> A\n  tb \\<in> B\n\ngoal (1 subgoal):\n 1. Q ta \\<and> Q tb \\<or> R ta \\<and> R tb", "by blast+"], ["proof (state)\nthis:\n  Q ta \\<and> Q tb \\<or> R ta \\<and> R tb\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> f A \\<inter> f B \\<Longrightarrow>\n       x \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "thus \"t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\nusing this:\n  Q ta \\<and> Q tb \\<or> R ta \\<and> R tb\n\ngoal (1 subgoal):\n 1. t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. Q ta \\<and> Q tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n 2. R ta \\<and> R tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "show \"Q ta \\<and> Q tb \\<Longrightarrow> ?thesis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Q ta \\<and> Q tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using ta(1) pgwt_ground[of ta] pgwt_is_empty_synth[of ta] subst_ground_ident[of ta \\<delta>a]"], ["proof (prove)\nusing this:\n  t = ta \\<cdot> \\<delta>a\n  public_ground_wf_term ta \\<Longrightarrow> fv ta = {}\n  public_ground_wf_term ta = ({} \\<turnstile>\\<^sub>c ta)\n  fv ta = {} \\<Longrightarrow> ta \\<cdot> \\<delta>a = ta\n\ngoal (1 subgoal):\n 1. Q ta \\<and> Q tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "unfolding Q_def f_def intruder_synth_code[symmetric]"], ["proof (prove)\nusing this:\n  t = ta \\<cdot> \\<delta>a\n  public_ground_wf_term ta \\<Longrightarrow> fv ta = {}\n  public_ground_wf_term ta = ({} \\<turnstile>\\<^sub>c ta)\n  fv ta = {} \\<Longrightarrow> ta \\<cdot> \\<delta>a = ta\n\ngoal (1 subgoal):\n 1. {} \\<turnstile>\\<^sub>c ta \\<and>\n    {} \\<turnstile>\\<^sub>c tb \\<Longrightarrow>\n    t \\<in> {t \\<cdot> \\<delta> |t \\<delta>.\n             t \\<in> C \\<and>\n             wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n             wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n              (subst_range \\<delta>) \\<and>\n             fv (t \\<cdot> \\<delta>) = {}} \\<union>\n            {m. {} \\<turnstile>\\<^sub>c m}", "by simp"], ["proof (state)\nthis:\n  Q ta \\<and> Q tb \\<Longrightarrow>\n  t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. R ta \\<and> R tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. R ta \\<and> R tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "assume \"R ta \\<and> R tb\""], ["proof (state)\nthis:\n  R ta \\<and> R tb\n\ngoal (1 subgoal):\n 1. R ta \\<and> R tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "then"], ["proof (chain)\npicking this:\n  R ta \\<and> R tb", "obtain ua \\<sigma>a where ua: \"ta = ua \\<cdot> \\<sigma>a\" \"ua \\<in> C\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>a\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>a)\""], ["proof (prove)\nusing this:\n  R ta \\<and> R tb\n\ngoal (1 subgoal):\n 1. (\\<And>ua \\<sigma>a.\n        \\<lbrakk>ta = ua \\<cdot> \\<sigma>a; ua \\<in> C;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>a;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using \\<theta> ABC ta_tb_wf(1,2) ta(2) tb(2) C is_wt_instance_of_condD'"], ["proof (prove)\nusing this:\n  R ta \\<and> R tb\n  Unifier \\<theta> ta tb\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  \\<forall>t\\<in>A.\n     \\<forall>s\\<in>B.\n        P t s \\<longrightarrow> Q t \\<and> Q s \\<or> R t \\<and> R s\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ta\n  wf\\<^sub>t\\<^sub>r\\<^sub>m tb\n  ta \\<in> A\n  tb \\<in> B\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s C\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; wf\\<^sub>t\\<^sub>r\\<^sub>m ?s;\n   is_wt_instance_of_cond \\<Gamma> ?t ?s\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<delta>.\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<delta> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<delta>) \\<and>\n                       ?t = ?s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>ua \\<sigma>a.\n        \\<lbrakk>ta = ua \\<cdot> \\<sigma>a; ua \\<in> C;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>a;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding P_def R_def"], ["proof (prove)\nusing this:\n  Bex C (is_wt_instance_of_cond \\<Gamma> ta) \\<and>\n  Bex C (is_wt_instance_of_cond \\<Gamma> tb)\n  Unifier \\<theta> ta tb\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<theta>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<theta>)\n  \\<forall>t\\<in>A.\n     \\<forall>s\\<in>B.\n        (\\<exists>\\<delta>.\n            wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n            wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n            Unifier \\<delta> t s) \\<longrightarrow>\n        Q t \\<and> Q s \\<or>\n        Bex C (is_wt_instance_of_cond \\<Gamma> t) \\<and>\n        Bex C (is_wt_instance_of_cond \\<Gamma> s)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m ta\n  wf\\<^sub>t\\<^sub>r\\<^sub>m tb\n  ta \\<in> A\n  tb \\<in> B\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s C\n  \\<lbrakk>wf\\<^sub>t\\<^sub>r\\<^sub>m ?t; wf\\<^sub>t\\<^sub>r\\<^sub>m ?s;\n   is_wt_instance_of_cond \\<Gamma> ?t ?s\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<delta>.\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<delta> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<delta>) \\<and>\n                       ?t = ?s \\<cdot> \\<delta>\n\ngoal (1 subgoal):\n 1. (\\<And>ua \\<sigma>a.\n        \\<lbrakk>ta = ua \\<cdot> \\<sigma>a; ua \\<in> C;\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>a;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>a)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  ta = ua \\<cdot> \\<sigma>a\n  ua \\<in> C\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<sigma>a\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<sigma>a)\n\ngoal (1 subgoal):\n 1. R ta \\<and> R tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "have \"t = ua \\<cdot> (\\<sigma>a \\<circ>\\<^sub>s \\<delta>a)\" \"fv t = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t = ua \\<cdot> \\<sigma>a \\<circ>\\<^sub>s \\<delta>a &&& fv t = {}", "using ua(1) ta(1,5) tb(1,5)"], ["proof (prove)\nusing this:\n  ta = ua \\<cdot> \\<sigma>a\n  t = ta \\<cdot> \\<delta>a\n  fv (ta \\<cdot> \\<delta>a) = {}\n  t = tb \\<cdot> \\<delta>b\n  fv (tb \\<cdot> \\<delta>b) = {}\n\ngoal (1 subgoal):\n 1. t = ua \\<cdot> \\<sigma>a \\<circ>\\<^sub>s \\<delta>a &&& fv t = {}", "by auto"], ["proof (state)\nthis:\n  t = ua \\<cdot> \\<sigma>a \\<circ>\\<^sub>s \\<delta>a\n  fv t = {}\n\ngoal (1 subgoal):\n 1. R ta \\<and> R tb \\<Longrightarrow>\n    t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "thus ?thesis"], ["proof (prove)\nusing this:\n  t = ua \\<cdot> \\<sigma>a \\<circ>\\<^sub>s \\<delta>a\n  fv t = {}\n\ngoal (1 subgoal):\n 1. t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using ua(2) wt_subst_compose[OF ua(3) ta(3)] wf_trms_subst_compose[OF ua(4) ta(4)]"], ["proof (prove)\nusing this:\n  t = ua \\<cdot> \\<sigma>a \\<circ>\\<^sub>s \\<delta>a\n  fv t = {}\n  ua \\<in> C\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<sigma>a \\<circ>\\<^sub>s \\<delta>a)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<sigma>a \\<circ>\\<^sub>s \\<delta>a))\n\ngoal (1 subgoal):\n 1. t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "unfolding f_def"], ["proof (prove)\nusing this:\n  t = ua \\<cdot> \\<sigma>a \\<circ>\\<^sub>s \\<delta>a\n  fv t = {}\n  ua \\<in> C\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n   (\\<sigma>a \\<circ>\\<^sub>s \\<delta>a)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (subst_range (\\<sigma>a \\<circ>\\<^sub>s \\<delta>a))\n\ngoal (1 subgoal):\n 1. t \\<in> {t \\<cdot> \\<delta> |t \\<delta>.\n             t \\<in> C \\<and>\n             wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n             wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n              (subst_range \\<delta>) \\<and>\n             fv (t \\<cdot> \\<delta>) = {}} \\<union>\n            {m. {} \\<turnstile>\\<^sub>c m}", "by blast"], ["proof (state)\nthis:\n  t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  t \\<in> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ground_SMP_disjointI:\n  fixes A B::\"('fun, ('fun, 'atom) term \\<times> nat) term list\" and C\n  defines \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and \"g \\<equiv> \\<lambda>M. {t \\<in> M. fv t = {}}\"\n    and \"Q \\<equiv> \\<lambda>t. intruder_synth' public arity {} t\"\n    and \"R \\<equiv> \\<lambda>t. \\<exists>u \\<in> C. is_wt_instance_of_cond \\<Gamma> t u\"\n  assumes AB_fv_disj: \"fv\\<^sub>s\\<^sub>e\\<^sub>t (set A) \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t (set B) = {}\"\n    and A_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> A\"\n    and B_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> B\"\n    and C_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s C\"\n    and ABC: \"\\<forall>t \\<in> set A. \\<forall>s \\<in> set B. \\<Gamma> t = \\<Gamma> s \\<and> mgu t s \\<noteq> None \\<longrightarrow> (Q t \\<and> Q s) \\<or> (R t \\<and> R s)\"\n  shows \"g (SMP (set A)) \\<inter> g (SMP (set B)) \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g (SMP (set A)) \\<inter> g (SMP (set B))\n    \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. g (SMP (set A)) \\<inter> g (SMP (set B))\n    \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "have AB_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A)\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B)", "using A_SMP_repr B_SMP_repr"], ["proof (prove)\nusing this:\n  finite_SMP_representation arity Ana \\<Gamma> A\n  finite_SMP_representation arity Ana \\<Gamma> B\n\ngoal (1 subgoal):\n 1. wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B)", "unfolding finite_SMP_representation_def wf\\<^sub>t\\<^sub>r\\<^sub>m_code list_all_iff"], ["proof (prove)\nusing this:\n  Ball (set A) (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set A)) (set A) \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set A)) (set A) \\<and>\n  is_TComp_var_instance_closed \\<Gamma> A\n  Ball (set B) (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set B)) (set B) \\<and>\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set B)) (set B) \\<and>\n  is_TComp_var_instance_closed \\<Gamma> B\n\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>set A. wf\\<^sub>t\\<^sub>r\\<^sub>m' arity t &&&\n    \\<forall>t\\<in>set B. wf\\<^sub>t\\<^sub>r\\<^sub>m' arity t", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B)\n\ngoal (1 subgoal):\n 1. g (SMP (set A)) \\<inter> g (SMP (set B))\n    \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "let ?P = \"\\<lambda>t s. \\<exists>\\<delta>. wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> Unifier \\<delta> t s\""], ["proof (state)\ngoal (1 subgoal):\n 1. g (SMP (set A)) \\<inter> g (SMP (set B))\n    \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "have ABC': \"\\<forall>t \\<in> set A. \\<forall>s \\<in> set B. ?P t s \\<longrightarrow> (Q t \\<and> Q s) \\<or> (R t \\<and> R s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>t\\<in>set A.\n       \\<forall>s\\<in>set B.\n          (\\<exists>\\<delta>.\n              wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n              wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n               (subst_range \\<delta>) \\<and>\n              Unifier \\<delta> t s) \\<longrightarrow>\n          Q t \\<and> Q s \\<or> R t \\<and> R s", "by (metis (no_types) ABC mgu_None_is_subst_neq wt_subst_trm'')"], ["proof (state)\nthis:\n  \\<forall>t\\<in>set A.\n     \\<forall>s\\<in>set B.\n        (\\<exists>\\<delta>.\n            wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n            wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and>\n            Unifier \\<delta> t s) \\<longrightarrow>\n        Q t \\<and> Q s \\<or> R t \\<and> R s\n\ngoal (1 subgoal):\n 1. g (SMP (set A)) \\<inter> g (SMP (set B))\n    \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. g (SMP (set A)) \\<inter> g (SMP (set B))\n    \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using ground_SMP_disjointI_aux1[OF f_def g_def, of \"set A\"]\n          ground_SMP_disjointI_aux1[OF f_def g_def, of \"set B\"]\n          ground_SMP_disjointI_aux2[OF f_def A_SMP_repr]\n          ground_SMP_disjointI_aux2[OF f_def B_SMP_repr]\n          ground_SMP_disjointI_aux3[OF f_def Q_def R_def AB_wf AB_fv_disj C_wf ABC']"], ["proof (prove)\nusing this:\n  f (SMP (set A)) = g (SMP (set A))\n  f (SMP (set B)) = g (SMP (set B))\n  f (set A) = f (SMP (set A))\n  f (set B) = f (SMP (set B))\n  f (set A) \\<inter> f (set B)\n  \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. g (SMP (set A)) \\<inter> g (SMP (set B))\n    \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by argo"], ["proof (state)\nthis:\n  g (SMP (set A)) \\<inter> g (SMP (set B))\n  \\<subseteq> f C \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"], ["", "end"]]}