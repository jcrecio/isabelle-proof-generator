{"file_name": "/home/qj213/afp-2021-10-22/thys/Stateful_Protocol_Composition_and_Typing/Parallel_Compositionality.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Stateful_Protocol_Composition_and_Typing", "problem_names": ["lemma intruder_deduct_hom_AxiomH[simp]:\n  assumes \"t \\<in> M\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\"", "lemma intruder_deduct_hom_ComposeH[simp]:\n  assumes \"length X = arity f\" \"public f\" \"\\<And>x. x \\<in> set X \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x\"\n  and \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec\" \"Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\"", "lemma intruder_deduct_hom_DecomposeH:\n  assumes \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\" \"Ana t = (K, T)\" \"\\<And>k. k \\<in> set K \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k\" \"t\\<^sub>i \\<in> set T\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\"", "lemma intruder_deduct_hom_induct[consumes 1, case_names AxiomH ComposeH DecomposeH]:\n  assumes \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\" \"\\<And>t. t \\<in> M \\<Longrightarrow> P M t\"\n          \"\\<And>X f. \\<lbrakk>length X = arity f; public f;\n                  \\<And>x. x \\<in> set X \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n                  \\<And>x. x \\<in> set X \\<Longrightarrow> P M x;\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n                  Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n                  \\<rbrakk> \\<Longrightarrow> P M (Fun f X)\"\n          \"\\<And>t K T t\\<^sub>i. \\<lbrakk>\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t; P M t; Ana t = (K, T);\n                       \\<And>k. k \\<in> set K \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n                       \\<And>k. k \\<in> set K \\<Longrightarrow> P M k; t\\<^sub>i \\<in> set T\\<rbrakk> \\<Longrightarrow> P M t\\<^sub>i\"\n        shows \"P M t\"", "lemma ideduct_hom_mono:\n  \"\\<lbrakk>\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t; M \\<subseteq> M'\\<rbrakk> \\<Longrightarrow> \\<langle>M'; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\"", "lemma GSMP_disjoint_empty[simp]:\n  \"GSMP_disjoint {} A Sec\" \"GSMP_disjoint A {} Sec\"", "lemma GSMP_mono:\n  assumes \"N \\<subseteq> M\"\n  shows \"GSMP N \\<subseteq> GSMP M\"", "lemma GSMP_SMP_mono:\n  assumes \"SMP N \\<subseteq> SMP M\"\n  shows \"GSMP N \\<subseteq> GSMP M\"", "lemma GSMP_subterm:\n  assumes \"t \\<in> GSMP M\" \"t' \\<sqsubseteq> t\"\n  shows \"t' \\<in> GSMP M\"", "lemma GSMP_subterms: \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (GSMP M) = GSMP M\"", "lemma GSMP_Ana_key:\n  assumes \"t \\<in> GSMP M\" \"Ana t = (K,T)\" \"k \\<in> set K\"\n  shows \"k \\<in> GSMP M\"", "lemma GSMP_append[simp]: \"GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (A@B)) = GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<union> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t B)\"", "lemma GSMP_union: \"GSMP (A \\<union> B) = GSMP A \\<union> GSMP B\"", "lemma GSMP_Union: \"GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) = (\\<Union>l. GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A))\"", "lemma in_GSMP_in_proj: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<Longrightarrow> \\<exists>n. t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\"", "lemma in_proj_in_GSMP: \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) \\<Longrightarrow> t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\"", "lemma GSMP_disjointE:\n  assumes A: \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) Sec\"\n  shows \"GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"", "lemma GSMP_disjoint_term:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  shows \"t \\<notin> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<or> t \\<notin> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) \\<or> t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t\"", "lemma GSMP_wt_subst_subset:\n  assumes \"t \\<in> GSMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>)\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\"\n  shows \"t \\<in> GSMP M\"", "lemma GSMP_wt_substI:\n  assumes \"t \\<in> M\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"t \\<cdot> I \\<in> GSMP M\"", "lemma GSMP_disjoint_subset:\n  assumes \"GSMP_disjoint L R S\" \"L' \\<subseteq> L\" \"R' \\<subseteq> R\"\n  shows \"GSMP_disjoint L' R' S\"", "lemma GSMP_disjoint_fst_specific_not_snd_specific:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\" \"l \\<noteq> l'\"\n  and \"proj_specific l m \\<A> Sec\"\n  shows \"\\<not>proj_specific l' m \\<A> Sec\"", "lemma GSMP_disjoint_snd_specific_not_fst_specific:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and \"proj_specific l' m \\<A> Sec\"\n  shows \"\\<not>proj_specific l m \\<A> Sec\"", "lemma GSMP_disjoint_intersection_not_specific:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and \"t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t\"\n  shows \"\\<not>proj_specific l t \\<A> Sec\" \"\\<not>proj_specific l t \\<A> Sec\"", "lemma ik_proj_subst_GSMP_subset:\n  assumes I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\"", "lemma declassified_proj_ik_subset: \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I\"", "lemma declassified_proj_GSMP_subset:\n  assumes I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\"", "lemma declassified_subterms_proj_GSMP_subset:\n  assumes I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I) \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\"", "lemma declassified_secrets_subset:\n  assumes A: \"\\<forall>n m. n \\<noteq> m \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) Sec\"\n  and I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"", "lemma declassified_subterms_secrets_subset:\n  assumes A: \"\\<forall>n m. n \\<noteq> m \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) Sec\"\n  and I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I) \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"", "lemma declassified_proj_eq: \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I = declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I\"", "lemma declassified_append: \"declassified\\<^sub>l\\<^sub>s\\<^sub>t (A@B) I = declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<union> declassified\\<^sub>l\\<^sub>s\\<^sub>t B I\"", "lemma declassified_prefix_subset: \"prefix A B \\<Longrightarrow> declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> declassified\\<^sub>l\\<^sub>s\\<^sub>t B I\"", "lemma proj_specific_secrets_anti_mono:\n  assumes \"proj_specific l t \\<A> Sec\" \"Sec' \\<subseteq> Sec\"\n  shows \"proj_specific l t \\<A> Sec'\"", "lemma heterogeneous_secrets_anti_mono:\n  assumes \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"Sec' \\<subseteq> Sec\"\n  shows \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec'\"", "lemma homogeneous_secrets_mono:\n  assumes \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec'\" \"Sec' \\<subseteq> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\"", "lemma heterogeneous_supterm:\n  assumes \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"t \\<sqsubseteq> t'\"\n  shows \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec\"", "lemma homogeneous_subterm:\n  assumes \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"t' \\<sqsubseteq> t\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec\"", "lemma proj_specific_subterm:\n  assumes \"t \\<sqsubseteq> t'\" \"proj_specific l t' \\<A> Sec\"\n  shows \"proj_specific l t \\<A> Sec \\<or> t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t\"", "lemma heterogeneous_term_is_Fun:\n  assumes \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A S\" shows \"\\<exists>f T. t = Fun f T\"", "lemma proj_specific_is_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"proj_specific l m \\<A> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\"", "lemma deduct_synth_homogeneous:\n  assumes \"{} \\<turnstile>\\<^sub>c t\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\"", "lemma GSMP_proj_is_homogeneous:\n  assumes \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' A) Sec\"\n  and \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A)\" \"t \\<notin> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec\"", "lemma homogeneous_is_not_proj_specific:\n  assumes \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\"\n  shows \"\\<exists>l::'lbl. \\<not>proj_specific l m \\<A> Sec\"", "lemma secrets_are_homogeneous:\n  assumes \"\\<forall>s \\<in> Sec. P s \\<longrightarrow> (\\<forall>s' \\<in> subterms s. {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec)\" \"s \\<in> Sec\" \"P s\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\"", "lemma GSMP_is_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\" \"t \\<notin> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\"", "lemma GSMP_intersection_is_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n    and t: \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>)\" \"l \\<noteq> l'\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\"", "lemma GSMP_is_homogeneous':\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n         \"t \\<notin> Sec - \\<Union>{GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) | l1 l2. l1 \\<noteq> l2}\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\"", "lemma declassified_secrets_are_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n    and \\<I>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\"\n    and s: \"s \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\"", "lemma Ana_keys_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  and k: \"Ana t = (K,T)\" \"k \\<in> set K\"\n         \"k \\<notin> Sec - \\<Union>{GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) | l1 l2. l1 \\<noteq> l2}\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\"", "lemma deduct_if_hom_deduct: \"\\<langle>M;A;S\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m \\<Longrightarrow> M \\<turnstile> m\"", "lemma hom_deduct_if_hom_ik:\n  assumes \"\\<langle>M;A;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\" \"\\<forall>m \\<in> M. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\"", "lemma deduct_hom_if_synth:\n  assumes hom: \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\" \"m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  and m: \"M \\<turnstile>\\<^sub>c m\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\"", "lemma hom_deduct_if_deduct:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and M: \"\\<forall>m\\<in>M. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  and m: \"M \\<turnstile> m\" \"m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\nshows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\"", "lemma par_comp_hom_deduct:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and M: \"\\<forall>l. \\<forall>m \\<in> M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\"\n         \"\\<forall>l. M l \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n         \"\\<forall>l. Discl \\<subseteq> M l\"\n         \"Discl \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"\n  and Sec: \"\\<forall>l. \\<forall>s \\<in> Sec - Discl. \\<not>(\\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)\"\n  and t: \"\\<langle>\\<Union>l. M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\"\n  shows \"t \\<notin> Sec - Discl\" (is ?A)\n        \"\\<forall>l. t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<longrightarrow> \\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\" (is ?B)", "lemma par_comp_deduct_proj:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and M: \"\\<forall>l. \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\"\n         \"\\<forall>l. M l \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n         \"\\<forall>l. Discl \\<subseteq> M l\"\n  and t: \"(\\<Union>l. M l) \\<turnstile> t\" \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n  and Discl: \"Discl \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"\n  shows \"M l \\<turnstile> t \\<or> (\\<exists>s \\<in> Sec - Discl. \\<exists>l. M l \\<turnstile> s)\"", "lemma par_comp_prefix: assumes \"par_comp (A@B) M\" shows \"par_comp A M\"", "theorem par_comp_constr_typed:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and \\<I>: \"\\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\"\n  shows \"(\\<forall>l. (\\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>)) \\<or> (\\<exists>\\<A>'. prefix \\<A>' \\<A> \\<and> (strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>))\"", "theorem par_comp_constr:\n  assumes \\<A>: \"par_comp \\<A> Sec\" \"typing_cond (unlabel \\<A>)\"\n  and \\<I>: \"\\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\"\n  shows \"\\<exists>\\<I>\\<^sub>\\<tau>. interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>) \\<and> (\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>) \\<and>\n              ((\\<forall>l. (\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>)) \\<or> (\\<exists>\\<A>'. prefix \\<A>' \\<A> \\<and> (strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>)))\"", "lemma wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s_eqs_wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s'[simp]: \"wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s S = wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s' S []\"", "lemma par_comp_prot_impl_par_comp:\n  assumes \"par_comp_prot \\<P> Sec\" \"\\<A> \\<in> \\<P>\"\n  shows \"par_comp \\<A> Sec\"", "lemma typing_cond_prot_impl_typing_cond:\n  assumes \"typing_cond_prot \\<P>\" \"\\<A> \\<in> \\<P>\"\n  shows \"typing_cond (unlabel \\<A>)\"", "theorem par_comp_constr_prot:\n  assumes P: \"P = composed_prot Pi\" \"par_comp_prot P Sec\" \"\\<forall>n. component_prot n (Pi n)\"\n  and left_secure: \"component_secure_prot n (Pi n) Sec attack\"\n  shows \"\\<forall>\\<A> \\<in> P. suffix [(ln n, Send (Fun attack []))] \\<A> \\<longrightarrow>\n                  unsat \\<A> \\<or> (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)\"", "lemma GSMP_disjointI:\n  fixes A' A B B'::\"('fun, ('fun, 'atom) term \\<times> nat) term list\"\n  defines \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and \"\\<delta> \\<equiv> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set A)))\"\n  assumes A'_wf: \"list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) A'\"\n    and B'_wf: \"list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) B'\"\n    and A_inst: \"has_all_wt_instances_of \\<Gamma> (set A') (set A)\"\n    and B_inst: \"has_all_wt_instances_of \\<Gamma> (set B') (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\"\n    and A_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> A\"\n    and B_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\"\n    and AB_trms_disj:\n      \"\\<forall>t \\<in> set A. \\<forall>s \\<in> set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>). \\<Gamma> t = \\<Gamma> s \\<and> mgu t s \\<noteq> None \\<longrightarrow>\n        (intruder_synth' public arity {} t \\<and> intruder_synth' public arity {} s) \\<or>\n        ((\\<exists>u \\<in> Sec. is_wt_instance_of_cond \\<Gamma> t u) \\<and> (\\<exists>u \\<in> Sec. is_wt_instance_of_cond \\<Gamma> s u))\"\n    and Sec_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s Sec\"\n  shows \"GSMP_disjoint (set A') (set B') ((f Sec) - {m. {} \\<turnstile>\\<^sub>c m})\""], "translations": [["", "lemma intruder_deduct_hom_AxiomH[simp]:\n  assumes \"t \\<in> M\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "using intruder_deduct_restricted.AxiomR[of t M] assms"], ["proof (prove)\nusing this:\n  t \\<in> M \\<Longrightarrow> \\<langle>M;?Q\\<rangle> \\<turnstile>\\<^sub>r t\n  t \\<in> M\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  t \\<in> M \\<Longrightarrow> \\<langle>M;?Q\\<rangle> \\<turnstile>\\<^sub>r t\n  t \\<in> M\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<lambda>t.\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                  t \\<in> GSMP\n                           (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                             \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t", "by blast"], ["", "lemma intruder_deduct_hom_ComposeH[simp]:\n  assumes \"length X = arity f\" \"public f\" \"\\<And>x. x \\<in> set X \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x\"\n  and \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec\" \"Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f\n                                 X", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f\n                                 X", "let ?Q = \"\\<lambda>t. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and> t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f\n                                 X", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f\n                                 X", "using intruder_deduct_restricted.ComposeR[of X f M ?Q] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>length X = arity f; public f;\n   \\<And>t.\n      t \\<in> set X \\<Longrightarrow>\n      \\<langle>M;\\<lambda>t.\n                    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                    t \\<in> GSMP\n                             (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                               \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n   homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec \\<and>\n   Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M;\\<lambda>t.\n                                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                                   Sec \\<and>\n                                  t \\<in> GSMP\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t\n       \\<A>)\\<rangle> \\<turnstile>\\<^sub>r Fun f X\n  length X = arity f\n  public f\n  ?x6 \\<in> set X \\<Longrightarrow>\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?x6\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec\n  Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f\n                                 X", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>length X = arity f; public f;\n   \\<And>t.\n      t \\<in> set X \\<Longrightarrow>\n      \\<langle>M;\\<lambda>t.\n                    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                    t \\<in> GSMP\n                             (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                               \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n   homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec \\<and>\n   Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M;\\<lambda>t.\n                                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                                   Sec \\<and>\n                                  t \\<in> GSMP\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t\n       \\<A>)\\<rangle> \\<turnstile>\\<^sub>r Fun f X\n  length X = arity f\n  public f\n  ?x6 \\<in> set X \\<Longrightarrow>\n  \\<langle>M;\\<lambda>t.\n                homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                t \\<in> GSMP\n                         (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                           \\<A>)\\<rangle> \\<turnstile>\\<^sub>r ?x6\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec\n  Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<lambda>t.\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                  t \\<in> GSMP\n                           (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                             \\<A>)\\<rangle> \\<turnstile>\\<^sub>r Fun f X", "by blast"], ["proof (state)\nthis:\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma intruder_deduct_hom_DecomposeH:\n  assumes \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\" \"Ana t = (K, T)\" \"\\<And>k. k \\<in> set K \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k\" \"t\\<^sub>i \\<in> set T\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "let ?Q = \"\\<lambda>t. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and> t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "using intruder_deduct_restricted.DecomposeR[of M ?Q t] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<langle>M;\\<lambda>t.\n                         homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                          Sec \\<and>\n                         t \\<in> GSMP\n                                  (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                    \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n   Ana t = (?K, ?T);\n   \\<And>k.\n      k \\<in> set ?K \\<Longrightarrow>\n      \\<langle>M;\\<lambda>t.\n                    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                    t \\<in> GSMP\n                             (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                               \\<A>)\\<rangle> \\<turnstile>\\<^sub>r k;\n   ?t\\<^sub>i \\<in> set ?T\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M;\\<lambda>t.\n                                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                                   Sec \\<and>\n                                  t \\<in> GSMP\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t\n       \\<A>)\\<rangle> \\<turnstile>\\<^sub>r ?t\\<^sub>i\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  Ana t = (K, T)\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n  t\\<^sub>i \\<in> set T\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<langle>M;\\<lambda>t.\n                         homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                          Sec \\<and>\n                         t \\<in> GSMP\n                                  (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                    \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n   Ana t = (?K, ?T);\n   \\<And>k.\n      k \\<in> set ?K \\<Longrightarrow>\n      \\<langle>M;\\<lambda>t.\n                    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                    t \\<in> GSMP\n                             (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                               \\<A>)\\<rangle> \\<turnstile>\\<^sub>r k;\n   ?t\\<^sub>i \\<in> set ?T\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M;\\<lambda>t.\n                                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                                   Sec \\<and>\n                                  t \\<in> GSMP\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t\n       \\<A>)\\<rangle> \\<turnstile>\\<^sub>r ?t\\<^sub>i\n  \\<langle>M;\\<lambda>t.\n                homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                t \\<in> GSMP\n                         (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                           \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t\n  Ana t = (K, T)\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M;\\<lambda>t.\n                homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                t \\<in> GSMP\n                         (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                           \\<A>)\\<rangle> \\<turnstile>\\<^sub>r ?k6\n  t\\<^sub>i \\<in> set T\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<lambda>t.\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                  t \\<in> GSMP\n                           (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                             \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t\\<^sub>i", "by blast"], ["proof (state)\nthis:\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma intruder_deduct_hom_induct[consumes 1, case_names AxiomH ComposeH DecomposeH]:\n  assumes \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\" \"\\<And>t. t \\<in> M \\<Longrightarrow> P M t\"\n          \"\\<And>X f. \\<lbrakk>length X = arity f; public f;\n                  \\<And>x. x \\<in> set X \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n                  \\<And>x. x \\<in> set X \\<Longrightarrow> P M x;\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n                  Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n                  \\<rbrakk> \\<Longrightarrow> P M (Fun f X)\"\n          \"\\<And>t K T t\\<^sub>i. \\<lbrakk>\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t; P M t; Ana t = (K, T);\n                       \\<And>k. k \\<in> set K \\<Longrightarrow> \\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n                       \\<And>k. k \\<in> set K \\<Longrightarrow> P M k; t\\<^sub>i \\<in> set T\\<rbrakk> \\<Longrightarrow> P M t\\<^sub>i\"\n        shows \"P M t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P M t", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. P M t", "let ?Q = \"\\<lambda>t. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and> t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (state)\ngoal (1 subgoal):\n 1. P M t", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. P M t", "using intruder_deduct_restricted_induct[of M ?Q t \"\\<lambda>M Q t. P M t\"] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<langle>M;\\<lambda>t.\n                         homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                          Sec \\<and>\n                         t \\<in> GSMP\n                                  (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                    \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n   \\<And>t. t \\<in> M \\<Longrightarrow> P M t;\n   \\<And>T f.\n      \\<lbrakk>length T = arity f; public f;\n       \\<And>t.\n          t \\<in> set T \\<Longrightarrow>\n          \\<langle>M;\\<lambda>t.\n                        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                         Sec \\<and>\n                        t \\<in> GSMP\n                                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                   \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n       \\<And>t. t \\<in> set T \\<Longrightarrow> P M t;\n       homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f T) \\<A> Sec \\<and>\n       Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n      \\<Longrightarrow> P M (Fun f T);\n   \\<And>t K T t\\<^sub>i.\n      \\<lbrakk>\\<langle>M;\\<lambda>t.\n                             homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                              Sec \\<and>\n                             t \\<in> GSMP\n(trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n       P M t; Ana t = (K, T);\n       \\<And>k.\n          k \\<in> set K \\<Longrightarrow>\n          \\<langle>M;\\<lambda>t.\n                        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                         Sec \\<and>\n                        t \\<in> GSMP\n                                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                   \\<A>)\\<rangle> \\<turnstile>\\<^sub>r k;\n       \\<And>k. k \\<in> set K \\<Longrightarrow> P M k;\n       t\\<^sub>i \\<in> set T\\<rbrakk>\n      \\<Longrightarrow> P M t\\<^sub>i\\<rbrakk>\n  \\<Longrightarrow> P M t\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  ?t6 \\<in> M \\<Longrightarrow> P M ?t6\n  \\<lbrakk>length ?X6 = arity ?f6; public ?f6;\n   \\<And>x.\n      x \\<in> set ?X6 \\<Longrightarrow>\n      \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n   \\<And>x. x \\<in> set ?X6 \\<Longrightarrow> P M x;\n   homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun ?f6 ?X6) \\<A> Sec;\n   Fun ?f6 ?X6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> P M (Fun ?f6 ?X6)\n  \\<lbrakk>\\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?t6;\n   P M ?t6; Ana ?t6 = (?K6, ?T6);\n   \\<And>k.\n      k \\<in> set ?K6 \\<Longrightarrow>\n      \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n   \\<And>k. k \\<in> set ?K6 \\<Longrightarrow> P M k;\n   ?t\\<^sub>i6 \\<in> set ?T6\\<rbrakk>\n  \\<Longrightarrow> P M ?t\\<^sub>i6\n\ngoal (1 subgoal):\n 1. P M t", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<langle>M;\\<lambda>t.\n                         homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                          Sec \\<and>\n                         t \\<in> GSMP\n                                  (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                    \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n   \\<And>t. t \\<in> M \\<Longrightarrow> P M t;\n   \\<And>T f.\n      \\<lbrakk>length T = arity f; public f;\n       \\<And>t.\n          t \\<in> set T \\<Longrightarrow>\n          \\<langle>M;\\<lambda>t.\n                        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                         Sec \\<and>\n                        t \\<in> GSMP\n                                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                   \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n       \\<And>t. t \\<in> set T \\<Longrightarrow> P M t;\n       homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f T) \\<A> Sec \\<and>\n       Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n      \\<Longrightarrow> P M (Fun f T);\n   \\<And>t K T t\\<^sub>i.\n      \\<lbrakk>\\<langle>M;\\<lambda>t.\n                             homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                              Sec \\<and>\n                             t \\<in> GSMP\n(trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n       P M t; Ana t = (K, T);\n       \\<And>k.\n          k \\<in> set K \\<Longrightarrow>\n          \\<langle>M;\\<lambda>t.\n                        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                         Sec \\<and>\n                        t \\<in> GSMP\n                                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                   \\<A>)\\<rangle> \\<turnstile>\\<^sub>r k;\n       \\<And>k. k \\<in> set K \\<Longrightarrow> P M k;\n       t\\<^sub>i \\<in> set T\\<rbrakk>\n      \\<Longrightarrow> P M t\\<^sub>i\\<rbrakk>\n  \\<Longrightarrow> P M t\n  \\<langle>M;\\<lambda>t.\n                homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                t \\<in> GSMP\n                         (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                           \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t\n  ?t6 \\<in> M \\<Longrightarrow> P M ?t6\n  \\<lbrakk>length ?X6 = arity ?f6; public ?f6;\n   \\<And>x.\n      x \\<in> set ?X6 \\<Longrightarrow>\n      \\<langle>M;\\<lambda>t.\n                    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                    t \\<in> GSMP\n                             (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                               \\<A>)\\<rangle> \\<turnstile>\\<^sub>r x;\n   \\<And>x. x \\<in> set ?X6 \\<Longrightarrow> P M x;\n   homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun ?f6 ?X6) \\<A> Sec;\n   Fun ?f6 ?X6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> P M (Fun ?f6 ?X6)\n  \\<lbrakk>\\<langle>M;\\<lambda>t.\n                         homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                          Sec \\<and>\n                         t \\<in> GSMP\n                                  (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                    \\<A>)\\<rangle> \\<turnstile>\\<^sub>r ?t6;\n   P M ?t6; Ana ?t6 = (?K6, ?T6);\n   \\<And>k.\n      k \\<in> set ?K6 \\<Longrightarrow>\n      \\<langle>M;\\<lambda>t.\n                    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                    t \\<in> GSMP\n                             (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                               \\<A>)\\<rangle> \\<turnstile>\\<^sub>r k;\n   \\<And>k. k \\<in> set ?K6 \\<Longrightarrow> P M k;\n   ?t\\<^sub>i6 \\<in> set ?T6\\<rbrakk>\n  \\<Longrightarrow> P M ?t\\<^sub>i6\n\ngoal (1 subgoal):\n 1. P M t", "by blast"], ["proof (state)\nthis:\n  P M t\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ideduct_hom_mono:\n  \"\\<lbrakk>\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t; M \\<subseteq> M'\\<rbrakk> \\<Longrightarrow> \\<langle>M'; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n     M \\<subseteq> M'\\<rbrakk>\n    \\<Longrightarrow> \\<langle>M';\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "using ideduct_restricted_mono[of M _ t M']"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<langle>M;?P\\<rangle> \\<turnstile>\\<^sub>r t;\n   M \\<subseteq> M'\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M';?P\\<rangle> \\<turnstile>\\<^sub>r t\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n     M \\<subseteq> M'\\<rbrakk>\n    \\<Longrightarrow> \\<langle>M';\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<langle>M;?P\\<rangle> \\<turnstile>\\<^sub>r t;\n   M \\<subseteq> M'\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M';?P\\<rangle> \\<turnstile>\\<^sub>r t\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<langle>M;\\<lambda>t.\n                           homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A>\n                            Sec \\<and>\n                           t \\<in> GSMP\n                                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n\\<A>)\\<rangle> \\<turnstile>\\<^sub>r t;\n     M \\<subseteq> M'\\<rbrakk>\n    \\<Longrightarrow> \\<langle>M';\\<lambda>t.\n                                     homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t\n\\<A> Sec \\<and>\n                                     t \\<in> GSMP\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rangle> \\<turnstile>\\<^sub>r t", "by fast"], ["", "subsection \\<open>Lemmata: GSMP\\<close>"], ["", "lemma GSMP_disjoint_empty[simp]:\n  \"GSMP_disjoint {} A Sec\" \"GSMP_disjoint A {} Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP_disjoint {} A Sec &&& GSMP_disjoint A {} Sec", "unfolding GSMP_disjoint_def GSMP_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {t \\<in> SMP {}. fv t = {}} \\<inter> {t \\<in> SMP A. fv t = {}}\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m} &&&\n    {t \\<in> SMP A. fv t = {}} \\<inter> {t \\<in> SMP {}. fv t = {}}\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by fastforce+"], ["", "lemma GSMP_mono:\n  assumes \"N \\<subseteq> M\"\n  shows \"GSMP N \\<subseteq> GSMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP N \\<subseteq> GSMP M", "using SMP_mono[OF assms]"], ["proof (prove)\nusing this:\n  SMP N \\<subseteq> SMP M\n\ngoal (1 subgoal):\n 1. GSMP N \\<subseteq> GSMP M", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  SMP N \\<subseteq> SMP M\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP N. fv t = {}} \\<subseteq> {t \\<in> SMP M. fv t = {}}", "by fast"], ["", "lemma GSMP_SMP_mono:\n  assumes \"SMP N \\<subseteq> SMP M\"\n  shows \"GSMP N \\<subseteq> GSMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP N \\<subseteq> GSMP M", "using assms"], ["proof (prove)\nusing this:\n  SMP N \\<subseteq> SMP M\n\ngoal (1 subgoal):\n 1. GSMP N \\<subseteq> GSMP M", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  SMP N \\<subseteq> SMP M\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP N. fv t = {}} \\<subseteq> {t \\<in> SMP M. fv t = {}}", "by fast"], ["", "lemma GSMP_subterm:\n  assumes \"t \\<in> GSMP M\" \"t' \\<sqsubseteq> t\"\n  shows \"t' \\<in> GSMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t' \\<in> GSMP M", "using SMP.Subterm[of t M t'] ground_subterm[of t t'] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>t \\<in> SMP M; t' \\<sqsubseteq> t\\<rbrakk>\n  \\<Longrightarrow> t' \\<in> SMP M\n  \\<lbrakk>fv t = {}; t' \\<sqsubseteq> t\\<rbrakk>\n  \\<Longrightarrow> fv t' = {}\n  t \\<in> GSMP M\n  t' \\<sqsubseteq> t\n\ngoal (1 subgoal):\n 1. t' \\<in> GSMP M", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>t \\<in> SMP M; t' \\<sqsubseteq> t\\<rbrakk>\n  \\<Longrightarrow> t' \\<in> SMP M\n  \\<lbrakk>fv t = {}; t' \\<sqsubseteq> t\\<rbrakk>\n  \\<Longrightarrow> fv t' = {}\n  t \\<in> {t \\<in> SMP M. fv t = {}}\n  t' \\<sqsubseteq> t\n\ngoal (1 subgoal):\n 1. t' \\<in> {t \\<in> SMP M. fv t = {}}", "by auto"], ["", "lemma GSMP_subterms: \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (GSMP M) = GSMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t (GSMP M) = GSMP M", "using GSMP_subterm[of _ M]"], ["proof (prove)\nusing this:\n  \\<lbrakk>?t \\<in> GSMP M; ?t' \\<sqsubseteq> ?t\\<rbrakk>\n  \\<Longrightarrow> ?t' \\<in> GSMP M\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t (GSMP M) = GSMP M", "by blast"], ["", "lemma GSMP_Ana_key:\n  assumes \"t \\<in> GSMP M\" \"Ana t = (K,T)\" \"k \\<in> set K\"\n  shows \"k \\<in> GSMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k \\<in> GSMP M", "using SMP.Ana[of t M K T k] Ana_keys_fv[of t K T] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>t \\<in> SMP M; Ana t = (K, T); k \\<in> set K\\<rbrakk>\n  \\<Longrightarrow> k \\<in> SMP M\n  Ana t = (K, T) \\<Longrightarrow>\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set K) \\<subseteq> fv t\n  t \\<in> GSMP M\n  Ana t = (K, T)\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. k \\<in> GSMP M", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>t \\<in> SMP M; Ana t = (K, T); k \\<in> set K\\<rbrakk>\n  \\<Longrightarrow> k \\<in> SMP M\n  Ana t = (K, T) \\<Longrightarrow>\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set K) \\<subseteq> fv t\n  t \\<in> {t \\<in> SMP M. fv t = {}}\n  Ana t = (K, T)\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. k \\<in> {t \\<in> SMP M. fv t = {}}", "by auto"], ["", "lemma GSMP_append[simp]: \"GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (A@B)) = GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<union> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (A @ B)) =\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<union>\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t B)", "using SMP_union[of \"trms\\<^sub>l\\<^sub>s\\<^sub>t A\" \"trms\\<^sub>l\\<^sub>s\\<^sub>t B\"] trms\\<^sub>l\\<^sub>s\\<^sub>t_append[of A B]"], ["proof (prove)\nusing this:\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t B) =\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<union>\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t B)\n  trms\\<^sub>l\\<^sub>s\\<^sub>t (A @ B) =\n  trms\\<^sub>l\\<^sub>s\\<^sub>t A \\<union> trms\\<^sub>l\\<^sub>s\\<^sub>t B\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (A @ B)) =\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<union>\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t B)", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t B) =\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<union>\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t B)\n  trms\\<^sub>l\\<^sub>s\\<^sub>t (A @ B) =\n  trms\\<^sub>l\\<^sub>s\\<^sub>t A \\<union> trms\\<^sub>l\\<^sub>s\\<^sub>t B\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (A @ B)). fv t = {}} =\n    {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A). fv t = {}} \\<union>\n    {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t B). fv t = {}}", "by auto"], ["", "lemma GSMP_union: \"GSMP (A \\<union> B) = GSMP A \\<union> GSMP B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP (A \\<union> B) = GSMP A \\<union> GSMP B", "using SMP_union[of A B]"], ["proof (prove)\nusing this:\n  SMP (A \\<union> B) = SMP A \\<union> SMP B\n\ngoal (1 subgoal):\n 1. GSMP (A \\<union> B) = GSMP A \\<union> GSMP B", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  SMP (A \\<union> B) = SMP A \\<union> SMP B\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP (A \\<union> B). fv t = {}} =\n    {t \\<in> SMP A. fv t = {}} \\<union> {t \\<in> SMP B. fv t = {}}", "by auto"], ["", "lemma GSMP_Union: \"GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) = (\\<Union>l. GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "define P where \"P \\<equiv> (\\<lambda>l. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A)\""], ["proof (state)\nthis:\n  P \\<equiv> \\<lambda>l. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "define Q where \"Q \\<equiv> trms\\<^sub>l\\<^sub>s\\<^sub>t A\""], ["proof (state)\nthis:\n  Q \\<equiv> trms\\<^sub>l\\<^sub>s\\<^sub>t A\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "have \"SMP (\\<Union>l. P l) = (\\<Union>l. SMP (P l))\" \"Q = (\\<Union>l. P l)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (\\<Union> (range P)) = (\\<Union>l. SMP (P l)) &&&\n    Q = \\<Union> (range P)", "unfolding P_def Q_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (\\<Union>l. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)) =\n    (\\<Union>l. SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))) &&&\n    trms\\<^sub>l\\<^sub>s\\<^sub>t A =\n    (\\<Union>l. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))", "by (metis SMP_Union, metis trms\\<^sub>l\\<^sub>s\\<^sub>t_union)"], ["proof (state)\nthis:\n  SMP (\\<Union> (range P)) = (\\<Union>l. SMP (P l))\n  Q = \\<Union> (range P)\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "hence \"GSMP Q = (\\<Union>l. GSMP (P l))\""], ["proof (prove)\nusing this:\n  SMP (\\<Union> (range P)) = (\\<Union>l. SMP (P l))\n  Q = \\<Union> (range P)\n\ngoal (1 subgoal):\n 1. GSMP Q = (\\<Union>l. GSMP (P l))", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  SMP (\\<Union> (range P)) = (\\<Union>l. SMP (P l))\n  Q = \\<Union> (range P)\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP Q. fv t = {}} = (\\<Union>l. {t \\<in> SMP (P l). fv t = {}})", "by auto"], ["proof (state)\nthis:\n  GSMP Q = (\\<Union>l. GSMP (P l))\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "thus ?thesis"], ["proof (prove)\nusing this:\n  GSMP Q = (\\<Union>l. GSMP (P l))\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "unfolding P_def Q_def"], ["proof (prove)\nusing this:\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n  (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n    (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))", "by metis"], ["proof (state)\nthis:\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n  (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma in_GSMP_in_proj: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<Longrightarrow> \\<exists>n. t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<Longrightarrow>\n    \\<exists>n. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "using GSMP_Union[of A]"], ["proof (prove)\nusing this:\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n  (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<Longrightarrow>\n    \\<exists>n. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "by blast"], ["", "lemma in_proj_in_GSMP: \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) \\<Longrightarrow> t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<Longrightarrow>\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "using GSMP_Union[of A]"], ["proof (prove)\nusing this:\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) =\n  (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)))\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<Longrightarrow>\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "by blast"], ["", "lemma GSMP_disjointE:\n  assumes A: \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) Sec\"\n  shows \"GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<inter>\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A))\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using assms"], ["proof (prove)\nusing this:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A)) Sec\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<inter>\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A))\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "unfolding GSMP_disjoint_def"], ["proof (prove)\nusing this:\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<inter>\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A))\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<inter>\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A))\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by auto"], ["", "lemma GSMP_disjoint_term:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  shows \"t \\<notin> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<or> t \\<notin> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) \\<or> t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<or>\n    t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) \\<or>\n    t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t", "using assms"], ["proof (prove)\nusing this:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<or>\n    t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) \\<or>\n    t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t", "unfolding GSMP_disjoint_def"], ["proof (prove)\nusing this:\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<or>\n    t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) \\<or>\n    t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t", "by blast"], ["", "lemma GSMP_wt_subst_subset:\n  assumes \"t \\<in> GSMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>)\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\"\n  shows \"t \\<in> GSMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> GSMP M", "using SMP_wt_subst_subset[OF _ assms(2,3), of t M] assms(1)"], ["proof (prove)\nusing this:\n  t \\<in> SMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>) \\<Longrightarrow>\n  t \\<in> SMP M\n  t \\<in> GSMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>)\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP M", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  t \\<in> SMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>) \\<Longrightarrow>\n  t \\<in> SMP M\n  t \\<in> {t \\<in> SMP (M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>). fv t = {}}\n\ngoal (1 subgoal):\n 1. t \\<in> {t \\<in> SMP M. fv t = {}}", "by simp"], ["", "lemma GSMP_wt_substI:\n  assumes \"t \\<in> M\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"t \\<cdot> I \\<in> GSMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> GSMP M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> GSMP M", "have \"t \\<in> SMP M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "using assms(1)"], ["proof (prove)\nusing this:\n  t \\<in> M\n\ngoal (1 subgoal):\n 1. t \\<in> SMP M", "by auto"], ["proof (state)\nthis:\n  t \\<in> SMP M\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> GSMP M", "hence *: \"t \\<cdot> I \\<in> SMP M\""], ["proof (prove)\nusing this:\n  t \\<in> SMP M\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> SMP M", "using SMP.Substitution assms(2,3) wf_trm_subst_range_iff[of I]"], ["proof (prove)\nusing this:\n  t \\<in> SMP M\n  \\<lbrakk>?t \\<in> SMP ?M;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range ?\\<delta>)\\<rbrakk>\n  \\<Longrightarrow> ?t \\<cdot> ?\\<delta> \\<in> SMP ?M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\n  (\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (I x)) =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> SMP M", "by simp"], ["proof (state)\nthis:\n  t \\<cdot> I \\<in> SMP M\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> GSMP M", "moreover"], ["proof (state)\nthis:\n  t \\<cdot> I \\<in> SMP M\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> GSMP M", "have \"fv (t \\<cdot> I) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv (t \\<cdot> I) = {}", "using assms(1) interpretation_grounds_all'[OF assms(4)]"], ["proof (prove)\nusing this:\n  t \\<in> M\n  ground (?M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I)\n\ngoal (1 subgoal):\n 1. fv (t \\<cdot> I) = {}", "by auto"], ["proof (state)\nthis:\n  fv (t \\<cdot> I) = {}\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> GSMP M", "ultimately"], ["proof (chain)\npicking this:\n  t \\<cdot> I \\<in> SMP M\n  fv (t \\<cdot> I) = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  t \\<cdot> I \\<in> SMP M\n  fv (t \\<cdot> I) = {}\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> GSMP M", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  t \\<cdot> I \\<in> SMP M\n  fv (t \\<cdot> I) = {}\n\ngoal (1 subgoal):\n 1. t \\<cdot> I \\<in> {t \\<in> SMP M. fv t = {}}", "by simp"], ["proof (state)\nthis:\n  t \\<cdot> I \\<in> GSMP M\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma GSMP_disjoint_subset:\n  assumes \"GSMP_disjoint L R S\" \"L' \\<subseteq> L\" \"R' \\<subseteq> R\"\n  shows \"GSMP_disjoint L' R' S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP_disjoint L' R' S", "using assms(1) SMP_mono[OF assms(2)] SMP_mono[OF assms(3)]"], ["proof (prove)\nusing this:\n  GSMP_disjoint L R S\n  SMP L' \\<subseteq> SMP L\n  SMP R' \\<subseteq> SMP R\n\ngoal (1 subgoal):\n 1. GSMP_disjoint L' R' S", "by (auto simp add: GSMP_def GSMP_disjoint_def)"], ["", "lemma GSMP_disjoint_fst_specific_not_snd_specific:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\" \"l \\<noteq> l'\"\n  and \"proj_specific l m \\<A> Sec\"\n  shows \"\\<not>proj_specific l' m \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> proj_specific l' m \\<A> Sec", "using assms"], ["proof (prove)\nusing this:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec\n  l \\<noteq> l'\n  proj_specific l m \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<not> proj_specific l' m \\<A> Sec", "by (fastforce simp add: GSMP_disjoint_def proj_specific_def)"], ["", "lemma GSMP_disjoint_snd_specific_not_fst_specific:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and \"proj_specific l' m \\<A> Sec\"\n  shows \"\\<not>proj_specific l m \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> proj_specific l m \\<A> Sec", "using assms"], ["proof (prove)\nusing this:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec\n  proj_specific l' m \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<not> proj_specific l m \\<A> Sec", "by (auto simp add: GSMP_disjoint_def proj_specific_def)"], ["", "lemma GSMP_disjoint_intersection_not_specific:\n  assumes \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and \"t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t\"\n  shows \"\\<not>proj_specific l t \\<A> Sec\" \"\\<not>proj_specific l t \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> proj_specific l t \\<A> Sec &&& \\<not> proj_specific l t \\<A> Sec", "using assms"], ["proof (prove)\nusing this:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec\n  t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t\n\ngoal (1 subgoal):\n 1. \\<not> proj_specific l t \\<A> Sec &&& \\<not> proj_specific l t \\<A> Sec", "by (auto simp add: GSMP_disjoint_def proj_specific_def)"], ["", "subsection \\<open>Lemmata: Intruder Knowledge and Declassification\\<close>"], ["", "lemma ik_proj_subst_GSMP_subset:\n  assumes I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "assume \"t \\<in> ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I\""], ["proof (state)\nthis:\n  t \\<in> ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          I\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "hence *: \"t \\<in> trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I\""], ["proof (prove)\nusing this:\n  t \\<in> ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          I\n\ngoal (1 subgoal):\n 1. t \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t\n             (proj n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n            I", "by auto"], ["proof (state)\nthis:\n  t \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t\n           (proj n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          I\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "then"], ["proof (chain)\npicking this:\n  t \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t\n           (proj n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          I", "obtain s where \"s \\<in> trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A\" \"t = s \\<cdot> I\""], ["proof (prove)\nusing this:\n  t \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t\n           (proj n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          I\n\ngoal (1 subgoal):\n 1. (\\<And>s.\n        \\<lbrakk>s \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A);\n         t = s \\<cdot> I\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  s \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)\n  t = s \\<cdot> I\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "hence \"t \\<in> SMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\nusing this:\n  s \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)\n  t = s \\<cdot> I\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "using SMP_I I(1,2) wf_trm_subst_range_iff[of I]"], ["proof (prove)\nusing this:\n  s \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)\n  t = s \\<cdot> I\n  \\<lbrakk>?s \\<in> ?M;\n   wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t ?\\<delta>;\n   ?t \\<sqsubseteq> ?s \\<cdot> ?\\<delta>;\n   \\<And>v. wf\\<^sub>t\\<^sub>r\\<^sub>m (?\\<delta> v)\\<rbrakk>\n  \\<Longrightarrow> ?t \\<in> SMP ?M\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\n  (\\<forall>x. wf\\<^sub>t\\<^sub>r\\<^sub>m (I x)) =\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\n\ngoal (1 subgoal):\n 1. t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "by simp"], ["proof (state)\nthis:\n  t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "moreover"], ["proof (state)\nthis:\n  t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "have \"fv t = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv t = {}", "using * interpretation_grounds_all'[OF I(3)]"], ["proof (prove)\nusing this:\n  t \\<in> trms\\<^sub>l\\<^sub>s\\<^sub>t\n           (proj n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          I\n  ground (?M \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I)\n\ngoal (1 subgoal):\n 1. fv t = {}", "by auto"], ["proof (state)\nthis:\n  fv t = {}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> ik\\<^sub>s\\<^sub>t\n                (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n               I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "ultimately"], ["proof (chain)\npicking this:\n  t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n  fv t = {}", "show \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\nusing this:\n  t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n  fv t = {}\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n  fv t = {}\n\ngoal (1 subgoal):\n 1. t \\<in> {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)).\n             fv t = {}}", "by simp"], ["proof (state)\nthis:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma declassified_proj_ik_subset: \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> ik\\<^sub>s\\<^sub>t\n                 (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                I", "proof (induction A)"], ["proof (state)\ngoal (2 subgoals):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t [] I\n    \\<subseteq> ik\\<^sub>s\\<^sub>t\n                 (proj_unl n []) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                I\n 2. \\<And>a A.\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n       \\<subseteq> ik\\<^sub>s\\<^sub>t\n                    (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   I \\<Longrightarrow>\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t (a # A) I\n       \\<subseteq> ik\\<^sub>s\\<^sub>t\n                    (proj_unl n (a # A)) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   I", "case (Cons a A)"], ["proof (state)\nthis:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              I\n\ngoal (2 subgoals):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t [] I\n    \\<subseteq> ik\\<^sub>s\\<^sub>t\n                 (proj_unl n []) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                I\n 2. \\<And>a A.\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n       \\<subseteq> ik\\<^sub>s\\<^sub>t\n                    (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   I \\<Longrightarrow>\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t (a # A) I\n       \\<subseteq> ik\\<^sub>s\\<^sub>t\n                    (proj_unl n (a # A)) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   I", "thus ?case"], ["proof (prove)\nusing this:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              I\n\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t (a # A) I\n    \\<subseteq> ik\\<^sub>s\\<^sub>t\n                 (proj_unl n (a # A)) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                I", "using proj_ik_append[of n \"[a]\" A]"], ["proof (prove)\nusing this:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              I\n  ik\\<^sub>s\\<^sub>t (proj_unl n ([a] @ A)) =\n  ik\\<^sub>s\\<^sub>t (proj_unl n [a]) \\<union>\n  ik\\<^sub>s\\<^sub>t (proj_unl n A)\n\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t (a # A) I\n    \\<subseteq> ik\\<^sub>s\\<^sub>t\n                 (proj_unl n (a # A)) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                I", "by (auto simp add: declassified\\<^sub>l\\<^sub>s\\<^sub>t_def)"], ["proof (state)\nthis:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t (a # A) I\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl n (a # A)) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              I\n\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t [] I\n    \\<subseteq> ik\\<^sub>s\\<^sub>t\n                 (proj_unl n []) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                I", "qed (simp add: declassified\\<^sub>l\\<^sub>s\\<^sub>t_def)"], ["", "lemma declassified_proj_GSMP_subset:\n  assumes I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "by (rule subset_trans[OF declassified_proj_ik_subset ik_proj_subst_GSMP_subset[OF I]])"], ["", "lemma declassified_subterms_proj_GSMP_subset:\n  assumes I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I) \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "fix t"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "assume t: \"t \\<in> subterms\\<^sub>s\\<^sub>e\\<^sub>t (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\""], ["proof (state)\nthis:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "then"], ["proof (chain)\npicking this:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A I", "obtain t' where t': \"t' \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\" \"t \\<sqsubseteq> t'\""], ["proof (prove)\nusing this:\n  t \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n\ngoal (1 subgoal):\n 1. (\\<And>t'.\n        \\<lbrakk>t' \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A I;\n         t \\<sqsubseteq> t'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t' \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n  t \\<sqsubseteq> t'\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "hence \"t' \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\nusing this:\n  t' \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n  t \\<sqsubseteq> t'\n\ngoal (1 subgoal):\n 1. t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "using declassified_proj_GSMP_subset[OF assms]"], ["proof (prove)\nusing this:\n  t' \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n  t \\<sqsubseteq> t'\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A I\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n ?A))\n\ngoal (1 subgoal):\n 1. t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "by blast"], ["proof (state)\nthis:\n  t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<Longrightarrow>\n       x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "thus \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A)\""], ["proof (prove)\nusing this:\n  t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "using SMP.Subterm[of t' \"trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A\" t] ground_subterm[OF _ t'(2)] t'(2)"], ["proof (prove)\nusing this:\n  t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n  \\<lbrakk>t' \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A));\n   t \\<sqsubseteq> t'\\<rbrakk>\n  \\<Longrightarrow> t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n  fv t' = {} \\<Longrightarrow> fv t = {}\n  t \\<sqsubseteq> t'\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  t' \\<in> {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)).\n            fv t = {}}\n  \\<lbrakk>t' \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A));\n   t \\<sqsubseteq> t'\\<rbrakk>\n  \\<Longrightarrow> t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n  fv t' = {} \\<Longrightarrow> fv t = {}\n  t \\<sqsubseteq> t'\n\ngoal (1 subgoal):\n 1. t \\<in> {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)).\n             fv t = {}}", "by fast"], ["proof (state)\nthis:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma declassified_secrets_subset:\n  assumes A: \"\\<forall>n m. n \\<noteq> m \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) Sec\"\n  and I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using declassified_proj_GSMP_subset[OF I] A at_least_2_labels"], ["proof (prove)\nusing this:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A I\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n ?A))\n  \\<forall>n m.\n     n \\<noteq> m \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A)) Sec\n  label_witness1 \\<noteq> label_witness2\n\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "unfolding GSMP_disjoint_def"], ["proof (prove)\nusing this:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A I\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n ?A))\n  \\<forall>n m.\n     n \\<noteq> m \\<longrightarrow>\n     GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<inter>\n     GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A))\n     \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  label_witness1 \\<noteq> label_witness2\n\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by blast"], ["", "lemma declassified_subterms_secrets_subset:\n  assumes A: \"\\<forall>n m. n \\<noteq> m \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t m A) Sec\"\n  and I: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range I)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t I\"\n  shows \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I) \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using declassified_subterms_proj_GSMP_subset[OF I, of A label_witness1]\n      declassified_subterms_proj_GSMP_subset[OF I, of A label_witness2]\n      A at_least_2_labels"], ["proof (prove)\nusing this:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj label_witness1 A))\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj label_witness2 A))\n  \\<forall>n m.\n     n \\<noteq> m \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A)) Sec\n  label_witness1 \\<noteq> label_witness2\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "unfolding GSMP_disjoint_def"], ["proof (prove)\nusing this:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj label_witness1 A))\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj label_witness2 A))\n  \\<forall>n m.\n     n \\<noteq> m \\<longrightarrow>\n     GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A)) \\<inter>\n     GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj m A))\n     \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  label_witness1 \\<noteq> label_witness2\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (declassified\\<^sub>l\\<^sub>s\\<^sub>t A I)\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by fast"], ["", "lemma declassified_proj_eq: \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A I = declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n    declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I", "unfolding declassified\\<^sub>l\\<^sub>s\\<^sub>t_def proj_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {t. (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n        \\<in> set A} \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    I =\n    {t. (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n        \\<in> set (filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s)\n                    A)} \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    I", "by auto"], ["", "lemma declassified_append: \"declassified\\<^sub>l\\<^sub>s\\<^sub>t (A@B) I = declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<union> declassified\\<^sub>l\\<^sub>s\\<^sub>t B I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. declassified\\<^sub>l\\<^sub>s\\<^sub>t (A @ B) I =\n    declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<union>\n    declassified\\<^sub>l\\<^sub>s\\<^sub>t B I", "unfolding declassified\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {t. (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n        \\<in> set (A @ B)} \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    I =\n    ({t. (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n         \\<in> set A} \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n     I) \\<union>\n    ({t. (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n         \\<in> set B} \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n     I)", "by auto"], ["", "lemma declassified_prefix_subset: \"prefix A B \\<Longrightarrow> declassified\\<^sub>l\\<^sub>s\\<^sub>t A I \\<subseteq> declassified\\<^sub>l\\<^sub>s\\<^sub>t B I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prefix A B \\<Longrightarrow>\n    declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> declassified\\<^sub>l\\<^sub>s\\<^sub>t B I", "using declassified_append"], ["proof (prove)\nusing this:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t (?A @ ?B) ?I =\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A ?I \\<union>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t ?B ?I\n\ngoal (1 subgoal):\n 1. prefix A B \\<Longrightarrow>\n    declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> declassified\\<^sub>l\\<^sub>s\\<^sub>t B I", "unfolding prefix_def"], ["proof (prove)\nusing this:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t (?A @ ?B) ?I =\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A ?I \\<union>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t ?B ?I\n\ngoal (1 subgoal):\n 1. \\<exists>zs. B = A @ zs \\<Longrightarrow>\n    declassified\\<^sub>l\\<^sub>s\\<^sub>t A I\n    \\<subseteq> declassified\\<^sub>l\\<^sub>s\\<^sub>t B I", "by auto"], ["", "subsection \\<open>Lemmata: Homogeneous and Heterogeneous Terms\\<close>"], ["", "lemma proj_specific_secrets_anti_mono:\n  assumes \"proj_specific l t \\<A> Sec\" \"Sec' \\<subseteq> Sec\"\n  shows \"proj_specific l t \\<A> Sec'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. proj_specific l t \\<A> Sec'", "using assms"], ["proof (prove)\nusing this:\n  proj_specific l t \\<A> Sec\n  Sec' \\<subseteq> Sec\n\ngoal (1 subgoal):\n 1. proj_specific l t \\<A> Sec'", "unfolding proj_specific_def"], ["proof (prove)\nusing this:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) -\n          (Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m})\n  Sec' \\<subseteq> Sec\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) -\n            (Sec' \\<union> {m. {} \\<turnstile>\\<^sub>c m})", "by fast"], ["", "lemma heterogeneous_secrets_anti_mono:\n  assumes \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"Sec' \\<subseteq> Sec\"\n  shows \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec'", "using assms proj_specific_secrets_anti_mono"], ["proof (prove)\nusing this:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  Sec' \\<subseteq> Sec\n  \\<lbrakk>proj_specific ?l ?t ?\\<A> ?Sec; ?Sec' \\<subseteq> ?Sec\\<rbrakk>\n  \\<Longrightarrow> proj_specific ?l ?t ?\\<A> ?Sec'\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec'", "unfolding heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<exists>l1 l2.\n     \\<exists>s1\\<in>subterms t.\n        \\<exists>s2\\<in>subterms t.\n           l1 \\<noteq> l2 \\<and>\n           proj_specific l1 s1 \\<A> Sec \\<and> proj_specific l2 s2 \\<A> Sec\n  Sec' \\<subseteq> Sec\n  \\<lbrakk>proj_specific ?l ?t ?\\<A> ?Sec; ?Sec' \\<subseteq> ?Sec\\<rbrakk>\n  \\<Longrightarrow> proj_specific ?l ?t ?\\<A> ?Sec'\n\ngoal (1 subgoal):\n 1. \\<exists>l1 l2.\n       \\<exists>s1\\<in>subterms t.\n          \\<exists>s2\\<in>subterms t.\n             l1 \\<noteq> l2 \\<and>\n             proj_specific l1 s1 \\<A> Sec' \\<and>\n             proj_specific l2 s2 \\<A> Sec'", "by metis"], ["", "lemma homogeneous_secrets_mono:\n  assumes \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec'\" \"Sec' \\<subseteq> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "using assms heterogeneous_secrets_anti_mono"], ["proof (prove)\nusing this:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec'\n  Sec' \\<subseteq> Sec\n  \\<lbrakk>heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t ?\\<A> ?Sec;\n   ?Sec' \\<subseteq> ?Sec\\<rbrakk>\n  \\<Longrightarrow> heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t ?\\<A> ?Sec'\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "by blast"], ["", "lemma heterogeneous_supterm:\n  assumes \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"t \\<sqsubseteq> t'\"\n  shows \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec", "obtain l1 l2 s1 s2 where *:\n      \"l1 \\<noteq> l2\"\n      \"s1 \\<sqsubseteq> t\" \"proj_specific l1 s1 \\<A> Sec\"\n      \"s2 \\<sqsubseteq> t\" \"proj_specific l2 s2 \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>l1 l2 s1 s2.\n        \\<lbrakk>l1 \\<noteq> l2; s1 \\<sqsubseteq> t;\n         proj_specific l1 s1 \\<A> Sec; s2 \\<sqsubseteq> t;\n         proj_specific l2 s2 \\<A> Sec\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(1)"], ["proof (prove)\nusing this:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n\ngoal (1 subgoal):\n 1. (\\<And>l1 l2 s1 s2.\n        \\<lbrakk>l1 \\<noteq> l2; s1 \\<sqsubseteq> t;\n         proj_specific l1 s1 \\<A> Sec; s2 \\<sqsubseteq> t;\n         proj_specific l2 s2 \\<A> Sec\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<exists>l1 l2.\n     \\<exists>s1\\<in>subterms t.\n        \\<exists>s2\\<in>subterms t.\n           l1 \\<noteq> l2 \\<and>\n           proj_specific l1 s1 \\<A> Sec \\<and> proj_specific l2 s2 \\<A> Sec\n\ngoal (1 subgoal):\n 1. (\\<And>l1 l2 s1 s2.\n        \\<lbrakk>l1 \\<noteq> l2; s1 \\<sqsubseteq> t;\n         proj_specific l1 s1 \\<A> Sec; s2 \\<sqsubseteq> t;\n         proj_specific l2 s2 \\<A> Sec\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  l1 \\<noteq> l2\n  s1 \\<sqsubseteq> t\n  proj_specific l1 s1 \\<A> Sec\n  s2 \\<sqsubseteq> t\n  proj_specific l2 s2 \\<A> Sec\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec", "thus ?thesis"], ["proof (prove)\nusing this:\n  l1 \\<noteq> l2\n  s1 \\<sqsubseteq> t\n  proj_specific l1 s1 \\<A> Sec\n  s2 \\<sqsubseteq> t\n  proj_specific l2 s2 \\<A> Sec\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec", "using term.order_trans[OF *(2) assms(2)] term.order_trans[OF *(4) assms(2)]"], ["proof (prove)\nusing this:\n  l1 \\<noteq> l2\n  s1 \\<sqsubseteq> t\n  proj_specific l1 s1 \\<A> Sec\n  s2 \\<sqsubseteq> t\n  proj_specific l2 s2 \\<A> Sec\n  s1 \\<sqsubseteq> t'\n  s2 \\<sqsubseteq> t'\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec", "by (auto simp add: heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def)"], ["proof (state)\nthis:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma homogeneous_subterm:\n  assumes \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"t' \\<sqsubseteq> t\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec", "by (metis assms heterogeneous_supterm)"], ["", "lemma proj_specific_subterm:\n  assumes \"t \\<sqsubseteq> t'\" \"proj_specific l t' \\<A> Sec\"\n  shows \"proj_specific l t \\<A> Sec \\<or> t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. proj_specific l t \\<A> Sec \\<or>\n    t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t", "using GSMP_subterm[OF _ assms(1)] assms(2)"], ["proof (prove)\nusing this:\n  t' \\<in> GSMP ?M \\<Longrightarrow> t \\<in> GSMP ?M\n  proj_specific l t' \\<A> Sec\n\ngoal (1 subgoal):\n 1. proj_specific l t \\<A> Sec \\<or>\n    t \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c t", "by (auto simp add: proj_specific_def)"], ["", "lemma heterogeneous_term_is_Fun:\n  assumes \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A S\" shows \"\\<exists>f T. t = Fun f T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>f T. t = Fun f T", "using assms"], ["proof (prove)\nusing this:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A S\n\ngoal (1 subgoal):\n 1. \\<exists>f T. t = Fun f T", "by (cases t) (auto simp add: GSMP_def heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def proj_specific_def)"], ["", "lemma proj_specific_is_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"proj_specific l m \\<A> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<Longrightarrow> False", "assume \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\""], ["proof (state)\nthis:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec", "obtain s l' where s: \"s \\<in> subterms m\" \"proj_specific l' s \\<A> Sec\" \"l \\<noteq> l'\""], ["proof (prove)\nusing this:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n\ngoal (1 subgoal):\n 1. (\\<And>s l'.\n        \\<lbrakk>s \\<sqsubseteq> m; proj_specific l' s \\<A> Sec;\n         l \\<noteq> l'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<exists>l1 l2.\n     \\<exists>s1\\<in>subterms m.\n        \\<exists>s2\\<in>subterms m.\n           l1 \\<noteq> l2 \\<and>\n           proj_specific l1 s1 \\<A> Sec \\<and> proj_specific l2 s2 \\<A> Sec\n\ngoal (1 subgoal):\n 1. (\\<And>s l'.\n        \\<lbrakk>s \\<sqsubseteq> m; proj_specific l' s \\<A> Sec;\n         l \\<noteq> l'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  s \\<sqsubseteq> m\n  proj_specific l' s \\<A> Sec\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<Longrightarrow> False", "hence \"s \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\" \"s \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>)\""], ["proof (prove)\nusing this:\n  s \\<sqsubseteq> m\n  proj_specific l' s \\<A> Sec\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) &&&\n    s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))", "using t"], ["proof (prove)\nusing this:\n  s \\<sqsubseteq> m\n  proj_specific l' s \\<A> Sec\n  l \\<noteq> l'\n  proj_specific l m \\<A> Sec\n\ngoal (1 subgoal):\n 1. s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) &&&\n    s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))", "by (auto simp add: GSMP_def proj_specific_def)"], ["proof (state)\nthis:\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<Longrightarrow> False", "hence \"s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\""], ["proof (prove)\nusing this:\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n\ngoal (1 subgoal):\n 1. s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s", "using \\<A> s(3)"], ["proof (prove)\nusing this:\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n  \\<forall>l l'.\n     l \\<noteq> l' \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s", "by (auto simp add: GSMP_disjoint_def)"], ["proof (state)\nthis:\n  s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<Longrightarrow> False", "thus False"], ["proof (prove)\nusing this:\n  s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\n\ngoal (1 subgoal):\n 1. False", "using s(2)"], ["proof (prove)\nusing this:\n  s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\n  proj_specific l' s \\<A> Sec\n\ngoal (1 subgoal):\n 1. False", "by (auto simp add: proj_specific_def)"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma deduct_synth_homogeneous:\n  assumes \"{} \\<turnstile>\\<^sub>c t\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "have \"\\<forall>s \\<in> subterms t. {} \\<turnstile>\\<^sub>c s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s\\<in>subterms t. {} \\<turnstile>\\<^sub>c s", "using deduct_synth_subterm[OF assms]"], ["proof (prove)\nusing this:\n  \\<lbrakk>?s \\<sqsubseteq> t;\n   \\<forall>m\\<in>{}.\n      \\<forall>s\\<in>subterms m. {} \\<turnstile>\\<^sub>c s\\<rbrakk>\n  \\<Longrightarrow> {} \\<turnstile>\\<^sub>c ?s\n\ngoal (1 subgoal):\n 1. \\<forall>s\\<in>subterms t. {} \\<turnstile>\\<^sub>c s", "by auto"], ["proof (state)\nthis:\n  \\<forall>s\\<in>subterms t. {} \\<turnstile>\\<^sub>c s\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>s\\<in>subterms t. {} \\<turnstile>\\<^sub>c s\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "unfolding heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def proj_specific_def"], ["proof (prove)\nusing this:\n  \\<forall>s\\<in>subterms t. {} \\<turnstile>\\<^sub>c s\n\ngoal (1 subgoal):\n 1. \\<nexists>l1 l2.\n       \\<exists>s1\\<in>subterms t.\n          \\<exists>s2\\<in>subterms t.\n             l1 \\<noteq> l2 \\<and>\n             s1 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) -\n                      (Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}) \\<and>\n             s2 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) -\n                      (Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m})", "by auto"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma GSMP_proj_is_homogeneous:\n  assumes \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' A) Sec\"\n  and \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A)\" \"t \\<notin> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<Longrightarrow> False", "assume \"heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec\""], ["proof (state)\nthis:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec", "obtain s l' where s: \"s \\<in> subterms t\" \"proj_specific l' s A Sec\" \"l \\<noteq> l'\""], ["proof (prove)\nusing this:\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec\n\ngoal (1 subgoal):\n 1. (\\<And>s l'.\n        \\<lbrakk>s \\<sqsubseteq> t; proj_specific l' s A Sec;\n         l \\<noteq> l'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<exists>l1 l2.\n     \\<exists>s1\\<in>subterms t.\n        \\<exists>s2\\<in>subterms t.\n           l1 \\<noteq> l2 \\<and>\n           proj_specific l1 s1 A Sec \\<and> proj_specific l2 s2 A Sec\n\ngoal (1 subgoal):\n 1. (\\<And>s l'.\n        \\<lbrakk>s \\<sqsubseteq> t; proj_specific l' s A Sec;\n         l \\<noteq> l'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  s \\<sqsubseteq> t\n  proj_specific l' s A Sec\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<Longrightarrow> False", "hence \"s \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A)\" \"s \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' A)\""], ["proof (prove)\nusing this:\n  s \\<sqsubseteq> t\n  proj_specific l' s A Sec\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)) &&&\n    s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' A))", "using assms"], ["proof (prove)\nusing this:\n  s \\<sqsubseteq> t\n  proj_specific l' s A Sec\n  l \\<noteq> l'\n  \\<forall>l l'.\n     l \\<noteq> l' \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' A)) Sec\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))\n  t \\<notin> Sec\n\ngoal (1 subgoal):\n 1. s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A)) &&&\n    s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' A))", "by (auto simp add: GSMP_def proj_specific_def)"], ["proof (state)\nthis:\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' A))\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<Longrightarrow> False", "hence \"s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\""], ["proof (prove)\nusing this:\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' A))\n\ngoal (1 subgoal):\n 1. s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s", "using assms(1) s(3)"], ["proof (prove)\nusing this:\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' A))\n  \\<forall>l l'.\n     l \\<noteq> l' \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' A)) Sec\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s", "by (auto simp add: GSMP_disjoint_def)"], ["proof (state)\nthis:\n  s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\n\ngoal (1 subgoal):\n 1. heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<Longrightarrow> False", "thus False"], ["proof (prove)\nusing this:\n  s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\n\ngoal (1 subgoal):\n 1. False", "using s(2)"], ["proof (prove)\nusing this:\n  s \\<in> Sec \\<or> {} \\<turnstile>\\<^sub>c s\n  proj_specific l' s A Sec\n\ngoal (1 subgoal):\n 1. False", "by (auto simp add: proj_specific_def)"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma homogeneous_is_not_proj_specific:\n  assumes \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\"\n  shows \"\\<exists>l::'lbl. \\<not>proj_specific l m \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>l. \\<not> proj_specific l m \\<A> Sec", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>l. \\<not> proj_specific l m \\<A> Sec", "let ?P = \"\\<lambda>l s. proj_specific l s \\<A> Sec\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>l. \\<not> proj_specific l m \\<A> Sec", "have \"\\<forall>l1 l2. \\<forall>s1\\<in>subterms m. \\<forall>s2\\<in>subterms m. (l1 \\<noteq> l2 \\<longrightarrow> (\\<not>?P l1 s1 \\<or> \\<not>?P l2 s2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       \\<forall>s1\\<in>subterms m.\n          \\<forall>s2\\<in>subterms m.\n             l1 \\<noteq> l2 \\<longrightarrow>\n             \\<not> proj_specific l1 s1 \\<A> Sec \\<or>\n             \\<not> proj_specific l2 s2 \\<A> Sec", "using assms heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t ?\\<A> ?Secrets \\<equiv>\n  \\<exists>l1 l2.\n     \\<exists>s1\\<in>subterms ?t.\n        \\<exists>s2\\<in>subterms ?t.\n           l1 \\<noteq> l2 \\<and>\n           proj_specific l1 s1 ?\\<A> ?Secrets \\<and>\n           proj_specific l2 s2 ?\\<A> ?Secrets\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       \\<forall>s1\\<in>subterms m.\n          \\<forall>s2\\<in>subterms m.\n             l1 \\<noteq> l2 \\<longrightarrow>\n             \\<not> proj_specific l1 s1 \\<A> Sec \\<or>\n             \\<not> proj_specific l2 s2 \\<A> Sec", "by metis"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     \\<forall>s1\\<in>subterms m.\n        \\<forall>s2\\<in>subterms m.\n           l1 \\<noteq> l2 \\<longrightarrow>\n           \\<not> proj_specific l1 s1 \\<A> Sec \\<or>\n           \\<not> proj_specific l2 s2 \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<exists>l. \\<not> proj_specific l m \\<A> Sec", "then"], ["proof (chain)\npicking this:\n  \\<forall>l1 l2.\n     \\<forall>s1\\<in>subterms m.\n        \\<forall>s2\\<in>subterms m.\n           l1 \\<noteq> l2 \\<longrightarrow>\n           \\<not> proj_specific l1 s1 \\<A> Sec \\<or>\n           \\<not> proj_specific l2 s2 \\<A> Sec", "obtain l1 l2 where \"l1 \\<noteq> l2\" \"\\<not>?P l1 m \\<or> \\<not>?P l2 m\""], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     \\<forall>s1\\<in>subterms m.\n        \\<forall>s2\\<in>subterms m.\n           l1 \\<noteq> l2 \\<longrightarrow>\n           \\<not> proj_specific l1 s1 \\<A> Sec \\<or>\n           \\<not> proj_specific l2 s2 \\<A> Sec\n\ngoal (1 subgoal):\n 1. (\\<And>l1 l2.\n        \\<lbrakk>l1 \\<noteq> l2;\n         \\<not> proj_specific l1 m \\<A> Sec \\<or>\n         \\<not> proj_specific l2 m \\<A> Sec\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis term.order_refl at_least_2_labels)"], ["proof (state)\nthis:\n  l1 \\<noteq> l2\n  \\<not> proj_specific l1 m \\<A> Sec \\<or>\n  \\<not> proj_specific l2 m \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<exists>l. \\<not> proj_specific l m \\<A> Sec", "thus ?thesis"], ["proof (prove)\nusing this:\n  l1 \\<noteq> l2\n  \\<not> proj_specific l1 m \\<A> Sec \\<or>\n  \\<not> proj_specific l2 m \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<exists>l. \\<not> proj_specific l m \\<A> Sec", "by metis"], ["proof (state)\nthis:\n  \\<exists>l. \\<not> proj_specific l m \\<A> Sec\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma secrets_are_homogeneous:\n  assumes \"\\<forall>s \\<in> Sec. P s \\<longrightarrow> (\\<forall>s' \\<in> subterms s. {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec)\" \"s \\<in> Sec\" \"P s\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>s\\<in>Sec.\n     P s \\<longrightarrow>\n     (\\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec)\n  s \\<in> Sec\n  P s\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "by (auto simp add: heterogeneous\\<^sub>l\\<^sub>s\\<^sub>t_def proj_specific_def)"], ["", "lemma GSMP_is_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\" \"t \\<notin> Sec\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "obtain n where n: \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n.\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj n \\<A>)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using in_GSMP_in_proj[OF t(1)]"], ["proof (prove)\nusing this:\n  \\<exists>n. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n\ngoal (1 subgoal):\n 1. (\\<And>n.\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj n \\<A>)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "using GSMP_proj_is_homogeneous[OF \\<A> n t(2)]"], ["proof (prove)\nusing this:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "by metis"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma GSMP_intersection_is_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n    and t: \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>)\" \"l \\<noteq> l'\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "define M where \"M \\<equiv> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (state)\nthis:\n  M \\<equiv> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "define M' where \"M' \\<equiv> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>)\""], ["proof (state)\nthis:\n  M' \\<equiv> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "have t_in: \"t \\<in> M \\<inter> M'\" \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> M \\<inter> M' &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using t(1) in_proj_in_GSMP[of t _ \\<A>]"], ["proof (prove)\nusing this:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n          GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n  t \\<in> GSMP\n           (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n \\<A>)) \\<Longrightarrow>\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. t \\<in> M \\<inter> M' &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "unfolding M_def M'_def"], ["proof (prove)\nusing this:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n          GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n  t \\<in> GSMP\n           (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n \\<A>)) \\<Longrightarrow>\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n            GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by blast+"], ["proof (state)\nthis:\n  t \\<in> M \\<inter> M'\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "have \"M \\<inter> M' \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M \\<inter> M' \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using \\<A> GSMP_disjointE[of l \\<A> l' Sec] t(2)"], ["proof (prove)\nusing this:\n  \\<forall>l l'.\n     l \\<noteq> l' \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec \\<Longrightarrow>\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. M \\<inter> M' \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "unfolding M_def M'_def"], ["proof (prove)\nusing this:\n  \\<forall>l l'.\n     l \\<noteq> l' \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec \\<Longrightarrow>\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  l \\<noteq> l'\n\ngoal (1 subgoal):\n 1. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by presburger"], ["proof (state)\nthis:\n  M \\<inter> M' \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "moreover"], ["proof (state)\nthis:\n  M \\<inter> M' \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "have \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M') = M \\<inter> M'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M') = M \\<inter> M'", "using GSMP_subterms"], ["proof (prove)\nusing this:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t (GSMP ?M) = GSMP ?M\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M') = M \\<inter> M'", "unfolding M_def M'_def"], ["proof (prove)\nusing this:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t (GSMP ?M) = GSMP ?M\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n      GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) =\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<inter>\n    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))", "by blast"], ["proof (state)\nthis:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M') = M \\<inter> M'\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "ultimately"], ["proof (chain)\npicking this:\n  M \\<inter> M' \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M') = M \\<inter> M'", "have *: \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M') \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\nusing this:\n  M \\<inter> M' \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M') = M \\<inter> M'\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M')\n    \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by blast"], ["proof (state)\nthis:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M')\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "proof (cases \"t \\<in> Sec\")"], ["proof (state)\ngoal (2 subgoals):\n 1. t \\<in> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n 2. t \\<notin> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "case True"], ["proof (state)\nthis:\n  t \\<in> Sec\n\ngoal (2 subgoals):\n 1. t \\<in> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n 2. t \\<notin> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "thus ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "using * secrets_are_homogeneous[of Sec \"\\<lambda>t. t \\<in> M \\<inter> M'\", OF _ _ t_in(1)]"], ["proof (prove)\nusing this:\n  t \\<in> Sec\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t (M \\<inter> M')\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  \\<lbrakk>\\<forall>s\\<in>Sec.\n              s \\<in> M \\<inter> M' \\<longrightarrow>\n              (\\<forall>s'\\<in>subterms s.\n                  {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec);\n   t \\<in> Sec\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t ?\\<A> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "by fast"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n\ngoal (1 subgoal):\n 1. t \\<notin> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "qed (metis GSMP_is_homogeneous[OF \\<A> t_in(2)])"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma GSMP_is_homogeneous':\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n         \"t \\<notin> Sec - \\<Union>{GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) | l1 l2. l1 \\<noteq> l2}\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "using GSMP_is_homogeneous[OF \\<A> t(1)] GSMP_intersection_is_homogeneous[OF \\<A>] t(2)"], ["proof (prove)\nusing this:\n  t \\<notin> Sec \\<Longrightarrow>\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  \\<lbrakk>?t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l \\<A>)) \\<inter>\n                    GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l' \\<A>));\n   ?l \\<noteq> ?l'\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t \\<A> Sec\n  t \\<notin> Sec -\n             \\<Union>\n              {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n               GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n               l1 l2. l1 \\<noteq> l2}\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "by blast"], ["", "lemma declassified_secrets_are_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n    and \\<I>: \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\"\n    and s: \"s \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "have s_in: \"s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using declassified_proj_GSMP_subset[OF \\<I>, of \\<A> label_witness1]\n          in_proj_in_GSMP[of s label_witness1 \\<A>] s"], ["proof (prove)\nusing this:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj label_witness1 \\<A>))\n  s \\<in> GSMP\n           (trms\\<^sub>l\\<^sub>s\\<^sub>t\n             (proj label_witness1 \\<A>)) \\<Longrightarrow>\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  s \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\n\ngoal (1 subgoal):\n 1. s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by blast"], ["proof (state)\nthis:\n  s \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "proof (cases \"s \\<in> Sec\")"], ["proof (state)\ngoal (2 subgoals):\n 1. s \\<in> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\n 2. s \\<notin> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "case True"], ["proof (state)\nthis:\n  s \\<in> Sec\n\ngoal (2 subgoals):\n 1. s \\<in> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\n 2. s \\<notin> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "thus ?thesis"], ["proof (prove)\nusing this:\n  s \\<in> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "using declassified_subterms_secrets_subset[OF \\<A> \\<I>]\n            secrets_are_homogeneous[of Sec \"\\<lambda>s. s \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\", OF _ _ s]"], ["proof (prove)\nusing this:\n  s \\<in> Sec\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>)\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  \\<lbrakk>\\<forall>s\\<in>Sec.\n              s \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n                       \\<I> \\<longrightarrow>\n              (\\<forall>s'\\<in>subterms s.\n                  {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec);\n   s \\<in> Sec\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s ?\\<A> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "by fast"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\n\ngoal (1 subgoal):\n 1. s \\<notin> Sec \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec", "qed (metis GSMP_is_homogeneous[OF \\<A> s_in])"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t s \\<A> Sec\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Ana_keys_homogeneous:\n  assumes \\<A>: \"\\<forall>l l'. l \\<noteq> l' \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>) Sec\"\n  and t: \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  and k: \"Ana t = (K,T)\" \"k \\<in> set K\"\n         \"k \\<notin> Sec - \\<Union>{GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) | l1 l2. l1 \\<noteq> l2}\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "proof (cases \"k \\<in> \\<Union>{GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) | l1 l2. l1 \\<noteq> l2}\")"], ["proof (state)\ngoal (2 subgoals):\n 1. k \\<in> \\<Union>\n             {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n              GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n              l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\n 2. k \\<notin> \\<Union>\n                {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n                 GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n                 l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "case False"], ["proof (state)\nthis:\n  k \\<notin> \\<Union>\n              {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n               GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n               l1 l2. l1 \\<noteq> l2}\n\ngoal (2 subgoals):\n 1. k \\<in> \\<Union>\n             {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n              GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n              l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\n 2. k \\<notin> \\<Union>\n                {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n                 GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n                 l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "hence \"k \\<notin> Sec\""], ["proof (prove)\nusing this:\n  k \\<notin> \\<Union>\n              {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n               GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n               l1 l2. l1 \\<noteq> l2}\n\ngoal (1 subgoal):\n 1. k \\<notin> Sec", "using k(3)"], ["proof (prove)\nusing this:\n  k \\<notin> \\<Union>\n              {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n               GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n               l1 l2. l1 \\<noteq> l2}\n  k \\<notin> Sec -\n             \\<Union>\n              {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n               GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n               l1 l2. l1 \\<noteq> l2}\n\ngoal (1 subgoal):\n 1. k \\<notin> Sec", "by fast"], ["proof (state)\nthis:\n  k \\<notin> Sec\n\ngoal (2 subgoals):\n 1. k \\<in> \\<Union>\n             {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n              GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n              l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\n 2. k \\<notin> \\<Union>\n                {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n                 GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n                 l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "moreover"], ["proof (state)\nthis:\n  k \\<notin> Sec\n\ngoal (2 subgoals):\n 1. k \\<in> \\<Union>\n             {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n              GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n              l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\n 2. k \\<notin> \\<Union>\n                {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n                 GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n                 l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "have \"k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using t SMP.Ana[OF _ k(1,2)] Ana_keys_fv[OF k(1)] k(2)"], ["proof (prove)\nusing this:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  t \\<in> SMP ?M \\<Longrightarrow> k \\<in> SMP ?M\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set K) \\<subseteq> fv t\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  t \\<in> {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>). fv t = {}}\n  t \\<in> SMP ?M \\<Longrightarrow> k \\<in> SMP ?M\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set K) \\<subseteq> fv t\n  k \\<in> set K\n\ngoal (1 subgoal):\n 1. k \\<in> {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>). fv t = {}}", "by auto"], ["proof (state)\nthis:\n  k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (2 subgoals):\n 1. k \\<in> \\<Union>\n             {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n              GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n              l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\n 2. k \\<notin> \\<Union>\n                {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n                 GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n                 l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "ultimately"], ["proof (chain)\npicking this:\n  k \\<notin> Sec\n  k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "show ?thesis"], ["proof (prove)\nusing this:\n  k \\<notin> Sec\n  k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "using GSMP_is_homogeneous[OF \\<A>, of k]"], ["proof (prove)\nusing this:\n  k \\<notin> Sec\n  k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  \\<lbrakk>k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   k \\<notin> Sec\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "by metis"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec\n\ngoal (1 subgoal):\n 1. k \\<in> \\<Union>\n             {GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n              GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) |\n              l1 l2. l1 \\<noteq> l2} \\<Longrightarrow>\n    homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec", "qed (use GSMP_intersection_is_homogeneous[OF \\<A>] in blast)"], ["", "subsection \\<open>Lemmata: Intruder Deduction Equivalences\\<close>"], ["", "lemma deduct_if_hom_deduct: \"\\<langle>M;A;S\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m \\<Longrightarrow> M \\<turnstile> m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;A;S\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m \\<Longrightarrow>\n    M \\<turnstile> m", "using deduct_if_restricted_deduct"], ["proof (prove)\nusing this:\n  \\<langle>?M;?P\\<rangle> \\<turnstile>\\<^sub>r ?m \\<Longrightarrow>\n  ?M \\<turnstile> ?m\n\ngoal (1 subgoal):\n 1. \\<langle>M;A;S\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m \\<Longrightarrow>\n    M \\<turnstile> m", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<langle>?M;?P\\<rangle> \\<turnstile>\\<^sub>r ?m \\<Longrightarrow>\n  ?M \\<turnstile> ?m\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<lambda>t.\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A S \\<and>\n                  t \\<in> GSMP\n                           (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                             A)\\<rangle> \\<turnstile>\\<^sub>r m \\<Longrightarrow>\n    M \\<turnstile> m", "by blast"], ["", "lemma hom_deduct_if_hom_ik:\n  assumes \"\\<langle>M;A;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\" \"\\<forall>m \\<in> M. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\"\n  shows \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "let ?Q = \"\\<lambda>m. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\""], ["proof (state)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "have \"?Q t'\" when \"?Q t\" \"t' \\<sqsubseteq> t\" for t t'"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' A Sec \\<and>\n    t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "using homogeneous_subterm[OF _ that(2)] GSMP_subterm[OF _ that(2)] that(1)"], ["proof (prove)\nusing this:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t ?\\<A> ?Sec \\<Longrightarrow>\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' ?\\<A> ?Sec\n  t \\<in> GSMP ?M \\<Longrightarrow> t' \\<in> GSMP ?M\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<and>\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' A Sec \\<and>\n    t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "by blast"], ["proof (state)\nthis:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 A Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 A Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 A Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 A Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "using assms(1) restricted_deduct_if_restricted_ik[OF _ assms(2)]"], ["proof (prove)\nusing this:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 A Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 A Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n  \\<langle>M;A;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\n  \\<lbrakk>\\<langle>M;\\<lambda>m.\n                         homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n                         m \\<in> GSMP\n                                  (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                    A)\\<rangle> \\<turnstile>\\<^sub>r ?m;\n   \\<forall>t t'.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<and>\n      t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<longrightarrow>\n      t' \\<sqsubseteq> t \\<longrightarrow>\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' A Sec \\<and>\n      t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?m A Sec \\<and>\n                    ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 A Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 A Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n  \\<langle>M;\\<lambda>t.\n                homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<and>\n                t \\<in> GSMP\n                         (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                           A)\\<rangle> \\<turnstile>\\<^sub>r m\n  \\<lbrakk>\\<langle>M;\\<lambda>m.\n                         homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n                         m \\<in> GSMP\n                                  (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                    A)\\<rangle> \\<turnstile>\\<^sub>r ?m;\n   \\<forall>t t'.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t A Sec \\<and>\n      t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A) \\<longrightarrow>\n      t' \\<sqsubseteq> t \\<longrightarrow>\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' A Sec \\<and>\n      t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?m A Sec \\<and>\n                    ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)", "by blast"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m A Sec \\<and>\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t A)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma deduct_hom_if_synth:\n  assumes hom: \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\" \"m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  and m: \"M \\<turnstile>\\<^sub>c m\"\n  shows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "let ?Q = \"\\<lambda>m. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "have \"?Q t'\" when \"?Q t\" \"t' \\<sqsubseteq> t\" for t t'"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n    t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using homogeneous_subterm[OF _ that(2)] GSMP_subterm[OF _ that(2)] that(1)"], ["proof (prove)\nusing this:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t ?\\<A> ?Sec \\<Longrightarrow>\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' ?\\<A> ?Sec\n  t \\<in> GSMP ?M \\<Longrightarrow> t' \\<in> GSMP ?M\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n    t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by blast"], ["proof (state)\nthis:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 \\<A> Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 \\<A> Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "using assms deduct_restricted_if_synth[of ?Q]"], ["proof (prove)\nusing this:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 \\<A> Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  M \\<turnstile>\\<^sub>c m\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?m \\<A> Sec \\<and>\n           ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   \\<forall>t t'.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n      t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<longrightarrow>\n      t' \\<sqsubseteq> t \\<longrightarrow>\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n      t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?M \\<turnstile>\\<^sub>c ?m\\<rbrakk>\n  \\<Longrightarrow> \\<langle>?M;\\<lambda>m.\n                                   homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m\n                                    \\<A> Sec \\<and>\n                                   m \\<in> GSMP\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rangle> \\<turnstile>\\<^sub>r ?m\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 \\<A> Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  M \\<turnstile>\\<^sub>c m\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?m \\<A> Sec \\<and>\n           ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   \\<forall>t t'.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n      t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<longrightarrow>\n      t' \\<sqsubseteq> t \\<longrightarrow>\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n      t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?M \\<turnstile>\\<^sub>c ?m\\<rbrakk>\n  \\<Longrightarrow> \\<langle>?M;\\<lambda>m.\n                                   homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m\n                                    \\<A> Sec \\<and>\n                                   m \\<in> GSMP\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rangle> \\<turnstile>\\<^sub>r ?m\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<lambda>t.\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                  t \\<in> GSMP\n                           (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                             \\<A>)\\<rangle> \\<turnstile>\\<^sub>r m", "by blast"], ["proof (state)\nthis:\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma hom_deduct_if_deduct:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and M: \"\\<forall>m\\<in>M. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n  and m: \"M \\<turnstile> m\" \"m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\nshows \"\\<langle>M; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "let ?P = \"\\<lambda>x. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t x \\<A> Sec \\<and> x \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "have GSMP_hom: \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" when \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\" for t"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "using \\<A> GSMP_is_homogeneous[of \\<A> Sec t]\n          secrets_are_homogeneous[of Sec \"\\<lambda>x. True\" t \\<A>] that"], ["proof (prove)\nusing this:\n  par_comp \\<A> Sec\n  \\<lbrakk>\\<forall>l l'.\n              l \\<noteq> l' \\<longrightarrow>\n              GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n               (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec;\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>); t \\<notin> Sec\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  \\<lbrakk>\\<forall>s\\<in>Sec.\n              True \\<longrightarrow>\n              (\\<forall>s'\\<in>subterms s.\n                  {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec);\n   t \\<in> Sec; True\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "unfolding par_comp_def"], ["proof (prove)\nusing this:\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n       (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec) \\<and>\n  (\\<forall>s\\<in>Sec.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n  ground Sec\n  \\<lbrakk>\\<forall>l l'.\n              l \\<noteq> l' \\<longrightarrow>\n              GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n               (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>)) Sec;\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>); t \\<notin> Sec\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  \\<lbrakk>\\<forall>s\\<in>Sec.\n              True \\<longrightarrow>\n              (\\<forall>s'\\<in>subterms s.\n                  {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec);\n   t \\<in> Sec; True\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec", "by blast"], ["proof (state)\nthis:\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<Longrightarrow>\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "have P_Ana: \"?P k\" when \"?P t\" \"Ana t = (K, T)\" \"k \\<in> set K\" for t K T k"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec \\<and>\n    k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using GSMP_Ana_key[OF _ that(2,3), of \"trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\"] \\<A> that GSMP_hom"], ["proof (prove)\nusing this:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<Longrightarrow>\n  k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  par_comp \\<A> Sec\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  Ana t = (K, T)\n  k \\<in> set K\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<Longrightarrow>\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec \\<and>\n    k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by presburger"], ["proof (state)\nthis:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   Ana ?t6 = (?K6, ?T6); ?k6 \\<in> set ?K6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?k6 \\<A> Sec \\<and>\n                    ?k6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "have P_subterm: \"?P t'\" when \"?P t\" \"t' \\<sqsubseteq> t\" for t t'"], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n    t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using GSMP_subterm[of _ \"trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\"] homogeneous_subterm[of _ \\<A> Sec] that"], ["proof (prove)\nusing this:\n  \\<lbrakk>?t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t' \\<sqsubseteq> ?t\\<rbrakk>\n  \\<Longrightarrow> ?t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t \\<A> Sec;\n   ?t' \\<sqsubseteq> ?t\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t' \\<A> Sec\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  t' \\<sqsubseteq> t\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n    t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by blast"], ["proof (state)\nthis:\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 \\<A> Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "have P_m: \"?P m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using GSMP_hom[OF m(2)] m(2)"], ["proof (prove)\nusing this:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by metis"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "using restricted_deduct_if_deduct'[OF M _ _ m(1) P_m] P_Ana P_subterm"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<forall>t t'.\n              homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n              t \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<longrightarrow>\n              t' \\<sqsubseteq> t \\<longrightarrow>\n              homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n              t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   \\<forall>t K T k.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n      t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<longrightarrow>\n      Ana t = (K, T) \\<longrightarrow>\n      k \\<in> set K \\<longrightarrow>\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec \\<and>\n      k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M;\\<lambda>a.\n                                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t a \\<A>\n                                   Sec \\<and>\n                                  a \\<in> GSMP\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rangle> \\<turnstile>\\<^sub>r m\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   Ana ?t6 = (?K6, ?T6); ?k6 \\<in> set ?K6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?k6 \\<A> Sec \\<and>\n                    ?k6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 \\<A> Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m", "unfolding intruder_deduct_hom_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<forall>t t'.\n              homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n              t \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<longrightarrow>\n              t' \\<sqsubseteq> t \\<longrightarrow>\n              homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t' \\<A> Sec \\<and>\n              t' \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   \\<forall>t K T k.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n      t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<longrightarrow>\n      Ana t = (K, T) \\<longrightarrow>\n      k \\<in> set K \\<longrightarrow>\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t k \\<A> Sec \\<and>\n      k \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M;\\<lambda>a.\n                                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t a \\<A>\n                                   Sec \\<and>\n                                  a \\<in> GSMP\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rangle> \\<turnstile>\\<^sub>r m\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   Ana ?t6 = (?K6, ?T6); ?k6 \\<in> set ?K6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?k6 \\<A> Sec \\<and>\n                    ?k6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t6 \\<A> Sec \\<and>\n           ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   ?t'6 \\<sqsubseteq> ?t6\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t'6 \\<A> Sec \\<and>\n                    ?t'6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M;\\<lambda>t.\n                  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec \\<and>\n                  t \\<in> GSMP\n                           (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                             \\<A>)\\<rangle> \\<turnstile>\\<^sub>r m", "by fast"], ["proof (state)\nthis:\n  \\<langle>M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m m\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Lemmata: Deduction Reduction of Parallel Composable Constraints\\<close>"], ["", "lemma par_comp_hom_deduct:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and M: \"\\<forall>l. \\<forall>m \\<in> M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\"\n         \"\\<forall>l. M l \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n         \"\\<forall>l. Discl \\<subseteq> M l\"\n         \"Discl \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"\n  and Sec: \"\\<forall>l. \\<forall>s \\<in> Sec - Discl. \\<not>(\\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)\"\n  and t: \"\\<langle>\\<Union>l. M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\"\n  shows \"t \\<notin> Sec - Discl\" (is ?A)\n        \"\\<forall>l. t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<longrightarrow> \\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\" (is ?B)"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl &&&\n    \\<forall>l.\n       t \\<in> GSMP\n                (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                  (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. t \\<notin> Sec - Discl\n 2. \\<forall>l.\n       t \\<in> GSMP\n                (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                  (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "have M': \"\\<forall>l. \\<forall>m \\<in> M l. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<forall>m\\<in>M l. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "proof (intro allI ballI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "fix l m"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "show \"m \\<in> M l \\<Longrightarrow> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<in> M l \\<Longrightarrow>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using M(2) in_proj_in_GSMP[of m l \\<A>]"], ["proof (prove)\nusing this:\n  \\<forall>l.\n     M l \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  m \\<in> GSMP\n           (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<Longrightarrow>\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. m \\<in> M l \\<Longrightarrow>\n    m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by blast"], ["proof (state)\nthis:\n  m \\<in> M l \\<Longrightarrow>\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>l.\n     \\<forall>m\\<in>M l. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (2 subgoals):\n 1. t \\<notin> Sec - Discl\n 2. \\<forall>l.\n       t \\<in> GSMP\n                (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                  (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "show ?A ?B"], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl &&&\n    \\<forall>l.\n       t \\<in> GSMP\n                (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                  (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "using t"], ["proof (prove)\nusing this:\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl &&&\n    \\<forall>l.\n       t \\<in> GSMP\n                (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                  (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "proof (induction t rule: intruder_deduct_hom_induct)"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow> t \\<notin> Sec - Discl\n 2. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 4. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 6. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "case (AxiomH t)"], ["proof (state)\nthis:\n  t \\<in> \\<Union> (range M)\n\ngoal (6 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow> t \\<notin> Sec - Discl\n 2. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 4. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 6. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "then"], ["proof (chain)\npicking this:\n  t \\<in> \\<Union> (range M)", "obtain lt where t_in_proj_ik: \"t \\<in> M lt\""], ["proof (prove)\nusing this:\n  t \\<in> \\<Union> (range M)\n\ngoal (1 subgoal):\n 1. (\\<And>lt. t \\<in> M lt \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t \\<in> M lt\n\ngoal (6 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow> t \\<notin> Sec - Discl\n 2. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 4. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 6. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "show t_not_Sec: \"t \\<notin> Sec - Discl\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<in> Sec - Discl \\<Longrightarrow> False", "assume \"t \\<in> Sec - Discl\""], ["proof (state)\nthis:\n  t \\<in> Sec - Discl\n\ngoal (1 subgoal):\n 1. t \\<in> Sec - Discl \\<Longrightarrow> False", "hence \"\\<forall>l. \\<not>(\\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t)\""], ["proof (prove)\nusing this:\n  t \\<in> Sec - Discl\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "using Sec"], ["proof (prove)\nusing this:\n  t \\<in> Sec - Discl\n  \\<forall>l.\n     \\<forall>s\\<in>Sec - Discl.\n        \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "by auto"], ["proof (state)\nthis:\n  \\<forall>l.\n     \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (1 subgoal):\n 1. t \\<in> Sec - Discl \\<Longrightarrow> False", "thus False"], ["proof (prove)\nusing this:\n  \\<forall>l.\n     \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (1 subgoal):\n 1. False", "using intruder_deduct_hom_AxiomH[OF t_in_proj_ik]"], ["proof (prove)\nusing this:\n  \\<forall>l.\n     \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  \\<langle>M lt;?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (1 subgoal):\n 1. False", "by metis"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  t \\<notin> Sec - Discl\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have 1: \"\\<forall>l. t \\<in> M l \\<longrightarrow> t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l.\n       t \\<in> M l \\<longrightarrow>\n       t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using M(2,3) AxiomH"], ["proof (prove)\nusing this:\n  \\<forall>l.\n     M l \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<forall>l. Discl \\<subseteq> M l\n  t \\<in> \\<Union> (range M)\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       t \\<in> M l \\<longrightarrow>\n       t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by auto"], ["proof (state)\nthis:\n  \\<forall>l.\n     t \\<in> M l \\<longrightarrow>\n     t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have 3: \"\\<And>l1 l2. l1 \\<noteq> l2 \\<Longrightarrow> t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) \\<inter> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>)\n                              \\<Longrightarrow> {} \\<turnstile>\\<^sub>c t \\<or> t \\<in> Discl\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l1 l2.\n       \\<lbrakk>l1 \\<noteq> l2;\n        t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n                GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\\<rbrakk>\n       \\<Longrightarrow> {} \\<turnstile>\\<^sub>c t \\<or> t \\<in> Discl", "using \\<A> t_not_Sec"], ["proof (prove)\nusing this:\n  par_comp \\<A> Sec\n  t \\<notin> Sec - Discl\n\ngoal (1 subgoal):\n 1. \\<And>l1 l2.\n       \\<lbrakk>l1 \\<noteq> l2;\n        t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n                GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\\<rbrakk>\n       \\<Longrightarrow> {} \\<turnstile>\\<^sub>c t \\<or> t \\<in> Discl", "by (auto simp add: par_comp_def GSMP_disjoint_def)"], ["proof (state)\nthis:\n  \\<lbrakk>?l1.6 \\<noteq> ?l2.6;\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.6 \\<A>)) \\<inter>\n           GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.6 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> {} \\<turnstile>\\<^sub>c t \\<or> t \\<in> Discl\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have 4: \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using M(1) M' t_in_proj_ik"], ["proof (prove)\nusing this:\n  \\<forall>l.\n     \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  \\<forall>l.\n     \\<forall>m\\<in>M l. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  t \\<in> M lt\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by auto"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "{"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "fix l"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "assume \"t \\<in> Discl\""], ["proof (state)\nthis:\n  t \\<in> Discl\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "hence \"t \\<in> M l\""], ["proof (prove)\nusing this:\n  t \\<in> Discl\n\ngoal (1 subgoal):\n 1. t \\<in> M l", "using M(3)"], ["proof (prove)\nusing this:\n  t \\<in> Discl\n  \\<forall>l. Discl \\<subseteq> M l\n\ngoal (1 subgoal):\n 1. t \\<in> M l", "by auto"], ["proof (state)\nthis:\n  t \\<in> M l\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "hence \"\\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\""], ["proof (prove)\nusing this:\n  t \\<in> M l\n\ngoal (1 subgoal):\n 1. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "by auto"], ["proof (state)\nthis:\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "}"], ["proof (state)\nthis:\n  t \\<in> Discl \\<Longrightarrow>\n  \\<langle>M ?l8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "hence 5: \"\\<forall>l. t \\<in> Discl \\<longrightarrow> \\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\""], ["proof (prove)\nusing this:\n  t \\<in> Discl \\<Longrightarrow>\n  \\<langle>M ?l8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       t \\<in> Discl \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "by metis"], ["proof (state)\nthis:\n  \\<forall>l.\n     t \\<in> Discl \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (5 subgoals):\n 1. \\<And>t.\n       t \\<in> \\<Union> (range M) \\<Longrightarrow>\n       \\<forall>l.\n          t \\<in> GSMP\n                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                     (proj l \\<A>)) \\<longrightarrow>\n          \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 3. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 5. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "show \"\\<forall>l. t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<longrightarrow> \\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l.\n       t \\<in> GSMP\n                (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                  (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t", "by (metis (lifting) Int_iff empty_subsetI\n          1 3 4 5 t_in_proj_ik\n          intruder_deduct_hom_AxiomH[of t _ \\<A> Sec]\n          deduct_hom_if_synth[of t \\<A> Sec \"{}\"]\n          ideduct_hom_mono[of \"{}\" \\<A> Sec t])"], ["proof (state)\nthis:\n  \\<forall>l.\n     t \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal (4 subgoals):\n 1. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 3. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 3. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "case (ComposeH T f)"], ["proof (state)\nthis:\n  length T = arity f\n  public f\n  ?x6 \\<in> set T \\<Longrightarrow>\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?x6\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f T) \\<A> Sec\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  ?x6 \\<in> set T \\<Longrightarrow> ?x6 \\<notin> Sec - Discl\n  ?x6 \\<in> set T \\<Longrightarrow>\n  \\<forall>l.\n     ?x6\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?x6\n\ngoal (4 subgoals):\n 1. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 2. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            Fun f X\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f X\n 3. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 4. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "show \"\\<forall>l. Fun f T \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<longrightarrow> \\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l.\n       Fun f T\n       \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\nf T", "proof (intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l.\n       Fun f T\n       \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<Longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\nf T", "fix l"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>l.\n       Fun f T\n       \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<Longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\nf T", "assume \"Fun f T \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (state)\nthis:\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<And>l.\n       Fun f T\n       \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<Longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\nf T", "hence \"\\<And>t. t \\<in> set T \\<Longrightarrow> t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (prove)\nusing this:\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> set T \\<Longrightarrow>\n       t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using GSMP_subterm[OF _ subtermeqI'']"], ["proof (prove)\nusing this:\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<lbrakk>Fun ?f1 ?T1 \\<in> GSMP ?M; ?t' \\<in> set ?T1\\<rbrakk>\n  \\<Longrightarrow> ?t' \\<in> GSMP ?M\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> set T \\<Longrightarrow>\n       t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by auto"], ["proof (state)\nthis:\n  ?t6 \\<in> set T \\<Longrightarrow>\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<And>l.\n       Fun f T\n       \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<Longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\nf T", "thus \"\\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f T\""], ["proof (prove)\nusing this:\n  ?t6 \\<in> set T \\<Longrightarrow>\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\n                                   f T", "using ComposeH.IH(2) intruder_deduct_hom_ComposeH[OF ComposeH.hyps(1,2) _ ComposeH.hyps(4,5)]"], ["proof (prove)\nusing this:\n  ?t6 \\<in> set T \\<Longrightarrow>\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  ?x6 \\<in> set T \\<Longrightarrow>\n  \\<forall>l.\n     ?x6\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?x6\n  (\\<And>x.\n      x \\<in> set T \\<Longrightarrow>\n      \\<langle>?M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x) \\<Longrightarrow>\n  \\<langle>?M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f T\n\ngoal (1 subgoal):\n 1. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\n                                   f T", "by simp"], ["proof (state)\nthis:\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun f\n                                 T\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>l.\n     Fun f T\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\n                                    f T\n\ngoal (3 subgoals):\n 1. \\<And>X f.\n       \\<lbrakk>length X = arity f; public f;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        \\<And>x. x \\<in> set X \\<Longrightarrow> x \\<notin> Sec - Discl;\n        \\<And>x.\n           x \\<in> set X \\<Longrightarrow>\n           \\<forall>l.\n              x \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m x;\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t (Fun f X) \\<A> Sec;\n        Fun f X \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n       \\<Longrightarrow> Fun f X \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 3. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "thus \"Fun f T \\<notin> Sec - Discl\""], ["proof (prove)\nusing this:\n  \\<forall>l.\n     Fun f T\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\n                                    f T\n\ngoal (1 subgoal):\n 1. Fun f T \\<notin> Sec - Discl", "using Sec ComposeH.hyps(5) trms\\<^sub>l\\<^sub>s\\<^sub>t_union[of \\<A>] GSMP_Union[of \\<A>]"], ["proof (prove)\nusing this:\n  \\<forall>l.\n     Fun f T\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m Fun\n                                    f T\n  \\<forall>l.\n     \\<forall>s\\<in>Sec - Discl.\n        \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n  (\\<Union>l. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) =\n  (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)))\n\ngoal (1 subgoal):\n 1. Fun f T \\<notin> Sec - Discl", "by (metis (no_types, lifting) UN_iff)"], ["proof (state)\nthis:\n  Fun f T \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "case (DecomposeH t K T t\\<^sub>i)"], ["proof (state)\nthis:\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  Ana t = (K, T)\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n  t\\<^sub>i \\<in> set T\n  t \\<notin> Sec - Discl\n  \\<forall>l.\n     t \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  ?k6 \\<in> set K \\<Longrightarrow> ?k6 \\<notin> Sec - Discl\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<forall>l.\n     ?k6\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have ti_subt: \"t\\<^sub>i \\<sqsubseteq> t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t\\<^sub>i \\<sqsubseteq> t", "using Ana_subterm[OF DecomposeH.hyps(2)] \\<open>t\\<^sub>i \\<in> set T\\<close>"], ["proof (prove)\nusing this:\n  set T \\<subset> subterms t\n  t\\<^sub>i \\<in> set T\n\ngoal (1 subgoal):\n 1. t\\<^sub>i \\<sqsubseteq> t", "by auto"], ["proof (state)\nthis:\n  t\\<^sub>i \\<sqsubseteq> t\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have t: \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\" \"t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using DecomposeH.hyps(1) hom_deduct_if_hom_ik M(1) M'"], ["proof (prove)\nusing this:\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  \\<lbrakk>\\<langle>?M;?A;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?m;\n   \\<forall>m\\<in>?M.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m ?A ?Sec \\<and>\n      m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t ?A)\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?m ?A ?Sec \\<and>\n                    ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t ?A)\n  \\<forall>l.\n     \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  \\<forall>l.\n     \\<forall>m\\<in>M l. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by auto"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t \\<A> Sec\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have ti: \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t\\<^sub>i \\<A> Sec\" \"t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t\\<^sub>i \\<A> Sec &&&\n    t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using intruder_deduct_hom_DecomposeH[OF DecomposeH.hyps] hom_deduct_if_hom_ik M(1) M'"], ["proof (prove)\nusing this:\n  (\\<And>k. k \\<in> set K \\<Longrightarrow> k \\<in> set K) \\<Longrightarrow>\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>\\<langle>?M;?A;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?m;\n   \\<forall>m\\<in>?M.\n      homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m ?A ?Sec \\<and>\n      m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t ?A)\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?m ?A ?Sec \\<and>\n                    ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t ?A)\n  \\<forall>l.\n     \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  \\<forall>l.\n     \\<forall>m\\<in>M l. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t\\<^sub>i \\<A> Sec &&&\n    t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by auto"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t\\<^sub>i \\<A> Sec\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "{"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t\\<^sub>i \\<A> Sec\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "fix l"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "assume *: \"t\\<^sub>i \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\" \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (state)\nthis:\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "hence \"\\<And>k. k \\<in> set K \\<Longrightarrow> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k\""], ["proof (prove)\nusing this:\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       k \\<in> set K \\<Longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k", "using GSMP_Ana_key[OF _ DecomposeH.hyps(2)] DecomposeH.IH(4)"], ["proof (prove)\nusing this:\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<lbrakk>t \\<in> GSMP ?M; ?k \\<in> set K\\<rbrakk>\n  \\<Longrightarrow> ?k \\<in> GSMP ?M\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<forall>l.\n     ?k6\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       k \\<in> set K \\<Longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k", "by auto"], ["proof (state)\nthis:\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "hence \"\\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\" \"t\\<^sub>i \\<notin> Sec - Discl\""], ["proof (prove)\nusing this:\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n\ngoal (1 subgoal):\n 1. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i &&&\n    t\\<^sub>i \\<notin> Sec - Discl", "using Sec DecomposeH.IH(2) *(2)\n              intruder_deduct_hom_DecomposeH[OF _ DecomposeH.hyps(2) _ \\<open>t\\<^sub>i \\<in> set T\\<close>]"], ["proof (prove)\nusing this:\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n  \\<forall>l.\n     \\<forall>s\\<in>Sec - Discl.\n        \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s\n  \\<forall>l.\n     t \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<lbrakk>\\<langle>?M;?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n   \\<And>k.\n      k \\<in> set K \\<Longrightarrow>\n      \\<langle>?M;?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k\\<rbrakk>\n  \\<Longrightarrow> \\<langle>?M;?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n\ngoal (1 subgoal):\n 1. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i &&&\n    t\\<^sub>i \\<notin> Sec - Discl", "by force+"], ["proof (state)\nthis:\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  t\\<^sub>i \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "}"], ["proof (state)\nthis:\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "{"], ["proof (state)\nthis:\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "fix l1 l2"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "assume *: \"t\\<^sub>i \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>)\" \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>)\" \"l1 \\<noteq> l2\""], ["proof (state)\nthis:\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n  l1 \\<noteq> l2\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "using *(3) \\<A>"], ["proof (prove)\nusing this:\n  l1 \\<noteq> l2\n  par_comp \\<A> Sec\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "by (simp add: par_comp_def)"], ["proof (state)\nthis:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "hence \"t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\nusing this:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "using GSMP_subterm[OF *(2) ti_subt] *(1)"], ["proof (prove)\nusing this:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n\ngoal (1 subgoal):\n 1. t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}", "by (auto simp add: GSMP_disjoint_def)"], ["proof (state)\nthis:\n  t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "moreover"], ["proof (state)\nthis:\n  t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have \"\\<And>k. k \\<in> set K \\<Longrightarrow> \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       k \\<in> set K \\<Longrightarrow>\n       \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k", "using *(2) GSMP_Ana_key[OF _ DecomposeH.hyps(2)] DecomposeH.IH(4)"], ["proof (prove)\nusing this:\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n  \\<lbrakk>t \\<in> GSMP ?M; ?k \\<in> set K\\<rbrakk>\n  \\<Longrightarrow> ?k \\<in> GSMP ?M\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<forall>l.\n     ?k6\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       k \\<in> set K \\<Longrightarrow>\n       \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k", "by auto"], ["proof (state)\nthis:\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "ultimately"], ["proof (chain)\npicking this:\n  t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6", "have \"t\\<^sub>i \\<notin> Sec - Discl\" \"{} \\<turnstile>\\<^sub>c t\\<^sub>i \\<or> t\\<^sub>i \\<in> Discl\""], ["proof (prove)\nusing this:\n  t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n\ngoal (1 subgoal):\n 1. t\\<^sub>i \\<notin> Sec - Discl &&&\n    {} \\<turnstile>\\<^sub>c t\\<^sub>i \\<or> t\\<^sub>i \\<in> Discl", "using Sec DecomposeH.IH(2) *(2)\n              intruder_deduct_hom_DecomposeH[OF _ DecomposeH.hyps(2) _ \\<open>t\\<^sub>i \\<in> set T\\<close>]"], ["proof (prove)\nusing this:\n  t\\<^sub>i \\<in> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  ?k6 \\<in> set K \\<Longrightarrow>\n  \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?k6\n  \\<forall>l.\n     \\<forall>s\\<in>Sec - Discl.\n        \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s\n  \\<forall>l.\n     t \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n  \\<lbrakk>\\<langle>?M;?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n   \\<And>k.\n      k \\<in> set K \\<Longrightarrow>\n      \\<langle>?M;?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k\\<rbrakk>\n  \\<Longrightarrow> \\<langle>?M;?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n\ngoal (1 subgoal):\n 1. t\\<^sub>i \\<notin> Sec - Discl &&&\n    {} \\<turnstile>\\<^sub>c t\\<^sub>i \\<or> t\\<^sub>i \\<in> Discl", "by (metis (lifting), metis (no_types, lifting) DiffI Un_iff mem_Collect_eq)"], ["proof (state)\nthis:\n  t\\<^sub>i \\<notin> Sec - Discl\n  {} \\<turnstile>\\<^sub>c t\\<^sub>i \\<or> t\\<^sub>i \\<in> Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "hence \"\\<langle>M l1;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\" \"\\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\" \"t\\<^sub>i \\<notin> Sec - Discl\""], ["proof (prove)\nusing this:\n  t\\<^sub>i \\<notin> Sec - Discl\n  {} \\<turnstile>\\<^sub>c t\\<^sub>i \\<or> t\\<^sub>i \\<in> Discl\n\ngoal (1 subgoal):\n 1. \\<langle>M l1;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i &&&\n    \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i &&&\n    t\\<^sub>i \\<notin> Sec - Discl", "using M(3,4) deduct_hom_if_synth[THEN ideduct_hom_mono] ti"], ["proof (prove)\nusing this:\n  t\\<^sub>i \\<notin> Sec - Discl\n  {} \\<turnstile>\\<^sub>c t\\<^sub>i \\<or> t\\<^sub>i \\<in> Discl\n  \\<forall>l. Discl \\<subseteq> M l\n  Discl \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  \\<lbrakk>homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t ?\\<A> ?Sec;\n   ?t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t ?\\<A>);\n   ?M \\<turnstile>\\<^sub>c ?t; ?M \\<subseteq> ?M'\\<rbrakk>\n  \\<Longrightarrow> \\<langle>?M';?\\<A>;?Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?t\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t t\\<^sub>i \\<A> Sec\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>M l1;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i &&&\n    \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i &&&\n    t\\<^sub>i \\<notin> Sec - Discl", "by (meson intruder_deduct_hom_AxiomH empty_subsetI subsetCE)+"], ["proof (state)\nthis:\n  \\<langle>M l1;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<langle>M l2;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  t\\<^sub>i \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "}"], ["proof (state)\nthis:\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l1.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l2.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "moreover"], ["proof (state)\nthis:\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l1.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l2.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "have\n        \"\\<exists>l. t\\<^sub>i \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n        \"\\<exists>l. t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>l.\n       t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) &&&\n    \\<exists>l. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using in_GSMP_in_proj[of _ \\<A>] ti(2) t(2)"], ["proof (prove)\nusing this:\n  ?t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<Longrightarrow>\n  \\<exists>n. ?t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<exists>l.\n       t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) &&&\n    \\<exists>l. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by presburger+"], ["proof (state)\nthis:\n  \\<exists>l.\n     t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<exists>l. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (2 subgoals):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<langle>\\<Union>\n                          (range\n                            M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        t \\<notin> Sec - Discl;\n        \\<forall>l.\n           t \\<in> GSMP\n                    (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                      (proj l \\<A>)) \\<longrightarrow>\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t;\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<langle>\\<Union>\n                     (range\n                       M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        \\<And>k. k \\<in> set K \\<Longrightarrow> k \\<notin> Sec - Discl;\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<forall>l.\n              k \\<in> GSMP\n                       (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                         (proj l \\<A>)) \\<longrightarrow>\n              \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m k;\n        t\\<^sub>i \\<in> set T\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l.\n                            t\\<^sub>i\n                            \\<in> GSMP\n                                   (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                     (proj l \\<A>)) \\<longrightarrow>\n                            \\<langle>M\nl;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "ultimately"], ["proof (chain)\npicking this:\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l1.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l2.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n  \\<exists>l.\n     t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<exists>l. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "show\n        \"t\\<^sub>i \\<notin> Sec - Discl\"\n        \"\\<forall>l. t\\<^sub>i \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>) \\<longrightarrow> \\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\""], ["proof (prove)\nusing this:\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l8 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l1.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> \\<langle>M ?l2.8;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>t\\<^sub>i\n           \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>));\n   t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>));\n   ?l1.8 \\<noteq> ?l2.8\\<rbrakk>\n  \\<Longrightarrow> t\\<^sub>i \\<notin> Sec - Discl\n  \\<exists>l.\n     t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<exists>l. t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. t\\<^sub>i \\<notin> Sec - Discl &&&\n    \\<forall>l.\n       t\\<^sub>i\n       \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "by (metis (no_types, lifting))+"], ["proof (state)\nthis:\n  t\\<^sub>i \\<notin> Sec - Discl\n  \\<forall>l.\n     t\\<^sub>i\n     \\<in> GSMP\n            (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  t \\<notin> Sec - Discl\n  \\<forall>l.\n     t \\<in> GSMP\n              (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<longrightarrow>\n     \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma par_comp_deduct_proj:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and M: \"\\<forall>l. \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\"\n         \"\\<forall>l. M l \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n         \"\\<forall>l. Discl \\<subseteq> M l\"\n  and t: \"(\\<Union>l. M l) \\<turnstile> t\" \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n  and Discl: \"Discl \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\"\n  shows \"M l \\<turnstile> t \\<or> (\\<exists>s \\<in> Sec - Discl. \\<exists>l. M l \\<turnstile> s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. M l \\<turnstile> t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s)", "using t"], ["proof (prove)\nusing this:\n  \\<Union> (range M) \\<turnstile> t\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. M l \\<turnstile> t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s)", "proof (induction t rule: intruder_deduct_induct)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> \\<Union> (range M);\n        t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 3. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "case (Axiom t)"], ["proof (state)\nthis:\n  t \\<in> \\<Union> (range M)\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (3 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> \\<Union> (range M);\n        t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 3. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "then"], ["proof (chain)\npicking this:\n  t \\<in> \\<Union> (range M)\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "obtain l' where t_in_ik_proj: \"t \\<in> M l'\""], ["proof (prove)\nusing this:\n  t \\<in> \\<Union> (range M)\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. (\\<And>l'. t \\<in> M l' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  t \\<in> M l'\n\ngoal (3 subgoals):\n 1. \\<And>t.\n       \\<lbrakk>t \\<in> \\<Union> (range M);\n        t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 3. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "proof (cases \"t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t\")"], ["proof (state)\ngoal (2 subgoals):\n 1. t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n 2. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "case True"], ["proof (state)\nthis:\n  t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t\n\ngoal (2 subgoals):\n 1. t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n 2. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "note T = True"], ["proof (state)\nthis:\n  t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t\n\ngoal (2 subgoals):\n 1. t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n 2. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "proof (cases \"t \\<in> Sec - Discl\")"], ["proof (state)\ngoal (2 subgoals):\n 1. t \\<in> Sec - Discl \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n 2. t \\<notin> Sec - Discl \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "case True"], ["proof (state)\nthis:\n  t \\<in> Sec - Discl\n\ngoal (2 subgoals):\n 1. t \\<in> Sec - Discl \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n 2. t \\<notin> Sec - Discl \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "thus ?thesis"], ["proof (prove)\nusing this:\n  t \\<in> Sec - Discl\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "using intruder_deduct.Axiom[OF t_in_ik_proj]"], ["proof (prove)\nusing this:\n  t \\<in> Sec - Discl\n  M l' \\<turnstile> t\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "by metis"], ["proof (state)\nthis:\n  intruder_deduct (M l) t \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "case False"], ["proof (state)\nthis:\n  t \\<notin> Sec - Discl\n\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "thus ?thesis"], ["proof (prove)\nusing this:\n  t \\<notin> Sec - Discl\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "using T ideduct_mono[of \"{}\" t]"], ["proof (prove)\nusing this:\n  t \\<notin> Sec - Discl\n  t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t\n  \\<lbrakk>{} \\<turnstile> t; {} \\<subseteq> ?M'\\<rbrakk>\n  \\<Longrightarrow> ?M' \\<turnstile> t\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "by auto"], ["proof (state)\nthis:\n  intruder_deduct (M l) t \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  intruder_deduct (M l) t \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal (1 subgoal):\n 1. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "case False"], ["proof (state)\nthis:\n  \\<not> (t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t)\n\ngoal (1 subgoal):\n 1. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "hence \"t \\<notin> Sec - Discl\" \"\\<not>{} \\<turnstile>\\<^sub>c t\" \"t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (prove)\nusing this:\n  \\<not> (t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t)\n\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl &&&\n    \\<not> {} \\<turnstile>\\<^sub>c t &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using Axiom"], ["proof (prove)\nusing this:\n  \\<not> (t \\<in> Sec - Discl \\<or> {} \\<turnstile>\\<^sub>c t)\n  t \\<in> \\<Union> (range M)\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. t \\<notin> Sec - Discl &&&\n    \\<not> {} \\<turnstile>\\<^sub>c t &&&\n    t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by auto"], ["proof (state)\nthis:\n  t \\<notin> Sec - Discl\n  \\<not> {} \\<turnstile>\\<^sub>c t\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "hence \"(\\<forall>l'. l \\<noteq> l' \\<longrightarrow> t \\<notin> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>)) \\<or> t \\<in> Discl\""], ["proof (prove)\nusing this:\n  t \\<notin> Sec - Discl\n  \\<not> {} \\<turnstile>\\<^sub>c t\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. (\\<forall>l'.\n        l \\<noteq> l' \\<longrightarrow>\n        t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n    t \\<in> Discl", "using \\<A>"], ["proof (prove)\nusing this:\n  t \\<notin> Sec - Discl\n  \\<not> {} \\<turnstile>\\<^sub>c t\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  par_comp \\<A> Sec\n\ngoal (1 subgoal):\n 1. (\\<forall>l'.\n        l \\<noteq> l' \\<longrightarrow>\n        t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n    t \\<in> Discl", "unfolding GSMP_disjoint_def par_comp_def"], ["proof (prove)\nusing this:\n  t \\<notin> Sec - Discl\n  \\<not> {} \\<turnstile>\\<^sub>c t\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n      GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n      \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}) \\<and>\n  (\\<forall>s\\<in>Sec.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n  ground Sec\n\ngoal (1 subgoal):\n 1. (\\<forall>l'.\n        l \\<noteq> l' \\<longrightarrow>\n        t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n    t \\<in> Discl", "by auto"], ["proof (state)\nthis:\n  (\\<forall>l'.\n      l \\<noteq> l' \\<longrightarrow>\n      t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n  t \\<in> Discl\n\ngoal (1 subgoal):\n 1. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "hence \"(\\<forall>l'. l \\<noteq> l' \\<longrightarrow> t \\<notin> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l' \\<A>)) \\<or> t \\<in> M l \\<or> {} \\<turnstile>\\<^sub>c t\""], ["proof (prove)\nusing this:\n  (\\<forall>l'.\n      l \\<noteq> l' \\<longrightarrow>\n      t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n  t \\<in> Discl\n\ngoal (1 subgoal):\n 1. (\\<forall>l'.\n        l \\<noteq> l' \\<longrightarrow>\n        t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n    t \\<in> M l \\<or> {} \\<turnstile>\\<^sub>c t", "using M"], ["proof (prove)\nusing this:\n  (\\<forall>l'.\n      l \\<noteq> l' \\<longrightarrow>\n      t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n  t \\<in> Discl\n  \\<forall>l.\n     \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n  \\<forall>l.\n     M l \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<forall>l. Discl \\<subseteq> M l\n\ngoal (1 subgoal):\n 1. (\\<forall>l'.\n        l \\<noteq> l' \\<longrightarrow>\n        t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n    t \\<in> M l \\<or> {} \\<turnstile>\\<^sub>c t", "by auto"], ["proof (state)\nthis:\n  (\\<forall>l'.\n      l \\<noteq> l' \\<longrightarrow>\n      t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n  t \\<in> M l \\<or> {} \\<turnstile>\\<^sub>c t\n\ngoal (1 subgoal):\n 1. \\<not> (t \\<in> Sec - Discl \\<or>\n            {} \\<turnstile>\\<^sub>c t) \\<Longrightarrow>\n    intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<forall>l'.\n      l \\<noteq> l' \\<longrightarrow>\n      t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n  t \\<in> M l \\<or> {} \\<turnstile>\\<^sub>c t\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "using Axiom deduct_if_synth[THEN ideduct_mono] t_in_ik_proj"], ["proof (prove)\nusing this:\n  (\\<forall>l'.\n      l \\<noteq> l' \\<longrightarrow>\n      t \\<notin> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l' \\<A>))) \\<or>\n  t \\<in> M l \\<or> {} \\<turnstile>\\<^sub>c t\n  t \\<in> \\<Union> (range M)\n  t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<lbrakk>?M \\<turnstile>\\<^sub>c ?t; ?M \\<subseteq> ?M'\\<rbrakk>\n  \\<Longrightarrow> ?M' \\<turnstile> ?t\n  t \\<in> M l'\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "by (metis (no_types, lifting) False M(2) intruder_deduct.Axiom subsetCE)"], ["proof (state)\nthis:\n  intruder_deduct (M l) t \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  intruder_deduct (M l) t \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal (2 subgoals):\n 1. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "case (Compose T f)"], ["proof (state)\nthis:\n  length T = arity f\n  public f\n  ?t6 \\<in> set T \\<Longrightarrow> \\<Union> (range M) \\<turnstile> ?t6\n  \\<lbrakk>?t6 \\<in> set T;\n   ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n  \\<Longrightarrow> intruder_deduct (M l) ?t6 \\<or>\n                    (\\<exists>s\\<in>Sec - Discl.\n                        \\<exists>l. intruder_deduct (M l) s)\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (2 subgoals):\n 1. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "hence \"Fun f T \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (prove)\nusing this:\n  length T = arity f\n  public f\n  ?t6 \\<in> set T \\<Longrightarrow> \\<Union> (range M) \\<turnstile> ?t6\n  \\<lbrakk>?t6 \\<in> set T;\n   ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n  \\<Longrightarrow> intruder_deduct (M l) ?t6 \\<or>\n                    (\\<exists>s\\<in>Sec - Discl.\n                        \\<exists>l. intruder_deduct (M l) s)\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using Compose.prems"], ["proof (prove)\nusing this:\n  length T = arity f\n  public f\n  ?t6 \\<in> set T \\<Longrightarrow> \\<Union> (range M) \\<turnstile> ?t6\n  \\<lbrakk>?t6 \\<in> set T;\n   ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n  \\<Longrightarrow> intruder_deduct (M l) ?t6 \\<or>\n                    (\\<exists>s\\<in>Sec - Discl.\n                        \\<exists>l. intruder_deduct (M l) s)\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by auto"], ["proof (state)\nthis:\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (2 subgoals):\n 1. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "hence \"\\<And>t. t \\<in> set T \\<Longrightarrow> t \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (prove)\nusing this:\n  Fun f T \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> set T \\<Longrightarrow>\n       t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "unfolding GSMP_def"], ["proof (prove)\nusing this:\n  Fun f T\n  \\<in> {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)).\n         fv t = {}}\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> set T \\<Longrightarrow>\n       t \\<in> {t \\<in> SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)).\n                fv t = {}}", "by auto"], ["proof (state)\nthis:\n  ?t6 \\<in> set T \\<Longrightarrow>\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (2 subgoals):\n 1. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "hence IH: \"\\<And>t. t \\<in> set T \\<Longrightarrow> M l \\<turnstile> t \\<or> (\\<exists>s \\<in> Sec - Discl. \\<exists>l. M l \\<turnstile> s)\""], ["proof (prove)\nusing this:\n  ?t6 \\<in> set T \\<Longrightarrow>\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> set T \\<Longrightarrow>\n       M l \\<turnstile> t \\<or>\n       (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s)", "using Compose.IH"], ["proof (prove)\nusing this:\n  ?t6 \\<in> set T \\<Longrightarrow>\n  ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  \\<lbrakk>?t6 \\<in> set T;\n   ?t6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n  \\<Longrightarrow> intruder_deduct (M l) ?t6 \\<or>\n                    (\\<exists>s\\<in>Sec - Discl.\n                        \\<exists>l. intruder_deduct (M l) s)\n\ngoal (1 subgoal):\n 1. \\<And>t.\n       t \\<in> set T \\<Longrightarrow>\n       M l \\<turnstile> t \\<or>\n       (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s)", "by auto"], ["proof (state)\nthis:\n  ?t6 \\<in> set T \\<Longrightarrow>\n  M l \\<turnstile> ?t6 \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s)\n\ngoal (2 subgoals):\n 1. \\<And>T f.\n       \\<lbrakk>length T = arity f; public f;\n        \\<And>t.\n           t \\<in> set T \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> t;\n        \\<And>t.\n           \\<lbrakk>t \\<in> set T;\n            t \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> t \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        Fun f T\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> Fun f T \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)\n 2. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. intruder_deduct (M l) (Fun f T) \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "proof (cases \"\\<forall>t \\<in> set T. M l \\<turnstile> t\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>t\\<in>set T. M l \\<turnstile> t \\<Longrightarrow>\n    intruder_deduct (M l) (Fun f T) \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n 2. \\<not> (\\<forall>t\\<in>set T. M l \\<turnstile> t) \\<Longrightarrow>\n    intruder_deduct (M l) (Fun f T) \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "case True"], ["proof (state)\nthis:\n  \\<forall>t\\<in>set T. M l \\<turnstile> t\n\ngoal (2 subgoals):\n 1. \\<forall>t\\<in>set T. M l \\<turnstile> t \\<Longrightarrow>\n    intruder_deduct (M l) (Fun f T) \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n 2. \\<not> (\\<forall>t\\<in>set T. M l \\<turnstile> t) \\<Longrightarrow>\n    intruder_deduct (M l) (Fun f T) \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>t\\<in>set T. M l \\<turnstile> t\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) (Fun f T) \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "by (metis intruder_deduct.Compose[OF Compose.hyps(1,2)])"], ["proof (state)\nthis:\n  intruder_deduct (M l) (Fun f T) \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>t\\<in>set T. M l \\<turnstile> t) \\<Longrightarrow>\n    intruder_deduct (M l) (Fun f T) \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "qed (metis IH)"], ["proof (state)\nthis:\n  intruder_deduct (M l) (Fun f T) \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "case (Decompose t K T t\\<^sub>i)"], ["proof (state)\nthis:\n  \\<Union> (range M) \\<turnstile> t\n  Ana t = (K, T)\n  ?k6 \\<in> set K \\<Longrightarrow> \\<Union> (range M) \\<turnstile> ?k6\n  t\\<^sub>i \\<in> set T\n  t \\<in> GSMP\n           (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<Longrightarrow>\n  intruder_deduct (M l) t \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n  \\<lbrakk>?k6 \\<in> set K;\n   ?k6 \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n  \\<Longrightarrow> intruder_deduct (M l) ?k6 \\<or>\n                    (\\<exists>s\\<in>Sec - Discl.\n                        \\<exists>l. intruder_deduct (M l) s)\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "have hom_ik: \"\\<forall>l. \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and> m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<forall>m\\<in>M l.\n          homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n          m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "proof (intro allI ballI conjI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n 2. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "fix l m"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n 2. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "assume m: \"m \\<in> M l\""], ["proof (state)\nthis:\n  m \\<in> M l\n\ngoal (2 subgoals):\n 1. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n 2. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "thus \"homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\""], ["proof (prove)\nusing this:\n  m \\<in> M l\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec", "using M(1)"], ["proof (prove)\nusing this:\n  m \\<in> M l\n  \\<forall>l.\n     \\<forall>m\\<in>M l. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n\ngoal (1 subgoal):\n 1. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec", "by simp"], ["proof (state)\nthis:\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<And>l m.\n       m \\<in> M l \\<Longrightarrow>\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "show \"m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "using in_proj_in_GSMP[of m l \\<A>] M(2) m"], ["proof (prove)\nusing this:\n  m \\<in> GSMP\n           (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)) \\<Longrightarrow>\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  \\<forall>l.\n     M l \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n  m \\<in> M l\n\ngoal (1 subgoal):\n 1. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by blast"], ["proof (state)\nthis:\n  m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>l.\n     \\<forall>m\\<in>M l.\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n        m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "have par_comp_unfold:\n      \"\\<forall>l1 l2. l1 \\<noteq> l2 \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "using \\<A>"], ["proof (prove)\nusing this:\n  par_comp \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "by (auto simp add: par_comp_def)"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "note ti_GSMP = in_proj_in_GSMP[OF Decompose.prems(1)]"], ["proof (state)\nthis:\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "have \"\\<langle>\\<Union>l. M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>\\<Union>\n              (range\n                M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "using intruder_deduct.Decompose[OF Decompose.hyps]\n          hom_deduct_if_deduct[OF \\<A>, of \"\\<Union>l. M l\"] hom_ik ti_GSMP"], ["proof (prove)\nusing this:\n  (\\<And>k. k \\<in> set K \\<Longrightarrow> k \\<in> set K) \\<Longrightarrow>\n  \\<Union> (range M) \\<turnstile> t\\<^sub>i\n  \\<lbrakk>\\<forall>m\\<in>\\<Union> (range M).\n              homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n              m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   \\<Union> (range M) \\<turnstile> ?m;\n   ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> \\<langle>\\<Union>\n                              (range\n                                M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?m\n  \\<forall>l.\n     \\<forall>m\\<in>M l.\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n        m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>\\<Union>\n              (range\n                M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "(* ti_hom *)"], ["proof (prove)\nusing this:\n  (\\<And>k. k \\<in> set K \\<Longrightarrow> k \\<in> set K) \\<Longrightarrow>\n  \\<Union> (range M) \\<turnstile> t\\<^sub>i\n  \\<lbrakk>\\<forall>m\\<in>\\<Union> (range M).\n              homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n              m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>);\n   \\<Union> (range M) \\<turnstile> ?m;\n   ?m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\\<rbrakk>\n  \\<Longrightarrow> \\<langle>\\<Union>\n                              (range\n                                M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?m\n  \\<forall>l.\n     \\<forall>m\\<in>M l.\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<and>\n        m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. \\<langle>\\<Union>\n              (range\n                M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i", "by blast"], ["proof (state)\nthis:\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "hence \"(\\<langle>M l; \\<A>; Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i) \\<or> (\\<exists>s \\<in> Sec-Discl. \\<exists>l. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)\""], ["proof (prove)\nusing this:\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n\ngoal (1 subgoal):\n 1. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i \\<or>\n    (\\<exists>s\\<in>Sec - Discl.\n        \\<exists>l.\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)", "using par_comp_hom_deduct(2)[OF \\<A> M Discl(1)] Decompose.prems(1)"], ["proof (prove)\nusing this:\n  \\<langle>\\<Union>\n            (range\n              M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i\n  \\<lbrakk>\\<forall>l.\n              \\<forall>s\\<in>Sec - Discl.\n                 \\<not> \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s;\n   \\<langle>\\<Union>\n             (range\n               M);\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?t\\<rbrakk>\n  \\<Longrightarrow> \\<forall>l.\n                       ?t \\<in> GSMP\n                                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                                   (proj l \\<A>)) \\<longrightarrow>\n                       \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?t\n  t\\<^sub>i \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (1 subgoal):\n 1. \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i \\<or>\n    (\\<exists>s\\<in>Sec - Discl.\n        \\<exists>l.\n           \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)", "by blast"], ["proof (state)\nthis:\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i \\<or>\n  (\\<exists>s\\<in>Sec - Discl.\n      \\<exists>l.\n         \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)\n\ngoal (1 subgoal):\n 1. \\<And>t K T t\\<^sub>i.\n       \\<lbrakk>\\<Union> (range M) \\<turnstile> t;\n        t \\<in> GSMP\n                 (trms\\<^sub>l\\<^sub>s\\<^sub>t\n                   (proj l \\<A>)) \\<Longrightarrow>\n        M l \\<turnstile> t \\<or>\n        (\\<exists>s\\<in>Sec - Discl. \\<exists>l. M l \\<turnstile> s);\n        Ana t = (K, T);\n        \\<And>k.\n           k \\<in> set K \\<Longrightarrow>\n           \\<Union> (range M) \\<turnstile> k;\n        \\<And>k.\n           \\<lbrakk>k \\<in> set K;\n            k \\<in> GSMP\n                     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n           \\<Longrightarrow> M l \\<turnstile> k \\<or>\n                             (\\<exists>s\\<in>Sec - Discl.\n                                 \\<exists>l. M l \\<turnstile> s);\n        t\\<^sub>i \\<in> set T;\n        t\\<^sub>i\n        \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\\<rbrakk>\n       \\<Longrightarrow> M l \\<turnstile> t\\<^sub>i \\<or>\n                         (\\<exists>s\\<in>Sec - Discl.\n                             \\<exists>l. M l \\<turnstile> s)", "thus ?case"], ["proof (prove)\nusing this:\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i \\<or>\n  (\\<exists>s\\<in>Sec - Discl.\n      \\<exists>l.\n         \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t\\<^sub>i \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "using deduct_if_hom_deduct[of _ \\<A> Sec]"], ["proof (prove)\nusing this:\n  \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m t\\<^sub>i \\<or>\n  (\\<exists>s\\<in>Sec - Discl.\n      \\<exists>l.\n         \\<langle>M l;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m s)\n  \\<langle>?M;\\<A>;Sec\\<rangle> \\<turnstile>\\<^sub>h\\<^sub>o\\<^sub>m ?m \\<Longrightarrow>\n  ?M \\<turnstile> ?m\n\ngoal (1 subgoal):\n 1. intruder_deduct (M l) t\\<^sub>i \\<or>\n    (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)", "by auto"], ["proof (state)\nthis:\n  intruder_deduct (M l) t\\<^sub>i \\<or>\n  (\\<exists>s\\<in>Sec - Discl. \\<exists>l. intruder_deduct (M l) s)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Theorem: Parallel Compositionality for Labeled Constraints\\<close>"], ["", "lemma par_comp_prefix: assumes \"par_comp (A@B) M\" shows \"par_comp A M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. par_comp A M", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. par_comp A M", "let ?L = \"\\<lambda>l. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l A \\<union> trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l B\""], ["proof (state)\ngoal (1 subgoal):\n 1. par_comp A M", "have \"\\<forall>l1 l2. l1 \\<noteq> l2 \\<longrightarrow> GSMP_disjoint (?L l1) (?L l2) M\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A) \\<union>\n         trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 B))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A) \\<union>\n         trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 B))\n        M", "using assms"], ["proof (prove)\nusing this:\n  par_comp (A @ B) M\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A) \\<union>\n         trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 B))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A) \\<union>\n         trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 B))\n        M", "unfolding par_comp_def"], ["proof (prove)\nusing this:\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 (A @ B)))\n       (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 (A @ B))) M) \\<and>\n  (\\<forall>s\\<in>M.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> M) \\<and>\n  ground M\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A) \\<union>\n         trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 B))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A) \\<union>\n         trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 B))\n        M", "by (metis trms\\<^sub>s\\<^sub>t_append proj_append(2) unlabel_append)"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A) \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 B))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A) \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 B))\n      M\n\ngoal (1 subgoal):\n 1. par_comp A M", "hence \"\\<forall>l1 l2. l1 \\<noteq> l2 \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 A) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 A) M\""], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A) \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 B))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A) \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 B))\n      M\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A)) M", "using SMP_union"], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A) \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 B))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A) \\<union>\n       trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 B))\n      M\n  SMP (?A \\<union> ?B) = SMP ?A \\<union> SMP ?B\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A)) M", "by (auto simp add: GSMP_def GSMP_disjoint_def)"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A)) M\n\ngoal (1 subgoal):\n 1. par_comp A M", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A)) M\n\ngoal (1 subgoal):\n 1. par_comp A M", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A)) M\n  par_comp (A @ B) M\n\ngoal (1 subgoal):\n 1. par_comp A M", "unfolding par_comp_def"], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A)) M\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 (A @ B)))\n       (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 (A @ B))) M) \\<and>\n  (\\<forall>s\\<in>M.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> M) \\<and>\n  ground M\n\ngoal (1 subgoal):\n 1. (\\<forall>l1 l2.\n        l1 \\<noteq> l2 \\<longrightarrow>\n        GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 A))\n         (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 A)) M) \\<and>\n    (\\<forall>s\\<in>M.\n        \\<forall>s'\\<in>subterms s.\n           {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> M) \\<and>\n    ground M", "by blast"], ["proof (state)\nthis:\n  par_comp A M\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem par_comp_constr_typed:\n  assumes \\<A>: \"par_comp \\<A> Sec\"\n  and \\<I>: \"\\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\"\n  shows \"(\\<forall>l. (\\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>)) \\<or> (\\<exists>\\<A>'. prefix \\<A>' \\<A> \\<and> (strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)", "let ?L = \"\\<lambda>\\<A>'. \\<exists>t \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>. \\<exists>l. \\<lbrakk>{}; proj_unl l \\<A>'@[Send t]\\<rbrakk>\\<^sub>d \\<I>\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)", "have \"\\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>", "using \\<I>"], ["proof (prove)\nusing this:\n  \\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\n  subst_domain \\<I> = \\<V> \\<and> ground (subst_range \\<I>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>", "by (simp add: constr_sem_d_def)"], ["proof (state)\nthis:\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)", "with \\<A>"], ["proof (chain)\npicking this:\n  par_comp \\<A> Sec\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>", "have \"(\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or> (\\<exists>\\<A>'. prefix \\<A>' \\<A> \\<and> ?L \\<A>')\""], ["proof (prove)\nusing this:\n  par_comp \\<A> Sec\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "proof (induction \"unlabel \\<A>\" arbitrary: \\<A> rule: List.rev_induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>\\<A>.\n       \\<lbrakk>[] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))\n 2. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "case Nil"], ["proof (state)\nthis:\n  [] = unlabel \\<A>\n  par_comp \\<A> Sec\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (2 subgoals):\n 1. \\<And>\\<A>.\n       \\<lbrakk>[] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))\n 2. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "hence \"\\<A> = []\""], ["proof (prove)\nusing this:\n  [] = unlabel \\<A>\n  par_comp \\<A> Sec\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. \\<A> = []", "using unlabel_nil_only_if_nil"], ["proof (prove)\nusing this:\n  [] = unlabel \\<A>\n  par_comp \\<A> Sec\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n  unlabel ?A = [] \\<Longrightarrow> ?A = []\n\ngoal (1 subgoal):\n 1. \\<A> = []", "by simp"], ["proof (state)\nthis:\n  \\<A> = []\n\ngoal (2 subgoals):\n 1. \\<And>\\<A>.\n       \\<lbrakk>[] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))\n 2. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "thus ?case"], ["proof (prove)\nusing this:\n  \\<A> = []\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by auto"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "case (snoc b B \\<A>)"], ["proof (state)\nthis:\n  \\<lbrakk>B = unlabel ?\\<A>6; par_comp ?\\<A>6 Sec;\n   \\<lbrakk>{}; unlabel ?\\<A>6\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n  \\<Longrightarrow> (\\<forall>l.\n                        \\<lbrakk>{}; proj_unl l ?\\<A>6\\<rbrakk>\\<^sub>d\n                         \\<I>) \\<or>\n                    (\\<exists>\\<A>'.\n                        prefix \\<A>' ?\\<A>6 \\<and>\n                        (\\<exists>t\\<in>Sec -\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                            \\<exists>l.\n                               \\<lbrakk>{}; proj_unl l \\<A>' @\n      [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                \\<I>))\n  B @ [b] = unlabel \\<A>\n  par_comp \\<A> Sec\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "hence disj: \"\\<forall>l1 l2. l1 \\<noteq> l2 \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec\""], ["proof (prove)\nusing this:\n  \\<lbrakk>B = unlabel ?\\<A>6; par_comp ?\\<A>6 Sec;\n   \\<lbrakk>{}; unlabel ?\\<A>6\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n  \\<Longrightarrow> (\\<forall>l.\n                        \\<lbrakk>{}; proj_unl l ?\\<A>6\\<rbrakk>\\<^sub>d\n                         \\<I>) \\<or>\n                    (\\<exists>\\<A>'.\n                        prefix \\<A>' ?\\<A>6 \\<and>\n                        (\\<exists>t\\<in>Sec -\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                            \\<exists>l.\n                               \\<lbrakk>{}; proj_unl l \\<A>' @\n      [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                \\<I>))\n  B @ [b] = unlabel \\<A>\n  par_comp \\<A> Sec\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "by (auto simp add: par_comp_def)"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "obtain a A n where a: \"\\<A> = A@[a]\" \"a = (ln n, b) \\<or> a = (\\<star>, b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>A a n.\n        \\<lbrakk>\\<A> = A @ [a];\n         a = (ln n, b) \\<or> a = (\\<star>, b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using unlabel_snoc_inv[OF snoc.hyps(2)[symmetric]]"], ["proof (prove)\nusing this:\n  \\<exists>A'.\n     (\\<exists>n. \\<A> = A' @ [(ln n, b)]) \\<or> \\<A> = A' @ [(\\<star>, b)]\n\ngoal (1 subgoal):\n 1. (\\<And>A a n.\n        \\<lbrakk>\\<A> = A @ [a];\n         a = (ln n, b) \\<or> a = (\\<star>, b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "hence A: \"\\<A> = A@[(ln n, b)] \\<or> \\<A> = A@[(\\<star>, b)]\""], ["proof (prove)\nusing this:\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. \\<A> = A @ [(ln n, b)] \\<or> \\<A> = A @ [(\\<star>, b)]", "by metis"], ["proof (state)\nthis:\n  \\<A> = A @ [(ln n, b)] \\<or> \\<A> = A @ [(\\<star>, b)]\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "have 1: \"B = unlabel A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B = unlabel A", "using a snoc.hyps(2) unlabel_append[of A \"[a]\"]"], ["proof (prove)\nusing this:\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  B @ [b] = unlabel \\<A>\n  unlabel (A @ [a]) = unlabel A @ unlabel [a]\n\ngoal (1 subgoal):\n 1. B = unlabel A", "by auto"], ["proof (state)\nthis:\n  B = unlabel A\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "have 2: \"par_comp A Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. par_comp A Sec", "using par_comp_prefix snoc.prems(1) a"], ["proof (prove)\nusing this:\n  par_comp (?A @ ?B) ?M \\<Longrightarrow> par_comp ?A ?M\n  par_comp \\<A> Sec\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. par_comp A Sec", "by metis"], ["proof (state)\nthis:\n  par_comp A Sec\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "have 3: \"\\<lbrakk>{}; unlabel A\\<rbrakk>\\<^sub>d \\<I>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; unlabel A\\<rbrakk>\\<^sub>d \\<I>", "by (metis 1 snoc.prems(2) snoc.hyps(2) strand_sem_split(3))"], ["proof (state)\nthis:\n  \\<lbrakk>{}; unlabel A\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "have IH: \"(\\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>) \\<or> (\\<exists>\\<A>'. prefix \\<A>' A \\<and> ?L \\<A>')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' A \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by (rule snoc.hyps(1)[OF 1 2 3])"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>'.\n      prefix \\<A>' A \\<and>\n      (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. \\<And>x xs \\<A>.\n       \\<lbrakk>\\<And>\\<A>.\n                   \\<lbrakk>xs = unlabel \\<A>; par_comp \\<A> Sec;\n                    \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n                   \\<Longrightarrow> (\\<forall>l.\n   \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                                     (\\<exists>\\<A>'.\n   prefix \\<A>' \\<A> \\<and>\n   (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n       \\<exists>l.\n          \\<lbrakk>{}; proj_unl l \\<A>' @\n                       [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n           \\<I>));\n        xs @ [x] = unlabel \\<A>; par_comp \\<A> Sec;\n        \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l.\n                             \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d\n                              \\<I>) \\<or>\n                         (\\<exists>\\<A>'.\n                             prefix \\<A>' \\<A> \\<and>\n                             (\\<exists>t\n \\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n                                 \\<exists>l.\n                                    \\<lbrakk>{}; proj_unl l \\<A>' @\n           [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                                     \\<I>))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "proof (cases \"\\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. \\<not> (\\<forall>l.\n               \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d\n                \\<I>) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "case False"], ["proof (state)\nthis:\n  \\<not> (\\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>)\n\ngoal (2 subgoals):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. \\<not> (\\<forall>l.\n               \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d\n                \\<I>) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "then"], ["proof (chain)\npicking this:\n  \\<not> (\\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>)", "obtain \\<A>' where \\<A>': \"prefix \\<A>' A\" \"?L \\<A>'\""], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<A>'.\n        \\<lbrakk>prefix \\<A>' A;\n         \\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (metis IH)"], ["proof (state)\nthis:\n  prefix \\<A>' A\n  \\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n     \\<exists>l.\n        \\<lbrakk>{}; proj_unl l \\<A>' @\n                     [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n         \\<I>\n\ngoal (2 subgoals):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. \\<not> (\\<forall>l.\n               \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d\n                \\<I>) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence \"prefix \\<A>' (A@[a])\""], ["proof (prove)\nusing this:\n  prefix \\<A>' A\n  \\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n     \\<exists>l.\n        \\<lbrakk>{}; proj_unl l \\<A>' @\n                     [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n         \\<I>\n\ngoal (1 subgoal):\n 1. prefix \\<A>' (A @ [a])", "using a prefix_prefix[of _ A \"[a]\"]"], ["proof (prove)\nusing this:\n  prefix \\<A>' A\n  \\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n     \\<exists>l.\n        \\<lbrakk>{}; proj_unl l \\<A>' @\n                     [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n         \\<I>\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  prefix ?xs A \\<Longrightarrow> prefix ?xs (A @ [a])\n\ngoal (1 subgoal):\n 1. prefix \\<A>' (A @ [a])", "by simp"], ["proof (state)\nthis:\n  prefix \\<A>' (A @ [a])\n\ngoal (2 subgoals):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. \\<not> (\\<forall>l.\n               \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d\n                \\<I>) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  prefix \\<A>' (A @ [a])\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using \\<A>'(2) a"], ["proof (prove)\nusing this:\n  prefix \\<A>' (A @ [a])\n  \\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n     \\<exists>l.\n        \\<lbrakk>{}; proj_unl l \\<A>' @\n                     [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n         \\<I>\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by auto"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "case True"], ["proof (state)\nthis:\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "note IH' = True"], ["proof (state)\nthis:\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "proof (cases b)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "case (Send t)"], ["proof (state)\nthis:\n  b = send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "hence \"ik\\<^sub>s\\<^sub>t (unlabel A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> t \\<cdot> \\<I>\""], ["proof (prove)\nusing this:\n  b = send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (unlabel A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I> \\<turnstile>\n    t \\<cdot> \\<I>", "using a \\<open>\\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<close> strand_sem_split(2)[of \"{}\" \"unlabel A\" \"unlabel [a]\" \\<I>]\n                unlabel_append[of A \"[a]\"]"], ["proof (prove)\nusing this:\n  b = send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n  \\<lbrakk>{}; unlabel A @ unlabel [a]\\<rbrakk>\\<^sub>c\n   \\<I> \\<Longrightarrow>\n  \\<lbrakk>{} \\<union>\n           (ik\\<^sub>s\\<^sub>t (unlabel A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n            \\<I>); unlabel [a]\\<rbrakk>\\<^sub>c\n   \\<I>\n  unlabel (A @ [a]) = unlabel A @ unlabel [a]\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (unlabel A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I> \\<turnstile>\n    t \\<cdot> \\<I>", "by auto"], ["proof (state)\nthis:\n  ik\\<^sub>s\\<^sub>t (unlabel A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I>\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "hence *: \"(\\<Union>l. (ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>)) \\<turnstile> t \\<cdot> \\<I>\""], ["proof (prove)\nusing this:\n  ik\\<^sub>s\\<^sub>t (unlabel A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I>\n\ngoal (1 subgoal):\n 1. (\\<Union>l.\n        ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n        \\<I>) \\<turnstile>\n    t \\<cdot> \\<I>", "using proj_ik_union_is_unlabel_ik image_UN"], ["proof (prove)\nusing this:\n  ik\\<^sub>s\\<^sub>t (unlabel A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I>\n  ik\\<^sub>s\\<^sub>t (unlabel ?A) =\n  (\\<Union>l. ik\\<^sub>s\\<^sub>t (proj_unl l ?A))\n  ?f ` \\<Union> (?B ` ?A) = (\\<Union>x\\<in>?A. ?f ` ?B x)\n\ngoal (1 subgoal):\n 1. (\\<Union>l.\n        ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n        \\<I>) \\<turnstile>\n    t \\<cdot> \\<I>", "by metis"], ["proof (state)\nthis:\n  (\\<Union>l.\n      ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n      \\<I>) \\<turnstile>\n  t \\<cdot> \\<I>\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have \"ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) = ik\\<^sub>s\\<^sub>t (proj_unl l A)\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) = ik\\<^sub>s\\<^sub>t (proj_unl l A)", "using Send A"], ["proof (prove)\nusing this:\n  b = send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n  \\<A> = A @ [(ln n, b)] \\<or> \\<A> = A @ [(\\<star>, b)]\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) = ik\\<^sub>s\\<^sub>t (proj_unl l A)", "by (metis append_Nil2 ik\\<^sub>s\\<^sub>t.simps(3) proj_unl_cons(3) proj_nil(2)\n                    singleton_lst_proj(1,2) proj_ik_append)"], ["proof (state)\nthis:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) =\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A)\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "hence **: \"ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\" for l"], ["proof (prove)\nusing this:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) =\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A)\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using ik_proj_subst_GSMP_subset[OF \\<I>(3,4,2), of _ \\<A>]"], ["proof (prove)\nusing this:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) =\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A)\n  ik\\<^sub>s\\<^sub>t (proj_unl ?n \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n \\<A>))\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by auto"], ["proof (state)\nthis:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "note Discl =\n          declassified_proj_ik_subset[of A \\<I>]\n          declassified_proj_GSMP_subset[OF \\<I>(3,4,2), of A]\n          declassified_secrets_subset[OF disj \\<I>(3,4,2)]\n          declassified_append[of A \"[a]\" \\<I>]"], ["proof (state)\nthis:\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl ?n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              \\<I>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n A))\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t (A @ [a]) \\<I> =\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<union>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t [a] \\<I>\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have Sec: \"ground Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ground Sec", "using \\<A>"], ["proof (prove)\nusing this:\n  par_comp \\<A> Sec\n\ngoal (1 subgoal):\n 1. ground Sec", "by (auto simp add: par_comp_def)"], ["proof (state)\nthis:\n  ground Sec\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have \"\\<forall>m\\<in>ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or> m \\<in> Sec-declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\"\n             \"\\<forall>m\\<in>ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>. m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\"\n             \"ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\"\n          for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                    (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   \\<I>.\n       homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n       m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> &&&\n    \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                    (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   \\<I>.\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) &&&\n    ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I>\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using declassified_secrets_are_homogeneous[OF disj \\<I>(3,4,2)]\n                GSMP_proj_is_homogeneous[OF disj]\n                ik_proj_subst_GSMP_subset[OF \\<I>(3,4,2), of _ \\<A>]"], ["proof (prove)\nusing this:\n  ?s \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I> \\<Longrightarrow>\n  homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?s \\<A> Sec\n  \\<lbrakk>?t \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l \\<A>));\n   ?t \\<notin> Sec\\<rbrakk>\n  \\<Longrightarrow> homogeneous\\<^sub>l\\<^sub>s\\<^sub>t ?t \\<A> Sec\n  ik\\<^sub>s\\<^sub>t (proj_unl ?n \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n \\<A>))\n\ngoal (1 subgoal):\n 1. \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                    (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   \\<I>.\n       homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n       m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> &&&\n    \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                    (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   \\<I>.\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) &&&\n    ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I>\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "apply (metis (no_types, lifting) Diff_iff Discl(4) UnCI a(1) subsetCE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                    (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   \\<I>.\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n 2. ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I>\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using ik_proj_subst_GSMP_subset[OF \\<I>(3,4,2), of _ \\<A>]\n                GSMP_Union[of \\<A>]"], ["proof (prove)\nusing this:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?n \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n \\<A>))\n  GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) =\n  (\\<Union>l. GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>)))\n\ngoal (2 subgoals):\n 1. \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                    (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                   \\<I>.\n       m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n 2. ik\\<^sub>s\\<^sub>t (proj_unl l \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I>\n    \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by auto"], ["proof (state)\nthis:\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n     m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "moreover"], ["proof (state)\nthis:\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n     m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have \"ik\\<^sub>s\\<^sub>t (proj_unl l [a]) = {}\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l [a]) = {}", "using Send proj_ik\\<^sub>s\\<^sub>t_is_proj_rcv_set[of _ \"[a]\"] a(2)"], ["proof (prove)\nusing this:\n  b = send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n  ik\\<^sub>s\\<^sub>t (proj_unl ?n [a]) =\n  {t. (ln ?n, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n      \\<in> set [a] \\<or>\n      (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) \\<in> set [a]}\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l [a]) = {}", "by auto"], ["proof (state)\nthis:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 [a]) = {}\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n     m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 [a]) = {}", "have M:\n            \"\\<forall>l. \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or> m \\<in> Sec-declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\"\n            \"\\<forall>l. ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<subseteq> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\""], ["proof (prove)\nusing this:\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n     m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 [a]) = {}\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n          m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> &&&\n    \\<forall>l.\n       ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n       \\<I>\n       \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using a(1) proj_ik_append[of _ A \"[a]\"]"], ["proof (prove)\nusing this:\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n     m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                  (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                 \\<I>.\n     m \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 \\<A>) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 [a]) = {}\n  \\<A> = A @ [a]\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l (A @ [a])) =\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l A) \\<union>\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l [a])\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n          m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> &&&\n    \\<forall>l.\n       ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n       \\<I>\n       \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by auto"], ["proof (state)\nthis:\n  \\<forall>l.\n     \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<forall>l.\n     ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>\n     \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have prefix_A: \"prefix A \\<A>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prefix A \\<A>", "using A"], ["proof (prove)\nusing this:\n  \\<A> = A @ [(ln n, b)] \\<or> \\<A> = A @ [(\\<star>, b)]\n\ngoal (1 subgoal):\n 1. prefix A \\<A>", "by auto"], ["proof (state)\nthis:\n  prefix A \\<A>\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have \"s \\<cdot> \\<I> = s\"\n          when \"s \\<in> Sec\" for s"], ["proof (prove)\ngoal (1 subgoal):\n 1. s \\<cdot> \\<I> = s", "using that Sec"], ["proof (prove)\nusing this:\n  s \\<in> Sec\n  ground Sec\n\ngoal (1 subgoal):\n 1. s \\<cdot> \\<I> = s", "by auto"], ["proof (state)\nthis:\n  ?s6 \\<in> Sec \\<Longrightarrow> ?s6 \\<cdot> \\<I> = ?s6\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "hence leakage_case: \"\\<lbrakk>{}; proj_unl l A@[Send s]\\<rbrakk>\\<^sub>d \\<I>\"\n          when \"s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\" \"ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> s\" for l s"], ["proof (prove)\nusing this:\n  ?s6 \\<in> Sec \\<Longrightarrow> ?s6 \\<cdot> \\<I> = ?s6\n\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; proj_unl l A @\n                 [send\\<langle>s\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n     \\<I>", "using that strand_sem_append(2) IH'"], ["proof (prove)\nusing this:\n  ?s6 \\<in> Sec \\<Longrightarrow> ?s6 \\<cdot> \\<I> = ?s6\n  s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  s\n  \\<lbrakk>\\<lbrakk>?M; ?S\\<rbrakk>\\<^sub>d ?\\<theta>;\n   \\<lbrakk>?M \\<union>\n            (ik\\<^sub>s\\<^sub>t ?S \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n             ?\\<theta>); ?S'\\<rbrakk>\\<^sub>d\n    ?\\<theta>\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>?M; ?S @ ?S'\\<rbrakk>\\<^sub>d ?\\<theta>\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; proj_unl l A @\n                 [send\\<langle>s\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n     \\<I>", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>?s6 \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>;\n   ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n   \\<I> \\<turnstile>\n   ?s6\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>{}; proj_unl ?l6 A @\n                                 [send\\<langle>?s6\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                     \\<I>\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have proj_deduct_case_n:\n            \"\\<forall>m. m \\<noteq> n \\<longrightarrow> \\<lbrakk>{}; proj_unl m (A@[a])\\<rbrakk>\\<^sub>d \\<I>\"\n            \"ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> t \\<cdot> \\<I> \\<Longrightarrow> \\<lbrakk>{}; proj_unl n (A@[a])\\<rbrakk>\\<^sub>d \\<I>\"\n          when \"a = (ln n, Send t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>m.\n       m \\<noteq> n \\<longrightarrow>\n       \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I> &&&\n    (ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n     \\<I> \\<turnstile>\n     t \\<cdot> \\<I> \\<Longrightarrow>\n     \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>)", "using that IH' proj_append(2)[of _ A]"], ["proof (prove)\nusing this:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n  proj_unl ?l (A @ ?B) = proj_unl ?l A @ proj_unl ?l ?B\n\ngoal (1 subgoal):\n 1. \\<forall>m.\n       m \\<noteq> n \\<longrightarrow>\n       \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I> &&&\n    (ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n     \\<I> \\<turnstile>\n     t \\<cdot> \\<I> \\<Longrightarrow>\n     \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>)", "by auto"], ["proof (state)\nthis:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) \\<Longrightarrow>\n  \\<forall>m.\n     m \\<noteq> n \\<longrightarrow>\n     \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  \\<lbrakk>a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t);\n   ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n   \\<I> \\<turnstile>\n   t \\<cdot> \\<I>\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "have proj_deduct_case_star:\n            \"\\<lbrakk>{}; proj_unl l (A@[a])\\<rbrakk>\\<^sub>d \\<I>\"\n          when \"a = (\\<star>, Send t)\" \"ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> t \\<cdot> \\<I>\" for l"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; proj_unl l (A @ [a])\\<rbrakk>\\<^sub>d \\<I>", "using that IH' proj_append(2)[of _ A]"], ["proof (prove)\nusing this:\n  a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I>\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n  proj_unl ?l (A @ ?B) = proj_unl ?l A @ proj_unl ?l ?B\n\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; proj_unl l (A @ [a])\\<rbrakk>\\<^sub>d \\<I>", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t);\n   ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n   \\<I> \\<turnstile>\n   t \\<cdot> \\<I>\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>{}; proj_unl ?l6 (A @ [a])\\<rbrakk>\\<^sub>d\n                     \\<I>\n\ngoal (4 subgoals):\n 1. \\<And>x1.\n       b = send\\<langle>x1\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 4. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "proof (cases \"\\<exists>l. \\<exists>m \\<in> ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>. m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "case True"], ["proof (state)\nthis:\n  \\<exists>l.\n     \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (2 subgoals):\n 1. \\<exists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "then"], ["proof (chain)\npicking this:\n  \\<exists>l.\n     \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>", "obtain l s where ls: \"s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\" \"ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> s\""], ["proof (prove)\nusing this:\n  \\<exists>l.\n     \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (1 subgoal):\n 1. (\\<And>s l.\n        \\<lbrakk>s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>;\n         ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n         \\<I> \\<turnstile>\n         s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using intruder_deduct.Axiom"], ["proof (prove)\nusing this:\n  \\<exists>l.\n     \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  ?t \\<in> ?M \\<Longrightarrow> ?M \\<turnstile> ?t\n\ngoal (1 subgoal):\n 1. (\\<And>s l.\n        \\<lbrakk>s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>;\n         ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n         \\<I> \\<turnstile>\n         s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  s\n\ngoal (2 subgoals):\n 1. \\<exists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  s\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using leakage_case prefix_A"], ["proof (prove)\nusing this:\n  s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  s\n  \\<lbrakk>?s6 \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>;\n   ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n   \\<I> \\<turnstile>\n   ?s6\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>{}; proj_unl ?l6 A @\n                                 [send\\<langle>?s6\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                     \\<I>\n  prefix A \\<A>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by blast"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "case False"], ["proof (state)\nthis:\n  \\<nexists>l.\n     \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (1 subgoal):\n 1. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence M': \"\\<forall>l. \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I>. homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\""], ["proof (prove)\nusing this:\n  \\<nexists>l.\n     \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec", "using M(1)"], ["proof (prove)\nusing this:\n  \\<nexists>l.\n     \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<forall>l.\n     \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec \\<or>\n        m \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (1 subgoal):\n 1. \\<forall>l.\n       \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec", "by blast"], ["proof (state)\nthis:\n  \\<forall>l.\n     \\<forall>m\\<in>ik\\<^sub>s\\<^sub>t\n                     (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I>.\n        homogeneous\\<^sub>l\\<^sub>s\\<^sub>t m \\<A> Sec\n\ngoal (1 subgoal):\n 1. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "note deduct_proj_lemma =\n              par_comp_deduct_proj[OF snoc.prems(1) M' M(2) _ *, of \"declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\" n]"], ["proof (state)\nthis:\n  \\<lbrakk>\\<forall>l.\n              declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n              \\<subseteq> ik\\<^sub>s\\<^sub>t\n                           (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                          \\<I>;\n   t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>));\n   declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n   \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\\<rbrakk>\n  \\<Longrightarrow> ik\\<^sub>s\\<^sub>t\n                     (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I> \\<turnstile>\n                    t \\<cdot> \\<I> \\<or>\n                    (\\<exists>s\\<in>Sec -\n                                    declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                                     \\<I>.\n                        \\<exists>l.\n                           ik\\<^sub>s\\<^sub>t\n                            (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                           \\<I> \\<turnstile>\n                           s)\n\ngoal (1 subgoal):\n 1. \\<nexists>l.\n       \\<exists>m\\<in>ik\\<^sub>s\\<^sub>t\n                       (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                      \\<I>.\n          m \\<in> Sec -\n                  declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                   \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "from a(2)"], ["proof (chain)\npicking this:\n  a = (ln n, b) \\<or> a = (\\<star>, b)", "show ?thesis"], ["proof (prove)\nusing this:\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. a = (ln n, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "assume \"a = (ln n, b)\""], ["proof (state)\nthis:\n  a = (ln n, b)\n\ngoal (2 subgoals):\n 1. a = (ln n, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence \"a = (ln n, Send t)\" \"t \\<cdot> \\<I> \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n \\<A>)\""], ["proof (prove)\nusing this:\n  a = (ln n, b)\n\ngoal (1 subgoal):\n 1. a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) &&&\n    t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))", "using Send a(1) trms_proj\\<^sub>l\\<^sub>s\\<^sub>t_append[of n A \"[a]\"]\n                    GSMP_wt_substI[OF _ \\<I>(3,4,2)]"], ["proof (prove)\nusing this:\n  a = (ln n, b)\n  b = send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n  \\<A> = A @ [a]\n  trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n (A @ [a])) =\n  trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) \\<union>\n  trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n [a])\n  ?t \\<in> ?M \\<Longrightarrow> ?t \\<cdot> \\<I> \\<in> GSMP ?M\n\ngoal (1 subgoal):\n 1. a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) &&&\n    t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))", "by (metis, force)"], ["proof (state)\nthis:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n\ngoal (2 subgoals):\n 1. a = (ln n, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence\n                \"a = (ln n, Send t)\"\n                \"\\<forall>m. m \\<noteq> n \\<longrightarrow> \\<lbrakk>{}; proj_unl m (A@[a])\\<rbrakk>\\<^sub>d \\<I>\"\n                \"ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> t \\<cdot> \\<I> \\<Longrightarrow> \\<lbrakk>{}; proj_unl n (A@[a])\\<rbrakk>\\<^sub>d \\<I>\"\n                \"t \\<cdot> \\<I> \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t n \\<A>)\""], ["proof (prove)\nusing this:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n\ngoal (1 subgoal):\n 1. (a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) &&&\n     \\<forall>m.\n        m \\<noteq> n \\<longrightarrow>\n        \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I>) &&&\n    (ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n     \\<I> \\<turnstile>\n     t \\<cdot> \\<I> \\<Longrightarrow>\n     \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>) &&&\n    t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))", "using proj_deduct_case_n"], ["proof (prove)\nusing this:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) \\<Longrightarrow>\n  \\<forall>m.\n     m \\<noteq> n \\<longrightarrow>\n     \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  \\<lbrakk>a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t);\n   ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n   \\<I> \\<turnstile>\n   t \\<cdot> \\<I>\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. (a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) &&&\n     \\<forall>m.\n        m \\<noteq> n \\<longrightarrow>\n        \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I>) &&&\n    (ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n     \\<I> \\<turnstile>\n     t \\<cdot> \\<I> \\<Longrightarrow>\n     \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>) &&&\n    t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))", "by auto"], ["proof (state)\nthis:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  \\<forall>m.\n     m \\<noteq> n \\<longrightarrow>\n     \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I> \\<Longrightarrow>\n  \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n\ngoal (2 subgoals):\n 1. a = (ln n, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence \"(\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n                   (\\<exists>s \\<in> Sec-declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>. \\<exists>l. ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> s)\""], ["proof (prove)\nusing this:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  \\<forall>m.\n     m \\<noteq> n \\<longrightarrow>\n     \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I> \\<Longrightarrow>\n  \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n        \\<exists>l.\n           ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n           \\<I> \\<turnstile>\n           s)", "using deduct_proj_lemma A a Discl"], ["proof (prove)\nusing this:\n  a = (ln n, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  \\<forall>m.\n     m \\<noteq> n \\<longrightarrow>\n     \\<lbrakk>{}; proj_unl m (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I> \\<Longrightarrow>\n  \\<lbrakk>{}; proj_unl n (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>))\n  \\<lbrakk>\\<forall>l.\n              declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n              \\<subseteq> ik\\<^sub>s\\<^sub>t\n                           (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                          \\<I>;\n   t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>));\n   declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n   \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\\<rbrakk>\n  \\<Longrightarrow> ik\\<^sub>s\\<^sub>t\n                     (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I> \\<turnstile>\n                    t \\<cdot> \\<I> \\<or>\n                    (\\<exists>s\\<in>Sec -\n                                    declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                                     \\<I>.\n                        \\<exists>l.\n                           ik\\<^sub>s\\<^sub>t\n                            (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                           \\<I> \\<turnstile>\n                           s)\n  \\<A> = A @ [(ln n, b)] \\<or> \\<A> = A @ [(\\<star>, b)]\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl ?n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              \\<I>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n A))\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t (A @ [a]) \\<I> =\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<union>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t [a] \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n        \\<exists>l.\n           ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n           \\<I> \\<turnstile>\n           s)", "by fast"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n      \\<exists>l.\n         ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n         \\<I> \\<turnstile>\n         s)\n\ngoal (2 subgoals):\n 1. a = (ln n, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n      \\<exists>l.\n         ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n         \\<I> \\<turnstile>\n         s)\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using leakage_case prefix_A"], ["proof (prove)\nusing this:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n      \\<exists>l.\n         ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n         \\<I> \\<turnstile>\n         s)\n  \\<lbrakk>?s6 \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>;\n   ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n   \\<I> \\<turnstile>\n   ?s6\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>{}; proj_unl ?l6 A @\n                                 [send\\<langle>?s6\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                     \\<I>\n  prefix A \\<A>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by metis"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "assume \"a = (\\<star>, b)\""], ["proof (state)\nthis:\n  a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence ***: \"a = (\\<star>, Send t)\" \"t \\<cdot> \\<I> \\<in> GSMP (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l \\<A>)\" for l"], ["proof (prove)\nusing this:\n  a = (\\<star>, b)\n\ngoal (1 subgoal):\n 1. a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) &&&\n    t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "using Send a(1) GSMP_wt_substI[OF _ \\<I>(3,4,2)]"], ["proof (prove)\nusing this:\n  a = (\\<star>, b)\n  b = send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n  \\<A> = A @ [a]\n  ?t \\<in> ?M \\<Longrightarrow> ?t \\<cdot> \\<I> \\<in> GSMP ?M\n\ngoal (1 subgoal):\n 1. a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t) &&&\n    t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l \\<A>))", "by (metis, force)"], ["proof (state)\nthis:\n  a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n\ngoal (1 subgoal):\n 1. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence \"t \\<cdot> \\<I> \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n                   t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n                   t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (prove)\nusing this:\n  a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<I>\n    \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n    t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n    t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}", "using snoc.prems(1) a(1) at_least_2_labels"], ["proof (prove)\nusing this:\n  a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n  par_comp \\<A> Sec\n  \\<A> = A @ [a]\n  label_witness1 \\<noteq> label_witness2\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<I>\n    \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n    t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n    t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}", "unfolding par_comp_def GSMP_disjoint_def"], ["proof (prove)\nusing this:\n  a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>)) \\<inter>\n      GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n      \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}) \\<and>\n  (\\<forall>s\\<in>Sec.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n  ground Sec\n  \\<A> = A @ [a]\n  label_witness1 \\<noteq> label_witness2\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<I>\n    \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n    t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n    t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}", "by blast"], ["proof (state)\nthis:\n  t \\<cdot> \\<I>\n  \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n  t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n  t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. a = (\\<star>, b) \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  t \\<cdot> \\<I>\n  \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n  t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<or>\n  t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "proof (elim disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. t \\<cdot> \\<I>\n    \\<in> Sec -\n          declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. t \\<cdot> \\<I>\n    \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 3. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "assume \"t \\<cdot> \\<I> \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\""], ["proof (state)\nthis:\n  t \\<cdot> \\<I> \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (3 subgoals):\n 1. t \\<cdot> \\<I>\n    \\<in> Sec -\n          declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. t \\<cdot> \\<I>\n    \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 3. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence \"\\<exists>s \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>. \\<exists>l. ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> s\""], ["proof (prove)\nusing this:\n  t \\<cdot> \\<I> \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n       \\<exists>l.\n          ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          \\<I> \\<turnstile>\n          s", "using deduct_proj_lemma ***(2) A a Discl"], ["proof (prove)\nusing this:\n  t \\<cdot> \\<I> \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<lbrakk>\\<forall>l.\n              declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n              \\<subseteq> ik\\<^sub>s\\<^sub>t\n                           (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                          \\<I>;\n   t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj n \\<A>));\n   declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n   \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\\<rbrakk>\n  \\<Longrightarrow> ik\\<^sub>s\\<^sub>t\n                     (proj_unl n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                    \\<I> \\<turnstile>\n                    t \\<cdot> \\<I> \\<or>\n                    (\\<exists>s\\<in>Sec -\n                                    declassified\\<^sub>l\\<^sub>s\\<^sub>t A\n                                     \\<I>.\n                        \\<exists>l.\n                           ik\\<^sub>s\\<^sub>t\n                            (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n                           \\<I> \\<turnstile>\n                           s)\n  t \\<cdot> \\<I> \\<in> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l6 \\<A>))\n  \\<A> = A @ [(ln n, b)] \\<or> \\<A> = A @ [(\\<star>, b)]\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl ?n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              \\<I>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<subseteq> GSMP (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?n A))\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<I>\n  \\<subseteq> Sec \\<union> {m. {} \\<turnstile>\\<^sub>c m}\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t (A @ [a]) \\<I> =\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<union>\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t [a] \\<I>\n\ngoal (1 subgoal):\n 1. \\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n       \\<exists>l.\n          ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n          \\<I> \\<turnstile>\n          s", "by blast"], ["proof (state)\nthis:\n  \\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n     \\<exists>l.\n        ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n        \\<I> \\<turnstile>\n        s\n\ngoal (3 subgoals):\n 1. t \\<cdot> \\<I>\n    \\<in> Sec -\n          declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. t \\<cdot> \\<I>\n    \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 3. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n     \\<exists>l.\n        ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n        \\<I> \\<turnstile>\n        s\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using prefix_A leakage_case"], ["proof (prove)\nusing this:\n  \\<exists>s\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>.\n     \\<exists>l.\n        ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n        \\<I> \\<turnstile>\n        s\n  prefix A \\<A>\n  \\<lbrakk>?s6 \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>;\n   ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n   \\<I> \\<turnstile>\n   ?s6\\<rbrakk>\n  \\<Longrightarrow> \\<lbrakk>{}; proj_unl ?l6 A @\n                                 [send\\<langle>?s6\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                     \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by blast"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (2 subgoals):\n 1. t \\<cdot> \\<I>\n    \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. t \\<cdot> \\<I>\n    \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "assume \"t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\""], ["proof (state)\nthis:\n  t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (2 subgoals):\n 1. t \\<cdot> \\<I>\n    \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence \"ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<I> \\<turnstile> t \\<cdot> \\<I>\" for l"], ["proof (prove)\nusing this:\n  t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I> \\<turnstile>\n    t \\<cdot> \\<I>", "using intruder_deduct.Axiom Discl(1)"], ["proof (prove)\nusing this:\n  t \\<cdot> \\<I> \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  ?t \\<in> ?M \\<Longrightarrow> ?M \\<turnstile> ?t\n  declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I>\n  \\<subseteq> ik\\<^sub>s\\<^sub>t\n               (proj_unl ?n A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n              \\<I>\n\ngoal (1 subgoal):\n 1. ik\\<^sub>s\\<^sub>t (proj_unl l A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n    \\<I> \\<turnstile>\n    t \\<cdot> \\<I>", "by blast"], ["proof (state)\nthis:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I>\n\ngoal (2 subgoals):\n 1. t \\<cdot> \\<I>\n    \\<in> declassified\\<^sub>l\\<^sub>s\\<^sub>t A \\<I> \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))\n 2. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using proj_deduct_case_star[OF ***(1)] a(1)"], ["proof (prove)\nusing this:\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I>\n  ik\\<^sub>s\\<^sub>t (proj_unl ?l6 A) \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n  \\<I> \\<turnstile>\n  t \\<cdot> \\<I> \\<Longrightarrow>\n  \\<lbrakk>{}; proj_unl ?l6 (A @ [a])\\<rbrakk>\\<^sub>d \\<I>\n  \\<A> = A @ [a]\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by fast"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "assume \"t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}\""], ["proof (state)\nthis:\n  t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "hence \"M \\<turnstile> t \\<cdot> \\<I>\" for M"], ["proof (prove)\nusing this:\n  t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. M \\<turnstile> t \\<cdot> \\<I>", "using ideduct_mono[OF deduct_if_synth]"], ["proof (prove)\nusing this:\n  t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m}\n  \\<lbrakk>?M \\<turnstile>\\<^sub>c ?t; ?M \\<subseteq> ?M'\\<rbrakk>\n  \\<Longrightarrow> ?M' \\<turnstile> ?t\n\ngoal (1 subgoal):\n 1. M \\<turnstile> t \\<cdot> \\<I>", "by blast"], ["proof (state)\nthis:\n  ?M6 \\<turnstile> t \\<cdot> \\<I>\n\ngoal (1 subgoal):\n 1. t \\<cdot> \\<I> \\<in> {m. {} \\<turnstile>\\<^sub>c m} \\<Longrightarrow>\n    (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  ?M6 \\<turnstile> t \\<cdot> \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using IH' a(1) ***(1)"], ["proof (prove)\nusing this:\n  ?M6 \\<turnstile> t \\<cdot> \\<I>\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n  \\<A> = A @ [a]\n  a = (\\<star>, send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by fastforce"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (3 subgoals):\n 1. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "case (Receive t)"], ["proof (state)\nthis:\n  b = receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (3 subgoals):\n 1. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "hence \"\\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>\" for l"], ["proof (prove)\nusing this:\n  b = receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>", "using IH' a proj_append(2)[of l A \"[a]\"]"], ["proof (prove)\nusing this:\n  b = receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  proj_unl l (A @ [a]) = proj_unl l A @ proj_unl l [a]\n\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>", "unfolding unlabel_def proj_def"], ["proof (prove)\nusing this:\n  b = receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t\n  \\<forall>l.\n     \\<lbrakk>{}; map snd\n                   (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                     A)\\<rbrakk>\\<^sub>d\n      \\<I>\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  map snd (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s) (A @ [a])) =\n  map snd (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s) A) @\n  map snd (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s) [a])\n\ngoal (1 subgoal):\n 1. \\<lbrakk>{}; map snd\n                  (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                    \\<A>)\\<rbrakk>\\<^sub>d\n     \\<I>", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>{}; proj_unl ?l6 \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (3 subgoals):\n 1. \\<And>x2.\n       b = receive\\<langle>x2\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 3. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>{}; proj_unl ?l6 \\<A>\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by metis"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (2 subgoals):\n 1. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "case (Equality ac t t')"], ["proof (state)\nthis:\n  b = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (2 subgoals):\n 1. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "hence *: \"\\<lbrakk>M; [Equality ac t t']\\<rbrakk>\\<^sub>d \\<I>\" for M"], ["proof (prove)\nusing this:\n  b = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. \\<lbrakk>M; [\\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n     \\<I>", "using a \\<open>\\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<close> unlabel_append[of A \"[a]\"]"], ["proof (prove)\nusing this:\n  b = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n  unlabel (A @ [a]) = unlabel A @ unlabel [a]\n\ngoal (1 subgoal):\n 1. \\<lbrakk>M; [\\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n     \\<I>", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>?M6; [\\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n   \\<I>\n\ngoal (2 subgoals):\n 1. \\<And>x31 x32 x33.\n       b =\n       \\<langle>x31: x32 \\<doteq> x33\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))\n 2. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using a proj_append(2)[of _ A \"[a]\"] Equality\n                strand_sem_append(2)[OF _ *] IH'"], ["proof (prove)\nusing this:\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  proj_unl ?l (A @ [a]) = proj_unl ?l A @ proj_unl ?l [a]\n  b = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n  \\<lbrakk>?M; ?S\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n  \\<lbrakk>?M; ?S @\n               [\\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n   \\<I>\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "unfolding unlabel_def proj_def"], ["proof (prove)\nusing this:\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  map snd\n   (filter (\\<lambda>s. is_LabelN ?l s \\<or> is_LabelS s) (A @ [a])) =\n  map snd (filter (\\<lambda>s. is_LabelN ?l s \\<or> is_LabelS s) A) @\n  map snd (filter (\\<lambda>s. is_LabelN ?l s \\<or> is_LabelS s) [a])\n  b = \\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t\n  \\<lbrakk>?M; ?S\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n  \\<lbrakk>?M; ?S @\n               [\\<langle>ac: t \\<doteq> t'\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n   \\<I>\n  \\<forall>l.\n     \\<lbrakk>{}; map snd\n                   (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                     A)\\<rbrakk>\\<^sub>d\n      \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l.\n        \\<lbrakk>{}; map snd\n                      (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                        \\<A>)\\<rbrakk>\\<^sub>d\n         \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; map snd\n                             (filter\n                               (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                               \\<A>'') @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by auto"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "case (Inequality X F)"], ["proof (state)\nthis:\n  b = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "hence *: \"\\<lbrakk>M; [Inequality X F]\\<rbrakk>\\<^sub>d \\<I>\" for M"], ["proof (prove)\nusing this:\n  b = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n\ngoal (1 subgoal):\n 1. \\<lbrakk>M; [\\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n     \\<I>", "using a \\<open>\\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\\<close> unlabel_append[of A \"[a]\"]"], ["proof (prove)\nusing this:\n  b = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  \\<lbrakk>{}; unlabel \\<A>\\<rbrakk>\\<^sub>d \\<I>\n  unlabel (A @ [a]) = unlabel A @ unlabel [a]\n\ngoal (1 subgoal):\n 1. \\<lbrakk>M; [\\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n     \\<I>", "by auto"], ["proof (state)\nthis:\n  \\<lbrakk>?M6; [\\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n   \\<I>\n\ngoal (1 subgoal):\n 1. \\<And>x41 x42.\n       b =\n       \\<forall>x41\\<langle>\\<or>\\<noteq>: x42\\<rangle>\\<^sub>s\\<^sub>t \\<Longrightarrow>\n       (\\<forall>l.\n           \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n       (\\<exists>\\<A>''.\n           prefix \\<A>'' \\<A> \\<and>\n           (\\<exists>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n               \\<exists>l.\n                  \\<lbrakk>{}; proj_unl l \\<A>'' @\n                               [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                   \\<I>))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "using a proj_append(2)[of _ A \"[a]\"] Inequality\n                strand_sem_append(2)[OF _ *] IH'"], ["proof (prove)\nusing this:\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  proj_unl ?l (A @ [a]) = proj_unl ?l A @ proj_unl ?l [a]\n  b = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  \\<lbrakk>?M; ?S\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n  \\<lbrakk>?M; ?S @\n               [\\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n   \\<I>\n  \\<forall>l. \\<lbrakk>{}; proj_unl l A\\<rbrakk>\\<^sub>d \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; proj_unl l \\<A>'' @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "unfolding unlabel_def proj_def"], ["proof (prove)\nusing this:\n  \\<A> = A @ [a]\n  a = (ln n, b) \\<or> a = (\\<star>, b)\n  map snd\n   (filter (\\<lambda>s. is_LabelN ?l s \\<or> is_LabelS s) (A @ [a])) =\n  map snd (filter (\\<lambda>s. is_LabelN ?l s \\<or> is_LabelS s) A) @\n  map snd (filter (\\<lambda>s. is_LabelN ?l s \\<or> is_LabelS s) [a])\n  b = \\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t\n  \\<lbrakk>?M; ?S\\<rbrakk>\\<^sub>d \\<I> \\<Longrightarrow>\n  \\<lbrakk>?M; ?S @\n               [\\<forall>X\\<langle>\\<or>\\<noteq>: F\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n   \\<I>\n  \\<forall>l.\n     \\<lbrakk>{}; map snd\n                   (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                     A)\\<rbrakk>\\<^sub>d\n      \\<I>\n\ngoal (1 subgoal):\n 1. (\\<forall>l.\n        \\<lbrakk>{}; map snd\n                      (filter (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                        \\<A>)\\<rbrakk>\\<^sub>d\n         \\<I>) \\<or>\n    (\\<exists>\\<A>''.\n        prefix \\<A>'' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n            \\<exists>l.\n               \\<lbrakk>{}; map snd\n                             (filter\n                               (\\<lambda>s. is_LabelN l s \\<or> is_LabelS s)\n                               \\<A>'') @\n                            [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n                \\<I>))", "by auto"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>''.\n      prefix \\<A>'' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec -\n                      declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>'' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>'.\n      prefix \\<A>' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>'.\n      prefix \\<A>' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)", "using \\<I>(1)"], ["proof (prove)\nusing this:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>'.\n      prefix \\<A>' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n  \\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)", "unfolding strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  (\\<forall>l. \\<lbrakk>{}; proj_unl l \\<A>\\<rbrakk>\\<^sub>d \\<I>) \\<or>\n  (\\<exists>\\<A>'.\n      prefix \\<A>' \\<A> \\<and>\n      (\\<exists>t\\<in>Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n          \\<exists>l.\n             \\<lbrakk>{}; proj_unl l \\<A>' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rbrakk>\\<^sub>d\n              \\<I>))\n  \\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\n\ngoal (1 subgoal):\n 1. (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n    (\\<exists>\\<A>'.\n        prefix \\<A>' \\<A> \\<and>\n        (\\<exists>t\\<in>Sec -\n                        declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>.\n            \\<exists>l.\n               \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>' @\n    [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))", "by (simp add: constr_sem_d_def)"], ["proof (state)\nthis:\n  (\\<forall>l. \\<I> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>) \\<or>\n  (\\<exists>\\<A>'.\n      prefix \\<A>' \\<A> \\<and>\n      strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>)\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem par_comp_constr:\n  assumes \\<A>: \"par_comp \\<A> Sec\" \"typing_cond (unlabel \\<A>)\"\n  and \\<I>: \"\\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\"\n  shows \"\\<exists>\\<I>\\<^sub>\\<tau>. interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>) \\<and> (\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>) \\<and>\n              ((\\<forall>l. (\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l \\<A>\\<rangle>)) \\<or> (\\<exists>\\<A>'. prefix \\<A>' \\<A> \\<and> (strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n       ((\\<forall>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n               \\<A>\\<rangle>) \\<or>\n        (\\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n       ((\\<forall>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n               \\<A>\\<rangle>) \\<or>\n        (\\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>))", "from \\<A>(2)"], ["proof (chain)\npicking this:\n  typing_cond (unlabel \\<A>)", "have *:\n      \"wf\\<^sub>s\\<^sub>t {} (unlabel \\<A>)\"\n      \"fv\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<inter> bvars\\<^sub>s\\<^sub>t (unlabel \\<A>) = {}\"\n      \"tfr\\<^sub>s\\<^sub>t (unlabel \\<A>)\"\n      \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>s\\<^sub>t (unlabel \\<A>))\"\n      \"Ana_invar_subst (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union> assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\""], ["proof (prove)\nusing this:\n  typing_cond (unlabel \\<A>)\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A> &&&\n     fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n     bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n     {}) &&&\n    tfr\\<^sub>s\\<^sub>t (unlabel \\<A>) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) &&&\n    Ana_invar_subst\n     (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n      assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))", "unfolding typing_cond_def tfr\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A> \\<and>\n  fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n  bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n  {} \\<and>\n  (tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<and>\n   list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)) \\<and>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<and>\n  Ana_invar_subst\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A> &&&\n     fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n     bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n     {}) &&&\n    tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<and>\n    list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) &&&\n    Ana_invar_subst\n     (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n      assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))", "by metis+"], ["proof (state)\nthis:\n  wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A>\n  fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n  bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n  {}\n  tfr\\<^sub>s\\<^sub>t (unlabel \\<A>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  Ana_invar_subst\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n\ngoal (1 subgoal):\n 1. \\<exists>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n       ((\\<forall>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n               \\<A>\\<rangle>) \\<or>\n        (\\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>))", "obtain \\<I>\\<^sub>\\<tau> where \\<I>\\<^sub>\\<tau>: \"\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\" \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<I>\\<^sub>\\<tau>.\n        \\<lbrakk>\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel\n                    \\<A>\\<rangle>;\n         subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n         ground (subst_range \\<I>\\<^sub>\\<tau>);\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n          (subst_range \\<I>\\<^sub>\\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using wt_attack_if_tfr_attack_d[OF * \\<I>(2,1)]"], ["proof (prove)\nusing this:\n  \\<exists>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<I>\\<^sub>\\<tau>.\n        \\<lbrakk>\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel\n                    \\<A>\\<rangle>;\n         subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n         ground (subst_range \\<I>\\<^sub>\\<tau>);\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n          (subst_range \\<I>\\<^sub>\\<tau>)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\n  subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n  ground (subst_range \\<I>\\<^sub>\\<tau>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n       ((\\<forall>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n               \\<A>\\<rangle>) \\<or>\n        (\\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n       ((\\<forall>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n               \\<A>\\<rangle>) \\<or>\n        (\\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>))", "using par_comp_constr_typed[OF \\<A>(1) \\<I>\\<^sub>\\<tau>] \\<I>\\<^sub>\\<tau>"], ["proof (prove)\nusing this:\n  (\\<forall>l.\n      \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n         \\<A>\\<rangle>) \\<or>\n  (\\<exists>\\<A>'.\n      prefix \\<A>' \\<A> \\<and>\n      strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>)\n  \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\n  subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n  ground (subst_range \\<I>\\<^sub>\\<tau>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n       ((\\<forall>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n               \\<A>\\<rangle>) \\<or>\n        (\\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>))", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n     \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n     ((\\<forall>l.\n          \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n             \\<A>\\<rangle>) \\<or>\n      (\\<exists>\\<A>'.\n          prefix \\<A>' \\<A> \\<and>\n          strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>))\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Theorem: Parallel Compositionality for Labeled Protocols\\<close>"], ["", "subsubsection \\<open>Definitions: Labeled Protocols\\<close>"], ["", "text \\<open>\n  We state our result on the level of protocol traces (i.e., the constraints reachable in a\n  symbolic execution of the actual protocol). Hence, we do not need to convert protocol strands\n  to intruder constraints in the following well-formedness definitions.\n\\<close>"], ["", "definition wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s::\"('fun,'var,'lbl) labeled_strand set \\<Rightarrow> bool\" where\n  \"wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s \\<S> \\<equiv> (\\<forall>\\<A> \\<in> \\<S>. wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A>) \\<and> (\\<forall>\\<A> \\<in> \\<S>. \\<forall>\\<A>' \\<in> \\<S>. fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter> bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' = {})\""], ["", "definition wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s'::\"('fun,'var,'lbl) labeled_strand set \\<Rightarrow> ('fun,'var,'lbl) labeled_strand \\<Rightarrow> bool\"\nwhere\n  \"wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s' \\<S> \\<A> \\<equiv> (\\<forall>\\<A>' \\<in> \\<S>. wf\\<^sub>s\\<^sub>t (wfrestrictedvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) (unlabel \\<A>')) \\<and>\n                 (\\<forall>\\<A>' \\<in> \\<S>. \\<forall>\\<A>'' \\<in> \\<S>. fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<inter> bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'' = {}) \\<and>\n                 (\\<forall>\\<A>' \\<in> \\<S>. fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<inter> bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> = {}) \\<and>\n                 (\\<forall>\\<A>' \\<in> \\<S>. fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter> bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' = {})\""], ["", "definition typing_cond_prot where\n  \"typing_cond_prot \\<P> \\<equiv>\n    wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s \\<P> \\<and>\n    tfr\\<^sub>s\\<^sub>e\\<^sub>t (\\<Union>(trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<Union>(trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n    (\\<forall>\\<A> \\<in> \\<P>. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)) \\<and>\n    Ana_invar_subst (\\<Union>(ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union> \\<Union>(assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\""], ["", "definition par_comp_prot where\n  \"par_comp_prot \\<P> Sec \\<equiv>\n    (\\<forall>l1 l2. l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP_disjoint (\\<Union>\\<A> \\<in> \\<P>. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (\\<Union>\\<A> \\<in> \\<P>. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec) \\<and>\n    ground Sec \\<and> (\\<forall>s \\<in> Sec. \\<forall>s' \\<in> subterms s. {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n    typing_cond_prot \\<P>\""], ["", "subsubsection \\<open>Lemmata: Labeled Protocols\\<close>"], ["", "lemma wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s_eqs_wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s'[simp]: \"wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s S = wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s' S []\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s S =\n    wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s' S []", "unfolding wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s_def wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s'_def unlabel_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<forall>\\<A>\\<in>S. wf\\<^sub>s\\<^sub>t {} (map snd \\<A>)) \\<and>\n     (\\<forall>\\<A>\\<in>S.\n         \\<forall>\\<A>'\\<in>S.\n            fv\\<^sub>s\\<^sub>t (map snd \\<A>) \\<inter>\n            bvars\\<^sub>s\\<^sub>t (map snd \\<A>') =\n            {})) =\n    ((\\<forall>\\<A>'\\<in>S.\n         wf\\<^sub>s\\<^sub>t (wfrestrictedvars\\<^sub>s\\<^sub>t (map snd []))\n          (map snd \\<A>')) \\<and>\n     (\\<forall>\\<A>'\\<in>S.\n         \\<forall>\\<A>''\\<in>S.\n            fv\\<^sub>s\\<^sub>t (map snd \\<A>') \\<inter>\n            bvars\\<^sub>s\\<^sub>t (map snd \\<A>'') =\n            {}) \\<and>\n     (\\<forall>\\<A>'\\<in>S.\n         fv\\<^sub>s\\<^sub>t (map snd \\<A>') \\<inter>\n         bvars\\<^sub>s\\<^sub>t (map snd []) =\n         {}) \\<and>\n     (\\<forall>\\<A>'\\<in>S.\n         fv\\<^sub>s\\<^sub>t (map snd []) \\<inter>\n         bvars\\<^sub>s\\<^sub>t (map snd \\<A>') =\n         {}))", "by auto"], ["", "lemma par_comp_prot_impl_par_comp:\n  assumes \"par_comp_prot \\<P> Sec\" \"\\<A> \\<in> \\<P>\"\n  shows \"par_comp \\<A> Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "have *: \"\\<forall>l1 l2. l1 \\<noteq> l2 \\<longrightarrow>\n              GSMP_disjoint (\\<Union>\\<A> \\<in> \\<P>. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (\\<Union>\\<A> \\<in> \\<P>. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint\n        (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n        (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n        Sec", "using assms(1)"], ["proof (prove)\nusing this:\n  par_comp_prot \\<P> Sec\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint\n        (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n        (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n        Sec", "unfolding par_comp_prot_def"], ["proof (prove)\nusing this:\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP_disjoint\n       (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n       (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n       Sec) \\<and>\n  ground Sec \\<and>\n  (\\<forall>s\\<in>Sec.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n  typing_cond_prot \\<P>\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint\n        (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n        (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n        Sec", "by metis"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint\n      (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n      Sec\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "{"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint\n      (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n      Sec\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "fix l1 l2::'lbl"], ["proof (state)\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "assume **: \"l1 \\<noteq> l2\""], ["proof (state)\nthis:\n  l1 \\<noteq> l2\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "hence ***: \"GSMP_disjoint (\\<Union>\\<A> \\<in> \\<P>. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (\\<Union>\\<A> \\<in> \\<P>. trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec\""], ["proof (prove)\nusing this:\n  l1 \\<noteq> l2\n\ngoal (1 subgoal):\n 1. GSMP_disjoint\n     (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n     (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n     Sec", "using *"], ["proof (prove)\nusing this:\n  l1 \\<noteq> l2\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint\n      (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n      Sec\n\ngoal (1 subgoal):\n 1. GSMP_disjoint\n     (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n     (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n     Sec", "by auto"], ["proof (state)\nthis:\n  GSMP_disjoint\n   (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n   (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "have \"GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "using GSMP_disjoint_subset[OF ***] assms(2)"], ["proof (prove)\nusing this:\n  \\<lbrakk>?L'\n           \\<subseteq> (\\<Union>\\<A>\\<in>\\<P>.\n                           trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>));\n   ?R'\n   \\<subseteq> (\\<Union>\\<A>\\<in>\\<P>.\n                   trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\\<rbrakk>\n  \\<Longrightarrow> GSMP_disjoint ?L' ?R' Sec\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "by auto"], ["proof (state)\nthis:\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "}"], ["proof (state)\nthis:\n  ?l1.8 \\<noteq> ?l2.8 \\<Longrightarrow>\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "hence \"\\<forall>l1 l2. l1 \\<noteq> l2 \\<longrightarrow> GSMP_disjoint (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l1 \\<A>) (trms_proj\\<^sub>l\\<^sub>s\\<^sub>t l2 \\<A>) Sec\""], ["proof (prove)\nusing this:\n  ?l1.8 \\<noteq> ?l2.8 \\<Longrightarrow>\n  GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l1.8 \\<A>))\n   (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj ?l2.8 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. \\<forall>l1 l2.\n       l1 \\<noteq> l2 \\<longrightarrow>\n       GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n        (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec", "by metis"], ["proof (state)\nthis:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n  par_comp_prot \\<P> Sec\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec", "unfolding par_comp_prot_def par_comp_def"], ["proof (prove)\nusing this:\n  \\<forall>l1 l2.\n     l1 \\<noteq> l2 \\<longrightarrow>\n     GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n      (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP_disjoint\n       (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n       (\\<Union>\\<A>\\<in>\\<P>. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n       Sec) \\<and>\n  ground Sec \\<and>\n  (\\<forall>s\\<in>Sec.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n  typing_cond_prot \\<P>\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. (\\<forall>l1 l2.\n        l1 \\<noteq> l2 \\<longrightarrow>\n        GSMP_disjoint (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n         (trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>)) Sec) \\<and>\n    (\\<forall>s\\<in>Sec.\n        \\<forall>s'\\<in>subterms s.\n           {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n    ground Sec", "by metis"], ["proof (state)\nthis:\n  par_comp \\<A> Sec\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma typing_cond_prot_impl_typing_cond:\n  assumes \"typing_cond_prot \\<P>\" \"\\<A> \\<in> \\<P>\"\n  shows \"typing_cond (unlabel \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "have 1: \"wf\\<^sub>s\\<^sub>t {} (unlabel \\<A>)\" \"fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter> bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A> &&&\n    fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n    bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n    {}", "using assms"], ["proof (prove)\nusing this:\n  typing_cond_prot \\<P>\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A> &&&\n    fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n    bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n    {}", "unfolding typing_cond_prot_def wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s_def"], ["proof (prove)\nusing this:\n  ((\\<forall>\\<A>\\<in>\\<P>. wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A>) \\<and>\n   (\\<forall>\\<A>\\<in>\\<P>.\n       \\<forall>\\<A>'\\<in>\\<P>.\n          fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n          bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' =\n          {})) \\<and>\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  (\\<forall>\\<A>\\<in>\\<P>.\n      list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)) \\<and>\n  Ana_invar_subst\n   (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n    \\<Union> (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A> &&&\n    fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n    bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n    {}", "by auto"], ["proof (state)\nthis:\n  wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A>\n  fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n  bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n  {}\n\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "have \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (\\<Union>(trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\"\n       \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (\\<Union>(trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\"\n       \"trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<subseteq> \\<Union>(trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)\"\n       \"SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - Var`\\<V> \\<subseteq> SMP (\\<Union>(trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) - Var`\\<V>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (tfr\\<^sub>s\\<^sub>e\\<^sub>t\n      (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) &&&\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))) &&&\n    trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n    \\<subseteq> \\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>) &&&\n    SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var\n    \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n                range Var", "using assms SMP_mono[of \"trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\" \"\\<Union>(trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)\"]"], ["proof (prove)\nusing this:\n  typing_cond_prot \\<P>\n  \\<A> \\<in> \\<P>\n  trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n  \\<subseteq> \\<Union>\n               (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>) \\<Longrightarrow>\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\n\ngoal (1 subgoal):\n 1. (tfr\\<^sub>s\\<^sub>e\\<^sub>t\n      (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) &&&\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))) &&&\n    trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n    \\<subseteq> \\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>) &&&\n    SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var\n    \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n                range Var", "unfolding typing_cond_prot_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s \\<P> \\<and>\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  (\\<forall>\\<A>\\<in>\\<P>.\n      list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)) \\<and>\n  Ana_invar_subst\n   (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n    \\<Union> (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\n  \\<A> \\<in> \\<P>\n  trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n  \\<subseteq> \\<Union>\n               (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>) \\<Longrightarrow>\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\n\ngoal (1 subgoal):\n 1. (tfr\\<^sub>s\\<^sub>e\\<^sub>t\n      (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) &&&\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))) &&&\n    trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n    \\<subseteq> \\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>) &&&\n    SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var\n    \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n                range Var", "by (metis, metis, auto)"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\n  trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n  \\<subseteq> \\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var\n  \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n              range Var\n\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "hence 2: \"tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\" and 3: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\""], ["proof (prove)\nusing this:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\n  trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n  \\<subseteq> \\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var\n  \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n              range Var\n\ngoal (1 subgoal):\n 1. tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "unfolding tfr\\<^sub>s\\<^sub>e\\<^sub>t_def"], ["proof (prove)\nusing this:\n  \\<forall>s\\<in>SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n                 range Var.\n     \\<forall>t\\<in>SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n                    range Var.\n        (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n        \\<Gamma> s = \\<Gamma> t\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>))\n  trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>\n  \\<subseteq> \\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)\n  SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var\n  \\<subseteq> SMP (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) -\n              range Var\n\ngoal (1 subgoal):\n 1. \\<forall>s\\<in>SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var.\n       \\<forall>t\\<in>SMP (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) - range Var.\n          (\\<exists>\\<delta>. Unifier \\<delta> s t) \\<longrightarrow>\n          \\<Gamma> s = \\<Gamma> t &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)", "by (meson subsetD)+"], ["proof (state)\nthis:\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "have 4: \"list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)", "using assms"], ["proof (prove)\nusing this:\n  typing_cond_prot \\<P>\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)", "unfolding typing_cond_prot_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s \\<P> \\<and>\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  (\\<forall>\\<A>\\<in>\\<P>.\n      list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)) \\<and>\n  Ana_invar_subst\n   (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n    \\<Union> (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)", "by auto"], ["proof (state)\nthis:\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)\n\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "have \"subterms\\<^sub>s\\<^sub>e\\<^sub>t (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union> assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>)) \\<subseteq>\n        subterms\\<^sub>s\\<^sub>e\\<^sub>t (\\<Union>(ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union> \\<Union>(assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n      assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n    \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                 (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n                  \\<Union>\n                   (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))", "using assms(2)"], ["proof (prove)\nusing this:\n  \\<A> \\<in> \\<P>\n\ngoal (1 subgoal):\n 1. subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n      assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n    \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n                 (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n                  \\<Union>\n                   (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))", "by auto"], ["proof (state)\nthis:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n  \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n               (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n                \\<Union> (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\n\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "hence 5: \"Ana_invar_subst (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union> assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\""], ["proof (prove)\nusing this:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n  \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n               (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n                \\<Union> (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\n\ngoal (1 subgoal):\n 1. Ana_invar_subst\n     (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n      assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))", "using assms SMP_mono"], ["proof (prove)\nusing this:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n  \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n               (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n                \\<Union> (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\n  typing_cond_prot \\<P>\n  \\<A> \\<in> \\<P>\n  ?A \\<subseteq> ?B \\<Longrightarrow> SMP ?A \\<subseteq> SMP ?B\n\ngoal (1 subgoal):\n 1. Ana_invar_subst\n     (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n      assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))", "unfolding typing_cond_prot_def Ana_invar_subst_def"], ["proof (prove)\nusing this:\n  subterms\\<^sub>s\\<^sub>e\\<^sub>t\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n  \\<subseteq> subterms\\<^sub>s\\<^sub>e\\<^sub>t\n               (\\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n                \\<Union> (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>))\n  wf\\<^sub>l\\<^sub>s\\<^sub>t\\<^sub>s \\<P> \\<and>\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (\\<Union> (trms\\<^sub>l\\<^sub>s\\<^sub>t ` \\<P>)) \\<and>\n  (\\<forall>\\<A>\\<in>\\<P>.\n      list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)) \\<and>\n  (\\<forall>f T K M \\<delta>.\n      Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n      \\<Union> (ik\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<union>\n      \\<Union>\n       (assignment_rhs\\<^sub>s\\<^sub>t ` unlabel ` \\<P>) \\<longrightarrow>\n      Ana (Fun f T) = (K, M) \\<longrightarrow>\n      Ana (Fun f T \\<cdot> \\<delta>) =\n      (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n       M \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  \\<A> \\<in> \\<P>\n  ?A \\<subseteq> ?B \\<Longrightarrow> SMP ?A \\<subseteq> SMP ?B\n\ngoal (1 subgoal):\n 1. \\<forall>f T K M \\<delta>.\n       Fun f T \\<sqsubseteq>\\<^sub>s\\<^sub>e\\<^sub>t\n       ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n       assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<longrightarrow>\n       Ana (Fun f T) = (K, M) \\<longrightarrow>\n       Ana (Fun f T \\<cdot> \\<delta>) =\n       (K \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>,\n        M \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)", "by (meson subsetD)"], ["proof (state)\nthis:\n  Ana_invar_subst\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "using 1 2 3 4 5"], ["proof (prove)\nusing this:\n  wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A>\n  fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n  bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n  {}\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)\n  Ana_invar_subst\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n\ngoal (1 subgoal):\n 1. typing_cond (unlabel \\<A>)", "unfolding typing_cond_def tfr\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A>\n  fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n  bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n  {}\n  tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>)\n  list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)\n  Ana_invar_subst\n   (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n    assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))\n\ngoal (1 subgoal):\n 1. wf\\<^sub>l\\<^sub>s\\<^sub>t {} \\<A> \\<and>\n    fv\\<^sub>l\\<^sub>s\\<^sub>t \\<A> \\<inter>\n    bvars\\<^sub>l\\<^sub>s\\<^sub>t \\<A> =\n    {} \\<and>\n    (tfr\\<^sub>s\\<^sub>e\\<^sub>t (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<and>\n     list_all tfr\\<^sub>s\\<^sub>t\\<^sub>p (unlabel \\<A>)) \\<and>\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n     (trms\\<^sub>l\\<^sub>s\\<^sub>t \\<A>) \\<and>\n    Ana_invar_subst\n     (ik\\<^sub>s\\<^sub>t (unlabel \\<A>) \\<union>\n      assignment_rhs\\<^sub>s\\<^sub>t (unlabel \\<A>))", "by blast"], ["proof (state)\nthis:\n  typing_cond (unlabel \\<A>)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsubsection \\<open>Theorem: Parallel Compositionality for Labeled Protocols\\<close>"], ["", "definition component_prot where\n  \"component_prot n P \\<equiv> (\\<forall>l \\<in> P. \\<forall>s \\<in> set l. is_LabelN n s \\<or> is_LabelS s)\""], ["", "definition composed_prot where\n  \"composed_prot \\<P>\\<^sub>i \\<equiv> {\\<A>. \\<forall>n. proj n \\<A> \\<in> \\<P>\\<^sub>i n}\""], ["", "definition component_secure_prot where\n  \"component_secure_prot n P Sec attack \\<equiv> (\\<forall>\\<A> \\<in> P. suffix [(ln n, Send (Fun attack []))] \\<A> \\<longrightarrow> \n     (\\<forall>\\<I>\\<^sub>\\<tau>. (interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)) \\<longrightarrow>\n            \\<not>(\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n \\<A>\\<rangle>) \\<and>\n            (\\<forall>\\<A>'. prefix \\<A>' \\<A> \\<longrightarrow>\n                    (\\<forall>t \\<in> Sec-declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>\\<^sub>\\<tau>. \\<not>(\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n \\<A>'@[Send t]\\<rangle>)))))\""], ["", "definition component_leaks where\n  \"component_leaks n \\<A> Sec \\<equiv> (\\<exists>\\<A>' \\<I>\\<^sub>\\<tau>. interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n      prefix \\<A>' \\<A> \\<and> (\\<exists>t \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>\\<^sub>\\<tau>. (\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n \\<A>'@[Send t]\\<rangle>)))\""], ["", "definition unsat where\n  \"unsat \\<A> \\<equiv> (\\<forall>\\<I>. interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I> \\<longrightarrow> \\<not>(\\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>))\""], ["", "theorem par_comp_constr_prot:\n  assumes P: \"P = composed_prot Pi\" \"par_comp_prot P Sec\" \"\\<forall>n. component_prot n (Pi n)\"\n  and left_secure: \"component_secure_prot n (Pi n) Sec attack\"\n  shows \"\\<forall>\\<A> \\<in> P. suffix [(ln n, Send (Fun attack []))] \\<A> \\<longrightarrow>\n                  unsat \\<A> \\<or> (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "fix \\<A> \\<A>'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "assume \\<A>: \"\\<A> = \\<A>'@[(ln n, Send (Fun attack []))]\" \"\\<A> \\<in> P\""], ["proof (state)\nthis:\n  \\<A> =\n  \\<A>' @ [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  \\<A> \\<in> P\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "let ?P = \"\\<exists>\\<A>' \\<I>\\<^sub>\\<tau>. interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>) \\<and> prefix \\<A>' \\<A> \\<and>\n                   (\\<exists>t \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>\\<^sub>\\<tau>. \\<exists>m. n \\<noteq> m \\<and> (\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>'@[Send t]\\<rangle>))\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "have tcp: \"typing_cond_prot P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. typing_cond_prot P", "using P(2)"], ["proof (prove)\nusing this:\n  par_comp_prot P Sec\n\ngoal (1 subgoal):\n 1. typing_cond_prot P", "unfolding par_comp_prot_def"], ["proof (prove)\nusing this:\n  (\\<forall>l1 l2.\n      l1 \\<noteq> l2 \\<longrightarrow>\n      GSMP_disjoint\n       (\\<Union>\\<A>\\<in>P. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l1 \\<A>))\n       (\\<Union>\\<A>\\<in>P. trms\\<^sub>l\\<^sub>s\\<^sub>t (proj l2 \\<A>))\n       Sec) \\<and>\n  ground Sec \\<and>\n  (\\<forall>s\\<in>Sec.\n      \\<forall>s'\\<in>subterms s.\n         {} \\<turnstile>\\<^sub>c s' \\<or> s' \\<in> Sec) \\<and>\n  typing_cond_prot P\n\ngoal (1 subgoal):\n 1. typing_cond_prot P", "by simp"], ["proof (state)\nthis:\n  typing_cond_prot P\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "have par_comp: \"par_comp \\<A> Sec\" \"typing_cond (unlabel \\<A>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec &&& typing_cond (unlabel \\<A>)", "using par_comp_prot_impl_par_comp[OF P(2) \\<A>(2)]\n            typing_cond_prot_impl_typing_cond[OF tcp \\<A>(2)]"], ["proof (prove)\nusing this:\n  par_comp \\<A> Sec\n  typing_cond (unlabel \\<A>)\n\ngoal (1 subgoal):\n 1. par_comp \\<A> Sec &&& typing_cond (unlabel \\<A>)", "by metis+"], ["proof (state)\nthis:\n  par_comp \\<A> Sec\n  typing_cond (unlabel \\<A>)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "have \"unlabel (proj n \\<A>) = proj_unl n \\<A>\" \"proj_unl n \\<A> = proj_unl n (proj n \\<A>)\"\n         \"\\<And>A. A \\<in> Pi n \\<Longrightarrow> proj n A = A\" \n         \"proj n \\<A> = (proj n \\<A>')@[(ln n, Send (Fun attack []))]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (proj_unl n \\<A> = proj_unl n \\<A> &&&\n     proj_unl n \\<A> = proj_unl n (proj n \\<A>)) &&&\n    (\\<And>A. A \\<in> Pi n \\<Longrightarrow> proj n A = A) &&&\n    proj n \\<A> =\n    proj n \\<A>' @\n    [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]", "using P(1,3) \\<A>"], ["proof (prove)\nusing this:\n  P = composed_prot Pi\n  \\<forall>n. component_prot n (Pi n)\n  \\<A> =\n  \\<A>' @ [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  \\<A> \\<in> P\n\ngoal (1 subgoal):\n 1. (proj_unl n \\<A> = proj_unl n \\<A> &&&\n     proj_unl n \\<A> = proj_unl n (proj n \\<A>)) &&&\n    (\\<And>A. A \\<in> Pi n \\<Longrightarrow> proj n A = A) &&&\n    proj n \\<A> =\n    proj n \\<A>' @\n    [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]", "by (auto simp add: proj_def unlabel_def component_prot_def composed_prot_def)"], ["proof (state)\nthis:\n  proj_unl n \\<A> = proj_unl n \\<A>\n  proj_unl n \\<A> = proj_unl n (proj n \\<A>)\n  ?A7 \\<in> Pi n \\<Longrightarrow> proj n ?A7 = ?A7\n  proj n \\<A> =\n  proj n \\<A>' @\n  [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "moreover"], ["proof (state)\nthis:\n  proj_unl n \\<A> = proj_unl n \\<A>\n  proj_unl n \\<A> = proj_unl n (proj n \\<A>)\n  ?A7 \\<in> Pi n \\<Longrightarrow> proj n ?A7 = ?A7\n  proj n \\<A> =\n  proj n \\<A>' @\n  [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "have \"proj n \\<A> \\<in> Pi n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. proj n \\<A> \\<in> Pi n", "using P(1) \\<A>"], ["proof (prove)\nusing this:\n  P = composed_prot Pi\n  \\<A> =\n  \\<A>' @ [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  \\<A> \\<in> P\n\ngoal (1 subgoal):\n 1. proj n \\<A> \\<in> Pi n", "unfolding composed_prot_def"], ["proof (prove)\nusing this:\n  P = {\\<A>. \\<forall>n. proj n \\<A> \\<in> Pi n}\n  \\<A> =\n  \\<A>' @ [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  \\<A> \\<in> P\n\ngoal (1 subgoal):\n 1. proj n \\<A> \\<in> Pi n", "by blast"], ["proof (state)\nthis:\n  proj n \\<A> \\<in> Pi n\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "moreover"], ["proof (state)\nthis:\n  proj n \\<A> \\<in> Pi n\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "{"], ["proof (state)\nthis:\n  proj n \\<A> \\<in> Pi n\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "fix A"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "assume \"prefix A \\<A>\""], ["proof (state)\nthis:\n  prefix A \\<A>\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "hence *: \"prefix (proj n A) (proj n \\<A>)\""], ["proof (prove)\nusing this:\n  prefix A \\<A>\n\ngoal (1 subgoal):\n 1. prefix (proj n A) (proj n \\<A>)", "unfolding proj_def prefix_def"], ["proof (prove)\nusing this:\n  \\<exists>zs. \\<A> = A @ zs\n\ngoal (1 subgoal):\n 1. \\<exists>zs.\n       filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s) \\<A> =\n       filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s) A @ zs", "by force"], ["proof (state)\nthis:\n  prefix (proj n A) (proj n \\<A>)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "hence \"proj_unl n A = proj_unl n (proj n A)\"\n            \"\\<forall>I. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I = declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I\""], ["proof (prove)\nusing this:\n  prefix (proj n A) (proj n \\<A>)\n\ngoal (1 subgoal):\n 1. proj_unl n A = proj_unl n (proj n A) &&&\n    \\<forall>I.\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n       declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I", "unfolding proj_def declassified\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  prefix (filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s) A)\n   (filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s) \\<A>)\n\ngoal (1 subgoal):\n 1. unlabel (filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s) A) =\n    unlabel\n     (filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s)\n       (filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s) A)) &&&\n    \\<forall>I.\n       {t. (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n           \\<in> set A} \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n       I =\n       {t. (\\<star>, receive\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t)\n           \\<in> set (filter (\\<lambda>s. is_LabelN n s \\<or> is_LabelS s)\n                       A)} \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t\n       I", "by auto"], ["proof (state)\nthis:\n  proj_unl n A = proj_unl n (proj n A)\n  \\<forall>I.\n     declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n     declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "hence \"\\<exists>B. prefix B (proj n \\<A>) \\<and> proj_unl n A = proj_unl n B \\<and>\n                 (\\<forall>I. declassified\\<^sub>l\\<^sub>s\\<^sub>t A I = declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)\""], ["proof (prove)\nusing this:\n  proj_unl n A = proj_unl n (proj n A)\n  \\<forall>I.\n     declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n     declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I\n\ngoal (1 subgoal):\n 1. \\<exists>B.\n       prefix B (proj n \\<A>) \\<and>\n       proj_unl n A = proj_unl n B \\<and>\n       (\\<forall>I.\n           declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n           declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)", "using *"], ["proof (prove)\nusing this:\n  proj_unl n A = proj_unl n (proj n A)\n  \\<forall>I.\n     declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n     declassified\\<^sub>l\\<^sub>s\\<^sub>t (proj n A) I\n  prefix (proj n A) (proj n \\<A>)\n\ngoal (1 subgoal):\n 1. \\<exists>B.\n       prefix B (proj n \\<A>) \\<and>\n       proj_unl n A = proj_unl n B \\<and>\n       (\\<forall>I.\n           declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n           declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)", "by metis"], ["proof (state)\nthis:\n  \\<exists>B.\n     prefix B (proj n \\<A>) \\<and>\n     proj_unl n A = proj_unl n B \\<and>\n     (\\<forall>I.\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t A I =\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "}"], ["proof (state)\nthis:\n  prefix ?A12 \\<A> \\<Longrightarrow>\n  \\<exists>B.\n     prefix B (proj n \\<A>) \\<and>\n     proj_unl n ?A12 = proj_unl n B \\<and>\n     (\\<forall>I.\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A12 I =\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "ultimately"], ["proof (chain)\npicking this:\n  proj_unl n \\<A> = proj_unl n \\<A>\n  proj_unl n \\<A> = proj_unl n (proj n \\<A>)\n  ?A7 \\<in> Pi n \\<Longrightarrow> proj n ?A7 = ?A7\n  proj n \\<A> =\n  proj n \\<A>' @\n  [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  proj n \\<A> \\<in> Pi n\n  prefix ?A12 \\<A> \\<Longrightarrow>\n  \\<exists>B.\n     prefix B (proj n \\<A>) \\<and>\n     proj_unl n ?A12 = proj_unl n B \\<and>\n     (\\<forall>I.\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A12 I =\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)", "have *: \n        \"\\<forall>\\<I>\\<^sub>\\<tau>. interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n                  \\<not>(\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n \\<A>\\<rangle>) \\<and> (\\<forall>\\<A>'. prefix \\<A>' \\<A> \\<longrightarrow>\n                        (\\<forall>t \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>\\<^sub>\\<tau>. \\<not>(\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n \\<A>'@[Send t]\\<rangle>)))\""], ["proof (prove)\nusing this:\n  proj_unl n \\<A> = proj_unl n \\<A>\n  proj_unl n \\<A> = proj_unl n (proj n \\<A>)\n  ?A7 \\<in> Pi n \\<Longrightarrow> proj n ?A7 = ?A7\n  proj n \\<A> =\n  proj n \\<A>' @\n  [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  proj n \\<A> \\<in> Pi n\n  prefix ?A12 \\<A> \\<Longrightarrow>\n  \\<exists>B.\n     prefix B (proj n \\<A>) \\<and>\n     proj_unl n ?A12 = proj_unl n B \\<and>\n     (\\<forall>I.\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A12 I =\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n       \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                 \\<A>\\<rangle> \\<and>\n       (\\<forall>\\<A>'.\n           prefix \\<A>' \\<A> \\<longrightarrow>\n           (\\<forall>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                            \\<I>\\<^sub>\\<tau>.\n               \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                         \\<A>' @\n                        [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))", "using left_secure"], ["proof (prove)\nusing this:\n  proj_unl n \\<A> = proj_unl n \\<A>\n  proj_unl n \\<A> = proj_unl n (proj n \\<A>)\n  ?A7 \\<in> Pi n \\<Longrightarrow> proj n ?A7 = ?A7\n  proj n \\<A> =\n  proj n \\<A>' @\n  [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  proj n \\<A> \\<in> Pi n\n  prefix ?A12 \\<A> \\<Longrightarrow>\n  \\<exists>B.\n     prefix B (proj n \\<A>) \\<and>\n     proj_unl n ?A12 = proj_unl n B \\<and>\n     (\\<forall>I.\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A12 I =\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)\n  component_secure_prot n (Pi n) Sec attack\n\ngoal (1 subgoal):\n 1. \\<forall>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n       \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                 \\<A>\\<rangle> \\<and>\n       (\\<forall>\\<A>'.\n           prefix \\<A>' \\<A> \\<longrightarrow>\n           (\\<forall>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                            \\<I>\\<^sub>\\<tau>.\n               \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                         \\<A>' @\n                        [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))", "unfolding component_secure_prot_def composed_prot_def suffix_def"], ["proof (prove)\nusing this:\n  proj_unl n \\<A> = proj_unl n \\<A>\n  proj_unl n \\<A> = proj_unl n (proj n \\<A>)\n  ?A7 \\<in> Pi n \\<Longrightarrow> proj n ?A7 = ?A7\n  proj n \\<A> =\n  proj n \\<A>' @\n  [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n  proj n \\<A> \\<in> Pi n\n  prefix ?A12 \\<A> \\<Longrightarrow>\n  \\<exists>B.\n     prefix B (proj n \\<A>) \\<and>\n     proj_unl n ?A12 = proj_unl n B \\<and>\n     (\\<forall>I.\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t ?A12 I =\n         declassified\\<^sub>l\\<^sub>s\\<^sub>t B I)\n  \\<forall>\\<A>\\<in>Pi n.\n     (\\<exists>zs.\n         \\<A> =\n         zs @\n         [(ln n,\n           send\\<langle>Fun attack\n                         []\\<rangle>\\<^sub>s\\<^sub>t)]) \\<longrightarrow>\n     (\\<forall>\\<I>\\<^sub>\\<tau>.\n         (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n          ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n          (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n         \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                   \\<A>\\<rangle> \\<and>\n         (\\<forall>\\<A>'.\n             prefix \\<A>' \\<A> \\<longrightarrow>\n             (\\<forall>t\\<in>Sec -\n                             declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                              \\<I>\\<^sub>\\<tau>.\n                 \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                           \\<A>' @\n                          [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n       \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                 \\<A>\\<rangle> \\<and>\n       (\\<forall>\\<A>'.\n           prefix \\<A>' \\<A> \\<longrightarrow>\n           (\\<forall>t\\<in>Sec -\n                           declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                            \\<I>\\<^sub>\\<tau>.\n               \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                         \\<A>' @\n                        [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))", "by metis"], ["proof (state)\nthis:\n  \\<forall>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n     \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n               \\<A>\\<rangle> \\<and>\n     (\\<forall>\\<A>'.\n         prefix \\<A>' \\<A> \\<longrightarrow>\n         (\\<forall>t\\<in>Sec -\n                         declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                          \\<I>\\<^sub>\\<tau>.\n             \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                       \\<A>' @\n                      [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "{"], ["proof (state)\nthis:\n  \\<forall>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n     \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n               \\<A>\\<rangle> \\<and>\n     (\\<forall>\\<A>'.\n         prefix \\<A>' \\<A> \\<longrightarrow>\n         (\\<forall>t\\<in>Sec -\n                         declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                          \\<I>\\<^sub>\\<tau>.\n             \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                       \\<A>' @\n                      [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "fix \\<I>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "assume \\<I>: \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\" \"\\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\""], ["proof (state)\nthis:\n  subst_domain \\<I> = \\<V> \\<and> ground (subst_range \\<I>)\n  \\<I> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "obtain \\<I>\\<^sub>\\<tau> where \\<I>\\<^sub>\\<tau>:\n          \"interpretation\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\" \"wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\" \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\"\n          \"\\<exists>\\<A>'. prefix \\<A>' \\<A> \\<and> (strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<I>\\<^sub>\\<tau>.\n        \\<lbrakk>subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n                 ground (subst_range \\<I>\\<^sub>\\<tau>);\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>);\n         \\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using par_comp_constr[OF par_comp \\<I>(2,1)] *"], ["proof (prove)\nusing this:\n  \\<exists>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n     \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle> \\<and>\n     ((\\<forall>l.\n          \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l\n             \\<A>\\<rangle>) \\<or>\n      (\\<exists>\\<A>'.\n          prefix \\<A>' \\<A> \\<and>\n          strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>))\n  \\<forall>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n     \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n               \\<A>\\<rangle> \\<and>\n     (\\<forall>\\<A>'.\n         prefix \\<A>' \\<A> \\<longrightarrow>\n         (\\<forall>t\\<in>Sec -\n                         declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                          \\<I>\\<^sub>\\<tau>.\n             \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                       \\<A>' @\n                      [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))\n\ngoal (1 subgoal):\n 1. (\\<And>\\<I>\\<^sub>\\<tau>.\n        \\<lbrakk>subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n                 ground (subst_range \\<I>\\<^sub>\\<tau>);\n         wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>;\n         wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>);\n         \\<exists>\\<A>'.\n            prefix \\<A>' \\<A> \\<and>\n            strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec\n             \\<I>\\<^sub>\\<tau>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by moura"], ["proof (state)\nthis:\n  subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n  ground (subst_range \\<I>\\<^sub>\\<tau>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "hence \"\\<exists>\\<A>'. prefix \\<A>' \\<A> \\<and> (\\<exists>t \\<in> Sec - declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>\\<^sub>\\<tau>. \\<exists>m.\n                  n \\<noteq> m \\<and> (\\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>'@[Send t]\\<rangle>))\""], ["proof (prove)\nusing this:\n  subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n  ground (subst_range \\<I>\\<^sub>\\<tau>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>\n\ngoal (1 subgoal):\n 1. \\<exists>\\<A>'.\n       prefix \\<A>' \\<A> \\<and>\n       (\\<exists>t\\<in>Sec -\n                       declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                        \\<I>\\<^sub>\\<tau>.\n           \\<exists>m.\n              n \\<noteq> m \\<and>\n              \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n                [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)", "using \\<I>\\<^sub>\\<tau>(4) *"], ["proof (prove)\nusing this:\n  subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n  ground (subst_range \\<I>\\<^sub>\\<tau>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' Sec \\<I>\\<^sub>\\<tau>\n  \\<forall>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n     \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n               \\<A>\\<rangle> \\<and>\n     (\\<forall>\\<A>'.\n         prefix \\<A>' \\<A> \\<longrightarrow>\n         (\\<forall>t\\<in>Sec -\n                         declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                          \\<I>\\<^sub>\\<tau>.\n             \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                       \\<A>' @\n                      [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))\n\ngoal (1 subgoal):\n 1. \\<exists>\\<A>'.\n       prefix \\<A>' \\<A> \\<and>\n       (\\<exists>t\\<in>Sec -\n                       declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                        \\<I>\\<^sub>\\<tau>.\n           \\<exists>m.\n              n \\<noteq> m \\<and>\n              \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n                [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)", "unfolding strand_leaks\\<^sub>l\\<^sub>s\\<^sub>t_def"], ["proof (prove)\nusing this:\n  subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n  ground (subst_range \\<I>\\<^sub>\\<tau>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     (\\<exists>t\\<in>Sec -\n                     declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                      \\<I>\\<^sub>\\<tau>.\n         \\<exists>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l \\<A>' @\n              [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     (\\<exists>t\\<in>Sec -\n                     declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                      \\<I>\\<^sub>\\<tau>.\n         \\<exists>l.\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl l \\<A>' @\n              [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n  \\<forall>\\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<longrightarrow>\n     \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n               \\<A>\\<rangle> \\<and>\n     (\\<forall>\\<A>'.\n         prefix \\<A>' \\<A> \\<longrightarrow>\n         (\\<forall>t\\<in>Sec -\n                         declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                          \\<I>\\<^sub>\\<tau>.\n             \\<not> \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl n\n                       \\<A>' @\n                      [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>))\n\ngoal (1 subgoal):\n 1. \\<exists>\\<A>'.\n       prefix \\<A>' \\<A> \\<and>\n       (\\<exists>t\\<in>Sec -\n                       declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                        \\<I>\\<^sub>\\<tau>.\n           \\<exists>m.\n              n \\<noteq> m \\<and>\n              \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n                [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)", "by metis"], ["proof (state)\nthis:\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     (\\<exists>t\\<in>Sec -\n                     declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                      \\<I>\\<^sub>\\<tau>.\n         \\<exists>m.\n            n \\<noteq> m \\<and>\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n              [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "hence ?P"], ["proof (prove)\nusing this:\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     (\\<exists>t\\<in>Sec -\n                     declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                      \\<I>\\<^sub>\\<tau>.\n         \\<exists>m.\n            n \\<noteq> m \\<and>\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n              [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<A>' \\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       prefix \\<A>' \\<A> \\<and>\n       (\\<exists>t\\<in>Sec -\n                       declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                        \\<I>\\<^sub>\\<tau>.\n           \\<exists>m.\n              n \\<noteq> m \\<and>\n              \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n                [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)", "using \\<I>\\<^sub>\\<tau>(1,2,3)"], ["proof (prove)\nusing this:\n  \\<exists>\\<A>'.\n     prefix \\<A>' \\<A> \\<and>\n     (\\<exists>t\\<in>Sec -\n                     declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                      \\<I>\\<^sub>\\<tau>.\n         \\<exists>m.\n            n \\<noteq> m \\<and>\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n              [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n  subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n  ground (subst_range \\<I>\\<^sub>\\<tau>)\n  wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau>\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<I>\\<^sub>\\<tau>)\n\ngoal (1 subgoal):\n 1. \\<exists>\\<A>' \\<I>\\<^sub>\\<tau>.\n       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n       prefix \\<A>' \\<A> \\<and>\n       (\\<exists>t\\<in>Sec -\n                       declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                        \\<I>\\<^sub>\\<tau>.\n           \\<exists>m.\n              n \\<noteq> m \\<and>\n              \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n                [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<A>' \\<I>\\<^sub>\\<tau>.\n     (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n      ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n     wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<I>\\<^sub>\\<tau> \\<and>\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n     prefix \\<A>' \\<A> \\<and>\n     (\\<exists>t\\<in>Sec -\n                     declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>'\n                      \\<I>\\<^sub>\\<tau>.\n         \\<exists>m.\n            n \\<noteq> m \\<and>\n            \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl m \\<A>' @\n              [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>subst_domain ?\\<I>9 = \\<V> \\<and> ground (subst_range ?\\<I>9);\n   ?\\<I>9 \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<A>' \\<I>\\<^sub>\\<tau>.\n                       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n                        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<I>\\<^sub>\\<tau> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n                       prefix \\<A>' \\<A> \\<and>\n                       (\\<exists>t\\<in>Sec -\n declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>\\<^sub>\\<tau>.\n                           \\<exists>m.\n                              n \\<noteq> m \\<and>\n                              \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl\n                                 m \\<A>' @\n                                [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "hence \"unsat \\<A> \\<or> (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>subst_domain ?\\<I>9 = \\<V> \\<and> ground (subst_range ?\\<I>9);\n   ?\\<I>9 \\<Turnstile> \\<langle>unlabel \\<A>\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> \\<exists>\\<A>' \\<I>\\<^sub>\\<tau>.\n                       (subst_domain \\<I>\\<^sub>\\<tau> = \\<V> \\<and>\n                        ground (subst_range \\<I>\\<^sub>\\<tau>)) \\<and>\n                       wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t\n                        \\<I>\\<^sub>\\<tau> \\<and>\n                       wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                        (subst_range \\<I>\\<^sub>\\<tau>) \\<and>\n                       prefix \\<A>' \\<A> \\<and>\n                       (\\<exists>t\\<in>Sec -\n declassified\\<^sub>l\\<^sub>s\\<^sub>t \\<A>' \\<I>\\<^sub>\\<tau>.\n                           \\<exists>m.\n                              n \\<noteq> m \\<and>\n                              \\<I>\\<^sub>\\<tau> \\<Turnstile> \\<langle>proj_unl\n                                 m \\<A>' @\n                                [send\\<langle>t\\<rangle>\\<^sub>s\\<^sub>t]\\<rangle>)\n\ngoal (1 subgoal):\n 1. unsat \\<A> \\<or>\n    (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "by (metis unsat_def component_leaks_def)"], ["proof (state)\nthis:\n  unsat \\<A> \\<or>\n  (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?\\<A>9 =\n           ?\\<A>'9 @\n           [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)];\n   ?\\<A>9 \\<in> P\\<rbrakk>\n  \\<Longrightarrow> unsat ?\\<A>9 \\<or>\n                    (\\<exists>m.\n                        n \\<noteq> m \\<and> component_leaks m ?\\<A>9 Sec)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?\\<A>9 =\n           ?\\<A>'9 @\n           [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)];\n   ?\\<A>9 \\<in> P\\<rbrakk>\n  \\<Longrightarrow> unsat ?\\<A>9 \\<or>\n                    (\\<exists>m.\n                        n \\<noteq> m \\<and> component_leaks m ?\\<A>9 Sec)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n        \\<A> \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "unfolding suffix_def"], ["proof (prove)\nusing this:\n  \\<lbrakk>?\\<A>9 =\n           ?\\<A>'9 @\n           [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)];\n   ?\\<A>9 \\<in> P\\<rbrakk>\n  \\<Longrightarrow> unsat ?\\<A>9 \\<or>\n                    (\\<exists>m.\n                        n \\<noteq> m \\<and> component_leaks m ?\\<A>9 Sec)\n\ngoal (1 subgoal):\n 1. \\<forall>\\<A>\\<in>P.\n       (\\<exists>zs.\n           \\<A> =\n           zs @\n           [(ln n,\n             send\\<langle>Fun attack\n                           []\\<rangle>\\<^sub>s\\<^sub>t)]) \\<longrightarrow>\n       unsat \\<A> \\<or>\n       (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)", "by metis"], ["proof (state)\nthis:\n  \\<forall>\\<A>\\<in>P.\n     suffix [(ln n, send\\<langle>Fun attack []\\<rangle>\\<^sub>s\\<^sub>t)]\n      \\<A> \\<longrightarrow>\n     unsat \\<A> \\<or>\n     (\\<exists>m. n \\<noteq> m \\<and> component_leaks m \\<A> Sec)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "subsection \\<open>Automated GSMP Disjointness\\<close>"], ["", "locale labeled_typed_model' = typed_model' arity public Ana \\<Gamma> +\n  labeled_typed_model arity public Ana \\<Gamma> label_witness1 label_witness2\n  for arity::\"'fun \\<Rightarrow> nat\"\n    and public::\"'fun \\<Rightarrow> bool\"\n    and Ana::\"('fun,(('fun,'atom::finite) term_type \\<times> nat)) term\n              \\<Rightarrow> (('fun,(('fun,'atom) term_type \\<times> nat)) term list\n                 \\<times> ('fun,(('fun,'atom) term_type \\<times> nat)) term list)\"\n    and \\<Gamma>::\"('fun,(('fun,'atom) term_type \\<times> nat)) term \\<Rightarrow> ('fun,'atom) term_type\"\n    and label_witness1 label_witness2::'lbl\nbegin"], ["", "lemma GSMP_disjointI:\n  fixes A' A B B'::\"('fun, ('fun, 'atom) term \\<times> nat) term list\"\n  defines \"f \\<equiv> \\<lambda>M. {t \\<cdot> \\<delta> | t \\<delta>. t \\<in> M \\<and> wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and> wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (subst_range \\<delta>) \\<and> fv (t \\<cdot> \\<delta>) = {}}\"\n    and \"\\<delta> \\<equiv> var_rename (max_var_set (fv\\<^sub>s\\<^sub>e\\<^sub>t (set A)))\"\n  assumes A'_wf: \"list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) A'\"\n    and B'_wf: \"list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) B'\"\n    and A_inst: \"has_all_wt_instances_of \\<Gamma> (set A') (set A)\"\n    and B_inst: \"has_all_wt_instances_of \\<Gamma> (set B') (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\"\n    and A_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> A\"\n    and B_SMP_repr: \"finite_SMP_representation arity Ana \\<Gamma> (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\"\n    and AB_trms_disj:\n      \"\\<forall>t \\<in> set A. \\<forall>s \\<in> set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>). \\<Gamma> t = \\<Gamma> s \\<and> mgu t s \\<noteq> None \\<longrightarrow>\n        (intruder_synth' public arity {} t \\<and> intruder_synth' public arity {} s) \\<or>\n        ((\\<exists>u \\<in> Sec. is_wt_instance_of_cond \\<Gamma> t u) \\<and> (\\<exists>u \\<in> Sec. is_wt_instance_of_cond \\<Gamma> s u))\"\n    and Sec_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s Sec\"\n  shows \"GSMP_disjoint (set A') (set B') ((f Sec) - {m. {} \\<turnstile>\\<^sub>c m})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "have A_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A)\" and B_wf: \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\"\n    and A'_wf': \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A')\" and B'_wf': \"wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A) &&&\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A') &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B')", "using finite_SMP_representationD[OF A_SMP_repr]\n          finite_SMP_representationD[OF B_SMP_repr]\n          A'_wf B'_wf"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set A)) (set A)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set A)) (set A)\n  is_TComp_var_instance_closed \\<Gamma> A\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)))\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union>\n     ((set \\<circ> fst \\<circ> Ana) `\n      set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)))\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  is_TComp_var_instance_closed \\<Gamma>\n   (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n  list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) A'\n  list_all (wf\\<^sub>t\\<^sub>r\\<^sub>m' arity) B'\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A) &&&\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A') &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B')", "unfolding wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s_code[symmetric] wf\\<^sub>t\\<^sub>r\\<^sub>m_code[symmetric] list_all_iff"], ["proof (prove)\nusing this:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A)\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t (set A)) (set A)\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union> ((set \\<circ> fst \\<circ> Ana) ` set A)) (set A)\n  is_TComp_var_instance_closed \\<Gamma> A\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  has_all_wt_instances_of \\<Gamma>\n   (subterms\\<^sub>s\\<^sub>e\\<^sub>t\n     (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)))\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  has_all_wt_instances_of \\<Gamma>\n   (\\<Union>\n     ((set \\<circ> fst \\<circ> Ana) `\n      set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)))\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  is_TComp_var_instance_closed \\<Gamma>\n   (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A')\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B')\n\ngoal (1 subgoal):\n 1. (wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A) &&&\n     wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n      (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))) &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A') &&&\n    wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B')", "by blast+"], ["proof (state)\nthis:\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A)\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set A')\n  wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s (set B')\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "have AB_fv_disj: \"fv\\<^sub>s\\<^sub>e\\<^sub>t (set A) \\<inter> fv\\<^sub>s\\<^sub>e\\<^sub>t (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)) = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fv\\<^sub>s\\<^sub>e\\<^sub>t (set A) \\<inter>\n    fv\\<^sub>s\\<^sub>e\\<^sub>t\n     (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)) =\n    {}", "using var_rename_fv_set_disjoint'[of \"set A\" \"set B\", unfolded \\<delta>_def[symmetric]]"], ["proof (prove)\nusing this:\n  finite (set A) \\<Longrightarrow>\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set A) \\<inter>\n  fv\\<^sub>s\\<^sub>e\\<^sub>t\n   (set B \\<cdot>\\<^sub>s\\<^sub>e\\<^sub>t \\<delta>) =\n  {}\n\ngoal (1 subgoal):\n 1. fv\\<^sub>s\\<^sub>e\\<^sub>t (set A) \\<inter>\n    fv\\<^sub>s\\<^sub>e\\<^sub>t\n     (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)) =\n    {}", "by simp"], ["proof (state)\nthis:\n  fv\\<^sub>s\\<^sub>e\\<^sub>t (set A) \\<inter>\n  fv\\<^sub>s\\<^sub>e\\<^sub>t\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)) =\n  {}\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "have \"GSMP_disjoint (set A) (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)) ((f Sec) - {m. {} \\<turnstile>\\<^sub>c m})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A)\n     (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n     (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "using ground_SMP_disjointI[OF AB_fv_disj A_SMP_repr B_SMP_repr Sec_wf AB_trms_disj]"], ["proof (prove)\nusing this:\n  {t \\<in> SMP (set A). fv t = {}} \\<inter>\n  {t \\<in> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)).\n   fv t = {}}\n  \\<subseteq> {t \\<cdot> \\<delta> |t \\<delta>.\n               t \\<in> Sec \\<and>\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               fv (t \\<cdot> \\<delta>) = {}} \\<union>\n              {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A)\n     (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n     (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "unfolding GSMP_def GSMP_disjoint_def f_def"], ["proof (prove)\nusing this:\n  {t \\<in> SMP (set A). fv t = {}} \\<inter>\n  {t \\<in> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)).\n   fv t = {}}\n  \\<subseteq> {t \\<cdot> \\<delta> |t \\<delta>.\n               t \\<in> Sec \\<and>\n               wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n               wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                (subst_range \\<delta>) \\<and>\n               fv (t \\<cdot> \\<delta>) = {}} \\<union>\n              {m. {} \\<turnstile>\\<^sub>c m}\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP (set A). fv t = {}} \\<inter>\n    {t \\<in> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)).\n     fv t = {}}\n    \\<subseteq> {t \\<cdot> \\<delta> |t \\<delta>.\n                 t \\<in> Sec \\<and>\n                 wt\\<^sub>s\\<^sub>u\\<^sub>b\\<^sub>s\\<^sub>t \\<delta> \\<and>\n                 wf\\<^sub>t\\<^sub>r\\<^sub>m\\<^sub>s\n                  (subst_range \\<delta>) \\<and>\n                 fv (t \\<cdot> \\<delta>) = {}} -\n                Collect ((\\<turnstile>\\<^sub>c) {}) \\<union>\n                {m. {} \\<turnstile>\\<^sub>c m}", "by blast"], ["proof (state)\nthis:\n  GSMP_disjoint (set A)\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n   (f Sec - {m. {} \\<turnstile>\\<^sub>c m})\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "moreover"], ["proof (state)\nthis:\n  GSMP_disjoint (set A)\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n   (f Sec - {m. {} \\<turnstile>\\<^sub>c m})\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "have \"SMP (set A') \\<subseteq> SMP (set A)\" \"SMP (set B') \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SMP (set A') \\<subseteq> SMP (set A) &&&\n    SMP (set B')\n    \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n                          \\<delta>))", "using SMP_I'[OF A'_wf' A_wf A_inst] SMP_SMP_subset[of \"set A'\" \"set A\"]\n          SMP_I'[OF B'_wf' B_wf B_inst] SMP_SMP_subset[of \"set B'\" \"set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)\"]"], ["proof (prove)\nusing this:\n  ?t \\<in> set A' \\<Longrightarrow> ?t \\<in> SMP (set A)\n  set A' \\<subseteq> SMP (set A) \\<Longrightarrow>\n  SMP (set A') \\<subseteq> SMP (set A)\n  ?t \\<in> set B' \\<Longrightarrow>\n  ?t \\<in> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n  set B'\n  \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n                        \\<delta>)) \\<Longrightarrow>\n  SMP (set B')\n  \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n\ngoal (1 subgoal):\n 1. SMP (set A') \\<subseteq> SMP (set A) &&&\n    SMP (set B')\n    \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t\n                          \\<delta>))", "by blast+"], ["proof (state)\nthis:\n  SMP (set A') \\<subseteq> SMP (set A)\n  SMP (set B')\n  \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "ultimately"], ["proof (chain)\npicking this:\n  GSMP_disjoint (set A)\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n   (f Sec - {m. {} \\<turnstile>\\<^sub>c m})\n  SMP (set A') \\<subseteq> SMP (set A)\n  SMP (set B')\n  \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))", "show ?thesis"], ["proof (prove)\nusing this:\n  GSMP_disjoint (set A)\n   (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n   (f Sec - {m. {} \\<turnstile>\\<^sub>c m})\n  SMP (set A') \\<subseteq> SMP (set A)\n  SMP (set B')\n  \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n\ngoal (1 subgoal):\n 1. GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})", "unfolding GSMP_def GSMP_disjoint_def"], ["proof (prove)\nusing this:\n  {t \\<in> SMP (set A). fv t = {}} \\<inter>\n  {t \\<in> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>)).\n   fv t = {}}\n  \\<subseteq> f Sec - Collect ((\\<turnstile>\\<^sub>c) {}) \\<union>\n              {m. {} \\<turnstile>\\<^sub>c m}\n  SMP (set A') \\<subseteq> SMP (set A)\n  SMP (set B')\n  \\<subseteq> SMP (set (B \\<cdot>\\<^sub>l\\<^sub>i\\<^sub>s\\<^sub>t \\<delta>))\n\ngoal (1 subgoal):\n 1. {t \\<in> SMP (set A'). fv t = {}} \\<inter>\n    {t \\<in> SMP (set B'). fv t = {}}\n    \\<subseteq> f Sec - Collect ((\\<turnstile>\\<^sub>c) {}) \\<union>\n                {m. {} \\<turnstile>\\<^sub>c m}", "by auto"], ["proof (state)\nthis:\n  GSMP_disjoint (set A') (set B') (f Sec - {m. {} \\<turnstile>\\<^sub>c m})\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"]]}