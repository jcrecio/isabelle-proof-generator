{"file_name": "/home/qj213/afp-2021-10-22/thys/pGCL/Continuity.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/pGCL", "problem_names": ["lemma bd_ctsD:\n  \"\\<lbrakk> bd_cts t; \\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i); \\<And>i. bounded_by b (M i) \\<rbrakk> \\<Longrightarrow>\n   t (Sup_exp (range M)) = Sup_exp (range (t o M))\"", "lemma bd_ctsI:\n  \"(\\<And>b M. (\\<And>i. M i \\<tturnstile> M (Suc i)) \\<Longrightarrow> (\\<And>i. sound (M i)) \\<Longrightarrow> (\\<And>i. bounded_by b (M i)) \\<Longrightarrow>\n         t (Sup_exp (range M)) = Sup_exp (range (t o M))) \\<Longrightarrow> bd_cts t\"", "lemma bd_cts_trD:\n  \"\\<lbrakk> bd_cts_tr T; \\<And>i. le_trans (M i) (M (Suc i)); \\<And>i. feasible (M i) \\<rbrakk> \\<Longrightarrow>\n   equiv_trans (T (Sup_trans (M ` UNIV))) (Sup_trans ((T o M) ` UNIV))\"", "lemma bd_cts_trI:\n  \"(\\<And>M. (\\<And>i. le_trans (M i) (M (Suc i))) \\<Longrightarrow> (\\<And>i. feasible (M i)) \\<Longrightarrow>\n         equiv_trans (T (Sup_trans (M ` UNIV))) (Sup_trans ((T o M) ` UNIV))) \\<Longrightarrow> bd_cts_tr T\"", "lemma cts_wp_Abort:\n  \"bd_cts (wp (Abort::'s prog))\"", "lemma cts_wp_Skip:\n  \"bd_cts (wp Skip)\"", "lemma cts_wp_Apply:\n  \"bd_cts (wp (Apply f))\"", "lemma cts_wp_Bind:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>s. bd_cts (wp (a (f s)))\"\n  shows \"bd_cts (wp (Bind f a))\"", "lemma cts_wp_DC:\n  fixes a b::\"'s prog\"\n  assumes ca: \"bd_cts (wp a)\"\n      and cb: \"bd_cts (wp b)\"\n      and ha: \"healthy (wp a)\"\n      and hb: \"healthy (wp b)\"\n  shows \"bd_cts (wp (a \\<Sqinter> b))\"", "lemma cts_wp_Seq:\n  fixes a b::\"'s prog\"\n  assumes ca: \"bd_cts (wp a)\"\n      and cb: \"bd_cts (wp b)\"\n      and hb: \"healthy (wp b)\"\n  shows \"bd_cts (wp (a ;; b))\"", "lemma cts_wp_PC:\n  fixes a b::\"'s prog\"\n  assumes ca: \"bd_cts (wp a)\"\n      and cb: \"bd_cts (wp b)\"\n      and ha: \"healthy (wp a)\"\n      and hb: \"healthy (wp b)\"\n      and up: \"unitary p\"\n  shows \"bd_cts (wp (PC a p b))\"", "lemma SetPC_Bind:\n  \"SetPC a p = Bind p (\\<lambda>p. SetPC a (\\<lambda>_. p))\"", "lemma SetPC_remove:\n  assumes nz: \"p x \\<noteq> 0\" and n1: \"p x \\<noteq> 1\"\n      and fsupp: \"finite (supp p)\"\n  shows \"SetPC a (\\<lambda>_. p) = PC (a x) (\\<lambda>_. p x) (SetPC a (\\<lambda>_. dist_remove p x))\"", "lemma cts_bot:\n  \"bd_cts (\\<lambda>(P::'s expect) (s::'s). 0::real)\"", "lemma wp_SetPC_nil:\n  \"wp (SetPC a (\\<lambda>s a. 0)) = (\\<lambda>P s. 0)\"", "lemma SetPC_sgl:\n  \"supp p = {x} \\<Longrightarrow> SetPC a (\\<lambda>_. p) = (\\<lambda>ab P s. p x * a x ab P s)\"", "lemma bd_cts_scale:\n  fixes a::\"'s trans\"\n  assumes ca: \"bd_cts a\"\n      and ha: \"healthy a\"\n      and nnc: \"0 \\<le> c\"\n  shows \"bd_cts (\\<lambda>P s. c * a P s)\"", "lemma cts_wp_SetPC_const:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x. x \\<in> (supp p) \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x. x \\<in> (supp p) \\<Longrightarrow> healthy (wp (a x))\"\n      and up: \"unitary p\"\n      and sump: \"sum p (supp p) \\<le> 1\"\n      and fsupp: \"finite (supp p)\"\n  shows \"bd_cts (wp (SetPC a (\\<lambda>_. p)))\"", "lemma cts_wp_SetPC:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x s. x \\<in> (supp (p s)) \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x s. x \\<in> (supp (p s)) \\<Longrightarrow> healthy (wp (a x))\"\n      and up: \"\\<And>s. unitary (p s)\"\n      and sump: \"\\<And>s. sum (p s) (supp (p s)) \\<le> 1\"\n      and fsupp: \"\\<And>s. finite (supp (p s))\"\n  shows \"bd_cts (wp (SetPC a p))\"", "lemma wp_SetDC_Bind:\n  \"SetDC a S = Bind S (\\<lambda>S. SetDC a (\\<lambda>_. S))\"", "lemma SetDC_finite_insert:\n  assumes fS: \"finite S\"\n      and neS: \"S \\<noteq> {}\"\n  shows \"SetDC a (\\<lambda>_. insert x S) = a x \\<Sqinter> SetDC a (\\<lambda>_. S)\"", "lemma SetDC_singleton:\n  \"SetDC a (\\<lambda>_. {x}) = a x\"", "lemma cts_wp_SetDC_const:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x. x \\<in> S \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x. x \\<in> S \\<Longrightarrow> healthy (wp (a x))\"\n      and fS: \"finite S\"\n      and neS: \"S \\<noteq> {}\"\n  shows \"bd_cts (wp (SetDC a (\\<lambda>_. S)))\"", "lemma cts_wp_SetDC:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x s. x \\<in> S s \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x s. x \\<in> S s \\<Longrightarrow> healthy (wp (a x))\"\n      and fS: \"\\<And>s. finite (S s)\"\n      and neS: \"\\<And>s. S s \\<noteq> {}\"\n  shows \"bd_cts (wp (SetDC a S))\"", "lemma cts_wp_repeat:\n  \"bd_cts (wp a) \\<Longrightarrow> healthy (wp a) \\<Longrightarrow> bd_cts (wp (repeat n a))\"", "lemma cts_wp_Embed:\n  \"bd_cts t \\<Longrightarrow> bd_cts (wp (Embed t))\"", "lemma cts_wp_loopstep:\n  fixes body::\"'s prog\"\n  assumes hb: \"healthy (wp body)\"\n      and cb: \"bd_cts (wp body)\"\n  shows \"bd_cts_tr (\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\" (is \"bd_cts_tr ?F\")"], "translations": [["", "lemma bd_ctsD:\n  \"\\<lbrakk> bd_cts t; \\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i); \\<And>i. bounded_by b (M i) \\<rbrakk> \\<Longrightarrow>\n   t (Sup_exp (range M)) = Sup_exp (range (t o M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>bd_cts t; \\<And>i. M i \\<tturnstile> M (Suc i);\n     \\<And>i. sound (M i); \\<And>i. bounded_by b (M i)\\<rbrakk>\n    \\<Longrightarrow> t (Sup_exp (range M)) = Sup_exp (range (t \\<circ> M))", "unfolding bd_cts_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>M.\n                (\\<forall>i.\n                    M i \\<tturnstile> M (Suc i) \\<and>\n                    sound (M i)) \\<longrightarrow>\n                (\\<exists>b.\n                    \\<forall>i. bounded_by b (M i)) \\<longrightarrow>\n                t (Sup_exp (range M)) = Sup_exp (range (t \\<circ> M));\n     \\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n     \\<And>i. bounded_by b (M i)\\<rbrakk>\n    \\<Longrightarrow> t (Sup_exp (range M)) = Sup_exp (range (t \\<circ> M))", "by(auto)"], ["", "lemma bd_ctsI:\n  \"(\\<And>b M. (\\<And>i. M i \\<tturnstile> M (Suc i)) \\<Longrightarrow> (\\<And>i. sound (M i)) \\<Longrightarrow> (\\<And>i. bounded_by b (M i)) \\<Longrightarrow>\n         t (Sup_exp (range M)) = Sup_exp (range (t o M))) \\<Longrightarrow> bd_cts t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>b M.\n        \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n         \\<And>i. bounded_by b (M i)\\<rbrakk>\n        \\<Longrightarrow> t (Sup_exp (range M)) =\n                          Sup_exp (range (t \\<circ> M))) \\<Longrightarrow>\n    bd_cts t", "unfolding bd_cts_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>b M.\n        \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n         \\<And>i. bounded_by b (M i)\\<rbrakk>\n        \\<Longrightarrow> t (Sup_exp (range M)) =\n                          Sup_exp (range (t \\<circ> M))) \\<Longrightarrow>\n    \\<forall>M.\n       (\\<forall>i.\n           M i \\<tturnstile> M (Suc i) \\<and> sound (M i)) \\<longrightarrow>\n       (\\<exists>b. \\<forall>i. bounded_by b (M i)) \\<longrightarrow>\n       t (Sup_exp (range M)) = Sup_exp (range (t \\<circ> M))", "by(auto)"], ["", "text \\<open>A generalised property for transformers of transformers.\\<close>"], ["", "definition bd_cts_tr :: \"('s trans \\<Rightarrow> 's trans) \\<Rightarrow> bool\"\nwhere \"bd_cts_tr T = (\\<forall>M. (\\<forall>i. le_trans (M i) (M (Suc i)) \\<and> feasible (M i)) \\<longrightarrow>\n                          equiv_trans (T (Sup_trans (M ` UNIV))) (Sup_trans ((T o M) ` UNIV)))\""], ["", "lemma bd_cts_trD:\n  \"\\<lbrakk> bd_cts_tr T; \\<And>i. le_trans (M i) (M (Suc i)); \\<And>i. feasible (M i) \\<rbrakk> \\<Longrightarrow>\n   equiv_trans (T (Sup_trans (M ` UNIV))) (Sup_trans ((T o M) ` UNIV))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>bd_cts_tr T; \\<And>i. le_trans (M i) (M (Suc i));\n     \\<And>i. feasible (M i)\\<rbrakk>\n    \\<Longrightarrow> equiv_trans (T (Sup_trans (range M)))\n                       (Sup_trans (range (T \\<circ> M)))", "by(simp add:bd_cts_tr_def)"], ["", "lemma bd_cts_trI:\n  \"(\\<And>M. (\\<And>i. le_trans (M i) (M (Suc i))) \\<Longrightarrow> (\\<And>i. feasible (M i)) \\<Longrightarrow>\n         equiv_trans (T (Sup_trans (M ` UNIV))) (Sup_trans ((T o M) ` UNIV))) \\<Longrightarrow> bd_cts_tr T\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>M.\n        \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n         \\<And>i. feasible (M i)\\<rbrakk>\n        \\<Longrightarrow> equiv_trans (T (Sup_trans (range M)))\n                           (Sup_trans\n                             (range (T \\<circ> M)))) \\<Longrightarrow>\n    bd_cts_tr T", "by(simp add:bd_cts_tr_def)"], ["", "subsection \\<open>Continuity of Primitives\\<close>"], ["", "lemma cts_wp_Abort:\n  \"bd_cts (wp (Abort::'s prog))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp Abort)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bd_cts (wp Abort)", "have X: \"range (\\<lambda>(i::nat) (s::'s). 0) = {\\<lambda>s. 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range (\\<lambda>i s. 0::'a) = {\\<lambda>s. 0::'a}", "by(auto)"], ["proof (state)\nthis:\n  range (\\<lambda>i s. 0::?'a1) = {\\<lambda>s. 0::?'a1}\n\ngoal (1 subgoal):\n 1. bd_cts (wp Abort)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp Abort)", "by(intro bd_ctsI, simp add:wp_eval o_def Sup_exp_def X)"], ["proof (state)\nthis:\n  bd_cts (wp Abort)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_Skip:\n  \"bd_cts (wp Skip)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp Skip)", "by(rule bd_ctsI, simp add:wp_def Skip_def o_def)"], ["", "lemma cts_wp_Apply:\n  \"bd_cts (wp (Apply f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (Apply f))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bd_cts (wp (Apply f))", "have X: \"\\<And>M s. {P (f s) |P. P \\<in> range M} = {P s |P. P \\<in> range (\\<lambda>i s. M i (f s))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M s.\n       {P (f s) |P. P \\<in> range M} =\n       {P s |P. P \\<in> range (\\<lambda>i s. M i (f s))}", "by(auto)"], ["proof (state)\nthis:\n  {P (f ?s) |P. P \\<in> range ?M} =\n  {P ?s |P. P \\<in> range (\\<lambda>i s. ?M i (f s))}\n\ngoal (1 subgoal):\n 1. bd_cts (wp (Apply f))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (Apply f))", "by(intro bd_ctsI ext, simp add:wp_eval o_def Sup_exp_def X)"], ["proof (state)\nthis:\n  bd_cts (wp (Apply f))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_Bind:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>s. bd_cts (wp (a (f s)))\"\n  shows \"bd_cts (wp (Bind f a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (Bind f a))", "proof(rule bd_ctsI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>b M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (Bind f a) (Sup_exp (range M)) =\n                         Sup_exp (range (wp (Bind f a) \\<circ> M))", "fix M::\"nat \\<Rightarrow> 's expect\" and c::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>b M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (Bind f a) (Sup_exp (range M)) =\n                         Sup_exp (range (wp (Bind f a) \\<circ> M))", "assume chain: \"\\<And>i. M i \\<tturnstile> M (Suc i)\" and sM: \"\\<And>i. sound (M i)\"\n     and bM: \"\\<And>i. bounded_by c (M i)\""], ["proof (state)\nthis:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>b M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (Bind f a) (Sup_exp (range M)) =\n                         Sup_exp (range (wp (Bind f a) \\<circ> M))", "with bd_ctsD[OF ca]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>i. ?M i \\<tturnstile> ?M (Suc i); \\<And>i. sound (?M i);\n   \\<And>i. bounded_by ?b (?M i)\\<rbrakk>\n  \\<Longrightarrow> wp (a (f ?s1)) (Sup_exp (range ?M)) =\n                    Sup_exp (range (wp (a (f ?s1)) \\<circ> ?M))\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)", "have \"\\<And>s. wp (a (f s)) (Sup_exp (range M)) =\n            Sup_exp (range (wp (a (f s)) o M))\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>i. ?M i \\<tturnstile> ?M (Suc i); \\<And>i. sound (?M i);\n   \\<And>i. bounded_by ?b (?M i)\\<rbrakk>\n  \\<Longrightarrow> wp (a (f ?s1)) (Sup_exp (range ?M)) =\n                    Sup_exp (range (wp (a (f ?s1)) \\<circ> ?M))\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>s.\n       wp (a (f s)) (Sup_exp (range M)) =\n       Sup_exp (range (wp (a (f s)) \\<circ> M))", "by(auto)"], ["proof (state)\nthis:\n  wp (a (f ?s)) (Sup_exp (range M)) =\n  Sup_exp (range (wp (a (f ?s)) \\<circ> M))\n\ngoal (1 subgoal):\n 1. \\<And>b M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (Bind f a) (Sup_exp (range M)) =\n                         Sup_exp (range (wp (Bind f a) \\<circ> M))", "moreover"], ["proof (state)\nthis:\n  wp (a (f ?s)) (Sup_exp (range M)) =\n  Sup_exp (range (wp (a (f ?s)) \\<circ> M))\n\ngoal (1 subgoal):\n 1. \\<And>b M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (Bind f a) (Sup_exp (range M)) =\n                         Sup_exp (range (wp (Bind f a) \\<circ> M))", "have \"\\<And>s. {fa s |fa. fa \\<in> range (\\<lambda>x. wp (a (f s)) (M x))} =\n                      {fa s |fa. fa \\<in> range (\\<lambda>x s. wp (a (f s)) (M x) s)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       {fa s |fa. fa \\<in> range (\\<lambda>x. wp (a (f s)) (M x))} =\n       {fa s |fa. fa \\<in> range (\\<lambda>x s. wp (a (f s)) (M x) s)}", "by(auto)"], ["proof (state)\nthis:\n  {fa ?s |fa. fa \\<in> range (\\<lambda>x. wp (a (f ?s)) (M x))} =\n  {fa ?s |fa. fa \\<in> range (\\<lambda>x s. wp (a (f s)) (M x) s)}\n\ngoal (1 subgoal):\n 1. \\<And>b M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (Bind f a) (Sup_exp (range M)) =\n                         Sup_exp (range (wp (Bind f a) \\<circ> M))", "ultimately"], ["proof (chain)\npicking this:\n  wp (a (f ?s)) (Sup_exp (range M)) =\n  Sup_exp (range (wp (a (f ?s)) \\<circ> M))\n  {fa ?s |fa. fa \\<in> range (\\<lambda>x. wp (a (f ?s)) (M x))} =\n  {fa ?s |fa. fa \\<in> range (\\<lambda>x s. wp (a (f s)) (M x) s)}", "show \"wp (Bind f a) (Sup_exp (range M)) =\n                   Sup_exp (range (wp (Bind f a) \\<circ> M))\""], ["proof (prove)\nusing this:\n  wp (a (f ?s)) (Sup_exp (range M)) =\n  Sup_exp (range (wp (a (f ?s)) \\<circ> M))\n  {fa ?s |fa. fa \\<in> range (\\<lambda>x. wp (a (f ?s)) (M x))} =\n  {fa ?s |fa. fa \\<in> range (\\<lambda>x s. wp (a (f s)) (M x) s)}\n\ngoal (1 subgoal):\n 1. wp (Bind f a) (Sup_exp (range M)) =\n    Sup_exp (range (wp (Bind f a) \\<circ> M))", "by(simp add:wp_eval o_def Sup_exp_def)"], ["proof (state)\nthis:\n  wp (Bind f a) (Sup_exp (range M)) =\n  Sup_exp (range (wp (Bind f a) \\<circ> M))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The first nontrivial proof.  We transform the suprema into limits, and appeal to the\ncontinuity of the underlying operation (here infimum).  This is typical of the remainder of the\nnonrecursive elements.\\<close>"], ["", "lemma cts_wp_DC:\n  fixes a b::\"'s prog\"\n  assumes ca: \"bd_cts (wp a)\"\n      and cb: \"bd_cts (wp b)\"\n      and ha: \"healthy (wp a)\"\n      and hb: \"healthy (wp b)\"\n  shows \"bd_cts (wp (a \\<Sqinter> b))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (a \\<Sqinter> b))", "proof(rule bd_ctsI, rule antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))\n 2. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> Sup_exp\n                          (range\n                            (wp (a \\<Sqinter> b) \\<circ>\n                             M)) \\<tturnstile> wp (a \\<Sqinter> b)\n          (Sup_exp (range M))", "fix M::\"nat \\<Rightarrow> 's expect\" and c::real"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))\n 2. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> Sup_exp\n                          (range\n                            (wp (a \\<Sqinter> b) \\<circ>\n                             M)) \\<tturnstile> wp (a \\<Sqinter> b)\n          (Sup_exp (range M))", "assume chain: \"\\<And>i. M i \\<tturnstile> M (Suc i)\" and sM: \"\\<And>i. sound (M i)\"\n     and bM: \"\\<And>i. bounded_by c (M i)\""], ["proof (state)\nthis:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (2 subgoals):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))\n 2. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> Sup_exp\n                          (range\n                            (wp (a \\<Sqinter> b) \\<circ>\n                             M)) \\<tturnstile> wp (a \\<Sqinter> b)\n          (Sup_exp (range M))", "from ha hb"], ["proof (chain)\npicking this:\n  healthy (wp a)\n  healthy (wp b)", "have hab: \"healthy (wp (a \\<Sqinter> b))\""], ["proof (prove)\nusing this:\n  healthy (wp a)\n  healthy (wp b)\n\ngoal (1 subgoal):\n 1. healthy (wp (a \\<Sqinter> b))", "by(rule healthy_intros)"], ["proof (state)\nthis:\n  healthy (wp (a \\<Sqinter> b))\n\ngoal (2 subgoals):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))\n 2. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> Sup_exp\n                          (range\n                            (wp (a \\<Sqinter> b) \\<circ>\n                             M)) \\<tturnstile> wp (a \\<Sqinter> b)\n          (Sup_exp (range M))", "from bM"], ["proof (chain)\npicking this:\n  bounded_by c (M ?i)", "have leSup: \"\\<And>i. M i \\<tturnstile> Sup_exp (range M)\""], ["proof (prove)\nusing this:\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i. M i \\<tturnstile> Sup_exp (range M)", "by(auto intro:Sup_exp_upper)"], ["proof (state)\nthis:\n  M ?i \\<tturnstile> Sup_exp (range M)\n\ngoal (2 subgoals):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))\n 2. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> Sup_exp\n                          (range\n                            (wp (a \\<Sqinter> b) \\<circ>\n                             M)) \\<tturnstile> wp (a \\<Sqinter> b)\n          (Sup_exp (range M))", "from sM bM"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by c (M ?i)", "have sSup: \"sound (Sup_exp (range M))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. sound (Sup_exp (range M))", "by(auto intro:Sup_exp_sound)"], ["proof (state)\nthis:\n  sound (Sup_exp (range M))\n\ngoal (2 subgoals):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))\n 2. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> Sup_exp\n                          (range\n                            (wp (a \\<Sqinter> b) \\<circ>\n                             M)) \\<tturnstile> wp (a \\<Sqinter> b)\n          (Sup_exp (range M))", "show \"Sup_exp (range (wp (a \\<Sqinter> b) \\<circ> M)) \\<tturnstile> wp (a \\<Sqinter> b) (Sup_exp (range M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sup_exp\n     (range\n       (wp (a \\<Sqinter> b) \\<circ>\n        M)) \\<tturnstile> wp (a \\<Sqinter> b) (Sup_exp (range M))", "proof(rule Sup_exp_least, clarsimp, rule le_funI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x.\n       wp (a \\<Sqinter> b) (M P) x\n       \\<le> wp (a \\<Sqinter> b) (Sup_exp (range M)) x\n 2. nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))", "fix i s"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x.\n       wp (a \\<Sqinter> b) (M P) x\n       \\<le> wp (a \\<Sqinter> b) (Sup_exp (range M)) x\n 2. nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))", "from mono_transD[OF healthy_monoD[OF hab]] leSup sM sSup"], ["proof (chain)\npicking this:\n  \\<lbrakk>sound ?P; sound ?Q; ?P \\<tturnstile> ?Q\\<rbrakk>\n  \\<Longrightarrow> wp (a \\<Sqinter> b)\n                     ?P \\<tturnstile> wp (a \\<Sqinter> b) ?Q\n  M ?i \\<tturnstile> Sup_exp (range M)\n  sound (M ?i)\n  sound (Sup_exp (range M))", "have \"wp (a \\<Sqinter> b) (M i) \\<tturnstile> wp (a \\<Sqinter> b) (Sup_exp (range M))\""], ["proof (prove)\nusing this:\n  \\<lbrakk>sound ?P; sound ?Q; ?P \\<tturnstile> ?Q\\<rbrakk>\n  \\<Longrightarrow> wp (a \\<Sqinter> b)\n                     ?P \\<tturnstile> wp (a \\<Sqinter> b) ?Q\n  M ?i \\<tturnstile> Sup_exp (range M)\n  sound (M ?i)\n  sound (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. wp (a \\<Sqinter> b)\n     (M i) \\<tturnstile> wp (a \\<Sqinter> b) (Sup_exp (range M))", "by(auto)"], ["proof (state)\nthis:\n  wp (a \\<Sqinter> b)\n   (M i) \\<tturnstile> wp (a \\<Sqinter> b) (Sup_exp (range M))\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       wp (a \\<Sqinter> b) (M P) x\n       \\<le> wp (a \\<Sqinter> b) (Sup_exp (range M)) x\n 2. nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))", "thus \"wp (a \\<Sqinter> b) (M i) s \\<le> wp (a \\<Sqinter> b) (Sup_exp (range M)) s\""], ["proof (prove)\nusing this:\n  wp (a \\<Sqinter> b)\n   (M i) \\<tturnstile> wp (a \\<Sqinter> b) (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. wp (a \\<Sqinter> b) (M i) s\n    \\<le> wp (a \\<Sqinter> b) (Sup_exp (range M)) s", "by(auto)"], ["proof (state)\nthis:\n  wp (a \\<Sqinter> b) (M i) s\n  \\<le> wp (a \\<Sqinter> b) (Sup_exp (range M)) s\n\ngoal (1 subgoal):\n 1. nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))", "from hab sSup"], ["proof (chain)\npicking this:\n  healthy (wp (a \\<Sqinter> b))\n  sound (Sup_exp (range M))", "have \"sound (wp (a \\<Sqinter> b) (Sup_exp (range M)))\""], ["proof (prove)\nusing this:\n  healthy (wp (a \\<Sqinter> b))\n  sound (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. sound (wp (a \\<Sqinter> b) (Sup_exp (range M)))", "by(auto)"], ["proof (state)\nthis:\n  sound (wp (a \\<Sqinter> b) (Sup_exp (range M)))\n\ngoal (1 subgoal):\n 1. nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))", "thus \"nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))\""], ["proof (prove)\nusing this:\n  sound (wp (a \\<Sqinter> b) (Sup_exp (range M)))\n\ngoal (1 subgoal):\n 1. nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))", "by(auto)"], ["proof (state)\nthis:\n  nneg (wp (a \\<Sqinter> b) (Sup_exp (range M)))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Sup_exp\n   (range\n     (wp (a \\<Sqinter> b) \\<circ>\n      M)) \\<tturnstile> wp (a \\<Sqinter> b) (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))", "from sM bM ha"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp a)", "have \"\\<And>i. bounded_by c (wp a (M i))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp a)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by c (wp a (M i))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c (wp a (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))", "hence baM: \"\\<And>i s. wp a (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  bounded_by c (wp a (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>i s. wp a (M i) s \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  wp a (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))", "from sM bM hb"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp b)", "have \"\\<And>i. bounded_by c (wp b (M i))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp b)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by c (wp b (M i))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c (wp b (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))", "hence bbM: \"\\<And>i s. wp b (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  bounded_by c (wp b (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>i s. wp b (M i) s \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  wp b (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp (a \\<Sqinter> b)\n                          (Sup_exp\n                            (range\n                              M)) \\<tturnstile> Sup_exp\n           (range (wp (a \\<Sqinter> b) \\<circ> M))", "show \"wp (a \\<Sqinter> b) (Sup_exp (range M)) \\<tturnstile> Sup_exp (range (wp (a \\<Sqinter> b) \\<circ> M))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (a \\<Sqinter> b)\n     (Sup_exp\n       (range\n         M)) \\<tturnstile> Sup_exp (range (wp (a \\<Sqinter> b) \\<circ> M))", "proof(simp add:wp_eval o_def, rule le_funI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "fix s::'s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "from bd_ctsD[OF ca, of M, OF chain sM bM] bd_ctsD[OF cb, of M, OF chain sM bM]"], ["proof (chain)\npicking this:\n  wp a (Sup_exp (range M)) = Sup_exp (range (wp a \\<circ> M))\n  wp b (Sup_exp (range M)) = Sup_exp (range (wp b \\<circ> M))", "have \"min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s) =\n          min (Sup_exp (range (wp a o M)) s) (Sup_exp (range (wp b o M)) s)\""], ["proof (prove)\nusing this:\n  wp a (Sup_exp (range M)) = Sup_exp (range (wp a \\<circ> M))\n  wp b (Sup_exp (range M)) = Sup_exp (range (wp b \\<circ> M))\n\ngoal (1 subgoal):\n 1. min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s) =\n    min (Sup_exp (range (wp a \\<circ> M)) s)\n     (Sup_exp (range (wp b \\<circ> M)) s)", "by(simp)"], ["proof (state)\nthis:\n  min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s) =\n  min (Sup_exp (range (wp a \\<circ> M)) s)\n   (Sup_exp (range (wp b \\<circ> M)) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "also"], ["proof (state)\nthis:\n  min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s) =\n  min (Sup_exp (range (wp a \\<circ> M)) s)\n   (Sup_exp (range (wp b \\<circ> M)) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "{"], ["proof (state)\nthis:\n  min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s) =\n  min (Sup_exp (range (wp a \\<circ> M)) s)\n   (Sup_exp (range (wp b \\<circ> M)) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "have \"{f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} = range (\\<lambda>i. wp a (M i) s)\"\n           \"{f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} = range (\\<lambda>i. wp b (M i) s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} =\n    range (\\<lambda>i. wp a (M i) s) &&&\n    {f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} =\n    range (\\<lambda>i. wp b (M i) s)", "by(auto)"], ["proof (state)\nthis:\n  {f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} =\n  range (\\<lambda>i. wp a (M i) s)\n  {f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} =\n  range (\\<lambda>i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "hence \"min (Sup_exp (range (wp a o M)) s) (Sup_exp (range (wp b o M)) s) =\n            min (Sup (range (\\<lambda>i. wp a (M i) s))) (Sup (range (\\<lambda>i. wp b (M i) s)))\""], ["proof (prove)\nusing this:\n  {f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} =\n  range (\\<lambda>i. wp a (M i) s)\n  {f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} =\n  range (\\<lambda>i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. min (Sup_exp (range (wp a \\<circ> M)) s)\n     (Sup_exp (range (wp b \\<circ> M)) s) =\n    min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)", "by(simp add:Sup_exp_def o_def)"], ["proof (state)\nthis:\n  min (Sup_exp (range (wp a \\<circ> M)) s)\n   (Sup_exp (range (wp b \\<circ> M)) s) =\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "}"], ["proof (state)\nthis:\n  min (Sup_exp (range (wp a \\<circ> M)) s)\n   (Sup_exp (range (wp b \\<circ> M)) s) =\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "also"], ["proof (state)\nthis:\n  min (Sup_exp (range (wp a \\<circ> M)) s)\n   (Sup_exp (range (wp b \\<circ> M)) s) =\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "{"], ["proof (state)\nthis:\n  min (Sup_exp (range (wp a \\<circ> M)) s)\n   (Sup_exp (range (wp b \\<circ> M)) s) =\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "have \"(\\<lambda>i. wp a (M i) s) \\<longlonglongrightarrow> Sup (range (\\<lambda>i. wp a (M i) s))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>i. wp a (M i) s)\n    \\<longlonglongrightarrow> (SUP i. wp a (M i) s)", "proof(rule increasing_LIMSEQ)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. wp a (M n) s \\<le> wp a (M (Suc n)) s\n 2. \\<And>n. wp a (M n) s \\<le> (SUP i. wp a (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "fix n"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. wp a (M n) s \\<le> wp a (M (Suc n)) s\n 2. \\<And>n. wp a (M n) s \\<le> (SUP i. wp a (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "from mono_transD[OF healthy_monoD, OF ha] sM chain"], ["proof (chain)\npicking this:\n  \\<lbrakk>sound ?P; sound ?Q; ?P \\<tturnstile> ?Q\\<rbrakk>\n  \\<Longrightarrow> wp a ?P \\<tturnstile> wp a ?Q\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)", "show \"wp a (M n) s \\<le> wp a (M (Suc n)) s\""], ["proof (prove)\nusing this:\n  \\<lbrakk>sound ?P; sound ?Q; ?P \\<tturnstile> ?Q\\<rbrakk>\n  \\<Longrightarrow> wp a ?P \\<tturnstile> wp a ?Q\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)\n\ngoal (1 subgoal):\n 1. wp a (M n) s \\<le> wp a (M (Suc n)) s", "by(auto intro:le_funD)"], ["proof (state)\nthis:\n  wp a (M n) s \\<le> wp a (M (Suc n)) s\n\ngoal (2 subgoals):\n 1. \\<And>n. wp a (M n) s \\<le> (SUP i. wp a (M i) s)\n 2. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "from baM"], ["proof (chain)\npicking this:\n  wp a (M ?i) ?s \\<le> c", "show \"wp a (M n) s \\<le> Sup (range (\\<lambda>i. wp a (M i) s))\""], ["proof (prove)\nusing this:\n  wp a (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. wp a (M n) s \\<le> (SUP i. wp a (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  wp a (M n) s \\<le> (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "fix e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "assume pe: \"0 < e\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "from baM"], ["proof (chain)\npicking this:\n  wp a (M ?i) ?s \\<le> c", "have cSup: \"Sup (range (\\<lambda>i. wp a (M i) s)) \\<in> closure (range (\\<lambda>i. wp a (M i) s))\""], ["proof (prove)\nusing this:\n  wp a (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. (SUP i. wp a (M i) s) \\<in> closure (range (\\<lambda>i. wp a (M i) s))", "by(blast intro:closure_contains_Sup)"], ["proof (state)\nthis:\n  (SUP i. wp a (M i) s) \\<in> closure (range (\\<lambda>i. wp a (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "with pe"], ["proof (chain)\npicking this:\n  0 < e\n  (SUP i. wp a (M i) s) \\<in> closure (range (\\<lambda>i. wp a (M i) s))", "obtain y where yin: \"y \\<in> (range (\\<lambda>i. wp a (M i) s))\"\n                          and dy: \"dist y (Sup (range (\\<lambda>i. wp a (M i) s))) < e\""], ["proof (prove)\nusing this:\n  0 < e\n  (SUP i. wp a (M i) s) \\<in> closure (range (\\<lambda>i. wp a (M i) s))\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> range (\\<lambda>i. wp a (M i) s);\n         dist y (SUP i. wp a (M i) s) < e\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(blast dest:iffD1[OF closure_approachable])"], ["proof (state)\nthis:\n  y \\<in> range (\\<lambda>i. wp a (M i) s)\n  dist y (SUP i. wp a (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "from yin"], ["proof (chain)\npicking this:\n  y \\<in> range (\\<lambda>i. wp a (M i) s)", "obtain i where \"y = wp a (M i) s\""], ["proof (prove)\nusing this:\n  y \\<in> range (\\<lambda>i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. (\\<And>i. y = wp a (M i) s \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(auto)"], ["proof (state)\nthis:\n  y = wp a (M i) s\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "with dy"], ["proof (chain)\npicking this:\n  dist y (SUP i. wp a (M i) s) < e\n  y = wp a (M i) s", "have \"dist (wp a (M i) s) (Sup (range (\\<lambda>i. wp a (M i) s))) < e\""], ["proof (prove)\nusing this:\n  dist y (SUP i. wp a (M i) s) < e\n  y = wp a (M i) s\n\ngoal (1 subgoal):\n 1. dist (wp a (M i) s) (SUP i. wp a (M i) s) < e", "by(simp)"], ["proof (state)\nthis:\n  dist (wp a (M i) s) (SUP i. wp a (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "moreover"], ["proof (state)\nthis:\n  dist (wp a (M i) s) (SUP i. wp a (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "from baM"], ["proof (chain)\npicking this:\n  wp a (M ?i) ?s \\<le> c", "have \"wp a (M i) s \\<le> Sup (range (\\<lambda>i. wp a (M i) s))\""], ["proof (prove)\nusing this:\n  wp a (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. wp a (M i) s \\<le> (SUP i. wp a (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  wp a (M i) s \\<le> (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "ultimately"], ["proof (chain)\npicking this:\n  dist (wp a (M i) s) (SUP i. wp a (M i) s) < e\n  wp a (M i) s \\<le> (SUP i. wp a (M i) s)", "have \"Sup (range (\\<lambda>i. wp a (M i) s)) \\<le> wp a (M i) s + e\""], ["proof (prove)\nusing this:\n  dist (wp a (M i) s) (SUP i. wp a (M i) s) < e\n  wp a (M i) s \\<le> (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. (SUP i. wp a (M i) s) \\<le> wp a (M i) s + e", "by(simp add:dist_real_def)"], ["proof (state)\nthis:\n  (SUP i. wp a (M i) s) \\<le> wp a (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp a (M i) s) \\<le> wp a (M n) s + e", "thus \"\\<exists>i. Sup (range (\\<lambda>i. wp a (M i) s)) \\<le> wp a (M i) s + e\""], ["proof (prove)\nusing this:\n  (SUP i. wp a (M i) s) \\<le> wp a (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<exists>i. (SUP i. wp a (M i) s) \\<le> wp a (M i) s + e", "by(auto)"], ["proof (state)\nthis:\n  \\<exists>i. (SUP i. wp a (M i) s) \\<le> wp a (M i) s + e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>i. wp a (M i) s) \\<longlonglongrightarrow> (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>i. wp a (M i) s) \\<longlonglongrightarrow> (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "have \"(\\<lambda>i. wp b (M i) s) \\<longlonglongrightarrow> Sup (range (\\<lambda>i. wp b (M i) s))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>i. wp b (M i) s)\n    \\<longlonglongrightarrow> (SUP i. wp b (M i) s)", "proof(rule increasing_LIMSEQ)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. wp b (M n) s \\<le> wp b (M (Suc n)) s\n 2. \\<And>n. wp b (M n) s \\<le> (SUP i. wp b (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "fix n"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. wp b (M n) s \\<le> wp b (M (Suc n)) s\n 2. \\<And>n. wp b (M n) s \\<le> (SUP i. wp b (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "from mono_transD[OF healthy_monoD, OF hb] sM chain"], ["proof (chain)\npicking this:\n  \\<lbrakk>sound ?P; sound ?Q; ?P \\<tturnstile> ?Q\\<rbrakk>\n  \\<Longrightarrow> wp b ?P \\<tturnstile> wp b ?Q\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)", "show \"wp b (M n) s \\<le> wp b (M (Suc n)) s\""], ["proof (prove)\nusing this:\n  \\<lbrakk>sound ?P; sound ?Q; ?P \\<tturnstile> ?Q\\<rbrakk>\n  \\<Longrightarrow> wp b ?P \\<tturnstile> wp b ?Q\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)\n\ngoal (1 subgoal):\n 1. wp b (M n) s \\<le> wp b (M (Suc n)) s", "by(auto intro:le_funD)"], ["proof (state)\nthis:\n  wp b (M n) s \\<le> wp b (M (Suc n)) s\n\ngoal (2 subgoals):\n 1. \\<And>n. wp b (M n) s \\<le> (SUP i. wp b (M i) s)\n 2. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "from bbM"], ["proof (chain)\npicking this:\n  wp b (M ?i) ?s \\<le> c", "show \"wp b (M n) s \\<le> Sup (range (\\<lambda>i. wp b (M i) s))\""], ["proof (prove)\nusing this:\n  wp b (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. wp b (M n) s \\<le> (SUP i. wp b (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  wp b (M n) s \\<le> (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "fix e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "assume pe: \"0 < e\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "from bbM"], ["proof (chain)\npicking this:\n  wp b (M ?i) ?s \\<le> c", "have cSup: \"Sup (range (\\<lambda>i. wp b (M i) s)) \\<in> closure (range (\\<lambda>i. wp b (M i) s))\""], ["proof (prove)\nusing this:\n  wp b (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. (SUP i. wp b (M i) s) \\<in> closure (range (\\<lambda>i. wp b (M i) s))", "by(blast intro:closure_contains_Sup)"], ["proof (state)\nthis:\n  (SUP i. wp b (M i) s) \\<in> closure (range (\\<lambda>i. wp b (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "with pe"], ["proof (chain)\npicking this:\n  0 < e\n  (SUP i. wp b (M i) s) \\<in> closure (range (\\<lambda>i. wp b (M i) s))", "obtain y where yin: \"y \\<in> (range (\\<lambda>i. wp b (M i) s))\"\n                          and dy: \"dist y (Sup (range (\\<lambda>i. wp b (M i) s))) < e\""], ["proof (prove)\nusing this:\n  0 < e\n  (SUP i. wp b (M i) s) \\<in> closure (range (\\<lambda>i. wp b (M i) s))\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> range (\\<lambda>i. wp b (M i) s);\n         dist y (SUP i. wp b (M i) s) < e\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(blast dest:iffD1[OF closure_approachable])"], ["proof (state)\nthis:\n  y \\<in> range (\\<lambda>i. wp b (M i) s)\n  dist y (SUP i. wp b (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "from yin"], ["proof (chain)\npicking this:\n  y \\<in> range (\\<lambda>i. wp b (M i) s)", "obtain i where \"y = wp b (M i) s\""], ["proof (prove)\nusing this:\n  y \\<in> range (\\<lambda>i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (\\<And>i. y = wp b (M i) s \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(auto)"], ["proof (state)\nthis:\n  y = wp b (M i) s\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "with dy"], ["proof (chain)\npicking this:\n  dist y (SUP i. wp b (M i) s) < e\n  y = wp b (M i) s", "have \"dist (wp b (M i) s) (Sup (range (\\<lambda>i. wp b (M i) s))) < e\""], ["proof (prove)\nusing this:\n  dist y (SUP i. wp b (M i) s) < e\n  y = wp b (M i) s\n\ngoal (1 subgoal):\n 1. dist (wp b (M i) s) (SUP i. wp b (M i) s) < e", "by(simp)"], ["proof (state)\nthis:\n  dist (wp b (M i) s) (SUP i. wp b (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "moreover"], ["proof (state)\nthis:\n  dist (wp b (M i) s) (SUP i. wp b (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "from bbM"], ["proof (chain)\npicking this:\n  wp b (M ?i) ?s \\<le> c", "have \"wp b (M i) s \\<le> Sup (range (\\<lambda>i. wp b (M i) s))\""], ["proof (prove)\nusing this:\n  wp b (M ?i) ?s \\<le> c\n\ngoal (1 subgoal):\n 1. wp b (M i) s \\<le> (SUP i. wp b (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  wp b (M i) s \\<le> (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "ultimately"], ["proof (chain)\npicking this:\n  dist (wp b (M i) s) (SUP i. wp b (M i) s) < e\n  wp b (M i) s \\<le> (SUP i. wp b (M i) s)", "have \"Sup (range (\\<lambda>i. wp b (M i) s)) \\<le> wp b (M i) s + e\""], ["proof (prove)\nusing this:\n  dist (wp b (M i) s) (SUP i. wp b (M i) s) < e\n  wp b (M i) s \\<le> (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (SUP i. wp b (M i) s) \\<le> wp b (M i) s + e", "by(simp add:dist_real_def)"], ["proof (state)\nthis:\n  (SUP i. wp b (M i) s) \\<le> wp b (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. wp b (M i) s) \\<le> wp b (M n) s + e", "thus \"\\<exists>i. Sup (range (\\<lambda>i. wp b (M i) s)) \\<le> wp b (M i) s + e\""], ["proof (prove)\nusing this:\n  (SUP i. wp b (M i) s) \\<le> wp b (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<exists>i. (SUP i. wp b (M i) s) \\<le> wp b (M i) s + e", "by(auto)"], ["proof (state)\nthis:\n  \\<exists>i. (SUP i. wp b (M i) s) \\<le> wp b (M i) s + e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>i. wp b (M i) s) \\<longlonglongrightarrow> (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>i. wp a (M i) s) \\<longlonglongrightarrow> (SUP i. wp a (M i) s)\n  (\\<lambda>i. wp b (M i) s) \\<longlonglongrightarrow> (SUP i. wp b (M i) s)", "have \"(\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)) \\<longlonglongrightarrow>\n                       min (Sup (range (\\<lambda>i. wp a (M i) s))) (Sup (range (\\<lambda>i. wp b (M i) s)))\""], ["proof (prove)\nusing this:\n  (\\<lambda>i. wp a (M i) s) \\<longlonglongrightarrow> (SUP i. wp a (M i) s)\n  (\\<lambda>i. wp b (M i) s) \\<longlonglongrightarrow> (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s))\n    \\<longlonglongrightarrow> min (SUP i. wp a (M i) s)\n                               (SUP i. wp b (M i) s)", "by(rule tendsto_min)"], ["proof (state)\nthis:\n  (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s))\n  \\<longlonglongrightarrow> min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s))\n  \\<longlonglongrightarrow> min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "have \"bdd_above (range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bdd_above (range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)))", "proof(intro bdd_aboveI, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "have \"min (wp a (M i) s) (wp b (M i) s) \\<le> wp a (M i) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. min (wp a (M i) s) (wp b (M i) s) \\<le> wp a (M i) s", "by(auto)"], ["proof (state)\nthis:\n  min (wp a (M i) s) (wp b (M i) s) \\<le> wp a (M i) s\n\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "also"], ["proof (state)\nthis:\n  min (wp a (M i) s) (wp b (M i) s) \\<le> wp a (M i) s\n\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "{"], ["proof (state)\nthis:\n  min (wp a (M i) s) (wp b (M i) s) \\<le> wp a (M i) s\n\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "from ha sM bM"], ["proof (chain)\npicking this:\n  healthy (wp a)\n  sound (M ?i)\n  bounded_by c (M ?i)", "have \"bounded_by c (wp a (M i))\""], ["proof (prove)\nusing this:\n  healthy (wp a)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. bounded_by c (wp a (M i))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c (wp a (M i))\n\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "hence \"wp a (M i) s \\<le>  c\""], ["proof (prove)\nusing this:\n  bounded_by c (wp a (M i))\n\ngoal (1 subgoal):\n 1. wp a (M i) s \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  wp a (M i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "}"], ["proof (state)\nthis:\n  wp a (M i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>i. min (wp a (M i) s) (wp b (M i) s) \\<le> ?M", "finally"], ["proof (chain)\npicking this:\n  min (wp a (M i) s) (wp b (M i) s) \\<le> c", "show \"min (wp a (M i) s) (wp b (M i) s) \\<le> c\""], ["proof (prove)\nusing this:\n  min (wp a (M i) s) (wp b (M i) s) \\<le> c\n\ngoal (1 subgoal):\n 1. min (wp a (M i) s) (wp b (M i) s) \\<le> c", "."], ["proof (state)\nthis:\n  min (wp a (M i) s) (wp b (M i) s) \\<le> c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bdd_above (range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s))\n  \\<longlonglongrightarrow> min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n  bdd_above (range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)))", "have \"min (Sup (range (\\<lambda>i. wp a (M i) s))) (Sup (range (\\<lambda>i. wp b (M i) s))) \\<le>\n            Sup (range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)))\""], ["proof (prove)\nusing this:\n  (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s))\n  \\<longlonglongrightarrow> min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n  bdd_above (range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)))\n\ngoal (1 subgoal):\n 1. min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n    \\<le> (SUP i. min (wp a (M i) s) (wp b (M i) s))", "by(blast intro:LIMSEQ_le_const2 cSup_upper min.mono[OF baM bbM])"], ["proof (state)\nthis:\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n  \\<le> (SUP i. min (wp a (M i) s) (wp b (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "}"], ["proof (state)\nthis:\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n  \\<le> (SUP i. min (wp a (M i) s) (wp b (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "also"], ["proof (state)\nthis:\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n  \\<le> (SUP i. min (wp a (M i) s) (wp b (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "{"], ["proof (state)\nthis:\n  min (SUP i. wp a (M i) s) (SUP i. wp b (M i) s)\n  \\<le> (SUP i. min (wp a (M i) s) (wp b (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "have \"range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)) =\n            {f s |f. f \\<in> range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)) =\n    {f s |f.\n     f \\<in> range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))}", "by(auto)"], ["proof (state)\nthis:\n  range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)) =\n  {f s |f. f \\<in> range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "hence \"Sup (range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s))) =\n           Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s\""], ["proof (prove)\nusing this:\n  range (\\<lambda>i. min (wp a (M i) s) (wp b (M i) s)) =\n  {f s |f. f \\<in> range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))}\n\ngoal (1 subgoal):\n 1. (SUP i. min (wp a (M i) s) (wp b (M i) s)) =\n    Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s", "by (simp add: Sup_exp_def cong del: SUP_cong_simp)"], ["proof (state)\nthis:\n  (SUP i. min (wp a (M i) s) (wp b (M i) s)) =\n  Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "}"], ["proof (state)\nthis:\n  (SUP i. min (wp a (M i) s) (wp b (M i) s)) =\n  Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       min (wp a (Sup_exp (range M)) x) (wp b (Sup_exp (range M)) x)\n       \\<le> Sup_exp\n              (range (\\<lambda>x s. min (wp a (M x) s) (wp b (M x) s))) x", "finally"], ["proof (chain)\npicking this:\n  min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s)\n  \\<le> Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s", "show \"min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s) \\<le>\n                  Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s\""], ["proof (prove)\nusing this:\n  min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s)\n  \\<le> Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s\n\ngoal (1 subgoal):\n 1. min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s)\n    \\<le> Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s)))\n           s", "."], ["proof (state)\nthis:\n  min (wp a (Sup_exp (range M)) s) (wp b (Sup_exp (range M)) s)\n  \\<le> Sup_exp (range (\\<lambda>i s. min (wp a (M i) s) (wp b (M i) s))) s\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  wp (a \\<Sqinter> b)\n   (Sup_exp\n     (range\n       M)) \\<tturnstile> Sup_exp (range (wp (a \\<Sqinter> b) \\<circ> M))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_Seq:\n  fixes a b::\"'s prog\"\n  assumes ca: \"bd_cts (wp a)\"\n      and cb: \"bd_cts (wp b)\"\n      and hb: \"healthy (wp b)\"\n  shows \"bd_cts (wp (a ;; b))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (a ;; b))", "proof(rule bd_ctsI, simp add:o_def wp_eval)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "fix M::\"nat \\<Rightarrow> 's expect\" and c::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "assume chain: \"\\<And>i. M i \\<tturnstile> M (Suc i)\" and sM: \"\\<And>i. sound (M i)\"\n     and bM: \"\\<And>i. bounded_by c (M i)\""], ["proof (state)\nthis:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "hence \"wp a (wp b (Sup_exp (range M))) = wp a (Sup_exp (range (wp b o M)))\""], ["proof (prove)\nusing this:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. wp a (wp b (Sup_exp (range M))) =\n    wp a (Sup_exp (range (wp b \\<circ> M)))", "by(subst bd_ctsD[OF cb], auto)"], ["proof (state)\nthis:\n  wp a (wp b (Sup_exp (range M))) = wp a (Sup_exp (range (wp b \\<circ> M)))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "also"], ["proof (state)\nthis:\n  wp a (wp b (Sup_exp (range M))) = wp a (Sup_exp (range (wp b \\<circ> M)))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "{"], ["proof (state)\nthis:\n  wp a (wp b (Sup_exp (range M))) = wp a (Sup_exp (range (wp b \\<circ> M)))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "from sM hb"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  healthy (wp b)", "have \"\\<And>i. sound ((wp b o M) i)\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  healthy (wp b)\n\ngoal (1 subgoal):\n 1. \\<And>i. sound ((wp b \\<circ> M) i)", "by(auto)"], ["proof (state)\nthis:\n  sound ((wp b \\<circ> M) ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "moreover"], ["proof (state)\nthis:\n  sound ((wp b \\<circ> M) ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "from chain sM"], ["proof (chain)\npicking this:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)", "have \"\\<And>i. (wp b o M) i \\<tturnstile> (wp b o M) (Suc i)\""], ["proof (prove)\nusing this:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i. (wp b \\<circ> M) i \\<tturnstile> (wp b \\<circ> M) (Suc i)", "by(auto intro:mono_transD[OF healthy_monoD, OF hb])"], ["proof (state)\nthis:\n  (wp b \\<circ> M) ?i \\<tturnstile> (wp b \\<circ> M) (Suc ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "moreover"], ["proof (state)\nthis:\n  (wp b \\<circ> M) ?i \\<tturnstile> (wp b \\<circ> M) (Suc ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "from sM bM hb"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp b)", "have \"\\<And>i. bounded_by c ((wp b o M) i)\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp b)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by c ((wp b \\<circ> M) i)", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c ((wp b \\<circ> M) ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "ultimately"], ["proof (chain)\npicking this:\n  sound ((wp b \\<circ> M) ?i)\n  (wp b \\<circ> M) ?i \\<tturnstile> (wp b \\<circ> M) (Suc ?i)\n  bounded_by c ((wp b \\<circ> M) ?i)", "have \"wp a (Sup_exp (range (wp b o M))) =\n                     Sup_exp (range (wp a o (wp b o M)))\""], ["proof (prove)\nusing this:\n  sound ((wp b \\<circ> M) ?i)\n  (wp b \\<circ> M) ?i \\<tturnstile> (wp b \\<circ> M) (Suc ?i)\n  bounded_by c ((wp b \\<circ> M) ?i)\n\ngoal (1 subgoal):\n 1. wp a (Sup_exp (range (wp b \\<circ> M))) =\n    Sup_exp (range (wp a \\<circ> (wp b \\<circ> M)))", "by(subst bd_ctsD[OF ca], auto)"], ["proof (state)\nthis:\n  wp a (Sup_exp (range (wp b \\<circ> M))) =\n  Sup_exp (range (wp a \\<circ> (wp b \\<circ> M)))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "}"], ["proof (state)\nthis:\n  wp a (Sup_exp (range (wp b \\<circ> M))) =\n  Sup_exp (range (wp a \\<circ> (wp b \\<circ> M)))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "also"], ["proof (state)\nthis:\n  wp a (Sup_exp (range (wp b \\<circ> M))) =\n  Sup_exp (range (wp a \\<circ> (wp b \\<circ> M)))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "have \"Sup_exp (range (wp a o (wp b o M))) =\n             Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sup_exp (range (wp a \\<circ> (wp b \\<circ> M))) =\n    Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))", "by(simp add:o_def)"], ["proof (state)\nthis:\n  Sup_exp (range (wp a \\<circ> (wp b \\<circ> M))) =\n  Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))\n\ngoal (1 subgoal):\n 1. \\<And>ba M.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> wp a (wp b (Sup_exp (range M))) =\n                         Sup_exp (range (\\<lambda>x. wp a (wp b (M x))))", "finally"], ["proof (chain)\npicking this:\n  wp a (wp b (Sup_exp (range M))) =\n  Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))", "show \"wp a (wp b (Sup_exp (range M))) =\n                Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))\""], ["proof (prove)\nusing this:\n  wp a (wp b (Sup_exp (range M))) =\n  Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))\n\ngoal (1 subgoal):\n 1. wp a (wp b (Sup_exp (range M))) =\n    Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))", "."], ["proof (state)\nthis:\n  wp a (wp b (Sup_exp (range M))) =\n  Sup_exp (range (\\<lambda>i. wp a (wp b (M i))))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_PC:\n  fixes a b::\"'s prog\"\n  assumes ca: \"bd_cts (wp a)\"\n      and cb: \"bd_cts (wp b)\"\n      and ha: \"healthy (wp a)\"\n      and hb: \"healthy (wp b)\"\n      and up: \"unitary p\"\n  shows \"bd_cts (wp (PC a p b))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (a \\<^bsub>p\\<^esub>\\<oplus> b))", "proof(rule bd_ctsI, rule ext, simp add:o_def wp_eval)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "fix M::\"nat \\<Rightarrow> 's expect\" and c::real and s::'s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "assume chain: \"\\<And>i. M i \\<tturnstile> M (Suc i)\" and sM: \"\\<And>i. sound (M i)\"\n     and bM: \"\\<And>i. bounded_by c (M i)\""], ["proof (state)\nthis:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from sM"], ["proof (chain)\npicking this:\n  sound (M ?i)", "have \"\\<And>i. nneg (M i)\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i. nneg (M i)", "by(auto)"], ["proof (state)\nthis:\n  nneg (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "with bM"], ["proof (chain)\npicking this:\n  bounded_by c (M ?i)\n  nneg (M ?i)", "have nc: \"0 \\<le> c\""], ["proof (prove)\nusing this:\n  bounded_by c (M ?i)\n  nneg (M ?i)\n\ngoal (1 subgoal):\n 1. 0 \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from chain sM bM"], ["proof (chain)\npicking this:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)", "have \"wp a (Sup_exp (range M)) = Sup_exp (range (wp a o M))\""], ["proof (prove)\nusing this:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. wp a (Sup_exp (range M)) = Sup_exp (range (wp a \\<circ> M))", "by(rule bd_ctsD[OF ca])"], ["proof (state)\nthis:\n  wp a (Sup_exp (range M)) = Sup_exp (range (wp a \\<circ> M))\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"wp a (Sup_exp (range M)) s = Sup_exp (range (wp a o M)) s\""], ["proof (prove)\nusing this:\n  wp a (Sup_exp (range M)) = Sup_exp (range (wp a \\<circ> M))\n\ngoal (1 subgoal):\n 1. wp a (Sup_exp (range M)) s = Sup_exp (range (wp a \\<circ> M)) s", "by(simp)"], ["proof (state)\nthis:\n  wp a (Sup_exp (range M)) s = Sup_exp (range (wp a \\<circ> M)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  wp a (Sup_exp (range M)) s = Sup_exp (range (wp a \\<circ> M)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  wp a (Sup_exp (range M)) s = Sup_exp (range (wp a \\<circ> M)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"{f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} = range (\\<lambda>i. wp a (M i) s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} =\n    range (\\<lambda>i. wp a (M i) s)", "by(auto)"], ["proof (state)\nthis:\n  {f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} =\n  range (\\<lambda>i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"Sup_exp (range (wp a o M)) s = Sup (range (\\<lambda>i. wp a (M i) s))\""], ["proof (prove)\nusing this:\n  {f s |f. f \\<in> range (\\<lambda>x. wp a (M x))} =\n  range (\\<lambda>i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. Sup_exp (range (wp a \\<circ> M)) s = (SUP i. wp a (M i) s)", "by(simp add:Sup_exp_def o_def)"], ["proof (state)\nthis:\n  Sup_exp (range (wp a \\<circ> M)) s = (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  Sup_exp (range (wp a \\<circ> M)) s = (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "finally"], ["proof (chain)\npicking this:\n  wp a (Sup_exp (range M)) s = (SUP i. wp a (M i) s)", "have \"p s * wp a (Sup_exp (range M)) s =\n                p s * Sup (range (\\<lambda>i. wp a (M i) s))\""], ["proof (prove)\nusing this:\n  wp a (Sup_exp (range M)) s = (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. p s * wp a (Sup_exp (range M)) s = p s * (SUP i. wp a (M i) s)", "by(simp)"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s = p s * (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s = p s * (SUP i. wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"... = Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p s * (SUP i. wp a (M i) s) =\n    Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)}", "proof(rule cSup_mult, blast, clarsimp)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i. wp a (M i) s \\<le> ?b\n 2. 0 \\<le> p s", "from up"], ["proof (chain)\npicking this:\n  unitary p", "show \"0 \\<le> p s\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> p s", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> p s\n\ngoal (1 subgoal):\n 1. \\<And>i. wp a (M i) s \\<le> ?b", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. wp a (M i) s \\<le> ?b", "from sM bM ha"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp a)", "have \"bounded_by c (wp a (M i))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp a)\n\ngoal (1 subgoal):\n 1. bounded_by c (wp a (M i))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c (wp a (M i))\n\ngoal (1 subgoal):\n 1. \\<And>i. wp a (M i) s \\<le> ?b", "thus \"wp a (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  bounded_by c (wp a (M i))\n\ngoal (1 subgoal):\n 1. wp a (M i) s \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  wp a (M i) s \\<le> c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  p s * (SUP i. wp a (M i) s) =\n  Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)}\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  p s * (SUP i. wp a (M i) s) =\n  Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)}\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  p s * (SUP i. wp a (M i) s) =\n  Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)}\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"{p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} = range (\\<lambda>i. p s * wp a (M i) s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} =\n    range (\\<lambda>i. p s * wp a (M i) s)", "by(auto)"], ["proof (state)\nthis:\n  {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} =\n  range (\\<lambda>i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} =\n           Sup (range (\\<lambda>i. p s * wp a (M i) s))\""], ["proof (prove)\nusing this:\n  {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} =\n  range (\\<lambda>i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} =\n    (SUP i. p s * wp a (M i) s)", "by(simp)"], ["proof (state)\nthis:\n  Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} =\n  (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  Sup {p s * x |x. x \\<in> range (\\<lambda>i. wp a (M i) s)} =\n  (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "finally"], ["proof (chain)\npicking this:\n  p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)", "have \"p s * wp a (Sup_exp (range M)) s = Sup (range (\\<lambda>i. p s * wp a (M i) s))\""], ["proof (prove)\nusing this:\n  p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)", "."], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "moreover"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from chain sM bM"], ["proof (chain)\npicking this:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)", "have \"wp b (Sup_exp (range M)) = Sup_exp (range (wp b o M))\""], ["proof (prove)\nusing this:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. wp b (Sup_exp (range M)) = Sup_exp (range (wp b \\<circ> M))", "by(rule bd_ctsD[OF cb])"], ["proof (state)\nthis:\n  wp b (Sup_exp (range M)) = Sup_exp (range (wp b \\<circ> M))\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"wp b (Sup_exp (range M)) s = Sup_exp (range (wp b o M)) s\""], ["proof (prove)\nusing this:\n  wp b (Sup_exp (range M)) = Sup_exp (range (wp b \\<circ> M))\n\ngoal (1 subgoal):\n 1. wp b (Sup_exp (range M)) s = Sup_exp (range (wp b \\<circ> M)) s", "by(simp)"], ["proof (state)\nthis:\n  wp b (Sup_exp (range M)) s = Sup_exp (range (wp b \\<circ> M)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  wp b (Sup_exp (range M)) s = Sup_exp (range (wp b \\<circ> M)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  wp b (Sup_exp (range M)) s = Sup_exp (range (wp b \\<circ> M)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"{f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} = range (\\<lambda>i. wp b (M i) s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} =\n    range (\\<lambda>i. wp b (M i) s)", "by(auto)"], ["proof (state)\nthis:\n  {f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} =\n  range (\\<lambda>i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"Sup_exp (range (wp b o M)) s = Sup (range (\\<lambda>i. wp b (M i) s))\""], ["proof (prove)\nusing this:\n  {f s |f. f \\<in> range (\\<lambda>x. wp b (M x))} =\n  range (\\<lambda>i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. Sup_exp (range (wp b \\<circ> M)) s = (SUP i. wp b (M i) s)", "by(simp add:Sup_exp_def o_def)"], ["proof (state)\nthis:\n  Sup_exp (range (wp b \\<circ> M)) s = (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  Sup_exp (range (wp b \\<circ> M)) s = (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "finally"], ["proof (chain)\npicking this:\n  wp b (Sup_exp (range M)) s = (SUP i. wp b (M i) s)", "have \"(1 - p s) * wp b (Sup_exp (range M)) s =\n                  (1 - p s) * Sup (range (\\<lambda>i. wp b (M i) s))\""], ["proof (prove)\nusing this:\n  wp b (Sup_exp (range M)) s = (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (1 - p s) * wp b (Sup_exp (range M)) s =\n    (1 - p s) * (SUP i. wp b (M i) s)", "by(simp)"], ["proof (state)\nthis:\n  (1 - p s) * wp b (Sup_exp (range M)) s = (1 - p s) * (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  (1 - p s) * wp b (Sup_exp (range M)) s = (1 - p s) * (SUP i. wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"... = Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (1 - p s) * (SUP i. wp b (M i) s) =\n    Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)}", "proof(rule cSup_mult, blast, clarsimp)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i. wp b (M i) s \\<le> ?b\n 2. 0 \\<le> 1 - p s", "from up"], ["proof (chain)\npicking this:\n  unitary p", "show \"0 \\<le> 1 - p s\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> 1 - p s", "by auto"], ["proof (state)\nthis:\n  0 \\<le> 1 - p s\n\ngoal (1 subgoal):\n 1. \\<And>i. wp b (M i) s \\<le> ?b", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i. wp b (M i) s \\<le> ?b", "from sM bM hb"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp b)", "have \"bounded_by c (wp b (M i))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n  healthy (wp b)\n\ngoal (1 subgoal):\n 1. bounded_by c (wp b (M i))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c (wp b (M i))\n\ngoal (1 subgoal):\n 1. \\<And>i. wp b (M i) s \\<le> ?b", "thus \"wp b (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  bounded_by c (wp b (M i))\n\ngoal (1 subgoal):\n 1. wp b (M i) s \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  wp b (M i) s \\<le> c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (1 - p s) * (SUP i. wp b (M i) s) =\n  Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)}\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  (1 - p s) * (SUP i. wp b (M i) s) =\n  Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)}\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  (1 - p s) * (SUP i. wp b (M i) s) =\n  Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)}\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"{(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n            range (\\<lambda>i. (1 - p s) * wp b (M i) s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n    range (\\<lambda>i. (1 - p s) * wp b (M i) s)", "by(auto)"], ["proof (state)\nthis:\n  {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n  range (\\<lambda>i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n             Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n  range (\\<lambda>i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n    (SUP i. (1 - p s) * wp b (M i) s)", "by(simp)"], ["proof (state)\nthis:\n  Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n  (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  Sup {(1 - p s) * x |x. x \\<in> range (\\<lambda>i. wp b (M i) s)} =\n  (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "finally"], ["proof (chain)\npicking this:\n  (1 - p s) * wp b (Sup_exp (range M)) s = (SUP i. (1 - p s) * wp b (M i) s)", "have \"(1 - p s) * wp b (Sup_exp (range M)) s =\n                  Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  (1 - p s) * wp b (Sup_exp (range M)) s = (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (1 - p s) * wp b (Sup_exp (range M)) s =\n    (SUP i. (1 - p s) * wp b (M i) s)", "."], ["proof (state)\nthis:\n  (1 - p s) * wp b (Sup_exp (range M)) s = (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  (1 - p s) * wp b (Sup_exp (range M)) s = (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "ultimately"], ["proof (chain)\npicking this:\n  p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)\n  (1 - p s) * wp b (Sup_exp (range M)) s = (SUP i. (1 - p s) * wp b (M i) s)", "have \"p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s =\n        Sup (range (\\<lambda>i. p s * wp a (M i) s)) + Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  p s * wp a (Sup_exp (range M)) s = (SUP i. p s * wp a (M i) s)\n  (1 - p s) * wp b (Sup_exp (range M)) s = (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. p s * wp a (Sup_exp (range M)) s +\n    (1 - p s) * wp b (Sup_exp (range M)) s =\n    (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)", "by(simp)"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s +\n  (1 - p s) * wp b (Sup_exp (range M)) s =\n  (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s +\n  (1 - p s) * wp b (Sup_exp (range M)) s =\n  (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s +\n  (1 - p s) * wp b (Sup_exp (range M)) s =\n  (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from bM sM ha"], ["proof (chain)\npicking this:\n  bounded_by c (M ?i)\n  sound (M ?i)\n  healthy (wp a)", "have \"\\<And>i. bounded_by c (wp a (M i))\""], ["proof (prove)\nusing this:\n  bounded_by c (M ?i)\n  sound (M ?i)\n  healthy (wp a)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by c (wp a (M i))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c (wp a (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"\\<And>i. wp a (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  bounded_by c (wp a (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>i. wp a (M i) s \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  wp a (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "moreover"], ["proof (state)\nthis:\n  wp a (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"0 \\<le> p s\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> p s", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> p s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "ultimately"], ["proof (chain)\npicking this:\n  wp a (M ?i) s \\<le> c\n  0 \\<le> p s", "have \"\\<And>i. p s * wp a (M i) s \\<le> p s * c\""], ["proof (prove)\nusing this:\n  wp a (M ?i) s \\<le> c\n  0 \\<le> p s\n\ngoal (1 subgoal):\n 1. \\<And>i. p s * wp a (M i) s \\<le> p s * c", "by(auto intro:mult_left_mono)"], ["proof (state)\nthis:\n  p s * wp a (M ?i) s \\<le> p s * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  p s * wp a (M ?i) s \\<le> p s * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from up nc"], ["proof (chain)\npicking this:\n  unitary p\n  0 \\<le> c", "have \"p s * c \\<le> 1 * c\""], ["proof (prove)\nusing this:\n  unitary p\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. p s * c \\<le> 1 * c", "by(blast intro:mult_right_mono)"], ["proof (state)\nthis:\n  p s * c \\<le> 1 * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  p s * c \\<le> 1 * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"... = c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 * c = c", "by(simp)"], ["proof (state)\nthis:\n  1 * c = c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "finally"], ["proof (chain)\npicking this:\n  p s * wp a (M ?i2) s \\<le> c", "have baM: \"\\<And>i. p s * wp a (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  p s * wp a (M ?i2) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>i. p s * wp a (M i) s \\<le> c", "."], ["proof (state)\nthis:\n  p s * wp a (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have lima: \"(\\<lambda>i. p s * wp a (M i) s) \\<longlonglongrightarrow> Sup (range (\\<lambda>i. p s * wp a (M i) s))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>i. p s * wp a (M i) s)\n    \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s)", "proof(rule increasing_LIMSEQ)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. p s * wp a (M n) s \\<le> p s * wp a (M (Suc n)) s\n 2. \\<And>n. p s * wp a (M n) s \\<le> (SUP i. p s * wp a (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "fix n"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. p s * wp a (M n) s \\<le> p s * wp a (M (Suc n)) s\n 2. \\<And>n. p s * wp a (M n) s \\<le> (SUP i. p s * wp a (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "from sM chain healthy_monoD[OF ha]"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)\n  mono_trans (wp a)", "have \"wp a (M n) \\<tturnstile> wp a (M (Suc n))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)\n  mono_trans (wp a)\n\ngoal (1 subgoal):\n 1. wp a (M n) \\<tturnstile> wp a (M (Suc n))", "by(auto)"], ["proof (state)\nthis:\n  wp a (M n) \\<tturnstile> wp a (M (Suc n))\n\ngoal (3 subgoals):\n 1. \\<And>n. p s * wp a (M n) s \\<le> p s * wp a (M (Suc n)) s\n 2. \\<And>n. p s * wp a (M n) s \\<le> (SUP i. p s * wp a (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "with up"], ["proof (chain)\npicking this:\n  unitary p\n  wp a (M n) \\<tturnstile> wp a (M (Suc n))", "show \"p s * wp a (M n) s \\<le> p s * wp a (M (Suc n)) s\""], ["proof (prove)\nusing this:\n  unitary p\n  wp a (M n) \\<tturnstile> wp a (M (Suc n))\n\ngoal (1 subgoal):\n 1. p s * wp a (M n) s \\<le> p s * wp a (M (Suc n)) s", "by(blast intro:mult_left_mono)"], ["proof (state)\nthis:\n  p s * wp a (M n) s \\<le> p s * wp a (M (Suc n)) s\n\ngoal (2 subgoals):\n 1. \\<And>n. p s * wp a (M n) s \\<le> (SUP i. p s * wp a (M i) s)\n 2. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "from baM"], ["proof (chain)\npicking this:\n  p s * wp a (M ?i) s \\<le> c", "show \"p s * wp a (M n) s \\<le> Sup (range (\\<lambda>i. p s * wp a (M i) s))\""], ["proof (prove)\nusing this:\n  p s * wp a (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. p s * wp a (M n) s \\<le> (SUP i. p s * wp a (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  p s * wp a (M n) s \\<le> (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "fix e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "assume pe: \"0 < e\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "from baM"], ["proof (chain)\npicking this:\n  p s * wp a (M ?i) s \\<le> c", "have \"Sup (range (\\<lambda>i. p s * wp a (M i) s)) \\<in>\n                     closure (range (\\<lambda>i. p s * wp a (M i) s))\""], ["proof (prove)\nusing this:\n  p s * wp a (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. (SUP i. p s * wp a (M i) s)\n    \\<in> closure (range (\\<lambda>i. p s * wp a (M i) s))", "by(blast intro:closure_contains_Sup)"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s)\n  \\<in> closure (range (\\<lambda>i. p s * wp a (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "thm closure_approachable"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s)\n  \\<in> closure (range (\\<lambda>i. p s * wp a (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "with pe"], ["proof (chain)\npicking this:\n  0 < e\n  (SUP i. p s * wp a (M i) s)\n  \\<in> closure (range (\\<lambda>i. p s * wp a (M i) s))", "obtain y where yin: \"y \\<in> range (\\<lambda>i. p s * wp a (M i) s)\"\n                         and dy: \"dist y (Sup (range (\\<lambda>i. p s * wp a (M i) s))) < e\""], ["proof (prove)\nusing this:\n  0 < e\n  (SUP i. p s * wp a (M i) s)\n  \\<in> closure (range (\\<lambda>i. p s * wp a (M i) s))\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> range (\\<lambda>i. p s * wp a (M i) s);\n         dist y (SUP i. p s * wp a (M i) s) < e\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(blast dest:iffD1[OF closure_approachable])"], ["proof (state)\nthis:\n  y \\<in> range (\\<lambda>i. p s * wp a (M i) s)\n  dist y (SUP i. p s * wp a (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "from yin"], ["proof (chain)\npicking this:\n  y \\<in> range (\\<lambda>i. p s * wp a (M i) s)", "obtain i where \"y = p s * wp a (M i) s\""], ["proof (prove)\nusing this:\n  y \\<in> range (\\<lambda>i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. (\\<And>i.\n        y = p s * wp a (M i) s \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(auto)"], ["proof (state)\nthis:\n  y = p s * wp a (M i) s\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "with dy"], ["proof (chain)\npicking this:\n  dist y (SUP i. p s * wp a (M i) s) < e\n  y = p s * wp a (M i) s", "have \"dist (p s * wp a (M i) s) (Sup (range (\\<lambda>i. p s * wp a (M i) s))) < e\""], ["proof (prove)\nusing this:\n  dist y (SUP i. p s * wp a (M i) s) < e\n  y = p s * wp a (M i) s\n\ngoal (1 subgoal):\n 1. dist (p s * wp a (M i) s) (SUP i. p s * wp a (M i) s) < e", "by(simp)"], ["proof (state)\nthis:\n  dist (p s * wp a (M i) s) (SUP i. p s * wp a (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "moreover"], ["proof (state)\nthis:\n  dist (p s * wp a (M i) s) (SUP i. p s * wp a (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "from baM"], ["proof (chain)\npicking this:\n  p s * wp a (M ?i) s \\<le> c", "have \"p s * wp a (M i) s \\<le> Sup (range (\\<lambda>i. p s * wp a (M i) s))\""], ["proof (prove)\nusing this:\n  p s * wp a (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. p s * wp a (M i) s \\<le> (SUP i. p s * wp a (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  p s * wp a (M i) s \\<le> (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "ultimately"], ["proof (chain)\npicking this:\n  dist (p s * wp a (M i) s) (SUP i. p s * wp a (M i) s) < e\n  p s * wp a (M i) s \\<le> (SUP i. p s * wp a (M i) s)", "have \"Sup (range (\\<lambda>i. p s * wp a (M i) s)) \\<le> p s * wp a (M i) s + e\""], ["proof (prove)\nusing this:\n  dist (p s * wp a (M i) s) (SUP i. p s * wp a (M i) s) < e\n  p s * wp a (M i) s \\<le> (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M i) s + e", "by(simp add:dist_real_def)"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M n) s + e", "thus \"\\<exists>i. Sup (range (\\<lambda>i. p s * wp a (M i) s)) \\<le> p s * wp a (M i) s + e\""], ["proof (prove)\nusing this:\n  (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<exists>i. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M i) s + e", "by(auto)"], ["proof (state)\nthis:\n  \\<exists>i. (SUP i. p s * wp a (M i) s) \\<le> p s * wp a (M i) s + e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>i. p s * wp a (M i) s)\n  \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from bM sM hb"], ["proof (chain)\npicking this:\n  bounded_by c (M ?i)\n  sound (M ?i)\n  healthy (wp b)", "have \"\\<And>i. bounded_by c (wp b (M i))\""], ["proof (prove)\nusing this:\n  bounded_by c (M ?i)\n  sound (M ?i)\n  healthy (wp b)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by c (wp b (M i))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by c (wp b (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"\\<And>i. wp b (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  bounded_by c (wp b (M ?i))\n\ngoal (1 subgoal):\n 1. \\<And>i. wp b (M i) s \\<le> c", "by(auto)"], ["proof (state)\nthis:\n  wp b (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "moreover"], ["proof (state)\nthis:\n  wp b (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"0 \\<le> (1 - p s)\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> 1 - p s", "by auto"], ["proof (state)\nthis:\n  0 \\<le> 1 - p s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "ultimately"], ["proof (chain)\npicking this:\n  wp b (M ?i) s \\<le> c\n  0 \\<le> 1 - p s", "have \"\\<And>i. (1 - p s) * wp b (M i) s \\<le> (1 - p s) * c\""], ["proof (prove)\nusing this:\n  wp b (M ?i) s \\<le> c\n  0 \\<le> 1 - p s\n\ngoal (1 subgoal):\n 1. \\<And>i. (1 - p s) * wp b (M i) s \\<le> (1 - p s) * c", "by(auto intro:mult_left_mono)"], ["proof (state)\nthis:\n  (1 - p s) * wp b (M ?i) s \\<le> (1 - p s) * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  (1 - p s) * wp b (M ?i) s \\<le> (1 - p s) * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  (1 - p s) * wp b (M ?i) s \\<le> (1 - p s) * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"1 - p s \\<le> 1\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 1 - p s \\<le> 1", "by(auto)"], ["proof (state)\nthis:\n  1 - p s \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "with nc"], ["proof (chain)\npicking this:\n  0 \\<le> c\n  1 - p s \\<le> 1", "have \"(1 - p s) * c \\<le> 1 * c\""], ["proof (prove)\nusing this:\n  0 \\<le> c\n  1 - p s \\<le> 1\n\ngoal (1 subgoal):\n 1. (1 - p s) * c \\<le> 1 * c", "by(blast intro:mult_right_mono)"], ["proof (state)\nthis:\n  (1 - p s) * c \\<le> 1 * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  (1 - p s) * c \\<le> 1 * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  (1 - p s) * c \\<le> 1 * c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"1 * c = c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 * c = c", "by(simp)"], ["proof (state)\nthis:\n  1 * c = c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "finally"], ["proof (chain)\npicking this:\n  (1 - p s) * wp b (M ?i2) s \\<le> c", "have bbM: \"\\<And>i. (1 - p s) * wp b (M i) s \\<le> c\""], ["proof (prove)\nusing this:\n  (1 - p s) * wp b (M ?i2) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>i. (1 - p s) * wp b (M i) s \\<le> c", "."], ["proof (state)\nthis:\n  (1 - p s) * wp b (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have limb: \"(\\<lambda>i. (1 - p s) * wp b (M i) s) \\<longlonglongrightarrow> Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>i. (1 - p s) * wp b (M i) s)\n    \\<longlonglongrightarrow> (SUP i. (1 - p s) * wp b (M i) s)", "proof(rule increasing_LIMSEQ)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. (1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s\n 2. \\<And>n.\n       (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "fix n"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n. (1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s\n 2. \\<And>n.\n       (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "from sM chain healthy_monoD[OF hb]"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)\n  mono_trans (wp b)", "have \"wp b (M n) \\<tturnstile> wp b (M (Suc n))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  M ?i \\<tturnstile> M (Suc ?i)\n  mono_trans (wp b)\n\ngoal (1 subgoal):\n 1. wp b (M n) \\<tturnstile> wp b (M (Suc n))", "by(auto)"], ["proof (state)\nthis:\n  wp b (M n) \\<tturnstile> wp b (M (Suc n))\n\ngoal (3 subgoals):\n 1. \\<And>n. (1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s\n 2. \\<And>n.\n       (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "moreover"], ["proof (state)\nthis:\n  wp b (M n) \\<tturnstile> wp b (M (Suc n))\n\ngoal (3 subgoals):\n 1. \\<And>n. (1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s\n 2. \\<And>n.\n       (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"0 \\<le> 1 - p s\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> 1 - p s", "by auto"], ["proof (state)\nthis:\n  0 \\<le> 1 - p s\n\ngoal (3 subgoals):\n 1. \\<And>n. (1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s\n 2. \\<And>n.\n       (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n 3. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "ultimately"], ["proof (chain)\npicking this:\n  wp b (M n) \\<tturnstile> wp b (M (Suc n))\n  0 \\<le> 1 - p s", "show \"(1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s\""], ["proof (prove)\nusing this:\n  wp b (M n) \\<tturnstile> wp b (M (Suc n))\n  0 \\<le> 1 - p s\n\ngoal (1 subgoal):\n 1. (1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s", "by(blast intro:mult_left_mono)"], ["proof (state)\nthis:\n  (1 - p s) * wp b (M n) s \\<le> (1 - p s) * wp b (M (Suc n)) s\n\ngoal (2 subgoals):\n 1. \\<And>n.\n       (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n 2. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "from bbM"], ["proof (chain)\npicking this:\n  (1 - p s) * wp b (M ?i) s \\<le> c", "show \"(1 - p s) * wp b (M n) s \\<le> Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  (1 - p s) * wp b (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  (1 - p s) * wp b (M n) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "fix e::real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "assume pe: \"0 < e\""], ["proof (state)\nthis:\n  0 < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "from bbM"], ["proof (chain)\npicking this:\n  (1 - p s) * wp b (M ?i) s \\<le> c", "have \"Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s)) \\<in>\n                     closure (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  (1 - p s) * wp b (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. (SUP i. (1 - p s) * wp b (M i) s)\n    \\<in> closure (range (\\<lambda>i. (1 - p s) * wp b (M i) s))", "by(blast intro:closure_contains_Sup)"], ["proof (state)\nthis:\n  (SUP i. (1 - p s) * wp b (M i) s)\n  \\<in> closure (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "with pe"], ["proof (chain)\npicking this:\n  0 < e\n  (SUP i. (1 - p s) * wp b (M i) s)\n  \\<in> closure (range (\\<lambda>i. (1 - p s) * wp b (M i) s))", "obtain y where yin: \"y \\<in> range (\\<lambda>i. (1 - p s) * wp b (M i) s)\"\n                         and dy: \"dist y (Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))) < e\""], ["proof (prove)\nusing this:\n  0 < e\n  (SUP i. (1 - p s) * wp b (M i) s)\n  \\<in> closure (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        \\<lbrakk>y \\<in> range (\\<lambda>i. (1 - p s) * wp b (M i) s);\n         dist y (SUP i. (1 - p s) * wp b (M i) s) < e\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(blast dest:iffD1[OF closure_approachable])"], ["proof (state)\nthis:\n  y \\<in> range (\\<lambda>i. (1 - p s) * wp b (M i) s)\n  dist y (SUP i. (1 - p s) * wp b (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "from yin"], ["proof (chain)\npicking this:\n  y \\<in> range (\\<lambda>i. (1 - p s) * wp b (M i) s)", "obtain i where \"y = (1 - p s) * wp b (M i) s\""], ["proof (prove)\nusing this:\n  y \\<in> range (\\<lambda>i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (\\<And>i.\n        y = (1 - p s) * wp b (M i) s \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by(auto)"], ["proof (state)\nthis:\n  y = (1 - p s) * wp b (M i) s\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "with dy"], ["proof (chain)\npicking this:\n  dist y (SUP i. (1 - p s) * wp b (M i) s) < e\n  y = (1 - p s) * wp b (M i) s", "have \"dist ((1 - p s) * wp b (M i) s)\n                         (Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))) < e\""], ["proof (prove)\nusing this:\n  dist y (SUP i. (1 - p s) * wp b (M i) s) < e\n  y = (1 - p s) * wp b (M i) s\n\ngoal (1 subgoal):\n 1. dist ((1 - p s) * wp b (M i) s) (SUP i. (1 - p s) * wp b (M i) s) < e", "by(simp)"], ["proof (state)\nthis:\n  dist ((1 - p s) * wp b (M i) s) (SUP i. (1 - p s) * wp b (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "moreover"], ["proof (state)\nthis:\n  dist ((1 - p s) * wp b (M i) s) (SUP i. (1 - p s) * wp b (M i) s) < e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "from bbM"], ["proof (chain)\npicking this:\n  (1 - p s) * wp b (M ?i) s \\<le> c", "have \"(1 - p s) * wp b (M i) s \\<le> Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  (1 - p s) * wp b (M ?i) s \\<le> c\n\ngoal (1 subgoal):\n 1. (1 - p s) * wp b (M i) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  (1 - p s) * wp b (M i) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "ultimately"], ["proof (chain)\npicking this:\n  dist ((1 - p s) * wp b (M i) s) (SUP i. (1 - p s) * wp b (M i) s) < e\n  (1 - p s) * wp b (M i) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)", "have \"Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s)) \\<le> (1 - p s) * wp b (M i) s + e\""], ["proof (prove)\nusing this:\n  dist ((1 - p s) * wp b (M i) s) (SUP i. (1 - p s) * wp b (M i) s) < e\n  (1 - p s) * wp b (M i) s \\<le> (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (SUP i. (1 - p s) * wp b (M i) s) \\<le> (1 - p s) * wp b (M i) s + e", "by(simp add:dist_real_def)"], ["proof (state)\nthis:\n  (SUP i. (1 - p s) * wp b (M i) s) \\<le> (1 - p s) * wp b (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<And>e.\n       0 < e \\<Longrightarrow>\n       \\<exists>n.\n          (SUP i. (1 - p s) * wp b (M i) s)\n          \\<le> (1 - p s) * wp b (M n) s + e", "thus \"\\<exists>i. Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s)) \\<le> (1 - p s) * wp b (M i) s + e\""], ["proof (prove)\nusing this:\n  (SUP i. (1 - p s) * wp b (M i) s) \\<le> (1 - p s) * wp b (M i) s + e\n\ngoal (1 subgoal):\n 1. \\<exists>i.\n       (SUP i. (1 - p s) * wp b (M i) s) \\<le> (1 - p s) * wp b (M i) s + e", "by(auto)"], ["proof (state)\nthis:\n  \\<exists>i.\n     (SUP i. (1 - p s) * wp b (M i) s) \\<le> (1 - p s) * wp b (M i) s + e\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>i. (1 - p s) * wp b (M i) s)\n  \\<longlonglongrightarrow> (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from lima limb"], ["proof (chain)\npicking this:\n  (\\<lambda>i. p s * wp a (M i) s)\n  \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s)\n  (\\<lambda>i. (1 - p s) * wp b (M i) s)\n  \\<longlonglongrightarrow> (SUP i. (1 - p s) * wp b (M i) s)", "have \"(\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) \\<longlonglongrightarrow>\n      Sup (range (\\<lambda>i. p s * wp a (M i) s)) + Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  (\\<lambda>i. p s * wp a (M i) s)\n  \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s)\n  (\\<lambda>i. (1 - p s) * wp b (M i) s)\n  \\<longlonglongrightarrow> (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n    \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s) +\n                              (SUP i. (1 - p s) * wp b (M i) s)", "by(rule tendsto_add)"], ["proof (state)\nthis:\n  (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n  \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s) +\n                            (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "moreover"], ["proof (state)\nthis:\n  (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n  \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s) +\n                            (SUP i. (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "from add_mono[OF baM bbM]"], ["proof (chain)\npicking this:\n  p s * wp a (M ?i2) s + (1 - p s) * wp b (M ?i1) s \\<le> c + c", "have \"\\<And>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s \\<le>\n                       Sup (range (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  p s * wp a (M ?i2) s + (1 - p s) * wp b (M ?i1) s \\<le> c + c\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       p s * wp a (M i) s + (1 - p s) * wp b (M i) s\n       \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)", "by(intro cSup_upper bdd_aboveI, auto)"], ["proof (state)\nthis:\n  p s * wp a (M ?i) s + (1 - p s) * wp b (M ?i) s\n  \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "ultimately"], ["proof (chain)\npicking this:\n  (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n  \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s) +\n                            (SUP i. (1 - p s) * wp b (M i) s)\n  p s * wp a (M ?i) s + (1 - p s) * wp b (M ?i) s\n  \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)", "have \"Sup (range (\\<lambda>i. p s * wp a (M i) s)) +\n                     Sup (range (\\<lambda>i. (1 - p s) * wp b (M i) s)) \\<le>\n                     Sup (range (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s))\""], ["proof (prove)\nusing this:\n  (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n  \\<longlonglongrightarrow> (SUP i. p s * wp a (M i) s) +\n                            (SUP i. (1 - p s) * wp b (M i) s)\n  p s * wp a (M ?i) s + (1 - p s) * wp b (M ?i) s\n  \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n    \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)", "by(blast intro: LIMSEQ_le_const2)"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n  \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n  \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "also"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n  \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "{"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s) + (SUP i. (1 - p s) * wp b (M i) s)\n  \\<le> (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"range (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) =\n          {f s |f. f \\<in> range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. range (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) =\n    {f s |f.\n     f \\<in> range\n              (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)}", "by(auto)"], ["proof (state)\nthis:\n  range (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) =\n  {f s |f.\n   f \\<in> range\n            (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)}\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "hence \"Sup (range (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)) =\n           Sup_exp (range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)) s\""], ["proof (prove)\nusing this:\n  range (\\<lambda>i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) =\n  {f s |f.\n   f \\<in> range\n            (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)}\n\ngoal (1 subgoal):\n 1. (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) =\n    Sup_exp\n     (range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)) s", "by (simp add: Sup_exp_def cong del: SUP_cong_simp)"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) =\n  Sup_exp\n   (range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "}"], ["proof (state)\nthis:\n  (SUP i. p s * wp a (M i) s + (1 - p s) * wp b (M i) s) =\n  Sup_exp\n   (range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "finally"], ["proof (chain)\npicking this:\n  p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\n  \\<le> Sup_exp\n         (range\n           (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s))\n         s", "have \"p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s \\<le>\n        Sup_exp (range (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)) s\""], ["proof (prove)\nusing this:\n  p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\n  \\<le> Sup_exp\n         (range\n           (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s))\n         s\n\ngoal (1 subgoal):\n 1. p s * wp a (Sup_exp (range M)) s +\n    (1 - p s) * wp b (Sup_exp (range M)) s\n    \\<le> Sup_exp\n           (range\n             (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s))\n           s", "."], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\n  \\<le> Sup_exp\n         (range\n           (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s))\n         s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "moreover"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\n  \\<le> Sup_exp\n         (range\n           (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s))\n         s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "have \"Sup_exp (range (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)) s \\<le>\n        p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sup_exp\n     (range (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)) s\n    \\<le> p s * wp a (Sup_exp (range M)) s +\n          (1 - p s) * wp b (Sup_exp (range M)) s", "proof(rule le_funD[OF Sup_exp_least], clarsimp, rule le_funI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "fix i::nat and s::'s"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "from bM"], ["proof (chain)\npicking this:\n  bounded_by c (M ?i)", "have leSup: \"M i \\<tturnstile> Sup_exp (range M)\""], ["proof (prove)\nusing this:\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. M i \\<tturnstile> Sup_exp (range M)", "by(blast intro: Sup_exp_upper)"], ["proof (state)\nthis:\n  M i \\<tturnstile> Sup_exp (range M)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "moreover"], ["proof (state)\nthis:\n  M i \\<tturnstile> Sup_exp (range M)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "from sM bM"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by c (M ?i)", "have sSup: \"sound (Sup_exp (range M))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by c (M ?i)\n\ngoal (1 subgoal):\n 1. sound (Sup_exp (range M))", "by(auto intro:Sup_exp_sound)"], ["proof (state)\nthis:\n  sound (Sup_exp (range M))\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "moreover"], ["proof (state)\nthis:\n  sound (Sup_exp (range M))\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "note healthy_monoD[OF ha] sM"], ["proof (state)\nthis:\n  mono_trans (wp a)\n  sound (M ?i)\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "ultimately"], ["proof (chain)\npicking this:\n  M i \\<tturnstile> Sup_exp (range M)\n  sound (Sup_exp (range M))\n  mono_trans (wp a)\n  sound (M ?i)", "have \"wp a (M i) \\<tturnstile> wp a (Sup_exp (range M))\""], ["proof (prove)\nusing this:\n  M i \\<tturnstile> Sup_exp (range M)\n  sound (Sup_exp (range M))\n  mono_trans (wp a)\n  sound (M ?i)\n\ngoal (1 subgoal):\n 1. wp a (M i) \\<tturnstile> wp a (Sup_exp (range M))", "by(auto)"], ["proof (state)\nthis:\n  wp a (M i) \\<tturnstile> wp a (Sup_exp (range M))\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "hence \"wp a (M i) s \\<le> wp a (Sup_exp (range M)) s\""], ["proof (prove)\nusing this:\n  wp a (M i) \\<tturnstile> wp a (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. wp a (M i) s \\<le> wp a (Sup_exp (range M)) s", "by(auto)"], ["proof (state)\nthis:\n  wp a (M i) s \\<le> wp a (Sup_exp (range M)) s\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "moreover"], ["proof (state)\nthis:\n  wp a (M i) s \\<le> wp a (Sup_exp (range M)) s\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "{"], ["proof (state)\nthis:\n  wp a (M i) s \\<le> wp a (Sup_exp (range M)) s\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "from leSup sSup healthy_monoD[OF hb] sM"], ["proof (chain)\npicking this:\n  M i \\<tturnstile> Sup_exp (range M)\n  sound (Sup_exp (range M))\n  mono_trans (wp b)\n  sound (M ?i)", "have \"wp b (M i) \\<tturnstile> wp b (Sup_exp (range M))\""], ["proof (prove)\nusing this:\n  M i \\<tturnstile> Sup_exp (range M)\n  sound (Sup_exp (range M))\n  mono_trans (wp b)\n  sound (M ?i)\n\ngoal (1 subgoal):\n 1. wp b (M i) \\<tturnstile> wp b (Sup_exp (range M))", "by(auto)"], ["proof (state)\nthis:\n  wp b (M i) \\<tturnstile> wp b (Sup_exp (range M))\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "hence \"wp b (M i) s \\<le> wp b (Sup_exp (range M)) s\""], ["proof (prove)\nusing this:\n  wp b (M i) \\<tturnstile> wp b (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. wp b (M i) s \\<le> wp b (Sup_exp (range M)) s", "by(auto)"], ["proof (state)\nthis:\n  wp b (M i) s \\<le> wp b (Sup_exp (range M)) s\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "}"], ["proof (state)\nthis:\n  wp b (M i) s \\<le> wp b (Sup_exp (range M)) s\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "moreover"], ["proof (state)\nthis:\n  wp b (M i) s \\<le> wp b (Sup_exp (range M)) s\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"0 \\<le> p s\" \"0 \\<le> 1 - p s\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> p s &&& 0 \\<le> 1 - p s", "by auto"], ["proof (state)\nthis:\n  0 \\<le> p s\n  0 \\<le> 1 - p s\n\ngoal (2 subgoals):\n 1. \\<And>P x.\n       p x * wp a (M P) x + (1 - p x) * wp b (M P) x\n       \\<le> p x * wp a (Sup_exp (range M)) x +\n             (1 - p x) * wp b (Sup_exp (range M)) x\n 2. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "ultimately"], ["proof (chain)\npicking this:\n  wp a (M i) s \\<le> wp a (Sup_exp (range M)) s\n  wp b (M i) s \\<le> wp b (Sup_exp (range M)) s\n  0 \\<le> p s\n  0 \\<le> 1 - p s", "show \"p s * wp a (M i) s + (1 - p s) * wp b (M i) s \\<le>\n          p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\""], ["proof (prove)\nusing this:\n  wp a (M i) s \\<le> wp a (Sup_exp (range M)) s\n  wp b (M i) s \\<le> wp b (Sup_exp (range M)) s\n  0 \\<le> p s\n  0 \\<le> 1 - p s\n\ngoal (1 subgoal):\n 1. p s * wp a (M i) s + (1 - p s) * wp b (M i) s\n    \\<le> p s * wp a (Sup_exp (range M)) s +\n          (1 - p s) * wp b (Sup_exp (range M)) s", "by(blast intro:add_mono mult_left_mono)"], ["proof (state)\nthis:\n  p s * wp a (M i) s + (1 - p s) * wp b (M i) s\n  \\<le> p s * wp a (Sup_exp (range M)) s +\n        (1 - p s) * wp b (Sup_exp (range M)) s\n\ngoal (1 subgoal):\n 1. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "from sSup ha hb"], ["proof (chain)\npicking this:\n  sound (Sup_exp (range M))\n  healthy (wp a)\n  healthy (wp b)", "have \"sound (wp a (Sup_exp (range M)))\"\n                         \"sound (wp b (Sup_exp (range M)))\""], ["proof (prove)\nusing this:\n  sound (Sup_exp (range M))\n  healthy (wp a)\n  healthy (wp b)\n\ngoal (1 subgoal):\n 1. sound (wp a (Sup_exp (range M))) &&& sound (wp b (Sup_exp (range M)))", "by(auto)"], ["proof (state)\nthis:\n  sound (wp a (Sup_exp (range M)))\n  sound (wp b (Sup_exp (range M)))\n\ngoal (1 subgoal):\n 1. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "hence \"\\<And>s. 0 \\<le> wp a (Sup_exp (range M)) s\" \"\\<And>s. 0 \\<le> wp b (Sup_exp (range M)) s\""], ["proof (prove)\nusing this:\n  sound (wp a (Sup_exp (range M)))\n  sound (wp b (Sup_exp (range M)))\n\ngoal (1 subgoal):\n 1. (\\<And>s. 0 \\<le> wp a (Sup_exp (range M)) s) &&&\n    (\\<And>s. 0 \\<le> wp b (Sup_exp (range M)) s)", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> wp a (Sup_exp (range M)) ?s\n  0 \\<le> wp b (Sup_exp (range M)) ?s\n\ngoal (1 subgoal):\n 1. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "moreover"], ["proof (state)\nthis:\n  0 \\<le> wp a (Sup_exp (range M)) ?s\n  0 \\<le> wp b (Sup_exp (range M)) ?s\n\ngoal (1 subgoal):\n 1. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"\\<And>s. 0 \\<le> p s\" \"\\<And>s. 0 \\<le> 1 - p s\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. (\\<And>s. 0 \\<le> p s) &&& (\\<And>s. 0 \\<le> 1 - p s)", "by auto"], ["proof (state)\nthis:\n  0 \\<le> p ?s\n  0 \\<le> 1 - p ?s\n\ngoal (1 subgoal):\n 1. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "ultimately"], ["proof (chain)\npicking this:\n  0 \\<le> wp a (Sup_exp (range M)) ?s\n  0 \\<le> wp b (Sup_exp (range M)) ?s\n  0 \\<le> p ?s\n  0 \\<le> 1 - p ?s", "show \"nneg (\\<lambda>c. p c * wp a (Sup_exp (range M)) c +\n                          (1 - p c) * wp b (Sup_exp (range M)) c)\""], ["proof (prove)\nusing this:\n  0 \\<le> wp a (Sup_exp (range M)) ?s\n  0 \\<le> wp b (Sup_exp (range M)) ?s\n  0 \\<le> p ?s\n  0 \\<le> 1 - p ?s\n\ngoal (1 subgoal):\n 1. nneg\n     (\\<lambda>c.\n         p c * wp a (Sup_exp (range M)) c +\n         (1 - p c) * wp b (Sup_exp (range M)) c)", "by(blast intro:add_nonneg_nonneg mult_nonneg_nonneg)"], ["proof (state)\nthis:\n  nneg\n   (\\<lambda>c.\n       p c * wp a (Sup_exp (range M)) c +\n       (1 - p c) * wp b (Sup_exp (range M)) c)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Sup_exp\n   (range (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)) s\n  \\<le> p s * wp a (Sup_exp (range M)) s +\n        (1 - p s) * wp b (Sup_exp (range M)) s\n\ngoal (1 subgoal):\n 1. \\<And>ba M x.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by ba (M i)\\<rbrakk>\n       \\<Longrightarrow> p x * wp a (Sup_exp (range M)) x +\n                         (1 - p x) * wp b (Sup_exp (range M)) x =\n                         Sup_exp\n                          (range\n                            (\\<lambda>x s.\n                                p s * wp a (M x) s +\n                                (1 - p s) * wp b (M x) s))\n                          x", "ultimately"], ["proof (chain)\npicking this:\n  p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\n  \\<le> Sup_exp\n         (range\n           (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s))\n         s\n  Sup_exp\n   (range (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)) s\n  \\<le> p s * wp a (Sup_exp (range M)) s +\n        (1 - p s) * wp b (Sup_exp (range M)) s", "show \"p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s =\n                  Sup_exp (range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)) s\""], ["proof (prove)\nusing this:\n  p s * wp a (Sup_exp (range M)) s + (1 - p s) * wp b (Sup_exp (range M)) s\n  \\<le> Sup_exp\n         (range\n           (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s))\n         s\n  Sup_exp\n   (range (\\<lambda>i s. p s * wp a (M i) s + (1 - p s) * wp b (M i) s)) s\n  \\<le> p s * wp a (Sup_exp (range M)) s +\n        (1 - p s) * wp b (Sup_exp (range M)) s\n\ngoal (1 subgoal):\n 1. p s * wp a (Sup_exp (range M)) s +\n    (1 - p s) * wp b (Sup_exp (range M)) s =\n    Sup_exp\n     (range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)) s", "by(auto)"], ["proof (state)\nthis:\n  p s * wp a (Sup_exp (range M)) s +\n  (1 - p s) * wp b (Sup_exp (range M)) s =\n  Sup_exp\n   (range (\\<lambda>x s. p s * wp a (M x) s + (1 - p s) * wp b (M x) s)) s\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Both set-based choice operators are only continuous for finite sets (probabilistic choice\n\\emph{can} be extended infinitely, but we have not done so).  The proofs for both are inductive,\nand rely on the above results on binary operators.\\<close>"], ["", "lemma SetPC_Bind:\n  \"SetPC a p = Bind p (\\<lambda>p. SetPC a (\\<lambda>_. p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SetPC a p = Bind p (\\<lambda>p. SetPC a (\\<lambda>_. p))", "by(intro ext, simp add:SetPC_def Bind_def Let_def)"], ["", "lemma SetPC_remove:\n  assumes nz: \"p x \\<noteq> 0\" and n1: \"p x \\<noteq> 1\"\n      and fsupp: \"finite (supp p)\"\n  shows \"SetPC a (\\<lambda>_. p) = PC (a x) (\\<lambda>_. p x) (SetPC a (\\<lambda>_. dist_remove p x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SetPC a (\\<lambda>_. p) =\n    a x \\<^bsub>(\\<lambda>_.\n                    p x)\\<^esub>\\<oplus> SetPC a\n    (\\<lambda>_. dist_remove p x)", "proof(intro ext, simp add:SetPC_def PC_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "fix ab P s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "from nz"], ["proof (chain)\npicking this:\n  p x \\<noteq> 0", "have \"x \\<in> supp p\""], ["proof (prove)\nusing this:\n  p x \\<noteq> 0\n\ngoal (1 subgoal):\n 1. x \\<in> supp p", "by(simp add:supp_def)"], ["proof (state)\nthis:\n  x \\<in> supp p\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "hence \"supp p = insert x (supp p - {x})\""], ["proof (prove)\nusing this:\n  x \\<in> supp p\n\ngoal (1 subgoal):\n 1. supp p = insert x (supp p - {x})", "by(auto)"], ["proof (state)\nthis:\n  supp p = insert x (supp p - {x})\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "hence \"(\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n         (\\<Sum>x\\<in>insert x (supp p - {x}). p x * a x ab P s)\""], ["proof (prove)\nusing this:\n  supp p = insert x (supp p - {x})\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n    (\\<Sum>x\\<in>insert x (supp p - {x}). p x * a x ab P s)", "by(simp)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n  (\\<Sum>x\\<in>insert x (supp p - {x}). p x * a x ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n  (\\<Sum>x\\<in>insert x (supp p - {x}). p x * a x ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "from fsupp"], ["proof (chain)\npicking this:\n  finite (supp p)", "have \"... = p x * a x ab P s + (\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s)\""], ["proof (prove)\nusing this:\n  finite (supp p)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>insert x (supp p - {x}). p x * a x ab P s) =\n    p x * a x ab P s + (\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s)", "by(blast intro:sum.insert)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>insert x (supp p - {x}). p x * a x ab P s) =\n  p x * a x ab P s + (\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>insert x (supp p - {x}). p x * a x ab P s) =\n  p x * a x ab P s + (\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "from n1"], ["proof (chain)\npicking this:\n  p x \\<noteq> 1", "have \"... = p x * a x ab P s + (1 - p x) * ((\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) / (1 - p x))\""], ["proof (prove)\nusing this:\n  p x \\<noteq> 1\n\ngoal (1 subgoal):\n 1. p x * a x ab P s + (\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) =\n    p x * a x ab P s +\n    (1 - p x) * ((\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) / (1 - p x))", "by(simp add:field_simps)"], ["proof (state)\nthis:\n  p x * a x ab P s + (\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) =\n  p x * a x ab P s +\n  (1 - p x) * ((\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) / (1 - p x))\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "also"], ["proof (state)\nthis:\n  p x * a x ab P s + (\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) =\n  p x * a x ab P s +\n  (1 - p x) * ((\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) / (1 - p x))\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "have \"... = p x * a x ab P s +\n                   (1 - p x) * ((\\<Sum>y\\<in>supp p - {x}. (p y / (1 - p x)) * a y ab P s))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p x * a x ab P s +\n    (1 - p x) * ((\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) / (1 - p x)) =\n    p x * a x ab P s +\n    (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x) * a y ab P s)", "by(simp add:sum_divide_distrib)"], ["proof (state)\nthis:\n  p x * a x ab P s +\n  (1 - p x) * ((\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) / (1 - p x)) =\n  p x * a x ab P s +\n  (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x) * a y ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "also"], ["proof (state)\nthis:\n  p x * a x ab P s +\n  (1 - p x) * ((\\<Sum>x\\<in>supp p - {x}. p x * a x ab P s) / (1 - p x)) =\n  p x * a x ab P s +\n  (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x) * a y ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "have \"... = p x * a x ab P s +\n                   (1 - p x) * ((\\<Sum>y\\<in>supp p - {x}. dist_remove p x y * a y ab P s))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p x * a x ab P s +\n    (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x) * a y ab P s) =\n    p x * a x ab P s +\n    (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. dist_remove p x y * a y ab P s)", "by(simp add:dist_remove_def)"], ["proof (state)\nthis:\n  p x * a x ab P s +\n  (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x) * a y ab P s) =\n  p x * a x ab P s +\n  (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. dist_remove p x y * a y ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "also"], ["proof (state)\nthis:\n  p x * a x ab P s +\n  (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x) * a y ab P s) =\n  p x * a x ab P s +\n  (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. dist_remove p x y * a y ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "from nz n1"], ["proof (chain)\npicking this:\n  p x \\<noteq> 0\n  p x \\<noteq> 1", "have \"... = p x * a x ab P s +\n              (1 - p x) * ((\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s))\""], ["proof (prove)\nusing this:\n  p x \\<noteq> 0\n  p x \\<noteq> 1\n\ngoal (1 subgoal):\n 1. p x * a x ab P s +\n    (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. dist_remove p x y * a y ab P s) =\n    p x * a x ab P s +\n    (1 - p x) *\n    (\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s)", "by(simp add:supp_dist_remove)"], ["proof (state)\nthis:\n  p x * a x ab P s +\n  (1 - p x) * (\\<Sum>y\\<in>supp p - {x}. dist_remove p x y * a y ab P s) =\n  p x * a x ab P s +\n  (1 - p x) *\n  (\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (\\<Sum>aa\\<in>supp p. p aa * a aa xa xaa xb) =\n       p x * a x xa xaa xb +\n       (1 - p x) *\n       (\\<Sum>aa\\<in>supp (dist_remove p x).\n          dist_remove p x aa * a aa xa xaa xb)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n  p x * a x ab P s +\n  (1 - p x) *\n  (\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s)", "show \"(\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n                 p x * a x ab P s +\n                 (1 - p x) * (\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s)\""], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n  p x * a x ab P s +\n  (1 - p x) *\n  (\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s)\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n    p x * a x ab P s +\n    (1 - p x) *\n    (\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s)", "."], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>supp p. p x * a x ab P s) =\n  p x * a x ab P s +\n  (1 - p x) *\n  (\\<Sum>y\\<in>supp (dist_remove p x). dist_remove p x y * a y ab P s)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_bot:\n  \"bd_cts (\\<lambda>(P::'s expect) (s::'s). 0::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (\\<lambda>P s. 0)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bd_cts (\\<lambda>P s. 0)", "have X: \"\\<And>s::'s. {(P::'s expect) s |P. P \\<in> range (\\<lambda>P s. 0)} = {0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s. {P s |P. P \\<in> range (\\<lambda>P s. 0)} = {0}", "by(auto)"], ["proof (state)\nthis:\n  {P ?s |P. P \\<in> range (\\<lambda>P s. 0)} = {0}\n\ngoal (1 subgoal):\n 1. bd_cts (\\<lambda>P s. 0)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (\\<lambda>P s. 0)", "by(intro bd_ctsI, simp add:Sup_exp_def o_def X)"], ["proof (state)\nthis:\n  bd_cts (\\<lambda>P s. 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wp_SetPC_nil:\n  \"wp (SetPC a (\\<lambda>s a. 0)) = (\\<lambda>P s. 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. wp (SetPC a (\\<lambda>s a. 0)) = (\\<lambda>P s. 0)", "by(intro ext, simp add:wp_eval)"], ["", "lemma SetPC_sgl:\n  \"supp p = {x} \\<Longrightarrow> SetPC a (\\<lambda>_. p) = (\\<lambda>ab P s. p x * a x ab P s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. supp p = {x} \\<Longrightarrow>\n    SetPC a (\\<lambda>_. p) = (\\<lambda>ab P s. p x * a x ab P s)", "by(simp add:SetPC_def)"], ["", "lemma bd_cts_scale:\n  fixes a::\"'s trans\"\n  assumes ca: \"bd_cts a\"\n      and ha: \"healthy a\"\n      and nnc: \"0 \\<le> c\"\n  shows \"bd_cts (\\<lambda>P s. c * a P s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (\\<lambda>P s. c * a P s)", "proof(intro bd_ctsI ext, simp add:o_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "fix M::\"nat \\<Rightarrow> 's expect\" and d::real and s::'s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "assume chain: \"\\<And>i. M i \\<tturnstile> M (Suc i)\" and sM: \"\\<And>i. sound (M i)\"\n     and bM: \"\\<And>i. bounded_by d (M i)\""], ["proof (state)\nthis:\n  M ?i \\<tturnstile> M (Suc ?i)\n  sound (M ?i)\n  bounded_by d (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "from sM"], ["proof (chain)\npicking this:\n  sound (M ?i)", "have \"\\<And>i. nneg (M i)\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i. nneg (M i)", "by(auto)"], ["proof (state)\nthis:\n  nneg (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "with bM"], ["proof (chain)\npicking this:\n  bounded_by d (M ?i)\n  nneg (M ?i)", "have nnd: \"0 \\<le> d\""], ["proof (prove)\nusing this:\n  bounded_by d (M ?i)\n  nneg (M ?i)\n\ngoal (1 subgoal):\n 1. 0 \\<le> d", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> d\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "from sM bM"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  bounded_by d (M ?i)", "have sSup: \"sound (Sup_exp (range M))\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  bounded_by d (M ?i)\n\ngoal (1 subgoal):\n 1. sound (Sup_exp (range M))", "by(auto intro:Sup_exp_sound)"], ["proof (state)\nthis:\n  sound (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "with healthy_scalingD[OF ha] nnc"], ["proof (chain)\npicking this:\n  scaling a\n  0 \\<le> c\n  sound (Sup_exp (range M))", "have \"c * a (Sup_exp (range M)) s = a (\\<lambda>s. c * Sup_exp (range M) s) s\""], ["proof (prove)\nusing this:\n  scaling a\n  0 \\<le> c\n  sound (Sup_exp (range M))\n\ngoal (1 subgoal):\n 1. c * a (Sup_exp (range M)) s = a (\\<lambda>s. c * Sup_exp (range M) s) s", "by(auto intro:scalingD)"], ["proof (state)\nthis:\n  c * a (Sup_exp (range M)) s = a (\\<lambda>s. c * Sup_exp (range M) s) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "also"], ["proof (state)\nthis:\n  c * a (Sup_exp (range M)) s = a (\\<lambda>s. c * Sup_exp (range M) s) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "{"], ["proof (state)\nthis:\n  c * a (Sup_exp (range M)) s = a (\\<lambda>s. c * Sup_exp (range M) s) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "have \"\\<And>s. {f s |f. f \\<in> range M} = range (\\<lambda>i. M i s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s. {f s |f. f \\<in> range M} = range (\\<lambda>i. M i s)", "by(auto)"], ["proof (state)\nthis:\n  {f ?s |f. f \\<in> range M} = range (\\<lambda>i. M i ?s)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "hence \"a (\\<lambda>s. c * Sup_exp (range M) s) s =\n           a (\\<lambda>s. c * Sup (range (\\<lambda>i. M i s))) s\""], ["proof (prove)\nusing this:\n  {f ?s |f. f \\<in> range M} = range (\\<lambda>i. M i ?s)\n\ngoal (1 subgoal):\n 1. a (\\<lambda>s. c * Sup_exp (range M) s) s =\n    a (\\<lambda>s. c * (SUP i. M i s)) s", "by(simp add:Sup_exp_def)"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * Sup_exp (range M) s) s =\n  a (\\<lambda>s. c * (SUP i. M i s)) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "}"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * Sup_exp (range M) s) s =\n  a (\\<lambda>s. c * (SUP i. M i s)) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "also"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * Sup_exp (range M) s) s =\n  a (\\<lambda>s. c * (SUP i. M i s)) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "{"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * Sup_exp (range M) s) s =\n  a (\\<lambda>s. c * (SUP i. M i s)) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "from bM"], ["proof (chain)\npicking this:\n  bounded_by d (M ?i)", "have \"\\<And>x s. x \\<in> range (\\<lambda>i. M i s) \\<Longrightarrow> x \\<le> d\""], ["proof (prove)\nusing this:\n  bounded_by d (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>x s. x \\<in> range (\\<lambda>i. M i s) \\<Longrightarrow> x \\<le> d", "by(auto)"], ["proof (state)\nthis:\n  ?x \\<in> range (\\<lambda>i. M i ?s) \\<Longrightarrow> ?x \\<le> d\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "with nnc"], ["proof (chain)\npicking this:\n  0 \\<le> c\n  ?x \\<in> range (\\<lambda>i. M i ?s) \\<Longrightarrow> ?x \\<le> d", "have \"a (\\<lambda>s. c * Sup (range (\\<lambda>i. M i s))) s =\n                   a (\\<lambda>s. Sup {c*x |x. x \\<in> range (\\<lambda>i. M i s)}) s\""], ["proof (prove)\nusing this:\n  0 \\<le> c\n  ?x \\<in> range (\\<lambda>i. M i ?s) \\<Longrightarrow> ?x \\<le> d\n\ngoal (1 subgoal):\n 1. a (\\<lambda>s. c * (SUP i. M i s)) s =\n    a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s", "by(subst cSup_mult, blast+)"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * (SUP i. M i s)) s =\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "}"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * (SUP i. M i s)) s =\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "also"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * (SUP i. M i s)) s =\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "{"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * (SUP i. M i s)) s =\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "have X: \"\\<And>s. {c * x |x. x \\<in> range (\\<lambda>i. M i s)} = range (\\<lambda>i. c * M i s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       {c * x |x. x \\<in> range (\\<lambda>i. M i s)} =\n       range (\\<lambda>i. c * M i s)", "by(auto)"], ["proof (state)\nthis:\n  {c * x |x. x \\<in> range (\\<lambda>i. M i ?s)} =\n  range (\\<lambda>i. c * M i ?s)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "have \"a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s =\n          a (\\<lambda>s. Sup (range (\\<lambda>i. c * M i s))) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s =\n    a (\\<lambda>s. SUP i. c * M i s) s", "by(simp add:X)"], ["proof (state)\nthis:\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s =\n  a (\\<lambda>s. SUP i. c * M i s) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "}"], ["proof (state)\nthis:\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s =\n  a (\\<lambda>s. SUP i. c * M i s) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "also"], ["proof (state)\nthis:\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s =\n  a (\\<lambda>s. SUP i. c * M i s) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "{"], ["proof (state)\nthis:\n  a (\\<lambda>s. Sup {c * x |x. x \\<in> range (\\<lambda>i. M i s)}) s =\n  a (\\<lambda>s. SUP i. c * M i s) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "have \"\\<And>s. range (\\<lambda>i. c * M i s) = {f s |f. f \\<in> range (\\<lambda>i s. c * M i s)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>s.\n       range (\\<lambda>i. c * M i s) =\n       {f s |f. f \\<in> range (\\<lambda>i s. c * M i s)}", "by(auto)"], ["proof (state)\nthis:\n  range (\\<lambda>i. c * M i ?s) =\n  {f ?s |f. f \\<in> range (\\<lambda>i s. c * M i s)}\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "hence \"(\\<lambda>s. Sup (range (\\<lambda>i. c * M i s))) = Sup_exp (range (\\<lambda>i s. c * M i s))\""], ["proof (prove)\nusing this:\n  range (\\<lambda>i. c * M i ?s) =\n  {f ?s |f. f \\<in> range (\\<lambda>i s. c * M i s)}\n\ngoal (1 subgoal):\n 1. (\\<lambda>s. SUP i. c * M i s) =\n    Sup_exp (range (\\<lambda>i s. c * M i s))", "by (simp add: Sup_exp_def cong del: SUP_cong_simp)"], ["proof (state)\nthis:\n  (\\<lambda>s. SUP i. c * M i s) = Sup_exp (range (\\<lambda>i s. c * M i s))\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "hence \"a (\\<lambda>s. Sup (range (\\<lambda>i. c * M i s))) s =\n           a (Sup_exp (range (\\<lambda>i s. c * M i s))) s\""], ["proof (prove)\nusing this:\n  (\\<lambda>s. SUP i. c * M i s) = Sup_exp (range (\\<lambda>i s. c * M i s))\n\ngoal (1 subgoal):\n 1. a (\\<lambda>s. SUP i. c * M i s) s =\n    a (Sup_exp (range (\\<lambda>i s. c * M i s))) s", "by(simp)"], ["proof (state)\nthis:\n  a (\\<lambda>s. SUP i. c * M i s) s =\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "}"], ["proof (state)\nthis:\n  a (\\<lambda>s. SUP i. c * M i s) s =\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "also"], ["proof (state)\nthis:\n  a (\\<lambda>s. SUP i. c * M i s) s =\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "{"], ["proof (state)\nthis:\n  a (\\<lambda>s. SUP i. c * M i s) s =\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "from le_funD[OF chain] nnc"], ["proof (chain)\npicking this:\n  M ?i1 ?x \\<le> M (Suc ?i1) ?x\n  0 \\<le> c", "have \"\\<And>i. (\\<lambda>s. c * M i s) \\<tturnstile> (\\<lambda>s. c * M (Suc i) s)\""], ["proof (prove)\nusing this:\n  M ?i1 ?x \\<le> M (Suc ?i1) ?x\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>i. \\<lambda>s. c * M i s \\<tturnstile> \\<lambda>s. c * M (Suc i) s", "by(auto intro:le_funI[OF mult_left_mono])"], ["proof (state)\nthis:\n  \\<lambda>s. c * M ?i s \\<tturnstile> \\<lambda>s. c * M (Suc ?i) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "moreover"], ["proof (state)\nthis:\n  \\<lambda>s. c * M ?i s \\<tturnstile> \\<lambda>s. c * M (Suc ?i) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "from sM nnc"], ["proof (chain)\npicking this:\n  sound (M ?i)\n  0 \\<le> c", "have \"\\<And>i. sound (\\<lambda>s. c * M i s)\""], ["proof (prove)\nusing this:\n  sound (M ?i)\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>i. sound (\\<lambda>s. c * M i s)", "by(auto intro:sound_intros)"], ["proof (state)\nthis:\n  sound (\\<lambda>s. c * M ?i s)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "moreover"], ["proof (state)\nthis:\n  sound (\\<lambda>s. c * M ?i s)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "from bM nnc"], ["proof (chain)\npicking this:\n  bounded_by d (M ?i)\n  0 \\<le> c", "have \"\\<And>i. bounded_by (c * d) (\\<lambda>s. c * M i s)\""], ["proof (prove)\nusing this:\n  bounded_by d (M ?i)\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by (c * d) (\\<lambda>s. c * M i s)", "by(auto intro:mult_left_mono)"], ["proof (state)\nthis:\n  bounded_by (c * d) (\\<lambda>s. c * M ?i s)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "ultimately"], ["proof (chain)\npicking this:\n  \\<lambda>s. c * M ?i s \\<tturnstile> \\<lambda>s. c * M (Suc ?i) s\n  sound (\\<lambda>s. c * M ?i s)\n  bounded_by (c * d) (\\<lambda>s. c * M ?i s)", "have \"a (Sup_exp (range (\\<lambda>i s. c * M i s))) =\n          Sup_exp (range (a o (\\<lambda>i s. c * M i s)))\""], ["proof (prove)\nusing this:\n  \\<lambda>s. c * M ?i s \\<tturnstile> \\<lambda>s. c * M (Suc ?i) s\n  sound (\\<lambda>s. c * M ?i s)\n  bounded_by (c * d) (\\<lambda>s. c * M ?i s)\n\ngoal (1 subgoal):\n 1. a (Sup_exp (range (\\<lambda>i s. c * M i s))) =\n    Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s)))", "by(rule bd_ctsD[OF ca])"], ["proof (state)\nthis:\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) =\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s)))\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "hence \"a (Sup_exp (range (\\<lambda>i s. c * M i s))) s =\n          Sup_exp (range (a o (\\<lambda>i s. c * M i s))) s\""], ["proof (prove)\nusing this:\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) =\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s)))\n\ngoal (1 subgoal):\n 1. a (Sup_exp (range (\\<lambda>i s. c * M i s))) s =\n    Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s", "by(auto)"], ["proof (state)\nthis:\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) s =\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "}"], ["proof (state)\nthis:\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) s =\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "also"], ["proof (state)\nthis:\n  a (Sup_exp (range (\\<lambda>i s. c * M i s))) s =\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "have \"Sup_exp (range (a o (\\<lambda>i s. c * M i s))) s =\n             Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s =\n    Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s", "by(simp add:o_def)"], ["proof (state)\nthis:\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s =\n  Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "also"], ["proof (state)\nthis:\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s =\n  Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "{"], ["proof (state)\nthis:\n  Sup_exp (range (a \\<circ> (\\<lambda>i s. c * M i s))) s =\n  Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "from nnc sM"], ["proof (chain)\npicking this:\n  0 \\<le> c\n  sound (M ?i)", "have \"\\<And>x. a (\\<lambda>s. c * M x s) = (\\<lambda>s. c * a (M x) s)\""], ["proof (prove)\nusing this:\n  0 \\<le> c\n  sound (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>x. a (\\<lambda>s. c * M x s) = (\\<lambda>s. c * a (M x) s)", "by(auto intro:scalingD[OF healthy_scalingD, OF ha, symmetric])"], ["proof (state)\nthis:\n  a (\\<lambda>s. c * M ?x s) = (\\<lambda>s. c * a (M ?x) s)\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "hence \"Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s =\n           Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s\""], ["proof (prove)\nusing this:\n  a (\\<lambda>s. c * M ?x s) = (\\<lambda>s. c * a (M ?x) s)\n\ngoal (1 subgoal):\n 1. Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s =\n    Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "by(simp)"], ["proof (state)\nthis:\n  Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s =\n  Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "}"], ["proof (state)\nthis:\n  Sup_exp (range (\\<lambda>x. a (\\<lambda>s. c * M x s))) s =\n  Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s\n\ngoal (1 subgoal):\n 1. \\<And>b M s.\n       \\<lbrakk>\\<And>i. M i \\<tturnstile> M (Suc i); \\<And>i. sound (M i);\n        \\<And>i. bounded_by b (M i)\\<rbrakk>\n       \\<Longrightarrow> c * a (Sup_exp (range M)) s =\n                         Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "finally"], ["proof (chain)\npicking this:\n  c * a (Sup_exp (range M)) s =\n  Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "show \"c * a (Sup_exp (range M)) s = Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s\""], ["proof (prove)\nusing this:\n  c * a (Sup_exp (range M)) s =\n  Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s\n\ngoal (1 subgoal):\n 1. c * a (Sup_exp (range M)) s =\n    Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s", "."], ["proof (state)\nthis:\n  c * a (Sup_exp (range M)) s =\n  Sup_exp (range (\\<lambda>x s. c * a (M x) s)) s\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_SetPC_const:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x. x \\<in> (supp p) \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x. x \\<in> (supp p) \\<Longrightarrow> healthy (wp (a x))\"\n      and up: \"unitary p\"\n      and sump: \"sum p (supp p) \\<le> 1\"\n      and fsupp: \"finite (supp p)\"\n  shows \"bd_cts (wp (SetPC a (\\<lambda>_. p)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a (\\<lambda>_. p)))", "proof(cases \"supp p = {}\", simp add:supp_empty SetPC_def wp_def cts_bot)"], ["proof (state)\ngoal (1 subgoal):\n 1. supp p \\<noteq> {} \\<Longrightarrow>\n    bd_cts (wp (SetPC a (\\<lambda>_. p)))", "assume nesupp: \"supp p \\<noteq> {}\""], ["proof (state)\nthis:\n  supp p \\<noteq> {}\n\ngoal (1 subgoal):\n 1. supp p \\<noteq> {} \\<Longrightarrow>\n    bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from fsupp"], ["proof (chain)\npicking this:\n  finite (supp p)", "have \"unitary p \\<longrightarrow> sum p (supp p) \\<le> 1 \\<longrightarrow> \n                   (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n                   (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n                   bd_cts (wp (SetPC a (\\<lambda>_. p)))\""], ["proof (prove)\nusing this:\n  finite (supp p)\n\ngoal (1 subgoal):\n 1. unitary p \\<longrightarrow>\n    sum p (supp p) \\<le> 1 \\<longrightarrow>\n    (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n    (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n    bd_cts (wp (SetPC a (\\<lambda>_. p)))", "proof(induct \"supp p\" arbitrary:p, simp add:supp_empty wp_SetPC_nil cts_bot, clarify)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "fix x::'a and F::\"'a set\" and p::\"'a \\<Rightarrow> real\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "assume fF: \"finite F\""], ["proof (state)\nthis:\n  finite F\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "assume \"insert x F = supp p\""], ["proof (state)\nthis:\n  insert x F = supp p\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "hence pstep: \"supp p = insert x F\""], ["proof (prove)\nusing this:\n  insert x F = supp p\n\ngoal (1 subgoal):\n 1. supp p = insert x F", "by(simp)"], ["proof (state)\nthis:\n  supp p = insert x F\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "hence xin: \"x \\<in> supp p\""], ["proof (prove)\nusing this:\n  supp p = insert x F\n\ngoal (1 subgoal):\n 1. x \\<in> supp p", "by(auto)"], ["proof (state)\nthis:\n  x \\<in> supp p\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "assume up: \"unitary p\" and ca: \"\\<forall>x\\<in>supp p. bd_cts (wp (a x))\"\n       and ha: \"\\<forall>x\\<in>supp p. healthy (wp (a x))\"\n       and sump: \"sum p (supp p) \\<le> 1\"\n       and xni: \"x \\<notin> F\""], ["proof (state)\nthis:\n  unitary p\n  \\<forall>x\\<in>supp p. bd_cts (wp (a x))\n  \\<forall>x\\<in>supp p. healthy (wp (a x))\n  sum p (supp p) \\<le> 1\n  x \\<notin> F\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "assume IH: \"\\<And>p. F = supp p \\<Longrightarrow>\n                     unitary p \\<longrightarrow> sum p (supp p) \\<le> 1 \\<longrightarrow>\n                     (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n                     (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n                     bd_cts (wp (SetPC a (\\<lambda>_. p)))\""], ["proof (state)\nthis:\n  F = supp ?p \\<Longrightarrow>\n  unitary ?p \\<longrightarrow>\n  sum ?p (supp ?p) \\<le> 1 \\<longrightarrow>\n  (\\<forall>x\\<in>supp ?p. bd_cts (wp (a x))) \\<longrightarrow>\n  (\\<forall>x\\<in>supp ?p. healthy (wp (a x))) \\<longrightarrow>\n  bd_cts (wp (SetPC a (\\<lambda>_. ?p)))\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "from fF pstep"], ["proof (chain)\npicking this:\n  finite F\n  supp p = insert x F", "have fsupp: \"finite (supp p)\""], ["proof (prove)\nusing this:\n  finite F\n  supp p = insert x F\n\ngoal (1 subgoal):\n 1. finite (supp p)", "by(auto)"], ["proof (state)\nthis:\n  finite (supp p)\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "from xin"], ["proof (chain)\npicking this:\n  x \\<in> supp p", "have nzp: \"p x \\<noteq> 0\""], ["proof (prove)\nusing this:\n  x \\<in> supp p\n\ngoal (1 subgoal):\n 1. p x \\<noteq> 0", "by(simp add:supp_def)"], ["proof (state)\nthis:\n  p x \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "have xy_le_sum:\n      \"\\<And>y. y \\<in> supp p \\<Longrightarrow> y \\<noteq> x \\<Longrightarrow> p x + p y \\<le> sum p (supp p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "fix y"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "assume yin: \"y \\<in> supp p\" and yne: \"y \\<noteq> x\""], ["proof (state)\nthis:\n  y \\<in> supp p\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"0 \\<le> sum p (supp p - {x,y})\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> sum p (supp p - {x, y})", "by(auto intro:sum_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> sum p (supp p - {x, y})\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "hence \"p x + p y \\<le> p x + p y + sum p (supp p - {x,y})\""], ["proof (prove)\nusing this:\n  0 \\<le> sum p (supp p - {x, y})\n\ngoal (1 subgoal):\n 1. p x + p y \\<le> p x + p y + sum p (supp p - {x, y})", "by(auto)"], ["proof (state)\nthis:\n  p x + p y \\<le> p x + p y + sum p (supp p - {x, y})\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "also"], ["proof (state)\nthis:\n  p x + p y \\<le> p x + p y + sum p (supp p - {x, y})\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "{"], ["proof (state)\nthis:\n  p x + p y \\<le> p x + p y + sum p (supp p - {x, y})\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "from yin yne fsupp"], ["proof (chain)\npicking this:\n  y \\<in> supp p\n  y \\<noteq> x\n  finite (supp p)", "have \"p y + sum p (supp p - {x,y}) = sum p (supp p - {x})\""], ["proof (prove)\nusing this:\n  y \\<in> supp p\n  y \\<noteq> x\n  finite (supp p)\n\ngoal (1 subgoal):\n 1. p y + sum p (supp p - {x, y}) = sum p (supp p - {x})", "by(subst sum.insert[symmetric], (blast intro!:sum.cong)+)"], ["proof (state)\nthis:\n  p y + sum p (supp p - {x, y}) = sum p (supp p - {x})\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "moreover"], ["proof (state)\nthis:\n  p y + sum p (supp p - {x, y}) = sum p (supp p - {x})\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "from xin fsupp"], ["proof (chain)\npicking this:\n  x \\<in> supp p\n  finite (supp p)", "have \"p x + sum p (supp p - {x}) = sum p (supp p)\""], ["proof (prove)\nusing this:\n  x \\<in> supp p\n  finite (supp p)\n\ngoal (1 subgoal):\n 1. p x + sum p (supp p - {x}) = sum p (supp p)", "by(subst sum.insert[symmetric], (blast intro!:sum.cong)+)"], ["proof (state)\nthis:\n  p x + sum p (supp p - {x}) = sum p (supp p)\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "ultimately"], ["proof (chain)\npicking this:\n  p y + sum p (supp p - {x, y}) = sum p (supp p - {x})\n  p x + sum p (supp p - {x}) = sum p (supp p)", "have \"p x + p y + sum p (supp p - {x, y}) = sum p (supp p)\""], ["proof (prove)\nusing this:\n  p y + sum p (supp p - {x, y}) = sum p (supp p - {x})\n  p x + sum p (supp p - {x}) = sum p (supp p)\n\ngoal (1 subgoal):\n 1. p x + p y + sum p (supp p - {x, y}) = sum p (supp p)", "by(simp)"], ["proof (state)\nthis:\n  p x + p y + sum p (supp p - {x, y}) = sum p (supp p)\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "}"], ["proof (state)\nthis:\n  p x + p y + sum p (supp p - {x, y}) = sum p (supp p)\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x + p y \\<le> sum p (supp p)", "finally"], ["proof (chain)\npicking this:\n  p x + p y \\<le> sum p (supp p)", "show \"p x + p y \\<le> sum p (supp p)\""], ["proof (prove)\nusing this:\n  p x + p y \\<le> sum p (supp p)\n\ngoal (1 subgoal):\n 1. p x + p y \\<le> sum p (supp p)", "."], ["proof (state)\nthis:\n  p x + p y \\<le> sum p (supp p)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?y \\<in> supp p; ?y \\<noteq> x\\<rbrakk>\n  \\<Longrightarrow> p x + p ?y \\<le> sum p (supp p)\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "have n1p: \"\\<And>y. y \\<in> supp p \\<Longrightarrow> y \\<noteq> x \\<Longrightarrow> p x \\<noteq> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> p x \\<noteq> 1", "proof(rule ccontr, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "assume px1: \"p x = 1\""], ["proof (state)\nthis:\n  p x = 1\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "fix y"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "assume yin: \"y \\<in> supp p\" and yne: \"y \\<noteq> x\""], ["proof (state)\nthis:\n  y \\<in> supp p\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"0 \\<le> p y\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> p y", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> p y\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "with yin"], ["proof (chain)\npicking this:\n  y \\<in> supp p\n  0 \\<le> p y", "have \"0 < p y\""], ["proof (prove)\nusing this:\n  y \\<in> supp p\n  0 \\<le> p y\n\ngoal (1 subgoal):\n 1. 0 < p y", "by(auto simp:supp_def)"], ["proof (state)\nthis:\n  0 < p y\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "hence \"0 + p x < p y + p x\""], ["proof (prove)\nusing this:\n  0 < p y\n\ngoal (1 subgoal):\n 1. 0 + p x < p y + p x", "by(rule add_strict_right_mono)"], ["proof (state)\nthis:\n  0 + p x < p y + p x\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "with px1"], ["proof (chain)\npicking this:\n  p x = 1\n  0 + p x < p y + p x", "have \"1 < p x + p y\""], ["proof (prove)\nusing this:\n  p x = 1\n  0 + p x < p y + p x\n\ngoal (1 subgoal):\n 1. 1 < p x + p y", "by(simp)"], ["proof (state)\nthis:\n  1 < p x + p y\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  1 < p x + p y\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "from yin yne"], ["proof (chain)\npicking this:\n  y \\<in> supp p\n  y \\<noteq> x", "have \"p x + p y \\<le> sum p (supp p)\""], ["proof (prove)\nusing this:\n  y \\<in> supp p\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. p x + p y \\<le> sum p (supp p)", "by(rule xy_le_sum)"], ["proof (state)\nthis:\n  p x + p y \\<le> sum p (supp p)\n\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>y \\<in> supp p; y \\<noteq> x; p x = 1\\<rbrakk>\n       \\<Longrightarrow> False", "finally"], ["proof (chain)\npicking this:\n  1 < sum p (supp p)", "show False"], ["proof (prove)\nusing this:\n  1 < sum p (supp p)\n\ngoal (1 subgoal):\n 1. False", "using sump"], ["proof (prove)\nusing this:\n  1 < sum p (supp p)\n  sum p (supp p) \\<le> 1\n\ngoal (1 subgoal):\n 1. False", "by(simp)"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?y \\<in> supp p; ?y \\<noteq> x\\<rbrakk>\n  \\<Longrightarrow> p x \\<noteq> 1\n\ngoal (1 subgoal):\n 1. \\<And>x F pa.\n       \\<lbrakk>finite F; x \\<notin> F;\n        \\<And>p.\n           F = supp p \\<Longrightarrow>\n           unitary p \\<longrightarrow>\n           sum p (supp p) \\<le> 1 \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n           (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n           bd_cts (wp (SetPC a (\\<lambda>_. p)));\n        insert x F = supp pa; finite (supp p); unitary pa;\n        sum pa (supp pa) \\<le> 1; \\<forall>x\\<in>supp pa. bd_cts (wp (a x));\n        \\<forall>x\\<in>supp pa. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. pa)))", "show \"bd_cts (wp (SetPC a (\\<lambda>_. p)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a (\\<lambda>_. p)))", "proof(cases \"F = {}\")"], ["proof (state)\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "case True"], ["proof (state)\nthis:\n  F = {}\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "with pstep"], ["proof (chain)\npicking this:\n  supp p = insert x F\n  F = {}", "have \"supp p = {x}\""], ["proof (prove)\nusing this:\n  supp p = insert x F\n  F = {}\n\ngoal (1 subgoal):\n 1. supp p = {x}", "by(simp)"], ["proof (state)\nthis:\n  supp p = {x}\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "hence \"wp (SetPC a (\\<lambda>_. p)) = (\\<lambda>P s. p x * wp (a x) P s)\""], ["proof (prove)\nusing this:\n  supp p = {x}\n\ngoal (1 subgoal):\n 1. wp (SetPC a (\\<lambda>_. p)) = (\\<lambda>P s. p x * wp (a x) P s)", "by(simp add:SetPC_sgl wp_def)"], ["proof (state)\nthis:\n  wp (SetPC a (\\<lambda>_. p)) = (\\<lambda>P s. p x * wp (a x) P s)\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "moreover"], ["proof (state)\nthis:\n  wp (SetPC a (\\<lambda>_. p)) = (\\<lambda>P s. p x * wp (a x) P s)\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "{"], ["proof (state)\nthis:\n  wp (SetPC a (\\<lambda>_. p)) = (\\<lambda>P s. p x * wp (a x) P s)\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from up ca ha xin"], ["proof (chain)\npicking this:\n  unitary p\n  \\<forall>x\\<in>supp p. bd_cts (wp (a x))\n  \\<forall>x\\<in>supp p. healthy (wp (a x))\n  x \\<in> supp p", "have \"bd_cts (wp (a x))\" \"healthy (wp (a x))\" \"0 \\<le> p x\""], ["proof (prove)\nusing this:\n  unitary p\n  \\<forall>x\\<in>supp p. bd_cts (wp (a x))\n  \\<forall>x\\<in>supp p. healthy (wp (a x))\n  x \\<in> supp p\n\ngoal (1 subgoal):\n 1. bd_cts (wp (a x)) &&& healthy (wp (a x)) &&& 0 \\<le> p x", "by(auto)"], ["proof (state)\nthis:\n  bd_cts (wp (a x))\n  healthy (wp (a x))\n  0 \\<le> p x\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "hence \"bd_cts (\\<lambda>P s. p x * wp (a x) P s)\""], ["proof (prove)\nusing this:\n  bd_cts (wp (a x))\n  healthy (wp (a x))\n  0 \\<le> p x\n\ngoal (1 subgoal):\n 1. bd_cts (\\<lambda>P s. p x * wp (a x) P s)", "by(rule bd_cts_scale)"], ["proof (state)\nthis:\n  bd_cts (\\<lambda>P s. p x * wp (a x) P s)\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "}"], ["proof (state)\nthis:\n  bd_cts (\\<lambda>P s. p x * wp (a x) P s)\n\ngoal (2 subgoals):\n 1. F = {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))\n 2. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "ultimately"], ["proof (chain)\npicking this:\n  wp (SetPC a (\\<lambda>_. p)) = (\\<lambda>P s. p x * wp (a x) P s)\n  bd_cts (\\<lambda>P s. p x * wp (a x) P s)", "show ?thesis"], ["proof (prove)\nusing this:\n  wp (SetPC a (\\<lambda>_. p)) = (\\<lambda>P s. p x * wp (a x) P s)\n  bd_cts (\\<lambda>P s. p x * wp (a x) P s)\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a (\\<lambda>_. p)))", "by(simp)"], ["proof (state)\nthis:\n  bd_cts (wp (SetPC a (\\<lambda>_. p)))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "assume neF: \"F \\<noteq> {}\""], ["proof (state)\nthis:\n  F \\<noteq> {}\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "then"], ["proof (chain)\npicking this:\n  F \\<noteq> {}", "obtain y where yinF: \"y \\<in> F\""], ["proof (prove)\nusing this:\n  F \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (\\<And>y. y \\<in> F \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by(auto)"], ["proof (state)\nthis:\n  y \\<in> F\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "with xni"], ["proof (chain)\npicking this:\n  x \\<notin> F\n  y \\<in> F", "have yne: \"y \\<noteq> x\""], ["proof (prove)\nusing this:\n  x \\<notin> F\n  y \\<in> F\n\ngoal (1 subgoal):\n 1. y \\<noteq> x", "by(auto)"], ["proof (state)\nthis:\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from yinF pstep"], ["proof (chain)\npicking this:\n  y \\<in> F\n  supp p = insert x F", "have yin: \"y \\<in> supp p\""], ["proof (prove)\nusing this:\n  y \\<in> F\n  supp p = insert x F\n\ngoal (1 subgoal):\n 1. y \\<in> supp p", "by(auto)"], ["proof (state)\nthis:\n  y \\<in> supp p\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from supp_dist_remove[of p x, OF nzp n1p, OF yin yne]"], ["proof (chain)\npicking this:\n  supp (dist_remove p x) = supp p - {x}", "have supp_sub: \"supp (dist_remove p x) \\<subseteq> supp p\""], ["proof (prove)\nusing this:\n  supp (dist_remove p x) = supp p - {x}\n\ngoal (1 subgoal):\n 1. supp (dist_remove p x) \\<subseteq> supp p", "by(auto)"], ["proof (state)\nthis:\n  supp (dist_remove p x) \\<subseteq> supp p\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from xin ca"], ["proof (chain)\npicking this:\n  x \\<in> supp p\n  \\<forall>x\\<in>supp p. bd_cts (wp (a x))", "have cax: \"bd_cts (wp (a x))\""], ["proof (prove)\nusing this:\n  x \\<in> supp p\n  \\<forall>x\\<in>supp p. bd_cts (wp (a x))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (a x))", "by(auto)"], ["proof (state)\nthis:\n  bd_cts (wp (a x))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from xin ha"], ["proof (chain)\npicking this:\n  x \\<in> supp p\n  \\<forall>x\\<in>supp p. healthy (wp (a x))", "have hax: \"healthy (wp (a x))\""], ["proof (prove)\nusing this:\n  x \\<in> supp p\n  \\<forall>x\\<in>supp p. healthy (wp (a x))\n\ngoal (1 subgoal):\n 1. healthy (wp (a x))", "by(auto)"], ["proof (state)\nthis:\n  healthy (wp (a x))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from supp_sub ha"], ["proof (chain)\npicking this:\n  supp (dist_remove p x) \\<subseteq> supp p\n  \\<forall>x\\<in>supp p. healthy (wp (a x))", "have hra: \"\\<forall>x\\<in>supp (dist_remove p x). healthy (wp (a x))\""], ["proof (prove)\nusing this:\n  supp (dist_remove p x) \\<subseteq> supp p\n  \\<forall>x\\<in>supp p. healthy (wp (a x))\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>supp (dist_remove p x). healthy (wp (a x))", "by(auto)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>supp (dist_remove p x). healthy (wp (a x))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from supp_sub ca"], ["proof (chain)\npicking this:\n  supp (dist_remove p x) \\<subseteq> supp p\n  \\<forall>x\\<in>supp p. bd_cts (wp (a x))", "have cra: \"\\<forall>x\\<in>supp (dist_remove p x). bd_cts (wp (a x))\""], ["proof (prove)\nusing this:\n  supp (dist_remove p x) \\<subseteq> supp p\n  \\<forall>x\\<in>supp p. bd_cts (wp (a x))\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>supp (dist_remove p x). bd_cts (wp (a x))", "by(auto)"], ["proof (state)\nthis:\n  \\<forall>x\\<in>supp (dist_remove p x). bd_cts (wp (a x))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from supp_dist_remove[of p x, OF nzp n1p, OF yin yne] pstep xni"], ["proof (chain)\npicking this:\n  supp (dist_remove p x) = supp p - {x}\n  supp p = insert x F\n  x \\<notin> F", "have Fsupp: \"F = supp (dist_remove p x)\""], ["proof (prove)\nusing this:\n  supp (dist_remove p x) = supp p - {x}\n  supp p = insert x F\n  x \\<notin> F\n\ngoal (1 subgoal):\n 1. F = supp (dist_remove p x)", "by(simp)"], ["proof (state)\nthis:\n  F = supp (dist_remove p x)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "have udp: \"unitary (dist_remove p x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary (dist_remove p x)", "proof(intro unitaryI2 nnegI bounded_byI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>xa. 0 \\<le> dist_remove p x xa\n 2. \\<And>xa. dist_remove p x xa \\<le> 1", "fix y"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>xa. 0 \\<le> dist_remove p x xa\n 2. \\<And>xa. dist_remove p x xa \\<le> 1", "show \"0 \\<le> dist_remove p x y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> dist_remove p x y", "proof(cases \"y=x\", simp_all add:dist_remove_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. y \\<noteq> x \\<Longrightarrow> 0 \\<le> p y / (1 - p x)", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"0 \\<le> p y\" \"0 \\<le> 1 - p x\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. 0 \\<le> p y &&& 0 \\<le> 1 - p x", "by auto"], ["proof (state)\nthis:\n  0 \\<le> p y\n  0 \\<le> 1 - p x\n\ngoal (1 subgoal):\n 1. y \\<noteq> x \\<Longrightarrow> 0 \\<le> p y / (1 - p x)", "thus \"0 \\<le> p y / (1 - p x)\""], ["proof (prove)\nusing this:\n  0 \\<le> p y\n  0 \\<le> 1 - p x\n\ngoal (1 subgoal):\n 1. 0 \\<le> p y / (1 - p x)", "by(rule divide_nonneg_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> p y / (1 - p x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  0 \\<le> dist_remove p x y\n\ngoal (1 subgoal):\n 1. \\<And>xa. dist_remove p x xa \\<le> 1", "show \"dist_remove p x y \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dist_remove p x y \\<le> 1", "proof(cases \"y=x\", simp_all add:dist_remove_def,\n              cases \"y\\<in>supp p\", simp_all add:nsupp_zero)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "assume yne: \"y \\<noteq> x\" and yin: \"y \\<in> supp p\""], ["proof (state)\nthis:\n  y \\<noteq> x\n  y \\<in> supp p\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "hence \"p x + p y \\<le> sum p (supp p)\""], ["proof (prove)\nusing this:\n  y \\<noteq> x\n  y \\<in> supp p\n\ngoal (1 subgoal):\n 1. p x + p y \\<le> sum p (supp p)", "by(auto intro:xy_le_sum)"], ["proof (state)\nthis:\n  p x + p y \\<le> sum p (supp p)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "also"], ["proof (state)\nthis:\n  p x + p y \\<le> sum p (supp p)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "note sump"], ["proof (state)\nthis:\n  sum p (supp p) \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "finally"], ["proof (chain)\npicking this:\n  p x + p y \\<le> 1", "have \"p y \\<le> 1 - p x\""], ["proof (prove)\nusing this:\n  p x + p y \\<le> 1\n\ngoal (1 subgoal):\n 1. p y \\<le> 1 - p x", "by(auto)"], ["proof (state)\nthis:\n  p y \\<le> 1 - p x\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "moreover"], ["proof (state)\nthis:\n  p y \\<le> 1 - p x\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"p x \\<le> 1\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. p x \\<le> 1", "by(auto)"], ["proof (state)\nthis:\n  p x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "moreover"], ["proof (state)\nthis:\n  p x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "from yin yne"], ["proof (chain)\npicking this:\n  y \\<in> supp p\n  y \\<noteq> x", "have \"p x \\<noteq> 1\""], ["proof (prove)\nusing this:\n  y \\<in> supp p\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. p x \\<noteq> 1", "by(rule n1p)"], ["proof (state)\nthis:\n  p x \\<noteq> 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>y \\<noteq> x; y \\<in> supp p\\<rbrakk>\n    \\<Longrightarrow> p y / (1 - p x) \\<le> 1", "ultimately"], ["proof (chain)\npicking this:\n  p y \\<le> 1 - p x\n  p x \\<le> 1\n  p x \\<noteq> 1", "show \"p y / (1 - p x) \\<le> 1\""], ["proof (prove)\nusing this:\n  p y \\<le> 1 - p x\n  p x \\<le> 1\n  p x \\<noteq> 1\n\ngoal (1 subgoal):\n 1. p y / (1 - p x) \\<le> 1", "by(auto)"], ["proof (state)\nthis:\n  p y / (1 - p x) \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  dist_remove p x y \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  unitary (dist_remove p x)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from xin"], ["proof (chain)\npicking this:\n  x \\<in> supp p", "have pxn0: \"p x \\<noteq> 0\""], ["proof (prove)\nusing this:\n  x \\<in> supp p\n\ngoal (1 subgoal):\n 1. p x \\<noteq> 0", "by(auto simp:supp_def)"], ["proof (state)\nthis:\n  p x \\<noteq> 0\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from yin yne"], ["proof (chain)\npicking this:\n  y \\<in> supp p\n  y \\<noteq> x", "have pxn1: \"p x \\<noteq> 1\""], ["proof (prove)\nusing this:\n  y \\<in> supp p\n  y \\<noteq> x\n\ngoal (1 subgoal):\n 1. p x \\<noteq> 1", "by(rule n1p)"], ["proof (state)\nthis:\n  p x \\<noteq> 1\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from pxn0 pxn1"], ["proof (chain)\npicking this:\n  p x \\<noteq> 0\n  p x \\<noteq> 1", "have \"sum (dist_remove p x) (supp (dist_remove p x)) =\n                           sum (dist_remove p x) (supp p - {x})\""], ["proof (prove)\nusing this:\n  p x \\<noteq> 0\n  p x \\<noteq> 1\n\ngoal (1 subgoal):\n 1. sum (dist_remove p x) (supp (dist_remove p x)) =\n    sum (dist_remove p x) (supp p - {x})", "by(simp add:supp_dist_remove)"], ["proof (state)\nthis:\n  sum (dist_remove p x) (supp (dist_remove p x)) =\n  sum (dist_remove p x) (supp p - {x})\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "also"], ["proof (state)\nthis:\n  sum (dist_remove p x) (supp (dist_remove p x)) =\n  sum (dist_remove p x) (supp p - {x})\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "have \"... = (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum (dist_remove p x) (supp p - {x}) =\n    (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x))", "by(simp add:dist_remove_def)"], ["proof (state)\nthis:\n  sum (dist_remove p x) (supp p - {x}) =\n  (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "also"], ["proof (state)\nthis:\n  sum (dist_remove p x) (supp p - {x}) =\n  (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "have \"... = (\\<Sum>y\\<in>supp p - {x}. p y) / (1 - p x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x)) =\n    sum p (supp p - {x}) / (1 - p x)", "by(simp add:sum_divide_distrib)"], ["proof (state)\nthis:\n  (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x)) =\n  sum p (supp p - {x}) / (1 - p x)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "also"], ["proof (state)\nthis:\n  (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x)) =\n  sum p (supp p - {x}) / (1 - p x)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "{"], ["proof (state)\nthis:\n  (\\<Sum>y\\<in>supp p - {x}. p y / (1 - p x)) =\n  sum p (supp p - {x}) / (1 - p x)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from xin"], ["proof (chain)\npicking this:\n  x \\<in> supp p", "have \"insert x (supp p) = supp p\""], ["proof (prove)\nusing this:\n  x \\<in> supp p\n\ngoal (1 subgoal):\n 1. insert x (supp p) = supp p", "by(auto)"], ["proof (state)\nthis:\n  insert x (supp p) = supp p\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "with fsupp"], ["proof (chain)\npicking this:\n  finite (supp p)\n  insert x (supp p) = supp p", "have \"p x + (\\<Sum>y\\<in>supp p - {x}. p y) = sum p (supp p)\""], ["proof (prove)\nusing this:\n  finite (supp p)\n  insert x (supp p) = supp p\n\ngoal (1 subgoal):\n 1. p x + sum p (supp p - {x}) = sum p (supp p)", "by(simp add:sum.insert[symmetric])"], ["proof (state)\nthis:\n  p x + sum p (supp p - {x}) = sum p (supp p)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "also"], ["proof (state)\nthis:\n  p x + sum p (supp p - {x}) = sum p (supp p)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "note sump"], ["proof (state)\nthis:\n  sum p (supp p) \\<le> 1\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "finally"], ["proof (chain)\npicking this:\n  p x + sum p (supp p - {x}) \\<le> 1", "have \"sum p (supp p - {x}) \\<le> 1 - p x\""], ["proof (prove)\nusing this:\n  p x + sum p (supp p - {x}) \\<le> 1\n\ngoal (1 subgoal):\n 1. sum p (supp p - {x}) \\<le> 1 - p x", "by(auto)"], ["proof (state)\nthis:\n  sum p (supp p - {x}) \\<le> 1 - p x\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "moreover"], ["proof (state)\nthis:\n  sum p (supp p - {x}) \\<le> 1 - p x\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "{"], ["proof (state)\nthis:\n  sum p (supp p - {x}) \\<le> 1 - p x\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have \"p x \\<le> 1\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. p x \\<le> 1", "by(auto)"], ["proof (state)\nthis:\n  p x \\<le> 1\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "with pxn1"], ["proof (chain)\npicking this:\n  p x \\<noteq> 1\n  p x \\<le> 1", "have \"p x < 1\""], ["proof (prove)\nusing this:\n  p x \\<noteq> 1\n  p x \\<le> 1\n\ngoal (1 subgoal):\n 1. p x < 1", "by(auto)"], ["proof (state)\nthis:\n  p x < 1\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "hence \"0 < 1 - p x\""], ["proof (prove)\nusing this:\n  p x < 1\n\ngoal (1 subgoal):\n 1. 0 < 1 - p x", "by(auto)"], ["proof (state)\nthis:\n  0 < 1 - p x\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "}"], ["proof (state)\nthis:\n  0 < 1 - p x\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "ultimately"], ["proof (chain)\npicking this:\n  sum p (supp p - {x}) \\<le> 1 - p x\n  0 < 1 - p x", "have \"sum p (supp p - {x}) / (1 - p x) \\<le> 1\""], ["proof (prove)\nusing this:\n  sum p (supp p - {x}) \\<le> 1 - p x\n  0 < 1 - p x\n\ngoal (1 subgoal):\n 1. sum p (supp p - {x}) / (1 - p x) \\<le> 1", "by(auto)"], ["proof (state)\nthis:\n  sum p (supp p - {x}) / (1 - p x) \\<le> 1\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "}"], ["proof (state)\nthis:\n  sum p (supp p - {x}) / (1 - p x) \\<le> 1\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "finally"], ["proof (chain)\npicking this:\n  sum (dist_remove p x) (supp (dist_remove p x)) \\<le> 1", "have sdp: \"sum (dist_remove p x) (supp (dist_remove p x)) \\<le> 1\""], ["proof (prove)\nusing this:\n  sum (dist_remove p x) (supp (dist_remove p x)) \\<le> 1\n\ngoal (1 subgoal):\n 1. sum (dist_remove p x) (supp (dist_remove p x)) \\<le> 1", "."], ["proof (state)\nthis:\n  sum (dist_remove p x) (supp (dist_remove p x)) \\<le> 1\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from Fsupp udp sdp hra cra IH"], ["proof (chain)\npicking this:\n  F = supp (dist_remove p x)\n  unitary (dist_remove p x)\n  sum (dist_remove p x) (supp (dist_remove p x)) \\<le> 1\n  \\<forall>x\\<in>supp (dist_remove p x). healthy (wp (a x))\n  \\<forall>x\\<in>supp (dist_remove p x). bd_cts (wp (a x))\n  F = supp ?p \\<Longrightarrow>\n  unitary ?p \\<longrightarrow>\n  sum ?p (supp ?p) \\<le> 1 \\<longrightarrow>\n  (\\<forall>x\\<in>supp ?p. bd_cts (wp (a x))) \\<longrightarrow>\n  (\\<forall>x\\<in>supp ?p. healthy (wp (a x))) \\<longrightarrow>\n  bd_cts (wp (SetPC a (\\<lambda>_. ?p)))", "have cts_dr: \"bd_cts (wp (SetPC a (\\<lambda>_. dist_remove p x)))\""], ["proof (prove)\nusing this:\n  F = supp (dist_remove p x)\n  unitary (dist_remove p x)\n  sum (dist_remove p x) (supp (dist_remove p x)) \\<le> 1\n  \\<forall>x\\<in>supp (dist_remove p x). healthy (wp (a x))\n  \\<forall>x\\<in>supp (dist_remove p x). bd_cts (wp (a x))\n  F = supp ?p \\<Longrightarrow>\n  unitary ?p \\<longrightarrow>\n  sum ?p (supp ?p) \\<le> 1 \\<longrightarrow>\n  (\\<forall>x\\<in>supp ?p. bd_cts (wp (a x))) \\<longrightarrow>\n  (\\<forall>x\\<in>supp ?p. healthy (wp (a x))) \\<longrightarrow>\n  bd_cts (wp (SetPC a (\\<lambda>_. ?p)))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a (\\<lambda>_. dist_remove p x)))", "by(auto)"], ["proof (state)\nthis:\n  bd_cts (wp (SetPC a (\\<lambda>_. dist_remove p x)))\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from up"], ["proof (chain)\npicking this:\n  unitary p", "have upx: \"unitary (\\<lambda>_. p x)\""], ["proof (prove)\nusing this:\n  unitary p\n\ngoal (1 subgoal):\n 1. unitary (\\<lambda>_. p x)", "by(auto)"], ["proof (state)\nthis:\n  unitary (\\<lambda>_. p x)\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetPC a (\\<lambda>_. p)))", "from pxn0 pxn1 fsupp hra"], ["proof (chain)\npicking this:\n  p x \\<noteq> 0\n  p x \\<noteq> 1\n  finite (supp p)\n  \\<forall>x\\<in>supp (dist_remove p x). healthy (wp (a x))", "show ?thesis"], ["proof (prove)\nusing this:\n  p x \\<noteq> 0\n  p x \\<noteq> 1\n  finite (supp p)\n  \\<forall>x\\<in>supp (dist_remove p x). healthy (wp (a x))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a (\\<lambda>_. p)))", "by(simp add:SetPC_remove,\n           blast intro:cts_wp_PC cax cts_dr hax healthy_intros\n                       unitary_sound[OF udp] sdp upx)"], ["proof (state)\nthis:\n  bd_cts (wp (SetPC a (\\<lambda>_. p)))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bd_cts (wp (SetPC a (\\<lambda>_. p)))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  unitary p \\<longrightarrow>\n  sum p (supp p) \\<le> 1 \\<longrightarrow>\n  (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n  (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n  bd_cts (wp (SetPC a (\\<lambda>_. p)))\n\ngoal (1 subgoal):\n 1. supp p \\<noteq> {} \\<Longrightarrow>\n    bd_cts (wp (SetPC a (\\<lambda>_. p)))", "with assms"], ["proof (chain)\npicking this:\n  ?x \\<in> supp p \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> supp p \\<Longrightarrow> healthy (wp (a ?x))\n  unitary p\n  sum p (supp p) \\<le> 1\n  finite (supp p)\n  unitary p \\<longrightarrow>\n  sum p (supp p) \\<le> 1 \\<longrightarrow>\n  (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n  (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n  bd_cts (wp (SetPC a (\\<lambda>_. p)))", "show ?thesis"], ["proof (prove)\nusing this:\n  ?x \\<in> supp p \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> supp p \\<Longrightarrow> healthy (wp (a ?x))\n  unitary p\n  sum p (supp p) \\<le> 1\n  finite (supp p)\n  unitary p \\<longrightarrow>\n  sum p (supp p) \\<le> 1 \\<longrightarrow>\n  (\\<forall>x\\<in>supp p. bd_cts (wp (a x))) \\<longrightarrow>\n  (\\<forall>x\\<in>supp p. healthy (wp (a x))) \\<longrightarrow>\n  bd_cts (wp (SetPC a (\\<lambda>_. p)))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a (\\<lambda>_. p)))", "by(auto)"], ["proof (state)\nthis:\n  bd_cts (wp (SetPC a (\\<lambda>_. p)))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_SetPC:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x s. x \\<in> (supp (p s)) \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x s. x \\<in> (supp (p s)) \\<Longrightarrow> healthy (wp (a x))\"\n      and up: \"\\<And>s. unitary (p s)\"\n      and sump: \"\\<And>s. sum (p s) (supp (p s)) \\<le> 1\"\n      and fsupp: \"\\<And>s. finite (supp (p s))\"\n  shows \"bd_cts (wp (SetPC a p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a p))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a p))", "from assms"], ["proof (chain)\npicking this:\n  ?x \\<in> supp (p ?s) \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> supp (p ?s) \\<Longrightarrow> healthy (wp (a ?x))\n  unitary (p ?s)\n  sum (p ?s) (supp (p ?s)) \\<le> 1\n  finite (supp (p ?s))", "have \"bd_cts (wp (Bind p (\\<lambda>p. SetPC a (\\<lambda>_. p))))\""], ["proof (prove)\nusing this:\n  ?x \\<in> supp (p ?s) \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> supp (p ?s) \\<Longrightarrow> healthy (wp (a ?x))\n  unitary (p ?s)\n  sum (p ?s) (supp (p ?s)) \\<le> 1\n  finite (supp (p ?s))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (Bind p (\\<lambda>p. SetPC a (\\<lambda>_. p))))", "by(iprover intro!:cts_wp_Bind cts_wp_SetPC_const)"], ["proof (state)\nthis:\n  bd_cts (wp (Bind p (\\<lambda>p. SetPC a (\\<lambda>_. p))))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a p))", "thus ?thesis"], ["proof (prove)\nusing this:\n  bd_cts (wp (Bind p (\\<lambda>p. SetPC a (\\<lambda>_. p))))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetPC a p))", "by(simp add:SetPC_Bind[symmetric])"], ["proof (state)\nthis:\n  bd_cts (wp (SetPC a p))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma wp_SetDC_Bind:\n  \"SetDC a S = Bind S (\\<lambda>S. SetDC a (\\<lambda>_. S))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SetDC a S = Bind S (\\<lambda>S. SetDC a (\\<lambda>_. S))", "by(intro ext, simp add:SetDC_def Bind_def)"], ["", "lemma SetDC_finite_insert:\n  assumes fS: \"finite S\"\n      and neS: \"S \\<noteq> {}\"\n  shows \"SetDC a (\\<lambda>_. insert x S) = a x \\<Sqinter> SetDC a (\\<lambda>_. S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SetDC a (\\<lambda>_. insert x S) =\n    a x \\<Sqinter> SetDC a (\\<lambda>_. S)", "proof (intro ext, simp add: SetDC_def DC_def cong del: image_cong_simp cong add: INF_cong_simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "fix ab P s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "from fS"], ["proof (chain)\npicking this:\n  finite S", "have A: \"finite (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))\" \n           and B: \"finite (((\\<lambda>x. a x ab P s) ` S))\""], ["proof (prove)\nusing this:\n  finite S\n\ngoal (1 subgoal):\n 1. finite (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) &&&\n    finite ((\\<lambda>x. a x ab P s) ` S)", "by(auto)"], ["proof (state)\nthis:\n  finite (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))\n  finite ((\\<lambda>x. a x ab P s) ` S)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "from neS"], ["proof (chain)\npicking this:\n  S \\<noteq> {}", "have C: \"insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S) \\<noteq> {}\"\n            and D: \"(\\<lambda>x. a x ab P s) ` S \\<noteq> {}\""], ["proof (prove)\nusing this:\n  S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S) \\<noteq> {} &&&\n    (\\<lambda>x. a x ab P s) ` S \\<noteq> {}", "by(auto)"], ["proof (state)\nthis:\n  insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S) \\<noteq> {}\n  (\\<lambda>x. a x ab P s) ` S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "from A C"], ["proof (chain)\npicking this:\n  finite (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))\n  insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S) \\<noteq> {}", "have \"Inf (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n                 Min (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))\""], ["proof (prove)\nusing this:\n  finite (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))\n  insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S) \\<noteq> {}\n\ngoal (1 subgoal):\n 1. Inf (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n    Min (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))", "by(auto intro:cInf_eq_Min)"], ["proof (state)\nthis:\n  Inf (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n  Min (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "also"], ["proof (state)\nthis:\n  Inf (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n  Min (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S))\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "from B D"], ["proof (chain)\npicking this:\n  finite ((\\<lambda>x. a x ab P s) ` S)\n  (\\<lambda>x. a x ab P s) ` S \\<noteq> {}", "have \"... = min (a x ab P s) (Min ((\\<lambda>x. a x ab P s) ` S))\""], ["proof (prove)\nusing this:\n  finite ((\\<lambda>x. a x ab P s) ` S)\n  (\\<lambda>x. a x ab P s) ` S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. Min (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n    min (a x ab P s) (MIN x\\<in>S. a x ab P s)", "by(auto intro:Min_insert)"], ["proof (state)\nthis:\n  Min (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n  min (a x ab P s) (MIN x\\<in>S. a x ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "also"], ["proof (state)\nthis:\n  Min (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n  min (a x ab P s) (MIN x\\<in>S. a x ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "from B D"], ["proof (chain)\npicking this:\n  finite ((\\<lambda>x. a x ab P s) ` S)\n  (\\<lambda>x. a x ab P s) ` S \\<noteq> {}", "have \"... = min (a x ab P s) (Inf ((\\<lambda>x. a x ab P s) ` S))\""], ["proof (prove)\nusing this:\n  finite ((\\<lambda>x. a x ab P s) ` S)\n  (\\<lambda>x. a x ab P s) ` S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. min (a x ab P s) (MIN x\\<in>S. a x ab P s) =\n    min (a x ab P s) (INF x\\<in>S. a x ab P s)", "by(simp add:cInf_eq_Min)"], ["proof (state)\nthis:\n  min (a x ab P s) (MIN x\\<in>S. a x ab P s) =\n  min (a x ab P s) (INF x\\<in>S. a x ab P s)\n\ngoal (1 subgoal):\n 1. \\<And>xa xaa xb.\n       (INF x\\<in>insert x S. a x xa xaa xb) =\n       min (a x xa xaa xb) (INF x\\<in>S. a x xa xaa xb)", "finally"], ["proof (chain)\npicking this:\n  Inf (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n  min (a x ab P s) (INF x\\<in>S. a x ab P s)", "show \"(INF x\\<in>insert x S. a x ab P s) =\n    min (a x ab P s) (INF x\\<in>S. a x ab P s)\""], ["proof (prove)\nusing this:\n  Inf (insert (a x ab P s) ((\\<lambda>x. a x ab P s) ` S)) =\n  min (a x ab P s) (INF x\\<in>S. a x ab P s)\n\ngoal (1 subgoal):\n 1. (INF x\\<in>insert x S. a x ab P s) =\n    min (a x ab P s) (INF x\\<in>S. a x ab P s)", "by (simp cong del: INF_cong_simp)"], ["proof (state)\nthis:\n  (INF x\\<in>insert x S. a x ab P s) =\n  min (a x ab P s) (INF x\\<in>S. a x ab P s)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SetDC_singleton:\n  \"SetDC a (\\<lambda>_. {x}) = a x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. SetDC a (\\<lambda>_. {x}) = a x", "by (simp add: SetDC_def cong del: INF_cong_simp)"], ["", "lemma cts_wp_SetDC_const:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x. x \\<in> S \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x. x \\<in> S \\<Longrightarrow> healthy (wp (a x))\"\n      and fS: \"finite S\"\n      and neS: \"S \\<noteq> {}\"\n  shows \"bd_cts (wp (SetDC a (\\<lambda>_. S)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a (\\<lambda>_. S)))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a (\\<lambda>_. S)))", "have \"finite S \\<Longrightarrow> S \\<noteq> {} \\<Longrightarrow>\n        (\\<forall>x\\<in>S. bd_cts (wp (a x))) \\<longrightarrow>\n        (\\<forall>x\\<in>S. healthy (wp (a x))) \\<longrightarrow>\n        bd_cts (wp (SetDC a (\\<lambda>_. S)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>finite S; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>S.\n                          bd_cts (wp (a x))) \\<longrightarrow>\n                      (\\<forall>x\\<in>S.\n                          healthy (wp (a x))) \\<longrightarrow>\n                      bd_cts (wp (SetDC a (\\<lambda>_. S)))", "proof(induct S rule:finite_induct, simp, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x F.\n       \\<lbrakk>finite F; x \\<notin> F;\n        F \\<noteq> {} \\<Longrightarrow>\n        bd_cts (wp (SetDC a (\\<lambda>_. F)));\n        bd_cts (wp (a x)); \\<forall>x\\<in>F. bd_cts (wp (a x));\n        healthy (wp (a x)); \\<forall>x\\<in>F. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))", "fix x::'a and F::\"'a set\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x F.\n       \\<lbrakk>finite F; x \\<notin> F;\n        F \\<noteq> {} \\<Longrightarrow>\n        bd_cts (wp (SetDC a (\\<lambda>_. F)));\n        bd_cts (wp (a x)); \\<forall>x\\<in>F. bd_cts (wp (a x));\n        healthy (wp (a x)); \\<forall>x\\<in>F. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))", "assume fF: \"finite F\"\n       and IH: \"F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetDC a (\\<lambda>_. F)))\"\n       and cax: \"bd_cts (wp (a x))\"\n       and hax: \"healthy (wp (a x))\"\n       and haF: \"\\<forall>x\\<in>F. healthy (wp (a x))\""], ["proof (state)\nthis:\n  finite F\n  F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetDC a (\\<lambda>_. F)))\n  bd_cts (wp (a x))\n  healthy (wp (a x))\n  \\<forall>x\\<in>F. healthy (wp (a x))\n\ngoal (1 subgoal):\n 1. \\<And>x F.\n       \\<lbrakk>finite F; x \\<notin> F;\n        F \\<noteq> {} \\<Longrightarrow>\n        bd_cts (wp (SetDC a (\\<lambda>_. F)));\n        bd_cts (wp (a x)); \\<forall>x\\<in>F. bd_cts (wp (a x));\n        healthy (wp (a x)); \\<forall>x\\<in>F. healthy (wp (a x))\\<rbrakk>\n       \\<Longrightarrow> bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))", "show \"bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))", "proof(cases \"F = {}\", simp add:SetDC_singleton cax)"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow>\n    bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))", "assume \"F \\<noteq> {}\""], ["proof (state)\nthis:\n  F \\<noteq> {}\n\ngoal (1 subgoal):\n 1. F \\<noteq> {} \\<Longrightarrow>\n    bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))", "with fF cax hax haF IH"], ["proof (chain)\npicking this:\n  finite F\n  bd_cts (wp (a x))\n  healthy (wp (a x))\n  \\<forall>x\\<in>F. healthy (wp (a x))\n  F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetDC a (\\<lambda>_. F)))\n  F \\<noteq> {}", "show \"bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))\""], ["proof (prove)\nusing this:\n  finite F\n  bd_cts (wp (a x))\n  healthy (wp (a x))\n  \\<forall>x\\<in>F. healthy (wp (a x))\n  F \\<noteq> {} \\<Longrightarrow> bd_cts (wp (SetDC a (\\<lambda>_. F)))\n  F \\<noteq> {}\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))", "by(auto intro!:cts_wp_DC healthy_intros simp:SetDC_finite_insert)"], ["proof (state)\nthis:\n  bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  bd_cts (wp (SetDC a (\\<lambda>_. insert x F)))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>finite S; S \\<noteq> {}\\<rbrakk>\n  \\<Longrightarrow> (\\<forall>x\\<in>S. bd_cts (wp (a x))) \\<longrightarrow>\n                    (\\<forall>x\\<in>S. healthy (wp (a x))) \\<longrightarrow>\n                    bd_cts (wp (SetDC a (\\<lambda>_. S)))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a (\\<lambda>_. S)))", "with assms"], ["proof (chain)\npicking this:\n  ?x \\<in> S \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> S \\<Longrightarrow> healthy (wp (a ?x))\n  finite S\n  S \\<noteq> {}\n  \\<lbrakk>finite S; S \\<noteq> {}\\<rbrakk>\n  \\<Longrightarrow> (\\<forall>x\\<in>S. bd_cts (wp (a x))) \\<longrightarrow>\n                    (\\<forall>x\\<in>S. healthy (wp (a x))) \\<longrightarrow>\n                    bd_cts (wp (SetDC a (\\<lambda>_. S)))", "show ?thesis"], ["proof (prove)\nusing this:\n  ?x \\<in> S \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> S \\<Longrightarrow> healthy (wp (a ?x))\n  finite S\n  S \\<noteq> {}\n  \\<lbrakk>finite S; S \\<noteq> {}\\<rbrakk>\n  \\<Longrightarrow> (\\<forall>x\\<in>S. bd_cts (wp (a x))) \\<longrightarrow>\n                    (\\<forall>x\\<in>S. healthy (wp (a x))) \\<longrightarrow>\n                    bd_cts (wp (SetDC a (\\<lambda>_. S)))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a (\\<lambda>_. S)))", "by(auto)"], ["proof (state)\nthis:\n  bd_cts (wp (SetDC a (\\<lambda>_. S)))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_SetDC:\n  fixes a::\"'a \\<Rightarrow> 's prog\"\n  assumes ca: \"\\<And>x s. x \\<in> S s \\<Longrightarrow> bd_cts (wp (a x))\"\n      and ha: \"\\<And>x s. x \\<in> S s \\<Longrightarrow> healthy (wp (a x))\"\n      and fS: \"\\<And>s. finite (S s)\"\n      and neS: \"\\<And>s. S s \\<noteq> {}\"\n  shows \"bd_cts (wp (SetDC a S))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a S))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a S))", "from assms"], ["proof (chain)\npicking this:\n  ?x \\<in> S ?s \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> S ?s \\<Longrightarrow> healthy (wp (a ?x))\n  finite (S ?s)\n  S ?s \\<noteq> {}", "have \"bd_cts (wp (Bind S (\\<lambda>S. SetDC a (\\<lambda>_. S))))\""], ["proof (prove)\nusing this:\n  ?x \\<in> S ?s \\<Longrightarrow> bd_cts (wp (a ?x))\n  ?x \\<in> S ?s \\<Longrightarrow> healthy (wp (a ?x))\n  finite (S ?s)\n  S ?s \\<noteq> {}\n\ngoal (1 subgoal):\n 1. bd_cts (wp (Bind S (\\<lambda>S. SetDC a (\\<lambda>_. S))))", "by(iprover intro!:cts_wp_Bind cts_wp_SetDC_const)"], ["proof (state)\nthis:\n  bd_cts (wp (Bind S (\\<lambda>S. SetDC a (\\<lambda>_. S))))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a S))", "thus ?thesis"], ["proof (prove)\nusing this:\n  bd_cts (wp (Bind S (\\<lambda>S. SetDC a (\\<lambda>_. S))))\n\ngoal (1 subgoal):\n 1. bd_cts (wp (SetDC a S))", "by(simp add:wp_SetDC_Bind[symmetric])"], ["proof (state)\nthis:\n  bd_cts (wp (SetDC a S))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cts_wp_repeat:\n  \"bd_cts (wp a) \\<Longrightarrow> healthy (wp a) \\<Longrightarrow> bd_cts (wp (repeat n a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>bd_cts (wp a); healthy (wp a)\\<rbrakk>\n    \\<Longrightarrow> bd_cts (wp (repeat n a))", "by(induct n, auto intro:cts_wp_Skip cts_wp_Seq healthy_intros)"], ["", "lemma cts_wp_Embed:\n  \"bd_cts t \\<Longrightarrow> bd_cts (wp (Embed t))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts t \\<Longrightarrow> bd_cts (wp (Embed t))", "by(simp add:wp_eval)"], ["", "subsection \\<open>Continuity of a Single Loop Step\\<close>"], ["", "text \\<open>A single loop iteration is continuous, in the more general sense defined above for\ntransformer transformers.\\<close>"], ["", "lemma cts_wp_loopstep:\n  fixes body::\"'s prog\"\n  assumes hb: \"healthy (wp body)\"\n      and cb: \"bd_cts (wp body)\"\n  shows \"bd_cts_tr (\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\" (is \"bd_cts_tr ?F\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. bd_cts_tr\n     (\\<lambda>x.\n         wp (body ;;\n             Embed\n              x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))", "proof(rule bd_cts_trI, rule le_trans_antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>M.\n       \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n        \\<And>i. feasible (M i)\\<rbrakk>\n       \\<Longrightarrow> le_trans\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\n                          (Sup_trans\n                            (range\n                              ((\\<lambda>x.\n                                   wp (body ;;\n Embed\n  x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                               M)))\n 2. \\<And>M.\n       \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n        \\<And>i. feasible (M i)\\<rbrakk>\n       \\<Longrightarrow> le_trans\n                          (Sup_trans\n                            (range\n                              ((\\<lambda>x.\n                                   wp (body ;;\n Embed\n  x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                               M)))\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))", "fix M::\"nat \\<Rightarrow> 's trans\" and b::real"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>M.\n       \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n        \\<And>i. feasible (M i)\\<rbrakk>\n       \\<Longrightarrow> le_trans\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\n                          (Sup_trans\n                            (range\n                              ((\\<lambda>x.\n                                   wp (body ;;\n Embed\n  x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                               M)))\n 2. \\<And>M.\n       \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n        \\<And>i. feasible (M i)\\<rbrakk>\n       \\<Longrightarrow> le_trans\n                          (Sup_trans\n                            (range\n                              ((\\<lambda>x.\n                                   wp (body ;;\n Embed\n  x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                               M)))\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))", "assume chain: \"\\<And>i. le_trans (M i) (M (Suc i))\"\n     and fM:    \"\\<And>i. feasible (M i)\""], ["proof (state)\nthis:\n  le_trans (M ?i) (M (Suc ?i))\n  feasible (M ?i)\n\ngoal (2 subgoals):\n 1. \\<And>M.\n       \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n        \\<And>i. feasible (M i)\\<rbrakk>\n       \\<Longrightarrow> le_trans\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\n                          (Sup_trans\n                            (range\n                              ((\\<lambda>x.\n                                   wp (body ;;\n Embed\n  x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                               M)))\n 2. \\<And>M.\n       \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n        \\<And>i. feasible (M i)\\<rbrakk>\n       \\<Longrightarrow> le_trans\n                          (Sup_trans\n                            (range\n                              ((\\<lambda>x.\n                                   wp (body ;;\n Embed\n  x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                               M)))\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))", "show fw: \"le_trans (Sup_trans (range (?F o M))) (?F (Sup_trans (range M)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. le_trans\n     (Sup_trans\n       (range\n         ((\\<lambda>x.\n              wp (body ;;\n                  Embed\n                   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n          M)))\n     (wp (body ;;\n          Embed\n           (Sup_trans\n             (range\n               M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))", "proof(rule le_transI[OF Sup_trans_least2], clarsimp)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "fix P Q::\"'s expect\" and t"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "assume sP: \"sound P\""], ["proof (state)\nthis:\n  sound P\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "assume nQ: \"nneg Q\" and bP: \"bounded_by (bound_of P) Q\""], ["proof (state)\nthis:\n  nneg Q\n  bounded_by (bound_of P) Q\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "hence sQ: \"sound Q\""], ["proof (prove)\nusing this:\n  nneg Q\n  bounded_by (bound_of P) Q\n\ngoal (1 subgoal):\n 1. sound Q", "by(auto)"], ["proof (state)\nthis:\n  sound Q\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "from fM"], ["proof (chain)\npicking this:\n  feasible (M ?i)", "have fSup: \"feasible (Sup_trans (range M))\""], ["proof (prove)\nusing this:\n  feasible (M ?i)\n\ngoal (1 subgoal):\n 1. feasible (Sup_trans (range M))", "by(auto intro:feasible_Sup_trans)"], ["proof (state)\nthis:\n  feasible (Sup_trans (range M))\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "from sQ fM"], ["proof (chain)\npicking this:\n  sound Q\n  feasible (M ?i)", "have \"M t Q \\<tturnstile> Sup_trans (range M) Q\""], ["proof (prove)\nusing this:\n  sound Q\n  feasible (M ?i)\n\ngoal (1 subgoal):\n 1. M t Q \\<tturnstile> Sup_trans (range M) Q", "by(auto intro:Sup_trans_upper2)"], ["proof (state)\nthis:\n  M t Q \\<tturnstile> Sup_trans (range M) Q\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "moreover"], ["proof (state)\nthis:\n  M t Q \\<tturnstile> Sup_trans (range M) Q\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "from sQ fM fSup"], ["proof (chain)\npicking this:\n  sound Q\n  feasible (M ?i)\n  feasible (Sup_trans (range M))", "have sMtP: \"sound (M t Q)\" \"sound (Sup_trans (range M) Q)\""], ["proof (prove)\nusing this:\n  sound Q\n  feasible (M ?i)\n  feasible (Sup_trans (range M))\n\ngoal (1 subgoal):\n 1. sound (M t Q) &&& sound (Sup_trans (range M) Q)", "by(auto)"], ["proof (state)\nthis:\n  sound (M t Q)\n  sound (Sup_trans (range M) Q)\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "ultimately"], ["proof (chain)\npicking this:\n  M t Q \\<tturnstile> Sup_trans (range M) Q\n  sound (M t Q)\n  sound (Sup_trans (range M) Q)", "have \"wp body (M t Q) \\<tturnstile> wp body (Sup_trans (range M) Q)\""], ["proof (prove)\nusing this:\n  M t Q \\<tturnstile> Sup_trans (range M) Q\n  sound (M t Q)\n  sound (Sup_trans (range M) Q)\n\ngoal (1 subgoal):\n 1. wp body (M t Q) \\<tturnstile> wp body (Sup_trans (range M) Q)", "using healthy_monoD[OF hb]"], ["proof (prove)\nusing this:\n  M t Q \\<tturnstile> Sup_trans (range M) Q\n  sound (M t Q)\n  sound (Sup_trans (range M) Q)\n  mono_trans (wp body)\n\ngoal (1 subgoal):\n 1. wp body (M t Q) \\<tturnstile> wp body (Sup_trans (range M) Q)", "by(auto)"], ["proof (state)\nthis:\n  wp body (M t Q) \\<tturnstile> wp body (Sup_trans (range M) Q)\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "hence \"\\<And>s. wp body (M t Q) s \\<le> wp body (Sup_trans (range M) Q) s\""], ["proof (prove)\nusing this:\n  wp body (M t Q) \\<tturnstile> wp body (Sup_trans (range M) Q)\n\ngoal (1 subgoal):\n 1. \\<And>s. wp body (M t Q) s \\<le> wp body (Sup_trans (range M) Q) s", "by(rule le_funD)"], ["proof (state)\nthis:\n  wp body (M t Q) ?s \\<le> wp body (Sup_trans (range M) Q) ?s\n\ngoal (5 subgoals):\n 1. \\<And>P t Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> wp (body ;;\n                             Embed\n                              (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                          Pa \\<tturnstile> wp\n      (body ;;\n       Embed\n        (Sup_trans\n          (range\n            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n      Pa\n 2. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (?b1 P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (?b1 P) (u Pa)\n 3. \\<And>P. sound P \\<Longrightarrow> nneg P\n 4. \\<And>P. sound P \\<Longrightarrow> bounded_by (?b1 P) P\n 5. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (?b1 P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "thus \"?F (M t) Q \\<tturnstile> ?F (Sup_trans (range M)) Q\""], ["proof (prove)\nusing this:\n  wp body (M t Q) ?s \\<le> wp body (Sup_trans (range M) Q) ?s\n\ngoal (1 subgoal):\n 1. wp (body ;;\n        Embed\n         (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n     Q \\<tturnstile> wp (body ;;\n                         Embed\n                          (Sup_trans\n                            (range\n                              M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                      Q", "by(intro le_funI, simp add:wp_eval mult_left_mono)"], ["proof (state)\nthis:\n  wp (body ;;\n      Embed\n       (M t) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n   Q \\<tturnstile> wp (body ;;\n                       Embed\n                        (Sup_trans\n                          (range\n                            M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                    Q\n\ngoal (4 subgoals):\n 1. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (bound_of P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (bound_of P) (u Pa)\n 2. \\<And>P. sound P \\<Longrightarrow> nneg P\n 3. \\<And>P. sound P \\<Longrightarrow> bounded_by (bound_of P) P\n 4. \\<And>P Pa.\n       \\<lbrakk>sound P; nneg Pa; bounded_by (bound_of P) Pa\\<rbrakk>\n       \\<Longrightarrow> nneg\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n                            Pa)", "show \"nneg (wp (body ;; Embed (Sup_trans (range M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip) Q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. nneg\n     (wp (body ;;\n          Embed\n           (Sup_trans\n             (range\n               M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n       Q)", "proof(rule nnegI, simp add:wp_eval)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n               wp body (Sup_trans (range M) Q) x +\n               (1 - \\<guillemotleft> G \\<guillemotright> x) * Q x", "fix s::'s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n               wp body (Sup_trans (range M) Q) x +\n               (1 - \\<guillemotleft> G \\<guillemotright> x) * Q x", "from fSup sQ"], ["proof (chain)\npicking this:\n  feasible (Sup_trans (range M))\n  sound Q", "have \"sound (Sup_trans (range M) Q)\""], ["proof (prove)\nusing this:\n  feasible (Sup_trans (range M))\n  sound Q\n\ngoal (1 subgoal):\n 1. sound (Sup_trans (range M) Q)", "by(auto)"], ["proof (state)\nthis:\n  sound (Sup_trans (range M) Q)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n               wp body (Sup_trans (range M) Q) x +\n               (1 - \\<guillemotleft> G \\<guillemotright> x) * Q x", "with hb"], ["proof (chain)\npicking this:\n  healthy (wp body)\n  sound (Sup_trans (range M) Q)", "have \"sound (wp body (Sup_trans (range M) Q))\""], ["proof (prove)\nusing this:\n  healthy (wp body)\n  sound (Sup_trans (range M) Q)\n\ngoal (1 subgoal):\n 1. sound (wp body (Sup_trans (range M) Q))", "by(auto)"], ["proof (state)\nthis:\n  sound (wp body (Sup_trans (range M) Q))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n               wp body (Sup_trans (range M) Q) x +\n               (1 - \\<guillemotleft> G \\<guillemotright> x) * Q x", "hence \"0 \\<le> wp body (Sup_trans (range M) Q) s\""], ["proof (prove)\nusing this:\n  sound (wp body (Sup_trans (range M) Q))\n\ngoal (1 subgoal):\n 1. 0 \\<le> wp body (Sup_trans (range M) Q) s", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> wp body (Sup_trans (range M) Q) s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n               wp body (Sup_trans (range M) Q) x +\n               (1 - \\<guillemotleft> G \\<guillemotright> x) * Q x", "moreover"], ["proof (state)\nthis:\n  0 \\<le> wp body (Sup_trans (range M) Q) s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n               wp body (Sup_trans (range M) Q) x +\n               (1 - \\<guillemotleft> G \\<guillemotright> x) * Q x", "from sQ"], ["proof (chain)\npicking this:\n  sound Q", "have \"0 \\<le> Q s\""], ["proof (prove)\nusing this:\n  sound Q\n\ngoal (1 subgoal):\n 1. 0 \\<le> Q s", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> Q s\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n               wp body (Sup_trans (range M) Q) x +\n               (1 - \\<guillemotleft> G \\<guillemotright> x) * Q x", "ultimately"], ["proof (chain)\npicking this:\n  0 \\<le> wp body (Sup_trans (range M) Q) s\n  0 \\<le> Q s", "show \"0 \\<le> \\<guillemotleft>G\\<guillemotright> s * wp body (Sup_trans (range M) Q) s + (1 - \\<guillemotleft>G\\<guillemotright> s) * Q s\""], ["proof (prove)\nusing this:\n  0 \\<le> wp body (Sup_trans (range M) Q) s\n  0 \\<le> Q s\n\ngoal (1 subgoal):\n 1. 0 \\<le> \\<guillemotleft> G \\<guillemotright> s *\n            wp body (Sup_trans (range M) Q) s +\n            (1 - \\<guillemotleft> G \\<guillemotright> s) * Q s", "by(auto intro:add_nonneg_nonneg mult_nonneg_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> \\<guillemotleft> G \\<guillemotright> s *\n          wp body (Sup_trans (range M) Q) s +\n          (1 - \\<guillemotleft> G \\<guillemotright> s) * Q s\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  nneg\n   (wp (body ;;\n        Embed\n         (Sup_trans\n           (range\n             M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)\n     Q)\n\ngoal (3 subgoals):\n 1. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (bound_of P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (bound_of P) (u Pa)\n 2. \\<And>P. sound P \\<Longrightarrow> nneg P\n 3. \\<And>P. sound P \\<Longrightarrow> bounded_by (bound_of P) P", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (bound_of P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (bound_of P) (u Pa)\n 2. \\<And>P. sound P \\<Longrightarrow> nneg P\n 3. \\<And>P. sound P \\<Longrightarrow> bounded_by (bound_of P) P", "fix P::\"'s expect\""], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (bound_of P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (bound_of P) (u Pa)\n 2. \\<And>P. sound P \\<Longrightarrow> nneg P\n 3. \\<And>P. sound P \\<Longrightarrow> bounded_by (bound_of P) P", "assume sP: \"sound P\""], ["proof (state)\nthis:\n  sound P\n\ngoal (3 subgoals):\n 1. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (bound_of P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (bound_of P) (u Pa)\n 2. \\<And>P. sound P \\<Longrightarrow> nneg P\n 3. \\<And>P. sound P \\<Longrightarrow> bounded_by (bound_of P) P", "thus \"nneg P\" \"bounded_by (bound_of P) P\""], ["proof (prove)\nusing this:\n  sound P\n\ngoal (1 subgoal):\n 1. nneg P &&& bounded_by (bound_of P) P", "by(auto)"], ["proof (state)\nthis:\n  nneg P\n  bounded_by (bound_of P) P\n\ngoal (1 subgoal):\n 1. \\<And>P.\n       sound P \\<Longrightarrow>\n       \\<forall>u\\<in>range\n                       ((\\<lambda>x.\n                            wp (body ;;\n                                Embed\n                                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                        M).\n          \\<forall>Pa.\n             nneg Pa \\<and> bounded_by (bound_of P) Pa \\<longrightarrow>\n             nneg (u Pa) \\<and> bounded_by (bound_of P) (u Pa)", "show \"\\<forall>u\\<in>range ((\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ> M).\n            \\<forall>R. nneg R \\<and> bounded_by (bound_of P) R \\<longrightarrow>\n                nneg (u R) \\<and> bounded_by (bound_of P) (u R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>u\\<in>range\n                    ((\\<lambda>x.\n                         wp (body ;;\n                             Embed\n                              x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                     M).\n       \\<forall>R.\n          nneg R \\<and> bounded_by (bound_of P) R \\<longrightarrow>\n          nneg (u R) \\<and> bounded_by (bound_of P) (u R)", "proof(clarsimp, intro conjI nnegI bounded_byI, simp_all add:wp_eval)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "fix u::nat and R::\"'s expect\" and s::'s"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "assume nR: \"nneg R\" and bR: \"bounded_by (bound_of P) R\""], ["proof (state)\nthis:\n  nneg R\n  bounded_by (bound_of P) R\n\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "hence sR: \"sound R\""], ["proof (prove)\nusing this:\n  nneg R\n  bounded_by (bound_of P) R\n\ngoal (1 subgoal):\n 1. sound R", "by(auto)"], ["proof (state)\nthis:\n  sound R\n\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "with fM"], ["proof (chain)\npicking this:\n  feasible (M ?i)\n  sound R", "have sMuR: \"sound (M u R)\""], ["proof (prove)\nusing this:\n  feasible (M ?i)\n  sound R\n\ngoal (1 subgoal):\n 1. sound (M u R)", "by(auto)"], ["proof (state)\nthis:\n  sound (M u R)\n\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "with hb"], ["proof (chain)\npicking this:\n  healthy (wp body)\n  sound (M u R)", "have \"sound (wp body (M u R))\""], ["proof (prove)\nusing this:\n  healthy (wp body)\n  sound (M u R)\n\ngoal (1 subgoal):\n 1. sound (wp body (M u R))", "by(auto)"], ["proof (state)\nthis:\n  sound (wp body (M u R))\n\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "hence \"0 \\<le> wp body (M u R) s\""], ["proof (prove)\nusing this:\n  sound (wp body (M u R))\n\ngoal (1 subgoal):\n 1. 0 \\<le> wp body (M u R) s", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> wp body (M u R) s\n\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "moreover"], ["proof (state)\nthis:\n  0 \\<le> wp body (M u R) s\n\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "from nR"], ["proof (chain)\npicking this:\n  nneg R", "have \"0 \\<le> R s\""], ["proof (prove)\nusing this:\n  nneg R\n\ngoal (1 subgoal):\n 1. 0 \\<le> R s", "by(auto)"], ["proof (state)\nthis:\n  0 \\<le> R s\n\ngoal (2 subgoals):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> \\<guillemotleft> G \\<guillemotright> x *\n                                 wp body (M u R) x +\n                                 (1 -\n                                  \\<guillemotleft> G \\<guillemotright> x) *\n                                 R x\n 2. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "ultimately"], ["proof (chain)\npicking this:\n  0 \\<le> wp body (M u R) s\n  0 \\<le> R s", "show \"0 \\<le> \\<guillemotleft>G\\<guillemotright> s * wp body (M u R) s + (1 - \\<guillemotleft>G\\<guillemotright> s) * R s\""], ["proof (prove)\nusing this:\n  0 \\<le> wp body (M u R) s\n  0 \\<le> R s\n\ngoal (1 subgoal):\n 1. 0 \\<le> \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n            (1 - \\<guillemotleft> G \\<guillemotright> s) * R s", "by(auto intro:add_nonneg_nonneg mult_nonneg_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n          (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "from sR bR fM"], ["proof (chain)\npicking this:\n  sound R\n  bounded_by (bound_of P) R\n  feasible (M ?i)", "have \"bounded_by (bound_of P) (M u R)\""], ["proof (prove)\nusing this:\n  sound R\n  bounded_by (bound_of P) R\n  feasible (M ?i)\n\ngoal (1 subgoal):\n 1. bounded_by (bound_of P) (M u R)", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) (M u R)\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "with sMuR hb"], ["proof (chain)\npicking this:\n  sound (M u R)\n  healthy (wp body)\n  bounded_by (bound_of P) (M u R)", "have \"bounded_by (bound_of P) (wp body (M u R))\""], ["proof (prove)\nusing this:\n  sound (M u R)\n  healthy (wp body)\n  bounded_by (bound_of P) (M u R)\n\ngoal (1 subgoal):\n 1. bounded_by (bound_of P) (wp body (M u R))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) (wp body (M u R))\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "hence \"wp body (M u R) s \\<le> bound_of P\""], ["proof (prove)\nusing this:\n  bounded_by (bound_of P) (wp body (M u R))\n\ngoal (1 subgoal):\n 1. wp body (M u R) s \\<le> bound_of P", "by(auto)"], ["proof (state)\nthis:\n  wp body (M u R) s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "moreover"], ["proof (state)\nthis:\n  wp body (M u R) s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "from bR"], ["proof (chain)\npicking this:\n  bounded_by (bound_of P) R", "have \"R s \\<le> bound_of P\""], ["proof (prove)\nusing this:\n  bounded_by (bound_of P) R\n\ngoal (1 subgoal):\n 1. R s \\<le> bound_of P", "by(auto)"], ["proof (state)\nthis:\n  R s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "ultimately"], ["proof (chain)\npicking this:\n  wp body (M u R) s \\<le> bound_of P\n  R s \\<le> bound_of P", "have \"\\<guillemotleft>G\\<guillemotright> s * wp body (M u R) s + (1 - \\<guillemotleft>G\\<guillemotright> s) * R s \\<le>\n                       \\<guillemotleft>G\\<guillemotright> s * bound_of P + (1 - \\<guillemotleft>G\\<guillemotright> s) * bound_of P\""], ["proof (prove)\nusing this:\n  wp body (M u R) s \\<le> bound_of P\n  R s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n    \\<le> \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n          (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P", "by(auto intro:add_mono mult_left_mono)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n  \\<le> \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n        (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "also"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n  \\<le> \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n        (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "have \"... = bound_of P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P =\n    bound_of P", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P =\n  bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>u R x.\n       \\<lbrakk>nneg R; bounded_by (bound_of P) R\\<rbrakk>\n       \\<Longrightarrow> \\<guillemotleft> G \\<guillemotright> x *\n                         wp body (M u R) x +\n                         (1 - \\<guillemotleft> G \\<guillemotright> x) * R x\n                         \\<le> bound_of P", "finally"], ["proof (chain)\npicking this:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n  \\<le> bound_of P", "show \"\\<guillemotleft>G\\<guillemotright> s * wp body (M u R) s + (1 - \\<guillemotleft>G\\<guillemotright> s) * R s \\<le> bound_of P\""], ["proof (prove)\nusing this:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n  \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n    \\<le> bound_of P", "."], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M u R) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * R s\n  \\<le> bound_of P\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>u\\<in>range\n                  ((\\<lambda>x.\n                       wp (body ;;\n                           Embed\n                            x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                   M).\n     \\<forall>R.\n        nneg R \\<and> bounded_by (bound_of P) R \\<longrightarrow>\n        nneg (u R) \\<and> bounded_by (bound_of P) (u R)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  le_trans\n   (Sup_trans\n     (range\n       ((\\<lambda>x.\n            wp (body ;;\n                Embed\n                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n        M)))\n   (wp (body ;;\n        Embed\n         (Sup_trans\n           (range\n             M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\n\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>\\<And>i. le_trans (M i) (M (Suc i));\n        \\<And>i. feasible (M i)\\<rbrakk>\n       \\<Longrightarrow> le_trans\n                          (wp (body ;;\n                               Embed\n                                (Sup_trans\n                                  (range\n                                    M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\n                          (Sup_trans\n                            (range\n                              ((\\<lambda>x.\n                                   wp (body ;;\n Embed\n  x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                               M)))", "show \"le_trans (?F (Sup_trans (range M))) (Sup_trans (range (?F o M)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. le_trans\n     (wp (body ;;\n          Embed\n           (Sup_trans\n             (range\n               M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\n     (Sup_trans\n       (range\n         ((\\<lambda>x.\n              wp (body ;;\n                  Embed\n                   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n          M)))", "proof(rule le_transI, rule le_funI, simp add: wp_eval cong del: image_cong_simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "fix P::\"'s expect\" and s::'s"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "assume sP: \"sound P\""], ["proof (state)\nthis:\n  sound P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "have \"{t P |t. t \\<in> range M} = range (\\<lambda>i. M i P)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {t P |t. t \\<in> range M} = range (\\<lambda>i. M i P)", "by(blast)"], ["proof (state)\nthis:\n  {t P |t. t \\<in> range M} = range (\\<lambda>i. M i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "hence \"wp body (Sup_trans (range M) P) s = wp body (Sup_exp (range (\\<lambda>i. M i P))) s\""], ["proof (prove)\nusing this:\n  {t P |t. t \\<in> range M} = range (\\<lambda>i. M i P)\n\ngoal (1 subgoal):\n 1. wp body (Sup_trans (range M) P) s =\n    wp body (Sup_exp (range (\\<lambda>i. M i P))) s", "by(simp add:Sup_trans_def)"], ["proof (state)\nthis:\n  wp body (Sup_trans (range M) P) s =\n  wp body (Sup_exp (range (\\<lambda>i. M i P))) s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "also"], ["proof (state)\nthis:\n  wp body (Sup_trans (range M) P) s =\n  wp body (Sup_exp (range (\\<lambda>i. M i P))) s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "{"], ["proof (state)\nthis:\n  wp body (Sup_trans (range M) P) s =\n  wp body (Sup_exp (range (\\<lambda>i. M i P))) s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "from sP fM"], ["proof (chain)\npicking this:\n  sound P\n  feasible (M ?i)", "have \"\\<And>i. sound (M i P)\""], ["proof (prove)\nusing this:\n  sound P\n  feasible (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i. sound (M i P)", "by(auto)"], ["proof (state)\nthis:\n  sound (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "moreover"], ["proof (state)\nthis:\n  sound (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "from sP chain"], ["proof (chain)\npicking this:\n  sound P\n  le_trans (M ?i) (M (Suc ?i))", "have \"\\<And>i. M i P \\<tturnstile> M (Suc i) P\""], ["proof (prove)\nusing this:\n  sound P\n  le_trans (M ?i) (M (Suc ?i))\n\ngoal (1 subgoal):\n 1. \\<And>i. M i P \\<tturnstile> M (Suc i) P", "by(auto)"], ["proof (state)\nthis:\n  M ?i P \\<tturnstile> M (Suc ?i) P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "moreover"], ["proof (state)\nthis:\n  M ?i P \\<tturnstile> M (Suc ?i) P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "{"], ["proof (state)\nthis:\n  M ?i P \\<tturnstile> M (Suc ?i) P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "from sP"], ["proof (chain)\npicking this:\n  sound P", "have \"bounded_by (bound_of P) P\""], ["proof (prove)\nusing this:\n  sound P\n\ngoal (1 subgoal):\n 1. bounded_by (bound_of P) P", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "with sP fM"], ["proof (chain)\npicking this:\n  sound P\n  feasible (M ?i)\n  bounded_by (bound_of P) P", "have \"\\<And>i. bounded_by (bound_of P) (M i P)\""], ["proof (prove)\nusing this:\n  sound P\n  feasible (M ?i)\n  bounded_by (bound_of P) P\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by (bound_of P) (M i P)", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "}"], ["proof (state)\nthis:\n  bounded_by (bound_of P) (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "ultimately"], ["proof (chain)\npicking this:\n  sound (M ?i P)\n  M ?i P \\<tturnstile> M (Suc ?i) P\n  bounded_by (bound_of P) (M ?i P)", "have \"wp body (Sup_exp (range (\\<lambda>i. M i P))) s =\n                       Sup_exp (range (\\<lambda>i. wp body (M i P))) s\""], ["proof (prove)\nusing this:\n  sound (M ?i P)\n  M ?i P \\<tturnstile> M (Suc ?i) P\n  bounded_by (bound_of P) (M ?i P)\n\ngoal (1 subgoal):\n 1. wp body (Sup_exp (range (\\<lambda>i. M i P))) s =\n    Sup_exp (range (\\<lambda>i. wp body (M i P))) s", "by(subst bd_ctsD[OF cb], auto simp:o_def)"], ["proof (state)\nthis:\n  wp body (Sup_exp (range (\\<lambda>i. M i P))) s =\n  Sup_exp (range (\\<lambda>i. wp body (M i P))) s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "}"], ["proof (state)\nthis:\n  wp body (Sup_exp (range (\\<lambda>i. M i P))) s =\n  Sup_exp (range (\\<lambda>i. wp body (M i P))) s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "also"], ["proof (state)\nthis:\n  wp body (Sup_exp (range (\\<lambda>i. M i P))) s =\n  Sup_exp (range (\\<lambda>i. wp body (M i P))) s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "have \"Sup_exp (range (\\<lambda>i. wp body (M i P))) s =\n               Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sup_exp (range (\\<lambda>i. wp body (M i P))) s =\n    Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}", "by(simp add:Sup_exp_def)"], ["proof (state)\nthis:\n  Sup_exp (range (\\<lambda>i. wp body (M i P))) s =\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "finally"], ["proof (chain)\npicking this:\n  wp body (Sup_trans (range M) P) s =\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}", "have \"\\<guillemotleft>G\\<guillemotright> s * wp body (Sup_trans (range M) P) s + (1 - \\<guillemotleft>G\\<guillemotright> s) * P s =\n                  \\<guillemotleft>G\\<guillemotright> s * Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} + (1 - \\<guillemotleft>G\\<guillemotright> s) * P s\""], ["proof (prove)\nusing this:\n  wp body (Sup_trans (range M) P) s =\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s *\n    wp body (Sup_trans (range M) P) s +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n    \\<guillemotleft> G \\<guillemotright> s *\n    Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * P s", "by(simp)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  wp body (Sup_trans (range M) P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "also"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  wp body (Sup_trans (range M) P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "{"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  wp body (Sup_trans (range M) P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "from sP fM"], ["proof (chain)\npicking this:\n  sound P\n  feasible (M ?i)", "have \"\\<And>i. sound (M i P)\""], ["proof (prove)\nusing this:\n  sound P\n  feasible (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i. sound (M i P)", "by(auto)"], ["proof (state)\nthis:\n  sound (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "moreover"], ["proof (state)\nthis:\n  sound (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "from sP fM"], ["proof (chain)\npicking this:\n  sound P\n  feasible (M ?i)", "have \"\\<And>i. bounded_by (bound_of P) (M i P)\""], ["proof (prove)\nusing this:\n  sound P\n  feasible (M ?i)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by (bound_of P) (M i P)", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "ultimately"], ["proof (chain)\npicking this:\n  sound (M ?i P)\n  bounded_by (bound_of P) (M ?i P)", "have \"\\<And>i. bounded_by (bound_of P) (wp body (M i P))\""], ["proof (prove)\nusing this:\n  sound (M ?i P)\n  bounded_by (bound_of P) (M ?i P)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by (bound_of P) (wp body (M i P))", "using hb"], ["proof (prove)\nusing this:\n  sound (M ?i P)\n  bounded_by (bound_of P) (M ?i P)\n  healthy (wp body)\n\ngoal (1 subgoal):\n 1. \\<And>i. bounded_by (bound_of P) (wp body (M i P))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) (wp body (M ?i P))\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "hence bound: \"\\<And>i. wp body (M i P) s \\<le> bound_of P\""], ["proof (prove)\nusing this:\n  bounded_by (bound_of P) (wp body (M ?i P))\n\ngoal (1 subgoal):\n 1. \\<And>i. wp body (M i P) s \\<le> bound_of P", "by(auto)"], ["proof (state)\nthis:\n  wp body (M ?i P) s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "moreover"], ["proof (state)\nthis:\n  wp body (M ?i P) s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "have \"{\\<guillemotleft> G \\<guillemotright> s * x |x. x \\<in> {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n            {\\<guillemotleft> G \\<guillemotright> s * f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {\\<guillemotleft> G \\<guillemotright> s * x |x.\n     x \\<in> {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n    {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n     f \\<in> range (\\<lambda>i. wp body (M i P))}", "by(blast)"], ["proof (state)\nthis:\n  {\\<guillemotleft> G \\<guillemotright> s * x |x.\n   x \\<in> {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n  {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n   f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "ultimately"], ["proof (chain)\npicking this:\n  wp body (M ?i P) s \\<le> bound_of P\n  {\\<guillemotleft> G \\<guillemotright> s * x |x.\n   x \\<in> {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n  {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n   f \\<in> range (\\<lambda>i. wp body (M i P))}", "have \"\\<guillemotleft>G\\<guillemotright> s * Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} =\n            Sup {\\<guillemotleft>G\\<guillemotright> s * f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\""], ["proof (prove)\nusing this:\n  wp body (M ?i P) s \\<le> bound_of P\n  {\\<guillemotleft> G \\<guillemotright> s * x |x.\n   x \\<in> {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n  {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n   f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s *\n    Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} =\n    Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n         f \\<in> range (\\<lambda>i. wp body (M i P))}", "by(subst cSup_mult, auto)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "moreover"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "{"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "have \"{x + (1-\\<guillemotleft>G\\<guillemotright> s) * P s |x.\n               x \\<in> {\\<guillemotleft>G\\<guillemotright> s * f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n              {\\<guillemotleft>G\\<guillemotright> s * f s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x + (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |x.\n     x \\<in> {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n              f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n    {\\<guillemotleft> G \\<guillemotright> s * f s +\n     (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n     f. f \\<in> range (\\<lambda>i. wp body (M i P))}", "by(blast)"], ["proof (state)\nthis:\n  {x + (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |x.\n   x \\<in> {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n            f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n  {\\<guillemotleft> G \\<guillemotright> s * f s +\n   (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n   f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "moreover"], ["proof (state)\nthis:\n  {x + (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |x.\n   x \\<in> {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n            f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n  {\\<guillemotleft> G \\<guillemotright> s * f s +\n   (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n   f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "from bound sP"], ["proof (chain)\npicking this:\n  wp body (M ?i P) s \\<le> bound_of P\n  sound P", "have \"\\<And>i. \\<guillemotleft>G\\<guillemotright> s * wp body (M i P) s \\<le> bound_of P\""], ["proof (prove)\nusing this:\n  wp body (M ?i P) s \\<le> bound_of P\n  sound P\n\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s\n       \\<le> bound_of P", "by(cases \"G s\", auto)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M ?i P) s\n  \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "ultimately"], ["proof (chain)\npicking this:\n  {x + (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |x.\n   x \\<in> {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n            f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n  {\\<guillemotleft> G \\<guillemotright> s * f s +\n   (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n   f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M ?i P) s\n  \\<le> bound_of P", "have \"Sup {\\<guillemotleft>G\\<guillemotright> s * f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} + (1-\\<guillemotleft>G\\<guillemotright> s) * P s =\n              Sup {\\<guillemotleft>G\\<guillemotright> s * f s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\""], ["proof (prove)\nusing this:\n  {x + (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |x.\n   x \\<in> {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n            f \\<in> range (\\<lambda>i. wp body (M i P))}} =\n  {\\<guillemotleft> G \\<guillemotright> s * f s +\n   (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n   f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M ?i P) s\n  \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n         f \\<in> range (\\<lambda>i. wp body (M i P))} +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n    Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n         (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n         f. f \\<in> range (\\<lambda>i. wp body (M i P))}", "by(subst cSup_add, auto)"], ["proof (state)\nthis:\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "}"], ["proof (state)\nthis:\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "ultimately"], ["proof (chain)\npicking this:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))}\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}", "have \"\\<guillemotleft>G\\<guillemotright> s * Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} + (1-\\<guillemotleft>G\\<guillemotright> s) * P s =\n            Sup {\\<guillemotleft>G\\<guillemotright> s * f s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s |f. f \\<in> range (\\<lambda>i. wp body (M i P))}\""], ["proof (prove)\nusing this:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))}\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s |f.\n       f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s *\n    Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n    Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n         (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n         f. f \\<in> range (\\<lambda>i. wp body (M i P))}", "by(simp)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "}"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "also"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "{"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  Sup {f s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "have \"\\<And>i. \\<guillemotleft>G\\<guillemotright> s * wp body (M i P) s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s =\n                 ((\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ> M) i P s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n       ((\\<lambda>x.\n            wp (body ;;\n                Embed\n                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n        M)\n        i P s", "by(simp add:wp_eval)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M ?i P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  ((\\<lambda>x.\n       wp (body ;;\n           Embed\n            x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n   M)\n   ?i P s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "also"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M ?i P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s =\n  ((\\<lambda>x.\n       wp (body ;;\n           Embed\n            x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n   M)\n   ?i P s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "have \"\\<And>i. ... i \\<le>\n                 Sup {f s |f. f \\<in> {t P |t. t \\<in> range ((\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ> M)}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       ((\\<lambda>x.\n            wp (body ;;\n                Embed\n                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n        M)\n        i P s\n       \\<le> Sup {f s |f.\n                  f \\<in> {t P |t.\n                           t \\<in> range\n                                    ((\\<lambda>x.\n   wp (body ;;\n       Embed\n        x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                     M)}}", "proof(intro cSup_upper bdd_aboveI, blast, clarsimp simp:wp_eval)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "from sP"], ["proof (chain)\npicking this:\n  sound P", "have bP: \"bounded_by (bound_of P) P\""], ["proof (prove)\nusing this:\n  sound P\n\ngoal (1 subgoal):\n 1. bounded_by (bound_of P) P", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) P\n\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "with sP fM"], ["proof (chain)\npicking this:\n  sound P\n  feasible (M ?i)\n  bounded_by (bound_of P) P", "have \"sound (M i P)\" \"bounded_by (bound_of P) (M i P)\""], ["proof (prove)\nusing this:\n  sound P\n  feasible (M ?i)\n  bounded_by (bound_of P) P\n\ngoal (1 subgoal):\n 1. sound (M i P) &&& bounded_by (bound_of P) (M i P)", "by(auto)"], ["proof (state)\nthis:\n  sound (M i P)\n  bounded_by (bound_of P) (M i P)\n\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "with hb"], ["proof (chain)\npicking this:\n  healthy (wp body)\n  sound (M i P)\n  bounded_by (bound_of P) (M i P)", "have \"bounded_by (bound_of P) (wp body (M i P))\""], ["proof (prove)\nusing this:\n  healthy (wp body)\n  sound (M i P)\n  bounded_by (bound_of P) (M i P)\n\ngoal (1 subgoal):\n 1. bounded_by (bound_of P) (wp body (M i P))", "by(auto)"], ["proof (state)\nthis:\n  bounded_by (bound_of P) (wp body (M i P))\n\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "with bP"], ["proof (chain)\npicking this:\n  bounded_by (bound_of P) P\n  bounded_by (bound_of P) (wp body (M i P))", "have \"wp body (M i P) s \\<le> bound_of P\" \"P s \\<le> bound_of P\""], ["proof (prove)\nusing this:\n  bounded_by (bound_of P) P\n  bounded_by (bound_of P) (wp body (M i P))\n\ngoal (1 subgoal):\n 1. wp body (M i P) s \\<le> bound_of P &&& P s \\<le> bound_of P", "by(auto)"], ["proof (state)\nthis:\n  wp body (M i P) s \\<le> bound_of P\n  P s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "hence \"\\<guillemotleft>G\\<guillemotright> s * wp body (M i P) s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s \\<le>\n               \\<guillemotleft>G\\<guillemotright> s * (bound_of P) + (1-\\<guillemotleft>G\\<guillemotright> s) * (bound_of P)\""], ["proof (prove)\nusing this:\n  wp body (M i P) s \\<le> bound_of P\n  P s \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n    \\<le> \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n          (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P", "by(auto intro:add_mono mult_left_mono)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n        (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "also"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n        (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "have \"... = bound_of P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P =\n    bound_of P", "by(simp add:algebra_simps)"], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * bound_of P +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * bound_of P =\n  bound_of P\n\ngoal (1 subgoal):\n 1. \\<And>i xa.\n       \\<guillemotleft> G \\<guillemotright> s * wp body (M xa P) s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n       \\<le> ?M1 i", "finally"], ["proof (chain)\npicking this:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> bound_of P", "show \"\\<guillemotleft>G\\<guillemotright> s * wp body (M i P) s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s \\<le> bound_of P\""], ["proof (prove)\nusing this:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> bound_of P\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n    \\<le> bound_of P", "."], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M i P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> bound_of P\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ((\\<lambda>x.\n       wp (body ;;\n           Embed\n            x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n   M)\n   ?i P s\n  \\<le> Sup {f s |f.\n             f \\<in> {t P |t.\n                      t \\<in> range\n                               ((\\<lambda>x.\n                                    wp (body ;;\n  Embed\n   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                M)}}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "finally"], ["proof (chain)\npicking this:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M ?i1 P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> Sup {f s |f.\n             f \\<in> {t P |t.\n                      t \\<in> range\n                               ((\\<lambda>x.\n                                    wp (body ;;\n  Embed\n   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                M)}}", "have \"Sup {\\<guillemotleft>G\\<guillemotright> s * f s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s |f. f \\<in> range (\\<lambda>i. wp body (M i P))} \\<le>\n            Sup {f s |f. f \\<in> {t P |t. t \\<in> range ((\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ> M)}}\""], ["proof (prove)\nusing this:\n  \\<guillemotleft> G \\<guillemotright> s * wp body (M ?i1 P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> Sup {f s |f.\n             f \\<in> {t P |t.\n                      t \\<in> range\n                               ((\\<lambda>x.\n                                    wp (body ;;\n  Embed\n   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                M)}}\n\ngoal (1 subgoal):\n 1. Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n         (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n         f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n    \\<le> Sup {f s |f.\n               f \\<in> {t P |t.\n                        t \\<in> range\n                                 ((\\<lambda>x.\nwp (body ;;\n    Embed\n     x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                  M)}}", "by(blast intro:cSup_least)"], ["proof (state)\nthis:\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n  \\<le> Sup {f s |f.\n             f \\<in> {t P |t.\n                      t \\<in> range\n                               ((\\<lambda>x.\n                                    wp (body ;;\n  Embed\n   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                M)}}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "}"], ["proof (state)\nthis:\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n  \\<le> Sup {f s |f.\n             f \\<in> {t P |t.\n                      t \\<in> range\n                               ((\\<lambda>x.\n                                    wp (body ;;\n  Embed\n   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                M)}}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "also"], ["proof (state)\nthis:\n  Sup {\\<guillemotleft> G \\<guillemotright> s * f s +\n       (1 - \\<guillemotleft> G \\<guillemotright> s) * P s |\n       f. f \\<in> range (\\<lambda>i. wp body (M i P))}\n  \\<le> Sup {f s |f.\n             f \\<in> {t P |t.\n                      t \\<in> range\n                               ((\\<lambda>x.\n                                    wp (body ;;\n  Embed\n   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                                M)}}\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "have \"Sup {f s |f. f \\<in> {t P |t. t \\<in> range ((\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ> M)}} =\n               Sup_trans (range ((\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ> M)) P s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Sup {f s |f.\n         f \\<in> {t P |t.\n                  t \\<in> range\n                           ((\\<lambda>x.\n                                wp (body ;;\n                                    Embed\n                                     x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                            M)}} =\n    Sup_trans\n     (range\n       ((\\<lambda>x.\n            wp (body ;;\n                Embed\n                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n        M))\n     P s", "by(simp add:Sup_trans_def Sup_exp_def)"], ["proof (state)\nthis:\n  Sup {f s |f.\n       f \\<in> {t P |t.\n                t \\<in> range\n                         ((\\<lambda>x.\n                              wp (body ;;\n                                  Embed\n                                   x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                          M)}} =\n  Sup_trans\n   (range\n     ((\\<lambda>x.\n          wp (body ;;\n              Embed\n               x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n      M))\n   P s\n\ngoal (1 subgoal):\n 1. \\<And>P x.\n       sound P \\<Longrightarrow>\n       \\<guillemotleft> G \\<guillemotright> x *\n       wp body (Sup_trans (range M) P) x +\n       (1 - \\<guillemotleft> G \\<guillemotright> x) * P x\n       \\<le> Sup_trans\n              (range\n                ((\\<lambda>x.\n                     wp (body ;;\n                         Embed\n                          x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n                 M))\n              P x", "finally"], ["proof (chain)\npicking this:\n  \\<guillemotleft> G \\<guillemotright> s *\n  wp body (Sup_trans (range M) P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> Sup_trans\n         (range\n           ((\\<lambda>x.\n                wp (body ;;\n                    Embed\n                     x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n            M))\n         P s", "show \"\\<guillemotleft>G\\<guillemotright> s * wp body (Sup_trans (range M) P) s + (1-\\<guillemotleft>G\\<guillemotright> s) * P s \\<le>\n                  Sup_trans (range ((\\<lambda>x. wp (body ;; Embed x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ> M)) P s\""], ["proof (prove)\nusing this:\n  \\<guillemotleft> G \\<guillemotright> s *\n  wp body (Sup_trans (range M) P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> Sup_trans\n         (range\n           ((\\<lambda>x.\n                wp (body ;;\n                    Embed\n                     x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n            M))\n         P s\n\ngoal (1 subgoal):\n 1. \\<guillemotleft> G \\<guillemotright> s *\n    wp body (Sup_trans (range M) P) s +\n    (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n    \\<le> Sup_trans\n           (range\n             ((\\<lambda>x.\n                  wp (body ;;\n                      Embed\n                       x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n              M))\n           P s", "."], ["proof (state)\nthis:\n  \\<guillemotleft> G \\<guillemotright> s *\n  wp body (Sup_trans (range M) P) s +\n  (1 - \\<guillemotleft> G \\<guillemotright> s) * P s\n  \\<le> Sup_trans\n         (range\n           ((\\<lambda>x.\n                wp (body ;;\n                    Embed\n                     x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n            M))\n         P s\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  le_trans\n   (wp (body ;;\n        Embed\n         (Sup_trans\n           (range\n             M)) \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip))\n   (Sup_trans\n     (range\n       ((\\<lambda>x.\n            wp (body ;;\n                Embed\n                 x \\<^bsub>\\<guillemotleft> G \\<guillemotright>\\<^esub>\\<oplus> Skip)) \\<circ>\n        M)))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}