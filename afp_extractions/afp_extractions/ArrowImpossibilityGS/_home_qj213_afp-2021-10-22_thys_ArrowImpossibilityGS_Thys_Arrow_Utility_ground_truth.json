{"file_name": "/home/qj213/afp-2021-10-22/thys/ArrowImpossibilityGS/Thys/Arrow_Utility.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/ArrowImpossibilityGS", "problem_names": ["lemma third_alt: \"a \\<noteq> b \\<Longrightarrow> \\<exists>c::alt. distinct[a,b,c]\"", "lemma alt2: \"\\<exists>b::alt. b \\<noteq> a\"", "lemma [simp]: \"r <= s \\<Longrightarrow> r < s+(1::real)\"", "lemma [simp]: \"r < s \\<Longrightarrow> r < s+(1::real)\"", "lemma [simp]: \"r <= s \\<Longrightarrow> \\<not> s+(1::real) < r\"", "lemma [simp]: \"(r < s-(1::real)) = (r+1 < s)\"", "lemma [simp]: \"(s-(1::real) < r) = (s < r+1)\"", "lemma less_if_bot[simp]: \"\\<lbrakk> b \\<cdot>< p; x \\<noteq> b \\<rbrakk> \\<Longrightarrow> p b < p x\"", "lemma [simp]: \"\\<lbrakk> p <\\<cdot> b; x \\<noteq> b \\<rbrakk> \\<Longrightarrow> p x < p b\"", "lemma [simp]: assumes top: \"p <\\<cdot> b\" shows \"\\<not> p b < p c\"", "lemma not_less_if_bot[simp]:\n  assumes bot: \"b \\<cdot>< p\" shows \"\\<not> p c < p b\"", "lemma top_impl_not_bot[simp]: \"p <\\<cdot> b \\<Longrightarrow> \\<not> b \\<cdot>< p\"", "lemma [simp]: \"extreme p b \\<Longrightarrow> (\\<not> p <\\<cdot> b) = (b \\<cdot>< p)\"", "lemma [simp]: \"extreme p b \\<Longrightarrow> (\\<not> b \\<cdot>< p) = (p <\\<cdot> b)\"", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> mktop p b a = p a\"", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> mkbot p b a = p a\"", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> p a < mktop p b b\"", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> mkbot p b b < p a\"", "lemma [simp]: \"mktop p b <\\<cdot> b\"", "lemma [simp]: \"\\<not> b \\<cdot>< mktop p b\"", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> \\<not> P p a < mkbot (P p) b b\"", "lemmas IIA' = IIA[THEN iffD1]", "lemma all_top[simp]: \"\\<forall>i. P i <\\<cdot> b \\<Longrightarrow> F P <\\<cdot> b\"", "lemma not_extreme:\n  assumes nex: \"\\<not> extreme p b\"\n  shows \"\\<exists>a c. distinct[a,b,c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\"", "lemma extremal:\n  assumes extremes: \"Extreme P b\" shows \"extreme (F P) b\"", "lemma pivotal_ind: assumes fin: \"finite D\"\n  shows \"\\<And>P. \\<lbrakk> D = {i. b \\<cdot>< P i}; Extreme P b; b \\<cdot>< F P \\<rbrakk>\n  \\<Longrightarrow> \\<exists>i. pivotal i b\" (is \"\\<And>P. ?D D P \\<Longrightarrow> ?E P \\<Longrightarrow> ?B P \\<Longrightarrow> _\")", "lemma pivotal_exists: \"\\<exists>i. pivotal i b\"", "lemma pivotal_xdictates: assumes pivo: \"pivotal i b\"\n  shows \"i dictates_except b\"", "lemma pivotal_is_dictator:\n  assumes pivo: \"pivotal i b\" and ab: \"a \\<noteq> b\" and d: \"j dictates a,b\"\n  shows \"i = j\"", "theorem dictator: \"\\<exists>i. dictator i\""], "translations": [["", "lemma third_alt: \"a \\<noteq> b \\<Longrightarrow> \\<exists>c::alt. distinct[a,b,c]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> \\<exists>c. distinct [a, b, c]", "using alt3"], ["proof (prove)\nusing this:\n  \\<exists>a b c. distinct [a, b, c]\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> \\<exists>c. distinct [a, b, c]", "by simp metis"], ["", "lemma alt2: \"\\<exists>b::alt. b \\<noteq> a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>b. b \\<noteq> a", "using alt3"], ["proof (prove)\nusing this:\n  \\<exists>a b c. distinct [a, b, c]\n\ngoal (1 subgoal):\n 1. \\<exists>b. b \\<noteq> a", "by simp metis"], ["", "type_synonym pref = \"alt \\<Rightarrow> real\""], ["", "type_synonym prof = \"indi \\<Rightarrow> pref\""], ["", "definition\n top :: \"pref \\<Rightarrow> alt \\<Rightarrow> bool\" (infixr \"<\\<cdot>\" 60) where\n\"p <\\<cdot> b  \\<equiv>  \\<forall>a. a \\<noteq> b \\<longrightarrow> p a < p b\""], ["", "definition\n bot :: \"alt \\<Rightarrow> pref \\<Rightarrow> bool\" (infixr \"\\<cdot><\" 60) where\n\"b \\<cdot>< p  \\<equiv>  \\<forall>a. a \\<noteq> b \\<longrightarrow> p b < p a\""], ["", "definition\n extreme :: \"pref \\<Rightarrow> alt \\<Rightarrow> bool\" where\n\"extreme p b  \\<equiv>  b \\<cdot>< p \\<or> p <\\<cdot> b\""], ["", "abbreviation\n\"Extreme P b == \\<forall>i. extreme (P i) b\""], ["", "lemma [simp]: \"r <= s \\<Longrightarrow> r < s+(1::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. r \\<le> s \\<Longrightarrow> r < s + 1", "by arith"], ["", "lemma [simp]: \"r < s \\<Longrightarrow> r < s+(1::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. r < s \\<Longrightarrow> r < s + 1", "by arith"], ["", "lemma [simp]: \"r <= s \\<Longrightarrow> \\<not> s+(1::real) < r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. r \\<le> s \\<Longrightarrow> \\<not> s + 1 < r", "by arith"], ["", "lemma [simp]: \"(r < s-(1::real)) = (r+1 < s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (r < s - 1) = (r + 1 < s)", "by arith"], ["", "lemma [simp]: \"(s-(1::real) < r) = (s < r+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (s - 1 < r) = (s < r + 1)", "by arith"], ["", "lemma less_if_bot[simp]: \"\\<lbrakk> b \\<cdot>< p; x \\<noteq> b \\<rbrakk> \\<Longrightarrow> p b < p x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b \\<cdot>< p; x \\<noteq> b\\<rbrakk> \\<Longrightarrow> p b < p x", "by(simp add:bot_def)"], ["", "lemma [simp]: \"\\<lbrakk> p <\\<cdot> b; x \\<noteq> b \\<rbrakk> \\<Longrightarrow> p x < p b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p <\\<cdot> b; x \\<noteq> b\\<rbrakk> \\<Longrightarrow> p x < p b", "by(simp add:top_def)"], ["", "lemma [simp]: assumes top: \"p <\\<cdot> b\" shows \"\\<not> p b < p c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> p b < p c", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<not> p b < p c\n 2. \\<not> ?P \\<Longrightarrow> \\<not> p b < p c", "assume \"b = c\""], ["proof (state)\nthis:\n  b = c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<not> p b < p c\n 2. \\<not> ?P \\<Longrightarrow> \\<not> p b < p c", "thus ?thesis"], ["proof (prove)\nusing this:\n  b = c\n\ngoal (1 subgoal):\n 1. \\<not> p b < p c", "by simp"], ["proof (state)\nthis:\n  \\<not> p b < p c\n\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p b < p c", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p b < p c", "assume \"b \\<noteq> c\""], ["proof (state)\nthis:\n  b \\<noteq> c\n\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p b < p c", "with top"], ["proof (chain)\npicking this:\n  p <\\<cdot> b\n  b \\<noteq> c", "have \"p c < p b\""], ["proof (prove)\nusing this:\n  p <\\<cdot> b\n  b \\<noteq> c\n\ngoal (1 subgoal):\n 1. p c < p b", "by (simp add:eq_sym_conv)"], ["proof (state)\nthis:\n  p c < p b\n\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p b < p c", "thus ?thesis"], ["proof (prove)\nusing this:\n  p c < p b\n\ngoal (1 subgoal):\n 1. \\<not> p b < p c", "by simp"], ["proof (state)\nthis:\n  \\<not> p b < p c\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma not_less_if_bot[simp]:\n  assumes bot: \"b \\<cdot>< p\" shows \"\\<not> p c < p b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> p c < p b", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<not> p c < p b\n 2. \\<not> ?P \\<Longrightarrow> \\<not> p c < p b", "assume \"b = c\""], ["proof (state)\nthis:\n  b = c\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<not> p c < p b\n 2. \\<not> ?P \\<Longrightarrow> \\<not> p c < p b", "thus ?thesis"], ["proof (prove)\nusing this:\n  b = c\n\ngoal (1 subgoal):\n 1. \\<not> p c < p b", "by simp"], ["proof (state)\nthis:\n  \\<not> p c < p b\n\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p c < p b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p c < p b", "assume \"b \\<noteq> c\""], ["proof (state)\nthis:\n  b \\<noteq> c\n\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p c < p b", "with bot"], ["proof (chain)\npicking this:\n  b \\<cdot>< p\n  b \\<noteq> c", "have \"p b < p c\""], ["proof (prove)\nusing this:\n  b \\<cdot>< p\n  b \\<noteq> c\n\ngoal (1 subgoal):\n 1. p b < p c", "by (simp add:eq_sym_conv)"], ["proof (state)\nthis:\n  p b < p c\n\ngoal (1 subgoal):\n 1. b \\<noteq> c \\<Longrightarrow> \\<not> p c < p b", "thus ?thesis"], ["proof (prove)\nusing this:\n  p b < p c\n\ngoal (1 subgoal):\n 1. \\<not> p c < p b", "by simp"], ["proof (state)\nthis:\n  \\<not> p c < p b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma top_impl_not_bot[simp]: \"p <\\<cdot> b \\<Longrightarrow> \\<not> b \\<cdot>< p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p <\\<cdot> b \\<Longrightarrow> \\<not> b \\<cdot>< p", "by(unfold bot_def, simp add:alt2)"], ["", "lemma [simp]: \"extreme p b \\<Longrightarrow> (\\<not> p <\\<cdot> b) = (b \\<cdot>< p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. extreme p b \\<Longrightarrow> (\\<not> p <\\<cdot> b) = b \\<cdot>< p", "apply(unfold extreme_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. b \\<cdot>< p \\<or> p <\\<cdot> b \\<Longrightarrow>\n    (\\<not> p <\\<cdot> b) = b \\<cdot>< p", "apply(fastforce dest:top_impl_not_bot)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma [simp]: \"extreme p b \\<Longrightarrow> (\\<not> b \\<cdot>< p) = (p <\\<cdot> b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. extreme p b \\<Longrightarrow> (\\<not> b \\<cdot>< p) = p <\\<cdot> b", "apply(unfold extreme_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. b \\<cdot>< p \\<or> p <\\<cdot> b \\<Longrightarrow>\n    (\\<not> b \\<cdot>< p) = p <\\<cdot> b", "apply(fastforce dest:top_impl_not_bot)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>Auxiliary construction to hide details of preference model.\\<close>"], ["", "definition\n mktop :: \"pref \\<Rightarrow> alt \\<Rightarrow> pref\" where\n\"mktop p b \\<equiv> p(b := Max(range p) + 1)\""], ["", "definition\n mkbot :: \"pref \\<Rightarrow> alt \\<Rightarrow> pref\" where\n\"mkbot p b \\<equiv> p(b := Min(range p) - 1)\""], ["", "definition\n between :: \"pref \\<Rightarrow> alt \\<Rightarrow> alt \\<Rightarrow> alt \\<Rightarrow> pref\" where\n\"between p a b c \\<equiv> p(b := (p a + p c)/2)\""], ["", "text\\<open>To make things simpler:\\<close>"], ["", "declare between_def[simp]"], ["", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> mktop p b a = p a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> mktop p b a = p a", "by(simp add:mktop_def)"], ["", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> mkbot p b a = p a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> mkbot p b a = p a", "by(simp add:mkbot_def)"], ["", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> p a < mktop p b b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> p a < mktop p b b", "by(simp add:mktop_def finite_alt)"], ["", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> mkbot p b b < p a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> mkbot p b b < p a", "by(simp add:mkbot_def finite_alt)"], ["", "lemma [simp]: \"mktop p b <\\<cdot> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mktop p b <\\<cdot> b", "by(simp add:mktop_def top_def finite_alt)"], ["", "lemma [simp]: \"\\<not> b \\<cdot>< mktop p b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> b \\<cdot>< mktop p b", "by(simp add:mktop_def bot_def alt2 finite_alt)"], ["", "lemma [simp]: \"a \\<noteq> b \\<Longrightarrow> \\<not> P p a < mkbot (P p) b b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> \\<not> P p a < mkbot (P p) b b", "proof (simp add:mkbot_def finite_alt)"], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> \\<exists>x. \\<not> P p a + 1 < P p x", "have \"\\<not> P p a + 1 < P p a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> P p a + 1 < P p a", "by simp"], ["proof (state)\nthis:\n  \\<not> P p a + 1 < P p a\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<Longrightarrow> \\<exists>x. \\<not> P p a + 1 < P p x", "thus \"\\<exists>x. \\<not> P p a + 1 < P p x\""], ["proof (prove)\nusing this:\n  \\<not> P p a + 1 < P p a\n\ngoal (1 subgoal):\n 1. \\<exists>x. \\<not> P p a + 1 < P p x", ".."], ["proof (state)\nthis:\n  \\<exists>x. \\<not> P p a + 1 < P p x\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>The proof starts here.\\<close>"], ["", "locale arrow =\nfixes F :: \"prof \\<Rightarrow> pref\"\nassumes unanimity: \"(\\<And>i. P i a < P i b) \\<Longrightarrow> F P a < F P b\"\nand IIA:\n\"(\\<And>i. (P i a < P i b) = (P' i a < P' i b)) \\<Longrightarrow>\n (F P a < F P b) = (F P' a < F P' b)\"\nbegin"], ["", "lemmas IIA' = IIA[THEN iffD1]"], ["", "definition\n dictates :: \"indi \\<Rightarrow> alt \\<Rightarrow> alt \\<Rightarrow> bool\" (\"_ dictates _ < _\") where\n\"(i dictates a < b)  \\<equiv>  \\<forall>P. P i a < P i b \\<longrightarrow> F P a < F P b\""], ["", "definition\n dictates2 :: \"indi \\<Rightarrow> alt \\<Rightarrow> alt \\<Rightarrow> bool\" (\"_ dictates _,_\") where\n\"(i dictates a,b)  \\<equiv>  (i dictates a < b) \\<and> (i dictates b < a)\""], ["", "definition\n dictatesx:: \"indi \\<Rightarrow> alt \\<Rightarrow> bool\" (\"_ dictates'_except _\") where\n\"(i dictates_except c)  \\<equiv>  \\<forall>a b. c \\<notin> {a,b} \\<longrightarrow> (i dictates a<b)\""], ["", "definition\n dictator :: \"indi \\<Rightarrow> bool\" where\n\"dictator i  \\<equiv>  \\<forall>a b. (i dictates a<b)\""], ["", "definition\n pivotal :: \"indi \\<Rightarrow> alt \\<Rightarrow> bool\" where\n\"pivotal i b \\<equiv>\n \\<exists>P. Extreme P b  \\<and>  b \\<cdot>< P i  \\<and>  b \\<cdot>< F P  \\<and>\n     F (P(i := mktop (P i) b)) <\\<cdot> b\""], ["", "lemma all_top[simp]: \"\\<forall>i. P i <\\<cdot> b \\<Longrightarrow> F P <\\<cdot> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. P i <\\<cdot> b \\<Longrightarrow> F P <\\<cdot> b", "by (unfold top_def) (simp add: unanimity)"], ["", "lemma not_extreme:\n  assumes nex: \"\\<not> extreme p b\"\n  shows \"\\<exists>a c. distinct[a,b,c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "obtain a c where abc: \"a \\<noteq> b \\<and> \\<not> p a < p b\" \"b \\<noteq> c \\<and> \\<not> p b < p c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a c.\n        \\<lbrakk>a \\<noteq> b \\<and> \\<not> p a < p b;\n         b \\<noteq> c \\<and> \\<not> p b < p c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using nex"], ["proof (prove)\nusing this:\n  \\<not> extreme p b\n\ngoal (1 subgoal):\n 1. (\\<And>a c.\n        \\<lbrakk>a \\<noteq> b \\<and> \\<not> p a < p b;\n         b \\<noteq> c \\<and> \\<not> p b < p c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (unfold extreme_def top_def bot_def) fastforce"], ["proof (state)\nthis:\n  a \\<noteq> b \\<and> \\<not> p a < p b\n  b \\<noteq> c \\<and> \\<not> p b < p c\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "proof (cases \"a = c\")"], ["proof (state)\ngoal (2 subgoals):\n 1. a = c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n 2. a \\<noteq> c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "assume \"a \\<noteq> c\""], ["proof (state)\nthis:\n  a \\<noteq> c\n\ngoal (2 subgoals):\n 1. a = c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n 2. a \\<noteq> c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "thus ?thesis"], ["proof (prove)\nusing this:\n  a \\<noteq> c\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "using abc"], ["proof (prove)\nusing this:\n  a \\<noteq> c\n  a \\<noteq> b \\<and> \\<not> p a < p b\n  b \\<noteq> c \\<and> \\<not> p b < p c\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "by simp blast"], ["proof (state)\nthis:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n\ngoal (1 subgoal):\n 1. a = c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. a = c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "assume ac: \"a = c\""], ["proof (state)\nthis:\n  a = c\n\ngoal (1 subgoal):\n 1. a = c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "obtain d where d: \"distinct[a,b,d]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>d. distinct [a, b, d] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using abc third_alt"], ["proof (prove)\nusing this:\n  a \\<noteq> b \\<and> \\<not> p a < p b\n  b \\<noteq> c \\<and> \\<not> p b < p c\n  ?a \\<noteq> ?b \\<Longrightarrow> \\<exists>c. distinct [?a, ?b, c]\n\ngoal (1 subgoal):\n 1. (\\<And>d. distinct [a, b, d] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  distinct [a, b, d]\n\ngoal (1 subgoal):\n 1. a = c \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "proof (cases \"p b < p d\")"], ["proof (state)\ngoal (2 subgoals):\n 1. p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n 2. \\<not> p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "case False"], ["proof (state)\nthis:\n  \\<not> p b < p d\n\ngoal (2 subgoals):\n 1. p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n 2. \\<not> p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<not> p b < p d\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "using abc d"], ["proof (prove)\nusing this:\n  \\<not> p b < p d\n  a \\<noteq> b \\<and> \\<not> p a < p b\n  b \\<noteq> c \\<and> \\<not> p b < p c\n  distinct [a, b, d]\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "by blast"], ["proof (state)\nthis:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n\ngoal (1 subgoal):\n 1. p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "case True"], ["proof (state)\nthis:\n  p b < p d\n\ngoal (1 subgoal):\n 1. p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "hence db: \"\\<not> p d < p b\""], ["proof (prove)\nusing this:\n  p b < p d\n\ngoal (1 subgoal):\n 1. \\<not> p d < p b", "by arith"], ["proof (state)\nthis:\n  \\<not> p d < p b\n\ngoal (1 subgoal):\n 1. p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "from d"], ["proof (chain)\npicking this:\n  distinct [a, b, d]", "have \"distinct[d,b,c]\""], ["proof (prove)\nusing this:\n  distinct [a, b, d]\n\ngoal (1 subgoal):\n 1. distinct [d, b, c]", "by(simp add:ac eq_sym_conv)"], ["proof (state)\nthis:\n  distinct [d, b, c]\n\ngoal (1 subgoal):\n 1. p b < p d \\<Longrightarrow>\n    \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "thus ?thesis"], ["proof (prove)\nusing this:\n  distinct [d, b, c]\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "using abc db"], ["proof (prove)\nusing this:\n  distinct [d, b, c]\n  a \\<noteq> b \\<and> \\<not> p a < p b\n  b \\<noteq> c \\<and> \\<not> p b < p c\n  \\<not> p d < p b\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c", "by blast"], ["proof (state)\nthis:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and> \\<not> p a < p b \\<and> \\<not> p b < p c\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma extremal:\n  assumes extremes: \"Extreme P b\" shows \"extreme (F P) b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. extreme (F P) b", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "assume nec: \"\\<not> extreme (F P) b\""], ["proof (state)\nthis:\n  \\<not> extreme (F P) b\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "hence \"\\<exists>a c. distinct[a,b,c] \\<and> \\<not> F P a < F P b \\<and> \\<not> F P b < F P c\""], ["proof (prove)\nusing this:\n  \\<not> extreme (F P) b\n\ngoal (1 subgoal):\n 1. \\<exists>a c.\n       distinct [a, b, c] \\<and>\n       \\<not> F P a < F P b \\<and> \\<not> F P b < F P c", "by(rule not_extreme)"], ["proof (state)\nthis:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and>\n     \\<not> F P a < F P b \\<and> \\<not> F P b < F P c\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and>\n     \\<not> F P a < F P b \\<and> \\<not> F P b < F P c", "obtain a c where d: \"distinct[a,b,c]\" and\n    ab: \"\\<not> F P a < F P b\" and bc: \"\\<not> F P b < F P c\""], ["proof (prove)\nusing this:\n  \\<exists>a c.\n     distinct [a, b, c] \\<and>\n     \\<not> F P a < F P b \\<and> \\<not> F P b < F P c\n\ngoal (1 subgoal):\n 1. (\\<And>a c.\n        \\<lbrakk>distinct [a, b, c]; \\<not> F P a < F P b;\n         \\<not> F P b < F P c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  distinct [a, b, c]\n  \\<not> F P a < F P b\n  \\<not> F P b < F P c\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "let ?P = \"\\<lambda>i. if P i <\\<cdot> b then between (P i) a c b\n                else (P i)(c := P i a + 1)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "have \"\\<not> F ?P a < F ?P b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            a\n           < F (\\<lambda>i.\n                   if P i <\\<cdot> b then between (P i) a c b\n                   else (P i)(c := P i a + 1))\n              b", "using extremes d"], ["proof (prove)\nusing this:\n  Extreme P b\n  distinct [a, b, c]\n\ngoal (1 subgoal):\n 1. \\<not> F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            a\n           < F (\\<lambda>i.\n                   if P i <\\<cdot> b then between (P i) a c b\n                   else (P i)(c := P i a + 1))\n              b", "by(simp add:IIA[of _ _ _ P] ab)"], ["proof (state)\nthis:\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          a\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            b\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          a\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            b\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "have \"\\<not> F ?P b < F ?P c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            b\n           < F (\\<lambda>i.\n                   if P i <\\<cdot> b then between (P i) a c b\n                   else (P i)(c := P i a + 1))\n              c", "using extremes d"], ["proof (prove)\nusing this:\n  Extreme P b\n  distinct [a, b, c]\n\ngoal (1 subgoal):\n 1. \\<not> F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            b\n           < F (\\<lambda>i.\n                   if P i <\\<cdot> b then between (P i) a c b\n                   else (P i)(c := P i a + 1))\n              c", "by(simp add:IIA[of _ _ _ P] bc eq_sym_conv)"], ["proof (state)\nthis:\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          b\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            c\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          b\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            c\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "have \"F ?P a < F ?P c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (\\<lambda>i.\n          if P i <\\<cdot> b then between (P i) a c b\n          else (P i)(c := P i a + 1))\n     a\n    < F (\\<lambda>i.\n            if P i <\\<cdot> b then between (P i) a c b\n            else (P i)(c := P i a + 1))\n       c", "by(rule unanimity)(insert d, simp)"], ["proof (state)\nthis:\n  F (\\<lambda>i.\n        if P i <\\<cdot> b then between (P i) a c b\n        else (P i)(c := P i a + 1))\n   a\n  < F (\\<lambda>i.\n          if P i <\\<cdot> b then between (P i) a c b\n          else (P i)(c := P i a + 1))\n     c\n\ngoal (1 subgoal):\n 1. \\<not> extreme (F P) b \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          a\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            b\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          b\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            c\n  F (\\<lambda>i.\n        if P i <\\<cdot> b then between (P i) a c b\n        else (P i)(c := P i a + 1))\n   a\n  < F (\\<lambda>i.\n          if P i <\\<cdot> b then between (P i) a c b\n          else (P i)(c := P i a + 1))\n     c", "show False"], ["proof (prove)\nusing this:\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          a\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            b\n  \\<not> F (\\<lambda>i.\n               if P i <\\<cdot> b then between (P i) a c b\n               else (P i)(c := P i a + 1))\n          b\n         < F (\\<lambda>i.\n                 if P i <\\<cdot> b then between (P i) a c b\n                 else (P i)(c := P i a + 1))\n            c\n  F (\\<lambda>i.\n        if P i <\\<cdot> b then between (P i) a c b\n        else (P i)(c := P i a + 1))\n   a\n  < F (\\<lambda>i.\n          if P i <\\<cdot> b then between (P i) a c b\n          else (P i)(c := P i a + 1))\n     c\n\ngoal (1 subgoal):\n 1. False", "by arith"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma pivotal_ind: assumes fin: \"finite D\"\n  shows \"\\<And>P. \\<lbrakk> D = {i. b \\<cdot>< P i}; Extreme P b; b \\<cdot>< F P \\<rbrakk>\n  \\<Longrightarrow> \\<exists>i. pivotal i b\" (is \"\\<And>P. ?D D P \\<Longrightarrow> ?E P \\<Longrightarrow> ?B P \\<Longrightarrow> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>D = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "using fin"], ["proof (prove)\nusing this:\n  finite D\n\ngoal (1 subgoal):\n 1. \\<And>P.\n       \\<lbrakk>D = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "proof (induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>P.\n       \\<lbrakk>{} = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b\n 2. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "case (empty P)"], ["proof (state)\nthis:\n  {} = {i. b \\<cdot>< P i}\n  Extreme P b\n  b \\<cdot>< F P\n\ngoal (2 subgoals):\n 1. \\<And>P.\n       \\<lbrakk>{} = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b\n 2. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "from empty(1,2)"], ["proof (chain)\npicking this:\n  {} = {i. b \\<cdot>< P i}\n  Extreme P b", "have \"\\<forall>i. P i <\\<cdot> b\""], ["proof (prove)\nusing this:\n  {} = {i. b \\<cdot>< P i}\n  Extreme P b\n\ngoal (1 subgoal):\n 1. \\<forall>i. P i <\\<cdot> b", "by simp"], ["proof (state)\nthis:\n  \\<forall>i. P i <\\<cdot> b\n\ngoal (2 subgoals):\n 1. \\<And>P.\n       \\<lbrakk>{} = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b\n 2. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "hence \"F P <\\<cdot> b\""], ["proof (prove)\nusing this:\n  \\<forall>i. P i <\\<cdot> b\n\ngoal (1 subgoal):\n 1. F P <\\<cdot> b", "by simp"], ["proof (state)\nthis:\n  F P <\\<cdot> b\n\ngoal (2 subgoals):\n 1. \\<And>P.\n       \\<lbrakk>{} = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b\n 2. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "hence False"], ["proof (prove)\nusing this:\n  F P <\\<cdot> b\n\ngoal (1 subgoal):\n 1. False", "using empty"], ["proof (prove)\nusing this:\n  F P <\\<cdot> b\n  {} = {i. b \\<cdot>< P i}\n  Extreme P b\n  b \\<cdot>< F P\n\ngoal (1 subgoal):\n 1. False", "by(blast dest:top_impl_not_bot)"], ["proof (state)\nthis:\n  False\n\ngoal (2 subgoals):\n 1. \\<And>P.\n       \\<lbrakk>{} = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b\n 2. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "thus ?case"], ["proof (prove)\nusing this:\n  False\n\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", ".."], ["proof (state)\nthis:\n  \\<exists>i. pivotal i b\n\ngoal (1 subgoal):\n 1. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "fix D i P"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "assume IH: \"\\<And>P. ?D D P \\<Longrightarrow> ?E P \\<Longrightarrow> ?B P \\<Longrightarrow> \\<exists>i. pivotal i b\"\n    and \"?E P\" and \"?B P\" and insert: \"insert i D = {i. b \\<cdot>< P i}\" and \"i \\<notin> D\""], ["proof (state)\nthis:\n  \\<lbrakk>D = {i. b \\<cdot>< ?P i}; Extreme ?P b; b \\<cdot>< F ?P\\<rbrakk>\n  \\<Longrightarrow> \\<exists>i. pivotal i b\n  Extreme P b\n  b \\<cdot>< F P\n  insert i D = {i. b \\<cdot>< P i}\n  i \\<notin> D\n\ngoal (1 subgoal):\n 1. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "from insert"], ["proof (chain)\npicking this:\n  insert i D = {i. b \\<cdot>< P i}", "have \"b \\<cdot>< P i\""], ["proof (prove)\nusing this:\n  insert i D = {i. b \\<cdot>< P i}\n\ngoal (1 subgoal):\n 1. b \\<cdot>< P i", "by blast"], ["proof (state)\nthis:\n  b \\<cdot>< P i\n\ngoal (1 subgoal):\n 1. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "let ?P = \"P(i := mktop (P i) b)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x Fa P.\n       \\<lbrakk>finite Fa; x \\<notin> Fa;\n        \\<And>P.\n           \\<lbrakk>Fa = {i. b \\<cdot>< P i}; Extreme P b;\n            b \\<cdot>< F P\\<rbrakk>\n           \\<Longrightarrow> \\<exists>i. pivotal i b;\n        insert x Fa = {i. b \\<cdot>< P i}; Extreme P b;\n        b \\<cdot>< F P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i. pivotal i b", "show \"\\<exists>i. pivotal i b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "proof (cases \"F ?P <\\<cdot> b\")"], ["proof (state)\ngoal (2 subgoals):\n 1. F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b\n 2. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "case True"], ["proof (state)\nthis:\n  F (P(i := mktop (P i) b)) <\\<cdot> b\n\ngoal (2 subgoals):\n 1. F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b\n 2. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "have \"pivotal i b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pivotal i b", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. pivotal i b", "from \\<open>?E P\\<close> \\<open>?B P\\<close> \\<open>b \\<cdot>< P i\\<close> True"], ["proof (chain)\npicking this:\n  Extreme P b\n  b \\<cdot>< F P\n  b \\<cdot>< P i\n  F (P(i := mktop (P i) b)) <\\<cdot> b", "show ?thesis"], ["proof (prove)\nusing this:\n  Extreme P b\n  b \\<cdot>< F P\n  b \\<cdot>< P i\n  F (P(i := mktop (P i) b)) <\\<cdot> b\n\ngoal (1 subgoal):\n 1. pivotal i b", "by(unfold pivotal_def, blast)"], ["proof (state)\nthis:\n  pivotal i b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  pivotal i b\n\ngoal (2 subgoals):\n 1. F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b\n 2. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "thus ?thesis"], ["proof (prove)\nusing this:\n  pivotal i b\n\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", ".."], ["proof (state)\nthis:\n  \\<exists>i. pivotal i b\n\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "case False"], ["proof (state)\nthis:\n  \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b\n\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "have \"D = {i. b \\<cdot>< ?P i}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D = {ia. b \\<cdot>< (P(i := mktop (P i) b)) ia}", "by (rule set_eqI) (simp add:\\<open>i \\<notin> D\\<close>, insert insert, blast)"], ["proof (state)\nthis:\n  D = {ia. b \\<cdot>< (P(i := mktop (P i) b)) ia}\n\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "moreover"], ["proof (state)\nthis:\n  D = {ia. b \\<cdot>< (P(i := mktop (P i) b)) ia}\n\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "have \"Extreme ?P b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Extreme (P(i := mktop (P i) b)) b", "using \\<open>?E P\\<close>"], ["proof (prove)\nusing this:\n  Extreme P b\n\ngoal (1 subgoal):\n 1. Extreme (P(i := mktop (P i) b)) b", "by (simp add:extreme_def)"], ["proof (state)\nthis:\n  Extreme (P(i := mktop (P i) b)) b\n\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "moreover"], ["proof (state)\nthis:\n  Extreme (P(i := mktop (P i) b)) b\n\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "have \"b \\<cdot>< F ?P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b \\<cdot>< F (P(i := mktop (P i) b))", "using extremal[OF \\<open>Extreme ?P b\\<close>] False"], ["proof (prove)\nusing this:\n  extreme (F (P(i := mktop (P i) b))) b\n  \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b\n\ngoal (1 subgoal):\n 1. b \\<cdot>< F (P(i := mktop (P i) b))", "by(simp del:fun_upd_apply)"], ["proof (state)\nthis:\n  b \\<cdot>< F (P(i := mktop (P i) b))\n\ngoal (1 subgoal):\n 1. \\<not> F (P(i := mktop (P i) b)) <\\<cdot> b \\<Longrightarrow>\n    \\<exists>i. pivotal i b", "ultimately"], ["proof (chain)\npicking this:\n  D = {ia. b \\<cdot>< (P(i := mktop (P i) b)) ia}\n  Extreme (P(i := mktop (P i) b)) b\n  b \\<cdot>< F (P(i := mktop (P i) b))", "show ?thesis"], ["proof (prove)\nusing this:\n  D = {ia. b \\<cdot>< (P(i := mktop (P i) b)) ia}\n  Extreme (P(i := mktop (P i) b)) b\n  b \\<cdot>< F (P(i := mktop (P i) b))\n\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "by(rule IH)"], ["proof (state)\nthis:\n  \\<exists>i. pivotal i b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>i. pivotal i b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma pivotal_exists: \"\\<exists>i. pivotal i b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "let ?P = \"(\\<lambda>_ a. if a=b then 0 else 1)::prof\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "have \"Extreme ?P b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Extreme (\\<lambda>i a. if a = b then 0 else 1) b", "by(simp add:extreme_def bot_def)"], ["proof (state)\nthis:\n  Extreme (\\<lambda>i a. if a = b then 0 else 1) b\n\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "moreover"], ["proof (state)\nthis:\n  Extreme (\\<lambda>i a. if a = b then 0 else 1) b\n\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "have \"b \\<cdot>< F ?P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b \\<cdot>< F (\\<lambda>_ a. if a = b then 0 else 1)", "by(simp add:bot_def unanimity del: less_if_bot not_less_if_bot)"], ["proof (state)\nthis:\n  b \\<cdot>< F (\\<lambda>_ a. if a = b then 0 else 1)\n\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "ultimately"], ["proof (chain)\npicking this:\n  Extreme (\\<lambda>i a. if a = b then 0 else 1) b\n  b \\<cdot>< F (\\<lambda>_ a. if a = b then 0 else 1)", "show \"\\<exists>i. pivotal i b\""], ["proof (prove)\nusing this:\n  Extreme (\\<lambda>i a. if a = b then 0 else 1) b\n  b \\<cdot>< F (\\<lambda>_ a. if a = b then 0 else 1)\n\ngoal (1 subgoal):\n 1. \\<exists>i. pivotal i b", "by (rule pivotal_ind[OF finite_subset[OF subset_UNIV finite_indi] refl])"], ["proof (state)\nthis:\n  \\<exists>i. pivotal i b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma pivotal_xdictates: assumes pivo: \"pivotal i b\"\n  shows \"i dictates_except b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i dictates_except b", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. i dictates_except b", "have \"\\<And>a c. \\<lbrakk> a \\<noteq> b; b \\<noteq> c \\<rbrakk> \\<Longrightarrow> i dictates a < c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a c.\n       \\<lbrakk>a \\<noteq> b; b \\<noteq> c\\<rbrakk>\n       \\<Longrightarrow> i dictates a < c", "proof (unfold dictates_def, intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a c P.\n       \\<lbrakk>a \\<noteq> b; b \\<noteq> c; P i a < P i c\\<rbrakk>\n       \\<Longrightarrow> F P a < F P c", "fix a c and P::prof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a c P.\n       \\<lbrakk>a \\<noteq> b; b \\<noteq> c; P i a < P i c\\<rbrakk>\n       \\<Longrightarrow> F P a < F P c", "assume abc: \"a \\<noteq> b\" \"b \\<noteq> c\" and\n           ac: \"P i a < P i c\""], ["proof (state)\nthis:\n  a \\<noteq> b\n  b \\<noteq> c\n  P i a < P i c\n\ngoal (1 subgoal):\n 1. \\<And>a c P.\n       \\<lbrakk>a \\<noteq> b; b \\<noteq> c; P i a < P i c\\<rbrakk>\n       \\<Longrightarrow> F P a < F P c", "show \"F P a < F P c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F P a < F P c", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F P a < F P c", "obtain P1 P2 where\n        \"Extreme P1 b\" and \"b \\<cdot>< F P1\" and \"b \\<cdot>< P1 i\" and \"F P2 <\\<cdot> b\" and\n        [simp]: \"P2 = P1(i := mktop (P1 i) b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>P1 P2.\n        \\<lbrakk>Extreme P1 b; b \\<cdot>< F P1; b \\<cdot>< P1 i;\n         F P2 <\\<cdot> b; P2 = P1(i := mktop (P1 i) b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using pivo"], ["proof (prove)\nusing this:\n  pivotal i b\n\ngoal (1 subgoal):\n 1. (\\<And>P1 P2.\n        \\<lbrakk>Extreme P1 b; b \\<cdot>< F P1; b \\<cdot>< P1 i;\n         F P2 <\\<cdot> b; P2 = P1(i := mktop (P1 i) b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (unfold pivotal_def) fast"], ["proof (state)\nthis:\n  Extreme P1 b\n  b \\<cdot>< F P1\n  b \\<cdot>< P1 i\n  F P2 <\\<cdot> b\n  P2 = P1(i := mktop (P1 i) b)\n\ngoal (1 subgoal):\n 1. F P a < F P c", "let ?P = \"\\<lambda>j. if j=i then between (P j) a b c\n                    else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b\""], ["proof (state)\ngoal (1 subgoal):\n 1. F P a < F P c", "have eq: \"(F P a < F P c) = (F ?P a < F ?P c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F P a < F P c) =\n    (F (\\<lambda>j.\n           if j = i then between (P j) a b c\n           else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      a\n     < F (\\<lambda>j.\n             if j = i then between (P j) a b c\n             else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n        c)", "using abc"], ["proof (prove)\nusing this:\n  a \\<noteq> b\n  b \\<noteq> c\n\ngoal (1 subgoal):\n 1. (F P a < F P c) =\n    (F (\\<lambda>j.\n           if j = i then between (P j) a b c\n           else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      a\n     < F (\\<lambda>j.\n             if j = i then between (P j) a b c\n             else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n        c)", "by - (rule IIA, auto)"], ["proof (state)\nthis:\n  (F P a < F P c) =\n  (F (\\<lambda>j.\n         if j = i then between (P j) a b c\n         else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n    a\n   < F (\\<lambda>j.\n           if j = i then between (P j) a b c\n           else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      c)\n\ngoal (1 subgoal):\n 1. F P a < F P c", "have \"F ?P a < F ?P b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (\\<lambda>j.\n          if j = i then between (P j) a b c\n          else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n     a\n    < F (\\<lambda>j.\n            if j = i then between (P j) a b c\n            else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n       b", "proof (rule IIA')"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (?P ia a < ?P ia b) =\n       ((if ia = i then between (P ia) a b c\n         else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n         a\n        < (if ia = i then between (P ia) a b c\n           else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n           b)\n 2. F ?P a < F ?P b", "fix j"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (?P ia a < ?P ia b) =\n       ((if ia = i then between (P ia) a b c\n         else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n         a\n        < (if ia = i then between (P ia) a b c\n           else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n           b)\n 2. F ?P a < F ?P b", "show \"(P2 j a < P2 j b) = (?P j a < ?P j b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P2 j a < P2 j b) =\n    ((if j = i then between (P j) a b c\n      else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      a\n     < (if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n        b)", "using \\<open>Extreme P1 b\\<close>"], ["proof (prove)\nusing this:\n  Extreme P1 b\n\ngoal (1 subgoal):\n 1. (P2 j a < P2 j b) =\n    ((if j = i then between (P j) a b c\n      else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      a\n     < (if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n        b)", "by(simp add: ac)"], ["proof (state)\nthis:\n  (P2 j a < P2 j b) =\n  ((if j = i then between (P j) a b c\n    else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n    a\n   < (if j = i then between (P j) a b c\n      else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      b)\n\ngoal (1 subgoal):\n 1. F P2 a < F P2 b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. F P2 a < F P2 b", "show \"F P2 a < F P2 b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F P2 a < F P2 b", "using \\<open>F P2 <\\<cdot> b\\<close> abc"], ["proof (prove)\nusing this:\n  F P2 <\\<cdot> b\n  a \\<noteq> b\n  b \\<noteq> c\n\ngoal (1 subgoal):\n 1. F P2 a < F P2 b", "by(simp add: eq_sym_conv)"], ["proof (state)\nthis:\n  F P2 a < F P2 b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F (\\<lambda>j.\n        if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n   a\n  < F (\\<lambda>j.\n          if j = i then between (P j) a b c\n          else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n     b\n\ngoal (1 subgoal):\n 1. F P a < F P c", "also"], ["proof (state)\nthis:\n  F (\\<lambda>j.\n        if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n   a\n  < F (\\<lambda>j.\n          if j = i then between (P j) a b c\n          else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n     b\n\ngoal (1 subgoal):\n 1. F P a < F P c", "have \"\\<dots> < F ?P c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (\\<lambda>j.\n          if j = i then between (P j) a b c\n          else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n     b\n    < F (\\<lambda>j.\n            if j = i then between (P j) a b c\n            else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n       c", "proof (rule IIA')"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (?P ia b < ?P ia c) =\n       ((if ia = i then between (P ia) a b c\n         else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n         b\n        < (if ia = i then between (P ia) a b c\n           else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n           c)\n 2. F ?P b < F ?P c", "fix j"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       (?P ia b < ?P ia c) =\n       ((if ia = i then between (P ia) a b c\n         else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n         b\n        < (if ia = i then between (P ia) a b c\n           else if P1 ia <\\<cdot> b then mktop (P ia) b else mkbot (P ia) b)\n           c)\n 2. F ?P b < F ?P c", "show \"(P1 j b < P1 j c) = (?P j b < ?P j c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (P1 j b < P1 j c) =\n    ((if j = i then between (P j) a b c\n      else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      b\n     < (if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n        c)", "using \\<open>Extreme P1 b\\<close> \\<open>b \\<cdot>< P1 i\\<close>"], ["proof (prove)\nusing this:\n  Extreme P1 b\n  b \\<cdot>< P1 i\n\ngoal (1 subgoal):\n 1. (P1 j b < P1 j c) =\n    ((if j = i then between (P j) a b c\n      else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      b\n     < (if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n        c)", "by(simp add: ac)"], ["proof (state)\nthis:\n  (P1 j b < P1 j c) =\n  ((if j = i then between (P j) a b c\n    else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n    b\n   < (if j = i then between (P j) a b c\n      else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n      c)\n\ngoal (1 subgoal):\n 1. F P1 b < F P1 c", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. F P1 b < F P1 c", "show \"F P1 b < F P1 c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F P1 b < F P1 c", "using \\<open>b \\<cdot>< F P1\\<close> abc"], ["proof (prove)\nusing this:\n  b \\<cdot>< F P1\n  a \\<noteq> b\n  b \\<noteq> c\n\ngoal (1 subgoal):\n 1. F P1 b < F P1 c", "by(simp add: eq_sym_conv)"], ["proof (state)\nthis:\n  F P1 b < F P1 c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F (\\<lambda>j.\n        if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n   b\n  < F (\\<lambda>j.\n          if j = i then between (P j) a b c\n          else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n     c\n\ngoal (1 subgoal):\n 1. F P a < F P c", "finally"], ["proof (chain)\npicking this:\n  F (\\<lambda>j.\n        if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n   a\n  < F (\\<lambda>j.\n          if j = i then between (P j) a b c\n          else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n     c", "show ?thesis"], ["proof (prove)\nusing this:\n  F (\\<lambda>j.\n        if j = i then between (P j) a b c\n        else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n   a\n  < F (\\<lambda>j.\n          if j = i then between (P j) a b c\n          else if P1 j <\\<cdot> b then mktop (P j) b else mkbot (P j) b)\n     c\n\ngoal (1 subgoal):\n 1. F P a < F P c", "by(simp add:eq)"], ["proof (state)\nthis:\n  F P a < F P c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F P a < F P c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?a \\<noteq> b; b \\<noteq> ?c\\<rbrakk>\n  \\<Longrightarrow> i dictates ?a < ?c\n\ngoal (1 subgoal):\n 1. i dictates_except b", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?a \\<noteq> b; b \\<noteq> ?c\\<rbrakk>\n  \\<Longrightarrow> i dictates ?a < ?c\n\ngoal (1 subgoal):\n 1. i dictates_except b", "by(unfold dictatesx_def) fast"], ["proof (state)\nthis:\n  i dictates_except b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma pivotal_is_dictator:\n  assumes pivo: \"pivotal i b\" and ab: \"a \\<noteq> b\" and d: \"j dictates a,b\"\n  shows \"i = j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i = j", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> False", "assume pd: \"i \\<noteq> j\""], ["proof (state)\nthis:\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> False", "obtain P1 P2 where \"Extreme P1 b\" and \"b \\<cdot>< F P1\" and \"F P2 <\\<cdot> b\" and\n    P2: \"P2 = P1(i := mktop (P1 i) b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>P1 P2.\n        \\<lbrakk>Extreme P1 b; b \\<cdot>< F P1; F P2 <\\<cdot> b;\n         P2 = P1(i := mktop (P1 i) b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using pivo"], ["proof (prove)\nusing this:\n  pivotal i b\n\ngoal (1 subgoal):\n 1. (\\<And>P1 P2.\n        \\<lbrakk>Extreme P1 b; b \\<cdot>< F P1; F P2 <\\<cdot> b;\n         P2 = P1(i := mktop (P1 i) b)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (unfold pivotal_def) fast"], ["proof (state)\nthis:\n  Extreme P1 b\n  b \\<cdot>< F P1\n  F P2 <\\<cdot> b\n  P2 = P1(i := mktop (P1 i) b)\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> False", "have \"~(P1 j a < P1 j b)\" (is \"~ ?ab\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> P1 j a < P1 j b", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. P1 j a < P1 j b \\<Longrightarrow> False", "assume \"?ab\""], ["proof (state)\nthis:\n  P1 j a < P1 j b\n\ngoal (1 subgoal):\n 1. P1 j a < P1 j b \\<Longrightarrow> False", "hence \"F P1 a < F P1 b\""], ["proof (prove)\nusing this:\n  P1 j a < P1 j b\n\ngoal (1 subgoal):\n 1. F P1 a < F P1 b", "using d"], ["proof (prove)\nusing this:\n  P1 j a < P1 j b\n  j dictates a,b\n\ngoal (1 subgoal):\n 1. F P1 a < F P1 b", "by(simp add: dictates_def dictates2_def)"], ["proof (state)\nthis:\n  F P1 a < F P1 b\n\ngoal (1 subgoal):\n 1. P1 j a < P1 j b \\<Longrightarrow> False", "with \\<open>b \\<cdot>< F P1\\<close>"], ["proof (chain)\npicking this:\n  b \\<cdot>< F P1\n  F P1 a < F P1 b", "show False"], ["proof (prove)\nusing this:\n  b \\<cdot>< F P1\n  F P1 a < F P1 b\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<not> P1 j a < P1 j b\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> False", "hence \"P1 j b < P1 j a\""], ["proof (prove)\nusing this:\n  \\<not> P1 j a < P1 j b\n\ngoal (1 subgoal):\n 1. P1 j b < P1 j a", "using \\<open>Extreme P1 b\\<close>[THEN spec, of j] ab"], ["proof (prove)\nusing this:\n  \\<not> P1 j a < P1 j b\n  extreme (P1 j) b\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. P1 j b < P1 j a", "unfolding extreme_def top_def bot_def"], ["proof (prove)\nusing this:\n  \\<not> P1 j a < P1 j b\n  (\\<forall>a. a \\<noteq> b \\<longrightarrow> P1 j b < P1 j a) \\<or>\n  (\\<forall>a. a \\<noteq> b \\<longrightarrow> P1 j a < P1 j b)\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. P1 j b < P1 j a", "by metis"], ["proof (state)\nthis:\n  P1 j b < P1 j a\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> False", "hence \"P2 j b < P2 j a\""], ["proof (prove)\nusing this:\n  P1 j b < P1 j a\n\ngoal (1 subgoal):\n 1. P2 j b < P2 j a", "using pd"], ["proof (prove)\nusing this:\n  P1 j b < P1 j a\n  i \\<noteq> j\n\ngoal (1 subgoal):\n 1. P2 j b < P2 j a", "by (simp add:P2)"], ["proof (state)\nthis:\n  P2 j b < P2 j a\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> False", "hence \"F P2 b < F P2 a\""], ["proof (prove)\nusing this:\n  P2 j b < P2 j a\n\ngoal (1 subgoal):\n 1. F P2 b < F P2 a", "using d"], ["proof (prove)\nusing this:\n  P2 j b < P2 j a\n  j dictates a,b\n\ngoal (1 subgoal):\n 1. F P2 b < F P2 a", "by(simp add: dictates_def dictates2_def)"], ["proof (state)\nthis:\n  F P2 b < F P2 a\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<Longrightarrow> False", "with \\<open>F P2 <\\<cdot> b\\<close>"], ["proof (chain)\npicking this:\n  F P2 <\\<cdot> b\n  F P2 b < F P2 a", "show False"], ["proof (prove)\nusing this:\n  F P2 <\\<cdot> b\n  F P2 b < F P2 a\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem dictator: \"\\<exists>i. dictator i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ex dictator", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Ex dictator", "from pivotal_exists[of b]"], ["proof (chain)\npicking this:\n  \\<exists>i. pivotal i b", "obtain i where pivo: \"pivotal i b\""], ["proof (prove)\nusing this:\n  \\<exists>i. pivotal i b\n\ngoal (1 subgoal):\n 1. (\\<And>i. pivotal i b \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", ".."], ["proof (state)\nthis:\n  pivotal i b\n\ngoal (1 subgoal):\n 1. Ex dictator", "{"], ["proof (state)\nthis:\n  pivotal i b\n\ngoal (1 subgoal):\n 1. Ex dictator", "fix a"], ["proof (state)\ngoal (1 subgoal):\n 1. Ex dictator", "assume neq: \"a \\<noteq> b\""], ["proof (state)\nthis:\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. Ex dictator", "have \"i dictates a,b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i dictates a,b", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. i dictates a,b", "obtain c where dist: \"distinct[a,b,c]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c. distinct [a, b, c] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using neq third_alt"], ["proof (prove)\nusing this:\n  a \\<noteq> b\n  ?a \\<noteq> ?b \\<Longrightarrow> \\<exists>c. distinct [?a, ?b, c]\n\ngoal (1 subgoal):\n 1. (\\<And>c. distinct [a, b, c] \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  distinct [a, b, c]\n\ngoal (1 subgoal):\n 1. i dictates a,b", "obtain j where \"pivotal j c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>j. pivotal j c \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "using pivotal_exists"], ["proof (prove)\nusing this:\n  \\<exists>i. pivotal i ?b\n\ngoal (1 subgoal):\n 1. (\\<And>j. pivotal j c \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by fast"], ["proof (state)\nthis:\n  pivotal j c\n\ngoal (1 subgoal):\n 1. i dictates a,b", "hence \"j dictates_except c\""], ["proof (prove)\nusing this:\n  pivotal j c\n\ngoal (1 subgoal):\n 1. j dictates_except c", "by(rule pivotal_xdictates)"], ["proof (state)\nthis:\n  j dictates_except c\n\ngoal (1 subgoal):\n 1. i dictates a,b", "hence b: \"j dictates a,b\""], ["proof (prove)\nusing this:\n  j dictates_except c\n\ngoal (1 subgoal):\n 1. j dictates a,b", "using dist"], ["proof (prove)\nusing this:\n  j dictates_except c\n  distinct [a, b, c]\n\ngoal (1 subgoal):\n 1. j dictates a,b", "by(simp add:dictatesx_def dictates2_def eq_sym_conv)"], ["proof (state)\nthis:\n  j dictates a,b\n\ngoal (1 subgoal):\n 1. i dictates a,b", "with pivo neq"], ["proof (chain)\npicking this:\n  pivotal i b\n  a \\<noteq> b\n  j dictates a,b", "have \"i = j\""], ["proof (prove)\nusing this:\n  pivotal i b\n  a \\<noteq> b\n  j dictates a,b\n\ngoal (1 subgoal):\n 1. i = j", "by(rule pivotal_is_dictator)"], ["proof (state)\nthis:\n  i = j\n\ngoal (1 subgoal):\n 1. i dictates a,b", "thus ?thesis"], ["proof (prove)\nusing this:\n  i = j\n\ngoal (1 subgoal):\n 1. i dictates a,b", "using b"], ["proof (prove)\nusing this:\n  i = j\n  j dictates a,b\n\ngoal (1 subgoal):\n 1. i dictates a,b", "by simp"], ["proof (state)\nthis:\n  i dictates a,b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  i dictates a,b\n\ngoal (1 subgoal):\n 1. Ex dictator", "}"], ["proof (state)\nthis:\n  ?a2 \\<noteq> b \\<Longrightarrow> i dictates ?a2,b\n\ngoal (1 subgoal):\n 1. Ex dictator", "with pivotal_xdictates[OF pivo]"], ["proof (chain)\npicking this:\n  i dictates_except b\n  ?a2 \\<noteq> b \\<Longrightarrow> i dictates ?a2,b", "have \"dictator i\""], ["proof (prove)\nusing this:\n  i dictates_except b\n  ?a2 \\<noteq> b \\<Longrightarrow> i dictates ?a2,b\n\ngoal (1 subgoal):\n 1. dictator i", "by(simp add: dictates_def dictatesx_def dictates2_def dictator_def)\n      (metis less_le)"], ["proof (state)\nthis:\n  dictator i\n\ngoal (1 subgoal):\n 1. Ex dictator", "thus ?thesis"], ["proof (prove)\nusing this:\n  dictator i\n\ngoal (1 subgoal):\n 1. Ex dictator", ".."], ["proof (state)\nthis:\n  Ex dictator\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"]]}