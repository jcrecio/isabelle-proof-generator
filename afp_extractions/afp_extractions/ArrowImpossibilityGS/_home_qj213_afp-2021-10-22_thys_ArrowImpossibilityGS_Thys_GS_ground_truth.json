{"file_name": "/home/qj213/afp-2021-10-22/thys/ArrowImpossibilityGS/Thys/GS.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/ArrowImpossibilityGS", "problem_names": ["lemma Top_in_Lin: \"L:Lin \\<Longrightarrow> Top S L : Lin\"", "lemma Top_in_Prof: \"P:Prof \\<Longrightarrow> Top S o P : Prof\"", "lemma not_manipulable: \"\\<not> manipulable f \\<longleftrightarrow>\n (\\<forall>P\\<in>Prof.\\<forall>i.\\<forall>L\\<in>Lin. f P \\<noteq> f(P(i:=L)) \\<longrightarrow>\n   (f(P(i := L)), f P) : P i \\<and> (f P, f(P(i := L))) : L)\" (is \"?A = ?B\")", "lemma nonmanip:\n  \"P:Prof \\<Longrightarrow> L:Lin \\<Longrightarrow> f(P(i := L)) \\<noteq> f P \\<Longrightarrow>\n  (f(P(i := L)), f P) : P i \\<and> (f P, f(P(i := L))) : L\"", "lemma mono:\nassumes \"P\\<in>Prof\" \"P'\\<in>Prof\" \"\\<forall>i a. (a, f P) : P i \\<longrightarrow> (a, f P) : P' i\"\nshows \"f P' = f P\"", "lemma una_Top: assumes \"P:Prof\" \"S \\<noteq> {}\" shows \"f(Top S o P) : S\"", "lemma SWF_swf: \"swf f : SWF\"", "lemma Top_top: \"L:Lin \\<Longrightarrow> (!!a. a\\<noteq>b \\<Longrightarrow> (a,b) : L) \\<Longrightarrow> Top {b} L = L\"", "lemma una_swf: \"unanimity(swf f)\"", "lemma IIA_swf: \"IIA(swf f)\"", "lemma dict_swf: assumes \"dictator (swf f) i\" shows \"dict f i\"", "theorem Gibbard_Satterthwaite:\n  \"\\<exists>i. dict f i\"", "theorem Gibbard_Satterthwaite:\n  \"\\<not> manipulable f \\<Longrightarrow> \\<forall>a.\\<exists>P\\<in>Prof. a = f P \\<Longrightarrow> \\<exists>i. dict f i\""], "translations": [["", "lemma Top_in_Lin: \"L:Lin \\<Longrightarrow> Top S L : Lin\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L \\<in> Lin \\<Longrightarrow> Top S L \\<in> Lin", "apply(simp add:Top_def slo_defs Sigma_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. trans L \\<and>\n    (\\<forall>a. (a, a) \\<notin> L) \\<and>\n    (\\<forall>x y.\n        x \\<noteq> y \\<longrightarrow>\n        x <\\<^bsub>L\\<^esub> y \\<or>\n        y <\\<^bsub>L\\<^esub> x) \\<Longrightarrow>\n    trans\n     ({(a, b).\n       a <\\<^bsub>L\\<^esub> b \\<and>\n       (a \\<in> S \\<and> b \\<in> S \\<or>\n        a \\<notin> S \\<and> b \\<notin> S)} \\<union>\n      (\\<Union>x\\<in>{a. a \\<notin> S}. \\<Union>y\\<in>S. {(x, y)})) \\<and>\n    (\\<forall>x y.\n        x \\<noteq> y \\<longrightarrow>\n        x <\\<^bsub>L\\<^esub> y \\<and>\n        (x \\<in> S \\<and> y \\<in> S \\<or>\n         x \\<notin> S \\<and> y \\<notin> S) \\<or>\n        x \\<notin> S \\<and> y \\<in> S \\<or>\n        y <\\<^bsub>L\\<^esub> x \\<and>\n        (y \\<in> S \\<and> x \\<in> S \\<or>\n         y \\<notin> S \\<and> x \\<notin> S) \\<or>\n        y \\<notin> S \\<and> x \\<in> S)", "unfolding trans_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x y z.\n        x <\\<^bsub>L\\<^esub> y \\<longrightarrow>\n        y <\\<^bsub>L\\<^esub> z \\<longrightarrow>\n        x <\\<^bsub>L\\<^esub> z) \\<and>\n    (\\<forall>a. (a, a) \\<notin> L) \\<and>\n    (\\<forall>x y.\n        x \\<noteq> y \\<longrightarrow>\n        x <\\<^bsub>L\\<^esub> y \\<or>\n        y <\\<^bsub>L\\<^esub> x) \\<Longrightarrow>\n    (\\<forall>x y z.\n        x <\\<^bsub>{(a, b).\n                    a <\\<^bsub>L\\<^esub> b \\<and>\n                    (a \\<in> S \\<and> b \\<in> S \\<or>\n                     a \\<notin> S \\<and> b \\<notin> S)} \\<union>\n                   (\\<Union>x\\<in>{a. a \\<notin> S}.\n                       \\<Union>y\\<in>S.\n                          {(x, y)})\\<^esub> y \\<longrightarrow>\n        y <\\<^bsub>{(a, b).\n                    a <\\<^bsub>L\\<^esub> b \\<and>\n                    (a \\<in> S \\<and> b \\<in> S \\<or>\n                     a \\<notin> S \\<and> b \\<notin> S)} \\<union>\n                   (\\<Union>x\\<in>{a. a \\<notin> S}.\n                       \\<Union>y\\<in>S.\n                          {(x, y)})\\<^esub> z \\<longrightarrow>\n        x <\\<^bsub>{(a, b).\n                    a <\\<^bsub>L\\<^esub> b \\<and>\n                    (a \\<in> S \\<and> b \\<in> S \\<or>\n                     a \\<notin> S \\<and> b \\<notin> S)} \\<union>\n                   (\\<Union>x\\<in>{a. a \\<notin> S}.\n                       \\<Union>y\\<in>S. {(x, y)})\\<^esub> z) \\<and>\n    (\\<forall>x y.\n        x \\<noteq> y \\<longrightarrow>\n        x <\\<^bsub>L\\<^esub> y \\<and>\n        (x \\<in> S \\<and> y \\<in> S \\<or>\n         x \\<notin> S \\<and> y \\<notin> S) \\<or>\n        x \\<notin> S \\<and> y \\<in> S \\<or>\n        y <\\<^bsub>L\\<^esub> x \\<and>\n        (y \\<in> S \\<and> x \\<in> S \\<or>\n         y \\<notin> S \\<and> x \\<notin> S) \\<or>\n        y \\<notin> S \\<and> x \\<in> S)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Top_in_Prof: \"P:Prof \\<Longrightarrow> Top S o P : Prof\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<in> Prof \\<Longrightarrow> Top S \\<circ> P \\<in> Prof", "by(simp add:Prof_def Pi_def Top_in_Lin)"], ["", "lemma not_manipulable: \"\\<not> manipulable f \\<longleftrightarrow>\n (\\<forall>P\\<in>Prof.\\<forall>i.\\<forall>L\\<in>Lin. f P \\<noteq> f(P(i:=L)) \\<longrightarrow>\n   (f(P(i := L)), f P) : P i \\<and> (f P, f(P(i := L))) : L)\" (is \"?A = ?B\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<not> manipulable f) =\n    (\\<forall>P\\<in>Prof.\n        \\<forall>i.\n           \\<forall>L\\<in>Lin.\n              f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n              f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n              f P <\\<^bsub>L\\<^esub> f (P(i := L)))", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<not> manipulable f \\<Longrightarrow>\n    \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L))\n 2. \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L)) \\<Longrightarrow>\n    \\<not> manipulable f", "assume ?A"], ["proof (state)\nthis:\n  \\<not> manipulable f\n\ngoal (2 subgoals):\n 1. \\<not> manipulable f \\<Longrightarrow>\n    \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L))\n 2. \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L)) \\<Longrightarrow>\n    \\<not> manipulable f", "show ?B"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L))", "proof(clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "fix P i L"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "assume 0: \"P \\<in> Prof\" \"L \\<in> Lin\" \"f P \\<noteq> f (P(i := L))\""], ["proof (state)\nthis:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "moreover"], ["proof (state)\nthis:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "hence 1: \"P i: Lin\" \"P(i:=L): Prof\""], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n\ngoal (1 subgoal):\n 1. P i \\<in> Lin &&& P(i := L) \\<in> Prof", "by(simp add:Prof_def Pi_def)+"], ["proof (state)\nthis:\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "ultimately"], ["proof (chain)\npicking this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof", "have \"(f (P(i := L)), f P) \\<in> P i\" (is ?L)"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof\n\ngoal (1 subgoal):\n 1. f (P(i := L)) <\\<^bsub>P i\\<^esub> f P", "using \\<open>?A\\<close>"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof\n  \\<not> manipulable f\n\ngoal (1 subgoal):\n 1. f (P(i := L)) <\\<^bsub>P i\\<^esub> f P", "unfolding manipulable_def"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof\n  \\<not> (\\<exists>P\\<in>Prof.\n             \\<exists>i.\n                \\<exists>L\\<in>Lin. f P <\\<^bsub>P i\\<^esub> f (P(i := L)))\n\ngoal (1 subgoal):\n 1. f (P(i := L)) <\\<^bsub>P i\\<^esub> f P", "by (metis notin_Lin_iff)"], ["proof (state)\nthis:\n  f (P(i := L)) <\\<^bsub>P i\\<^esub> f P\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "moreover"], ["proof (state)\nthis:\n  f (P(i := L)) <\\<^bsub>P i\\<^esub> f P\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "have \"(f P, f (P(i := L))) \\<in> L\" (is ?R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f P <\\<^bsub>L\\<^esub> f (P(i := L))", "using 0 1 fun_upd_upd[of P] fun_upd_triv[of P] fun_upd_same[of P]"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof\n  P(?x := ?y, ?x := ?z) = P(?x := ?z)\n  P(?x := P ?x) = P\n  (P(?x := ?y)) ?x = ?y\n\ngoal (1 subgoal):\n 1. f P <\\<^bsub>L\\<^esub> f (P(i := L))", "using \\<open>?A\\<close>"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof\n  P(?x := ?y, ?x := ?z) = P(?x := ?z)\n  P(?x := P ?x) = P\n  (P(?x := ?y)) ?x = ?y\n  \\<not> manipulable f\n\ngoal (1 subgoal):\n 1. f P <\\<^bsub>L\\<^esub> f (P(i := L))", "unfolding manipulable_def"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P \\<noteq> f (P(i := L))\n  P i \\<in> Lin\n  P(i := L) \\<in> Prof\n  P(?x := ?y, ?x := ?z) = P(?x := ?z)\n  P(?x := P ?x) = P\n  (P(?x := ?y)) ?x = ?y\n  \\<not> (\\<exists>P\\<in>Prof.\n             \\<exists>i.\n                \\<exists>L\\<in>Lin. f P <\\<^bsub>P i\\<^esub> f (P(i := L)))\n\ngoal (1 subgoal):\n 1. f P <\\<^bsub>L\\<^esub> f (P(i := L))", "by (metis notin_Lin_iff)"], ["proof (state)\nthis:\n  f P <\\<^bsub>L\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P \\<noteq> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                         f P <\\<^bsub>L\\<^esub> f (P(i := L))", "ultimately"], ["proof (chain)\npicking this:\n  f (P(i := L)) <\\<^bsub>P i\\<^esub> f P\n  f P <\\<^bsub>L\\<^esub> f (P(i := L))", "show \"?L \\<and> ?R\""], ["proof (prove)\nusing this:\n  f (P(i := L)) <\\<^bsub>P i\\<^esub> f P\n  f P <\\<^bsub>L\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n    f P <\\<^bsub>L\\<^esub> f (P(i := L))", ".."], ["proof (state)\nthis:\n  f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n  f P <\\<^bsub>L\\<^esub> f (P(i := L))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>P\\<in>Prof.\n     \\<forall>i.\n        \\<forall>L\\<in>Lin.\n           f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n           f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n           f P <\\<^bsub>L\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L)) \\<Longrightarrow>\n    \\<not> manipulable f", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L)) \\<Longrightarrow>\n    \\<not> manipulable f", "assume ?B"], ["proof (state)\nthis:\n  \\<forall>P\\<in>Prof.\n     \\<forall>i.\n        \\<forall>L\\<in>Lin.\n           f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n           f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n           f P <\\<^bsub>L\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. \\<forall>P\\<in>Prof.\n       \\<forall>i.\n          \\<forall>L\\<in>Lin.\n             f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n             f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n             f P <\\<^bsub>L\\<^esub> f (P(i := L)) \\<Longrightarrow>\n    \\<not> manipulable f", "show ?A"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> manipulable f", "proof(clarsimp simp:manipulable_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P <\\<^bsub>P i\\<^esub> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> False", "fix P i L"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P <\\<^bsub>P i\\<^esub> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> False", "assume \"P \\<in> Prof\" \"L \\<in> Lin\" \"(f P, f (P(i := L))) \\<in> P i\""], ["proof (state)\nthis:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P <\\<^bsub>P i\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P <\\<^bsub>P i\\<^esub> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> False", "moreover"], ["proof (state)\nthis:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P <\\<^bsub>P i\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P <\\<^bsub>P i\\<^esub> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> False", "hence \"P i: Lin\""], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P <\\<^bsub>P i\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. P i \\<in> Lin", "by(simp add:Prof_def Pi_def)"], ["proof (state)\nthis:\n  P i \\<in> Lin\n\ngoal (1 subgoal):\n 1. \\<And>P i L.\n       \\<lbrakk>P \\<in> Prof; L \\<in> Lin;\n        f P <\\<^bsub>P i\\<^esub> f (P(i := L))\\<rbrakk>\n       \\<Longrightarrow> False", "ultimately"], ["proof (chain)\npicking this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P <\\<^bsub>P i\\<^esub> f (P(i := L))\n  P i \\<in> Lin", "show False"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P <\\<^bsub>P i\\<^esub> f (P(i := L))\n  P i \\<in> Lin\n\ngoal (1 subgoal):\n 1. False", "using \\<open>?B\\<close>"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  L \\<in> Lin\n  f P <\\<^bsub>P i\\<^esub> f (P(i := L))\n  P i \\<in> Lin\n  \\<forall>P\\<in>Prof.\n     \\<forall>i.\n        \\<forall>L\\<in>Lin.\n           f P \\<noteq> f (P(i := L)) \\<longrightarrow>\n           f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n           f P <\\<^bsub>L\\<^esub> f (P(i := L))\n\ngoal (1 subgoal):\n 1. False", "by(metis Lin_irrefl)"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<not> manipulable f\n\ngoal:\nNo subgoals!", "qed"], ["", "definition \"swf(f) \\<equiv> \\<lambda>P. {(a,b). a\\<noteq>b \\<and> f(Top {a,b} o P) = b}\""], ["", "locale GS =\nfixes f\nassumes not_manip: \"\\<not> manipulable f\"\nand onto: \"f ` Prof = UNIV\"\nbegin"], ["", "lemma nonmanip:\n  \"P:Prof \\<Longrightarrow> L:Lin \\<Longrightarrow> f(P(i := L)) \\<noteq> f P \\<Longrightarrow>\n  (f(P(i := L)), f P) : P i \\<and> (f P, f(P(i := L))) : L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>P \\<in> Prof; L \\<in> Lin; f (P(i := L)) \\<noteq> f P\\<rbrakk>\n    \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                      f P <\\<^bsub>L\\<^esub> f (P(i := L))", "using not_manip"], ["proof (prove)\nusing this:\n  \\<not> manipulable f\n\ngoal (1 subgoal):\n 1. \\<lbrakk>P \\<in> Prof; L \\<in> Lin; f (P(i := L)) \\<noteq> f P\\<rbrakk>\n    \\<Longrightarrow> f (P(i := L)) <\\<^bsub>P i\\<^esub> f P \\<and>\n                      f P <\\<^bsub>L\\<^esub> f (P(i := L))", "by(metis not_manipulable)"], ["", "lemma mono:\nassumes \"P\\<in>Prof\" \"P'\\<in>Prof\" \"\\<forall>i a. (a, f P) : P i \\<longrightarrow> (a, f P) : P' i\"\nshows \"f P' = f P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f P' = f P", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. f P' = f P", "obtain h :: \"indi \\<Rightarrow> nat\" where\n    injh: \"inj h\" and surjh: \"h ` I = {0..<N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>inj h; range h = {0..<N}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(metis ex_bij_betw_finite_nat[OF finite_indi] bij_betw_def)"], ["proof (state)\nthis:\n  inj h\n  range h = {0..<N}\n\ngoal (1 subgoal):\n 1. f P' = f P", "let ?M = \"%n i. if h i < n then P' i else P i\""], ["proof (state)\ngoal (1 subgoal):\n 1. f P' = f P", "have N: \"!!i. h i < N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i. h i < N", "using surjh"], ["proof (prove)\nusing this:\n  range h = {0..<N}\n\ngoal (1 subgoal):\n 1. \\<And>i. h i < N", "by auto"], ["proof (state)\nthis:\n  h ?i < N\n\ngoal (1 subgoal):\n 1. f P' = f P", "have MProf: \"!!n. ?M n : Prof\" and P'Lin: \"!!i. P' i : Lin\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>n. (\\<lambda>i. if h i < n then P' i else P i) \\<in> Prof) &&&\n    (\\<And>i. P' i \\<in> Lin)", "using \\<open>P:Prof\\<close> \\<open>P':Prof\\<close>"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  P' \\<in> Prof\n\ngoal (1 subgoal):\n 1. (\\<And>n. (\\<lambda>i. if h i < n then P' i else P i) \\<in> Prof) &&&\n    (\\<And>i. P' i \\<in> Lin)", "by(simp add:Prof_def Pi_def)+"], ["proof (state)\nthis:\n  (\\<lambda>i. if h i < ?n then P' i else P i) \\<in> Prof\n  P' ?i \\<in> Lin\n\ngoal (1 subgoal):\n 1. f P' = f P", "{"], ["proof (state)\nthis:\n  (\\<lambda>i. if h i < ?n then P' i else P i) \\<in> Prof\n  P' ?i \\<in> Lin\n\ngoal (1 subgoal):\n 1. f P' = f P", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. f P' = f P", "have \"n<=N \\<Longrightarrow> f(?M n) = f P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<le> N \\<Longrightarrow>\n    f (\\<lambda>i. if h i < n then P' i else P i) = f P", "proof(induct n)"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 \\<le> N \\<Longrightarrow>\n    f (\\<lambda>i. if h i < 0 then P' i else P i) = f P\n 2. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then P' i else P i) = f P;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i. if h i < Suc n then P' i else P i) =\n                         f P", "case 0"], ["proof (state)\nthis:\n  0 \\<le> N\n\ngoal (2 subgoals):\n 1. 0 \\<le> N \\<Longrightarrow>\n    f (\\<lambda>i. if h i < 0 then P' i else P i) = f P\n 2. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then P' i else P i) = f P;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i. if h i < Suc n then P' i else P i) =\n                         f P", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < 0 then P' i else P i) = f P", "by simp"], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < 0 then P' i else P i) = f P\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then P' i else P i) = f P;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i. if h i < Suc n then P' i else P i) =\n                         f P", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then P' i else P i) = f P;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i. if h i < Suc n then P' i else P i) =\n                         f P", "case (Suc n)"], ["proof (state)\nthis:\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then P' i else P i) = f P\n  Suc n \\<le> N\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then P' i else P i) = f P;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i. if h i < Suc n then P' i else P i) =\n                         f P", "let ?up = \"(?M n)(inv h n := P' (inv h n))\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then P' i else P i) = f P;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i. if h i < Suc n then P' i else P i) =\n                         f P", "have 1: \"?M(Suc n) = ?up\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>i. if h i < Suc n then P' i else P i) =\n    (\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n))", "using surjh Suc(2)"], ["proof (prove)\nusing this:\n  range h = {0..<N}\n  Suc n \\<le> N\n\ngoal (1 subgoal):\n 1. (\\<lambda>i. if h i < Suc n then P' i else P i) =\n    (\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n))", "by(simp (no_asm_simp) add:fun_eq_iff f_inv_into_f)\n          (metis injh inv_f_f less_antisym)"], ["proof (state)\nthis:\n  (\\<lambda>i. if h i < Suc n then P' i else P i) =\n  (\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then P' i else P i) = f P;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i. if h i < Suc n then P' i else P i) =\n                         f P", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then P' i else P i) = f P", "proof(rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then P' i else P i) \\<noteq>\n    f P \\<Longrightarrow>\n    False", "assume \"\\<not> ?case\""], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < Suc n then P' i else P i) \\<noteq> f P\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then P' i else P i) \\<noteq>\n    f P \\<Longrightarrow>\n    False", "with \\<open>?M(Suc n) = ?up\\<close> Suc"], ["proof (chain)\npicking this:\n  (\\<lambda>i. if h i < Suc n then P' i else P i) =\n  (\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n))\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then P' i else P i) = f P\n  Suc n \\<le> N\n  f (\\<lambda>i. if h i < Suc n then P' i else P i) \\<noteq> f P", "have 0: \"f ?up \\<noteq> f(?M n)\""], ["proof (prove)\nusing this:\n  (\\<lambda>i. if h i < Suc n then P' i else P i) =\n  (\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n))\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then P' i else P i) = f P\n  Suc n \\<le> N\n  f (\\<lambda>i. if h i < Suc n then P' i else P i) \\<noteq> f P\n\ngoal (1 subgoal):\n 1. f ((\\<lambda>i. if h i < n then P' i else P i)\n       (inv h n := P' (inv h n))) \\<noteq>\n    f (\\<lambda>i. if h i < n then P' i else P i)", "by simp"], ["proof (state)\nthis:\n  f ((\\<lambda>i. if h i < n then P' i else P i)\n     (inv h n := P' (inv h n))) \\<noteq>\n  f (\\<lambda>i. if h i < n then P' i else P i)\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then P' i else P i) \\<noteq>\n    f P \\<Longrightarrow>\n    False", "from nonmanip[OF MProf P'Lin 0] assms(3)"], ["proof (chain)\npicking this:\n  f ((\\<lambda>i. if h i < n then P' i else P i)\n     (inv h n :=\n        P' (inv h\n             n))) <\\<^bsub>(if h (inv h n) < n then P' (inv h n)\n                            else P (inv h\n                                     n))\\<^esub> f\n            (\\<lambda>i. if h i < n then P' i else P i) \\<and>\n  f (\\<lambda>i.\n        if h i < n then P' i\n        else P i) <\\<^bsub>P' (inv h\n                                n)\\<^esub> f\n      ((\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n)))\n  \\<forall>i a.\n     a <\\<^bsub>P i\\<^esub> f P \\<longrightarrow>\n     a <\\<^bsub>P' i\\<^esub> f P", "show False"], ["proof (prove)\nusing this:\n  f ((\\<lambda>i. if h i < n then P' i else P i)\n     (inv h n :=\n        P' (inv h\n             n))) <\\<^bsub>(if h (inv h n) < n then P' (inv h n)\n                            else P (inv h\n                                     n))\\<^esub> f\n            (\\<lambda>i. if h i < n then P' i else P i) \\<and>\n  f (\\<lambda>i.\n        if h i < n then P' i\n        else P i) <\\<^bsub>P' (inv h\n                                n)\\<^esub> f\n      ((\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n)))\n  \\<forall>i a.\n     a <\\<^bsub>P i\\<^esub> f P \\<longrightarrow>\n     a <\\<^bsub>P' i\\<^esub> f P\n\ngoal (1 subgoal):\n 1. False", "using N surjh Suc Lin_irrefl[OF P'Lin]"], ["proof (prove)\nusing this:\n  f ((\\<lambda>i. if h i < n then P' i else P i)\n     (inv h n :=\n        P' (inv h\n             n))) <\\<^bsub>(if h (inv h n) < n then P' (inv h n)\n                            else P (inv h\n                                     n))\\<^esub> f\n            (\\<lambda>i. if h i < n then P' i else P i) \\<and>\n  f (\\<lambda>i.\n        if h i < n then P' i\n        else P i) <\\<^bsub>P' (inv h\n                                n)\\<^esub> f\n      ((\\<lambda>i. if h i < n then P' i else P i)(inv h n := P' (inv h n)))\n  \\<forall>i a.\n     a <\\<^bsub>P i\\<^esub> f P \\<longrightarrow>\n     a <\\<^bsub>P' i\\<^esub> f P\n  h ?i < N\n  range h = {0..<N}\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then P' i else P i) = f P\n  Suc n \\<le> N\n  \\<lbrakk>?a <\\<^bsub>P' ?i1\\<^esub> ?b;\n   ?b <\\<^bsub>P' ?i1\\<^esub> ?a\\<rbrakk>\n  \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. False", "by(fastforce simp: f_inv_into_f)"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < Suc n then P' i else P i) = f P\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then P' i else P i) = f P\n\ngoal (1 subgoal):\n 1. f P' = f P", "}"], ["proof (state)\nthis:\n  ?n2 \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < ?n2 then P' i else P i) = f P\n\ngoal (1 subgoal):\n 1. f P' = f P", "from this[of N] N"], ["proof (chain)\npicking this:\n  N \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < N then P' i else P i) = f P\n  h ?i < N", "show \"f P' = f P\""], ["proof (prove)\nusing this:\n  N \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < N then P' i else P i) = f P\n  h ?i < N\n\ngoal (1 subgoal):\n 1. f P' = f P", "by simp"], ["proof (state)\nthis:\n  f P' = f P\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma una_Top: assumes \"P:Prof\" \"S \\<noteq> {}\" shows \"f(Top S o P) : S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "obtain h :: \"indi \\<Rightarrow> nat\" where\n    injh: \"inj h\" and surjh: \"h ` I = {0..<N}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>h.\n        \\<lbrakk>inj h; range h = {0..<N}\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(metis ex_bij_betw_finite_nat[OF finite_indi] bij_betw_def)"], ["proof (state)\nthis:\n  inj h\n  range h = {0..<N}\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "from assms"], ["proof (chain)\npicking this:\n  P \\<in> Prof\n  S \\<noteq> {}", "obtain a where \"a:S\""], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  S \\<noteq> {}\n\ngoal (1 subgoal):\n 1. (\\<And>a. a \\<in> S \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by blast"], ["proof (state)\nthis:\n  a \\<in> S\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "from onto"], ["proof (chain)\npicking this:\n  f ` Prof = UNIV", "obtain Pa where \"Pa:Prof\" \"f Pa = a\""], ["proof (prove)\nusing this:\n  f ` Prof = UNIV\n\ngoal (1 subgoal):\n 1. (\\<And>Pa.\n        \\<lbrakk>Pa \\<in> Prof; f Pa = a\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by(metis inv_into_into UNIV_I f_inv_into_f)"], ["proof (state)\nthis:\n  Pa \\<in> Prof\n  f Pa = a\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "let ?M = \"%n i. if h i < n then Top S (P i) else Pa i\""], ["proof (state)\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "have N: \"!!i. h i < N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i. h i < N", "using surjh"], ["proof (prove)\nusing this:\n  range h = {0..<N}\n\ngoal (1 subgoal):\n 1. \\<And>i. h i < N", "by auto"], ["proof (state)\nthis:\n  h ?i < N\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "have MProf: \"!!n. ?M n : Prof\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n. (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> Prof", "using \\<open>P:Prof\\<close> \\<open>Pa:Prof\\<close>"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  Pa \\<in> Prof\n\ngoal (1 subgoal):\n 1. \\<And>n. (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> Prof", "by(simp add:Prof_def Pi_def Top_in_Lin mktop_Lin)"], ["proof (state)\nthis:\n  (\\<lambda>i. if h i < ?n then Top S (P i) else Pa i) \\<in> Prof\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "{"], ["proof (state)\nthis:\n  (\\<lambda>i. if h i < ?n then Top S (P i) else Pa i) \\<in> Prof\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "fix n"], ["proof (state)\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "have \"n<=N \\<Longrightarrow> f(?M n) : S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<le> N \\<Longrightarrow>\n    f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> S", "proof(induct n)"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 \\<le> N \\<Longrightarrow>\n    f (\\<lambda>i. if h i < 0 then Top S (P i) else Pa i) \\<in> S\n 2. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n                \\<in> S;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i.\n                               if h i < Suc n then Top S (P i) else Pa i)\n                         \\<in> S", "case 0"], ["proof (state)\nthis:\n  0 \\<le> N\n\ngoal (2 subgoals):\n 1. 0 \\<le> N \\<Longrightarrow>\n    f (\\<lambda>i. if h i < 0 then Top S (P i) else Pa i) \\<in> S\n 2. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n                \\<in> S;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i.\n                               if h i < Suc n then Top S (P i) else Pa i)\n                         \\<in> S", "thus ?case"], ["proof (prove)\nusing this:\n  0 \\<le> N\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < 0 then Top S (P i) else Pa i) \\<in> S", "using \\<open>f Pa = a\\<close> \\<open>a:S\\<close>"], ["proof (prove)\nusing this:\n  0 \\<le> N\n  f Pa = a\n  a \\<in> S\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < 0 then Top S (P i) else Pa i) \\<in> S", "by simp"], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < 0 then Top S (P i) else Pa i) \\<in> S\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n                \\<in> S;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i.\n                               if h i < Suc n then Top S (P i) else Pa i)\n                         \\<in> S", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n                \\<in> S;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i.\n                               if h i < Suc n then Top S (P i) else Pa i)\n                         \\<in> S", "case (Suc n)"], ["proof (state)\nthis:\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> S\n  Suc n \\<le> N\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>n \\<le> N \\<Longrightarrow>\n                f (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n                \\<in> S;\n        Suc n \\<le> N\\<rbrakk>\n       \\<Longrightarrow> f (\\<lambda>i.\n                               if h i < Suc n then Top S (P i) else Pa i)\n                         \\<in> S", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S\n 2. \\<not> ?P \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "assume \"f(?M n) = f(?M(Suc n))\""], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) =\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i)\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S\n 2. \\<not> ?P \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "thus ?case"], ["proof (prove)\nusing this:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) =\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i)\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "using Suc"], ["proof (prove)\nusing this:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) =\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i)\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> S\n  Suc n \\<le> N\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "by simp"], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f (\\<lambda>i.\n          if h i < Suc n then Top S (P i) else Pa i) \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f (\\<lambda>i.\n          if h i < Suc n then Top S (P i) else Pa i) \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "let ?up = \"(?M n)(inv h n := Top S (P(inv h n)))\""], ["proof (state)\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f (\\<lambda>i.\n          if h i < Suc n then Top S (P i) else Pa i) \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "assume \"f(?M n) \\<noteq> f(?M(Suc n))\""], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i)\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f (\\<lambda>i.\n          if h i < Suc n then Top S (P i) else Pa i) \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "also"], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i)\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f (\\<lambda>i.\n          if h i < Suc n then Top S (P i) else Pa i) \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "have eq: \"?M(Suc n) = ?up\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) =\n    (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n    (inv h n := Top S (P (inv h n)))", "using surjh Suc"], ["proof (prove)\nusing this:\n  range h = {0..<N}\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> S\n  Suc n \\<le> N\n\ngoal (1 subgoal):\n 1. (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) =\n    (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n    (inv h n := Top S (P (inv h n)))", "by(simp (no_asm_simp) add:fun_eq_iff f_inv_into_f)\n            (metis injh inv_f_eq less_antisym)"], ["proof (state)\nthis:\n  (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) =\n  (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n  (inv h n := Top S (P (inv h n)))\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f (\\<lambda>i.\n          if h i < Suc n then Top S (P i) else Pa i) \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "finally"], ["proof (chain)\npicking this:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n  f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n     (inv h n := Top S (P (inv h n))))", "have n: \"f(?M n) \\<noteq> f(?up)\""], ["proof (prove)\nusing this:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n  f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n     (inv h n := Top S (P (inv h n))))\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n       (inv h n := Top S (P (inv h n))))", "."], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n  f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n     (inv h n := Top S (P (inv h n))))\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n    f (\\<lambda>i.\n          if h i < Suc n then Top S (P i) else Pa i) \\<Longrightarrow>\n    f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "with nonmanip[OF MProf Top_in_Lin n[symmetric]] Suc eq \\<open>P:Prof\\<close>"], ["proof (chain)\npicking this:\n  P (inv h n) \\<in> Lin \\<Longrightarrow>\n  f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n     (inv h n :=\n        Top S\n         (P (inv h\n              n)))) <\\<^bsub>(if h (inv h n) < n then Top S (P (inv h n))\n                              else Pa (inv h\n  n))\\<^esub> f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<and>\n  f (\\<lambda>i.\n        if h i < n then Top S (P i)\n        else Pa i) <\\<^bsub>Top S\n                             (P (inv h\n                                  n))\\<^esub> f\n         ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n          (inv h n := Top S (P (inv h n))))\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> S\n  Suc n \\<le> N\n  (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) =\n  (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n  (inv h n := Top S (P (inv h n)))\n  P \\<in> Prof\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n  f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n     (inv h n := Top S (P (inv h n))))", "show ?case"], ["proof (prove)\nusing this:\n  P (inv h n) \\<in> Lin \\<Longrightarrow>\n  f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n     (inv h n :=\n        Top S\n         (P (inv h\n              n)))) <\\<^bsub>(if h (inv h n) < n then Top S (P (inv h n))\n                              else Pa (inv h\n  n))\\<^esub> f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<and>\n  f (\\<lambda>i.\n        if h i < n then Top S (P i)\n        else Pa i) <\\<^bsub>Top S\n                             (P (inv h\n                                  n))\\<^esub> f\n         ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n          (inv h n := Top S (P (inv h n))))\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> S\n  Suc n \\<le> N\n  (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) =\n  (\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n  (inv h n := Top S (P (inv h n)))\n  P \\<in> Prof\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<noteq>\n  f ((\\<lambda>i. if h i < n then Top S (P i) else Pa i)\n     (inv h n := Top S (P (inv h n))))\n\ngoal (1 subgoal):\n 1. f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S", "by (simp add:Top_def Prof_def Pi_def)"], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f (\\<lambda>i. if h i < Suc n then Top S (P i) else Pa i) \\<in> S\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  n \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < n then Top S (P i) else Pa i) \\<in> S\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "}"], ["proof (state)\nthis:\n  ?n2 \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < ?n2 then Top S (P i) else Pa i) \\<in> S\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "from this[of N] N"], ["proof (chain)\npicking this:\n  N \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < N then Top S (P i) else Pa i) \\<in> S\n  h ?i < N", "show ?thesis"], ["proof (prove)\nusing this:\n  N \\<le> N \\<Longrightarrow>\n  f (\\<lambda>i. if h i < N then Top S (P i) else Pa i) \\<in> S\n  h ?i < N\n\ngoal (1 subgoal):\n 1. f (Top S \\<circ> P) \\<in> S", "by(simp add:comp_def)"], ["proof (state)\nthis:\n  f (Top S \\<circ> P) \\<in> S\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma SWF_swf: \"swf f : SWF\""], ["proof (prove)\ngoal (1 subgoal):\n 1. swf f \\<in> SWF", "proof (rule Pi_I)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> Prof \\<Longrightarrow> swf f x \\<in> Lin", "fix P"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> Prof \\<Longrightarrow> swf f x \\<in> Lin", "assume \"P: Prof\""], ["proof (state)\nthis:\n  P \\<in> Prof\n\ngoal (1 subgoal):\n 1. \\<And>x. x \\<in> Prof \\<Longrightarrow> swf f x \\<in> Lin", "show \"swf f P : Lin\""], ["proof (prove)\ngoal (1 subgoal):\n 1. swf f P \\<in> Lin", "proof(unfold Lin_def strict_linear_order_on_def, auto)"], ["proof (state)\ngoal (3 subgoals):\n 1. trans (swf f P)\n 2. irrefl (swf f P)\n 3. total (swf f P)", "show \"total(swf f P)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. total (swf f P)", "proof(simp add: total_on_def, intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       x \\<noteq> y \\<Longrightarrow>\n       x <\\<^bsub>swf f P\\<^esub> y \\<or> y <\\<^bsub>swf f P\\<^esub> x", "fix a b :: alt"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       x \\<noteq> y \\<Longrightarrow>\n       x <\\<^bsub>swf f P\\<^esub> y \\<or> y <\\<^bsub>swf f P\\<^esub> x", "assume \"a\\<noteq>b\""], ["proof (state)\nthis:\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. \\<And>x y.\n       x \\<noteq> y \\<Longrightarrow>\n       x <\\<^bsub>swf f P\\<^esub> y \\<or> y <\\<^bsub>swf f P\\<^esub> x", "thus \"(a,b) \\<in> swf f P \\<or> (b,a) \\<in> swf f P\""], ["proof (prove)\nusing this:\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. a <\\<^bsub>swf f P\\<^esub> b \\<or> b <\\<^bsub>swf f P\\<^esub> a", "unfolding swf_def"], ["proof (prove)\nusing this:\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. a <\\<^bsub>{(a, b).\n                a \\<noteq> b \\<and>\n                f (Top {a, b} \\<circ> P) = b}\\<^esub> b \\<or>\n    b <\\<^bsub>{(a, b).\n                a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}\\<^esub> a", "using una_Top[of P \"{a,b}\"] \\<open>P:Prof\\<close>"], ["proof (prove)\nusing this:\n  a \\<noteq> b\n  \\<lbrakk>P \\<in> Prof; {a, b} \\<noteq> {}\\<rbrakk>\n  \\<Longrightarrow> f (Top {a, b} \\<circ> P) \\<in> {a, b}\n  P \\<in> Prof\n\ngoal (1 subgoal):\n 1. a <\\<^bsub>{(a, b).\n                a \\<noteq> b \\<and>\n                f (Top {a, b} \\<circ> P) = b}\\<^esub> b \\<or>\n    b <\\<^bsub>{(a, b).\n                a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}\\<^esub> a", "by simp(metis insert_commute)"], ["proof (state)\nthis:\n  a <\\<^bsub>swf f P\\<^esub> b \\<or> b <\\<^bsub>swf f P\\<^esub> a\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  total (swf f P)\n\ngoal (2 subgoals):\n 1. trans (swf f P)\n 2. irrefl (swf f P)", "show \"irrefl(swf f P)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. irrefl (swf f P)", "by(simp add: irrefl_def swf_def)"], ["proof (state)\nthis:\n  irrefl (swf f P)\n\ngoal (1 subgoal):\n 1. trans (swf f P)", "show \"trans(swf f P)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. trans (swf f P)", "proof (clarsimp simp:trans_def swf_def insert_commute)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "fix a b c"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "assume \"a\\<noteq>b\" \"b\\<noteq>c\" \"f(Top{a,b} \\<circ> P) = b\" \"f(Top{b,c} \\<circ> P) = c\""], ["proof (state)\nthis:\n  a \\<noteq> b\n  b \\<noteq> c\n  f (Top {a, b} \\<circ> P) = b\n  f (Top {b, c} \\<circ> P) = c\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "hence \"a\\<noteq>c\""], ["proof (prove)\nusing this:\n  a \\<noteq> b\n  b \\<noteq> c\n  f (Top {a, b} \\<circ> P) = b\n  f (Top {b, c} \\<circ> P) = c\n\ngoal (1 subgoal):\n 1. a \\<noteq> c", "by(auto simp: insert_commute)"], ["proof (state)\nthis:\n  a \\<noteq> c\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "note 3 = Top_in_Prof[OF \\<open>P:Prof\\<close>, of \"{a,b,c}\"]"], ["proof (state)\nthis:\n  Top {a, b, c} \\<circ> P \\<in> Prof\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "{"], ["proof (state)\nthis:\n  Top {a, b, c} \\<circ> P \\<in> Prof\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "assume \"f (Top {a, b, c} \\<circ> P) = a\""], ["proof (state)\nthis:\n  f (Top {a, b, c} \\<circ> P) = a\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "hence \"f(Top{a,b} \\<circ> P) = a\""], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = a\n\ngoal (1 subgoal):\n 1. f (Top {a, b} \\<circ> P) = a", "using mono[OF 3 Top_in_Prof[OF \\<open>P:Prof\\<close>], of \"{a,b}\"]"], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = a\n  \\<forall>i aa.\n     aa <\\<^bsub>(Top {a, b, c} \\<circ> P)\n                  i\\<^esub> f (Top {a, b, c} \\<circ> P) \\<longrightarrow>\n     aa <\\<^bsub>(Top {a, b} \\<circ> P)\n                  i\\<^esub> f (Top {a, b, c} \\<circ> P) \\<Longrightarrow>\n  f (Top {a, b} \\<circ> P) = f (Top {a, b, c} \\<circ> P)\n\ngoal (1 subgoal):\n 1. f (Top {a, b} \\<circ> P) = a", "by(auto simp:Top_def)"], ["proof (state)\nthis:\n  f (Top {a, b} \\<circ> P) = a\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "with \\<open>f(Top{a,b} \\<circ> P) = b\\<close> \\<open>a\\<noteq>b\\<close>"], ["proof (chain)\npicking this:\n  f (Top {a, b} \\<circ> P) = b\n  a \\<noteq> b\n  f (Top {a, b} \\<circ> P) = a", "have False"], ["proof (prove)\nusing this:\n  f (Top {a, b} \\<circ> P) = b\n  a \\<noteq> b\n  f (Top {a, b} \\<circ> P) = a\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "}"], ["proof (state)\nthis:\n  f (Top {a, b, c} \\<circ> P) = a \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "moreover"], ["proof (state)\nthis:\n  f (Top {a, b, c} \\<circ> P) = a \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "{"], ["proof (state)\nthis:\n  f (Top {a, b, c} \\<circ> P) = a \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "assume \"f (Top {a, b, c} \\<circ> P) = b\""], ["proof (state)\nthis:\n  f (Top {a, b, c} \\<circ> P) = b\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "hence \"f(Top{b,c} \\<circ> P) = b\""], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = b\n\ngoal (1 subgoal):\n 1. f (Top {b, c} \\<circ> P) = b", "using mono[OF 3 Top_in_Prof[OF \\<open>P:Prof\\<close>], of \"{b,c}\"]"], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = b\n  \\<forall>i aa.\n     aa <\\<^bsub>(Top {a, b, c} \\<circ> P)\n                  i\\<^esub> f (Top {a, b, c} \\<circ> P) \\<longrightarrow>\n     aa <\\<^bsub>(Top {b, c} \\<circ> P)\n                  i\\<^esub> f (Top {a, b, c} \\<circ> P) \\<Longrightarrow>\n  f (Top {b, c} \\<circ> P) = f (Top {a, b, c} \\<circ> P)\n\ngoal (1 subgoal):\n 1. f (Top {b, c} \\<circ> P) = b", "by(auto simp:Top_def)"], ["proof (state)\nthis:\n  f (Top {b, c} \\<circ> P) = b\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "with \\<open>f(Top{b,c} \\<circ> P) = c\\<close> \\<open>b\\<noteq>c\\<close>"], ["proof (chain)\npicking this:\n  f (Top {b, c} \\<circ> P) = c\n  b \\<noteq> c\n  f (Top {b, c} \\<circ> P) = b", "have False"], ["proof (prove)\nusing this:\n  f (Top {b, c} \\<circ> P) = c\n  b \\<noteq> c\n  f (Top {b, c} \\<circ> P) = b\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "}"], ["proof (state)\nthis:\n  f (Top {a, b, c} \\<circ> P) = b \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "ultimately"], ["proof (chain)\npicking this:\n  f (Top {a, b, c} \\<circ> P) = a \\<Longrightarrow> False\n  f (Top {a, b, c} \\<circ> P) = b \\<Longrightarrow> False", "have \"f (Top {a, b, c} \\<circ> P) = c\""], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = a \\<Longrightarrow> False\n  f (Top {a, b, c} \\<circ> P) = b \\<Longrightarrow> False\n\ngoal (1 subgoal):\n 1. f (Top {a, b, c} \\<circ> P) = c", "using una_Top[OF \\<open>P:Prof\\<close>, of \"{a,b,c}\", simplified]"], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = a \\<Longrightarrow> False\n  f (Top {a, b, c} \\<circ> P) = b \\<Longrightarrow> False\n  f (Top {a, b, c} \\<circ> P) = a \\<or>\n  f (Top {a, b, c} \\<circ> P) = b \\<or> f (Top {a, b, c} \\<circ> P) = c\n\ngoal (1 subgoal):\n 1. f (Top {a, b, c} \\<circ> P) = c", "by blast"], ["proof (state)\nthis:\n  f (Top {a, b, c} \\<circ> P) = c\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "hence \"f(Top{a,c} \\<circ> P) = c\" (is ?R)"], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = c\n\ngoal (1 subgoal):\n 1. f (Top {a, c} \\<circ> P) = c", "using mono[OF 3 Top_in_Prof[OF \\<open>P:Prof\\<close>], of \"{a,c}\"]"], ["proof (prove)\nusing this:\n  f (Top {a, b, c} \\<circ> P) = c\n  \\<forall>i aa.\n     aa <\\<^bsub>(Top {a, b, c} \\<circ> P)\n                  i\\<^esub> f (Top {a, b, c} \\<circ> P) \\<longrightarrow>\n     aa <\\<^bsub>(Top {a, c} \\<circ> P)\n                  i\\<^esub> f (Top {a, b, c} \\<circ> P) \\<Longrightarrow>\n  f (Top {a, c} \\<circ> P) = f (Top {a, b, c} \\<circ> P)\n\ngoal (1 subgoal):\n 1. f (Top {a, c} \\<circ> P) = c", "by (auto simp:Top_def)"], ["proof (state)\nthis:\n  f (Top {a, c} \\<circ> P) = c\n\ngoal (1 subgoal):\n 1. \\<And>x y z.\n       \\<lbrakk>x \\<noteq> y; f (Top {x, y} \\<circ> P) = y; y \\<noteq> z;\n        f (Top {y, z} \\<circ> P) = z\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> z \\<and> f (Top {x, z} \\<circ> P) = z", "thus \"a\\<noteq>c \\<and> ?R\""], ["proof (prove)\nusing this:\n  f (Top {a, c} \\<circ> P) = c\n\ngoal (1 subgoal):\n 1. a \\<noteq> c \\<and> f (Top {a, c} \\<circ> P) = c", "using \\<open>a\\<noteq>c\\<close>"], ["proof (prove)\nusing this:\n  f (Top {a, c} \\<circ> P) = c\n  a \\<noteq> c\n\ngoal (1 subgoal):\n 1. a \\<noteq> c \\<and> f (Top {a, c} \\<circ> P) = c", "by blast"], ["proof (state)\nthis:\n  a \\<noteq> c \\<and> f (Top {a, c} \\<circ> P) = c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  trans (swf f P)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  swf f P \\<in> Lin\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Top_top: \"L:Lin \\<Longrightarrow> (!!a. a\\<noteq>b \\<Longrightarrow> (a,b) : L) \\<Longrightarrow> Top {b} L = L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>L \\<in> Lin;\n     \\<And>a. a \\<noteq> b \\<Longrightarrow> a <\\<^bsub>L\\<^esub> b\\<rbrakk>\n    \\<Longrightarrow> Top {b} L = L", "apply(auto simp:Top_def slo_defs)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ba.\n       \\<lbrakk>\\<And>a.\n                   a \\<noteq> b \\<Longrightarrow> a <\\<^bsub>L\\<^esub> b;\n        trans L; \\<forall>a. (a, a) \\<notin> L;\n        \\<forall>x y.\n           x \\<noteq> y \\<longrightarrow>\n           x <\\<^bsub>L\\<^esub> y \\<or> y <\\<^bsub>L\\<^esub> x;\n        b <\\<^bsub>L\\<^esub> ba\\<rbrakk>\n       \\<Longrightarrow> ba = b\n 2. \\<And>ba.\n       \\<lbrakk>\\<And>a.\n                   a \\<noteq> b \\<Longrightarrow> a <\\<^bsub>L\\<^esub> b;\n        trans L; \\<forall>a. (a, a) \\<notin> L;\n        \\<forall>x y.\n           x \\<noteq> y \\<longrightarrow>\n           x <\\<^bsub>L\\<^esub> y \\<or> y <\\<^bsub>L\\<^esub> x;\n        b <\\<^bsub>L\\<^esub> ba; ba \\<noteq> b\\<rbrakk>\n       \\<Longrightarrow> False", "apply (metis trans_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ba.\n       \\<lbrakk>\\<And>a.\n                   a \\<noteq> b \\<Longrightarrow> a <\\<^bsub>L\\<^esub> b;\n        trans L; \\<forall>a. (a, a) \\<notin> L;\n        \\<forall>x y.\n           x \\<noteq> y \\<longrightarrow>\n           x <\\<^bsub>L\\<^esub> y \\<or> y <\\<^bsub>L\\<^esub> x;\n        b <\\<^bsub>L\\<^esub> ba; ba \\<noteq> b\\<rbrakk>\n       \\<Longrightarrow> False", "apply (metis trans_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma una_swf: \"unanimity(swf f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unanimity (swf f)", "proof(clarsimp simp:swf_def unanimity_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "fix P a b"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "assume \"P:Prof\" and abP: \"\\<forall>i. (a, b) \\<in> P i\""], ["proof (state)\nthis:\n  P \\<in> Prof\n  \\<forall>i. a <\\<^bsub>P i\\<^esub> b\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "hence \"a \\<noteq> b\""], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  \\<forall>i. a <\\<^bsub>P i\\<^esub> b\n\ngoal (1 subgoal):\n 1. a \\<noteq> b", "by(fastforce simp:Prof_def Pi_def slo_defs)"], ["proof (state)\nthis:\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "let ?abP = \"Top {a,b} \\<circ> P\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "have \"?abP : Prof\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Top {a, b} \\<circ> P \\<in> Prof", "using \\<open>P:Prof\\<close>"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n\ngoal (1 subgoal):\n 1. Top {a, b} \\<circ> P \\<in> Prof", "by(simp add:Prof_def Pi_def Top_in_Lin)"], ["proof (state)\nthis:\n  Top {a, b} \\<circ> P \\<in> Prof\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "have top: \"!!i c. b\\<noteq>c \\<Longrightarrow> (c,b) : Top {a,b} (P i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i c.\n       b \\<noteq> c \\<Longrightarrow> c <\\<^bsub>Top {a, b} (P i)\\<^esub> b", "using abP"], ["proof (prove)\nusing this:\n  \\<forall>i. a <\\<^bsub>P i\\<^esub> b\n\ngoal (1 subgoal):\n 1. \\<And>i c.\n       b \\<noteq> c \\<Longrightarrow> c <\\<^bsub>Top {a, b} (P i)\\<^esub> b", "by(auto simp:Top_def)"], ["proof (state)\nthis:\n  b \\<noteq> ?c \\<Longrightarrow> ?c <\\<^bsub>Top {a, b} (P ?i)\\<^esub> b\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "have \"Top {b} o ?abP = ?abP\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Top {b} \\<circ> (Top {a, b} \\<circ> P) = Top {a, b} \\<circ> P", "using \\<open>P:Prof\\<close>"], ["proof (prove)\nusing this:\n  P \\<in> Prof\n\ngoal (1 subgoal):\n 1. Top {b} \\<circ> (Top {a, b} \\<circ> P) = Top {a, b} \\<circ> P", "by (simp add:fun_eq_iff top Top_top Prof_def Pi_def Top_in_Lin)"], ["proof (state)\nthis:\n  Top {b} \\<circ> (Top {a, b} \\<circ> P) = Top {a, b} \\<circ> P\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "moreover"], ["proof (state)\nthis:\n  Top {b} \\<circ> (Top {a, b} \\<circ> P) = Top {a, b} \\<circ> P\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "have \"f(Top {b} o ?abP) = b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (Top {b} \\<circ> (Top {a, b} \\<circ> P)) = b", "by (metis una_Top[OF \\<open>?abP : Prof\\<close>] empty_not_insert singletonE)"], ["proof (state)\nthis:\n  f (Top {b} \\<circ> (Top {a, b} \\<circ> P)) = b\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "ultimately"], ["proof (chain)\npicking this:\n  Top {b} \\<circ> (Top {a, b} \\<circ> P) = Top {a, b} \\<circ> P\n  f (Top {b} \\<circ> (Top {a, b} \\<circ> P)) = b", "have \"f ?abP = b\""], ["proof (prove)\nusing this:\n  Top {b} \\<circ> (Top {a, b} \\<circ> P) = Top {a, b} \\<circ> P\n  f (Top {b} \\<circ> (Top {a, b} \\<circ> P)) = b\n\ngoal (1 subgoal):\n 1. f (Top {a, b} \\<circ> P) = b", "by simp"], ["proof (state)\nthis:\n  f (Top {a, b} \\<circ> P) = b\n\ngoal (1 subgoal):\n 1. \\<And>P a b.\n       \\<lbrakk>P \\<in> Prof; \\<forall>i. a <\\<^bsub>P i\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "thus \"a\\<noteq>b \\<and> f ?abP = b\""], ["proof (prove)\nusing this:\n  f (Top {a, b} \\<circ> P) = b\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "using \\<open>a\\<noteq>b\\<close>"], ["proof (prove)\nusing this:\n  f (Top {a, b} \\<circ> P) = b\n  a \\<noteq> b\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b", "by blast"], ["proof (state)\nthis:\n  a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma IIA_swf: \"IIA(swf f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. IIA (swf f)", "proof(clarsimp simp: IIA_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "fix P P' a b"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "assume \"P:Prof\" \"P':Prof\" and iff: \"\\<forall>i. ((a,b) \\<in> P i) = ((a,b) \\<in> P' i)\""], ["proof (state)\nthis:\n  P \\<in> Prof\n  P' \\<in> Prof\n  \\<forall>i. (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\n\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "hence [simp]: \"!!i x. (x,x) ~: P i \\<and> (x,x) ~: P' i\""], ["proof (prove)\nusing this:\n  P \\<in> Prof\n  P' \\<in> Prof\n  \\<forall>i. (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\n\ngoal (1 subgoal):\n 1. \\<And>i x. (x, x) \\<notin> P i \\<and> (x, x) \\<notin> P' i", "by(simp add:Prof_def Pi_def slo_defs)"], ["proof (state)\nthis:\n  (?x, ?x) \\<notin> P ?i \\<and> (?x, ?x) \\<notin> P' ?i\n\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "have iff':  \"a\\<noteq>b \\<longrightarrow> (\\<forall>i. ((b,a) \\<in> P i) = ((b,a) \\<in> P' i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<longrightarrow>\n    (\\<forall>i. (b <\\<^bsub>P i\\<^esub> a) = (b <\\<^bsub>P' i\\<^esub> a))", "using iff \\<open>P:Prof\\<close> \\<open>P':Prof\\<close>"], ["proof (prove)\nusing this:\n  \\<forall>i. (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\n  P \\<in> Prof\n  P' \\<in> Prof\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<longrightarrow>\n    (\\<forall>i. (b <\\<^bsub>P i\\<^esub> a) = (b <\\<^bsub>P' i\\<^esub> a))", "unfolding Prof_def Pi_def"], ["proof (prove)\nusing this:\n  \\<forall>i. (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\n  P \\<in> {f. \\<forall>x. x \\<in> I \\<longrightarrow> f x \\<in> Lin}\n  P' \\<in> {f. \\<forall>x. x \\<in> I \\<longrightarrow> f x \\<in> Lin}\n\ngoal (1 subgoal):\n 1. a \\<noteq> b \\<longrightarrow>\n    (\\<forall>i. (b <\\<^bsub>P i\\<^esub> a) = (b <\\<^bsub>P' i\\<^esub> a))", "by simp (metis iff notin_Lin_iff)"], ["proof (state)\nthis:\n  a \\<noteq> b \\<longrightarrow>\n  (\\<forall>i. (b <\\<^bsub>P i\\<^esub> a) = (b <\\<^bsub>P' i\\<^esub> a))\n\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "let ?abP = \"Top {a,b} o P\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "let ?abP' = \"Top {a,b} o P'\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "have \"\\<forall>i c. (c, f ?abP) : ?abP i \\<longrightarrow> (c, f ?abP) : ?abP' i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i c.\n       c <\\<^bsub>(Top {a, b} \\<circ> P)\n                   i\\<^esub> f (Top {a, b} \\<circ> P) \\<longrightarrow>\n       c <\\<^bsub>(Top {a, b} \\<circ> P') i\\<^esub> f (Top {a, b} \\<circ> P)", "using una_Top[of P \"{a,b}\", OF \\<open>P:Prof\\<close>] iff iff'"], ["proof (prove)\nusing this:\n  {a, b} \\<noteq> {} \\<Longrightarrow> f (Top {a, b} \\<circ> P) \\<in> {a, b}\n  \\<forall>i. (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\n  a \\<noteq> b \\<longrightarrow>\n  (\\<forall>i. (b <\\<^bsub>P i\\<^esub> a) = (b <\\<^bsub>P' i\\<^esub> a))\n\ngoal (1 subgoal):\n 1. \\<forall>i c.\n       c <\\<^bsub>(Top {a, b} \\<circ> P)\n                   i\\<^esub> f (Top {a, b} \\<circ> P) \\<longrightarrow>\n       c <\\<^bsub>(Top {a, b} \\<circ> P') i\\<^esub> f (Top {a, b} \\<circ> P)", "by(auto simp add:Top_def)"], ["proof (state)\nthis:\n  \\<forall>i c.\n     c <\\<^bsub>(Top {a, b} \\<circ> P)\n                 i\\<^esub> f (Top {a, b} \\<circ> P) \\<longrightarrow>\n     c <\\<^bsub>(Top {a, b} \\<circ> P') i\\<^esub> f (Top {a, b} \\<circ> P)\n\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "then"], ["proof (chain)\npicking this:\n  \\<forall>i c.\n     c <\\<^bsub>(Top {a, b} \\<circ> P)\n                 i\\<^esub> f (Top {a, b} \\<circ> P) \\<longrightarrow>\n     c <\\<^bsub>(Top {a, b} \\<circ> P') i\\<^esub> f (Top {a, b} \\<circ> P)", "have \"f (Top {a,b} \\<circ> P) = f (Top {a,b} \\<circ> P')\""], ["proof (prove)\nusing this:\n  \\<forall>i c.\n     c <\\<^bsub>(Top {a, b} \\<circ> P)\n                 i\\<^esub> f (Top {a, b} \\<circ> P) \\<longrightarrow>\n     c <\\<^bsub>(Top {a, b} \\<circ> P') i\\<^esub> f (Top {a, b} \\<circ> P)\n\ngoal (1 subgoal):\n 1. f (Top {a, b} \\<circ> P) = f (Top {a, b} \\<circ> P')", "using Top_in_Prof[OF \\<open>P:Prof\\<close>] Top_in_Prof[OF \\<open>P':Prof\\<close>]\n          mono[of \"Top {a, b} \\<circ> P\"]"], ["proof (prove)\nusing this:\n  \\<forall>i c.\n     c <\\<^bsub>(Top {a, b} \\<circ> P)\n                 i\\<^esub> f (Top {a, b} \\<circ> P) \\<longrightarrow>\n     c <\\<^bsub>(Top {a, b} \\<circ> P') i\\<^esub> f (Top {a, b} \\<circ> P)\n  Top ?S \\<circ> P \\<in> Prof\n  Top ?S \\<circ> P' \\<in> Prof\n  \\<lbrakk>Top {a, b} \\<circ> P \\<in> Prof; ?P' \\<in> Prof;\n   \\<forall>i aa.\n      aa <\\<^bsub>(Top {a, b} \\<circ> P)\n                   i\\<^esub> f (Top {a, b} \\<circ> P) \\<longrightarrow>\n      aa <\\<^bsub>?P' i\\<^esub> f (Top {a, b} \\<circ> P)\\<rbrakk>\n  \\<Longrightarrow> f ?P' = f (Top {a, b} \\<circ> P)\n\ngoal (1 subgoal):\n 1. f (Top {a, b} \\<circ> P) = f (Top {a, b} \\<circ> P')", "by metis"], ["proof (state)\nthis:\n  f (Top {a, b} \\<circ> P) = f (Top {a, b} \\<circ> P')\n\ngoal (1 subgoal):\n 1. \\<And>P P' a b.\n       \\<lbrakk>P \\<in> Prof; P' \\<in> Prof;\n        \\<forall>i.\n           (a <\\<^bsub>P i\\<^esub> b) = (a <\\<^bsub>P' i\\<^esub> b)\\<rbrakk>\n       \\<Longrightarrow> (a <\\<^bsub>swf f P\\<^esub> b) =\n                         (a <\\<^bsub>swf f P'\\<^esub> b)", "thus \"(a <\\<^bsub>swf f P\\<^esub> b) = (a <\\<^bsub>swf f P'\\<^esub> b)\""], ["proof (prove)\nusing this:\n  f (Top {a, b} \\<circ> P) = f (Top {a, b} \\<circ> P')\n\ngoal (1 subgoal):\n 1. (a <\\<^bsub>swf f P\\<^esub> b) = (a <\\<^bsub>swf f P'\\<^esub> b)", "by(simp add: swf_def)"], ["proof (state)\nthis:\n  (a <\\<^bsub>swf f P\\<^esub> b) = (a <\\<^bsub>swf f P'\\<^esub> b)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma dict_swf: assumes \"dictator (swf f) i\" shows \"dict f i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dict f i", "proof (auto simp:dict_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P a.\n       \\<lbrakk>P \\<in> Prof; a \\<noteq> f P\\<rbrakk>\n       \\<Longrightarrow> a <\\<^bsub>P i\\<^esub> f P", "fix P a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>P a.\n       \\<lbrakk>P \\<in> Prof; a \\<noteq> f P\\<rbrakk>\n       \\<Longrightarrow> a <\\<^bsub>P i\\<^esub> f P", "assume \"P:Prof\" \"a\\<noteq>f P\""], ["proof (state)\nthis:\n  P \\<in> Prof\n  a \\<noteq> f P\n\ngoal (1 subgoal):\n 1. \\<And>P a.\n       \\<lbrakk>P \\<in> Prof; a \\<noteq> f P\\<rbrakk>\n       \\<Longrightarrow> a <\\<^bsub>P i\\<^esub> f P", "have \"f (Top {a,f P} \\<circ> P) = f P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (Top {a, f P} \\<circ> P) = f P", "using mono[OF \\<open>P:Prof\\<close> Top_in_Prof[OF \\<open>P:Prof\\<close>,of \"{a,f P}\"]]"], ["proof (prove)\nusing this:\n  \\<forall>i aa.\n     aa <\\<^bsub>P i\\<^esub> f P \\<longrightarrow>\n     aa <\\<^bsub>(Top {a, f P} \\<circ> P) i\\<^esub> f P \\<Longrightarrow>\n  f (Top {a, f P} \\<circ> P) = f P\n\ngoal (1 subgoal):\n 1. f (Top {a, f P} \\<circ> P) = f P", "by (auto simp:Top_def)"], ["proof (state)\nthis:\n  f (Top {a, f P} \\<circ> P) = f P\n\ngoal (1 subgoal):\n 1. \\<And>P a.\n       \\<lbrakk>P \\<in> Prof; a \\<noteq> f P\\<rbrakk>\n       \\<Longrightarrow> a <\\<^bsub>P i\\<^esub> f P", "moreover"], ["proof (state)\nthis:\n  f (Top {a, f P} \\<circ> P) = f P\n\ngoal (1 subgoal):\n 1. \\<And>P a.\n       \\<lbrakk>P \\<in> Prof; a \\<noteq> f P\\<rbrakk>\n       \\<Longrightarrow> a <\\<^bsub>P i\\<^esub> f P", "have \"P i = {(a,b). a\\<noteq>b \\<and> f(Top {a,b} \\<circ> P) = b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P i = {(a, b). a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}", "using assms \\<open>P:Prof\\<close>"], ["proof (prove)\nusing this:\n  dictator (swf f) i\n  P \\<in> Prof\n\ngoal (1 subgoal):\n 1. P i = {(a, b). a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}", "by(simp add:dictator_def swf_def)"], ["proof (state)\nthis:\n  P i = {(a, b). a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}\n\ngoal (1 subgoal):\n 1. \\<And>P a.\n       \\<lbrakk>P \\<in> Prof; a \\<noteq> f P\\<rbrakk>\n       \\<Longrightarrow> a <\\<^bsub>P i\\<^esub> f P", "ultimately"], ["proof (chain)\npicking this:\n  f (Top {a, f P} \\<circ> P) = f P\n  P i = {(a, b). a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}", "show \"(a,f P) : P i\""], ["proof (prove)\nusing this:\n  f (Top {a, f P} \\<circ> P) = f P\n  P i = {(a, b). a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}\n\ngoal (1 subgoal):\n 1. a <\\<^bsub>P i\\<^esub> f P", "using \\<open>a\\<noteq>f P\\<close>"], ["proof (prove)\nusing this:\n  f (Top {a, f P} \\<circ> P) = f P\n  P i = {(a, b). a \\<noteq> b \\<and> f (Top {a, b} \\<circ> P) = b}\n  a \\<noteq> f P\n\ngoal (1 subgoal):\n 1. a <\\<^bsub>P i\\<^esub> f P", "by simp"], ["proof (state)\nthis:\n  a <\\<^bsub>P i\\<^esub> f P\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem Gibbard_Satterthwaite:\n  \"\\<exists>i. dict f i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>i. dict f i", "by (metis Arrow SWF_swf una_swf IIA_swf dict_swf)"], ["", "end"], ["", "theorem Gibbard_Satterthwaite:\n  \"\\<not> manipulable f \\<Longrightarrow> \\<forall>a.\\<exists>P\\<in>Prof. a = f P \\<Longrightarrow> \\<exists>i. dict f i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> manipulable f;\n     \\<forall>a. \\<exists>P\\<in>Prof. a = f P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>i. dict f i", "using GS.Gibbard_Satterthwaite[of f,unfolded GS_def]"], ["proof (prove)\nusing this:\n  \\<not> manipulable f \\<and> f ` Prof = UNIV \\<Longrightarrow>\n  \\<exists>i. dict f i\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> manipulable f;\n     \\<forall>a. \\<exists>P\\<in>Prof. a = f P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>i. dict f i", "by blast"], ["", "end"]]}