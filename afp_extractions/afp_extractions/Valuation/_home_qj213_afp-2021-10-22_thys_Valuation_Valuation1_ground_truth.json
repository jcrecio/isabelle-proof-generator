{"file_name": "/home/qj213/afp-2021-10-22/thys/Valuation/Valuation1.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Valuation", "problem_names": ["lemma int_less_mono:\"(a::nat) < b \\<Longrightarrow> int a < int b\"", "lemma zless_trans:\"\\<lbrakk>(i::int) < j; j < k\\<rbrakk> \\<Longrightarrow> i < k\"", "lemma zmult_pos_bignumTr0:\"\\<exists>L. \\<forall>m. L < m \\<longrightarrow> z < x + int m\"", "lemma zle_less_trans:\"\\<lbrakk>(i::int) \\<le> j; j < k\\<rbrakk> \\<Longrightarrow> i < k\"", "lemma  zless_le_trans:\"\\<lbrakk>(i::int) < j; j \\<le> k\\<rbrakk> \\<Longrightarrow> i < k\"", "lemma zmult_pos_bignumTr:\"0 < (a::int) \\<Longrightarrow>\n                   \\<exists>l. \\<forall>m. l < m \\<longrightarrow> z < x + (int m) * a\"", "lemma  ale_shift:\"\\<lbrakk>(x::ant)\\<le> y; y = z\\<rbrakk> \\<Longrightarrow> x \\<le> z\"", "lemma aneg_na_0[simp]:\"a < 0 \\<Longrightarrow> na a = 0\"", "lemma amult_an_an:\"an (m * n) = (an m) * (an n)\"", "lemma apos_amod_conj:\"0 < ant b \\<Longrightarrow>\n                  0 \\<le> (ant a) amod (ant b) \\<and> (ant a) amod (ant b) < (ant b)\"", "lemma  amod_adiv_equality:\n       \"(ant a) = (a div b) *\\<^sub>a (ant b) + ant (a mod b)\"", "lemma asp_z_Z:\"z *\\<^sub>a ant x \\<in> Z\\<^sub>\\<infinity>\"", "lemma apos_in_aug_inf:\"0 \\<le> a \\<Longrightarrow> a \\<in> Z\\<^sub>\\<infinity>\"", "lemma  amult_1_both:\"\\<lbrakk>0 < (w::ant); x * w = 1\\<rbrakk> \\<Longrightarrow> x = 1 \\<and> w = 1\"", "lemma poss_int_neq_0:\"0 < (z::int) \\<Longrightarrow> z \\<noteq> 0\"", "lemma aadd_neg_negg[simp]:\"\\<lbrakk>a \\<le> (0::ant); b < 0\\<rbrakk> \\<Longrightarrow> a + b < 0\"", "lemma aadd_two_negg[simp]:\"\\<lbrakk>a < (0::ant); b < 0\\<rbrakk> \\<Longrightarrow> a + b < 0\"", "lemma amin_aminTr:\"(z::ant) \\<le> z' \\<Longrightarrow> amin z w \\<le> amin z' w\"", "lemma amin_le1:\"(z::ant) \\<le> z' \\<Longrightarrow> (amin z w) \\<le> z'\"", "lemma amin_le2:\"(z::ant) \\<le> z' \\<Longrightarrow> (amin w z) \\<le> z'\"", "lemma  Amin_geTr:\"(\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>j \\<le> n. z \\<le> (f j)) \\<longrightarrow>\n                                 z \\<le> (Amin n f)\"", "lemma Amin_ge:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>; \\<forall>j \\<le> n. z \\<le> (f j)\\<rbrakk> \\<Longrightarrow>\n                             z \\<le> (Amin n f)\"", "lemma Abs_pos:\"0 \\<le> Abs z\"", "lemma Abs_x_plus_x_pos:\"0 \\<le> (Abs x) + x\"", "lemma  Abs_ge_self:\"x \\<le> Abs x\"", "lemma  na_1:\"na 1 = Suc 0\"", "lemma ant_int:\"ant (int n) = an n\"", "lemma int_nat:\"0 < z \\<Longrightarrow> int (nat z) = z\"", "lemma int_ex_nat:\"0 < z \\<Longrightarrow> \\<exists>n. int n = z\"", "lemma eq_nat_pos_ints:\n  \"\\<lbrakk>nat (z::int) = nat (z'::int); 0 \\<le> z; 0 \\<le> z'\\<rbrakk> \\<Longrightarrow> z = z'\"", "lemma a_p1_gt[simp]:\"\\<lbrakk>a \\<noteq> \\<infinity>; a \\<noteq> -\\<infinity>\\<rbrakk>  \\<Longrightarrow> a < a + 1\"", "lemma  gt_na_poss:\"(na a) < m \\<Longrightarrow> 0 < m\"", "lemma azmult_less:\"\\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x\\<rbrakk>\n                         \\<Longrightarrow> a < int m *\\<^sub>a x\"", "lemma  zmult_gt_one:\"\\<lbrakk>2 \\<le> m; 0 < xa\\<rbrakk> \\<Longrightarrow> 1 < int m * xa\"", "lemma zmult_pos:\"\\<lbrakk> 0 < m; 0 < (a::int)\\<rbrakk> \\<Longrightarrow> 0 < (int m) * a\"", "lemma  ant_int_na:\"\\<lbrakk>0 \\<le> a; a \\<noteq> \\<infinity> \\<rbrakk> \\<Longrightarrow> ant (int (na a)) = a\"", "lemma zpos_nat:\"0 \\<le> (z::int) \\<Longrightarrow> \\<exists>n. z = int n\"", "lemma nsetTr1:\"\\<lbrakk>j \\<in> nset a b; j \\<noteq> a\\<rbrakk> \\<Longrightarrow> j \\<in> nset (Suc a) b\"", "lemma nsetTr2:\"j \\<in> nset (Suc a) (Suc b) \\<Longrightarrow> j - Suc 0 \\<in> nset a b\"", "lemma  nsetTr3:\"\\<lbrakk>j \\<noteq> Suc (Suc 0); j - Suc 0 \\<in> nset (Suc 0) (Suc n)\\<rbrakk>\n       \\<Longrightarrow>  Suc 0 < j - Suc 0\"", "lemma Suc_leD1:\"Suc m \\<le> n \\<Longrightarrow> m < n\"", "lemma leI1:\"n < m \\<Longrightarrow> \\<not> ((m::nat) \\<le> n)\"", "lemma neg_zle:\"\\<not> (z::int) \\<le> z' \\<Longrightarrow> z' < z\"", "lemma nset_m_m:\"nset m m = {m}\"", "lemma nset_Tr51:\"\\<lbrakk>j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> j - Suc 0 \\<in> nset (Suc 0) (Suc n)\"", "lemma nset_Tr52:\"\\<lbrakk>j \\<noteq> Suc (Suc 0); Suc 0 \\<le> j - Suc 0\\<rbrakk>\n       \\<Longrightarrow> \\<not> j - Suc 0 \\<le> Suc 0\"", "lemma nset_Suc:\"nset (Suc 0) (Suc (Suc n)) =\n                  nset (Suc 0) (Suc n) \\<union> {Suc (Suc n)}\"", "lemma AinequalityTr0:\"x \\<noteq> -\\<infinity> \\<Longrightarrow> \\<exists>L. (\\<forall>N. L < N \\<longrightarrow>\n                          (an m) < (x + an N))\"", "lemma AinequalityTr:\"\\<lbrakk>0 < b \\<and> b \\<noteq> \\<infinity>; x \\<noteq> -\\<infinity>\\<rbrakk> \\<Longrightarrow> \\<exists>L. (\\<forall>N. L < N \\<longrightarrow>\n                          (an m) < (x + (int N) *\\<^sub>a b))\"", "lemma two_inequalities:\"\\<lbrakk>\\<forall>(n::nat). x < n \\<longrightarrow> P n; \\<forall>(n::nat). y < n \\<longrightarrow> Q n\\<rbrakk>\n \\<Longrightarrow>  \\<forall>n. (max x y) < n \\<longrightarrow> (P n) \\<and> (Q n)\"", "lemma multi_inequalityTr0:\"(\\<forall>j \\<le> (n::nat). (x j) \\<noteq> -\\<infinity> ) \\<longrightarrow>\n      (\\<exists>L. (\\<forall>N. L < N \\<longrightarrow>  (\\<forall>l \\<le> n. (an m) < (x l) + (an N))))\"", "lemma multi_inequalityTr1:\"\\<lbrakk>\\<forall>j \\<le> (n::nat). (x j) \\<noteq> - \\<infinity>\\<rbrakk> \\<Longrightarrow>\n       \\<exists>L. (\\<forall>N. L < N \\<longrightarrow>  (\\<forall>l \\<le> n. (an m) < (x l) + (an N)))\"", "lemma gcoeff_multi_inequality:\"\\<lbrakk>\\<forall>N. 0 < N \\<longrightarrow> (\\<forall>j \\<le> (n::nat). (x j) \\<noteq> -\\<infinity> \\<and>\n     0 < (b N j) \\<and> (b N j) \\<noteq> \\<infinity>)\\<rbrakk> \\<Longrightarrow>\n\\<exists>L. (\\<forall>N. L < N \\<longrightarrow>  (\\<forall>l \\<le> n.(an m) < (x l) + (int N) *\\<^sub>a (b N l)))\"", "lemma m_maxTr:\"\\<forall>l \\<le> n. (f l) \\<le> m_max n f\"", "lemma m_max_gt:\"l \\<le> n \\<Longrightarrow> (f l) \\<le> m_max n f\"", "lemma ASum_zero:\" (\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>l \\<le> n. f l = 0) \\<longrightarrow> ASum f n = 0\"", "lemma eSum_singleTr:\"(\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (j \\<le> n \\<and> (\\<forall>l \\<in>{h. h \\<le> n} - {j}. f l = 0))  \\<longrightarrow> ASum f n = f j\"", "lemma eSum_single:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity> ; j \\<le> n; \\<forall>l \\<in> {h. h \\<le> n} - {j}. f l = 0\\<rbrakk>\n \\<Longrightarrow> ASum  f n = f j\"", "lemma ASum_eqTr:\"(\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>j \\<le> n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                (\\<forall>j \\<le> n. f j = g j) \\<longrightarrow> ASum f n = ASum g n\"", "lemma ASum_eq:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>; \\<forall>j \\<le> n. g j \\<in> Z\\<^sub>\\<infinity>; \\<forall>j \\<le> n. f j = g j\\<rbrakk> \\<Longrightarrow>\n               ASum f n = ASum g n\"", "lemma Kdelta_in_Zinf:\"\\<lbrakk>j \\<le> (Suc n); k \\<le> (Suc n)\\<rbrakk>  \\<Longrightarrow>\n                 z *\\<^sub>a (\\<delta>\\<^bsub>j k\\<^esub>) \\<in> Z\\<^sub>\\<infinity>\"", "lemma Kdelta_in_Zinf1:\"\\<lbrakk>j \\<le> n; k \\<le> n\\<rbrakk>  \\<Longrightarrow> \\<delta>\\<^bsub>j k\\<^esub> \\<in> Z\\<^sub>\\<infinity>\"", "lemma m_zmax_gt_eachTr:\n      \"(\\<forall>j \\<le> n. f j \\<in> Zset) \\<longrightarrow> (\\<forall>j \\<le> n. (f j) \\<le> m_zmax n f)\"", "lemma m_zmax_gt_each:\"(\\<forall>j \\<le> n. f j \\<in> Zset) \\<Longrightarrow> (\\<forall>j \\<le> n. (f j) \\<le> m_zmax n f)\"", "lemma n_notin_Nset_pred:\" 0 < n \\<Longrightarrow> \\<not> n \\<le> (n - Suc 0)\"", "lemma Nset_preTr:\"\\<lbrakk>0 < n; j \\<le> (n - Suc 0)\\<rbrakk> \\<Longrightarrow> j \\<le> n\"", "lemma Nset_preTr1:\"\\<lbrakk>0 < n; j \\<le> (n - Suc 0)\\<rbrakk> \\<Longrightarrow> j \\<noteq> n\"", "lemma transpos_noteqTr:\"\\<lbrakk>0 < n; k \\<le> (n - Suc 0); j \\<le> n; j \\<noteq> n\\<rbrakk>\n                    \\<Longrightarrow> j \\<noteq> (\\<tau>\\<^bsub>j n\\<^esub>) k\"", "lemma (in Corps) invf_closed:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K\"", "lemma (in Corps) valuation_map:\"valuation K v \\<Longrightarrow> v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>\"", "lemma (in Corps) value_in_aug_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n       v x \\<in> Z\\<^sub>\\<infinity>\"", "lemma (in Corps) value_of_zero:\"valuation K v  \\<Longrightarrow> v (\\<zero>) = \\<infinity>\"", "lemma (in Corps) val_nonzero_noninf:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n     \\<Longrightarrow> (v x) \\<noteq> \\<infinity>\"", "lemma (in Corps) value_inf_zero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = \\<infinity>\\<rbrakk>\n     \\<Longrightarrow> x = \\<zero>\"", "lemma (in Corps) val_nonzero_z:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                      \\<exists>z. (v x) = ant z\"", "lemma (in Corps) val_nonzero_z_unique:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!z. (v x) = ant z\"", "lemma (in Corps) value_noninf_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x \\<noteq> \\<infinity>\\<rbrakk>\n         \\<Longrightarrow> x \\<noteq> \\<zero>\"", "lemma (in Corps) val1_neq_0:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 1\\<rbrakk> \\<Longrightarrow>\n                                         x \\<noteq> \\<zero>\"", "lemma (in Corps) val_Zmin_sym:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                 \\<Longrightarrow>  amin (v x) (v y) = amin (v y ) (v x)\"", "lemma (in Corps) val_t2p:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                         \\<Longrightarrow> v (x \\<cdot>\\<^sub>r y ) = v x + v y\"", "lemma (in Corps) val_axiom4:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> v x\\<rbrakk> \\<Longrightarrow>\n                      0 \\<le> v (1\\<^sub>r \\<plusminus> x)\"", "lemma (in Corps) val_axiom5:\"valuation K v \\<Longrightarrow>\n                  \\<exists>x. x \\<in> carrier K \\<and> v x \\<noteq> \\<infinity> \\<and> v x \\<noteq> 0\"", "lemma (in Corps) val_field_nonzero:\"valuation K v \\<Longrightarrow> carrier K \\<noteq> {\\<zero>}\"", "lemma (in Corps) val_field_1_neq_0:\"valuation K v \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\"", "lemma (in Corps) value_of_one:\"valuation K v \\<Longrightarrow> v (1\\<^sub>r) = 0\"", "lemma (in Corps) has_val_one_neq_zero:\"valuation K v \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\"", "lemma (in Corps) val_minus_one:\"valuation K v \\<Longrightarrow> v (-\\<^sub>a 1\\<^sub>r) = 0\"", "lemma (in Corps) val_minus_eq:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                            v (-\\<^sub>a x) = v x\"", "lemma (in Corps) value_of_inv:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                        v (x\\<^bsup>\\<hyphen>K\\<^esup>) = - (v x)\"", "lemma (in Corps) val_exp_ring:\"\\<lbrakk> valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n           \\<Longrightarrow> (int n) *\\<^sub>a (v x) = v (x^\\<^bsup>K n\\<^esup>)\"", "lemma (in Corps) val_exp:\"\\<lbrakk> valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                        z *\\<^sub>a (v x) = v (x\\<^bsub>K\\<^esub>\\<^bsup>z\\<^esup>)\"", "lemma (in Corps) value_zero_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n                   \\<Longrightarrow> x \\<noteq> \\<zero>\"", "lemma (in Corps) v_ale_diff:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n        x \\<noteq> \\<zero>; v x \\<le> v y \\<rbrakk> \\<Longrightarrow> 0 \\<le> v(y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\"", "lemma (in Corps) amin_le_plusTr:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n       v x \\<noteq> \\<infinity>; v y \\<noteq> \\<infinity>; v x \\<le> v y\\<rbrakk> \\<Longrightarrow> amin (v x) (v y) \\<le> v ( x \\<plusminus> y)\"", "lemma (in Corps) amin_le_plus:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                   \\<Longrightarrow> (amin (v x) (v y)) \\<le> (v (x \\<plusminus> y))\"", "lemma (in Corps) value_less_eq:\"\\<lbrakk> valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n                       (v x) < (v y)\\<rbrakk> \\<Longrightarrow> (v x) = (v (x \\<plusminus> y))\"", "lemma (in Corps) value_less_eq1:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n      (v x) < (v y)\\<rbrakk> \\<Longrightarrow> v x =  v (y \\<plusminus> x)\"", "lemma (in Corps) val_1px:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> (v (1\\<^sub>r \\<plusminus> x))\\<rbrakk>\n         \\<Longrightarrow> 0 \\<le> (v x)\"", "lemma (in Corps) val_1mx:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n                  0 \\<le> (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a x)))\\<rbrakk> \\<Longrightarrow> 0 \\<le> (v x)\"", "lemma (in Corps) vals_pos_nonempty:\"valuation K v \\<Longrightarrow>\n                       {x. x \\<in> v ` carrier K \\<and> 0 < x} \\<noteq> {}\"", "lemma (in Corps) vals_pos_LBset:\"valuation K v \\<Longrightarrow>\n            {x. x \\<in> v ` carrier K \\<and> 0 < x} \\<subseteq> LBset 1\"", "lemma (in Corps) Lv_pos:\"valuation K v \\<Longrightarrow> 0 < Lv K v\"", "lemma (in Corps) AMin_z:\"valuation K v \\<Longrightarrow>\n         \\<exists>a. AMin {x. x \\<in> v ` carrier K \\<and> 0 < x} = ant a\"", "lemma (in Corps) Lv_z:\"valuation K v \\<Longrightarrow> \\<exists>z. Lv K v = ant z\"", "lemma (in Corps) AMin_k:\"valuation K v \\<Longrightarrow>\n         \\<exists>k\\<in> carrier K - {\\<zero>}. AMin {x. x \\<in> v ` carrier K \\<and> 0 < x} = v k\"", "lemma (in Corps) val_Pg:\" valuation K v \\<Longrightarrow>\n                  Pg K v \\<in> carrier K - {\\<zero>} \\<and> v (Pg K v) = Lv K v\"", "lemma (in Corps) amin_generateTr:\"valuation K v \\<Longrightarrow>\n  \\<forall>w\\<in>carrier K - {\\<zero>}. \\<exists>z. v w = z *\\<^sub>a AMin {x. x \\<in> v ` carrier K \\<and> 0 < x}\"", "lemma (in Corps) val_principalTr1:\"\\<lbrakk> valuation K v\\<rbrakk>  \\<Longrightarrow>\n            Lv K v \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n             (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * Lv K v) \\<and> 0 < Lv K v\"", "lemma (in Corps) val_principalTr2:\"\\<lbrakk>valuation K v;\n  c \\<in> v ` (carrier K - {\\<zero>}) \\<and> (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * c) \\<and> 0 < c;\n  d \\<in> v ` (carrier K - {\\<zero>}) \\<and> (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * d) \\<and> 0 < d\\<rbrakk>\n       \\<Longrightarrow> c = d\"", "lemma (in Corps) val_principal:\"valuation K v \\<Longrightarrow>\n  \\<exists>!x0. x0 \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n     (\\<forall>w \\<in> v ` (carrier K). \\<exists>(a::ant). w = a * x0) \\<and> 0 < x0\"", "lemma (in Corps) n_val_defTr:\"\\<lbrakk>valuation K v; w \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                           \\<exists>!a. a * Lv K v = v w\"", "lemma (in Corps) n_valTr:\"\\<lbrakk> valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n             (THE l. (l * (Lv K v)) = v x)*(Lv K v) = v x\"", "lemma (in Corps) n_val:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n                           (n_val K v x)*(Lv K v) = v x\"", "lemma (in Corps) val_pos_n_val_pos:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n           (0 \\<le> v x) = (0 \\<le> n_val K v x)\"", "lemma (in Corps) n_val_in_aug_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                           n_val K v x \\<in> Z\\<^sub>\\<infinity>\"", "lemma (in Corps) n_val_0:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n       \\<Longrightarrow>  n_val K v x = 0\"", "lemma (in Corps) value_n0_n_val_n0:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x \\<noteq> 0\\<rbrakk> \\<Longrightarrow>\n                             n_val K v x \\<noteq> 0\"", "lemma (in Corps) val_0_n_val_0:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                         (v x = 0) = (n_val K v x = 0)\"", "lemma (in Corps) val_noninf_n_val_noninf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n      (v x \\<noteq> \\<infinity>) = (n_val K v x \\<noteq> \\<infinity>)\"", "lemma (in Corps) val_inf_n_val_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n      (v x = \\<infinity>) = (n_val K v x = \\<infinity>)\"", "lemma (in Corps) val_eq_n_val_eq:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n  \\<Longrightarrow>  (v x = v y) = (n_val K v x = n_val K v y)\"", "lemma (in Corps) val_poss_n_val_poss:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n           (0 < v x) = (0 < n_val K v x)\"", "lemma (in Corps) n_val_Pg:\"valuation K v \\<Longrightarrow> n_val K v (Pg K v) = 1\"", "lemma (in Corps) n_val_valuationTr1:\"valuation K v \\<Longrightarrow>\n                           \\<forall>x\\<in>carrier K. n_val K v x \\<in> Z\\<^sub>\\<infinity>\"", "lemma (in Corps) n_val_t2p:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                   n_val K v (x \\<cdot>\\<^sub>r y) = n_val K v x + (n_val K v y)\"", "lemma (in Corps) n_val_valuationTr2:\"\\<lbrakk> valuation K v; x \\<in> carrier K;\n      y \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n       amin (n_val K v x) (n_val K v y) \\<le> (n_val K v ( x \\<plusminus> y))\"", "lemma (in Corps) n_val_valuation:\"valuation K v \\<Longrightarrow>\n                                      valuation K (n_val K v)\"", "lemma (in Corps) n_val_le_val:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> (v x)\\<rbrakk>  \\<Longrightarrow>\n                 (n_val K v x) \\<le>(v x)\"", "lemma (in Corps) n_val_surj:\"valuation K v \\<Longrightarrow>\n                                   \\<exists>x\\<in> carrier K. n_val K v x = 1\"", "lemma (in Corps) n_value_in_aug_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                             n_val K v x \\<in> Z\\<^sub>\\<infinity>\"", "lemma (in Corps) val_surj_n_valTr:\"\\<lbrakk>valuation K v; \\<exists>x \\<in> carrier K. v x = 1\\<rbrakk>\n      \\<Longrightarrow>  Lv K v = 1\"", "lemma (in Corps) val_surj_n_val:\"\\<lbrakk>valuation K v; \\<exists>x \\<in> carrier K. v x = 1\\<rbrakk> \\<Longrightarrow>\n                       (n_val K v) = v\"", "lemma (in Corps) n_val_n_val:\"valuation K v \\<Longrightarrow>\n        n_val K (n_val K v)  = n_val K v\"", "lemma nnonzero_annonzero:\"0 < N \\<Longrightarrow> an N \\<noteq> 0\"", "lemma (in Ring) ring_pow_apow:\"ideal R I \\<Longrightarrow>\n                  I\\<^bsup>\\<diamondsuit>R n\\<^esup> =  I\\<^bsup>R (an n)\\<^esup>\"", "lemma (in Ring) r_apow_Suc:\"ideal R I \\<Longrightarrow> I\\<^bsup>R (an (Suc 0))\\<^esup> = I\"", "lemma (in Ring) apow_ring_pow:\"ideal R I \\<Longrightarrow>\n                  I\\<^bsup>\\<diamondsuit>R n\\<^esup> =  I\\<^bsup>R (an n)\\<^esup>\"", "lemma (in Corps) Vr_ring:\"valuation K v \\<Longrightarrow> Ring (Vr K v)\"", "lemma (in Corps) val_pos_mem_Vr:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                             (0 \\<le> (v x)) = (x \\<in> carrier (Vr K v))\"", "lemma (in Corps) val_poss_mem_Vr:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 < (v x)\\<rbrakk>\n                        \\<Longrightarrow>  x \\<in> carrier (Vr K v)\"", "lemma (in Corps) Vr_one:\"valuation K v \\<Longrightarrow> 1\\<^sub>r\\<^bsub>K\\<^esub> \\<in> carrier (Vr K v)\"", "lemma (in Corps) Vr_mem_f_mem:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n     \\<Longrightarrow>  x \\<in> carrier K\"", "lemma (in Corps) Vr_0_f_0:\"valuation K v \\<Longrightarrow> \\<zero>\\<^bsub>Vr K v\\<^esub> = \\<zero>\"", "lemma (in Corps) Vr_1_f_1:\"valuation K v \\<Longrightarrow> 1\\<^sub>r\\<^bsub>(Vr K v)\\<^esub> = 1\\<^sub>r\"", "lemma (in Corps) Vr_pOp_f_pOp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n       y \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>  x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y = x \\<plusminus> y\"", "lemma (in Corps) Vr_mOp_f_mOp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n                     \\<Longrightarrow> -\\<^sub>a\\<^bsub>(Vr K v)\\<^esub> x = -\\<^sub>a x\"", "lemma (in Corps) Vr_tOp_f_tOp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n                     y \\<in> carrier(Vr K  v)\\<rbrakk> \\<Longrightarrow>  x \\<cdot>\\<^sub>r\\<^bsub>(Vr K v)\\<^esub> y = x \\<cdot>\\<^sub>r y\"", "lemma (in Corps) Vr_pOp_le:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n       y \\<in> carrier (Vr K v)\\<rbrakk>  \\<Longrightarrow> v x \\<le> (v x + (v y))\"", "lemma (in Corps) Vr_integral:\"valuation K v \\<Longrightarrow> Idomain (Vr K v)\"", "lemma (in Corps) Vr_exp_mem:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n      \\<Longrightarrow>  x^\\<^bsup>K n\\<^esup> \\<in> carrier (Vr K v)\"", "lemma (in Corps) Vr_exp_f_exp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>\n                                    x^\\<^bsup>(Vr K v) n\\<^esup> =  x^\\<^bsup>K n\\<^esup>\"", "lemma (in Corps) Vr_potent_nonzero:\"\\<lbrakk>valuation K v;\n      x \\<in> carrier (Vr K v) - {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>  \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>\"", "lemma (in Corps) elem_0_val_if:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n              \\<Longrightarrow> x \\<in> carrier (Vr K v) \\<and> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)\"", "lemma (in Corps) elem0val:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n      (v x = 0) = ( x \\<in> carrier (Vr K v) \\<and> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v))\"", "lemma (in Corps) ideal_inc_elem0val_whole:\"\\<lbrakk> valuation K v; x \\<in> carrier K;\n v x = 0; ideal (Vr K v) I; x \\<in> I\\<rbrakk> \\<Longrightarrow>  I = carrier (Vr K v)\"", "lemma (in Corps) vp_mem_Vr_mem:\"\\<lbrakk>valuation K v; x \\<in> (vp K v)\\<rbrakk> \\<Longrightarrow>\n                                                x \\<in> carrier (Vr K v)\"", "lemma (in Corps) vp_mem_val_poss:\"\\<lbrakk> valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                                   (x \\<in> vp K v) = (0 < (v x))\"", "lemma (in Corps) Pg_in_Vr:\"valuation K v \\<Longrightarrow>  Pg K v \\<in> carrier (Vr K v)\"", "lemma (in Corps) vp_ideal:\"valuation K v \\<Longrightarrow>  ideal (Vr K v) (vp K v)\"", "lemma (in Corps) vp_not_whole:\"valuation K v \\<Longrightarrow>\n                       (vp K v) \\<noteq> carrier (Vr K v)\"", "lemma (in Ring) elem_out_ideal_nonzero:\"\\<lbrakk>ideal R I; x \\<in> carrier R;\n        x \\<notin> I\\<rbrakk> \\<Longrightarrow> x \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\"", "lemma (in Corps) vp_prime:\"valuation K v \\<Longrightarrow> prime_ideal (Vr K v) (vp K v)\"", "lemma (in Corps) vp_pow_ideal:\"valuation K v \\<Longrightarrow>\n                      ideal (Vr K v) ((vp K v)\\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup>)\"", "lemma (in Corps) vp_apow_ideal:\"\\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n                      ideal (Vr K v) ((vp K v)\\<^bsup>(Vr K v) n\\<^esup>)\"", "lemma (in Corps) mem_vp_apow_mem_Vr:\"\\<lbrakk>valuation K v;\n       0 \\<le> N; x \\<in> vp K v \\<^bsup>(Vr K v) N\\<^esup>\\<rbrakk>  \\<Longrightarrow> x \\<in> carrier (Vr K v)\"", "lemma (in Corps) elem_out_vp_unit:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n      x \\<notin> vp K v\\<rbrakk>  \\<Longrightarrow> v x = 0\"", "lemma (in Corps) vp_maximal:\"valuation K v \\<Longrightarrow>\n                          maximal_ideal (Vr K v) (vp K v)\"", "lemma (in Corps) ideal_sub_vp:\"\\<lbrakk> valuation K v; ideal (Vr K v) I;\n I \\<noteq> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow> I \\<subseteq> (vp K v)\"", "lemma (in Corps) Vr_local:\"\\<lbrakk>valuation K v; maximal_ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                   (vp K v) = I\"", "lemma (in Corps) v_residue_field:\"valuation K v \\<Longrightarrow>\n                                Corps ((Vr K v)  /\\<^sub>r (vp K v))\"", "lemma (in Corps) Vr_n_val_Vr:\"valuation K v \\<Longrightarrow>\n     carrier (Vr K v) = carrier (Vr K (n_val K v))\"", "lemma (in Corps) Vr_has_poss_elem:\"valuation K v \\<Longrightarrow>\n                 \\<exists>x\\<in>carrier (Vr K v) - {\\<zero>\\<^bsub>Vr K v\\<^esub>}. 0 < v x\"", "lemma (in Corps) vp_nonzero:\"valuation K v \\<Longrightarrow>  vp K v \\<noteq>  {\\<zero>\\<^bsub>Vr K v\\<^esub>}\"", "lemma (in Corps) field_frac_mul:\"\\<lbrakk>x \\<in> carrier K; y \\<in> carrier K; y \\<noteq> \\<zero>\\<rbrakk>\n        \\<Longrightarrow>   x = (x \\<cdot>\\<^sub>r  (y\\<^bsup>\\<hyphen>K\\<^esup>)) \\<cdot>\\<^sub>r y\"", "lemma (in Corps) elems_le_val:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n       x \\<noteq> \\<zero>; v x \\<le> (v y)\\<rbrakk>  \\<Longrightarrow> \\<exists>r\\<in>carrier (Vr K v). y = r \\<cdot>\\<^sub>r x\"", "lemma (in Corps) val_Rxa_gt_a:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v) - {\\<zero>};\n y \\<in> carrier (Vr K v);  y \\<in> Rxa (Vr K v) x\\<rbrakk> \\<Longrightarrow> v x \\<le> (v y)\"", "lemma (in Corps) val_Rxa_gt_a_1:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\ny \\<in> carrier (Vr K v); x \\<noteq> \\<zero>; v x \\<le> (v y)\\<rbrakk> \\<Longrightarrow> y \\<in> Rxa (Vr K v) x\"", "lemma (in Corps) eqval_inv:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n       y \\<noteq> \\<zero>; v x = v y\\<rbrakk> \\<Longrightarrow>  0 = v (x \\<cdot>\\<^sub>r (y\\<^bsup>\\<hyphen>K\\<^esup>))\"", "lemma (in Corps) eq_val_eq_idealTr:\"\\<lbrakk>valuation K v;\n      x \\<in> carrier (Vr K v) - {\\<zero>}; y \\<in> carrier  (Vr K v); v x \\<le> (v y)\\<rbrakk> \\<Longrightarrow>\n                       Rxa (Vr K v) y \\<subseteq>  Rxa (Vr K v) x\"", "lemma (in Corps) eq_val_eq_ideal:\"\\<lbrakk>valuation K v;\n      x \\<in> carrier (Vr K v); y \\<in> carrier  (Vr K v); v x = v y\\<rbrakk>\n       \\<Longrightarrow> Rxa (Vr K v) x = Rxa (Vr K v) y\"", "lemma (in Corps) eq_ideal_eq_val:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\ny \\<in> carrier (Vr K v); Rxa (Vr K v) x = Rxa (Vr K v) y\\<rbrakk>  \\<Longrightarrow> v x = v y\"", "lemma (in Corps) zero_val_gen_whole:\n \"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>\n             (v x = 0) = (Rxa (Vr K v) x = carrier (Vr K v))\"", "lemma (in Corps) elem_nonzeroval_gen_proper:\"\\<lbrakk> valuation K v;\n      x \\<in> carrier (Vr K v); v x \\<noteq> 0\\<rbrakk> \\<Longrightarrow> Rxa (Vr K v) x \\<noteq> carrier (Vr K v)\"", "lemma (in Corps) val_in_image:\"\\<lbrakk>valuation K v; ideal (Vr K v) I; x \\<in> I\\<rbrakk> \\<Longrightarrow>\n                            v x \\<in> v ` I\"", "lemma (in Corps) I_vals_nonempty:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                           v ` I \\<noteq> {}\"", "lemma (in Corps) I_vals_LBset:\"\\<lbrakk> valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                                          v ` I  \\<subseteq> LBset 0\"", "lemma (in Corps) LI_pos:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow> 0 \\<le> LI K v I\"", "lemma (in Corps) LI_poss:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n                 I \\<noteq> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow> 0 < LI K v I\"", "lemma (in Corps) LI_z:\"\\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk> \\<Longrightarrow>\n                 \\<exists>z. LI K v I = ant z\"", "lemma (in Corps) LI_k:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                                \\<exists>k\\<in> I. LI K v I = v k\"", "lemma (in Corps) LI_infinity:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n             (LI K v I = \\<infinity>)  = (I = {\\<zero>\\<^bsub>Vr K v\\<^esub>})\"", "lemma (in Corps) val_Ig:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                           (Ig K v I) \\<in> I \\<and> v (Ig K v I) = LI K v I\"", "lemma (in Corps) Ig_nonzero:\"\\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n                  \\<Longrightarrow> (Ig K v I) \\<noteq> \\<zero>\"", "lemma (in Corps) Vr_ideal_npowf_closed:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n       x \\<in> I; 0 < n\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup> \\<in> I\"", "lemma (in Corps) Ig_generate_I:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p (Ig K v I) = I\"", "lemma (in Corps) Pg_gen_vp:\"valuation K v  \\<Longrightarrow>\n                          (Vr K v) \\<diamondsuit>\\<^sub>p (Pg K v) = vp K v\"", "lemma (in Corps) vp_gen_t:\"valuation K v  \\<Longrightarrow>\n                \\<exists>t\\<in>carrier (Vr K v). vp K v = (Vr K v) \\<diamondsuit>\\<^sub>p t\"", "lemma (in Corps) vp_gen_nonzero:\"\\<lbrakk>valuation K v; vp K v = (Vr K v) \\<diamondsuit>\\<^sub>p t\\<rbrakk> \\<Longrightarrow>\n                 t \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>\"", "lemma (in Corps) n_value_idealTr:\"\\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n        (vp K v) \\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup> = Vr K v \\<diamondsuit>\\<^sub>p ((Pg K v)^\\<^bsup>(Vr K v) n\\<^esup>)\"", "lemma (in Corps) ideal_pow_vp:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n                     I \\<noteq> carrier (Vr K v); I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>  \\<Longrightarrow>\n                     I = (vp K v)\\<^bsup>\\<diamondsuit> (Vr K v) (na (n_val K v (Ig K v I)))\\<^esup>\"", "lemma (in Corps) ideal_apow_vp:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                     I = (vp K v)\\<^bsup> (Vr K v) (n_val K v (Ig K v I))\\<^esup>\"", "lemma (in Corps) ideal_apow_n_val:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p x = (vp K v)\\<^bsup>(Vr K v) (n_val K v x)\\<^esup>\"", "lemma (in Corps) t_gen_vp:\"\\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p t = vp K v\"", "lemma (in Corps) t_vp_apow:\"\\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p (t^\\<^bsup>(Vr K v) n\\<^esup>) = (vp K v)\\<^bsup>(Vr K v) (an n)\\<^esup>\"", "lemma (in Corps) nonzeroelem_gen_nonzero:\"\\<lbrakk>valuation K v; x \\<noteq> \\<zero>;\n                 x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>  Vr K v \\<diamondsuit>\\<^sub>p x \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\"", "lemma (in Corps)  Amin_le_addTr:\"valuation K v \\<Longrightarrow>\n(\\<forall>j \\<le> n. f j \\<in> carrier K) \\<longrightarrow> Amin n (v \\<circ> f) \\<le> (v (nsum K f n))\"", "lemma (in Corps) Amin_le_add:\"\\<lbrakk>valuation K v; \\<forall>j \\<le> n. f j \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                      Amin n (v \\<circ> f) \\<le> (v (nsum K f n))\"", "lemma (in Corps) value_ge_add:\"\\<lbrakk>valuation K v; \\<forall>j \\<le> n. f j \\<in> carrier K;\n                     \\<forall>j \\<le> n. z \\<le> ((v \\<circ> f) j)\\<rbrakk>  \\<Longrightarrow> z \\<le> (v (\\<Sigma>\\<^sub>e K f n))\"", "lemma (in Corps) Vr_ideal_powTr1:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n I \\<noteq> carrier (Vr K v); b \\<in> I\\<rbrakk>  \\<Longrightarrow> b \\<in> (vp K v)\"", "lemma (in Corps) n_value_x_1:\"\\<lbrakk>valuation K v; 0 \\<le> n;\n                    x \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\\<rbrakk> \\<Longrightarrow>  n \\<le> (n_val K v x)\"", "lemma (in Corps) n_value_x_1_nat:\"\\<lbrakk>valuation K v; x \\<in> (vp K v)\\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup> \\<rbrakk> \\<Longrightarrow>\n             (an n) \\<le> (n_val K v x)\"", "lemma (in Corps) n_value_x_2:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        n \\<le> (n_val K v x);  0 \\<le> n\\<rbrakk> \\<Longrightarrow>  x \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\"", "lemma (in Corps) n_value_x_2_nat:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n      (an n) \\<le> ((n_val K v) x)\\<rbrakk> \\<Longrightarrow>  x \\<in> (vp K v)\\<^bsup>\\<diamondsuit>(Vr K  v)  n\\<^esup>\"", "lemma (in Corps) n_val_n_pow:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n         (n \\<le> (n_val K v x)) = (x \\<in> (vp K v) \\<^bsup>(Vr K v)  n\\<^esup>)\"", "lemma (in Corps) eqval_in_vpr_apow:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> n;\n      y \\<in> carrier K; n_val K v x = n_val K v y; x \\<in> (vp K v)\\<^bsup>(Vr K v) n\\<^esup>\\<rbrakk> \\<Longrightarrow>\n      y \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\"", "lemma (in Corps) convergenceTr:\"\\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n  b \\<in> (vp K v)\\<^bsup>(Vr K v) n\\<^esup>; (Abs (n_val K v x)) \\<le> n\\<rbrakk> \\<Longrightarrow>\n                x \\<cdot>\\<^sub>r b \\<in> (vp K v)\\<^bsup>(Vr K v) (n + (n_val K v x))\\<^esup>\"", "lemma (in Corps) convergenceTr1:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n      b \\<in> (vp K v)\\<^bsup>(Vr K v) (n + Abs (n_val K v x))\\<^esup>; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n                                 x \\<cdot>\\<^sub>r b \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\"", "lemma (in Corps) vp_potent_zero:\"\\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n             (n = \\<infinity>) = (vp K v \\<^bsup>(Vr K v) n\\<^esup> = {\\<zero>\\<^bsub>Vr K v\\<^esub>})\"", "lemma (in Corps) Vr_potent_eqTr1:\"\\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n        (vp K v) \\<^bsup>(Vr K v) n\\<^esup> = (vp K v) \\<^bsup>(Vr K v) m\\<^esup>; m = 0\\<rbrakk>  \\<Longrightarrow>  n = m\"", "lemma (in Corps) Vr_potent_eqTr2:\"\\<lbrakk>valuation K v;\n        (vp K v) \\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup> = (vp K v) \\<^bsup>\\<diamondsuit>(Vr K v) m\\<^esup>\\<rbrakk>  \\<Longrightarrow>   n = m\"", "lemma (in Corps) Vr_potent_eq:\"\\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n              (vp K v) \\<^bsup>(Vr K v) n\\<^esup> = (vp K v) \\<^bsup>(Vr K v) m\\<^esup>\\<rbrakk> \\<Longrightarrow>  n = m\"", "lemma (in Corps) Vr_prime_maximalTr1:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n       Suc 0 < n\\<rbrakk>  \\<Longrightarrow> x \\<cdot>\\<^sub>r\\<^bsub>(Vr K v)\\<^esub> (x^\\<^bsup>K (n - Suc 0)\\<^esup>) \\<in> (Vr K v) \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\"", "lemma (in Corps) Vr_prime_maximalTr2:\"\\<lbrakk> valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>;\n  Suc 0 < n\\<rbrakk> \\<Longrightarrow> x \\<notin> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>) \\<and> x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<notin> (Vr K v) \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\"", "lemma (in Corps) Vring_prime_maximal:\"\\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n      I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk> \\<Longrightarrow> maximal_ideal (Vr K v) I\"", "lemma (in Corps) field_frac1:\"\\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow> x = x \\<cdot>\\<^sub>r ((1\\<^sub>r)\\<^bsup>\\<hyphen>K\\<^esup>)\"", "lemma (in Corps) field_frac2:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x = (1\\<^sub>r) \\<cdot>\\<^sub>r ((x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsup>\\<hyphen>K\\<^esup>)\"", "lemma (in Corps) val_nonpos_inv_pos:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n        \\<not> 0 \\<le> (v x)\\<rbrakk>  \\<Longrightarrow> 0 < (v (x\\<^bsup>\\<hyphen>K\\<^esup>))\"", "lemma (in Corps) frac_Vr_is_K:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n \\<exists>s\\<in>carrier (Vr K v). \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}. x = s \\<cdot>\\<^sub>r (t\\<^bsup>\\<hyphen>K\\<^esup>)\"", "lemma (in Corps) valuations_eqTr1:\"\\<lbrakk>valuation K v; valuation K v';\n Vr K v = Vr K v'; \\<forall>x\\<in>carrier (Vr K v). v x = v' x\\<rbrakk> \\<Longrightarrow> v = v'\"", "lemma (in Corps) ridmap_rhom:\"\\<lbrakk> valuation K v; valuation K v';\n carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk> \\<Longrightarrow>\n      ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')\"", "lemma (in Corps) contract_ideal:\"\\<lbrakk>valuation K v; valuation K v';\n                 carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk> \\<Longrightarrow>\n                       ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\"", "lemma (in Corps) contract_prime:\"\\<lbrakk>valuation K v; valuation K v';\n      carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>  \\<Longrightarrow>\n      prime_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\"", "lemma (in Corps) valuation_equivTr:\"\\<lbrakk>valuation K v; valuation K v';\n      x \\<in> carrier K;  0 < (v' x); carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n      \\<Longrightarrow> 0 \\<le> (v x)\"", "lemma (in Corps) contract_maximal:\"\\<lbrakk>valuation K v; valuation K v';\n  carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk> \\<Longrightarrow>\n  maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\"", "lemma (in Corps) valuation_equivTr1:\"\\<lbrakk>valuation K v; valuation K v';\n \\<forall>x\\<in>carrier K. 0 \\<le> (v x) \\<longrightarrow> 0 \\<le> (v' x)\\<rbrakk> \\<Longrightarrow>\n                carrier (Vr K v) \\<subseteq> carrier (Vr K v')\"", "lemma (in Corps) valuation_equivTr2:\"\\<lbrakk>valuation K v; valuation K v';\n carrier (Vr K v) \\<subseteq> carrier (Vr K v'); vp K v = carrier (Vr K v) \\<inter> vp K v'\\<rbrakk>\n  \\<Longrightarrow>  carrier (Vr K v') \\<subseteq> carrier (Vr K v)\"", "lemma (in Corps) eq_carr_eq_Vring:\" \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) = carrier (Vr K v')\\<rbrakk> \\<Longrightarrow> Vr K v = Vr K v'\"", "lemma (in Corps) valuations_equiv:\"\\<lbrakk>valuation K v; valuation K v';\n    \\<forall>x\\<in>carrier K. 0 \\<le> (v x) \\<longrightarrow> 0 \\<le> (v' x)\\<rbrakk>  \\<Longrightarrow> v_equiv K v v'\"", "lemma (in Corps) val_equiv_axiom1:\"valuation K v \\<Longrightarrow> v_equiv K v v\"", "lemma (in Corps) val_equiv_axiom2:\"\\<lbrakk> valuation K v; valuation K v';\n      v_equiv K v v'\\<rbrakk> \\<Longrightarrow> v_equiv K v' v\"", "lemma (in Corps) val_equiv_axiom3:\"\\<lbrakk> valuation K v; valuation K v';\n valuation K v'; v_equiv K v v'; v_equiv K v' v''\\<rbrakk> \\<Longrightarrow>  v_equiv K v v''\"", "lemma (in Corps) n_val_equiv_val:\"\\<lbrakk> valuation K v\\<rbrakk> \\<Longrightarrow>\n                               v_equiv K v (n_val K v)\"", "lemma (in Corps) val_in_P_valuation:\"\\<lbrakk>valuation K v; v' \\<in> P\\<^bsub>K v\\<^esub>\\<rbrakk> \\<Longrightarrow>\n       valuation K v'\"", "lemma (in Corps) vals_in_P_equiv:\"\\<lbrakk> valuation K v; v' \\<in> P\\<^bsub>K v\\<^esub>\\<rbrakk> \\<Longrightarrow>\n       v_equiv K v v'\"", "lemma (in Corps) v_in_prime_v:\"valuation K v \\<Longrightarrow> v \\<in> P\\<^bsub>K v\\<^esub>\"", "lemma (in Corps) some_in_prime_divisor:\"valuation K v \\<Longrightarrow>\n             (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>) \\<in>  P\\<^bsub>K v\\<^esub>\"", "lemma (in Corps) valuation_some_in_prime_divisor:\"valuation K v\n          \\<Longrightarrow>  valuation K (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>)\"", "lemma (in Corps) valuation_some_in_prime_divisor1:\"P \\<in> Pds  \\<Longrightarrow>\n                  valuation K (SOME w. w \\<in> P)\"", "lemma (in Corps) representative_of_pd_valuation:\n           \"P \\<in> Pds \\<Longrightarrow> valuation K (\\<nu>\\<^bsub>K P\\<^esub>)\"", "lemma (in Corps) some_in_P_equiv:\"valuation K v \\<Longrightarrow>\n                  v_equiv K v (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>)\"", "lemma (in Corps) n_val_n_val1:\"P \\<in> Pds  \\<Longrightarrow> n_val K (\\<nu>\\<^bsub>K P\\<^esub>) = (\\<nu>\\<^bsub>K P\\<^esub>)\"", "lemma (in Corps) P_eq_val_equiv:\"\\<lbrakk>valuation K v; valuation K v'\\<rbrakk> \\<Longrightarrow>\n        (v_equiv K v v') = (P\\<^bsub>K v\\<^esub> =  P\\<^bsub>K v'\\<^esub>)\"", "lemma (in Corps) unique_n_valuation:\"\\<lbrakk> P \\<in> Pds\\<^bsub>K\\<^esub>; P' \\<in> Pds\\<rbrakk> \\<Longrightarrow>\n                (P = P') =  (\\<nu>\\<^bsub>K P\\<^esub> = \\<nu>\\<^bsub>K P'\\<^esub>)\"", "lemma (in Corps) n_val_representative:\"P \\<in> Pds \\<Longrightarrow>  (\\<nu>\\<^bsub>K P\\<^esub>) \\<in> P\"", "lemma (in Corps) val_equiv_eq_pdiv:\"\\<lbrakk> P \\<in> Pds\\<^bsub>K\\<^esub>; P'\\<in> Pds\\<^bsub>K\\<^esub>; valuation K v;\n         valuation K v'; v_equiv K v v'; v \\<in> P; v' \\<in> P' \\<rbrakk> \\<Longrightarrow>  P = P'\"", "lemma (in Corps) distinct_p_divisors:\"\\<lbrakk> P \\<in> Pds\\<^bsub>K\\<^esub>; P' \\<in> Pds\\<^bsub>K\\<^esub>\\<rbrakk> \\<Longrightarrow>\n          (\\<not> P = P') =  (\\<not> v_equiv K (\\<nu>\\<^bsub>K P\\<^esub>) (\\<nu>\\<^bsub>K P'\\<^esub>))\"", "lemma (in Corps) Ostrowski_elem_0:\"\\<lbrakk>vals_nonequiv K n vv; x \\<in> carrier K;\n Ostrowski_elem K n vv x\\<rbrakk> \\<Longrightarrow> 0 < (vv 0 (1\\<^sub>r \\<plusminus> (-\\<^sub>a x)))\"", "lemma (in Corps) Ostrowski_elem_Suc:\"\\<lbrakk>vals_nonequiv K n vv; x \\<in> carrier K;\n  Ostrowski_elem K n vv x; j \\<in> nset (Suc 0) n\\<rbrakk> \\<Longrightarrow> 0 < (vv j x)\"", "lemma (in Corps) vals_nonequiv_valuation:\"\\<lbrakk>vals_nonequiv K n vv; m \\<le> n\\<rbrakk> \\<Longrightarrow>\n       valuation K (vv m)\"", "lemma (in Corps) vals_nonequiv:\"\\<lbrakk> vals_nonequiv K (Suc (Suc n)) vv;\n i \\<le> (Suc (Suc n)); j \\<le> (Suc (Suc n)); i \\<noteq> j\\<rbrakk> \\<Longrightarrow>\n                                   \\<not> (v_equiv K (vv i) (vv j))\"", "lemma (in Corps) skip_vals_nonequiv:\"vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n  vals_nonequiv K (Suc n) (compose {l. l \\<le> (Suc n)} vv (skip j))\"", "lemma (in Corps) not_v_equiv_reflex:\"\\<lbrakk>valuation K v; valuation K v';\n \\<not> v_equiv K v v'\\<rbrakk> \\<Longrightarrow> \\<not> v_equiv K v' v \"", "lemma (in Corps) nonequiv_ex_Ostrowski_elem:\"\\<lbrakk>valuation K v; valuation K v';\n \\<not> v_equiv K v v'\\<rbrakk> \\<Longrightarrow> \\<exists>x\\<in>carrier K. 0 \\<le> (v x) \\<and> (v' x) < 0\"", "lemma (in Corps) field_op_minus:\"\\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                              -\\<^sub>a (a \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)) = (-\\<^sub>a a) \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)\"", "lemma (in Corps) field_one_plus_frac1:\"\\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>\\<rbrakk>\n \\<Longrightarrow> 1\\<^sub>r \\<plusminus> (a \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)) = (b \\<plusminus> a) \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)\"", "lemma (in Corps) field_one_plus_frac2:\"\\<lbrakk>a \\<in> carrier K; b \\<in> carrier K;\n a \\<plusminus> b \\<noteq> \\<zero>\\<rbrakk>  \\<Longrightarrow> 1\\<^sub>r \\<plusminus> (-\\<^sub>a (a \\<cdot>\\<^sub>r (a \\<plusminus> b)\\<^bsup>\\<hyphen>K\\<^esup>)) = b \\<cdot>\\<^sub>r ((a \\<plusminus> b)\\<^bsup>\\<hyphen>K\\<^esup>)\"", "lemma (in Corps) field_one_plus_frac3:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n      1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow>\n      1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                    (1\\<^sub>r \\<plusminus> -\\<^sub>a x^\\<^bsup>K (Suc (Suc 0))\\<^esup>) \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\"", "lemma (in Corps) OstrowskiTr1:\"\\<lbrakk> valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n      0 \\<le> (v s); v t < 0\\<rbrakk>  \\<Longrightarrow> s \\<plusminus> t \\<noteq> \\<zero>\"", "lemma (in Corps) OstrowskiTr2:\"\\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n  0 \\<le> (v s); v t < 0\\<rbrakk>  \\<Longrightarrow> 0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a ((t \\<cdot>\\<^sub>r ((s \\<plusminus> t)\\<^bsup>\\<hyphen>K\\<^esup>))))))\"", "lemma (in Corps) OstrowskiTr3:\"\\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n      0 \\<le> (v t); v s < 0\\<rbrakk>  \\<Longrightarrow> 0 < (v (t \\<cdot>\\<^sub>r (( s \\<plusminus> t)\\<^bsup>\\<hyphen>K\\<^esup>)))\"", "lemma (in Corps) restrict_Ostrowski_elem:\"\\<lbrakk> x \\<in> carrier K;\n  Ostrowski_elem K (Suc (Suc n)) vv x\\<rbrakk> \\<Longrightarrow> Ostrowski_elem K (Suc n) vv x\"", "lemma (in Corps) restrict_vals_nonequiv:\"vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n                  vals_nonequiv K (Suc n) vv\"", "lemma (in Corps) restrict_vals_nonequiv1:\"vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n       vals_nonequiv K (Suc n) (compose {h. h \\<le> (Suc n)} vv (skip 1))\"", "lemma (in Corps) restrict_vals_nonequiv2:\"\\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv\\<rbrakk>\n      \\<Longrightarrow> vals_nonequiv K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 2))\"", "lemma (in Corps)  OstrowskiTr31:\"\\<lbrakk>valuation K v; s \\<in> carrier K;\n        0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a s)))\\<rbrakk> \\<Longrightarrow> s \\<noteq> \\<zero>\"", "lemma (in Corps) OstrowskiTr32:\"\\<lbrakk>valuation K v; s \\<in> carrier K;\n           0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a s)))\\<rbrakk> \\<Longrightarrow> 0 \\<le> (v s)\"", "lemma (in Corps) OstrowskiTr4:\"\\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n      0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a s))); 0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a t)))\\<rbrakk>  \\<Longrightarrow>\n                              0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a (s \\<cdot>\\<^sub>r t))))\"", "lemma (in Corps) OstrowskiTr5:\"\\<lbrakk> vals_nonequiv K (Suc (Suc n)) vv;\n  s \\<in> carrier K; t \\<in> carrier K;\n  0 \\<le> (vv (Suc 0)) s \\<and> 0 \\<le> (vv (Suc (Suc 0))) t;\n  Ostrowski_elem K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 1)) s;\n  Ostrowski_elem K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 2)) t\\<rbrakk> \\<Longrightarrow>\n  Ostrowski_elem K (Suc (Suc n)) vv (s \\<cdot>\\<^sub>r t)\"", "lemma (in Corps) one_plus_x_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0\\<rbrakk>\n      \\<Longrightarrow> 1\\<^sub>r \\<plusminus> x \\<in> carrier K \\<and> v (1\\<^sub>r \\<plusminus> x) < 0\"", "lemma (in Corps)  val_neg_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0\\<rbrakk> \\<Longrightarrow>\n                                     x \\<noteq> \\<zero>\"", "lemma (in Corps) OstrowskiTr6:\"\\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> (v x)\\<rbrakk> \\<Longrightarrow>\n       (1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<in> carrier K - {\\<zero>}\"", "lemma (in Corps) OstrowskiTr7:\"\\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> (v x)\\<rbrakk> \\<Longrightarrow>\n  1\\<^sub>r \\<plusminus> -\\<^sub>a (x \\<cdot>\\<^sub>r ((1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen>K\\<^esup>)) =\n     (1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r ((1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen>K\\<^esup>)\"", "lemma (in Corps) Ostrowski_elem_nonzero:\"\\<lbrakk>vals_nonequiv K (Suc n) vv;\n x \\<in> carrier K; Ostrowski_elem K (Suc n) vv x\\<rbrakk> \\<Longrightarrow> x \\<noteq> \\<zero>\"", "lemma (in Corps) Ostrowski_elem_not_one:\"\\<lbrakk>vals_nonequiv K (Suc n) vv;\n      x \\<in> carrier K; Ostrowski_elem K (Suc n) vv x\\<rbrakk>  \\<Longrightarrow>  1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<noteq> \\<zero>\"", "lemma (in Corps) val_unit_cond:\"\\<lbrakk> valuation K v; x \\<in> carrier K;\n      0 < (v (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<rbrakk>  \\<Longrightarrow> v x = 0\""], "translations": [["", "lemma int_less_mono:\"(a::nat) < b \\<Longrightarrow> int a < int b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a < b \\<Longrightarrow> int a < int b", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma zless_trans:\"\\<lbrakk>(i::int) < j; j < k\\<rbrakk> \\<Longrightarrow> i < k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i < j; j < k\\<rbrakk> \\<Longrightarrow> i < k", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma zmult_pos_bignumTr0:\"\\<exists>L. \\<forall>m. L < m \\<longrightarrow> z < x + int m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>L. \\<forall>m>L. z < x + int m", "by (subgoal_tac \"\\<forall>m. (nat((abs z) + (abs x))) < m \\<longrightarrow> z < x + int m\",\n       blast, rule allI, rule impI, arith)"], ["", "lemma zle_less_trans:\"\\<lbrakk>(i::int) \\<le> j; j < k\\<rbrakk> \\<Longrightarrow> i < k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<le> j; j < k\\<rbrakk> \\<Longrightarrow> i < k", "apply (simp add:less_le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  zless_le_trans:\"\\<lbrakk>(i::int) < j; j \\<le> k\\<rbrakk> \\<Longrightarrow> i < k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i < j; j \\<le> k\\<rbrakk> \\<Longrightarrow> i < k", "apply (simp add:less_le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma zmult_pos_bignumTr:\"0 < (a::int) \\<Longrightarrow>\n                   \\<exists>l. \\<forall>m. l < m \\<longrightarrow> z < x + (int m) * a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < a \\<Longrightarrow> \\<exists>l. \\<forall>m>l. z < x + int m * a", "apply (cut_tac zmult_pos_bignumTr0[of \"z\" \"x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < a; \\<exists>L. \\<forall>m>L. z < x + int m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l. \\<forall>m>l. z < x + int m * a", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>L.\n       \\<lbrakk>0 < a; \\<forall>m>L. z < x + int m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l. \\<forall>m>l. z < x + int m * a", "apply (subgoal_tac \"\\<forall>m. L < m \\<longrightarrow> z < x + int m * a\", blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>L.\n       \\<lbrakk>0 < a; \\<forall>m>L. z < x + int m\\<rbrakk>\n       \\<Longrightarrow> \\<forall>m>L. z < x + int m * a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>L m.\n       \\<lbrakk>0 < a; \\<forall>m>L. z < x + int m; L < m\\<rbrakk>\n       \\<Longrightarrow> z < x + int m * a", "apply (drule_tac a = m in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m\\<rbrakk>\n       \\<Longrightarrow> z < x + int m * a", "apply (subgoal_tac \"0 \\<le> int m\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m; 0 \\<le> int m\\<rbrakk>\n       \\<Longrightarrow> z < x + int m * a\n 2. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> int m", "apply (frule_tac a = \"int m\" and b = a in pos_zmult_pos, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m; 0 \\<le> int m;\n        int m \\<le> int m * a\\<rbrakk>\n       \\<Longrightarrow> z < x + int m * a\n 2. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> int m", "apply (cut_tac order_refl[of \"x\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m; 0 \\<le> int m;\n        int m \\<le> int m * a; x \\<le> x\\<rbrakk>\n       \\<Longrightarrow> z < x + int m * a\n 2. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> int m", "apply (frule_tac z' = \"int m\" and z = \"int m * a\" in\n         zadd_zle_mono[of \"x\" \"x\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m; 0 \\<le> int m;\n        int m \\<le> int m * a; x \\<le> x;\n        x + int m \\<le> x + int m * a\\<rbrakk>\n       \\<Longrightarrow> z < x + int m * a\n 2. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> int m", "apply (rule_tac y = \"x + int m\" and z = \"x + (int m)* a\" in\n         less_le_trans[of \"z\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>L m.\n       \\<lbrakk>0 < a; L < m; z < x + int m\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> int m", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  ale_shift:\"\\<lbrakk>(x::ant)\\<le> y; y = z\\<rbrakk> \\<Longrightarrow> x \\<le> z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<le> y; y = z\\<rbrakk> \\<Longrightarrow> x \\<le> z", "by simp"], ["", "lemma aneg_na_0[simp]:\"a < 0 \\<Longrightarrow> na a = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a < 0 \\<Longrightarrow> na a = 0", "by (simp add:na_def)"], ["", "lemma amult_an_an:\"an (m * n) = (an m) * (an n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. an (m * n) = an m * an n", "apply (simp add:an_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ant (int m * int n) = ant (int m) * ant (int n)", "apply (simp add: of_nat_mult a_z_z)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  adiv :: \"[ant, ant] \\<Rightarrow> ant\" (infixl \"adiv\" 200) where\n  \"x adiv y = ant ((tna x) div (tna y))\""], ["", "definition\n  amod :: \"[ant, ant] \\<Rightarrow> ant\" (infixl \"amod\" 200) where\n  \"x amod y = ant ((tna x) mod (tna y))\""], ["", "lemma apos_amod_conj:\"0 < ant b \\<Longrightarrow>\n                  0 \\<le> (ant a) amod (ant b) \\<and> (ant a) amod (ant b) < (ant b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < ant b \\<Longrightarrow>\n    0 \\<le> ant a amod ant b \\<and> ant a amod ant b < ant b", "by (simp add:amod_def tna_ant, simp only:ant_0[THEN sym],\n       simp add:aless_zless)"], ["", "lemma  amod_adiv_equality:\n       \"(ant a) = (a div b) *\\<^sub>a (ant b) + ant (a mod b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ant a = (a div b) *\\<^sub>a ant b + ant (a mod b)", "apply (simp add:adiv_def tna_ant a_z_z a_zpz  asprod_mult)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma asp_z_Z:\"z *\\<^sub>a ant x \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z *\\<^sub>a ant x \\<in> Z\\<^sub>\\<infinity>", "by (simp add:asprod_mult z_in_aug_inf)"], ["", "lemma apos_in_aug_inf:\"0 \\<le> a \\<Longrightarrow> a \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> a \\<Longrightarrow> a \\<in> Z\\<^sub>\\<infinity>", "by (simp add:aug_inf_def, rule contrapos_pp, simp+,\n    cut_tac minf_le_any[of \"0\"], frule ale_antisym[of \"0\" \"-\\<infinity>\"],\n    assumption+, simp)"], ["", "lemma  amult_1_both:\"\\<lbrakk>0 < (w::ant); x * w = 1\\<rbrakk> \\<Longrightarrow> x = 1 \\<and> w = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < w; x * w = 1\\<rbrakk> \\<Longrightarrow> x = 1 \\<and> w = 1", "apply (cut_tac mem_ant[of \"x\"], cut_tac mem_ant[of \"w\"],\n      (erule disjE)+, simp,\n      (frule sym, thin_tac \"\\<infinity> = 1\", simp only:ant_1[THEN sym],\n       simp del:ant_1))"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < w; x * w = 1; x = - \\<infinity>;\n     (\\<exists>z. w = ant z) \\<or> w = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = 1 \\<and> w = 1\n 2. \\<lbrakk>0 < w; x * w = 1;\n     w = - \\<infinity> \\<or> (\\<exists>z. w = ant z) \\<or> w = \\<infinity>;\n     (\\<exists>z. x = ant z) \\<or> x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = 1 \\<and> w = 1", "apply (erule disjE, erule exE, simp,\n       (frule sym, thin_tac \"-\\<infinity> = 1\", simp only:ant_1[THEN sym],\n       simp del:ant_1), simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < \\<infinity>; - \\<infinity> = 1; x = 1;\n     w = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> \\<infinity> = 1\n 2. \\<lbrakk>0 < w; x * w = 1;\n     w = - \\<infinity> \\<or> (\\<exists>z. w = ant z) \\<or> w = \\<infinity>;\n     (\\<exists>z. x = ant z) \\<or> x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = 1 \\<and> w = 1", "apply (frule sym, thin_tac \"-\\<infinity> = 1\", simp only:ant_1[THEN sym],\n       simp del:ant_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < w; x * w = 1;\n     w = - \\<infinity> \\<or> (\\<exists>z. w = ant z) \\<or> w = \\<infinity>;\n     (\\<exists>z. x = ant z) \\<or> x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = 1 \\<and> w = 1", "apply ((erule disjE)+, erule exE, simp,\n       frule_tac aless_imp_le[of \"0\" \"-\\<infinity>\"],\n       cut_tac minf_le_any[of \"0\"],\n       frule ale_antisym[of \"0\" \"-\\<infinity>\"], assumption+,\n       simp only:ant_0[THEN sym], simp,\n       frule sym, thin_tac \"-\\<infinity> = 1\", simp only:ant_1[THEN sym],\n       simp del:ant_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < w; x * w = 1;\n     (\\<exists>z. x = ant z) \\<or> x = \\<infinity>;\n     (\\<exists>z. w = ant z) \\<or> w = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = 1 \\<and> w = 1", "apply ((erule disjE)+, (erule exE)+, simp only:ant_1[THEN sym],\n       simp del:ant_1 add:a_z_z,\n       (cut_tac a = z and b = za in mult.commute, simp,\n        cut_tac z = za and z' = z in  times_1_both, assumption+),\n       simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < w; x * w = 1; \\<exists>z. x = ant z;\n     w = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = 1 \\<and> w = 1\n 2. \\<lbrakk>0 < w; x * w = 1;\n     (\\<exists>z. w = ant z) \\<or> w = \\<infinity>; x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = 1 \\<and> w = 1", "apply (erule exE, simp,\n       cut_tac x = z and y = 0 in less_linear, erule disjE, simp,\n       frule sym, thin_tac \"-\\<infinity> = 1\", simp only:ant_1[THEN sym],\n       simp del:ant_1,\n       erule disjE, simp add:ant_0, simp,\n       frule sym, thin_tac \"\\<infinity> = 1\", simp only:ant_1[THEN sym],\n       simp del:ant_1,\n       erule disjE, erule exE, simp,\n       frule sym, thin_tac \"\\<infinity> = 1\", simp only:ant_1[THEN sym],\n       simp del:ant_1, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma poss_int_neq_0:\"0 < (z::int) \\<Longrightarrow> z \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < z \\<Longrightarrow> z \\<noteq> 0", "by simp"], ["", "lemma aadd_neg_negg[simp]:\"\\<lbrakk>a \\<le> (0::ant); b < 0\\<rbrakk> \\<Longrightarrow> a + b < 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<le> 0; b < 0\\<rbrakk> \\<Longrightarrow> a + b < 0", "apply (frule ale_minus[of \"a\" \"0\"], simp,\n       frule aless_minus[of \"b\" \"0\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<le> 0; b < 0; 0 \\<le> - a; 0 < - b\\<rbrakk>\n    \\<Longrightarrow> a + b < 0", "apply (frule aadd_pos_poss[of \"-a\" \"-b\"], assumption+,\n       simp add:aminus_add_distrib[THEN sym, of \"a\" \"b\"],\n       frule aless_minus[of \"0\" \"-(a + b)\"], simp add:a_minus_minus)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma aadd_two_negg[simp]:\"\\<lbrakk>a < (0::ant); b < 0\\<rbrakk> \\<Longrightarrow> a + b < 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a < 0; b < 0\\<rbrakk> \\<Longrightarrow> a + b < 0", "by auto"], ["", "lemma amin_aminTr:\"(z::ant) \\<le> z' \\<Longrightarrow> amin z w \\<le> amin z' w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<le> z' \\<Longrightarrow> amin z w \\<le> amin z' w", "by (simp add:amin_def, simp add:aneg_le,\n      (rule impI)+, frule aless_le_trans[of \"w\" \"z\" \"z'\"],\n      assumption+, simp)"], ["", "lemma amin_le1:\"(z::ant) \\<le> z' \\<Longrightarrow> (amin z w) \\<le> z'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<le> z' \\<Longrightarrow> amin z w \\<le> z'", "by (simp add:amin_def, simp add:aneg_le,\n       rule impI, frule aless_le_trans[of \"w\" \"z\" \"z'\"],\n       assumption+, simp add:aless_imp_le)"], ["", "lemma amin_le2:\"(z::ant) \\<le> z' \\<Longrightarrow> (amin w z) \\<le> z'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<le> z' \\<Longrightarrow> amin w z \\<le> z'", "by (simp add:amin_def, rule impI,\n       frule ale_trans[of \"w\" \"z\" \"z'\"], assumption+)"], ["", "lemma  Amin_geTr:\"(\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>j \\<le> n. z \\<le> (f j)) \\<longrightarrow>\n                                 z \\<le> (Amin n f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>j\\<le>n. z \\<le> f j) \\<longrightarrow>\n    z \\<le> Amin n f", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>j\\<le>0. z \\<le> f j) \\<longrightarrow>\n    z \\<le> Amin 0 f\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>n. z \\<le> f j) \\<longrightarrow>\n       z \\<le> Amin n f \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>Suc n. z \\<le> f j) \\<longrightarrow>\n       z \\<le> Amin (Suc n) f", "apply (rule impI, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>n. z \\<le> f j) \\<longrightarrow>\n       z \\<le> Amin n f \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>Suc n. z \\<le> f j) \\<longrightarrow>\n       z \\<le> Amin (Suc n) f", "apply (rule impI, (erule conjE)+,\n       cut_tac Nsetn_sub_mem1[of n], simp,\n       drule_tac x = \"Suc n\" in spec, simp,\n       rule_tac z = z and x = \"Amin n f\" and y = \"f(Suc n)\" in amin_ge1,\n       simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Amin_ge:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>; \\<forall>j \\<le> n. z \\<le> (f j)\\<rbrakk> \\<Longrightarrow>\n                             z \\<le> (Amin n f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>;\n     \\<forall>j\\<le>n. z \\<le> f j\\<rbrakk>\n    \\<Longrightarrow> z \\<le> Amin n f", "by (simp add:Amin_geTr)"], ["", "definition\n  Abs :: \"ant \\<Rightarrow> ant\" where\n  \"Abs z = (if z < 0 then -z else z)\""], ["", "lemma Abs_pos:\"0 \\<le> Abs z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> Abs z", "by (simp add:Abs_def, rule conjI, rule impI,\n       cut_tac aless_minus[of \"z\" \"0\"], simp,\n       assumption,\n       rule impI, simp add:aneg_less[of \"z\" \"0\"])"], ["", "lemma Abs_x_plus_x_pos:\"0 \\<le> (Abs x) + x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> Abs x + x", "apply (case_tac \"x < 0\",\n       simp add:Abs_def, simp add:aadd_minus_inv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> x < 0 \\<Longrightarrow> 0 \\<le> Abs x + x", "apply (simp add:aneg_less,\n       simp add:Abs_def, simp add:aneg_less[THEN sym, of \"0\" \"x\"],\n       simp add:aneg_less[of \"x\" \"0\"], simp add:aadd_two_pos)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  Abs_ge_self:\"x \\<le> Abs x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> Abs x", "apply (simp add:Abs_def, rule impI,\n       cut_tac ale_minus[of \"x\" \"0\"],\n       simp add:aminus_0, simp add:aless_imp_le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  na_1:\"na 1 = Suc 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. na 1 = Suc 0", "apply (simp only:ant_1[THEN sym], simp only:na_def,\n       simp only:ant_0[THEN sym], simp only:aless_zless[of \"1\" \"0\"],\n       simp, subgoal_tac \"\\<infinity> \\<noteq> 1\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<infinity> \\<noteq> 1 \\<Longrightarrow> nat (tna 1) = Suc 0\n 2. \\<infinity> \\<noteq> 1", "apply (simp only:ant_1[THEN sym], simp only:tna_ant,\n       rule not_sym, simp only:ant_1[THEN sym], simp del:ant_1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ant_int:\"ant (int n) = an n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ant (int n) = an n", "by (simp add:an_def)"], ["", "lemma int_nat:\"0 < z \\<Longrightarrow> int (nat z) = z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < z \\<Longrightarrow> int (nat z) = z", "by arith"], ["", "lemma int_ex_nat:\"0 < z \\<Longrightarrow> \\<exists>n. int n = z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < z \\<Longrightarrow> \\<exists>n. int n = z", "by (cut_tac int_nat[of z], blast, assumption)"], ["", "lemma eq_nat_pos_ints:\n  \"\\<lbrakk>nat (z::int) = nat (z'::int); 0 \\<le> z; 0 \\<le> z'\\<rbrakk> \\<Longrightarrow> z = z'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>nat z = nat z'; 0 \\<le> z; 0 \\<le> z'\\<rbrakk>\n    \\<Longrightarrow> z = z'", "by simp"], ["", "lemma a_p1_gt[simp]:\"\\<lbrakk>a \\<noteq> \\<infinity>; a \\<noteq> -\\<infinity>\\<rbrakk>  \\<Longrightarrow> a < a + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; a \\<noteq> - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < a + 1", "apply (cut_tac aadd_poss_less[of a 1],\n       simp add:aadd_commute, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; a \\<noteq> - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> 0 < 1", "apply (cut_tac zposs_aposss[of 1], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  gt_na_poss:\"(na a) < m \\<Longrightarrow> 0 < m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. na a < m \\<Longrightarrow> 0 < m", "apply (simp add:na_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma azmult_less:\"\\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x\\<rbrakk>\n                         \\<Longrightarrow> a < int m *\\<^sub>a x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (cut_tac mem_ant[of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     a = - \\<infinity> \\<or>\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     a = - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x\n 2. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (case_tac \"x = \\<infinity>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x; a = - \\<infinity>;\n     x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x\n 2. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x; a = - \\<infinity>;\n     x \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x\n 3. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>na (- \\<infinity>) < m; 0 < \\<infinity>; a = - \\<infinity>;\n     x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> - \\<infinity> < \\<infinity>\n 2. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x; a = - \\<infinity>;\n     x \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x\n 3. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (subst less_le[of \"-\\<infinity>\" \"\\<infinity>\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>na (- \\<infinity>) < m; 0 < \\<infinity>; a = - \\<infinity>;\n     x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> - \\<infinity> \\<le> \\<infinity> \\<and>\n                      - \\<infinity> \\<noteq> \\<infinity>\n 2. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x; a = - \\<infinity>;\n     x \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x\n 3. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x; a = - \\<infinity>;\n     x \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x\n 2. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (frule aless_imp_le[of \"0\" \"x\"], frule apos_neq_minf[of \"x\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x; a = - \\<infinity>;\n     x \\<noteq> \\<infinity>; 0 \\<le> x; x \\<noteq> - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x\n 2. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (cut_tac mem_ant[of \"x\"], simp, erule exE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>na (- \\<infinity>) < m; 0 < z; a = - \\<infinity>;\n        0 \\<le> ant z; x = ant z\\<rbrakk>\n       \\<Longrightarrow> - \\<infinity> < int m *\\<^sub>a ant z\n 2. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (simp add:asprod_amult a_z_z)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<noteq> \\<infinity>; na a < m; 0 < x;\n     (\\<exists>z. a = ant z) \\<or> a = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> a < int m *\\<^sub>a x", "apply (simp, erule exE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>na (ant z) < m; 0 < x; a = ant z\\<rbrakk>\n       \\<Longrightarrow> ant z < int m *\\<^sub>a x", "apply (frule_tac a = \"ant z\" in gt_na_poss[of _ \"m\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>na (ant z) < m; 0 < x; a = ant z; 0 < m\\<rbrakk>\n       \\<Longrightarrow> ant z < int m *\\<^sub>a x", "apply (case_tac \"x = \\<infinity>\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>na (ant z) < m; 0 < x; a = ant z; 0 < m;\n        x \\<noteq> \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> ant z < int m *\\<^sub>a x", "apply (frule aless_imp_le[of \"0\" \"x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>na (ant z) < m; 0 < x; a = ant z; 0 < m;\n        x \\<noteq> \\<infinity>; 0 \\<le> x\\<rbrakk>\n       \\<Longrightarrow> ant z < int m *\\<^sub>a x", "apply (frule apos_neq_minf[of \"x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>na (ant z) < m; 0 < x; a = ant z; 0 < m;\n        x \\<noteq> \\<infinity>; 0 \\<le> x; x \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> ant z < int m *\\<^sub>a x", "apply (cut_tac mem_ant[of \"x\"], simp, erule exE,\n        simp add:asprod_amult a_z_z)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z za.\n       \\<lbrakk>na (ant z) < m; 0 < za; a = ant z; 0 \\<le> ant za;\n        x = ant za\\<rbrakk>\n       \\<Longrightarrow> ant z < ant (int m * za)", "apply (subst aless_zless)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z za.\n       \\<lbrakk>na (ant z) < m; 0 < za; a = ant z; 0 \\<le> ant za;\n        x = ant za\\<rbrakk>\n       \\<Longrightarrow> z < int m * za", "apply (cut_tac a = \"ant z\" in gt_na_poss[of _ \"m\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z za.\n       \\<lbrakk>na (ant z) < m; 0 < za; a = ant z; 0 \\<le> ant za;\n        x = ant za; 0 < m\\<rbrakk>\n       \\<Longrightarrow> z < int m * za", "apply (smt a0_less_int_conv aposs_na_poss int_less_mono int_nat na_def of_nat_0_le_iff pos_zmult_pos tna_ant z_neq_inf)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  zmult_gt_one:\"\\<lbrakk>2 \\<le> m; 0 < xa\\<rbrakk> \\<Longrightarrow> 1 < int m * xa\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>2 \\<le> m; 0 < xa\\<rbrakk> \\<Longrightarrow> 1 < int m * xa", "by (metis ge2_zmult_pos mult.commute)"], ["", "lemma zmult_pos:\"\\<lbrakk> 0 < m; 0 < (a::int)\\<rbrakk> \\<Longrightarrow> 0 < (int m) * a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < m; 0 < a\\<rbrakk> \\<Longrightarrow> 0 < int m * a", "by (frule zmult_zless_mono2[of \"0\" \"a\" \"int m\"], simp, simp)"], ["", "lemma  ant_int_na:\"\\<lbrakk>0 \\<le> a; a \\<noteq> \\<infinity> \\<rbrakk> \\<Longrightarrow> ant (int (na a)) = a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> a; a \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> ant (int (na a)) = a", "by (frule an_na[of \"a\"], assumption, simp add:an_def)"], ["", "lemma zpos_nat:\"0 \\<le> (z::int) \\<Longrightarrow> \\<exists>n. z = int n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> z \\<Longrightarrow> \\<exists>n. z = int n", "apply (subgoal_tac \"z = int (nat z)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 \\<le> z; z = int (nat z)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. z = int n\n 2. 0 \\<le> z \\<Longrightarrow> z = int (nat z)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> z \\<Longrightarrow> z = int (nat z)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"nsets\""], ["", "lemma nsetTr1:\"\\<lbrakk>j \\<in> nset a b; j \\<noteq> a\\<rbrakk> \\<Longrightarrow> j \\<in> nset (Suc a) b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<in> nset a b; j \\<noteq> a\\<rbrakk>\n    \\<Longrightarrow> j \\<in> nset (Suc a) b", "apply (simp add:nset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma nsetTr2:\"j \\<in> nset (Suc a) (Suc b) \\<Longrightarrow> j - Suc 0 \\<in> nset a b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. j \\<in> nset (Suc a) (Suc b) \\<Longrightarrow> j - Suc 0 \\<in> nset a b", "apply (simp add:nset_def, erule conjE,\n       simp add:skip_im_Tr4[of \"j\" \"b\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  nsetTr3:\"\\<lbrakk>j \\<noteq> Suc (Suc 0); j - Suc 0 \\<in> nset (Suc 0) (Suc n)\\<rbrakk>\n       \\<Longrightarrow>  Suc 0 < j - Suc 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> Suc (Suc 0);\n     j - Suc 0 \\<in> nset (Suc 0) (Suc n)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < j - Suc 0", "apply (simp add:nset_def, erule conjE, subgoal_tac \"j \\<noteq> 0\",\n       rule contrapos_pp, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Suc_leD1:\"Suc m \\<le> n \\<Longrightarrow> m < n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc m \\<le> n \\<Longrightarrow> m < n", "apply (insert lessI[of \"m\"],\n       rule less_le_trans[of \"m\" \"Suc m\" \"n\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma leI1:\"n < m \\<Longrightarrow> \\<not> ((m::nat) \\<le> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n < m \\<Longrightarrow> \\<not> m \\<le> n", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma neg_zle:\"\\<not> (z::int) \\<le> z' \\<Longrightarrow> z' < z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> z \\<le> z' \\<Longrightarrow> z' < z", "apply (simp add: not_le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma nset_m_m:\"nset m m = {m}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. nset m m = {m}", "by (simp add:nset_def,\n       rule equalityI, rule subsetI, simp,\n       rule subsetI, simp)"], ["", "lemma nset_Tr51:\"\\<lbrakk>j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> j - Suc 0 \\<in> nset (Suc 0) (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> j - Suc 0 \\<in> nset (Suc 0) (Suc n)", "apply (simp add:nset_def, (erule conjE)+,\n       frule_tac m = j and n = \"Suc (Suc n)\" and l = \"Suc 0\" in diff_le_mono,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma nset_Tr52:\"\\<lbrakk>j \\<noteq> Suc (Suc 0); Suc 0 \\<le> j - Suc 0\\<rbrakk>\n       \\<Longrightarrow> \\<not> j - Suc 0 \\<le> Suc 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> Suc (Suc 0); Suc 0 \\<le> j - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<not> j - Suc 0 \\<le> Suc 0", "by auto"], ["", "lemma nset_Suc:\"nset (Suc 0) (Suc (Suc n)) =\n                  nset (Suc 0) (Suc n) \\<union> {Suc (Suc n)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. nset (Suc 0) (Suc (Suc n)) = nset (Suc 0) (Suc n) \\<union> {Suc (Suc n)}", "by (auto simp add:nset_def)"], ["", "lemma AinequalityTr0:\"x \\<noteq> -\\<infinity> \\<Longrightarrow> \\<exists>L. (\\<forall>N. L < N \\<longrightarrow>\n                          (an m) < (x + an N))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<noteq> - \\<infinity> \\<Longrightarrow>\n    \\<exists>L. \\<forall>N>L. an m < x + an N", "apply (case_tac \"x = \\<infinity>\", simp add:an_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<noteq> - \\<infinity>; x \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>L. \\<forall>N>L. an m < x + an N", "apply (cut_tac mem_ant[of \"x\"], simp, erule exE, simp add:an_def a_zpz,\n       simp add:aless_zless,\n       cut_tac x = z in zmult_pos_bignumTr0[of \"int m\"], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma AinequalityTr:\"\\<lbrakk>0 < b \\<and> b \\<noteq> \\<infinity>; x \\<noteq> -\\<infinity>\\<rbrakk> \\<Longrightarrow> \\<exists>L. (\\<forall>N. L < N \\<longrightarrow>\n                          (an m) < (x + (int N) *\\<^sub>a b))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < b \\<and> b \\<noteq> \\<infinity>;\n     x \\<noteq> - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>L. \\<forall>N>L. an m < x + int N *\\<^sub>a b", "apply (frule_tac AinequalityTr0[of \"x\" \"m\"],\n       erule exE,\n       subgoal_tac \"\\<forall>N. L < N \\<longrightarrow> an m < x + (int N) *\\<^sub>a b\",\n       blast, rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>L N.\n       \\<lbrakk>0 < b \\<and> b \\<noteq> \\<infinity>;\n        x \\<noteq> - \\<infinity>; \\<forall>N>L. an m < x + an N;\n        L < N\\<rbrakk>\n       \\<Longrightarrow> an m < x + int N *\\<^sub>a b", "apply (drule_tac a = N in forall_spec, assumption,\n       erule conjE,\n       cut_tac N = N in asprod_ge[of \"b\"], assumption,\n       thin_tac \"x \\<noteq> - \\<infinity>\", thin_tac \"b \\<noteq> \\<infinity>\", thin_tac \"an m < x + an N\",\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>L N.\n       \\<lbrakk>x \\<noteq> - \\<infinity>; L < N; an m < x + an N; 0 < b;\n        b \\<noteq> \\<infinity>; an N \\<le> int N *\\<^sub>a b\\<rbrakk>\n       \\<Longrightarrow> an m < x + int N *\\<^sub>a b", "apply (frule_tac x = \"an N\" and y = \"int N *\\<^sub>a b\" and z = x in aadd_le_mono,\n        simp only:aadd_commute[of _ \"x\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma two_inequalities:\"\\<lbrakk>\\<forall>(n::nat). x < n \\<longrightarrow> P n; \\<forall>(n::nat). y < n \\<longrightarrow> Q n\\<rbrakk>\n \\<Longrightarrow>  \\<forall>n. (max x y) < n \\<longrightarrow> (P n) \\<and> (Q n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>n>x. P n; \\<forall>n>y. Q n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>n>max x y. P n \\<and> Q n", "by auto"], ["", "lemma multi_inequalityTr0:\"(\\<forall>j \\<le> (n::nat). (x j) \\<noteq> -\\<infinity> ) \\<longrightarrow>\n      (\\<exists>L. (\\<forall>N. L < N \\<longrightarrow>  (\\<forall>l \\<le> n. (an m) < (x l) + (an N))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n    (\\<exists>L. \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n    (\\<exists>L. \\<forall>N>L. \\<forall>l\\<le>0. an m < x l + an N)\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L.\n           \\<forall>N>L.\n              \\<forall>l\\<le>n. an m < x l + an N) \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L. \\<forall>N>L. \\<forall>l\\<le>Suc n. an m < x l + an N)", "apply (rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. x 0 \\<noteq> - \\<infinity> \\<Longrightarrow>\n    \\<exists>L. \\<forall>N>L. an m < x 0 + an N\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L.\n           \\<forall>N>L.\n              \\<forall>l\\<le>n. an m < x l + an N) \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L. \\<forall>N>L. \\<forall>l\\<le>Suc n. an m < x l + an N)", "apply (rule AinequalityTr0[of \"x 0\" \"m\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L.\n           \\<forall>N>L.\n              \\<forall>l\\<le>n. an m < x l + an N) \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L. \\<forall>N>L. \\<forall>l\\<le>Suc n. an m < x l + an N)", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L.\n           \\<forall>N>L.\n              \\<forall>l\\<le>n. an m < x l + an N) \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n       (\\<exists>L. \\<forall>N>L. \\<forall>l\\<le>Suc n. an m < x l + an N)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>Suc n. an m < x l + an N", "apply (subgoal_tac \"\\<forall>l. l \\<le> n \\<longrightarrow> l \\<le> (Suc n)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>\\<exists>L.\n                   \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>Suc n. an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n L.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>Suc n. an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (frule_tac a = \"Suc n\" in forall_spec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n L.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        x (Suc n) \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>Suc n. an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (frule_tac x = \"x (Suc n)\" in AinequalityTr0[of _ \"m\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n L.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        x (Suc n) \\<noteq> - \\<infinity>;\n        \\<exists>L. \\<forall>N>L. an m < x (Suc n) + an N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>Suc n. an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n L La.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        x (Suc n) \\<noteq> - \\<infinity>;\n        \\<forall>N>La. an m < x (Suc n) + an N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>Suc n. an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (subgoal_tac \"\\<forall>N. (max L La) < N \\<longrightarrow>\n                 (\\<forall>l \\<le> (Suc n). an m < x l + an N)\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n L La.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        x (Suc n) \\<noteq> - \\<infinity>;\n        \\<forall>N>La. an m < x (Suc n) + an N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>N>max L La.\n                            \\<forall>l\\<le>Suc n. an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (rule allI, rule impI, rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n L La N l.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        x (Suc n) \\<noteq> - \\<infinity>;\n        \\<forall>N>La. an m < x (Suc n) + an N; max L La < N;\n        l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (rotate_tac 1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n L La N l.\n       \\<lbrakk>\\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        x (Suc n) \\<noteq> - \\<infinity>;\n        \\<forall>N>La. an m < x (Suc n) + an N; max L La < N; l \\<le> Suc n;\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> an m < x l + an N\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    x j \\<noteq> - \\<infinity>) \\<longrightarrow>\n                (\\<exists>L.\n                    \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N);\n        \\<forall>j\\<le>Suc n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. l \\<le> Suc n", "apply (case_tac \"l = Suc n\", simp,\n        drule_tac m = l and n = \"Suc n\" in noteq_le_less, assumption+,\n        drule_tac x = l and n = \"Suc n\" in less_le_diff, simp,\n        simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma multi_inequalityTr1:\"\\<lbrakk>\\<forall>j \\<le> (n::nat). (x j) \\<noteq> - \\<infinity>\\<rbrakk> \\<Longrightarrow>\n       \\<exists>L. (\\<forall>N. L < N \\<longrightarrow>  (\\<forall>l \\<le> n. (an m) < (x l) + (an N)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity> \\<Longrightarrow>\n    \\<exists>L. \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N", "by (simp add:multi_inequalityTr0)"], ["", "lemma gcoeff_multi_inequality:\"\\<lbrakk>\\<forall>N. 0 < N \\<longrightarrow> (\\<forall>j \\<le> (n::nat). (x j) \\<noteq> -\\<infinity> \\<and>\n     0 < (b N j) \\<and> (b N j) \\<noteq> \\<infinity>)\\<rbrakk> \\<Longrightarrow>\n\\<exists>L. (\\<forall>N. L < N \\<longrightarrow>  (\\<forall>l \\<le> n.(an m) < (x l) + (int N) *\\<^sub>a (b N l)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<exists>L.\n       \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + int N *\\<^sub>a b N l", "apply (subgoal_tac \"\\<forall>j \\<le> n. x j \\<noteq> - \\<infinity>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>N>0.\n                \\<forall>j\\<le>n.\n                   x j \\<noteq> - \\<infinity> \\<and>\n                   0 < b N j \\<and> b N j \\<noteq> \\<infinity>;\n     \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>L.\n                         \\<forall>N>L.\n                            \\<forall>l\\<le>n.\n                               an m < x l + int N *\\<^sub>a b N l\n 2. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>", "apply (frule  multi_inequalityTr1[of \"n\" \"x\" \"m\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>N>0.\n                \\<forall>j\\<le>n.\n                   x j \\<noteq> - \\<infinity> \\<and>\n                   0 < b N j \\<and> b N j \\<noteq> \\<infinity>;\n     \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>;\n     \\<exists>L. \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N\\<rbrakk>\n    \\<Longrightarrow> \\<exists>L.\n                         \\<forall>N>L.\n                            \\<forall>l\\<le>n.\n                               an m < x l + int N *\\<^sub>a b N l\n 2. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>", "apply (erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L.\n       \\<lbrakk>\\<forall>N>0.\n                   \\<forall>j\\<le>n.\n                      x j \\<noteq> - \\<infinity> \\<and>\n                      0 < b N j \\<and> b N j \\<noteq> \\<infinity>;\n        \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>n.\n                                  an m < x l + int N *\\<^sub>a b N l\n 2. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>", "apply (subgoal_tac \"\\<forall>N. L < N \\<longrightarrow>\n                     (\\<forall>l \\<le> n. an m < x l + (int N) *\\<^sub>a (b N l))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>L.\n       \\<lbrakk>\\<forall>N>0.\n                   \\<forall>j\\<le>n.\n                      x j \\<noteq> - \\<infinity> \\<and>\n                      0 < b N j \\<and> b N j \\<noteq> \\<infinity>;\n        \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N;\n        \\<forall>N>L.\n           \\<forall>l\\<le>n. an m < x l + int N *\\<^sub>a b N l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>L.\n                            \\<forall>N>L.\n                               \\<forall>l\\<le>n.\n                                  an m < x l + int N *\\<^sub>a b N l\n 2. \\<And>L.\n       \\<lbrakk>\\<forall>N>0.\n                   \\<forall>j\\<le>n.\n                      x j \\<noteq> - \\<infinity> \\<and>\n                      0 < b N j \\<and> b N j \\<noteq> \\<infinity>;\n        \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>N>L.\n                            \\<forall>l\\<le>n.\n                               an m < x l + int N *\\<^sub>a b N l\n 3. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L.\n       \\<lbrakk>\\<forall>N>0.\n                   \\<forall>j\\<le>n.\n                      x j \\<noteq> - \\<infinity> \\<and>\n                      0 < b N j \\<and> b N j \\<noteq> \\<infinity>;\n        \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>;\n        \\<forall>N>L. \\<forall>l\\<le>n. an m < x l + an N\\<rbrakk>\n       \\<Longrightarrow> \\<forall>N>L.\n                            \\<forall>l\\<le>n.\n                               an m < x l + int N *\\<^sub>a b N l\n 2. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>", "apply (rule allI, rule impI, rule allI, rule impI,\n       drule_tac a = N in forall_spec, simp,\n       drule_tac a = l in forall_spec, assumption,\n       drule_tac a = N in forall_spec, assumption,\n       drule_tac a = l in forall_spec, assumption,\n       drule_tac a = l in forall_spec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L N l.\n       \\<lbrakk>L < N; l \\<le> n; x l \\<noteq> - \\<infinity>;\n        x l \\<noteq> - \\<infinity> \\<and>\n        0 < b N l \\<and> b N l \\<noteq> \\<infinity>;\n        an m < x l + an N\\<rbrakk>\n       \\<Longrightarrow> an m < x l + int N *\\<^sub>a b N l\n 2. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>", "apply (cut_tac b = \"b N l\" and N = N in asprod_ge, simp, simp,\n        (erule conjE)+, simp, thin_tac \"x l \\<noteq> - \\<infinity>\", thin_tac \"b N l \\<noteq> \\<infinity>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>L N l.\n       \\<lbrakk>L < N; l \\<le> n; an m < x l + an N;\n        an N \\<le> int N *\\<^sub>a b N l; 0 < b N l\\<rbrakk>\n       \\<Longrightarrow> an m < x l + int N *\\<^sub>a b N l\n 2. \\<forall>N>0.\n       \\<forall>j\\<le>n.\n          x j \\<noteq> - \\<infinity> \\<and>\n          0 < b N j \\<and> b N j \\<noteq> \\<infinity> \\<Longrightarrow>\n    \\<forall>j\\<le>n. x j \\<noteq> - \\<infinity>", "apply (frule_tac x = \"an N\" and y = \"int N *\\<^sub>a b N l\" and z = \"x l\" in\n       aadd_le_mono, simp add:aadd_commute,\n       rule allI, rule impI,\n       cut_tac lessI[of \"(0::nat)\"],\n       drule_tac a = \"Suc 0\" in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>j \\<le> n; 0 < Suc 0;\n        \\<forall>j\\<le>n.\n           x j \\<noteq> - \\<infinity> \\<and>\n           0 < b (Suc 0) j \\<and> b (Suc 0) j \\<noteq> \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> x j \\<noteq> - \\<infinity>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "primrec m_max :: \"[nat, nat \\<Rightarrow> nat] \\<Rightarrow> nat\"\nwhere\n  m_max_0: \"m_max 0 f = f 0\"\n| m_max_Suc: \"m_max (Suc n) f  = max (m_max n f) (f (Suc n))\""], ["", "(** maximum value of f **)"], ["", "lemma m_maxTr:\"\\<forall>l \\<le> n. (f l) \\<le> m_max n f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l\\<le>n. f l \\<le> m_max n f", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>l\\<le>0. f l \\<le> m_max 0 f\n 2. \\<And>n.\n       \\<forall>l\\<le>n. f l \\<le> m_max n f \\<Longrightarrow>\n       \\<forall>l\\<le>Suc n. f l \\<le> m_max (Suc n) f", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>l\\<le>n. f l \\<le> m_max n f \\<Longrightarrow>\n       \\<forall>l\\<le>Suc n. f l \\<le> m_max (Suc n) f", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>\\<forall>l\\<le>n. f l \\<le> m_max n f;\n        l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f l \\<le> m_max (Suc n) f", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>\\<forall>l\\<le>n. f l \\<le> m_max n f;\n        l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f l \\<le> max (m_max n f) (f (Suc n))", "apply (case_tac \"l = Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>\\<forall>l\\<le>n. f l \\<le> m_max n f; l \\<le> Suc n;\n        l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> f l \\<le> max (m_max n f) (f (Suc n))", "apply (cut_tac m = l and n = \"Suc n\" in noteq_le_less, assumption+,\n        thin_tac \"l \\<le> Suc n\", thin_tac \"l \\<noteq> Suc n\",\n        frule_tac x = l and n = \"Suc n\" in less_le_diff,\n        thin_tac \"l < Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>\\<forall>l\\<le>n. f l \\<le> m_max n f; l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f l \\<le> max (m_max n f) (f (Suc n))", "apply (drule_tac a = l in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>l \\<le> n; f l \\<le> m_max n f\\<rbrakk>\n       \\<Longrightarrow> f l \\<le> max (m_max n f) (f (Suc n))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma m_max_gt:\"l \\<le> n \\<Longrightarrow> (f l) \\<le> m_max n f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. l \\<le> n \\<Longrightarrow> f l \\<le> m_max n f", "apply (simp add:m_maxTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ASum_zero:\" (\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>l \\<le> n. f l = 0) \\<longrightarrow> ASum f n = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n    ASum f n = 0", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>l\\<le>0. f l = 0) \\<longrightarrow>\n    ASum f 0 = 0\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n       ASum f n = 0 \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>l\\<le>Suc n. f l = 0) \\<longrightarrow>\n       ASum f (Suc n) = 0", "apply (rule impI, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n       ASum f n = 0 \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>l\\<le>Suc n. f l = 0) \\<longrightarrow>\n       ASum f (Suc n) = 0", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n                ASum f n = 0;\n        (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>Suc n. f l = 0)\\<rbrakk>\n       \\<Longrightarrow> ASum f (Suc n) = 0", "apply (subgoal_tac \"(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>l\\<le>n. f l = 0)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ASum f n = 0;\n        (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>Suc n. f l = 0);\n        (\\<exists>j. j \\<le> n) \\<longrightarrow>\n        0 \\<in> Z\\<^sub>\\<infinity>\\<rbrakk>\n       \\<Longrightarrow> 0 + 0 = 0\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n                ASum f n = 0;\n        (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>Suc n. f l = 0)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>n.\n                             f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                         (\\<forall>l\\<le>n. f l = 0)", "apply (simp add:aadd_0_l, erule conjE,\n        thin_tac \"(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow> ASum f n = 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<le>Suc n. f l = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>n.\n                             f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                         (\\<forall>l\\<le>n. f l = 0)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<le>Suc n. f l = 0\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>\n 2. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<le>Suc n. f l = 0\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. f l = 0", "apply (rule allI, rule impI,\n        drule_tac a = j in forall_spec, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<le>Suc n. f l = 0\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. f l = 0", "apply (thin_tac \"\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>l\\<le>Suc n. f l = 0 \\<Longrightarrow>\n       \\<forall>l\\<le>n. f l = 0", "apply (rule allI, rule impI,\n        drule_tac a = l in forall_spec, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma eSum_singleTr:\"(\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (j \\<le> n \\<and> (\\<forall>l \\<in>{h. h \\<le> n} - {j}. f l = 0))  \\<longrightarrow> ASum f n = f j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    j \\<le> n \\<and>\n    (\\<forall>l\\<in>{h. h \\<le> n} - {j}. f l = 0) \\<longrightarrow>\n    ASum f n = f j", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    j \\<le> 0 \\<and>\n    (\\<forall>l\\<in>{h. h \\<le> 0} - {j}. f l = 0) \\<longrightarrow>\n    ASum f 0 = f j\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       j \\<le> n \\<and>\n       (\\<forall>l\\<in>{h. h \\<le> n} - {j}. f l = 0) \\<longrightarrow>\n       ASum f n = f j \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       j \\<le> Suc n \\<and>\n       (\\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0) \\<longrightarrow>\n       ASum f (Suc n) = f j", "apply (simp, rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                j \\<le> n \\<and>\n                (\\<forall>l\\<in>{h. h \\<le> n} - {j}.\n                    f l = 0) \\<longrightarrow>\n                ASum f n = f j;\n        \\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>; j \\<le> Suc n;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0\\<rbrakk>\n       \\<Longrightarrow> ASum f (Suc n) = f j", "apply (case_tac \"j \\<le> n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                j \\<le> n \\<and>\n                (\\<forall>l\\<in>{h. h \\<le> n} - {j}.\n                    f l = 0) \\<longrightarrow>\n                ASum f n = f j;\n        \\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>; j \\<le> Suc n;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ASum f (Suc n) = f j\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                j \\<le> n \\<and>\n                (\\<forall>l\\<in>{h. h \\<le> n} - {j}.\n                    f l = 0) \\<longrightarrow>\n                ASum f n = f j;\n        \\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>; j \\<le> Suc n;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0;\n        \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ASum f (Suc n) = f j", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ASum f n = f j;\n        \\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j + 0 = f j\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                j \\<le> n \\<and>\n                (\\<forall>l\\<in>{h. h \\<le> n} - {j}.\n                    f l = 0) \\<longrightarrow>\n                ASum f n = f j;\n        \\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>; j \\<le> Suc n;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0;\n        \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ASum f (Suc n) = f j", "apply (simp add:aadd_0_r)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                j \\<le> n \\<and>\n                (\\<forall>l\\<in>{h. h \\<le> n} - {j}.\n                    f l = 0) \\<longrightarrow>\n                ASum f n = f j;\n        \\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>; j \\<le> Suc n;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0;\n        \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ASum f (Suc n) = f j", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        j \\<le> Suc n; \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0;\n        \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ASum f n + f (Suc n) = f j", "apply (simp add:nat_not_le_less[of j])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        j \\<le> Suc n; \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0;\n        n < j\\<rbrakk>\n       \\<Longrightarrow> ASum f n + f (Suc n) = f j", "apply (frule_tac m = n and n = j in Suc_leI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        j \\<le> Suc n; \\<forall>l\\<in>{h. h \\<le> Suc n} - {j}. f l = 0;\n        n < j; Suc n \\<le> j\\<rbrakk>\n       \\<Longrightarrow> ASum f n + f (Suc n) = f j", "apply (frule_tac m = j and n = \"Suc n\" in le_antisym, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0;\n        j = Suc n\\<rbrakk>\n       \\<Longrightarrow> ASum f n + f (Suc n) = f (Suc n)", "apply (cut_tac n = n in ASum_zero [of _ \"f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0; j = Suc n;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n        ASum f n = 0\\<rbrakk>\n       \\<Longrightarrow> ASum f n + f (Suc n) = f (Suc n)", "apply (subgoal_tac \"(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>l\\<le>n. f l = 0)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0; j = Suc n;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n        ASum f n = 0;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0)\\<rbrakk>\n       \\<Longrightarrow> ASum f n + f (Suc n) = f (Suc n)\n 2. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0; j = Suc n;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n        ASum f n = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>n.\n                             f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                         (\\<forall>l\\<le>n. f l = 0)", "apply (thin_tac \"\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>\",\n        thin_tac \"\\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0\", simp only:mp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>j = Suc n;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n        ASum f n = 0;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0)\\<rbrakk>\n       \\<Longrightarrow> 0 + f (Suc n) = f (Suc n)\n 2. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0; j = Suc n;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n        ASum f n = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>n.\n                             f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                         (\\<forall>l\\<le>n. f l = 0)", "apply (simp add:aadd_0_l)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0; j = Suc n;\n        (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n        (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow>\n        ASum f n = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>n.\n                             f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                         (\\<forall>l\\<le>n. f l = 0)", "apply (thin_tac \"(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>l\\<le>n. f l = 0) \\<longrightarrow> ASum f n = 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0;\n        j = Suc n\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>n.\n                             f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                         (\\<forall>l\\<le>n. f l = 0)", "apply (rule conjI,\n        thin_tac \"\\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>l\\<in>{h. h \\<le> Suc n} - {Suc n}. f l = 0;\n        j = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. f l = 0", "apply (thin_tac \"\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>\", simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma eSum_single:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity> ; j \\<le> n; \\<forall>l \\<in> {h. h \\<le> n} - {j}. f l = 0\\<rbrakk>\n \\<Longrightarrow> ASum  f n = f j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>; j \\<le> n;\n     \\<forall>l\\<in>{h. h \\<le> n} - {j}. f l = 0\\<rbrakk>\n    \\<Longrightarrow> ASum f n = f j", "apply (simp add:eSum_singleTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ASum_eqTr:\"(\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and> (\\<forall>j \\<le> n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                (\\<forall>j \\<le> n. f j = g j) \\<longrightarrow> ASum f n = ASum g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>j\\<le>n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n    ASum f n = ASum g n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>j\\<le>0. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n    (\\<forall>j\\<le>0. f j = g j) \\<longrightarrow>\n    ASum f 0 = ASum g 0\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n       ASum f n = ASum g n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>Suc n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>Suc n. f j = g j) \\<longrightarrow>\n       ASum f (Suc n) = ASum g (Suc n)", "apply (rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n       ASum f n = ASum g n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>Suc n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n       (\\<forall>j\\<le>Suc n. f j = g j) \\<longrightarrow>\n       ASum f (Suc n) = ASum g (Suc n)", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                (\\<forall>j\\<le>n. g j \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n                ASum f n = ASum g n;\n        \\<forall>j\\<le>Suc n. f j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>j\\<le>Suc n. g j \\<in> Z\\<^sub>\\<infinity>;\n        \\<forall>j\\<le>Suc n. f j = g j\\<rbrakk>\n       \\<Longrightarrow> ASum f (Suc n) = ASum g (Suc n)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ASum_eq:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> Z\\<^sub>\\<infinity>; \\<forall>j \\<le> n. g j \\<in> Z\\<^sub>\\<infinity>; \\<forall>j \\<le> n. f j = g j\\<rbrakk> \\<Longrightarrow>\n               ASum f n = ASum g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> Z\\<^sub>\\<infinity>;\n     \\<forall>j\\<le>n. g j \\<in> Z\\<^sub>\\<infinity>;\n     \\<forall>j\\<le>n. f j = g j\\<rbrakk>\n    \\<Longrightarrow> ASum f n = ASum g n", "by (cut_tac ASum_eqTr[of n f g], simp)"], ["", "definition\n  Kronecker_delta :: \"[nat, nat] \\<Rightarrow> ant\"\n    (\"(\\<delta>\\<^bsub>_ _\\<^esub>)\" [70,71]70) where\n  \"\\<delta>\\<^bsub>i j\\<^esub> = (if i = j then 1 else 0)\""], ["", "definition\n  K_gamma :: \"[nat, nat] \\<Rightarrow> int\"\n    (\"(\\<gamma>\\<^bsub>_ _\\<^esub>)\" [70,71]70) where\n  \"\\<gamma>\\<^bsub>i j\\<^esub> = (if i = j then 0 else 1)\""], ["", "abbreviation\n  TRANSPOS  (\"(\\<tau>\\<^bsub>_ _\\<^esub>)\" [90,91]90) where\n  \"\\<tau>\\<^bsub>i j\\<^esub> == transpos i j\""], ["", "lemma Kdelta_in_Zinf:\"\\<lbrakk>j \\<le> (Suc n); k \\<le> (Suc n)\\<rbrakk>  \\<Longrightarrow>\n                 z *\\<^sub>a (\\<delta>\\<^bsub>j k\\<^esub>) \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<le> Suc n; k \\<le> Suc n\\<rbrakk>\n    \\<Longrightarrow> z *\\<^sub>a (\\<delta>\\<^bsub>j k\\<^esub>)\n                      \\<in> Z\\<^sub>\\<infinity>", "apply (simp add:Kronecker_delta_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<le> Suc n; k \\<le> Suc n\\<rbrakk>\n    \\<Longrightarrow> (j = k \\<longrightarrow>\n                       ant z \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                      (j \\<noteq> k \\<longrightarrow>\n                       z *\\<^sub>a 0 \\<in> Z\\<^sub>\\<infinity>)", "apply (simp add:z_in_aug_inf Zero_in_aug_inf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<le> Suc n; k \\<le> Suc n\\<rbrakk>\n    \\<Longrightarrow> j \\<noteq> k \\<longrightarrow>\n                      z *\\<^sub>a 0 \\<in> Z\\<^sub>\\<infinity>", "apply (simp add:asprod_n_0 Zero_in_aug_inf)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Kdelta_in_Zinf1:\"\\<lbrakk>j \\<le> n; k \\<le> n\\<rbrakk>  \\<Longrightarrow> \\<delta>\\<^bsub>j k\\<^esub> \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<le> n; k \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<delta>\\<^bsub>j k\\<^esub> \\<in> Z\\<^sub>\\<infinity>", "apply (simp add:Kronecker_delta_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<le> n; k \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (j = k \\<longrightarrow>\n                       1 \\<in> Z\\<^sub>\\<infinity>) \\<and>\n                      (j \\<noteq> k \\<longrightarrow>\n                       0 \\<in> Z\\<^sub>\\<infinity>)", "apply (simp add:z_in_aug_inf Zero_in_aug_inf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<le> n; k \\<le> n\\<rbrakk>\n    \\<Longrightarrow> j = k \\<longrightarrow> 1 \\<in> Z\\<^sub>\\<infinity>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<le> n; k \\<le> n; j = k\\<rbrakk>\n    \\<Longrightarrow> 1 \\<in> Z\\<^sub>\\<infinity>", "apply (simp only:ant_1[THEN sym], simp del:ant_1 add:z_in_aug_inf)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "primrec m_zmax :: \"[nat, nat \\<Rightarrow> int] \\<Rightarrow> int\"\nwhere\n  m_zmax_0: \"m_zmax 0 f = f 0\"\n| m_zmax_Suc: \"m_zmax (Suc n) f = zmax (m_zmax n f) (f (Suc n))\""], ["", "lemma m_zmax_gt_eachTr:\n      \"(\\<forall>j \\<le> n. f j \\<in> Zset) \\<longrightarrow> (\\<forall>j \\<le> n. (f j) \\<le> m_zmax n f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> Zset) \\<longrightarrow>\n    (\\<forall>j\\<le>n. f j \\<le> m_zmax n f)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> Zset) \\<longrightarrow>\n    (\\<forall>j\\<le>0. f j \\<le> m_zmax 0 f)\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Zset) \\<longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<le> m_zmax n f) \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Zset) \\<longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<le> m_zmax (Suc n) f)", "apply (rule impI, rule allI, rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> Zset) \\<longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<le> m_zmax n f) \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> Zset) \\<longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<le> m_zmax (Suc n) f)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> Zset) \\<longrightarrow>\n                (\\<forall>j\\<le>n. f j \\<le> m_zmax n f);\n        \\<forall>j\\<le>Suc n. f j \\<in> Zset\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc n. f j \\<le> m_zmax (Suc n) f", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<le> m_zmax n f;\n        \\<forall>j\\<le>Suc n. f j \\<in> Zset\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                            f j \\<le> zmax (m_zmax n f) (f (Suc n))", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<le> m_zmax n f;\n        \\<forall>j\\<le>Suc n. f j \\<in> Zset; j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f j \\<le> zmax (m_zmax n f) (f (Suc n))", "apply (case_tac \"j = Suc n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<le> m_zmax n f;\n        \\<forall>j\\<le>Suc n. f j \\<in> Zset; j = Suc n\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<le> zmax (m_zmax n f) (f (Suc n))\n 2. \\<And>n j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<le> m_zmax n f;\n        \\<forall>j\\<le>Suc n. f j \\<in> Zset; j \\<le> Suc n;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> f j \\<le> zmax (m_zmax n f) (f (Suc n))", "apply (simp add:zmax_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<le> m_zmax n f;\n        \\<forall>j\\<le>Suc n. f j \\<in> Zset; j \\<le> Suc n;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> f j \\<le> zmax (m_zmax n f) (f (Suc n))", "apply (drule_tac m = j and n = \"Suc n\" in noteq_le_less, assumption,\n        drule_tac x = j and n = \"Suc n\" in less_le_diff, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<le> m_zmax n f;\n        \\<forall>j\\<le>Suc n. f j \\<in> Zset; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j \\<le> zmax (m_zmax n f) (f (Suc n))", "apply (drule_tac a = j in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> Zset; j \\<le> n;\n        f j \\<le> m_zmax n f\\<rbrakk>\n       \\<Longrightarrow> f j \\<le> zmax (m_zmax n f) (f (Suc n))", "apply (simp add:zmax_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma m_zmax_gt_each:\"(\\<forall>j \\<le> n. f j \\<in> Zset) \\<Longrightarrow> (\\<forall>j \\<le> n. (f j) \\<le> m_zmax n f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>n. f j \\<in> Zset \\<Longrightarrow>\n    \\<forall>j\\<le>n. f j \\<le> m_zmax n f", "apply (simp add:m_zmax_gt_eachTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma n_notin_Nset_pred:\" 0 < n \\<Longrightarrow> \\<not> n \\<le> (n - Suc 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < n \\<Longrightarrow> \\<not> n \\<le> n - Suc 0", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Nset_preTr:\"\\<lbrakk>0 < n; j \\<le> (n - Suc 0)\\<rbrakk> \\<Longrightarrow> j \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; j \\<le> n - Suc 0\\<rbrakk> \\<Longrightarrow> j \\<le> n", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Nset_preTr1:\"\\<lbrakk>0 < n; j \\<le> (n - Suc 0)\\<rbrakk> \\<Longrightarrow> j \\<noteq> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; j \\<le> n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> j \\<noteq> n", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma transpos_noteqTr:\"\\<lbrakk>0 < n; k \\<le> (n - Suc 0); j \\<le> n; j \\<noteq> n\\<rbrakk>\n                    \\<Longrightarrow> j \\<noteq> (\\<tau>\\<^bsub>j n\\<^esub>) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; k \\<le> n - Suc 0; j \\<le> n; j \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> j \\<noteq> (\\<tau>\\<^bsub>j n\\<^esub>) k", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<le> n - Suc 0; j \\<le> n; j \\<noteq> n;\n     j = (\\<tau>\\<^bsub>j n\\<^esub>) k\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:transpos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<le> n - Suc 0; j \\<le> n; j \\<noteq> n;\n     j = (if k = j then n else if k = n then j else k)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (case_tac \"k = j\", simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<le> n - Suc 0; j \\<le> n; j \\<noteq> n;\n     j = (if k = n then j else k); k \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> False", "apply (case_tac \"k = n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>k \\<le> n - Suc 0; j \\<le> n; j \\<noteq> n;\n     j = (if k = n then j else k); k \\<noteq> j; k \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:n_notin_Nset_pred)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "chapter \"Elementary properties of a valuation\""], ["", "section \"Definition of a valuation\""], ["", "definition\n  valuation :: \"[('b, 'm) Ring_scheme, 'b \\<Rightarrow> ant] \\<Rightarrow> bool\" where\n  \"valuation K v \\<longleftrightarrow>\n     v \\<in> extensional (carrier K) \\<and>\n     v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>  \\<and>\n     v (\\<zero>\\<^bsub>K\\<^esub>) = \\<infinity> \\<and> (\\<forall>x\\<in>((carrier K) - {\\<zero>\\<^bsub>K\\<^esub>}). v x \\<noteq> \\<infinity>) \\<and>\n    (\\<forall>x\\<in>(carrier K). \\<forall>y\\<in>(carrier K). v (x \\<cdot>\\<^sub>r\\<^bsub>K\\<^esub> y) = (v x) + (v y)) \\<and>\n    (\\<forall>x\\<in>(carrier K). 0 \\<le> (v x) \\<longrightarrow> 0 \\<le> (v (1\\<^sub>r\\<^bsub>K\\<^esub> \\<plusminus>\\<^bsub>K\\<^esub> x))) \\<and>\n    (\\<exists>x. x \\<in> carrier K \\<and> (v x) \\<noteq> \\<infinity> \\<and> (v x) \\<noteq> 0)\""], ["", "lemma (in Corps) invf_closed:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n    x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K", "by (cut_tac invf_closed1[of x], simp, assumption)"], ["", "lemma (in Corps) valuation_map:\"valuation K v \\<Longrightarrow> v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>", "by (simp add:valuation_def)"], ["", "lemma (in Corps) value_in_aug_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n       v x \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v x \\<in> Z\\<^sub>\\<infinity>", "by (simp add:valuation_def, (erule conjE)+, simp add:funcset_mem)"], ["", "lemma (in Corps) value_of_zero:\"valuation K v  \\<Longrightarrow> v (\\<zero>) = \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> v \\<zero> = \\<infinity>", "by (simp add:valuation_def)"], ["", "lemma (in Corps) val_nonzero_noninf:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n     \\<Longrightarrow> (v x) \\<noteq> \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> v x \\<noteq> \\<infinity>", "by (simp add:valuation_def)"], ["", "lemma (in Corps) value_inf_zero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = \\<infinity>\\<rbrakk>\n     \\<Longrightarrow> x = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x = \\<zero>", "by (rule contrapos_pp, simp+,\n    frule val_nonzero_noninf[of v x], assumption+, simp)"], ["", "lemma (in Corps) val_nonzero_z:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                      \\<exists>z. (v x) = ant z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>z. v x = ant z", "by (frule value_in_aug_inf[of v x], assumption+,\n    frule val_nonzero_noninf[of v x], assumption+,\n    cut_tac mem_ant[of \"v x\"],  simp add:aug_inf_def)"], ["", "lemma (in Corps) val_nonzero_z_unique:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>!z. (v x) = ant z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!z. v x = ant z", "by (rule ex_ex1I, simp add:val_nonzero_z, simp)"], ["", "lemma (in Corps) value_noninf_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x \\<noteq> \\<infinity>\\<rbrakk>\n         \\<Longrightarrow> x \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     v x \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<zero>", "by (rule contrapos_pp, simp+, simp add:value_of_zero)"], ["", "lemma (in Corps) val1_neq_0:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 1\\<rbrakk> \\<Longrightarrow>\n                                         x \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 1\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+, simp add:value_of_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<zero> \\<in> carrier K; \\<infinity> = 1;\n     x = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp only:ant_1[THEN sym], cut_tac z_neq_inf[THEN not_sym, of 1], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_Zmin_sym:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                 \\<Longrightarrow>  amin (v x) (v y) = amin (v y ) (v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) = amin (v y) (v x)", "by (simp add:amin_commute)"], ["", "lemma (in Corps) val_t2p:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                         \\<Longrightarrow> v (x \\<cdot>\\<^sub>r y ) = v x + v y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v (x \\<cdot>\\<^sub>r y) = v x + v y", "by (simp add:valuation_def)"], ["", "lemma (in Corps) val_axiom4:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> v x\\<rbrakk> \\<Longrightarrow>\n                      0 \\<le> v (1\\<^sub>r \\<plusminus> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v (1\\<^sub>r \\<plusminus> x)", "by (simp add:valuation_def)"], ["", "lemma (in Corps) val_axiom5:\"valuation K v \\<Longrightarrow>\n                  \\<exists>x. x \\<in> carrier K \\<and> v x \\<noteq> \\<infinity> \\<and> v x \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<exists>x.\n       x \\<in> carrier K \\<and>\n       v x \\<noteq> \\<infinity> \\<and> v x \\<noteq> 0", "by (simp add:valuation_def)"], ["", "lemma (in Corps) val_field_nonzero:\"valuation K v \\<Longrightarrow> carrier K \\<noteq> {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> carrier K \\<noteq> {\\<zero>}", "by (rule contrapos_pp, simp+,\n       frule val_axiom5[of v],\n       erule exE, (erule conjE)+, simp add:value_of_zero)"], ["", "lemma (in Corps) val_field_1_neq_0:\"valuation K v \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 1\\<^sub>r = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule val_axiom5[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 1\\<^sub>r = \\<zero>;\n     \\<exists>x.\n        x \\<in> carrier K \\<and>\n        v x \\<noteq> \\<infinity> \\<and> v x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> False", "apply (erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; 1\\<^sub>r = \\<zero>; x \\<in> carrier K;\n        v x \\<noteq> \\<infinity>; v x \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac field_is_ring,\n       frule_tac t = x in  Ring.ring_l_one[THEN sym, of \"K\"], assumption+,\n       simp add:Ring.ring_times_0_x, simp add:value_of_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) value_of_one:\"valuation K v \\<Longrightarrow> v (1\\<^sub>r) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> v 1\\<^sub>r = 0", "apply (cut_tac field_is_ring, frule Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v 1\\<^sub>r = 0", "apply (frule val_t2p[of v \"1\\<^sub>r\" \"1\\<^sub>r\"], assumption+,\n       simp add:Ring.ring_l_one, frule val_field_1_neq_0[of v],\n       frule val_nonzero_z[of v \"1\\<^sub>r\"], assumption+,\n       erule exE, simp add:a_zpz)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) has_val_one_neq_zero:\"valuation K v \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>", "by (frule value_of_one[of \"v\"],\n       rule contrapos_pp, simp+, simp add:value_of_zero)"], ["", "lemma (in Corps) val_minus_one:\"valuation K v \\<Longrightarrow> v (-\\<^sub>a 1\\<^sub>r) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> v (-\\<^sub>a 1\\<^sub>r) = 0", "apply (cut_tac field_is_ring, frule Ring.ring_one[of \"K\"],\n       frule Ring.ring_is_ag[of \"K\"],\n       frule val_field_1_neq_0[of v],\n       frule aGroup.ag_inv_inj[of \"K\" \"1\\<^sub>r\" \"\\<zero>\"], assumption+,\n       simp add:Ring.ring_zero, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; 1\\<^sub>r \\<in> carrier K; aGroup K;\n     1\\<^sub>r \\<noteq> \\<zero>;\n     -\\<^sub>a 1\\<^sub>r \\<noteq> -\\<^sub>a \\<zero>\\<rbrakk>\n    \\<Longrightarrow> v (-\\<^sub>a 1\\<^sub>r) = 0", "apply (frule val_nonzero_z[of v \"-\\<^sub>a 1\\<^sub>r\"],\n        rule aGroup.ag_mOp_closed, assumption+, simp add:aGroup.ag_inv_zero,\n        erule exE, frule val_t2p [THEN sym, of v \"-\\<^sub>a 1\\<^sub>r\" \"-\\<^sub>a 1\\<^sub>r\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; 1\\<^sub>r \\<in> carrier K; aGroup K;\n        1\\<^sub>r \\<noteq> \\<zero>;\n        -\\<^sub>a 1\\<^sub>r \\<noteq> -\\<^sub>a \\<zero>;\n        v (-\\<^sub>a 1\\<^sub>r) = ant z\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a 1\\<^sub>r \\<in> carrier K\n 2. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; 1\\<^sub>r \\<in> carrier K; aGroup K;\n        1\\<^sub>r \\<noteq> \\<zero>;\n        -\\<^sub>a 1\\<^sub>r \\<noteq> -\\<^sub>a \\<zero>;\n        v (-\\<^sub>a 1\\<^sub>r) = ant z\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a 1\\<^sub>r \\<in> carrier K\n 3. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; 1\\<^sub>r \\<in> carrier K; aGroup K;\n        1\\<^sub>r \\<noteq> \\<zero>;\n        -\\<^sub>a 1\\<^sub>r \\<noteq> -\\<^sub>a \\<zero>;\n        v (-\\<^sub>a 1\\<^sub>r) = ant z;\n        v (-\\<^sub>a 1\\<^sub>r) + v (-\\<^sub>a 1\\<^sub>r) =\n        v ((-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r\n           (-\\<^sub>a 1\\<^sub>r))\\<rbrakk>\n       \\<Longrightarrow> v (-\\<^sub>a 1\\<^sub>r) = 0", "apply (simp add:aGroup.ag_mOp_closed[of \"K\" \"1\\<^sub>r\"],\n       simp add:aGroup.ag_mOp_closed[of \"K\" \"1\\<^sub>r\"],\n       frule Ring.ring_inv1_3[THEN sym, of \"K\" \"1\\<^sub>r\" \"1\\<^sub>r\"], assumption+,\n       simp add:Ring.ring_l_one, simp add:value_of_one a_zpz)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_minus_eq:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                            v (-\\<^sub>a x) = v x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v (-\\<^sub>a x) = v x", "apply (cut_tac field_is_ring,\n     simp add:Ring.ring_times_minusl[of K x],\n     subst val_t2p[of v], assumption+,\n     frule Ring.ring_is_ag[of \"K\"], rule aGroup.ag_mOp_closed, assumption+,\n     simp add:Ring.ring_one, assumption, simp add:val_minus_one,\n     simp add:aadd_0_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) value_of_inv:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                        v (x\\<^bsup>\\<hyphen>K\\<^esup>) = - (v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> v (x\\<^bsup>\\<hyphen> K\\<^esup>) = - v x", "apply (cut_tac invf_inv[of x], erule conjE,\n       frule val_t2p[of v \"x\\<^bsup>\\<hyphen>K\\<^esup>\" x], assumption+,\n       simp+, simp add:value_of_one, simp add:a_inv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_exp_ring:\"\\<lbrakk> valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n           \\<Longrightarrow> (int n) *\\<^sub>a (v x) = v (x^\\<^bsup>K n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> int n *\\<^sub>a v x = v (x^\\<^bsup>K n\\<^esup>)", "apply (cut_tac field_is_ring,\n       induct_tac n, simp add:Ring.ring_r_one, simp add:value_of_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>;\n        Ring K; int n *\\<^sub>a v x = v (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> int (Suc n) *\\<^sub>a v x =\n                         v (x^\\<^bsup>K Suc n\\<^esup>)", "apply (drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>;\n        Ring K; v (x^\\<^bsup>K n\\<^esup>) = int n *\\<^sub>a v x\\<rbrakk>\n       \\<Longrightarrow> (1 + int n) *\\<^sub>a v x =\n                         v (x^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r x)", "apply (subst val_t2p[of v _ x], assumption+,\n       rule Ring.npClose, assumption+,\n       frule val_nonzero_z[of v x], assumption+,\n              erule exE, simp add:asprod_mult a_zpz,\n       simp add: distrib_right)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>exponent in a field\\<close>"], ["", "lemma (in Corps) val_exp:\"\\<lbrakk> valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                        z *\\<^sub>a (v x) = v (x\\<^bsub>K\\<^esub>\\<^bsup>z\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> z *\\<^sub>a v x =\n                      v (x\\<^bsub>K\\<^esub>\\<^bsup>z\\<^esup>)", "apply (simp add:npowf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> z \\<longrightarrow>\n                       z *\\<^sub>a v x =\n                       v (x^\\<^bsup>K nat z\\<^esup>)) \\<and>\n                      (\\<not> 0 \\<le> z \\<longrightarrow>\n                       z *\\<^sub>a v x =\n                       v (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                            (- z)\\<^esup>))", "apply (case_tac \"0 \\<le> z\",\n       simp, frule val_exp_ring [of v x \"nat z\"], assumption+,\n       simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> z\\<rbrakk>\n    \\<Longrightarrow> z *\\<^sub>a v x =\n                      v (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                           (- z)\\<^esup>)", "apply (simp add:zle,\n       cut_tac invf_closed1[of x], simp,\n       cut_tac  val_exp_ring [THEN sym, of v \"x\\<^bsup>\\<hyphen> K\\<^esup>\" \"nat (- z)\"], simp,\n       thin_tac \"v (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K (nat (- z))\\<^esup>) = (- z) *\\<^sub>a v (x\\<^bsup>\\<hyphen> K\\<^esup>)\", erule conjE)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> z *\\<^sub>a v x =\n                      (- z) *\\<^sub>a v (x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> valuation K v\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K\n 4. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\n 5. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>;\n     z < 0\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (subst value_of_inv[of v x], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> z *\\<^sub>a v x = (- z) *\\<^sub>a (- v x)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> valuation K v\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K\n 4. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>; z < 0;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\n 5. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>;\n     z < 0\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (frule val_nonzero_z[of v x], assumption+, erule exE, simp,\n       simp add:asprod_mult aminus, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) value_zero_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n                   \\<Longrightarrow> x \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<zero>", "by (frule value_noninf_nonzero[of v x], assumption+, simp,\n        assumption)"], ["", "lemma (in Corps) v_ale_diff:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n        x \\<noteq> \\<zero>; v x \\<le> v y \\<rbrakk> \\<Longrightarrow> 0 \\<le> v(y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     x \\<noteq> \\<zero>; v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v (y \\<cdot>\\<^sub>r\n                                 x\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (frule value_in_aug_inf[of v x], simp+,\n       frule value_in_aug_inf[of v y], simp+,\n       frule val_nonzero_z[of v x], assumption+,\n       erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n        x \\<noteq> \\<zero>; v x \\<le> v y; v x \\<in> Z\\<^sub>\\<infinity>;\n        v y \\<in> Z\\<^sub>\\<infinity>; v x = ant z\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> v (y \\<cdot>\\<^sub>r\n                                    x\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (cut_tac invf_closed[of x], simp+,\n       simp add:val_t2p,\n       simp add:value_of_inv[of v \"x\"],\n       frule_tac x = \"ant z\" in ale_diff_pos[of _ \"v y\"],\n       simp add:diff_ant_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n        x \\<noteq> \\<zero>; v x \\<le> v y; v x \\<in> Z\\<^sub>\\<infinity>;\n        v y \\<in> Z\\<^sub>\\<infinity>; v x = ant z\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) amin_le_plusTr:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n       v x \\<noteq> \\<infinity>; v y \\<noteq> \\<infinity>; v x \\<le> v y\\<rbrakk> \\<Longrightarrow> amin (v x) (v y) \\<le> v ( x \\<plusminus> y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     v x \\<noteq> \\<infinity>; v y \\<noteq> \\<infinity>;\n     v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) \\<le> v (x \\<plusminus> y)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag,\n       frule value_noninf_nonzero[of v x], assumption+,\n       frule v_ale_diff[of v x y], assumption+,\n       cut_tac invf_closed1[of x],\n       frule Ring.ring_tOp_closed[of K y \"x\\<^bsup>\\<hyphen> K\\<^esup>\"], assumption+, simp,\n       frule Ring.ring_one[of \"K\"],\n       frule aGroup.ag_pOp_closed[of \"K\" \"1\\<^sub>r\" \"y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>\"], assumption+,\n       frule val_axiom4[of v \"y \\<cdot>\\<^sub>r ( x\\<^bsup>\\<hyphen> K\\<^esup>)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     v x \\<noteq> \\<infinity>; v y \\<noteq> \\<infinity>; v x \\<le> v y;\n     Ring K; aGroup K; x \\<noteq> \\<zero>;\n     0 \\<le> v (y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n     y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     0 \\<le> v (1\\<^sub>r \\<plusminus>\n                y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) \\<le> v (x \\<plusminus> y)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     v x \\<noteq> \\<infinity>; v y \\<noteq> \\<infinity>; v x \\<le> v y;\n     Ring K; aGroup K; x \\<noteq> \\<zero>;\n     0 \\<le> v (y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (frule aadd_le_mono[of \"0\" \"v (1\\<^sub>r \\<plusminus> y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\" \"v x\"],\n       simp add:aadd_0_l, simp add:aadd_commute[of _ \"v x\"],\n       simp add:val_t2p[THEN sym, of v x],\n       simp add:Ring.ring_distrib1 Ring.ring_r_one,\n       simp add:Ring.ring_tOp_commute[of \"K\" \"x\"],\n       simp add:Ring.ring_tOp_assoc, simp add:linvf,\n       simp add:Ring.ring_r_one,\n       cut_tac amin_le_l[of \"v x\" \"v y\"],\n       rule ale_trans[of \"amin (v x) (v y)\" \"v x\" \"v (x \\<plusminus> y)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     v x \\<noteq> \\<infinity>; v y \\<noteq> \\<infinity>; v x \\<le> v y;\n     Ring K; aGroup K; x \\<noteq> \\<zero>;\n     0 \\<le> v (y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) amin_le_plus:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                   \\<Longrightarrow> (amin (v x) (v y)) \\<le> (v (x \\<plusminus> y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) \\<le> v (x \\<plusminus> y)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; Ring K;\n     aGroup K\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) \\<le> v (x \\<plusminus> y)", "apply (case_tac \"v x = \\<infinity> \\<or> v y = \\<infinity>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; Ring K;\n     aGroup K; v x = \\<infinity> \\<or> v y = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) \\<le> v (x \\<plusminus> y)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; Ring K;\n     aGroup K; \\<not> (v x = \\<infinity> \\<or> v y = \\<infinity>)\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) \\<le> v (x \\<plusminus> y)", "apply (erule disjE, simp,\n       frule value_inf_zero[of v x], assumption+,\n       simp add:aGroup.ag_l_zero amin_def,\n       frule value_inf_zero[of v y], assumption+,\n       simp add:aGroup.ag_r_zero amin_def, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; Ring K;\n     aGroup K; v x \\<noteq> \\<infinity>; v y \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> amin (v x) (v y) \\<le> v (x \\<plusminus> y)", "apply (cut_tac z = \"v x\" and w = \"v y\" in ale_linear,\n       erule disjE, simp add:amin_le_plusTr,\n       frule_tac amin_le_plusTr[of v y x], assumption+,\n       simp add:aGroup.ag_pOp_commute amin_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) value_less_eq:\"\\<lbrakk> valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n                       (v x) < (v y)\\<rbrakk> \\<Longrightarrow> (v x) = (v (x \\<plusminus> y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     v x < v y\\<rbrakk>\n    \\<Longrightarrow> v x = v (x \\<plusminus> y)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule amin_le_plus[of v x y], assumption+,\n       frule aless_imp_le[of \"v x\" \"v y\"],\n       simp add: amin_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; v x < v y;\n     Ring K; aGroup K; v x \\<le> v (x \\<plusminus> y);\n     v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> v x = v (x \\<plusminus> y)", "apply (frule amin_le_plus[of v \"x \\<plusminus> y\" \"-\\<^sub>a y\"],\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule aGroup.ag_mOp_closed, assumption+,\n       simp add:val_minus_eq,\n       frule aGroup.ag_mOp_closed[of \"K\" \"y\"], assumption+,\n       simp add:aGroup.ag_pOp_assoc[of \"K\" \"x\" \"y\"],\n       simp add:aGroup.ag_r_inv1, simp add:aGroup.ag_r_zero,\n       simp add:amin_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; v x < v y;\n     Ring K; aGroup K; v x \\<le> v (x \\<plusminus> y); v x \\<le> v y;\n     (if v (x \\<plusminus> y) \\<le> v y then v (x \\<plusminus> y) else v y)\n     \\<le> v x;\n     -\\<^sub>a y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v x = v (x \\<plusminus> y)", "apply (case_tac \"\\<not> (v (x \\<plusminus>\\<^bsub>K\\<^esub> y) \\<le> (v y))\", simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) value_less_eq1:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n      (v x) < (v y)\\<rbrakk> \\<Longrightarrow> v x =  v (y \\<plusminus> x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     v x < v y\\<rbrakk>\n    \\<Longrightarrow> v x = v (y \\<plusminus> x)", "apply (cut_tac field_is_ring,\n       frule Ring.ring_is_ag[of \"K\"],\n       frule value_less_eq[of v x y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; v x < v y;\n     Ring K; aGroup K; v x = v (x \\<plusminus> y)\\<rbrakk>\n    \\<Longrightarrow> v x = v (y \\<plusminus> x)", "apply (subst aGroup.ag_pOp_commute, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_1px:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> (v (1\\<^sub>r \\<plusminus> x))\\<rbrakk>\n         \\<Longrightarrow> 0 \\<le> (v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 \\<le> v (1\\<^sub>r \\<plusminus> x)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v x", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 \\<le> v (1\\<^sub>r \\<plusminus> x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v x", "apply (rule contrapos_pp, simp+,\n       case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\",\n        simp add:aGroup.ag_r_zero, simp add:value_of_zero,\n        simp add: aneg_le[of \"0\" \"v x\"],\n        frule value_less_eq[of v x \"1\\<^sub>r\"], assumption+,\n        simp add:value_of_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 \\<le> v (1\\<^sub>r \\<plusminus> x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; v x < 0; x \\<noteq> \\<zero>;\n     v x = v (x \\<plusminus> 1\\<^sub>r)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (drule sym,\n       simp add:aGroup.ag_pOp_commute[of \"K\" \"x\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_1mx:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n                  0 \\<le> (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a x)))\\<rbrakk> \\<Longrightarrow> 0 \\<le> (v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 \\<le> v (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v x", "by (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule val_1px[of v \"-\\<^sub>a x\"],\n       simp add:aGroup.ag_mOp_closed, assumption, simp add:val_minus_eq)"], ["", "section \"The normal valuation of v\""], ["", "definition\n  Lv :: \"[('r, 'm) Ring_scheme , 'r \\<Rightarrow> ant] \\<Rightarrow> ant\" (* Least nonnegative value *) where\n  \"Lv K v = AMin {x. x \\<in> v ` carrier K \\<and> 0 < x}\""], ["", "definition\n  n_val :: \"[('r, 'm) Ring_scheme, 'r \\<Rightarrow> ant] \\<Rightarrow> ('r \\<Rightarrow> ant)\" where\n  \"n_val K v = (\\<lambda>x\\<in> carrier K.  (THE l. (l * (Lv K v)) = v x))\""], ["", "(* normal valuation *)"], ["", "definition\n  Pg :: \"[('r, 'm) Ring_scheme, 'r \\<Rightarrow> ant] \\<Rightarrow> 'r\" (* Positive generator *) where\n  \"Pg K v = (SOME x. x \\<in> carrier K - {\\<zero>\\<^bsub>K\\<^esub>} \\<and> v x = Lv K v)\""], ["", "lemma (in Corps) vals_pos_nonempty:\"valuation K v \\<Longrightarrow>\n                       {x. x \\<in> v ` carrier K \\<and> 0 < x} \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    {x \\<in> v ` carrier K. 0 < x} \\<noteq> {}", "using val_axiom5[of v] value_noninf_nonzero[of v] value_of_inv[THEN sym, of v]"], ["proof (prove)\nusing this:\n  valuation K v \\<Longrightarrow>\n  \\<exists>x.\n     x \\<in> carrier K \\<and> v x \\<noteq> \\<infinity> \\<and> v x \\<noteq> 0\n  \\<lbrakk>valuation K v; ?x \\<in> carrier K;\n   v ?x \\<noteq> \\<infinity>\\<rbrakk>\n  \\<Longrightarrow> ?x \\<noteq> \\<zero>\n  \\<lbrakk>valuation K v; ?x1 \\<in> carrier K; ?x1 \\<noteq> \\<zero>\\<rbrakk>\n  \\<Longrightarrow> - v ?x1 = v (?x1\\<^bsup>\\<hyphen> K\\<^esup>)\n\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    {x \\<in> v ` carrier K. 0 < x} \\<noteq> {}", "by (auto simp: ex_image_cong_iff) (metis Ring.ring_is_ag aGroup.ag_mOp_closed aGroup.ag_pOp_closed aGroup.ag_r_inv1 f_is_ring zero_lt_inf)"], ["", "lemma (in Corps) vals_pos_LBset:\"valuation K v \\<Longrightarrow>\n            {x. x \\<in> v ` carrier K \\<and> 0 < x} \\<subseteq> LBset 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1", "by (rule subsetI, simp add:LBset_def, erule conjE,\n       rule_tac x = x in gt_a0_ge_1, assumption)"], ["", "lemma (in Corps) Lv_pos:\"valuation K v \\<Longrightarrow> 0 < Lv K v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> 0 < Lv K v", "apply (simp add:Lv_def,\n       frule vals_pos_nonempty[of v],\n       frule vals_pos_LBset[of v],\n       simp only:ant_1[THEN sym],\n       frule AMin[of \"{x. x \\<in> v ` carrier K \\<and> 0 < x}\" \"1\"], assumption+,\n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; {x \\<in> v ` carrier K. 0 < x} \\<noteq> {};\n     {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset (ant 1);\n     AMin {x \\<in> v ` carrier K. 0 < x}\n     \\<in> {x \\<in> v ` carrier K. 0 < x};\n     \\<forall>x\\<in>{x \\<in> v ` carrier K. 0 < x}.\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x\\<rbrakk>\n    \\<Longrightarrow> 0 < AMin {x \\<in> v ` carrier K. 0 < x}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) AMin_z:\"valuation K v \\<Longrightarrow>\n         \\<exists>a. AMin {x. x \\<in> v ` carrier K \\<and> 0 < x} = ant a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<exists>a. AMin {x \\<in> v ` carrier K. 0 < x} = ant a", "apply (frule vals_pos_nonempty[of v],\n       frule vals_pos_LBset[of v],\n       simp only:ant_1[THEN sym],\n       frule AMin[of \"{x. x \\<in> v ` carrier K \\<and> 0 < x}\" \"1\"], assumption+,\n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; {x \\<in> v ` carrier K. 0 < x} \\<noteq> {};\n     {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset (ant 1);\n     AMin {x \\<in> v ` carrier K. 0 < x}\n     \\<in> {x \\<in> v ` carrier K. 0 < x};\n     \\<forall>x\\<in>{x \\<in> v ` carrier K. 0 < x}.\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         AMin {x \\<in> v ` carrier K. 0 < x} = ant a", "apply (frule val_axiom5[of v],\n       erule exE, (erule conjE)+,\n       cut_tac x = \"v x\" in aless_linear[of _ \"0\"], simp,\n       erule disjE,\n       frule_tac x = x in value_noninf_nonzero[of v], assumption+,\n       frule_tac x1 = x in value_of_inv[THEN sym, of v], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K \\<and>\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        v x < 0; x \\<noteq> \\<zero>;\n        - v x = v (x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a\n 2. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K \\<and>\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        0 < v x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a", "apply (frule_tac x = \"v x\" in aless_minus[of _ \"0\"], simp,\n       cut_tac x = x in invf_closed1, simp, erule conjE,\n       frule valuation_map[of v],\n       frule_tac a = \"x\\<^bsup>\\<hyphen> K\\<^esup>\" in mem_in_image[of \"v\" \"carrier K\" \"Z\\<^sub>\\<infinity>\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        v x < 0; x \\<noteq> \\<zero>;\n        - v x = v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K;\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>;\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<in> v ` carrier K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a\n 2. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K \\<and>\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        0 < v x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a", "apply (drule_tac a = \"v (x\\<^bsup>\\<hyphen> K\\<^esup>)\" in forall_spec, simp,\n       frule_tac x = \"x\\<^bsup>\\<hyphen> K\\<^esup>\" in val_nonzero_noninf[of v],\n       thin_tac \"v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<in> v ` carrier K\",\n       thin_tac \"{x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1\",\n       thin_tac \"AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K\",\n       thin_tac \"0 < AMin {x \\<in> v ` carrier K. 0 < x}\", simp,\n       thin_tac \"v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<in> v ` carrier K\",\n       thin_tac \"{x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1\",\n       thin_tac \"AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K\",\n       thin_tac \"0 < AMin {x \\<in> v ` carrier K. 0 < x}\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        v x < 0; x \\<noteq> \\<zero>;\n        - v x = v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K;\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>;\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<in> v ` carrier K;\n        AMin {x \\<in> v ` carrier K. 0 < x}\n        \\<le> v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<noteq> \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a\n 2. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K \\<and>\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        0 < v x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a", "apply (rule noninf_mem_Z[of \"AMin {x \\<in> v ` carrier K. 0 < x}\"],\n       frule image_sub[of v \"carrier K\" \"Z\\<^sub>\\<infinity>\" \"carrier K\"],\n       rule subset_refl)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        v x < 0; x \\<noteq> \\<zero>;\n        - v x = v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K;\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>;\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<in> v ` carrier K;\n        AMin {x \\<in> v ` carrier K. 0 < x}\n        \\<le> v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<noteq> \\<infinity>;\n        v ` carrier K \\<subseteq> Z\\<^sub>\\<infinity>\\<rbrakk>\n       \\<Longrightarrow> AMin {x \\<in> v ` carrier K. 0 < x}\n                         \\<in> Z\\<^sub>\\<infinity>\n 2. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        v x < 0; x \\<noteq> \\<zero>;\n        - v x = v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K;\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>;\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<in> v ` carrier K;\n        AMin {x \\<in> v ` carrier K. 0 < x}\n        \\<le> v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<noteq> \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> AMin {x \\<in> v ` carrier K. 0 < x} \\<noteq>\n                         \\<infinity>\n 3. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K \\<and>\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        0 < v x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a", "apply (rule subsetD[of \"v ` carrier K\" \"Z\\<^sub>\\<infinity>\"\n                    \"AMin {x \\<in> v ` carrier K. 0 < x}\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        v x < 0; x \\<noteq> \\<zero>;\n        - v x = v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K;\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>;\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<in> v ` carrier K;\n        AMin {x \\<in> v ` carrier K. 0 < x}\n        \\<le> v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        v (x\\<^bsup>\\<hyphen> K\\<^esup>) \\<noteq> \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> AMin {x \\<in> v ` carrier K. 0 < x} \\<noteq>\n                         \\<infinity>\n 2. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<in> v ` carrier K \\<and>\n        0 < AMin {x \\<in> v ` carrier K. 0 < x};\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        0 < v x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            AMin {x \\<in> v ` carrier K. 0 < x} = ant a", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xb xc.\n       \\<lbrakk>valuation K v;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           v xb \\<le> x;\n        x \\<in> carrier K; v x \\<noteq> \\<infinity>; v x \\<noteq> 0;\n        0 < v x; 0 < v xb; AMin {x \\<in> v ` carrier K. 0 < x} = v xb;\n        xb \\<in> carrier K; 0 < v xc; xc \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. v xb = ant a", "by (metis (no_types, lifting) aneg_le aug_inf_noninf_is_z image_eqI value_in_aug_inf z_less_i)"], ["", "lemma (in Corps) Lv_z:\"valuation K v \\<Longrightarrow> \\<exists>z. Lv K v = ant z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> \\<exists>z. Lv K v = ant z", "by (simp add:Lv_def, rule AMin_z, assumption+)"], ["", "lemma (in Corps) AMin_k:\"valuation K v \\<Longrightarrow>\n         \\<exists>k\\<in> carrier K - {\\<zero>}. AMin {x. x \\<in> v ` carrier K \\<and> 0 < x} = v k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<exists>k\\<in>carrier K - {\\<zero>}.\n       AMin {x \\<in> v ` carrier K. 0 < x} = v k", "apply (frule vals_pos_nonempty[of v],\n       frule vals_pos_LBset[of v],\n       simp only:ant_1[THEN sym],\n       frule AMin[of \"{x. x \\<in> v ` carrier K \\<and> 0 < x}\" \"1\"], assumption+,\n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; {x \\<in> v ` carrier K. 0 < x} \\<noteq> {};\n     {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset (ant 1);\n     AMin {x \\<in> v ` carrier K. 0 < x}\n     \\<in> {x \\<in> v ` carrier K. 0 < x};\n     \\<forall>x\\<in>{x \\<in> v ` carrier K. 0 < x}.\n        AMin {x \\<in> v ` carrier K. 0 < x} \\<le> x\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k\\<in>carrier K - {\\<zero>}.\n                         AMin {x \\<in> v ` carrier K. 0 < x} = v k", "apply (thin_tac \"\\<forall>x\\<in>{x. x \\<in> v ` carrier K \\<and> 0 < x}.\n                   AMin {x. x \\<in> v ` carrier K \\<and> 0 < x} \\<le> x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; {x \\<in> v ` carrier K. 0 < x} \\<noteq> {};\n     {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset (ant 1);\n     AMin {x \\<in> v ` carrier K. 0 < x}\n     \\<in> {x \\<in> v ` carrier K. 0 < x}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k\\<in>carrier K - {\\<zero>}.\n                         AMin {x \\<in> v ` carrier K. 0 < x} = v k", "apply (simp add:image_def, erule conjE, erule bexE,\n       thin_tac \"{x. (\\<exists>xa\\<in>carrier K. x = v xa) \\<and> 0 < x} \\<subseteq> LBset 1\",\n       thin_tac \"\\<exists>x. (\\<exists>xa\\<in>carrier K. x = v xa) \\<and> 0 < x\",\n       subgoal_tac \"x \\<in> carrier K - {\\<zero>}\", blast,\n       frule AMin_z[of v],  erule exE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>valuation K v; 0 < v x; x \\<in> carrier K;\n        AMin {x. (\\<exists>xa\\<in>carrier K. x = v xa) \\<and> 0 < x} = v x;\n        AMin {x \\<in> v ` carrier K. 0 < x} = ant a\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> \\<zero>", "apply (simp add:image_def,\n       thin_tac \"AMin {x. (\\<exists>xa\\<in>carrier K. x = v xa) \\<and> 0 < x} = ant a\",\n       rule contrapos_pp, simp+, frule sym, thin_tac \"v (\\<zero>) = ant a\",\n       simp add:value_of_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_Pg:\" valuation K v \\<Longrightarrow>\n                  Pg K v \\<in> carrier K - {\\<zero>} \\<and> v (Pg K v) = Lv K v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    Pg K v \\<in> carrier K - {\\<zero>} \\<and> v (Pg K v) = Lv K v", "apply (frule AMin_k[of v], unfold Lv_def, unfold Pg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     \\<exists>k\\<in>carrier K - {\\<zero>}.\n        AMin {x \\<in> v ` carrier K. 0 < x} = v k\\<rbrakk>\n    \\<Longrightarrow> (SOME x.\n                          x \\<in> carrier K - {\\<zero>} \\<and> v x = Lv K v)\n                      \\<in> carrier K - {\\<zero>} \\<and>\n                      v (SOME x.\n                            x \\<in> carrier K - {\\<zero>} \\<and>\n                            v x = Lv K v) =\n                      AMin {x \\<in> v ` carrier K. 0 < x}", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     \\<exists>k\\<in>carrier K - {\\<zero>}.\n        AMin {x \\<in> v ` carrier K. 0 < x} = v k\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         a \\<in> carrier K - {\\<zero>} \\<and> v a = Lv K v\n 2. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>k\\<in>carrier K - {\\<zero>}.\n           AMin {x \\<in> v ` carrier K. 0 < x} = v k;\n        x \\<in> carrier K - {\\<zero>} \\<and> v x = Lv K v\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier K - {\\<zero>} \\<and>\n                         v x = AMin {x \\<in> v ` carrier K. 0 < x}", "apply (erule bexE, drule sym, unfold Lv_def, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v;\n        \\<exists>k\\<in>carrier K - {\\<zero>}.\n           AMin {x \\<in> v ` carrier K. 0 < x} = v k;\n        x \\<in> carrier K - {\\<zero>} \\<and>\n        v x = AMin {x \\<in> v ` carrier K. 0 < x}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier K - {\\<zero>} \\<and>\n                         v x = AMin {x \\<in> v ` carrier K. 0 < x}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) amin_generateTr:\"valuation K v \\<Longrightarrow>\n  \\<forall>w\\<in>carrier K - {\\<zero>}. \\<exists>z. v w = z *\\<^sub>a AMin {x. x \\<in> v ` carrier K \\<and> 0 < x}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<forall>w\\<in>carrier K - {\\<zero>}.\n       \\<exists>z. v w = z *\\<^sub>a AMin {x \\<in> v ` carrier K. 0 < x}", "apply (frule vals_pos_nonempty[of v],\n       frule vals_pos_LBset[of v],\n       simp only:ant_1[THEN sym],\n       frule AMin[of \"{x. x \\<in> v ` carrier K \\<and> 0 < x}\" \"1\"], assumption+,\n       frule AMin_z[of v], erule exE, simp,\n       thin_tac \"\\<exists>x. x \\<in> v ` carrier K \\<and> 0 < x\",\n       (erule conjE)+, rule ballI, simp, erule conjE,\n       frule_tac x = w in val_nonzero_noninf[of v], assumption+,\n       frule_tac x = w in value_in_aug_inf[of v], assumption+,\n       simp add:aug_inf_def,\n       cut_tac a = \"v w\" in mem_ant, simp, erule exE,\n       cut_tac a = z and b = a in amod_adiv_equality)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a w z.\n       \\<lbrakk>valuation K v;\n        {x \\<in> v ` carrier K. 0 < x} \\<subseteq> LBset 1;\n        AMin {x \\<in> v ` carrier K. 0 < x} = ant a;\n        ant a \\<in> v ` carrier K; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           ant a \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; v w \\<noteq> \\<infinity>;\n        v w \\<noteq> - \\<infinity>; v w = ant z;\n        ant z = (z div a) *\\<^sub>a ant a + ant (z mod a)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a ant a", "apply (case_tac \"z mod a = 0\", simp add:ant_0 aadd_0_r, blast,\n       thin_tac \"{x. x \\<in> v ` carrier K \\<and> 0 < x} \\<subseteq> LBset 1\",\n       thin_tac \"v w \\<noteq> \\<infinity>\", thin_tac \"v w \\<noteq> - \\<infinity>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a w z.\n       \\<lbrakk>valuation K v; AMin {x \\<in> v ` carrier K. 0 < x} = ant a;\n        ant a \\<in> v ` carrier K; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           ant a \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; v w = ant z;\n        ant z = (z div a) *\\<^sub>a ant a + ant (z mod a);\n        z mod a \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a ant a", "apply (frule AMin_k[of v], erule bexE,\n       drule sym,\n       drule sym,\n       drule sym,\n       rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a w z k.\n       \\<lbrakk>valuation K v; ant a \\<in> v ` carrier K; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow>\n           ant a \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; z mod a \\<noteq> 0;\n        k \\<in> carrier K - {\\<zero>};\n        AMin {x \\<in> v ` carrier K. 0 < x} = v k;\n        ant a = AMin {x \\<in> v ` carrier K. 0 < x}; ant z = v w;\n        ant z = (z div a) *\\<^sub>a ant a + ant (z mod a)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a ant a", "apply (cut_tac z = z in z_in_aug_inf,\n       cut_tac z = \"(z div a)\" and x = a in asp_z_Z,\n       cut_tac z = \"z mod a\" in z_in_aug_inf,\n       frule_tac a = \"ant z\" and b = \"(z div a) *\\<^sub>a ant a\" and\n       c = \"ant (z mod a)\" in ant_sol, assumption+,\n       subst asprod_mult, simp, assumption, simp,\n       frule_tac x = k and z = \"z div a\" in val_exp[of v],\n        (erule conjE)+, assumption, simp, simp,\n       thin_tac \"(z div a) *\\<^sub>a v k = v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\",\n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a w z k.\n       \\<lbrakk>valuation K v; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow> v k \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; z mod a \\<noteq> 0;\n        AMin {x \\<in> v ` carrier K. 0 < x} = v k; ant a = v k;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>) + ant (z mod a) =\n        v w;\n        ant z = v w; v w \\<in> Z\\<^sub>\\<infinity>;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\n        \\<in> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> Z\\<^sub>\\<infinity>;\n        v w - v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>) =\n        ant (z mod a);\n        k \\<in> carrier K; k \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a v k", "apply (frule_tac x = k and n = \"z div a\" in field_potent_nonzero1,\n         assumption+,\n      frule_tac a = k and n = \"z div a\" in npowf_mem, assumption,\n      frule_tac x1 = \"k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>\" in value_of_inv[THEN sym, of v], assumption+,\n      simp add:diff_ant_def,\n       thin_tac \"- v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>) = v ((k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>)\",\n       cut_tac x = \"k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>\" in invf_closed1, simp,\n       simp, erule conjE,\n       frule_tac x1 = w and y1 = \"(k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\"  in\n        val_t2p[THEN sym, of  v], assumption+, simp,\n       cut_tac field_is_ring,\n       thin_tac \"v w + v ((k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>) = ant (z mod a)\",\n       thin_tac \"v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>) + ant (z mod a) = v w\",\n       frule_tac x = w and y = \"(k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\" in\n                 Ring.ring_tOp_closed[of \"K\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a w z k.\n       \\<lbrakk>valuation K v; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow> v k \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; z mod a \\<noteq> 0;\n        AMin {x \\<in> v ` carrier K. 0 < x} = v k; ant a = v k; ant z = v w;\n        v w \\<in> Z\\<^sub>\\<infinity>;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\n        \\<in> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> Z\\<^sub>\\<infinity>;\n        v (w \\<cdot>\\<^sub>r\n           (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>) =\n        ant (z mod a);\n        k \\<in> carrier K; k \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n        \\<zero>;\n        Ring K;\n        w \\<cdot>\\<^sub>r\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a v k", "apply (frule valuation_map[of v],\n       frule_tac a = \"w \\<cdot>\\<^sub>r (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\" in mem_in_image[of \"v\"\n        \"carrier K\" \"Z\\<^sub>\\<infinity>\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a w z k.\n       \\<lbrakk>valuation K v; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow> v k \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; z mod a \\<noteq> 0;\n        AMin {x \\<in> v ` carrier K. 0 < x} = v k; ant a = v k; ant z = v w;\n        v w \\<in> Z\\<^sub>\\<infinity>;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\n        \\<in> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> Z\\<^sub>\\<infinity>;\n        v (w \\<cdot>\\<^sub>r\n           (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>) =\n        ant (z mod a);\n        k \\<in> carrier K; k \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n        \\<zero>;\n        Ring K;\n        w \\<cdot>\\<^sub>r\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> v ` carrier K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a v k", "apply (thin_tac \"AMin {x. x \\<in> v ` carrier K \\<and> 0 < x} = v k\",\n       thin_tac \"v \\<in> carrier K \\<rightarrow> Z\\<^sub>\\<infinity>\",\n       subgoal_tac \"0 < v (w \\<cdot>\\<^sub>r (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> )\",\n       drule_tac a = \"v (w \\<cdot>\\<^sub>r (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>)\" in forall_spec,\n       simp add:image_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a w z k.\n       \\<lbrakk>valuation K v; 0 < a; w \\<in> carrier K; w \\<noteq> \\<zero>;\n        z mod a \\<noteq> 0; ant a = v k; ant z = v w;\n        v w \\<in> Z\\<^sub>\\<infinity>;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\n        \\<in> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> Z\\<^sub>\\<infinity>;\n        v (w \\<cdot>\\<^sub>r\n           (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>) =\n        ant (z mod a);\n        k \\<in> carrier K; k \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n        \\<zero>;\n        Ring K;\n        w \\<cdot>\\<^sub>r\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        ant (z mod a) \\<in> v ` carrier K;\n        0 < v (w \\<cdot>\\<^sub>r\n               (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n     a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>);\n        v k\n        \\<le> v (w \\<cdot>\\<^sub>r\n                 (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n       a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a v k\n 2. \\<And>a w z k.\n       \\<lbrakk>valuation K v; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow> v k \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; z mod a \\<noteq> 0;\n        ant a = v k; ant z = v w; v w \\<in> Z\\<^sub>\\<infinity>;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\n        \\<in> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> Z\\<^sub>\\<infinity>;\n        v (w \\<cdot>\\<^sub>r\n           (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>) =\n        ant (z mod a);\n        k \\<in> carrier K; k \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n        \\<zero>;\n        Ring K;\n        w \\<cdot>\\<^sub>r\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        ant (z mod a) \\<in> v ` carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < v (w \\<cdot>\\<^sub>r\n                                (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                      a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (drule sym, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a w z k.\n       \\<lbrakk>valuation K v; 0 < a; w \\<in> carrier K; w \\<noteq> \\<zero>;\n        ant z = v w; v w \\<in> Z\\<^sub>\\<infinity>;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\n        \\<in> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> Z\\<^sub>\\<infinity>;\n        v (w \\<cdot>\\<^sub>r\n           (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>) =\n        ant (z mod a);\n        k \\<in> carrier K; k \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n        \\<zero>;\n        Ring K;\n        w \\<cdot>\\<^sub>r\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        ant (z mod a) \\<in> v ` carrier K; a \\<le> z mod a;\n        v k = ant a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. v w = z *\\<^sub>a ant a\n 2. \\<And>a w z k.\n       \\<lbrakk>valuation K v; 0 < a;\n        \\<forall>x.\n           x \\<in> v ` carrier K \\<and> 0 < x \\<longrightarrow> v k \\<le> x;\n        w \\<in> carrier K; w \\<noteq> \\<zero>; z mod a \\<noteq> 0;\n        ant a = v k; ant z = v w; v w \\<in> Z\\<^sub>\\<infinity>;\n        v (k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup>)\n        \\<in> Z\\<^sub>\\<infinity>;\n        ant (z mod a) \\<in> Z\\<^sub>\\<infinity>;\n        v (w \\<cdot>\\<^sub>r\n           (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>) =\n        ant (z mod a);\n        k \\<in> carrier K; k \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<noteq> \\<zero>;\n        k\\<^bsub>K\\<^esub>\\<^bsup>(z div a)\\<^esup> \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n        \\<zero>;\n        Ring K;\n        w \\<cdot>\\<^sub>r\n        (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                                    a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> carrier K;\n        ant (z mod a) \\<in> v ` carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < v (w \\<cdot>\\<^sub>r\n                                (k\\<^bsub>K\\<^esub>\\<^bsup>(z div\n                      a)\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (frule_tac b = a and a = z in pos_mod_conj, erule conjE,\n       simp, simp,\n       frule_tac b = a and a = z in pos_mod_conj, erule conjE, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_principalTr1:\"\\<lbrakk> valuation K v\\<rbrakk>  \\<Longrightarrow>\n            Lv K v \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n             (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * Lv K v) \\<and> 0 < Lv K v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    Lv K v \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n    (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * Lv K v) \\<and>\n    0 < Lv K v", "apply (rule conjI,\n        frule val_Pg[of v], erule conjE,\n        simp add:image_def, frule sym, thin_tac \"v (Pg K v) = Lv K v\",\n        erule conjE, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * Lv K v) \\<and>\n    0 < Lv K v", "apply (rule conjI,\n       rule ballI, simp add:image_def, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>w x.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; w = v x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. w = a * Lv K v\n 2. valuation K v \\<Longrightarrow> 0 < Lv K v", "apply  (\n        frule_tac x = x in value_in_aug_inf[of v], assumption,\n        frule sym, thin_tac \"w = v x\", simp add:aug_inf_def,\n        cut_tac a = w in mem_ant, simp, erule disjE, erule exE,\n        frule_tac x = x in value_noninf_nonzero[of v], assumption+,\n        simp, frule amin_generateTr[of v])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>w x z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; w \\<noteq> - \\<infinity>;\n        v x = w; w = ant z; x \\<noteq> \\<zero>;\n        \\<forall>w\\<in>carrier K - {\\<zero>}.\n           \\<exists>z.\n              v w = z *\\<^sub>a AMin {x \\<in> v ` carrier K. 0 < x}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. w = a * Lv K v\n 2. \\<And>w x.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; w \\<noteq> - \\<infinity>;\n        v x = w; w = \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. w = a * Lv K v\n 3. valuation K v \\<Longrightarrow> 0 < Lv K v", "apply (drule_tac x = x in bspec, simp,\n        erule exE,\n        frule AMin_z[of v], erule exE, simp add:Lv_def,\n        simp add:asprod_mult, frule sym, thin_tac \"za * a = z\",\n        simp, subst a_z_z[THEN sym], blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>w x.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; w \\<noteq> - \\<infinity>;\n        v x = w; w = \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. w = a * Lv K v\n 2. valuation K v \\<Longrightarrow> 0 < Lv K v", "apply (simp add:Lv_def,\n        frule AMin_z[of v], erule exE, simp,\n        frule Lv_pos[of v], simp add:Lv_def,\n        frule_tac m1 = a in a_i_pos[THEN sym], blast,\n        simp add:Lv_pos)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_principalTr2:\"\\<lbrakk>valuation K v;\n  c \\<in> v ` (carrier K - {\\<zero>}) \\<and> (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * c) \\<and> 0 < c;\n  d \\<in> v ` (carrier K - {\\<zero>}) \\<and> (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * d) \\<and> 0 < d\\<rbrakk>\n       \\<Longrightarrow> c = d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     c \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n     (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * c) \\<and> 0 < c;\n     d \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n     (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * d) \\<and>\n     0 < d\\<rbrakk>\n    \\<Longrightarrow> c = d", "apply ((erule conjE)+,\n       drule_tac x = d in bspec,\n       simp add:image_def, erule bexE, blast,\n       drule_tac x = c in bspec,\n       simp add:image_def, erule bexE, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; c \\<in> v ` (carrier K - {\\<zero>});\n     d \\<in> v ` (carrier K - {\\<zero>}); 0 < c; 0 < d;\n     \\<exists>a. d = a * c; \\<exists>a. c = a * d\\<rbrakk>\n    \\<Longrightarrow> c = d", "apply ((erule exE)+,\n       drule sym, simp,\n       simp add:image_def, (erule bexE)+, simp,\n       (erule conjE)+,\n       frule_tac x = x in val_nonzero_z[of v], assumption+, erule exE,\n       frule_tac x = xa in val_nonzero_z[of v], assumption+, erule exE,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa x xa z za.\n       \\<lbrakk>valuation K v; 0 < z; 0 < za; c = ant z; a * ant z = ant za;\n        aa * ant za = ant z; d = ant za; x \\<in> carrier K;\n        x \\<noteq> \\<zero>; xa \\<in> carrier K; xa \\<noteq> \\<zero>;\n        v x = ant z; v xa = ant za\\<rbrakk>\n       \\<Longrightarrow> z = za", "apply (\n       subgoal_tac \"a \\<noteq> \\<infinity> \\<and> a \\<noteq> -\\<infinity>\", subgoal_tac \"aa \\<noteq> \\<infinity> \\<and> aa \\<noteq> -\\<infinity>\",\n       cut_tac a = a in mem_ant, cut_tac a = aa in mem_ant, simp,\n       (erule exE)+, simp add:a_z_z,\n       thin_tac \"c = ant z\", frule sym, thin_tac \"zb * z = za\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a aa x xa z za zb zc.\n       \\<lbrakk>valuation K v; 0 < z; 0 < zb * z; zc * zb = 1;\n        d = ant (zb * z); x \\<in> carrier K; x \\<noteq> \\<zero>;\n        xa \\<in> carrier K; xa \\<noteq> \\<zero>; v x = ant z;\n        v xa = ant (zb * z); a = ant zb; aa = ant zc; za = zb * z\\<rbrakk>\n       \\<Longrightarrow> zb = 1\n 2. \\<And>a aa x xa z za.\n       \\<lbrakk>valuation K v; 0 < z; 0 < za; c = ant z; a * ant z = ant za;\n        aa * ant za = ant z; d = ant za; x \\<in> carrier K;\n        x \\<noteq> \\<zero>; xa \\<in> carrier K; xa \\<noteq> \\<zero>;\n        v x = ant z; v xa = ant za;\n        a \\<noteq> \\<infinity> \\<and> a \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> aa \\<noteq> \\<infinity> \\<and>\n                         aa \\<noteq> - \\<infinity>\n 3. \\<And>a aa x xa z za.\n       \\<lbrakk>valuation K v; 0 < z; 0 < za; c = ant z; a * ant z = ant za;\n        aa * ant za = ant z; d = ant za; x \\<in> carrier K;\n        x \\<noteq> \\<zero>; xa \\<in> carrier K; xa \\<noteq> \\<zero>;\n        v x = ant z; v xa = ant za\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> \\<infinity> \\<and>\n                         a \\<noteq> - \\<infinity>", "apply (subgoal_tac \"0 < zb\",\n       cut_tac a = zc and b = zb in mult.commute, simp,\n       simp add:pos_zmult_eq_1_iff,\n       rule contrapos_pp, simp+,\n       cut_tac x = 0 and y = zb in less_linear, simp,\n       thin_tac \"\\<not> 0 < zb\",\n       erule disjE, simp,\n       frule_tac i = 0 and j = z and k = zb in zmult_zless_mono_neg,\n             assumption+, simp add:mult.commute)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a aa x xa z za.\n       \\<lbrakk>valuation K v; 0 < z; 0 < za; c = ant z; a * ant z = ant za;\n        aa * ant za = ant z; d = ant za; x \\<in> carrier K;\n        x \\<noteq> \\<zero>; xa \\<in> carrier K; xa \\<noteq> \\<zero>;\n        v x = ant z; v xa = ant za;\n        a \\<noteq> \\<infinity> \\<and> a \\<noteq> - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> aa \\<noteq> \\<infinity> \\<and>\n                         aa \\<noteq> - \\<infinity>\n 2. \\<And>a aa x xa z za.\n       \\<lbrakk>valuation K v; 0 < z; 0 < za; c = ant z; a * ant z = ant za;\n        aa * ant za = ant z; d = ant za; x \\<in> carrier K;\n        x \\<noteq> \\<zero>; xa \\<in> carrier K; xa \\<noteq> \\<zero>;\n        v x = ant z; v xa = ant za\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> \\<infinity> \\<and>\n                         a \\<noteq> - \\<infinity>", "apply (rule contrapos_pp, simp+, thin_tac \"a \\<noteq> \\<infinity> \\<and> a \\<noteq> - \\<infinity>\",\n       erule disjE, simp, rotate_tac 5, drule sym,\n       simp, simp, rotate_tac 5, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa x xa z za.\n       \\<lbrakk>valuation K v; 0 < z; 0 < za; c = ant z; a * ant z = ant za;\n        aa * ant za = ant z; d = ant za; x \\<in> carrier K;\n        x \\<noteq> \\<zero>; xa \\<in> carrier K; xa \\<noteq> \\<zero>;\n        v x = ant z; v xa = ant za\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> \\<infinity> \\<and>\n                         a \\<noteq> - \\<infinity>", "apply (rule contrapos_pp, simp+,\n       erule disjE, simp, rotate_tac 4,\n       drule sym, simp, simp,\n       rotate_tac 4, drule sym,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_principal:\"valuation K v \\<Longrightarrow>\n  \\<exists>!x0. x0 \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n     (\\<forall>w \\<in> v ` (carrier K). \\<exists>(a::ant). w = a * x0) \\<and> 0 < x0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<exists>!x0.\n       x0 \\<in> v ` (carrier K - {\\<zero>}) \\<and>\n       (\\<forall>w\\<in>v ` carrier K. \\<exists>a. w = a * x0) \\<and> 0 < x0", "by (rule ex_ex1I,\n    frule val_principalTr1[of v], blast,\n    rule_tac c = x0 and d = y in val_principalTr2[of v],\n                 assumption+)"], ["", "lemma (in Corps) n_val_defTr:\"\\<lbrakk>valuation K v; w \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                           \\<exists>!a. a * Lv K v = v w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; w \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!a. a * Lv K v = v w", "apply (rule ex_ex1I,\n      frule AMin_k[of v],\n      frule Lv_pos[of v], simp add:Lv_def,\n      erule bexE,\n      frule_tac x = k in val_nonzero_z[of v], simp, simp,\n      erule exE, simp, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k z.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; 0 < z;\n        AMin {x \\<in> v ` carrier K. 0 < x} = ant z; v k = ant z;\n        k \\<in> carrier K; k \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. a * ant z = v w\n 2. \\<And>a y.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * Lv K v = v w;\n        y * Lv K v = v w\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (case_tac \"w = \\<zero>\\<^bsub>K\\<^esub>\", simp add:value_of_zero,\n       frule_tac m = z in a_i_pos, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k z.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; 0 < z;\n        AMin {x \\<in> v ` carrier K. 0 < x} = ant z; v k = ant z;\n        k \\<in> carrier K; k \\<noteq> \\<zero>; w \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. a * ant z = v w\n 2. \\<And>a y.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * Lv K v = v w;\n        y * Lv K v = v w\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (frule amin_generateTr[of v],\n       drule_tac x = w in bspec, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k z.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; 0 < z;\n        AMin {x \\<in> v ` carrier K. 0 < x} = ant z; v k = ant z;\n        k \\<in> carrier K; k \\<noteq> \\<zero>; w \\<noteq> \\<zero>;\n        \\<exists>za. v w = za *\\<^sub>a ant z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a. a * ant z = v w\n 2. \\<And>a y.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * Lv K v = v w;\n        y * Lv K v = v w\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (\n       erule exE, simp add:asprod_mult,\n       subst a_z_z[THEN sym], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a y.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * Lv K v = v w;\n        y * Lv K v = v w\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (frule AMin_k[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a y.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * Lv K v = v w;\n        y * Lv K v = v w;\n        \\<exists>k\\<in>carrier K - {\\<zero>}.\n           AMin {x \\<in> v ` carrier K. 0 < x} = v k\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (erule bexE,\n      frule Lv_pos[of v], simp add:Lv_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a y k.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * v k = v w;\n        y * v k = v w; k \\<in> carrier K \\<and> k \\<noteq> \\<zero>;\n        AMin {x \\<in> v ` carrier K. 0 < x} = v k; 0 < v k\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (\n      erule conjE,\n      frule_tac x = k in val_nonzero_z[of v], assumption+,\n      erule exE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a y k z.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * ant z = v w;\n        y * ant z = v w; AMin {x \\<in> v ` carrier K. 0 < x} = ant z; 0 < z;\n        k \\<in> carrier K; k \\<noteq> \\<zero>; v k = ant z\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (\n      case_tac \"w = \\<zero>\\<^bsub>K\\<^esub>\", simp del:a_i_pos add:value_of_zero,\n      subgoal_tac \"y = \\<infinity>\", simp, rule contrapos_pp, simp+,\n      cut_tac a = a in mem_ant, simp,\n      erule disjE, simp, erule exE, simp add:a_z_z)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a y k z.\n       \\<lbrakk>valuation K v; \\<zero> \\<in> carrier K;\n        a * ant z = \\<infinity>; y * ant z = \\<infinity>;\n        AMin {x \\<in> v ` carrier K. 0 < x} = ant z; 0 < z;\n        k \\<in> carrier K; k \\<noteq> \\<zero>; v k = ant z;\n        w = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> y = \\<infinity>\n 2. \\<And>a y k z.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * ant z = v w;\n        y * ant z = v w; AMin {x \\<in> v ` carrier K. 0 < x} = ant z; 0 < z;\n        k \\<in> carrier K; k \\<noteq> \\<zero>; v k = ant z;\n        w \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (rule contrapos_pp, simp+,\n      cut_tac a = y in mem_ant, simp, erule disjE, simp,\n      erule exE, simp add:a_z_z,\n      frule_tac x = w in val_nonzero_z[of v], assumption+,\n      erule exE, simp, cut_tac a = a in mem_ant,\n      erule disjE, simp, frule sym, thin_tac \"- \\<infinity> = ant za\", simp,\n      erule disjE, erule exE, simp add:a_z_z)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a y k z za zb.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; zb * z = za;\n        y * ant z = ant za; AMin {x \\<in> v ` carrier K. 0 < x} = ant z;\n        0 < z; k \\<in> carrier K; k \\<noteq> \\<zero>; v k = ant z;\n        w \\<noteq> \\<zero>; v w = ant za; a = ant zb\\<rbrakk>\n       \\<Longrightarrow> ant zb = y\n 2. \\<And>a y k z za.\n       \\<lbrakk>valuation K v; w \\<in> carrier K; a * ant z = ant za;\n        y * ant z = ant za; AMin {x \\<in> v ` carrier K. 0 < x} = ant z;\n        0 < z; k \\<in> carrier K; k \\<noteq> \\<zero>; v k = ant z;\n        w \\<noteq> \\<zero>; v w = ant za; a = \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> a = y", "apply (cut_tac a = y in mem_ant,\n      erule disjE, simp, rotate_tac 3, drule sym,\n      simp, erule disjE, erule exE, simp add:a_z_z, frule sym,\n      thin_tac \"zb * z = za\", simp, simp,\n      rotate_tac 3, drule sym,\n      simp, simp, frule sym, thin_tac \"\\<infinity> = ant za\", simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_valTr:\"\\<lbrakk> valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n             (THE l. (l * (Lv K v)) = v x)*(Lv K v) = v x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (THE l. l * Lv K v = v x) * Lv K v = v x", "by (rule theI', rule n_val_defTr, assumption+)"], ["", "lemma (in Corps) n_val:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n                           (n_val K v x)*(Lv K v) = v x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n_val K v x * Lv K v = v x", "by (frule n_valTr[of v x], assumption+, simp add:n_val_def)"], ["", "lemma (in Corps) val_pos_n_val_pos:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n           (0 \\<le> v x) = (0 \\<le> n_val K v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> v x) = (0 \\<le> n_val K v x)", "apply (frule n_val[of v x], assumption+,\n       drule sym,\n       frule Lv_pos[of v],\n       frule Lv_z[of v], erule exE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; v x = n_val K v x * ant z;\n        0 < z; Lv K v = ant z\\<rbrakk>\n       \\<Longrightarrow> (0 \\<le> n_val K v x * ant z) =\n                         (0 \\<le> n_val K v x)", "apply (frule_tac w = z and x = 0 and y = \"n_val K v x\" in amult_pos_mono_r,\n       simp add:amult_0_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_in_aug_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                           n_val K v x \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n_val K v x \\<in> Z\\<^sub>\\<infinity>", "apply (cut_tac field_is_ring, frule Ring.ring_zero[of \"K\"],\n       frule Lv_pos[of v],\n       frule Lv_z[of v], erule exE,\n       simp add:aug_inf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; Ring K;\n        \\<zero> \\<in> carrier K; 0 < z; Lv K v = ant z\\<rbrakk>\n       \\<Longrightarrow> n_val K v x \\<noteq> - \\<infinity>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; Ring K;\n        \\<zero> \\<in> carrier K; 0 < z; Lv K v = ant z;\n        n_val K v x = - \\<infinity>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\", simp,\n       frule n_val[of v \"\\<zero>\"],\n       simp add:value_of_zero, simp add:value_of_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; Ring K;\n        \\<zero> \\<in> carrier K; 0 < z; Lv K v = ant z;\n        n_val K v x = - \\<infinity>; x \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule n_val[of v x], simp,\n       frule val_nonzero_z[of v x], assumption+,\n       erule exE, simp, rotate_tac -2, drule sym,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_0:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n       \\<Longrightarrow>  n_val K v x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n    \\<Longrightarrow> n_val K v x = 0", "by (frule Lv_z[of v], erule exE,\n       frule Lv_pos[of v],\n       frule n_val[of v x], simp, simp,\n       rule_tac z = z and a = \"n_val K v x\" in a_a_z_0, assumption+)"], ["", "lemma (in Corps) value_n0_n_val_n0:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x \\<noteq> 0\\<rbrakk> \\<Longrightarrow>\n                             n_val K v x \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> n_val K v x \\<noteq> 0", "apply (frule n_val[of v x],\n       rule contrapos_pp, simp+, frule Lv_z[of v],\n       erule exE, simp, simp only:ant_0[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; v x \\<noteq> ant 0;\n        n_val K v x * ant z = v x; Lv K v = ant z\\<rbrakk>\n       \\<Longrightarrow> n_val K v x \\<noteq> ant 0", "apply (rule contrapos_pp, simp+,\n       simp add:a_z_z)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_0_n_val_0:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                         (v x = 0) = (n_val K v x = 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (v x = 0) = (n_val K v x = 0)", "apply (rule iffI,\n       simp add:n_val_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; n_val K v x = 0\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (rule contrapos_pp, simp+,\n       frule value_n0_n_val_n0[of v x], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; n_val K v x = 0;\n     v x \\<noteq> 0; n_val K v x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_noninf_n_val_noninf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n      (v x \\<noteq> \\<infinity>) = (n_val K v x \\<noteq> \\<infinity>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (v x \\<noteq> \\<infinity>) =\n                      (n_val K v x \\<noteq> \\<infinity>)", "by (frule Lv_z[of v], erule exE,\n       frule Lv_pos[of v], simp,\n       frule n_val[THEN sym, of v x],simp, simp,\n       thin_tac \"v x = n_val K v x * ant z\",\n       rule iffI, rule contrapos_pp, simp+,\n       cut_tac mem_ant[of \"n_val K v x\"], erule disjE, simp,\n       erule disjE, erule exE, simp add:a_z_z, simp, simp)"], ["", "lemma (in Corps) val_inf_n_val_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n      (v x = \\<infinity>) = (n_val K v x = \\<infinity>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (v x = \\<infinity>) = (n_val K v x = \\<infinity>)", "by (cut_tac val_noninf_n_val_noninf[of v x], simp, assumption+)"], ["", "lemma (in Corps) val_eq_n_val_eq:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n  \\<Longrightarrow>  (v x = v y) = (n_val K v x = n_val K v y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (v x = v y) = (n_val K v x = n_val K v y)", "apply (subst n_val[THEN sym, of v x], assumption+,\n       subst n_val[THEN sym, of v y], assumption+,\n       frule Lv_pos[of v], frule Lv_z[of v], erule exE, simp,\n       frule_tac s = z in zless_neq[THEN not_sym, of \"0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; 0 < z;\n        Lv K v = ant z; z \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> (n_val K v x * ant z = n_val K v y * ant z) =\n                         (n_val K v x = n_val K v y)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; 0 < z;\n        Lv K v = ant z; z \\<noteq> 0;\n        n_val K v x * ant z = n_val K v y * ant z\\<rbrakk>\n       \\<Longrightarrow> n_val K v x = n_val K v y\n 2. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; 0 < z;\n        Lv K v = ant z; z \\<noteq> 0; n_val K v x = n_val K v y\\<rbrakk>\n       \\<Longrightarrow> n_val K v x * ant z = n_val K v y * ant z", "apply (rule_tac z = z in amult_eq_eq_r[of _ \"n_val K v x\" \"n_val K v y\"],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; 0 < z;\n        Lv K v = ant z; z \\<noteq> 0; n_val K v x = n_val K v y\\<rbrakk>\n       \\<Longrightarrow> n_val K v x * ant z = n_val K v y * ant z", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_poss_n_val_poss:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n           (0 < v x) = (0 < n_val K v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (0 < v x) = (0 < n_val K v x)", "apply (simp add:less_le,\n       frule val_pos_n_val_pos[of v x], assumption+,\n       rule iffI, erule conjE, simp,\n       simp add:value_n0_n_val_n0[of v x])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     (0 \\<le> v x) = (0 \\<le> n_val K v x);\n     0 \\<le> n_val K v x \\<and> n_val K v x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v x \\<and> v x \\<noteq> 0", "apply (drule sym,\n       erule conjE, simp,\n       frule_tac val_0_n_val_0[THEN sym, of v x], assumption+,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_Pg:\"valuation K v \\<Longrightarrow> n_val K v (Pg K v) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> n_val K v (Pg K v) = 1", "apply (frule val_Pg[of v], simp, (erule conjE)+,\n       frule n_val[of v \"Pg K v\"], simp, frule Lv_z[of v], erule exE, simp,\n       frule Lv_pos[of v], simp, frule_tac i = 0 and j = z in zless_neq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Pg K v \\<in> carrier K;\n        Pg K v \\<noteq> \\<zero>; v (Pg K v) = ant z;\n        n_val K v (Pg K v) * ant z = ant z; Lv K v = ant z; 0 < z;\n        0 \\<noteq> z\\<rbrakk>\n       \\<Longrightarrow> n_val K v (Pg K v) = 1", "apply (rotate_tac -1, frule not_sym, thin_tac \"0 \\<noteq> z\",\n       subgoal_tac \"n_val K v (Pg K v) * ant z = 1 * ant z\",\n       rule_tac z = z in adiv_eq[of _ \"n_val K v (Pg K v)\" \"1\"], assumption+,\n       simp add:amult_one_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_valuationTr1:\"valuation K v \\<Longrightarrow>\n                           \\<forall>x\\<in>carrier K. n_val K v x \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<forall>x\\<in>carrier K. n_val K v x \\<in> Z\\<^sub>\\<infinity>", "by (rule ballI,\n      frule n_val[of v], assumption,\n      frule_tac x = x in value_in_aug_inf[of v], assumption,\n      frule Lv_pos[of v], simp add:aug_inf_def,\n      frule Lv_z[of v], erule exE, simp,\n      rule contrapos_pp, simp+)"], ["", "lemma (in Corps) n_val_t2p:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                   n_val K v (x \\<cdot>\\<^sub>r y) = n_val K v x + (n_val K v y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n_val K v (x \\<cdot>\\<^sub>r y) =\n                      n_val K v x + n_val K v y", "apply (cut_tac field_is_ring,\n       frule Ring.ring_tOp_closed[of K x y], assumption+,\n       frule n_val[of v \"x \\<cdot>\\<^sub>r y\"], assumption+,\n       frule Lv_pos[of \"v\"],\n       simp add:val_t2p,\n       frule n_val[THEN sym, of v x], assumption+,\n       frule n_val[THEN sym, of v y], assumption+, simp,\n       frule Lv_z[of v], erule exE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; Ring K;\n        x \\<cdot>\\<^sub>r y \\<in> carrier K;\n        n_val K v (x \\<cdot>\\<^sub>r y) * ant z =\n        n_val K v x * ant z + n_val K v y * ant z;\n        0 < z; v x = n_val K v x * ant z; v y = n_val K v y * ant z;\n        Lv K v = ant z\\<rbrakk>\n       \\<Longrightarrow> n_val K v (x \\<cdot>\\<^sub>r y) =\n                         n_val K v x + n_val K v y", "apply (subgoal_tac \"ant z \\<noteq> 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; Ring K;\n        x \\<cdot>\\<^sub>r y \\<in> carrier K;\n        n_val K v (x \\<cdot>\\<^sub>r y) * ant z =\n        n_val K v x * ant z + n_val K v y * ant z;\n        0 < z; v x = n_val K v x * ant z; v y = n_val K v y * ant z;\n        Lv K v = ant z; ant z \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> n_val K v (x \\<cdot>\\<^sub>r y) =\n                         n_val K v x + n_val K v y\n 2. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K; Ring K;\n        x \\<cdot>\\<^sub>r y \\<in> carrier K;\n        n_val K v (x \\<cdot>\\<^sub>r y) * ant z =\n        n_val K v x * ant z + n_val K v y * ant z;\n        0 < z; v x = n_val K v x * ant z; v y = n_val K v y * ant z;\n        Lv K v = ant z\\<rbrakk>\n       \\<Longrightarrow> ant z \\<noteq> 0", "apply (frule_tac z1 = z in amult_distrib1[THEN sym, of _ \"n_val K v x\"\n       \"n_val K v y\"], simp,\n       thin_tac \"n_val K v x * ant z + n_val K v y * ant z =\n           (n_val K v x + n_val K v y) * ant z\",\n       rule_tac z = z and a = \"n_val K v (x \\<cdot>\\<^sub>r y)\" and\n        b = \"n_val K v x + n_val K v y\" in adiv_eq, simp, assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_valuationTr2:\"\\<lbrakk> valuation K v; x \\<in> carrier K;\n      y \\<in> carrier K\\<rbrakk>  \\<Longrightarrow>\n       amin (n_val K v x) (n_val K v y) \\<le> (n_val K v ( x \\<plusminus> y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> amin (n_val K v x) (n_val K v y)\n                      \\<le> n_val K v (x \\<plusminus> y)", "apply (frule n_val[THEN sym, of v x], assumption+,\n       frule n_val[THEN sym, of v y], assumption+,\n       frule n_val[THEN sym, of v \"x \\<plusminus> y\"],\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     v x = n_val K v x * Lv K v; v y = n_val K v y * Lv K v;\n     v (x \\<plusminus> y) = n_val K v (x \\<plusminus> y) * Lv K v\\<rbrakk>\n    \\<Longrightarrow> amin (n_val K v x) (n_val K v y)\n                      \\<le> n_val K v (x \\<plusminus> y)", "apply (frule amin_le_plus[of v x y], assumption+, simp,\n       simp add:amult_commute[of _ \"Lv K v\"],\n       frule Lv_z[of v], erule exE, simp,\n       frule Lv_pos[of v], simp,\n       simp add:amin_amult_pos, simp add:amult_pos_mono_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_valuation:\"valuation K v \\<Longrightarrow>\n                                      valuation K (n_val K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> valuation K (n_val K v)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> valuation K (n_val K v)", "apply (frule Lv_z[of v], erule exE, frule Lv_pos[of v], simp,\n       subst valuation_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; Lv K v = ant z;\n        0 < z\\<rbrakk>\n       \\<Longrightarrow> n_val K v \\<in> extensional (carrier K) \\<and>\n                         n_val K v\n                         \\<in> carrier K \\<rightarrow>\n                               Z\\<^sub>\\<infinity> \\<and>\n                         n_val K v \\<zero> = \\<infinity> \\<and>\n                         (\\<forall>x\\<in>carrier K - {\\<zero>}.\n                             n_val K v x \\<noteq> \\<infinity>) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             \\<forall>y\\<in>carrier K.\n                                n_val K v (x \\<cdot>\\<^sub>r y) =\n                                n_val K v x + n_val K v y) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             0 \\<le> n_val K v x \\<longrightarrow>\n                             0 \\<le> n_val K v\n(1\\<^sub>r \\<plusminus> x)) \\<and>\n                         (\\<exists>x.\n                             x \\<in> carrier K \\<and>\n                             n_val K v x \\<noteq> \\<infinity> \\<and>\n                             n_val K v x \\<noteq> 0)", "apply (rule conjI, simp add:n_val_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; Lv K v = ant z;\n        0 < z\\<rbrakk>\n       \\<Longrightarrow> n_val K v\n                         \\<in> carrier K \\<rightarrow>\n                               Z\\<^sub>\\<infinity> \\<and>\n                         n_val K v \\<zero> = \\<infinity> \\<and>\n                         (\\<forall>x\\<in>carrier K - {\\<zero>}.\n                             n_val K v x \\<noteq> \\<infinity>) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             \\<forall>y\\<in>carrier K.\n                                n_val K v (x \\<cdot>\\<^sub>r y) =\n                                n_val K v x + n_val K v y) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             0 \\<le> n_val K v x \\<longrightarrow>\n                             0 \\<le> n_val K v\n(1\\<^sub>r \\<plusminus> x)) \\<and>\n                         (\\<exists>x.\n                             x \\<in> carrier K \\<and>\n                             n_val K v x \\<noteq> \\<infinity> \\<and>\n                             n_val K v x \\<noteq> 0)", "apply (rule conjI, simp add:n_val_valuationTr1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; Lv K v = ant z;\n        0 < z\\<rbrakk>\n       \\<Longrightarrow> n_val K v \\<zero> = \\<infinity> \\<and>\n                         (\\<forall>x\\<in>carrier K - {\\<zero>}.\n                             n_val K v x \\<noteq> \\<infinity>) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             \\<forall>y\\<in>carrier K.\n                                n_val K v (x \\<cdot>\\<^sub>r y) =\n                                n_val K v x + n_val K v y) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             0 \\<le> n_val K v x \\<longrightarrow>\n                             0 \\<le> n_val K v\n(1\\<^sub>r \\<plusminus> x)) \\<and>\n                         (\\<exists>x.\n                             x \\<in> carrier K \\<and>\n                             n_val K v x \\<noteq> \\<infinity> \\<and>\n                             n_val K v x \\<noteq> 0)", "apply (rule conjI, frule n_val[of v \\<zero>],\n       simp add:Ring.ring_zero,\n       frule Lv_z[of v], erule exE, frule Lv_pos[of v],\n       cut_tac mem_ant[of \"n_val K v (\\<zero>)\"], erule disjE,\n       simp add:value_of_zero,\n       erule disjE, erule exE, simp add:a_z_z value_of_zero, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; Lv K v = ant z;\n        0 < z\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>x\\<in>carrier K - {\\<zero>}.\n                             n_val K v x \\<noteq> \\<infinity>) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             \\<forall>y\\<in>carrier K.\n                                n_val K v (x \\<cdot>\\<^sub>r y) =\n                                n_val K v x + n_val K v y) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             0 \\<le> n_val K v x \\<longrightarrow>\n                             0 \\<le> n_val K v\n(1\\<^sub>r \\<plusminus> x)) \\<and>\n                         (\\<exists>x.\n                             x \\<in> carrier K \\<and>\n                             n_val K v x \\<noteq> \\<infinity> \\<and>\n                             n_val K v x \\<noteq> 0)", "apply (rule conjI, rule ballI,\n       frule_tac x = x in val_nonzero_noninf[of v], simp+,\n       simp add:val_noninf_n_val_noninf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; Lv K v = ant z;\n        0 < z\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>x\\<in>carrier K.\n                             \\<forall>y\\<in>carrier K.\n                                n_val K v (x \\<cdot>\\<^sub>r y) =\n                                n_val K v x + n_val K v y) \\<and>\n                         (\\<forall>x\\<in>carrier K.\n                             0 \\<le> n_val K v x \\<longrightarrow>\n                             0 \\<le> n_val K v\n(1\\<^sub>r \\<plusminus> x)) \\<and>\n                         (\\<exists>x.\n                             x \\<in> carrier K \\<and>\n                             n_val K v x \\<noteq> \\<infinity> \\<and>\n                             n_val K v x \\<noteq> 0)", "apply (rule conjI, (rule ballI)+, simp add:n_val_t2p,\n       rule conjI, rule ballI, rule impI,\n       frule Lv_z[of v], erule exE,\n            frule Lv_pos[of v], simp,\n       frule_tac x = x in n_val[of v], simp,\n       frule_tac w1 = z and x1 = 0 and y1 = \"n_val K v x\" in\n            amult_pos_mono_r[THEN sym], simp add:amult_0_l,\n       frule_tac x = x in val_axiom4[of v], assumption+,\n       frule_tac x1 = \"1\\<^sub>r \\<plusminus> x\" in n_val[THEN sym, of v],\n       frule Ring.ring_is_ag[of \"K\"],\n           rule aGroup.ag_pOp_closed, assumption+, simp add:Ring.ring_one,\n           assumption,\n       frule_tac w = z and x = 0 and y = \"n_val K v (1\\<^sub>r \\<plusminus> x)\"\n           in amult_pos_mono_r,\n       simp add:amult_0_l)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; Lv K v = ant z;\n        0 < z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            x \\<in> carrier K \\<and>\n                            n_val K v x \\<noteq> \\<infinity> \\<and>\n                            n_val K v x \\<noteq> 0", "apply (frule val_axiom5[of v], erule exE,\n       (erule conjE)+,\n       frule_tac x = x in value_n0_n_val_n0[of v], assumption+,\n       frule_tac x = x in val_noninf_n_val_noninf, simp,\n       blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_le_val:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> (v x)\\<rbrakk>  \\<Longrightarrow>\n                 (n_val K v x) \\<le>(v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> n_val K v x \\<le> v x", "by (subst n_val[THEN sym, of v x], assumption+,\n       frule Lv_pos[of v],\n       simp add:val_pos_n_val_pos[of v x],\n       frule Lv_z[of v], erule exE,\n       cut_tac b = z and x = \"n_val K v x\" in amult_pos, simp+,\n       simp add:asprod_amult, simp add:amult_commute)"], ["", "lemma (in Corps) n_val_surj:\"valuation K v \\<Longrightarrow>\n                                   \\<exists>x\\<in> carrier K. n_val K v x = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<exists>x\\<in>carrier K. n_val K v x = 1", "apply (frule Lv_z[of v], erule exE,\n       frule Lv_pos[of v],\n       frule AMin_k[of v], erule bexE, frule_tac x = k in n_val[of v], simp,\n       simp add:Lv_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z k.\n       \\<lbrakk>valuation K v; v k = ant z; 0 < z;\n        k \\<in> carrier K \\<and> k \\<noteq> \\<zero>;\n        AMin {x \\<in> v ` carrier K. 0 < x} = ant z;\n        n_val K v k * ant z = ant z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier K. n_val K v x = 1", "apply (subgoal_tac \"n_val K v k * ant z = 1 * ant z\",\n       subgoal_tac \"z \\<noteq> 0\",\n       frule_tac z = z and a = \"n_val K v k\" and b = 1 in amult_eq_eq_r,\n         assumption, blast, simp, simp add:amult_one_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_value_in_aug_inf:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                             n_val K v x \\<in> Z\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n_val K v x \\<in> Z\\<^sub>\\<infinity>", "by (frule n_val[of v x], assumption,\n    simp add:aug_inf_def, rule contrapos_pp, simp+,\n    frule Lv_pos[of v], frule Lv_z[of v], erule exE, simp,\n    frule value_in_aug_inf[of v x], assumption+, simp add:aug_inf_def)"], ["", "lemma (in Corps) val_surj_n_valTr:\"\\<lbrakk>valuation K v; \\<exists>x \\<in> carrier K. v x = 1\\<rbrakk>\n      \\<Longrightarrow>  Lv K v = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<exists>x\\<in>carrier K. v x = 1\\<rbrakk>\n    \\<Longrightarrow> Lv K v = 1", "apply (erule bexE,\n       frule_tac x = x in n_val[of v],\n       simp, frule Lv_pos[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 1;\n        n_val K v x * Lv K v = v x; 0 < Lv K v\\<rbrakk>\n       \\<Longrightarrow> Lv K v = 1", "apply (frule_tac w = \"Lv K v\" and x = \"n_val K v x\" in amult_1_both)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 1;\n        n_val K v x * Lv K v = v x; 0 < Lv K v\\<rbrakk>\n       \\<Longrightarrow> n_val K v x * Lv K v = 1\n 2. \\<And>x.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 1;\n        n_val K v x * Lv K v = v x; 0 < Lv K v;\n        n_val K v x = 1 \\<and> Lv K v = 1\\<rbrakk>\n       \\<Longrightarrow> Lv K v = 1", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_surj_n_val:\"\\<lbrakk>valuation K v; \\<exists>x \\<in> carrier K. v x = 1\\<rbrakk> \\<Longrightarrow>\n                       (n_val K v) = v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<exists>x\\<in>carrier K. v x = 1\\<rbrakk>\n    \\<Longrightarrow> n_val K v = v", "apply (rule funcset_eq[of _ \"carrier K\"],\n      simp add:n_val_def restrict_def extensional_def,\n      simp add:valuation_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<exists>x\\<in>carrier K. v x = 1\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier K. n_val K v x = v x", "apply (rule ballI,\n       frule val_surj_n_valTr[of v], assumption+,\n       frule_tac x = x in n_val[of v], assumption+,\n       simp add:amult_one_r)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_n_val:\"valuation K v \\<Longrightarrow>\n        n_val K (n_val K v)  = n_val K v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> n_val K (n_val K v) = n_val K v", "by (frule n_val_valuation[of v],\n       frule n_val_surj[of v],\n       simp add:val_surj_n_val)"], ["", "lemma nnonzero_annonzero:\"0 < N \\<Longrightarrow> an N \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < N \\<Longrightarrow> an N \\<noteq> 0", "apply (simp only:an_0[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < N \\<Longrightarrow> an N \\<noteq> an 0", "apply (subst aneq_natneq, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Valuation ring\""], ["", "definition\n  Vr :: \"[('r, 'm) Ring_scheme, 'r \\<Rightarrow> ant] \\<Rightarrow> ('r, 'm) Ring_scheme\" where\n  \"Vr K v = Sr K ({x. x \\<in> carrier K \\<and> 0 \\<le> (v x)})\""], ["", "definition\n  vp :: \"[('r, 'm) Ring_scheme, 'r \\<Rightarrow> ant] \\<Rightarrow> 'r set\" where\n  \"vp K v = {x. x \\<in> carrier (Vr K v) \\<and> 0 < (v x)}\""], ["", "definition\n  r_apow :: \"[('r, 'm) Ring_scheme, 'r set, ant] \\<Rightarrow> 'r set\" where\n  \"r_apow R I a = (if a = \\<infinity> then {\\<zero>\\<^bsub>R\\<^esub>} else\n                   (if a = 0 then carrier R else I\\<^bsup>\\<diamondsuit>R (na a)\\<^esup>))\""], ["", "(** 0 \\<le> a and a \\<noteq> -\\<infinity> **)"], ["", "abbreviation\n  RAPOW  (\"(3_\\<^bsup> _ _\\<^esup>)\" [62,62,63]62) where\n  \"I\\<^bsup>R a\\<^esup> == r_apow R I a\""], ["", "lemma (in Ring) ring_pow_apow:\"ideal R I \\<Longrightarrow>\n                  I\\<^bsup>\\<diamondsuit>R n\\<^esup> =  I\\<^bsup>R (an n)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    I \\<^bsup>\\<diamondsuit>R n\\<^esup> = I\\<^bsup> R an n\\<^esup>", "apply (simp add:r_apow_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    (an n = 0 \\<longrightarrow>\n     I \\<^bsup>\\<diamondsuit>R n\\<^esup> = carrier R) \\<and>\n    (an n \\<noteq> 0 \\<longrightarrow>\n     (an n = \\<infinity> \\<longrightarrow>\n      I \\<^bsup>\\<diamondsuit>R n\\<^esup> = {\\<zero>}) \\<and>\n     (an n \\<noteq> \\<infinity> \\<longrightarrow>\n      I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n      I \\<^bsup>\\<diamondsuit>R na (an n)\\<^esup>))", "apply (case_tac \"n = 0\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                       carrier R) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                        {\\<zero>}) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                        I \\<^bsup>\\<diamondsuit>R na (an n)\\<^esup>))", "apply (simp add:nnonzero_annonzero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; 0 < n\\<rbrakk>\n    \\<Longrightarrow> (an n = \\<infinity> \\<longrightarrow>\n                       I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                       {\\<zero>}) \\<and>\n                      (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                       I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                       I \\<^bsup>\\<diamondsuit>R na (an n)\\<^esup>)", "apply (simp add:an_neq_inf na_an)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) r_apow_Suc:\"ideal R I \\<Longrightarrow> I\\<^bsup>R (an (Suc 0))\\<^esup> = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> I\\<^bsup> R an (Suc 0)\\<^esup> = I", "apply (cut_tac an_1, simp add:r_apow_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; an (Suc 0) = 1\\<rbrakk>\n    \\<Longrightarrow> (1 = 0 \\<longrightarrow> carrier R = I) \\<and>\n                      (1 \\<noteq> 0 \\<longrightarrow>\n                       (\\<infinity> = 1 \\<longrightarrow>\n                        {\\<zero>} = I) \\<and>\n                       (\\<infinity> \\<noteq> 1 \\<longrightarrow>\n                        I \\<^bsup>\\<diamondsuit>R na 1\\<^esup> = I))", "apply (simp add:a0_neq_1[THEN not_sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; an (Suc 0) = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<infinity> = 1 \\<longrightarrow>\n                       {\\<zero>} = I) \\<and>\n                      (\\<infinity> \\<noteq> 1 \\<longrightarrow>\n                       I \\<^bsup>\\<diamondsuit>R na 1\\<^esup> = I)", "apply (simp only:ant_1[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; an (Suc 0) = ant 1\\<rbrakk>\n    \\<Longrightarrow> (\\<infinity> = ant 1 \\<longrightarrow>\n                       {\\<zero>} = I) \\<and>\n                      (\\<infinity> \\<noteq> ant 1 \\<longrightarrow>\n                       I \\<^bsup>\\<diamondsuit>R na (ant 1)\\<^esup> = I)", "apply (simp del:ant_1 add:z_neq_inf[of 1, THEN not_sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; an (Suc 0) = ant 1\\<rbrakk>\n    \\<Longrightarrow> I \\<^bsup>\\<diamondsuit>R na (ant 1)\\<^esup> = I", "apply (simp add:na_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; an (Suc 0) = 1\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r carrier R = I", "apply (simp add:idealprod_whole_r)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) apow_ring_pow:\"ideal R I \\<Longrightarrow>\n                  I\\<^bsup>\\<diamondsuit>R n\\<^esup> =  I\\<^bsup>R (an n)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    I \\<^bsup>\\<diamondsuit>R n\\<^esup> = I\\<^bsup> R an n\\<^esup>", "apply (simp add:r_apow_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    (an n = 0 \\<longrightarrow>\n     I \\<^bsup>\\<diamondsuit>R n\\<^esup> = carrier R) \\<and>\n    (an n \\<noteq> 0 \\<longrightarrow>\n     (an n = \\<infinity> \\<longrightarrow>\n      I \\<^bsup>\\<diamondsuit>R n\\<^esup> = {\\<zero>}) \\<and>\n     (an n \\<noteq> \\<infinity> \\<longrightarrow>\n      I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n      I \\<^bsup>\\<diamondsuit>R na (an n)\\<^esup>))", "apply (case_tac \"n = 0\", simp add:an_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                       carrier R) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                        {\\<zero>}) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                        I \\<^bsup>\\<diamondsuit>R na (an n)\\<^esup>))", "apply (simp add: aless_nat_less[THEN sym],\n       cut_tac an_neq_inf[of n],\n       simp add: less_le[of 0 \"an n\"] na_an)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_ring:\"valuation K v \\<Longrightarrow> Ring (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> Ring (Vr K v)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       simp add:Vr_def, rule Ring.Sr_ring, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> sr K {x \\<in> carrier K. 0 \\<le> v x}", "apply (simp add:sr_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier K \\<and>\n                      0 \\<le> v 1\\<^sub>r \\<and>\n                      (\\<forall>x.\n                          x \\<in> carrier K \\<and>\n                          0 \\<le> v x \\<longrightarrow>\n                          (\\<forall>y.\n                              y \\<in> carrier K \\<and>\n                              0 \\<le> v y \\<longrightarrow>\n                              x \\<plusminus> -\\<^sub>a y\n                              \\<in> carrier K \\<and>\n                              0 \\<le> v (x \\<plusminus> -\\<^sub>a y) \\<and>\n                              x \\<cdot>\\<^sub>r y \\<in> carrier K \\<and>\n                              0 \\<le> v (x \\<cdot>\\<^sub>r y)))", "apply (intro conjI subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier K\n 2. \\<lbrakk>valuation K v; Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v 1\\<^sub>r\n 3. \\<lbrakk>valuation K v; Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         x \\<in> carrier K \\<and>\n                         0 \\<le> v x \\<longrightarrow>\n                         (\\<forall>y.\n                             y \\<in> carrier K \\<and>\n                             0 \\<le> v y \\<longrightarrow>\n                             x \\<plusminus> -\\<^sub>a y\n                             \\<in> carrier K \\<and>\n                             0 \\<le> v (x \\<plusminus> -\\<^sub>a y) \\<and>\n                             x \\<cdot>\\<^sub>r y \\<in> carrier K \\<and>\n                             0 \\<le> v (x \\<cdot>\\<^sub>r y))", "apply (simp_all add: value_of_one Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         x \\<in> carrier K \\<and>\n                         0 \\<le> v x \\<longrightarrow>\n                         (\\<forall>y.\n                             y \\<in> carrier K \\<and>\n                             0 \\<le> v y \\<longrightarrow>\n                             x \\<plusminus> -\\<^sub>a y\n                             \\<in> carrier K \\<and>\n                             0 \\<le> v (x \\<plusminus> -\\<^sub>a y) \\<and>\n                             x \\<cdot>\\<^sub>r y \\<in> carrier K \\<and>\n                             0 \\<le> v (x \\<cdot>\\<^sub>r y))", "apply ((rule allI, rule impI)+,\n       (erule conjE)+, rule conjI, rule aGroup.ag_pOp_closed, assumption+,\n       rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; x \\<in> carrier K;\n        0 \\<le> v x; y \\<in> carrier K; 0 \\<le> v y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> v (x \\<plusminus> -\\<^sub>a y) \\<and>\n                         x \\<cdot>\\<^sub>r y \\<in> carrier K \\<and>\n                         0 \\<le> v (x \\<cdot>\\<^sub>r y)", "apply (frule_tac x = x and y = \"-\\<^sub>a y\" in amin_le_plus[of v], assumption+,\n       rule aGroup.ag_mOp_closed, assumption+,\n       simp add:val_minus_eq[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; x \\<in> carrier K;\n        0 \\<le> v x; y \\<in> carrier K; 0 \\<le> v y;\n        amin (v x) (v y) \\<le> v (x \\<plusminus> -\\<^sub>a y)\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> v (x \\<plusminus> -\\<^sub>a y) \\<and>\n                         x \\<cdot>\\<^sub>r y \\<in> carrier K \\<and>\n                         0 \\<le> v (x \\<cdot>\\<^sub>r y)", "apply (\n       frule_tac z = 0 and x = \"v x\" and y = \"v y\" in amin_ge1, assumption+,\n       frule_tac i = 0 and j = \"amin (v x) (v y)\" and k = \"v (x \\<plusminus> -\\<^sub>a y)\" in\n       ale_trans, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; Ring K; aGroup K; x \\<in> carrier K;\n        0 \\<le> v x; y \\<in> carrier K; 0 \\<le> v y;\n        amin (v x) (v y) \\<le> v (x \\<plusminus> -\\<^sub>a y);\n        0 \\<le> amin (v x) (v y);\n        0 \\<le> v (x \\<plusminus> -\\<^sub>a y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<in> carrier K \\<and>\n                         0 \\<le> v (x \\<cdot>\\<^sub>r y)", "by (simp add: Ring.ring_tOp_closed aadd_two_pos val_t2p)"], ["", "lemma (in Corps) val_pos_mem_Vr:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                             (0 \\<le> (v x)) = (x \\<in> carrier (Vr K v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> v x) = (x \\<in> carrier (Vr K v))", "by (rule iffI, (simp add:Vr_def Sr_def)+)"], ["", "lemma (in Corps) val_poss_mem_Vr:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 < (v x)\\<rbrakk>\n                        \\<Longrightarrow>  x \\<in> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; 0 < v x\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (Vr K v)", "by (frule aless_imp_le[of \"0\" \"v x\"], simp add:val_pos_mem_Vr)"], ["", "lemma (in Corps) Vr_one:\"valuation K v \\<Longrightarrow> 1\\<^sub>r\\<^bsub>K\\<^esub> \\<in> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> 1\\<^sub>r \\<in> carrier (Vr K v)", "by (cut_tac field_is_ring, frule Ring.ring_one[of \"K\"],\n       frule val_pos_mem_Vr[of v \"1\\<^sub>r\"], assumption+,\n       simp add:value_of_one)"], ["", "lemma (in Corps) Vr_mem_f_mem:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n     \\<Longrightarrow>  x \\<in> carrier K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K", "by (simp add:Vr_def Sr_def)"], ["", "lemma (in Corps) Vr_0_f_0:\"valuation K v \\<Longrightarrow> \\<zero>\\<^bsub>Vr K v\\<^esub> = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> \\<zero>\\<^bsub>Vr K v\\<^esub> = \\<zero>", "by (simp add:Vr_def Sr_def)"], ["", "lemma (in Corps) Vr_1_f_1:\"valuation K v \\<Longrightarrow> 1\\<^sub>r\\<^bsub>(Vr K v)\\<^esub> = 1\\<^sub>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>Vr K v\\<^esub> = 1\\<^sub>r", "by (simp add:Vr_def Sr_def)"], ["", "lemma (in Corps) Vr_pOp_f_pOp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n       y \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>  x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y = x \\<plusminus> y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y =\n                      x \\<plusminus> y", "by (simp add:Vr_def Sr_def)"], ["", "lemma (in Corps) Vr_mOp_f_mOp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n                     \\<Longrightarrow> -\\<^sub>a\\<^bsub>(Vr K v)\\<^esub> x = -\\<^sub>a x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>Vr K v\\<^esub> x = -\\<^sub>a x", "by (simp add:Vr_def Sr_def)"], ["", "lemma (in Corps) Vr_tOp_f_tOp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n                     y \\<in> carrier(Vr K  v)\\<rbrakk> \\<Longrightarrow>  x \\<cdot>\\<^sub>r\\<^bsub>(Vr K v)\\<^esub> y = x \\<cdot>\\<^sub>r y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y =\n                      x \\<cdot>\\<^sub>r y", "by (simp add:Vr_def Sr_def)"], ["", "lemma (in Corps) Vr_pOp_le:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n       y \\<in> carrier (Vr K v)\\<rbrakk>  \\<Longrightarrow> v x \\<le> (v x + (v y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     y \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> v x \\<le> v x + v y", "apply (frule val_pos_mem_Vr[THEN sym, of v y],\n       simp add:Vr_mem_f_mem, simp, frule aadd_pos_le[of \"v y\" \"v x\"],\n       simp add:aadd_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_integral:\"valuation K v \\<Longrightarrow> Idomain (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> Idomain (Vr K v)", "apply (simp add:Idomain_def,\n       simp add:Vr_ring, simp add:Idomain_axioms_def,\n       rule allI, rule impI, rule allI, (rule impI)+,\n       simp add:Vr_tOp_f_tOp, simp add:Vr_0_f_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>valuation K v; a \\<in> carrier (Vr K v);\n        b \\<in> carrier (Vr K v); a \\<cdot>\\<^sub>r b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> a = \\<zero> \\<or> b = \\<zero>", "apply (rule contrapos_pp, simp+, erule conjE,\n       cut_tac field_is_idom,\n       frule_tac x = a in Vr_mem_f_mem[of v], assumption,\n       frule_tac x = b in Vr_mem_f_mem[of v], assumption,\n       frule_tac x = a and y = b in Idomain.idom_tOp_nonzeros[of \"K\"],\n       assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_exp_mem:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n      \\<Longrightarrow>  x^\\<^bsup>K n\\<^esup> \\<in> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<in> carrier (Vr K v)", "by (frule Vr_ring[of v],\n       induct_tac n, simp add:Vr_one,\n       simp add:Vr_tOp_f_tOp[THEN sym, of v],\n       simp add:Ring.ring_tOp_closed)"], ["", "lemma (in Corps) Vr_exp_f_exp:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>\n                                    x^\\<^bsup>(Vr K v) n\\<^esup> =  x^\\<^bsup>K n\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>Vr K v n\\<^esup> = x^\\<^bsup>K n\\<^esup>", "apply (induct_tac n,\n      simp, simp add:Vr_1_f_1, simp,\n      thin_tac \"x^\\<^bsup>(Vr K v) n\\<^esup> = x^\\<^bsup>K n\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n                         x =\n                         x^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r x", "apply (rule Vr_tOp_f_tOp, assumption+,\n      simp add:Vr_exp_mem, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_potent_nonzero:\"\\<lbrakk>valuation K v;\n      x \\<in> carrier (Vr K v) - {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>  \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> carrier (Vr K v) - {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<noteq>\n                      \\<zero>\\<^bsub>Vr K v\\<^esub>", "apply (frule Vr_mem_f_mem[of v x], simp,\n       simp add:Vr_0_f_0, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<in> carrier (Vr K v);\n     x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>", "apply (frule Vr_mem_f_mem[of v x], assumption+,\n        simp add:field_potent_nonzero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) elem_0_val_if:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n              \\<Longrightarrow> x \\<in> carrier (Vr K v) \\<and> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (Vr K v) \\<and>\n                      x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)", "apply (frule val_pos_mem_Vr[of v x], assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0;\n     x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)", "apply (frule value_zero_nonzero[of \"v\" \"x\"], simp add:Vr_mem_f_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0;\n     x \\<in> carrier (Vr K v); x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)", "apply (frule value_of_inv[of v x], assumption+,\n       simp, subst val_pos_mem_Vr[THEN sym, of v \"x\\<^bsup>\\<hyphen>K\\<^esup>\"], assumption+,\n       cut_tac invf_closed[of x], simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) elem0val:\"\\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n      (v x = 0) = ( x \\<in> carrier (Vr K v) \\<and> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (v x = 0) =\n                      (x \\<in> carrier (Vr K v) \\<and>\n                       x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v))", "apply (rule iffI, rule elem_0_val_if[of v], assumption+,\n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x \\<in> carrier (Vr K v);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (simp add:val_pos_mem_Vr[THEN sym, of v x],\n      frule Vr_mem_f_mem[of v \"x\\<^bsup>\\<hyphen>K\\<^esup>\"], assumption+,\n      simp add:val_pos_mem_Vr[THEN sym, of v \"x\\<^bsup>\\<hyphen>K\\<^esup>\"],\n      simp add:value_of_inv, frule ale_minus[of \"0\" \"- v x\"],\n      simp add:a_minus_minus)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) ideal_inc_elem0val_whole:\"\\<lbrakk> valuation K v; x \\<in> carrier K;\n v x = 0; ideal (Vr K v) I; x \\<in> I\\<rbrakk> \\<Longrightarrow>  I = carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0; ideal (Vr K v) I;\n     x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I = carrier (Vr K v)", "apply (frule elem_0_val_if[of v x], assumption+, erule conjE,\n       frule value_zero_nonzero[of v x], assumption+,\n       frule Vr_ring[of v],\n       frule_tac I = I and x = x and r = \"x\\<^bsup>\\<hyphen>K\\<^esup>\" in\n       Ring.ideal_ring_multiple[of \"Vr K v\"], assumption+,\n       cut_tac invf_closed1[of x], simp+, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0; ideal (Vr K v) I;\n     x \\<in> I; x \\<in> carrier (Vr K v);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n     x \\<noteq> \\<zero>; Ring (Vr K v);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> x\n     \\<in> I;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> I = carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; v x = 0; ideal (Vr K v) I;\n     x \\<in> I; x \\<in> carrier (Vr K v);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n     x \\<noteq> \\<zero>; Ring (Vr K v);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> x\n     \\<in> I\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:Vr_tOp_f_tOp, cut_tac invf_inv[of x], simp+,\n       simp add: Vr_1_f_1[THEN sym, of v],\n       simp add:Ring.ideal_inc_one, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vp_mem_Vr_mem:\"\\<lbrakk>valuation K v; x \\<in> (vp K v)\\<rbrakk> \\<Longrightarrow>\n                                                x \\<in> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (Vr K v)", "by (rule val_poss_mem_Vr[of v x], assumption+, (simp add:vp_def\n       Vr_def Sr_def)+)"], ["", "lemma (in Corps) vp_mem_val_poss:\"\\<lbrakk> valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                                   (x \\<in> vp K v) = (0 < (v x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (x \\<in> vp K v) = (0 < v x)", "by (simp add:vp_def, simp add:Vr_def Sr_def less_ant_def)"], ["", "lemma (in Corps) Pg_in_Vr:\"valuation K v \\<Longrightarrow>  Pg K v \\<in> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> Pg K v \\<in> carrier (Vr K v)", "by (frule val_Pg[of v], erule conjE,\n    frule Lv_pos[of v], drule sym,\n    simp, erule conjE,\n    simp add:val_poss_mem_Vr)"], ["", "lemma (in Corps) vp_ideal:\"valuation K v \\<Longrightarrow>  ideal (Vr K v) (vp K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> ideal (Vr K v) (vp K v)", "apply (cut_tac field_is_ring,\n       frule Vr_ring[of v],\n       rule Ring.ideal_condition1, assumption+,\n       rule subsetI, simp add:vp_mem_Vr_mem,\n       simp add:vp_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> carrier (Vr K v) \\<and> 0 < v x\n 2. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>vp K v.\n                         \\<forall>y\\<in>vp K v.\n                            x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y\n                            \\<in> vp K v\n 3. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (Vr K v).\n                         \\<forall>x\\<in>vp K v.\n                            r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> x\n                            \\<in> vp K v", "apply (frule val_Pg[of v],\n       frule Lv_pos[of v], simp, (erule conjE)+,\n       drule sym, simp,\n       frule val_poss_mem_Vr[of v \"Pg K v\"], assumption+, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>vp K v.\n                         \\<forall>y\\<in>vp K v.\n                            x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y\n                            \\<in> vp K v\n 2. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (Vr K v).\n                         \\<forall>x\\<in>vp K v.\n                            r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> x\n                            \\<in> vp K v", "apply ((rule ballI)+,\n       frule_tac x = x in vp_mem_Vr_mem[of v], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; Ring K; Ring (Vr K v); x \\<in> vp K v;\n        y \\<in> vp K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y \\<in> vp K v\n 2. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (Vr K v).\n                         \\<forall>x\\<in>vp K v.\n                            r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> x\n                            \\<in> vp K v", "apply (\n       frule_tac x = y in vp_mem_Vr_mem[of v], assumption,\n       simp add:vp_def,\n       frule Ring.ring_is_ag[of \"Vr K v\"],\n       frule_tac x = x and y = y in aGroup.ag_pOp_closed, assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; Ring K; Ring (Vr K v); 0 < v x; 0 < v y;\n        x \\<in> carrier (Vr K v); y \\<in> carrier (Vr K v); aGroup (Vr K v);\n        x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y\n        \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> 0 < v (x \\<plusminus>\\<^bsub>Vr K v\\<^esub> y)\n 2. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (Vr K v).\n                         \\<forall>x\\<in>vp K v.\n                            r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> x\n                            \\<in> vp K v", "apply (simp add:Vr_pOp_f_pOp,\n        cut_tac x = \"v x\" and y = \"v y\" in amin_le_l,\n        frule_tac x = x and y = y in amin_le_plus,\n        (simp add:Vr_mem_f_mem)+,\n       (frule_tac z = 0 and x = \"v x\" and y = \"v y\" in amin_gt, assumption+),\n       rule_tac x = 0 and y = \"amin (v x) (v y)\" and z = \"v (x \\<plusminus> y)\" in\n       less_le_trans, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (Vr K v).\n                         \\<forall>x\\<in>vp K v.\n                            r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> x\n                            \\<in> vp K v", "apply ((rule ballI)+,\n       frule_tac x1 = r in val_pos_mem_Vr[THEN sym, of v],\n       simp add:Vr_mem_f_mem, simp,\n       frule_tac x = x in vp_mem_Vr_mem[of v], simp add:Vr_pOp_f_pOp,\n       simp add:vp_def, simp add:Ring.ring_tOp_closed,\n       simp add:Vr_tOp_f_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>valuation K v; Ring K; Ring (Vr K v); 0 \\<le> v r; 0 < v x;\n        r \\<in> carrier (Vr K v); x \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> 0 < v (r \\<cdot>\\<^sub>r x)", "apply (frule_tac x = r in Vr_mem_f_mem[of v], assumption+,\n       frule_tac x = x in Vr_mem_f_mem[of v], assumption+,\n       simp add:val_t2p, simp add:aadd_pos_poss)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vp_not_whole:\"valuation K v \\<Longrightarrow>\n                       (vp K v) \\<noteq> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> vp K v \\<noteq> carrier (Vr K v)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; aGroup K; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<noteq> carrier (Vr K v)", "apply (rule contrapos_pp, simp+,\n       drule sym,\n       frule Ring.ring_one[of \"Vr K v\"], simp,\n       simp add:Vr_1_f_1,\n       frule Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring K; aGroup K; Ring (Vr K v);\n     carrier (Vr K v) = vp K v; 1\\<^sub>r \\<in> vp K v;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp only:vp_mem_val_poss[of v \"1\\<^sub>r\"],\n        simp add:value_of_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) elem_out_ideal_nonzero:\"\\<lbrakk>ideal R I; x \\<in> carrier R;\n        x \\<notin> I\\<rbrakk> \\<Longrightarrow> x \\<noteq> \\<zero>\\<^bsub>R\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier R; x \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<zero>", "by (rule contrapos_pp, simp+, frule ideal_zero[of I],\n       simp)"], ["", "lemma (in Corps) vp_prime:\"valuation K v \\<Longrightarrow> prime_ideal (Vr K v) (vp K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> prime_ideal (Vr K v) (vp K v)", "apply (simp add:prime_ideal_def, simp add:vp_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> vp K v \\<and>\n    (\\<forall>x\\<in>carrier (Vr K v).\n        \\<forall>y\\<in>carrier (Vr K v).\n           x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y\n           \\<in> vp K v \\<longrightarrow>\n           x \\<in> vp K v \\<or> y \\<in> vp K v)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. valuation K v \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> vp K v\n 2. valuation K v \\<Longrightarrow>\n    \\<forall>x\\<in>carrier (Vr K v).\n       \\<forall>y\\<in>carrier (Vr K v).\n          x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y\n          \\<in> vp K v \\<longrightarrow>\n          x \\<in> vp K v \\<or> y \\<in> vp K v", "(** if the unit is contained in (vp K v), then (vp K v) is\n    the whole ideal, this contradicts vp_not_whole **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. valuation K v \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> vp K v\n 2. valuation K v \\<Longrightarrow>\n    \\<forall>x\\<in>carrier (Vr K v).\n       \\<forall>y\\<in>carrier (Vr K v).\n          x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y\n          \\<in> vp K v \\<longrightarrow>\n          x \\<in> vp K v \\<or> y \\<in> vp K v", "apply (rule contrapos_pp, simp+,\n       frule Vr_ring[of v],\n       frule vp_ideal[of v],\n       frule Ring.ideal_inc_one[of \"Vr K v\" \"vp K v\"], assumption+,\n       simp add:vp_not_whole[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<forall>x\\<in>carrier (Vr K v).\n       \\<forall>y\\<in>carrier (Vr K v).\n          x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y\n          \\<in> vp K v \\<longrightarrow>\n          x \\<in> vp K v \\<or> y \\<in> vp K v", "(* done*)\n\n(** if x \\<cdot>\\<^bsub>(Vr K v)\\<^esub> y is in (vp K v), then 0 < v (x \\<cdot>\\<^sub>K y). We have\n    0 \\<le> (v x) and 0 \\<le> (v y), because x and y are elements of Vr K v.\n    Since v (x \\<cdot>\\<^sub>K y) = (v x) + (v y), we have 0 < (v x) or 0 < (v y).\n   To obtain the final conclusion, we suppose \\<not> (x \\<in> vp K v \\<or> y \\<in> vp K v)\n   then, we have (v x) = 0 and (v y) = 0. Frome this, we have v (x \\<cdot>\\<^sub>K y) =\n   0. Contradiction.  *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<forall>x\\<in>carrier (Vr K v).\n       \\<forall>y\\<in>carrier (Vr K v).\n          x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y\n          \\<in> vp K v \\<longrightarrow>\n          x \\<in> vp K v \\<or> y \\<in> vp K v", "apply ((rule ballI)+, rule impI, rule contrapos_pp, simp+, (erule conjE)+,\n       frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        y \\<in> carrier (Vr K v);\n        x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y \\<in> vp K v;\n        x \\<notin> vp K v; y \\<notin> vp K v; Ring (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n       frule_tac x = x in Vr_mem_f_mem[of v], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        y \\<in> carrier (Vr K v);\n        x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y \\<in> vp K v;\n        x \\<notin> vp K v; y \\<notin> vp K v; Ring (Vr K v);\n        x \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n       frule_tac x = y in Vr_mem_f_mem[of v], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        y \\<in> carrier (Vr K v);\n        x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y \\<in> vp K v;\n        x \\<notin> vp K v; y \\<notin> vp K v; Ring (Vr K v);\n        x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n       frule vp_ideal[of v],\n       frule_tac x = x in Ring.elem_out_ideal_nonzero[of \"Vr K v\" \"vp K v\"],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        y \\<in> carrier (Vr K v);\n        x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y \\<in> vp K v;\n        x \\<notin> vp K v; y \\<notin> vp K v; Ring (Vr K v);\n        x \\<in> carrier K; y \\<in> carrier K; ideal (Vr K v) (vp K v);\n        x \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n       frule_tac x = y in Ring.elem_out_ideal_nonzero[of \"Vr K v\" \"vp K v\"],\n       assumption+, simp add:Vr_0_f_0,\n       simp add:Vr_tOp_f_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        y \\<in> carrier (Vr K v); x \\<cdot>\\<^sub>r y \\<in> vp K v;\n        x \\<notin> vp K v; y \\<notin> vp K v; Ring (Vr K v);\n        x \\<in> carrier K; y \\<in> carrier K; ideal (Vr K v) (vp K v);\n        x \\<noteq> \\<zero>; y \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n       frule_tac x = \"x \\<cdot>\\<^sub>r y\" in vp_mem_val_poss[of v],\n       cut_tac field_is_ring, simp add:Ring.ring_tOp_closed, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        y \\<in> carrier (Vr K v); 0 < v (x \\<cdot>\\<^sub>r y);\n        x \\<notin> vp K v; y \\<notin> vp K v; Ring (Vr K v);\n        x \\<in> carrier K; y \\<in> carrier K; ideal (Vr K v) (vp K v);\n        x \\<noteq> \\<zero>; y \\<noteq> \\<zero>;\n        x \\<cdot>\\<^sub>r y \\<in> vp K v\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac field_is_ring,\n       frule_tac x = x and y = y in Ring.ring_tOp_closed, assumption+,\n       simp add:Ring.ring_tOp_closed[of \"Vr K v\"],\n       simp add:vp_def, simp add:aneg_less,\n       frule_tac x1 = x in val_pos_mem_Vr[THEN sym, of v], assumption+,\n       frule_tac x1 = y in val_pos_mem_Vr[THEN sym, of v], assumption+,\n       frule_tac P = \"x \\<in> carrier (Vr K v)\" and Q = \"0 \\<le> v x\" in eq_prop,\n          assumption,\n       frule_tac P = \"y \\<in> carrier (Vr K v)\" and Q = \"0 \\<le> v y\" in eq_prop,\n          assumption,\n       frule_tac x = \"v x\" and y = 0 in ale_antisym, assumption+,\n       frule_tac x = \"v y\" and y = 0 in ale_antisym, assumption+,\n       simp add:val_t2p aadd_0_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vp_pow_ideal:\"valuation K v \\<Longrightarrow>\n                      ideal (Vr K v) ((vp K v)\\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    ideal (Vr K v) (vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>)", "by (frule Vr_ring[of v], frule vp_ideal[of v],\n       simp add:Ring.ideal_pow_ideal)"], ["", "lemma (in Corps) vp_apow_ideal:\"\\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n                      ideal (Vr K v) ((vp K v)\\<^bsup>(Vr K v) n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (vp K v\\<^bsup> Vr K v n\\<^esup>)", "apply (frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (vp K v\\<^bsup> Vr K v n\\<^esup>)", "apply (case_tac \"n = 0\",\n        simp add:r_apow_def, simp add:Ring.whole_ideal[of \"Vr K v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; Ring (Vr K v); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (vp K v\\<^bsup> Vr K v n\\<^esup>)", "apply (case_tac \"n = \\<infinity>\",\n        simp add:r_apow_def, simp add:Ring.zero_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; Ring (Vr K v); n \\<noteq> 0;\n     n \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (vp K v\\<^bsup> Vr K v n\\<^esup>)", "apply (simp add:r_apow_def, simp add:vp_pow_ideal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) mem_vp_apow_mem_Vr:\"\\<lbrakk>valuation K v;\n       0 \\<le> N; x \\<in> vp K v \\<^bsup>(Vr K v) N\\<^esup>\\<rbrakk>  \\<Longrightarrow> x \\<in> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> N;\n     x \\<in> vp K v\\<^bsup> Vr K v N\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (Vr K v)", "by (frule Vr_ring[of v], frule vp_apow_ideal[of v N], assumption,\n    simp add:Ring.ideal_subset)"], ["", "lemma (in Corps) elem_out_vp_unit:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n      x \\<notin> vp K v\\<rbrakk>  \\<Longrightarrow> v x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     x \\<notin> vp K v\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "by (metis Vr_mem_f_mem ale_antisym aneg_le val_pos_mem_Vr vp_mem_val_poss)"], ["", "lemma (in Corps) vp_maximal:\"valuation K v \\<Longrightarrow>\n                          maximal_ideal (Vr K v) (vp K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> maximal_ideal (Vr K v) (vp K v)", "apply (frule Vr_ring[of v],\n       simp add:maximal_ideal_def, simp add:vp_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> vp K v \\<and>\n                      {J. ideal (Vr K v) J \\<and> vp K v \\<subseteq> J} =\n                      {vp K v, carrier (Vr K v)}", "(** we know that vp is not a whole ideal, and so vp does not include 1 **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> vp K v \\<and>\n                      {J. ideal (Vr K v) J \\<and> vp K v \\<subseteq> J} =\n                      {vp K v, carrier (Vr K v)}", "apply (frule vp_not_whole[of v],\n       rule conjI, rule contrapos_pp, simp+, frule vp_ideal[of v],\n       frule Ring.ideal_inc_one[of \"Vr K v\" \"vp K v\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; Ring (Vr K v); vp K v \\<noteq> carrier (Vr K v);\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<in> vp K v; ideal (Vr K v) (vp K v);\n     vp K v = carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {J. ideal (Vr K v) J \\<and> vp K v \\<subseteq> J} =\n                      {vp K v, carrier (Vr K v)}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {J. ideal (Vr K v) J \\<and> vp K v \\<subseteq> J} =\n                      {vp K v, carrier (Vr K v)}", "(** onemore condition of maximal ideal **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {J. ideal (Vr K v) J \\<and> vp K v \\<subseteq> J} =\n                      {vp K v, carrier (Vr K v)}", "apply (rule equalityI,\n       rule subsetI, simp, erule conjE,\n       case_tac \"x = vp K v\", simp, simp, rename_tac X)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>valuation K v; Ring (Vr K v);\n        vp K v \\<noteq> carrier (Vr K v); ideal (Vr K v) X;\n        vp K v \\<subseteq> X; X \\<noteq> vp K v\\<rbrakk>\n       \\<Longrightarrow> X = carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {vp K v, carrier (Vr K v)}\n                      \\<subseteq> {J. ideal (Vr K v) J \\<and>\nvp K v \\<subseteq> J}", "(** show exists a unit contained in X **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>valuation K v; Ring (Vr K v);\n        vp K v \\<noteq> carrier (Vr K v); ideal (Vr K v) X;\n        vp K v \\<subseteq> X; X \\<noteq> vp K v\\<rbrakk>\n       \\<Longrightarrow> X = carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {vp K v, carrier (Vr K v)}\n                      \\<subseteq> {J. ideal (Vr K v) J \\<and>\nvp K v \\<subseteq> J}", "apply (frule_tac A = X in sets_not_eq[of _ \"vp K v\"], assumption+,\n       erule bexE,\n       frule_tac I = X and h = a in Ring.ideal_subset[of \"Vr K v\"],\n       assumption+,\n       frule_tac x = a in elem_out_vp_unit[of v], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X a.\n       \\<lbrakk>valuation K v; Ring (Vr K v);\n        vp K v \\<noteq> carrier (Vr K v); ideal (Vr K v) X;\n        vp K v \\<subseteq> X; X \\<noteq> vp K v; a \\<in> X;\n        a \\<notin> vp K v; a \\<in> carrier (Vr K v); v a = 0\\<rbrakk>\n       \\<Longrightarrow> X = carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {vp K v, carrier (Vr K v)}\n                      \\<subseteq> {J. ideal (Vr K v) J \\<and>\nvp K v \\<subseteq> J}", "(** since v a = 0, we see a is a unit **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X a.\n       \\<lbrakk>valuation K v; Ring (Vr K v);\n        vp K v \\<noteq> carrier (Vr K v); ideal (Vr K v) X;\n        vp K v \\<subseteq> X; X \\<noteq> vp K v; a \\<in> X;\n        a \\<notin> vp K v; a \\<in> carrier (Vr K v); v a = 0\\<rbrakk>\n       \\<Longrightarrow> X = carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {vp K v, carrier (Vr K v)}\n                      \\<subseteq> {J. ideal (Vr K v) J \\<and>\nvp K v \\<subseteq> J}", "apply (frule_tac x = a and I = X in ideal_inc_elem0val_whole [of v],\n        simp add:Vr_mem_f_mem, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {vp K v, carrier (Vr K v)}\n                      \\<subseteq> {J. ideal (Vr K v) J \\<and>\nvp K v \\<subseteq> J}", "apply (rule subsetI, simp, erule disjE,\n       simp add:prime_ideal_def, simp add:vp_ideal,\n       simp add:Ring.whole_ideal, rule subsetI, simp add:vp_mem_Vr_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) ideal_sub_vp:\"\\<lbrakk> valuation K v; ideal (Vr K v) I;\n I \\<noteq> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow> I \\<subseteq> (vp K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I;\n     I \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> vp K v", "apply (frule Vr_ring[of v], rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     Ring (Vr K v); \\<not> I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:subset_eq,\n        erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I;\n        I \\<noteq> carrier (Vr K v); Ring (Vr K v); x \\<in> I;\n        x \\<notin> vp K v\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac h = x in Ring.ideal_subset[of \"Vr K v\" I], assumption+,\n        frule_tac x = x in elem_out_vp_unit[of v], assumption+,\n        frule_tac x = x in ideal_inc_elem0val_whole[of v _ I],\n        simp add:Vr_mem_f_mem, assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_local:\"\\<lbrakk>valuation K v; maximal_ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                   (vp K v) = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> vp K v = I", "apply (frule Vr_ring[of v],\n       frule ideal_sub_vp[of v I], simp add:Ring.maximal_ideal_ideal)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> I \\<noteq> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n     I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> vp K v = I", "apply (simp add:maximal_ideal_def,\n       frule conjunct2, fold maximal_ideal_def, frule conjunct1,\n       rule Ring.proper_ideal, assumption+,simp add:maximal_ideal_def, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n     I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> vp K v = I", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n     I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<subseteq> I\n 2. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n     I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> vp K v", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n     I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> vp K v\n 2. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n     I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<subseteq> I", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n     I \\<subseteq> vp K v\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<subseteq> I", "apply (rule contrapos_pp, simp+,\n        frule sets_not_eq[of \"vp K v\" I], assumption+, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n        I \\<subseteq> vp K v; vp K v \\<noteq> I; a \\<in> vp K v;\n        a \\<notin> I\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = a in vp_mem_Vr_mem[of v],\n frule Ring.maximal_ideal_ideal[of \"Vr K v\" \"I\"], assumption,\n frule_tac x = a in Ring.elem_out_ideal_nonzero[of \"Vr K v\" \"I\"],\n           assumption+,\n frule vp_ideal[of v], rule Ring.ideal_subset[of \"Vr K v\" \"vp K v\"],\n assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n        I \\<subseteq> vp K v; vp K v \\<noteq> I; a \\<in> vp K v;\n        a \\<notin> I; a \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = a in Ring.principal_ideal[of \"Vr K v\"], assumption+,\n       frule Ring.maximal_ideal_ideal[of \"Vr K v\" I], assumption+,\n       frule_tac ?I2.0 = \"Vr K v \\<diamondsuit>\\<^sub>p a\"in Ring.sum_ideals[of \"Vr K v\" \"I\"],\n        simp add:Ring.maximal_ideal_ideal, assumption,\n   frule_tac ?I2.0 = \"Vr K v \\<diamondsuit>\\<^sub>p a\"in Ring.sum_ideals_la1[of \"Vr K v\" \"I\"],\n      assumption+,\n   frule_tac ?I2.0 = \"Vr K v \\<diamondsuit>\\<^sub>p a\"in Ring.sum_ideals_la2[of \"Vr K v\" \"I\"],\n      assumption+,\n   frule_tac a = a in Ring.a_in_principal[of \"Vr K v\"], assumption+,\n   frule_tac A = \"Vr K v \\<diamondsuit>\\<^sub>p a\" and B = \"I \\<minusplus>\\<^bsub>(Vr K v)\\<^esub> (Vr K v \\<diamondsuit>\\<^sub>p a)\"\n       and c = a in subsetD, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n        I \\<subseteq> vp K v; vp K v \\<noteq> I; a \\<in> vp K v;\n        a \\<notin> I; a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> False", "thm Ring.sum_ideals_cont[of \"Vr K v\" \"vp K v\" I ]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n        I \\<subseteq> vp K v; vp K v \\<noteq> I; a \\<in> vp K v;\n        a \\<notin> I; a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac B = \"Vr K v \\<diamondsuit>\\<^sub>p a\" in Ring.sum_ideals_cont[of \"Vr K v\"\n       \"vp K v\" I], simp add:vp_ideal, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n        I \\<subseteq> vp K v; vp K v \\<noteq> I; a \\<in> vp K v;\n        a \\<notin> I; a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p a \\<subseteq> vp K v\n 2. \\<And>a.\n       \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n        I \\<subseteq> vp K v; vp K v \\<noteq> I; a \\<in> vp K v;\n        a \\<notin> I; a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> vp K v\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = a in Ring.ideal_cont_Rxa[of \"Vr K v\" \"vp K v\"],\n        simp add:vp_ideal, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; maximal_ideal (Vr K v) I; Ring (Vr K v);\n        I \\<subseteq> vp K v; vp K v \\<noteq> I; a \\<in> vp K v;\n        a \\<notin> I; a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> vp K v\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:maximal_ideal_def, (erule conjE)+,\n      subgoal_tac \"I \\<minusplus>\\<^bsub>(Vr K v)\\<^esub> (Vr K v \\<diamondsuit>\\<^sub>p a) \\<in> {J. ideal (Vr K v) J \\<and> I \\<subseteq> J}\",\n      simp, thin_tac \"{J. ideal (Vr K v) J \\<and> I \\<subseteq> J} = {I, carrier (Vr K v)}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; Ring (Vr K v); I \\<subseteq> vp K v;\n        vp K v \\<noteq> I; a \\<in> vp K v; a \\<notin> I;\n        a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> vp K v;\n        1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n        Vr K v \\<diamondsuit>\\<^sub>p a =\n        I \\<or>\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n        Vr K v \\<diamondsuit>\\<^sub>p a =\n        carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>a.\n       \\<lbrakk>valuation K v; Ring (Vr K v); I \\<subseteq> vp K v;\n        vp K v \\<noteq> I; a \\<in> vp K v; a \\<notin> I;\n        a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> vp K v;\n        1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n        {J. ideal (Vr K v) J \\<and> I \\<subseteq> J} =\n        {I, carrier (Vr K v)}\\<rbrakk>\n       \\<Longrightarrow> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                         Vr K v \\<diamondsuit>\\<^sub>p a\n                         \\<in> {J. ideal (Vr K v) J \\<and> I \\<subseteq> J}", "apply (erule disjE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; Ring (Vr K v); I \\<subseteq> vp K v;\n        vp K v \\<noteq> I; a \\<in> vp K v; a \\<notin> I;\n        a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> vp K v;\n        1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n        Vr K v \\<diamondsuit>\\<^sub>p a =\n        carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>a.\n       \\<lbrakk>valuation K v; Ring (Vr K v); I \\<subseteq> vp K v;\n        vp K v \\<noteq> I; a \\<in> vp K v; a \\<notin> I;\n        a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> vp K v;\n        1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n        {J. ideal (Vr K v) J \\<and> I \\<subseteq> J} =\n        {I, carrier (Vr K v)}\\<rbrakk>\n       \\<Longrightarrow> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                         Vr K v \\<diamondsuit>\\<^sub>p a\n                         \\<in> {J. ideal (Vr K v) J \\<and> I \\<subseteq> J}", "apply (cut_tac A = \"carrier (Vr K v)\" and B = \"I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\" and\n        C = \"vp K v\" in subset_trans, simp, assumption,\n        frule Ring.ideal_subset1[of \"Vr K v\" \"vp K v\"], simp add:vp_ideal,\n        frule equalityI[of \"vp K v\" \"carrier (Vr K v)\"], assumption+,\n        frule vp_not_whole[of v], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; Ring (Vr K v); I \\<subseteq> vp K v;\n        vp K v \\<noteq> I; a \\<in> vp K v; a \\<notin> I;\n        a \\<in> carrier (Vr K v);\n        ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p a); ideal (Vr K v) I;\n        ideal (Vr K v)\n         (I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n          Vr K v \\<diamondsuit>\\<^sub>p a);\n        I \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                      Vr K v \\<diamondsuit>\\<^sub>p a;\n        Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                    Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> Vr K v \\<diamondsuit>\\<^sub>p a;\n        a \\<in> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                Vr K v \\<diamondsuit>\\<^sub>p a;\n        I \\<minusplus>\\<^bsub>Vr K v\\<^esub> Vr K v \\<diamondsuit>\\<^sub>p a\n        \\<subseteq> vp K v;\n        1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n        {J. ideal (Vr K v) J \\<and> I \\<subseteq> J} =\n        {I, carrier (Vr K v)}\\<rbrakk>\n       \\<Longrightarrow> I \\<minusplus>\\<^bsub>Vr K v\\<^esub>\n                         Vr K v \\<diamondsuit>\\<^sub>p a\n                         \\<in> {J. ideal (Vr K v) J \\<and> I \\<subseteq> J}", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) v_residue_field:\"valuation K v \\<Longrightarrow>\n                                Corps ((Vr K v)  /\\<^sub>r (vp K v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> Corps (Vr K v /\\<^sub>r vp K v)", "by (frule Vr_ring[of v],\n       rule Ring.residue_field_cd [of \"Vr K v\" \"vp K v\"], assumption+,\n       simp add:vp_maximal)"], ["", "lemma (in Corps) Vr_n_val_Vr:\"valuation K v \\<Longrightarrow>\n     carrier (Vr K v) = carrier (Vr K (n_val K v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    carrier (Vr K v) = carrier (Vr K (n_val K v))", "by (simp add:Vr_def Sr_def,\n       rule equalityI,\n      (rule subsetI, simp, erule conjE, simp add:val_pos_n_val_pos),\n      (rule subsetI, simp, erule conjE, simp add:val_pos_n_val_pos[THEN sym]))"], ["", "section \"Ideals in a valuation ring\""], ["", "lemma (in Corps) Vr_has_poss_elem:\"valuation K v \\<Longrightarrow>\n                 \\<exists>x\\<in>carrier (Vr K v) - {\\<zero>\\<^bsub>Vr K v\\<^esub>}. 0 < v x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<exists>x\\<in>carrier (Vr K v) - {\\<zero>\\<^bsub>Vr K v\\<^esub>}.\n       0 < v x", "apply (frule val_Pg[of v], erule conjE,\n       frule Lv_pos[of v], drule sym,\n       subst Vr_0_f_0, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Pg K v \\<in> carrier K - {\\<zero>}; 0 < Lv K v;\n     Lv K v = v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier (Vr K v) - {\\<zero>}. 0 < v x", "apply (frule aeq_ale[of \"Lv K v\" \"v (Pg K v)\"],\n       frule aless_le_trans[of \"0\" \"Lv K v\" \"v (Pg K v)\"], assumption+,\n       frule val_poss_mem_Vr[of v \"Pg K v\"],\n       simp, assumption, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vp_nonzero:\"valuation K v \\<Longrightarrow>  vp K v \\<noteq>  {\\<zero>\\<^bsub>Vr K v\\<^esub>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    vp K v \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}", "apply (frule Vr_has_poss_elem[of v], erule bexE,\n       simp, erule conjE,\n       frule_tac x1 = x in vp_mem_val_poss[THEN sym, of v],\n       simp add:Vr_mem_f_mem, simp, rule contrapos_pp, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_frac_mul:\"\\<lbrakk>x \\<in> carrier K; y \\<in> carrier K; y \\<noteq> \\<zero>\\<rbrakk>\n        \\<Longrightarrow>   x = (x \\<cdot>\\<^sub>r  (y\\<^bsup>\\<hyphen>K\\<^esup>)) \\<cdot>\\<^sub>r y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; y \\<in> carrier K;\n     y \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x =\n                      x \\<cdot>\\<^sub>r\n                      y\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                      y", "apply (cut_tac invf_closed[of y],\n       cut_tac field_is_ring,\n       simp add:Ring.ring_tOp_assoc,\n       subst linvf[of y], simp, simp add:Ring.ring_r_one[of K], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) elems_le_val:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n       x \\<noteq> \\<zero>; v x \\<le> (v y)\\<rbrakk>  \\<Longrightarrow> \\<exists>r\\<in>carrier (Vr K v). y = r \\<cdot>\\<^sub>r x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     x \\<noteq> \\<zero>; v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier (Vr K v).\n                         y = r \\<cdot>\\<^sub>r x", "apply (frule ale_diff_pos[of \"v x\" \"v y\"], simp add:diff_ant_def,\n       simp add:value_of_inv[THEN sym, of v x],\n       cut_tac invf_closed[of \"x\"],\n       simp only:val_t2p[THEN sym, of v y \"x\\<^bsup>\\<hyphen>K\\<^esup>\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     x \\<noteq> \\<zero>; v x \\<le> v y;\n     0 \\<le> v (y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier (Vr K v).\n                         y = r \\<cdot>\\<^sub>r x\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     x \\<noteq> \\<zero>; v x \\<le> v y;\n     0 \\<le> v y + v (x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (cut_tac field_is_ring,\n       frule_tac x = y and y = \"x\\<^bsup>\\<hyphen>K\\<^esup>\" in Ring.ring_tOp_closed[of \"K\"],\n       assumption+,\n       simp add:val_pos_mem_Vr[of v \"y \\<cdot>\\<^sub>r (x\\<^bsup>\\<hyphen>K\\<^esup>)\"],\n       frule field_frac_mul[of y x], assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     x \\<noteq> \\<zero>; v x \\<le> v y;\n     0 \\<le> v y + v (x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_Rxa_gt_a:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v) - {\\<zero>};\n y \\<in> carrier (Vr K v);  y \\<in> Rxa (Vr K v) x\\<rbrakk> \\<Longrightarrow> v x \\<le> (v y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v) - {\\<zero>};\n     y \\<in> carrier (Vr K v);\n     y \\<in> Vr K v \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> v x \\<le> v y", "apply (simp add:Rxa_def,\n       erule bexE,\n       simp add:Vr_tOp_f_tOp, (erule conjE)+,\n        frule_tac x = r in Vr_mem_f_mem[of v], assumption+,\n        frule_tac x = x in Vr_mem_f_mem[of v], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>valuation K v; r \\<cdot>\\<^sub>r x \\<in> carrier (Vr K v);\n        r \\<in> carrier (Vr K v); y = r \\<cdot>\\<^sub>r x;\n        x \\<in> carrier (Vr K v); x \\<noteq> \\<zero>; r \\<in> carrier K;\n        x \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> v x \\<le> v (r \\<cdot>\\<^sub>r x)", "apply (subst val_t2p, assumption+,\n       simp add:val_pos_mem_Vr[THEN sym, of v],\n       frule_tac y = \"v r\" in aadd_le_mono[of \"0\" _ \"v x\"],\n       simp add:aadd_0_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_Rxa_gt_a_1:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\ny \\<in> carrier (Vr K v); x \\<noteq> \\<zero>; v x \\<le> (v y)\\<rbrakk> \\<Longrightarrow> y \\<in> Rxa (Vr K v) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v); x \\<noteq> \\<zero>; v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> y \\<in> Vr K v \\<diamondsuit>\\<^sub>p x", "apply (frule_tac x = x in Vr_mem_f_mem[of v], assumption+,\n       frule_tac x = y in Vr_mem_f_mem[of v], assumption+,\n       frule v_ale_diff[of v x y], assumption+,\n       cut_tac invf_closed[of x],\n       cut_tac field_is_ring, frule Ring.ring_tOp_closed[of K y \"x\\<^bsup>\\<hyphen>K\\<^esup>\"],\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v); x \\<noteq> \\<zero>; v x \\<le> v y;\n     x \\<in> carrier K; y \\<in> carrier K;\n     0 \\<le> v (y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K; Ring K;\n     y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> y \\<in> Vr K v \\<diamondsuit>\\<^sub>p x\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v); x \\<noteq> \\<zero>; v x \\<le> v y;\n     x \\<in> carrier K; y \\<in> carrier K;\n     0 \\<le> v (y \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:val_pos_mem_Vr[of \"v\" \"y \\<cdot>\\<^sub>r (x\\<^bsup>\\<hyphen>K\\<^esup>)\"],\n       frule field_frac_mul[of \"y\" \"x\"], assumption+,\n       simp add:Rxa_def, simp add:Vr_tOp_f_tOp, blast, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) eqval_inv:\"\\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n       y \\<noteq> \\<zero>; v x = v y\\<rbrakk> \\<Longrightarrow>  0 = v (x \\<cdot>\\<^sub>r (y\\<^bsup>\\<hyphen>K\\<^esup>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; y \\<in> carrier K;\n     y \\<noteq> \\<zero>; v x = v y\\<rbrakk>\n    \\<Longrightarrow> 0 = v (x \\<cdot>\\<^sub>r y\\<^bsup>\\<hyphen> K\\<^esup>)", "by (cut_tac invf_closed[of y],\n       simp add:val_t2p value_of_inv, simp add:aadd_minus_r,\n       simp)"], ["", "lemma (in Corps) eq_val_eq_idealTr:\"\\<lbrakk>valuation K v;\n      x \\<in> carrier (Vr K v) - {\\<zero>}; y \\<in> carrier  (Vr K v); v x \\<le> (v y)\\<rbrakk> \\<Longrightarrow>\n                       Rxa (Vr K v) y \\<subseteq>  Rxa (Vr K v) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v) - {\\<zero>};\n     y \\<in> carrier (Vr K v); v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p y\n                      \\<subseteq> Vr K v \\<diamondsuit>\\<^sub>p x", "apply (frule val_Rxa_gt_a_1[of v x y], simp+,\n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; y \\<in> carrier (Vr K v); v x \\<le> v y;\n     y \\<in> Vr K v \\<diamondsuit>\\<^sub>p x; x \\<in> carrier (Vr K v);\n     x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p y\n                      \\<subseteq> Vr K v \\<diamondsuit>\\<^sub>p x", "apply (frule_tac x = x in Vr_mem_f_mem[of v], assumption+,\n       frule Vr_ring[of v],\n       frule Ring.principal_ideal[of \"Vr K v\" \"x\"], assumption,\n       frule Ring.ideal_cont_Rxa[of \"Vr K v\" \"(Vr K v) \\<diamondsuit>\\<^sub>p x\" \"y\"],\n  assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) eq_val_eq_ideal:\"\\<lbrakk>valuation K v;\n      x \\<in> carrier (Vr K v); y \\<in> carrier  (Vr K v); v x = v y\\<rbrakk>\n       \\<Longrightarrow> Rxa (Vr K v) x = Rxa (Vr K v) y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v); v x = v y\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x =\n                      Vr K v \\<diamondsuit>\\<^sub>p y", "apply (case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\",\n       simp add:value_of_zero,\n       frule value_inf_zero[of v y],\n       simp add:Vr_mem_f_mem, rule sym, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v); v x = v y; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x =\n                      Vr K v \\<diamondsuit>\\<^sub>p y", "apply (rule equalityI,\n       rule eq_val_eq_idealTr[of v y x], assumption+,\n       drule sym, simp,\n       rule contrapos_pp, simp+, simp add:value_of_zero,\n       frule Vr_mem_f_mem[of v x], assumption+,\n       frule value_inf_zero[of v x], assumption+,\n       rule sym, assumption, simp, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v); v x = v y; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p y\n                      \\<subseteq> Vr K v \\<diamondsuit>\\<^sub>p x", "apply (rule eq_val_eq_idealTr[of v x y], assumption+, simp,\n       assumption, rule aeq_ale, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) eq_ideal_eq_val:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\ny \\<in> carrier (Vr K v); Rxa (Vr K v) x = Rxa (Vr K v) y\\<rbrakk>  \\<Longrightarrow> v x = v y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p x =\n     Vr K v \\<diamondsuit>\\<^sub>p y\\<rbrakk>\n    \\<Longrightarrow> v x = v y", "apply (case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\", simp,\n       drule sym,\n       frule Vr_ring[of v],\n       frule Ring.a_in_principal[of \"Vr K v\" y], assumption+, simp,\n       thin_tac \"Vr K v \\<diamondsuit>\\<^sub>p y = Vr K v \\<diamondsuit>\\<^sub>p (\\<zero>)\", simp add:Rxa_def,\n       erule bexE, simp add:Vr_0_f_0[of v, THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>valuation K v;\n        \\<zero>\\<^bsub>Vr K v\\<^esub> \\<in> carrier (Vr K v);\n        r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n        \\<zero>\\<^bsub>Vr K v\\<^esub>\n        \\<in> carrier (Vr K v);\n        x = \\<zero>\\<^bsub>Vr K v\\<^esub>; Ring (Vr K v);\n        r \\<in> carrier (Vr K v);\n        y =\n        r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n        \\<zero>\\<^bsub>Vr K v\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> v \\<zero>\\<^bsub>Vr K v\\<^esub> =\n                         v (r \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n                            \\<zero>\\<^bsub>Vr K v\\<^esub>)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p x = Vr K v \\<diamondsuit>\\<^sub>p y;\n     x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> v x = v y", "apply (simp add:Vr_tOp_f_tOp, simp add:Vr_0_f_0,\n       frule_tac x = r in Vr_mem_f_mem[of v], assumption+,\n       cut_tac field_is_ring, simp add:Ring.ring_times_x_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p x = Vr K v \\<diamondsuit>\\<^sub>p y;\n     x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> v x = v y", "apply (frule Vr_ring[of v],\n       frule val_Rxa_gt_a[of v x y], simp,\n       simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p x = Vr K v \\<diamondsuit>\\<^sub>p y;\n     x \\<noteq> \\<zero>; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> y \\<in> Vr K v \\<diamondsuit>\\<^sub>p x\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p x = Vr K v \\<diamondsuit>\\<^sub>p y;\n     x \\<noteq> \\<zero>; Ring (Vr K v); v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> v x = v y", "apply (drule sym,\n       frule Ring.a_in_principal[of \"Vr K v\" \"y\"], simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     y \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p x = Vr K v \\<diamondsuit>\\<^sub>p y;\n     x \\<noteq> \\<zero>; Ring (Vr K v); v x \\<le> v y\\<rbrakk>\n    \\<Longrightarrow> v x = v y", "apply (frule val_Rxa_gt_a[of v y x],\n       simp, rule contrapos_pp, simp+,\n       frule Ring.a_in_principal[of \"Vr K v\" \"x\"], assumption+,\n       simp add:Rxa_def,\n       erule bexE, simp add:Vr_tOp_f_tOp, cut_tac field_is_ring,\n       frule_tac x = r in Vr_mem_f_mem[of v], assumption+,\n       simp add:Ring.ring_times_x_0, simp,\n       frule Ring.a_in_principal[of \"Vr K v\" \"x\"], assumption+, simp,\n       rule ale_antisym, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) zero_val_gen_whole:\n \"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>\n             (v x = 0) = (Rxa (Vr K v) x = carrier (Vr K v))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> (v x = 0) =\n                      (Vr K v \\<diamondsuit>\\<^sub>p x = carrier (Vr K v))", "apply (frule Vr_mem_f_mem[of v x], assumption,\n       frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); x \\<in> carrier K;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> (v x = 0) =\n                      (Vr K v \\<diamondsuit>\\<^sub>p x = carrier (Vr K v))", "apply (rule iffI,\n       frule Ring.principal_ideal[of \"Vr K v\" \"x\"], assumption+,\n       frule Ring.a_in_principal[of \"Vr K v\" \"x\"], assumption+,\n       rule ideal_inc_elem0val_whole[of v x \"Vr K v \\<diamondsuit>\\<^sub>p x\"], assumption+,\n       frule Ring.ring_one[of \"Vr K v\"],\n       frule eq_set_inc[of \"1\\<^sub>r\\<^bsub>(Vr K v)\\<^esub>\"\n              \"carrier (Vr K v)\" \"Vr K v \\<diamondsuit>\\<^sub>p x\"], drule sym, assumption,\n       thin_tac \"1\\<^sub>r\\<^bsub>(Vr K v)\\<^esub> \\<in> carrier (Vr K v)\",\n       thin_tac \"Vr K v \\<diamondsuit>\\<^sub>p x = carrier (Vr K v)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); x \\<in> carrier K;\n     Ring (Vr K v);\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (simp add:Rxa_def, erule bexE,\n       simp add:Vr_1_f_1, simp add:Vr_tOp_f_tOp,\n       frule value_of_one[of v], simp,\n       frule_tac x = r in Vr_mem_f_mem[of v], assumption+,\n       cut_tac field_is_ring, simp add:val_t2p,\n       simp add:val_pos_mem_Vr[THEN sym, of v],\n       rule contrapos_pp, simp+,\n       cut_tac less_le[THEN sym, of \"0\" \"v x\"], drule not_sym, simp,\n       frule_tac x = \"v r\" and y = \"v x\" in aadd_pos_poss, assumption+,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) elem_nonzeroval_gen_proper:\"\\<lbrakk> valuation K v;\n      x \\<in> carrier (Vr K v); v x \\<noteq> 0\\<rbrakk> \\<Longrightarrow> Rxa (Vr K v) x \\<noteq> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     v x \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x \\<noteq>\n                      carrier (Vr K v)", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); v x \\<noteq> 0;\n     Vr K v \\<diamondsuit>\\<^sub>p x = carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add: zero_val_gen_whole[THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>We prove that Vr K v is a principal ideal ring\\<close>"], ["", "definition\n  LI :: \"[('r, 'm) Ring_scheme, 'r \\<Rightarrow> ant, 'r set] \\<Rightarrow> ant\" where\n         (** The least nonzero value of I **)\n \"LI K v I = AMin (v ` I)\""], ["", "definition\n  Ig :: \"[('r, 'm) Ring_scheme, 'r \\<Rightarrow> ant, 'r set] \\<Rightarrow> 'r\" where\n                                          (** Generator of I **)\n  \"Ig K v I = (SOME x. x \\<in> I \\<and> v x = LI K v I)\""], ["", "lemma (in Corps) val_in_image:\"\\<lbrakk>valuation K v; ideal (Vr K v) I; x \\<in> I\\<rbrakk> \\<Longrightarrow>\n                            v x \\<in> v ` I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> v x \\<in> v ` I", "by (simp add:image_def, blast)"], ["", "lemma (in Corps) I_vals_nonempty:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                           v ` I \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> v ` I \\<noteq> {}", "by (frule Vr_ring[of v],\n    frule Ring.ideal_zero[of \"Vr K v\" \"I\"],\n    assumption+, rule contrapos_pp, simp+)"], ["", "lemma (in Corps) I_vals_LBset:\"\\<lbrakk> valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                                          v ` I  \\<subseteq> LBset 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> v ` I \\<subseteq> LBset 0", "apply (frule Vr_ring[of v],\n       rule subsetI, simp add:LBset_def, simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n        \\<exists>xa\\<in>I. x = v xa\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> x", "apply (erule bexE,\n       frule_tac h = xa in Ring.ideal_subset[of \"Vr K v\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v); xa \\<in> I;\n        x = v xa; xa \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> x", "apply (frule_tac x1 = xa in val_pos_mem_Vr[THEN sym, of v],\n       simp add:Vr_mem_f_mem, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) LI_pos:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow> 0 \\<le> LI K v I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> LI K v I", "apply (simp add:LI_def,\n       frule I_vals_LBset[of v],\n       simp add:ant_0[THEN sym],\n       frule I_vals_nonempty[of v], simp only:ant_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; v ` I \\<subseteq> LBset 0;\n     v ` I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> AMin (v ` I)", "apply (simp only:ant_0[THEN sym], frule AMin[of \"v ` I\" \"0\"], assumption,\n       erule conjE, frule subsetD[of \"v ` I\" \"LBset (ant 0)\" \"AMin (v ` I)\"],\n       assumption+, simp add:LBset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) LI_poss:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n                 I \\<noteq> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow> 0 < LI K v I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I;\n     I \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> 0 < LI K v I", "apply (subst less_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I;\n     I \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> LI K v I \\<and> 0 \\<noteq> LI K v I", "apply (simp add:LI_pos)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I;\n     I \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> LI K v I \\<noteq> 0", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     LI K v I = 0\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:LI_def,\n       frule I_vals_LBset[of v], assumption+,\n       simp add:ant_0[THEN sym],\n       frule I_vals_nonempty[of v], assumption+, simp only:ant_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     AMin (v ` I) = 0; v ` I \\<subseteq> LBset 0; v ` I \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp only:ant_0[THEN sym], frule AMin[of \"v ` I\" \"0\"], assumption,\n       erule conjE, frule subsetD[of \"v ` I\" \"LBset (ant 0)\" \"AMin (v ` I)\"],\n       assumption+, simp add:LBset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     AMin (v ` I) = ant 0; v ` I \\<subseteq> {x. ant 0 \\<le> x};\n     I \\<noteq> {}; ant 0 \\<in> v ` I;\n     \\<forall>x\\<in>I. ant 0 \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> False", "apply (thin_tac \"\\<forall>x\\<in>I. ant 0 \\<le> v x\",\n       thin_tac \"v ` I \\<subseteq> {x. ant 0 \\<le> x}\", simp add:image_def,\n       erule bexE, simp add:ant_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I;\n        I \\<noteq> carrier (Vr K v);\n        AMin {y. \\<exists>x\\<in>I. y = v x} = 0; I \\<noteq> {}; x \\<in> I;\n        v x = 0\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule Vr_ring[of v],\n       frule_tac h = x in Ring.ideal_subset[of \"Vr K v\" \"I\"], assumption+,\n       frule_tac x = x in zero_val_gen_whole[of v], assumption+,\n       simp,\n       frule_tac a = x in Ring.ideal_cont_Rxa[of \"Vr K v\" \"I\"], assumption+,\n       simp, frule Ring.ideal_subset1[of \"Vr K v\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I;\n        I \\<noteq> carrier (Vr K v);\n        AMin {y. \\<exists>x\\<in>I. y = v x} = 0; I \\<noteq> {}; x \\<in> I;\n        Vr K v \\<diamondsuit>\\<^sub>p x = carrier (Vr K v); Ring (Vr K v);\n        x \\<in> carrier (Vr K v); v x = 0; carrier (Vr K v) \\<subseteq> I;\n        I \\<subseteq> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule equalityI[of \"I\" \"carrier (Vr K v)\"], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) LI_z:\"\\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk> \\<Longrightarrow>\n                 \\<exists>z. LI K v I = ant z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>z. LI K v I = ant z", "apply (frule Vr_ring[of v],\n       frule Ring.ideal_zero[of \"Vr K v\" \"I\"], assumption+,\n       cut_tac mem_ant[of \"LI K v I\"],\n       frule LI_pos[of v I], assumption,\n       erule disjE, simp,\n       cut_tac minf_le_any[of \"0\"],\n       frule ale_antisym[of \"0\" \"-\\<infinity>\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     \\<zero>\\<^bsub>Vr K v\\<^esub> \\<in> I; 0 \\<le> LI K v I;\n     (\\<exists>z. LI K v I = ant z) \\<or> LI K v I = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>z. LI K v I = ant z", "apply (erule disjE, simp,\n       frule singleton_sub[of \"\\<zero>\\<^bsub>Vr K v\\<^esub>\" \"I\"],\n       frule sets_not_eq[of \"I\" \"{\\<zero>\\<^bsub>Vr K v\\<^esub>}\"], assumption+,\n       erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I;\n        I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n        \\<zero>\\<^bsub>Vr K v\\<^esub> \\<in> I; LI K v I = \\<infinity>;\n        a \\<in> I; a \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. \\<infinity> = ant z", "apply (simp add:LI_def,\n       frule I_vals_LBset[of v], assumption+,\n       simp only:ant_0[THEN sym],\n       frule I_vals_nonempty[of v], assumption+,\n       frule AMin[of \"v ` I\" \"0\"], assumption, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I;\n        I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n        \\<zero>\\<^bsub>Vr K v\\<^esub> \\<in> I; AMin (v ` I) = \\<infinity>;\n        a \\<in> I; a \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>;\n        v ` I \\<subseteq> LBset (ant 0); v ` I \\<noteq> {};\n        AMin (v ` I) \\<in> v ` I;\n        \\<forall>x\\<in>v ` I. AMin (v ` I) \\<le> x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z. \\<infinity> = ant z", "apply (frule_tac x = a in val_in_image[of v I], assumption+,\n       drule_tac x = \"v a\" in bspec, simp,\n       simp add:Vr_0_f_0,\n       frule_tac x = a in val_nonzero_z[of v],\n       simp add:Ring.ideal_subset Vr_mem_f_mem, assumption+,\n       erule exE, simp,\n       cut_tac x = \"ant z\" in inf_ge_any, frule_tac x = \"ant z\" in\n       ale_antisym[of _ \"\\<infinity>\"], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) LI_k:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                                \\<exists>k\\<in> I. LI K v I = v k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>k\\<in>I. LI K v I = v k", "by (simp add:LI_def,\n       frule I_vals_LBset[of v], assumption+,\n       simp only:ant_0[THEN sym],\n       frule I_vals_nonempty[of v], assumption+,\n       frule AMin[of \"v ` I\" \"0\"], assumption, erule conjE,\n       thin_tac \"\\<forall>x\\<in>v ` I. AMin (v ` I) \\<le> x\", simp add:image_def)"], ["", "lemma (in Corps) LI_infinity:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n             (LI K v I = \\<infinity>)  = (I = {\\<zero>\\<^bsub>Vr K v\\<^esub>})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> (LI K v I = \\<infinity>) =\n                      (I = {\\<zero>\\<^bsub>Vr K v\\<^esub>})", "apply (frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> (LI K v I = \\<infinity>) =\n                      (I = {\\<zero>\\<^bsub>Vr K v\\<^esub>})", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     LI K v I = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> I = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     I = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> LI K v I = \\<infinity>", "apply (rule contrapos_pp, simp+,\n       frule Ring.ideal_zero[of \"Vr K v\" \"I\"], assumption+,\n       frule singleton_sub[of \"\\<zero>\\<^bsub>Vr K v\\<^esub>\" \"I\"],\n       frule sets_not_eq[of \"I\" \"{\\<zero>\\<^bsub>Vr K v\\<^esub>}\"], assumption+,\n       erule bexE,\n       frule_tac h = a in Ring.ideal_subset[of \"Vr K v\" \"I\"], assumption+,\n       simp add:Vr_0_f_0,\n       frule_tac x = a in Vr_mem_f_mem[of v], assumption+,\n       frule_tac x = a in val_nonzero_z[of v], assumption+,\n       erule exE,\n       simp add:LI_def,\n       frule I_vals_LBset[of v], assumption+,\n       simp only:ant_0[THEN sym],\n       frule I_vals_nonempty[of v], assumption+,\n       frule AMin[of \"v ` I\" \"0\"], assumption, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a z.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n        AMin (v ` I) = \\<infinity>; I \\<noteq> {\\<zero>}; \\<zero> \\<in> I;\n        a \\<in> I; a \\<noteq> \\<zero>; a \\<in> carrier (Vr K v);\n        a \\<in> carrier K; v a = ant z; v ` I \\<subseteq> LBset (ant 0);\n        v ` I \\<noteq> {}; AMin (v ` I) \\<in> v ` I;\n        \\<forall>x\\<in>v ` I. AMin (v ` I) \\<le> x\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     I = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> LI K v I = \\<infinity>", "apply (frule_tac h = a in Ring.ideal_subset[of \"Vr K v\" \"I\"], assumption+,\n       frule_tac x = a in val_in_image[of v I], assumption+,\n       drule_tac x = \"v a\" in bspec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a z.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n        AMin (v ` I) = \\<infinity>; I \\<noteq> {\\<zero>}; \\<zero> \\<in> I;\n        a \\<in> I; a \\<noteq> \\<zero>; a \\<in> carrier (Vr K v);\n        a \\<in> carrier K; v a = ant z; v ` I \\<subseteq> LBset (ant 0);\n        v ` I \\<noteq> {}; AMin (v ` I) \\<in> v ` I;\n        a \\<in> carrier (Vr K v); v a \\<in> v ` I;\n        AMin (v ` I) \\<le> v a\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     I = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> LI K v I = \\<infinity>", "apply (frule_tac x = a in val_nonzero_z[of v], assumption+,\n       erule exE, simp,\n       cut_tac x = \"ant z\" in inf_ge_any, frule_tac x = \"ant z\" in\n       ale_antisym[of _ \"\\<infinity>\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     I = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> LI K v I = \\<infinity>", "apply (frule sym, thin_tac \"I = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\",\n       simp add:LI_def,\n       frule I_vals_LBset[of v], assumption+,\n       simp only:ant_0[THEN sym],\n       frule I_vals_nonempty[of v], assumption+,\n       frule AMin[of \"v ` I\" \"0\"], assumption, erule conjE,\n       drule sym, simp,\n       simp add:Vr_0_f_0 value_of_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_Ig:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                           (Ig K v I) \\<in> I \\<and> v (Ig K v I) = LI K v I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> Ig K v I \\<in> I \\<and> v (Ig K v I) = LI K v I", "by (simp add:Ig_def, rule someI2_ex,\n    frule LI_k[of v I], assumption+, erule bexE,\n    drule sym, blast, assumption)"], ["", "lemma (in Corps) Ig_nonzero:\"\\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n                  \\<Longrightarrow> (Ig K v I) \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> Ig K v I \\<noteq> \\<zero>", "by (rule contrapos_pp, simp+,\n    frule LI_infinity[of v I], assumption+,\n    frule val_Ig[of v I], assumption+, erule conjE,\n    simp add:value_of_zero)"], ["", "lemma (in Corps) Vr_ideal_npowf_closed:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n       x \\<in> I; 0 < n\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup> \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; x \\<in> I; 0 < n\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup> \\<in> I", "by (simp add:npowf_def, frule Vr_ring[of v],\n      frule Ring.ideal_npow_closed[of \"Vr K v\" \"I\" \"x\" \"nat n\"], assumption+,\n      simp, frule Ring.ideal_subset[of \"Vr K v\" \"I\" \"x\"], assumption+,\n      simp add:Vr_exp_f_exp)"], ["", "lemma (in Corps) Ig_generate_I:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p (Ig K v I) = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I", "apply (frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I", "apply (case_tac \"I = carrier (Vr K v)\",\n   frule sym, thin_tac \"I = carrier (Vr K v)\",\n   frule Ring.ring_one[of \"Vr K v\"],\n   simp, simp add: Vr_1_f_1,\n   frule val_Ig[of v I], assumption+, erule conjE,\n   frule LI_pos[of v I], assumption+,\n\n   simp add: LI_def cong del: image_cong_simp,\n   frule I_vals_LBset[of v], assumption+,\n   simp only: ant_0[THEN sym],\n   frule I_vals_nonempty[of v], assumption+,\n   frule AMin[of \"v ` I\" \"0\"], assumption, erule conjE,\n\n   frule val_in_image[of v I \"1\\<^sub>r\"], assumption+,\n   drule_tac x = \"v (1\\<^sub>r)\" in bspec, assumption+,\n   simp add: value_of_one ant_0 cong del: image_cong_simp,\n   simp add: zero_val_gen_whole[of v \"Ig K v I\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I", "apply (frule val_Ig[of v I], assumption+, (erule conjE)+,\n       frule Ring.ideal_cont_Rxa[of \"Vr K v\" \"I\" \"Ig K v I\"], assumption+,\n       rule equalityI, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); Ig K v I \\<in> I; v (Ig K v I) = LI K v I;\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I", "apply (case_tac \"LI K v I = \\<infinity>\",\n       frule LI_infinity[of v I], simp,\n       simp add:Rxa_def, simp add:Ring.ring_times_x_0,\n       frule Ring.ring_zero, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); Ig K v I \\<in> I; v (Ig K v I) = LI K v I;\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I \\<subseteq> I;\n     LI K v I \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I", "apply (rule subsetI,\n       case_tac \"v x = 0\",\n       frule_tac x = x in Vr_mem_f_mem[of v],\n       simp add:Ring.ideal_subset,\n       frule_tac x = x in zero_val_gen_whole[of v],\n       simp add:Ring.ideal_subset, simp,\n       frule_tac a = x in Ring.ideal_cont_Rxa[of \"Vr K v\" \"I\"], assumption+,\n       simp, frule Ring.ideal_subset1[of \"Vr K v\" \"I\"], assumption,\n       frule equalityI[of \"I\" \"carrier (Vr K v)\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n        I \\<noteq> carrier (Vr K v); Ig K v I \\<in> I;\n        v (Ig K v I) = LI K v I;\n        Vr K v \\<diamondsuit>\\<^sub>p Ig K v I \\<subseteq> I;\n        LI K v I \\<noteq> \\<infinity>; x \\<in> I; v x \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I", "apply (simp add:LI_def,\n       frule I_vals_LBset[of v], assumption+,\n       simp only:ant_0[THEN sym],\n       frule I_vals_nonempty[of v], assumption+,\n       frule AMin[of \"v ` I\" \"0\"], assumption, erule conjE,\n       frule_tac x = \"v x\" in bspec,\n       frule_tac x = x in val_in_image[of v I], assumption+,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n        I \\<noteq> carrier (Vr K v); Ig K v I \\<in> I;\n        v (Ig K v I) = AMin (v ` I);\n        Vr K v \\<diamondsuit>\\<^sub>p Ig K v I \\<subseteq> I;\n        AMin (v ` I) \\<noteq> \\<infinity>; x \\<in> I; v x \\<noteq> ant 0;\n        v ` I \\<subseteq> LBset (ant 0); I \\<noteq> {};\n        AMin (v ` I) \\<in> v ` I;\n        \\<forall>x\\<in>I. AMin (v ` I) \\<le> v x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I", "apply (drule_tac x =  x in bspec, assumption,\n       frule_tac y = x in eq_val_eq_idealTr[of v \"Ig K v I\"],\n           simp add:Ring.ideal_subset,\n       rule contrapos_pp, simp+, simp add:value_of_zero,\n       simp add:Ring.ideal_subset, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n        I \\<noteq> carrier (Vr K v); Ig K v I \\<in> I;\n        v (Ig K v I) = AMin (v ` I);\n        Vr K v \\<diamondsuit>\\<^sub>p Ig K v I \\<subseteq> I;\n        AMin (v ` I) \\<noteq> \\<infinity>; x \\<in> I; v x \\<noteq> ant 0;\n        v ` I \\<subseteq> LBset (ant 0); I \\<noteq> {};\n        AMin (v ` I) \\<in> v ` I; AMin (v ` I) \\<le> v x;\n        Vr K v \\<diamondsuit>\\<^sub>p x\n        \\<subseteq> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> Vr K v \\<diamondsuit>\\<^sub>p Ig K v I", "apply (frule_tac a = x in Ring.a_in_principal[of \"Vr K v\"],\n       simp add:Ring.ideal_subset, rule subsetD, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Pg_gen_vp:\"valuation K v  \\<Longrightarrow>\n                          (Vr K v) \\<diamondsuit>\\<^sub>p (Pg K v) = vp K v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    Vr K v \\<diamondsuit>\\<^sub>p Pg K v = vp K v", "apply (frule vp_ideal[of v],\n       frule Ig_generate_I[of v \"vp K v\"], assumption+,\n       frule vp_not_whole[of v],\n       frule eq_val_eq_ideal[of v \"Ig K v (vp K v)\" \"Pg K v\"],\n       frule val_Ig [of v \"vp K v\"], assumption+, erule conjE,\n       simp add:vp_mem_Vr_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v;\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> Pg K v \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v;\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> v (Ig K v (vp K v)) = v (Pg K v)\n 3. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v;\n     vp K v \\<noteq> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) =\n     Vr K v \\<diamondsuit>\\<^sub>p Pg K v\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Pg K v = vp K v", "apply (frule val_Pg[of v], erule conjE,\n       frule Lv_pos[of v],\n       rotate_tac -2, drule sym, simp,\n       simp add:val_poss_mem_Vr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v;\n     vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> v (Ig K v (vp K v)) = v (Pg K v)\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v;\n     vp K v \\<noteq> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) =\n     Vr K v \\<diamondsuit>\\<^sub>p Pg K v\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Pg K v = vp K v", "apply (thin_tac \"Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v\",\n       frule val_Pg[of v], erule conjE,\n       simp, frule val_Ig[of v \"vp K v\"], assumption+, erule conjE,\n       simp, thin_tac \"v (Pg K v) = Lv K v\",\n       thin_tac \"Ig K v (vp K v) \\<in> vp K v \\<and> v (Ig K v (vp K v)) =\n        LI K v (vp K v)\", simp add:LI_def Lv_def,\n       subgoal_tac \"v ` vp K v = {x. x \\<in> v ` carrier K \\<and> 0 < x}\",\n       simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     vp K v \\<noteq> carrier (Vr K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> v ` vp K v = {x \\<in> v ` carrier K. 0 < x}\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v;\n     vp K v \\<noteq> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) =\n     Vr K v \\<diamondsuit>\\<^sub>p Pg K v\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Pg K v = vp K v", "apply (thin_tac \"ideal (Vr K v) (vp K v)\", thin_tac \"Pg K v \\<in> carrier K\",\n       thin_tac \"Pg K v \\<noteq> \\<zero>\",\n       rule equalityI, rule subsetI,\n       simp add:image_def vp_def, erule exE, erule conjE,\n       (erule conjE)+,\n       frule_tac x = xa in Vr_mem_f_mem[of v], assumption+, simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; vp K v \\<noteq> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> {x \\<in> v ` carrier K. 0 < x} \\<subseteq> v ` vp K v\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) (vp K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) = vp K v;\n     vp K v \\<noteq> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v (vp K v) =\n     Vr K v \\<diamondsuit>\\<^sub>p Pg K v\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Pg K v = vp K v", "apply (rule subsetI, simp add:image_def vp_def, erule conjE, erule bexE, simp,\n       frule_tac x = xa in val_poss_mem_Vr[of v], assumption+,\n       cut_tac y = \"v xa\" in less_le[of \"0\"], simp, blast, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vp_gen_t:\"valuation K v  \\<Longrightarrow>\n                \\<exists>t\\<in>carrier (Vr K v). vp K v = (Vr K v) \\<diamondsuit>\\<^sub>p t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    \\<exists>t\\<in>carrier (Vr K v).\n       vp K v = Vr K v \\<diamondsuit>\\<^sub>p t", "by (frule Pg_gen_vp[of v], frule Pg_in_Vr[of v], blast)"], ["", "lemma (in Corps) vp_gen_nonzero:\"\\<lbrakk>valuation K v; vp K v = (Vr K v) \\<diamondsuit>\\<^sub>p t\\<rbrakk> \\<Longrightarrow>\n                 t \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     vp K v = Vr K v \\<diamondsuit>\\<^sub>p t\\<rbrakk>\n    \\<Longrightarrow> t \\<noteq> \\<zero>\\<^bsub>Vr K v\\<^esub>", "apply (rule contrapos_pp, simp+,\n       cut_tac Ring.Rxa_zero[of \"Vr K v\"], drule sym, simp,\n       simp add:vp_nonzero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     vp K v = Vr K v \\<diamondsuit>\\<^sub>p \\<zero>\\<^bsub>Vr K v\\<^esub>;\n     t = \\<zero>\\<^bsub>Vr K v\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> Ring (Vr K v)", "apply (simp add:Vr_ring)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_value_idealTr:\"\\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n        (vp K v) \\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup> = Vr K v \\<diamondsuit>\\<^sub>p ((Pg K v)^\\<^bsup>(Vr K v) n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      Vr K v \\<diamondsuit>\\<^sub>p\n                      (Pg K v^\\<^bsup>Vr K v n\\<^esup>)", "apply (frule Vr_ring[of v],\n       frule Pg_gen_vp[THEN sym, of v],\n       simp add:vp_ideal,\n       frule val_Pg[of v], simp, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; Ring (Vr K v);\n     vp K v = Vr K v \\<diamondsuit>\\<^sub>p Pg K v; Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; v (Pg K v) = Lv K v\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p Pg K v\n                         \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      Vr K v \\<diamondsuit>\\<^sub>p\n                      (Pg K v^\\<^bsup>Vr K v n\\<^esup>)", "apply (subst Ring.principal_ideal_n_pow[of \"Vr K v\" \"Pg K v\"\n       \"Vr K v \\<diamondsuit>\\<^sub>p Pg K v\"], assumption+,\n       frule Lv_pos[of v], rotate_tac -2, frule sym,\n       thin_tac \"v (Pg K v) = Lv K v\", simp, simp add:val_poss_mem_Vr,\n       simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) ideal_pow_vp:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n                     I \\<noteq> carrier (Vr K v); I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>  \\<Longrightarrow>\n                     I = (vp K v)\\<^bsup>\\<diamondsuit> (Vr K v) (na (n_val K v (Ig K v I)))\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> I =\n                      vp K v\n                         \\<^bsup>\\<diamondsuit>Vr K\n          v na (n_val K v (Ig K v I))\\<^esup>", "apply (frule Vr_ring[of v],\n       frule Ig_generate_I[of v I], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I\\<rbrakk>\n    \\<Longrightarrow> I =\n                      vp K v\n                         \\<^bsup>\\<diamondsuit>Vr K\n          v na (n_val K v (Ig K v I))\\<^esup>", "apply (frule n_val[of v \"Ig K v I\"],\n       frule val_Ig[of v I], assumption+, erule conjE,\n       simp add:Ring.ideal_subset[of \"Vr K v\" \"I\" \"Ig K v I\"] Vr_mem_f_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * Lv K v = v (Ig K v I)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      vp K v\n                         \\<^bsup>\\<diamondsuit>Vr K\n          v na (n_val K v (Ig K v I))\\<^esup>", "apply (frule val_Pg[of v], erule conjE,\n       rotate_tac -1, drule sym, simp,\n       frule Ig_nonzero[of v I], assumption+,\n       frule LI_pos[of v I], assumption+,\n       frule Lv_pos[of v],\n       frule val_Ig[of v I], assumption+, (erule conjE)+,\n       rotate_tac -1, drule sym, simp,\n       frule val_pos_n_val_pos[of v \"Ig K v I\"],\n       simp add:Ring.ideal_subset Vr_mem_f_mem,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     Ig K v I \\<noteq> \\<zero>; 0 \\<le> n_val K v (Ig K v I);\n     0 < v (Pg K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Ig K v I \\<in> I; LI K v I = v (Ig K v I);\n     0 \\<le> v (Ig K v I)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      vp K v\n                         \\<^bsup>\\<diamondsuit>Vr K\n          v na (n_val K v (Ig K v I))\\<^esup>", "apply (frule zero_val_gen_whole[THEN sym, of v \"Ig K v I\"],\n       simp add:Ring.ideal_subset,\n       simp, rotate_tac -1, drule not_sym,\n       cut_tac less_le[THEN sym, of \"0\" \"v (Ig K v I)\"], simp,\n              thin_tac \"0 \\<le> v (Ig K v I)\",\n       frule Ring.ideal_subset[of \"Vr K v\" I \"Ig K v I\"], assumption+,\n       frule Vr_mem_f_mem[of v \"Ig K v I\"], assumption+,\n       frule val_poss_n_val_poss[of v \"Ig K v I\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     Ig K v I \\<noteq> \\<zero>; 0 \\<le> n_val K v (Ig K v I);\n     0 < v (Pg K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Ig K v I \\<in> I; LI K v I = v (Ig K v I); v (Ig K v I) \\<noteq> 0;\n     0 < n_val K v (Ig K v I); Ig K v I \\<in> carrier (Vr K v);\n     Ig K v I \\<in> carrier K; 0 < v (Ig K v I)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      vp K v\n                         \\<^bsup>\\<diamondsuit>Vr K\n          v na (n_val K v (Ig K v I))\\<^esup>", "apply (frule Ig_nonzero[of v I],\n       frule val_nonzero_noninf[of v \"Ig K v I\"], assumption+,\n       simp add:val_noninf_n_val_noninf[of v \"Ig K v I\"],\n       frule val_poss_mem_Vr[of v \"Pg K v\"], assumption+,\n       subst n_value_idealTr[of v \"na (n_val K v (Ig K v I))\"],\n          assumption+, simp add:na_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     0 \\<le> n_val K v (Ig K v I); 0 < v (Pg K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Ig K v I \\<in> I; LI K v I = v (Ig K v I);\n     v (Ig K v I) \\<noteq> 0; 0 < n_val K v (Ig K v I);\n     Ig K v I \\<in> carrier (Vr K v); Ig K v I \\<in> carrier K;\n     0 < v (Ig K v I); Ig K v I \\<noteq> \\<zero>;\n     Pg K v \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      Vr K v \\<diamondsuit>\\<^sub>p\n                      (Pg K\n                        v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)", "apply (frule eq_val_eq_ideal[of v \"Ig K v I\"\n               \"(Pg K v)^\\<^bsup>(Vr K v) (na (n_val K v (Ig K v I)))\\<^esup>\"], assumption+,\n       rule Ring.npClose, assumption+,\n       simp add:Vr_exp_f_exp[of v \"Pg K v\"],\n       subst val_exp_ring[THEN sym, of v \"Pg K v\"\n                          \"na (n_val K v (Ig K v I))\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     0 \\<le> n_val K v (Ig K v I); 0 < v (Pg K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Ig K v I \\<in> I; LI K v I = v (Ig K v I);\n     v (Ig K v I) \\<noteq> 0; 0 < n_val K v (Ig K v I);\n     Ig K v I \\<in> carrier (Vr K v); Ig K v I \\<in> carrier K;\n     0 < v (Ig K v I); Ig K v I \\<noteq> \\<zero>;\n     Pg K v \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> v (Ig K v I) =\n                      int (na (n_val K v (Ig K v I))) *\\<^sub>a v (Pg K v)\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     0 \\<le> n_val K v (Ig K v I); 0 < v (Pg K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Ig K v I \\<in> I; LI K v I = v (Ig K v I);\n     v (Ig K v I) \\<noteq> 0; 0 < n_val K v (Ig K v I);\n     Ig K v I \\<in> carrier (Vr K v); Ig K v I \\<in> carrier K;\n     0 < v (Ig K v I); Ig K v I \\<noteq> \\<zero>;\n     Pg K v \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I =\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      Vr K v \\<diamondsuit>\\<^sub>p\n                      (Pg K\n                        v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)", "apply (frule Lv_z[of v], erule exE, simp,\n      rotate_tac 6, drule sym, simp,\n      subst asprod_amult,\n      simp add:val_poss_n_val_poss[of v \"Ig K v I\"],\n      frule val_nonzero_noninf[of v \"Ig K v I\"], assumption+,\n      frule val_noninf_n_val_noninf[of v \"Ig K v I\"], assumption+, simp,\n      rule aposs_na_poss[of \"n_val K v (Ig K v I)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>ant z = v (Pg K v); 0 \\<le> n_val K v (Ig K v I);\n        0 < v (Pg K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n        Ig K v I \\<in> I; LI K v I = n_val K v (Ig K v I) * v (Pg K v);\n        n_val K v (Ig K v I) * v (Pg K v) \\<noteq> 0;\n        0 < n_val K v (Ig K v I); Ig K v I \\<in> carrier (Vr K v);\n        Ig K v I \\<in> carrier K; 0 < n_val K v (Ig K v I) * v (Pg K v);\n        Ig K v I \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n        Lv K v = v (Pg K v); valuation K v; ideal (Vr K v) I;\n        I \\<noteq> carrier (Vr K v);\n        I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n        Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n        v (Ig K v I) = n_val K v (Ig K v I) * v (Pg K v)\\<rbrakk>\n       \\<Longrightarrow> n_val K v (Ig K v I) * v (Pg K v) =\n                         ant (int (na (n_val K v (Ig K v I)))) * v (Pg K v)\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     0 \\<le> n_val K v (Ig K v I); 0 < v (Pg K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Ig K v I \\<in> I; LI K v I = v (Ig K v I);\n     v (Ig K v I) \\<noteq> 0; 0 < n_val K v (Ig K v I);\n     Ig K v I \\<in> carrier (Vr K v); Ig K v I \\<in> carrier K;\n     0 < v (Ig K v I); Ig K v I \\<noteq> \\<zero>;\n     Pg K v \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I =\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      Vr K v \\<diamondsuit>\\<^sub>p\n                      (Pg K\n                        v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)", "apply (fold an_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>ant z = v (Pg K v); 0 \\<le> n_val K v (Ig K v I);\n        0 < v (Pg K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n        Ig K v I \\<in> I; LI K v I = n_val K v (Ig K v I) * v (Pg K v);\n        n_val K v (Ig K v I) * v (Pg K v) \\<noteq> 0;\n        0 < n_val K v (Ig K v I); Ig K v I \\<in> carrier (Vr K v);\n        Ig K v I \\<in> carrier K; 0 < n_val K v (Ig K v I) * v (Pg K v);\n        Ig K v I \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n        Lv K v = v (Pg K v); valuation K v; ideal (Vr K v) I;\n        I \\<noteq> carrier (Vr K v);\n        I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n        Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n        v (Ig K v I) = n_val K v (Ig K v I) * v (Pg K v)\\<rbrakk>\n       \\<Longrightarrow> n_val K v (Ig K v I) * v (Pg K v) =\n                         an (na (n_val K v (Ig K v I))) * v (Pg K v)\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     0 \\<le> n_val K v (Ig K v I); 0 < v (Pg K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Ig K v I \\<in> I; LI K v I = v (Ig K v I);\n     v (Ig K v I) \\<noteq> 0; 0 < n_val K v (Ig K v I);\n     Ig K v I \\<in> carrier (Vr K v); Ig K v I \\<in> carrier K;\n     0 < v (Ig K v I); Ig K v I \\<noteq> \\<zero>;\n     Pg K v \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I =\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      Vr K v \\<diamondsuit>\\<^sub>p\n                      (Pg K\n                        v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)", "apply (subst an_na[THEN sym, of \"n_val K v (Ig K v I)\"],\n      frule val_nonzero_noninf[of v \"Ig K v I\"], assumption+,\n      frule val_noninf_n_val_noninf[of v \"Ig K v I\"], assumption+, simp,\n      simp add:aless_imp_le, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = I;\n     n_val K v (Ig K v I) * v (Pg K v) = v (Ig K v I); Lv K v = v (Pg K v);\n     0 \\<le> n_val K v (Ig K v I); 0 < v (Pg K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Ig K v I \\<in> I; LI K v I = v (Ig K v I);\n     v (Ig K v I) \\<noteq> 0; 0 < n_val K v (Ig K v I);\n     Ig K v I \\<in> carrier (Vr K v); Ig K v I \\<in> carrier K;\n     0 < v (Ig K v I); Ig K v I \\<noteq> \\<zero>;\n     Pg K v \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I =\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> I =\n                      Vr K v \\<diamondsuit>\\<^sub>p\n                      (Pg K\n                        v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) ideal_apow_vp:\"\\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk> \\<Longrightarrow>\n                     I = (vp K v)\\<^bsup> (Vr K v) (n_val K v (Ig K v I))\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I\\<rbrakk>\n    \\<Longrightarrow> I = vp K v\\<^bsup> Vr K v n_val K v (Ig K v I)\\<^esup>", "apply (frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> I = vp K v\\<^bsup> Vr K v n_val K v (Ig K v I)\\<^esup>", "apply (case_tac \"v (Ig K v I) = \\<infinity>\",\n       frule val_Ig[of v I], assumption,\n       frule val_inf_n_val_inf[of v \"Ig K v I\"],\n       simp add:Ring.ideal_subset Vr_mem_f_mem, simp, simp add:r_apow_def,\n       simp add:LI_infinity[of v I])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     v (Ig K v I) \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> I = vp K v\\<^bsup> Vr K v n_val K v (Ig K v I)\\<^esup>", "apply (case_tac \"v (Ig K v I) = 0\",\n       frule val_0_n_val_0[of v \"Ig K v I\"],\n       frule val_Ig[of v I], assumption+, erule conjE,\n       simp add:Ring.ideal_subset Vr_mem_f_mem, simp,\n\n       frule val_Ig[of v I], assumption,\n       frule zero_val_gen_whole[of v \"Ig K v I\"],\n       simp add:Ring.ideal_subset, (erule conjE)+, simp,\n       frule Ring.ideal_cont_Rxa[of \"Vr K v\" \"I\" \"Ig K v I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     n_val K v (Ig K v I) = 0; LI K v I = 0;\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I = carrier (Vr K v);\n     Ig K v I \\<in> I; v (Ig K v I) = 0;\n     Vr K v \\<diamondsuit>\\<^sub>p Ig K v I \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> I = vp K v\\<^bsup> Vr K v 0\\<^esup>\n 2. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     v (Ig K v I) \\<noteq> \\<infinity>; v (Ig K v I) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> I = vp K v\\<^bsup> Vr K v n_val K v (Ig K v I)\\<^esup>", "apply (simp,\n       frule Ring.ideal_subset1[of \"Vr K v\" \"I\"], assumption+,\n       frule equalityI[of \"I\" \"carrier (Vr K v)\"], assumption+,\n       simp add:r_apow_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     v (Ig K v I) \\<noteq> \\<infinity>; v (Ig K v I) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> I = vp K v\\<^bsup> Vr K v n_val K v (Ig K v I)\\<^esup>", "apply (frule val_noninf_n_val_noninf[of v \"Ig K v I\"],\n       frule val_Ig[of v I], assumption,\n       simp add:Ring.ideal_subset Vr_mem_f_mem, simp,\n       frule value_n0_n_val_n0[of v \"Ig K v I\"],\n       frule val_Ig[of v I], assumption,\n       simp add:Ring.ideal_subset Vr_mem_f_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     n_val K v (Ig K v I) \\<noteq> \\<infinity>; v (Ig K v I) \\<noteq> 0;\n     v (Ig K v I) \\<noteq> \\<infinity>;\n     n_val K v (Ig K v I) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> I = vp K v\\<^bsup> Vr K v n_val K v (Ig K v I)\\<^esup>", "apply (simp add:r_apow_def,\n       rule ideal_pow_vp, assumption+,\n       frule elem_nonzeroval_gen_proper[of v \"Ig K v I\"],\n       frule val_Ig[of v I], assumption+, erule conjE,\n       simp add:Ring.ideal_subset, assumption, simp add:Ig_generate_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; Ring (Vr K v);\n     n_val K v (Ig K v I) \\<noteq> \\<infinity>; v (Ig K v I) \\<noteq> 0;\n     v (Ig K v I) \\<noteq> \\<infinity>;\n     n_val K v (Ig K v I) \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}", "apply (frule val_Ig[of v I], assumption+, erule conjE, simp,\n       simp add:LI_infinity[of v I])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(* A note to the above lemma (in Corps).\n  Let K be a field and v be a valuation. Let R be the valuaiton ring of v,\nand let P be the maximal ideal of R. If I is an ideal of R such that I \\<noteq> 0\nand I \\<noteq> R, then I = P^n. Here n = nat znt n_valuation K G a i v (I_gen\nK v I)) which is nat of the integer part of the normal value of\n(I_gen K v I).  Let b be a generator of I, then n = v (b) / v (p), where\np is a generator of P in R:\n                           I = P \\<^bsup>\\<diamondsuit>R n\\<^esup>\n\nHere\n          P = vp K v,\n          R = Vr K v,\n          b = Ig K v I,,\n          n = nat n_val K v (Ig K v I).\nIt is easy to see that n = v\\<^sup>* b. Here v\\<^sup>* is the normal valuation derived from\nv. *)"], ["", "lemma (in Corps) ideal_apow_n_val:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p x = (vp K v)\\<^bsup>(Vr K v) (n_val K v x)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x =\n                      vp K v\\<^bsup> Vr K v n_val K v x\\<^esup>", "apply (frule Vr_ring[of v],\n       frule Ring.principal_ideal[of \"Vr K v\" \"x\"], assumption+,\n       frule ideal_apow_vp[of v \"Vr K v \\<diamondsuit>\\<^sub>p x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Ring (Vr K v);\n     ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p x);\n     Vr K v \\<diamondsuit>\\<^sub>p x =\n     vp K\n      v\\<^bsup> Vr K\n                 v n_val K v\n                    (Ig K v\n                      (Vr K v \\<diamondsuit>\\<^sub>p x))\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x =\n                      vp K v\\<^bsup> Vr K v n_val K v x\\<^esup>", "apply (frule val_Ig[of v \"Vr K v \\<diamondsuit>\\<^sub>p x\"], assumption+, erule conjE,\n       frule Ring.ideal_subset[of \"Vr K v\" \"Vr K v \\<diamondsuit>\\<^sub>p x\"\n             \"Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)\"], assumption+,\n       frule Ig_generate_I[of v \"Vr K v \\<diamondsuit>\\<^sub>p x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Ring (Vr K v);\n     ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p x);\n     Vr K v \\<diamondsuit>\\<^sub>p x =\n     vp K\n      v\\<^bsup> Vr K\n                 v n_val K v\n                    (Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x))\\<^esup>;\n     Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p x;\n     v (Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)) =\n     LI K v (Vr K v \\<diamondsuit>\\<^sub>p x);\n     Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x) \\<in> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p\n     Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x) =\n     Vr K v \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x =\n                      vp K v\\<^bsup> Vr K v n_val K v x\\<^esup>", "apply (frule eq_ideal_eq_val[of v \"Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)\" x],\n       assumption+,\n       thin_tac \"Vr K v \\<diamondsuit>\\<^sub>p Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x) = Vr K v \\<diamondsuit>\\<^sub>p x\",\n       thin_tac \"v (Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)) = LI K v (Vr K v \\<diamondsuit>\\<^sub>p x)\",\n       frule n_val[THEN sym, of v x],\n       simp add:Vr_mem_f_mem, simp,\n       thin_tac \"v x = n_val K v x * Lv K v\",\n       frule n_val[THEN sym, of v \"Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)\"],\n       simp add:Vr_mem_f_mem, simp,\n       thin_tac \"v (Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)) = n_val K v x * Lv K v\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Ring (Vr K v);\n     ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p x);\n     Vr K v \\<diamondsuit>\\<^sub>p x =\n     vp K\n      v\\<^bsup> Vr K\n                 v n_val K v\n                    (Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x))\\<^esup>;\n     Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p x;\n     Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x) \\<in> carrier (Vr K v);\n     n_val K v (Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x)) * Lv K v =\n     n_val K v x * Lv K v\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x =\n                      vp K v\\<^bsup> Vr K v n_val K v x\\<^esup>", "apply (frule Lv_pos[of v],\n       frule Lv_z[of v], erule exE, simp,\n       frule_tac s = z in zless_neq[THEN not_sym, of \"0\"],\n       frule_tac z = z in adiv_eq[of _ \"n_val K v (Ig K v (Vr K v \\<diamondsuit>\\<^sub>p x))\"\n        \"n_val K v x\"], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) t_gen_vp:\"\\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p t = vp K v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "(*\napply (frule val_surj_n_val[of v], blast)\napply (frule ideal_apow_n_val[of v t])\napply (cut_tac a0_less_1)\napply (rule val_poss_mem_Vr[of v t], assumption+, simp)\napply (simp add:r_apow_def)\napply (simp only:ant_1[THEN sym], simp only:ant_0[THEN sym])\napply (simp only:aeq_zeq, simp)\napply (cut_tac z_neq_inf[THEN not_sym, of \"1\"], simp)\napply (simp only:an_1[THEN sym]) apply (simp add:na_an)\napply (rule Ring.idealprod_whole_r[of \"Vr K v\" \"vp K v\"])\napply (simp add:Vr_ring)\napply (simp add:vp_ideal)\ndone *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "assume  a1:\"valuation K v\" and\n        a2:\"t \\<in> carrier K\" and\n        a3:\"v t = 1\""], ["proof (state)\nthis:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "from a1 and a2 and a3"], ["proof (chain)\npicking this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1", "have h1:\"t \\<in> carrier (Vr K v)\""], ["proof (prove)\nusing this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1\n\ngoal (1 subgoal):\n 1. t \\<in> carrier (Vr K v)", "apply (cut_tac a0_less_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; 0 < 1\\<rbrakk>\n    \\<Longrightarrow> t \\<in> carrier (Vr K v)", "apply (rule val_poss_mem_Vr[of v t], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  t \\<in> carrier (Vr K v)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "from a1 and a2 and a3"], ["proof (chain)\npicking this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1", "have h2:\"n_val K v = v\""], ["proof (prove)\nusing this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1\n\ngoal (1 subgoal):\n 1. n_val K v = v", "apply (subst val_surj_n_val[of v])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> valuation K v\n 2. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier K. v x = 1\n 3. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> v = v", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier K. v x = 1\n 2. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> v = v", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> v = v", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  n_val K v = v\n\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "from a1 and h1"], ["proof (chain)\npicking this:\n  valuation K v\n  t \\<in> carrier (Vr K v)", "have h3:\"Vr K v \\<diamondsuit>\\<^sub>p t = vp K v\\<^bsup> (Vr K v) (n_val K v t)\\<^esup>\""], ["proof (prove)\nusing this:\n  valuation K v\n  t \\<in> carrier (Vr K v)\n\ngoal (1 subgoal):\n 1. Vr K v \\<diamondsuit>\\<^sub>p t =\n    vp K v\\<^bsup> Vr K v n_val K v t\\<^esup>", "apply (simp add:ideal_apow_n_val[of v t])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  Vr K v \\<diamondsuit>\\<^sub>p t =\n  vp K v\\<^bsup> Vr K v n_val K v t\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "from a1 and a3 and h2 and h3"], ["proof (chain)\npicking this:\n  valuation K v\n  v t = 1\n  n_val K v = v\n  Vr K v \\<diamondsuit>\\<^sub>p t =\n  vp K v\\<^bsup> Vr K v n_val K v t\\<^esup>", "show ?thesis"], ["proof (prove)\nusing this:\n  valuation K v\n  v t = 1\n  n_val K v = v\n  Vr K v \\<diamondsuit>\\<^sub>p t =\n  vp K v\\<^bsup> Vr K v n_val K v t\\<^esup>\n\ngoal (1 subgoal):\n 1. Vr K v \\<diamondsuit>\\<^sub>p t = vp K v", "apply (simp add:r_apow_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v t = 1; n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     (if \\<infinity> = 1 then {\\<zero>\\<^bsub>Vr K v\\<^esub>}\n      else if 1 = 0 then carrier (Vr K v)\n           else vp K v \\<^bsup>\\<diamondsuit>Vr K v na 1\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> (1 = 0 \\<longrightarrow>\n                       carrier (Vr K v) = vp K v) \\<and>\n                      (1 \\<noteq> 0 \\<longrightarrow>\n                       (\\<infinity> = 1 \\<longrightarrow>\n                        {\\<zero>\\<^bsub>Vr K v\\<^esub>} = vp K v) \\<and>\n                       (\\<infinity> \\<noteq> 1 \\<longrightarrow>\n                        vp K v \\<^bsup>\\<diamondsuit>Vr K v na 1\\<^esup> =\n                        vp K v))", "apply (simp only:ant_1[THEN sym], simp only:ant_0[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v t = ant 1; n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     (if \\<infinity> = ant 1 then {\\<zero>\\<^bsub>Vr K v\\<^esub>}\n      else if ant 1 = ant 0 then carrier (Vr K v)\n           else vp K v\n                   \\<^bsup>\\<diamondsuit>Vr K v na (ant 1)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> (ant 1 = ant 0 \\<longrightarrow>\n                       carrier (Vr K v) = vp K v) \\<and>\n                      (ant 1 \\<noteq> ant 0 \\<longrightarrow>\n                       (\\<infinity> = ant 1 \\<longrightarrow>\n                        {\\<zero>\\<^bsub>Vr K v\\<^esub>} = vp K v) \\<and>\n                       (\\<infinity> \\<noteq> ant 1 \\<longrightarrow>\n                        vp K v\n                           \\<^bsup>\\<diamondsuit>Vr K v na (ant 1)\\<^esup> =\n                        vp K v))", "apply (simp only:aeq_zeq, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v t = 1; n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     (if \\<infinity> = 1 then {\\<zero>\\<^bsub>Vr K v\\<^esub>}\n      else if 1 = 0 then carrier (Vr K v)\n           else vp K v\n                   \\<^bsup>\\<diamondsuit>Vr K v na (ant 1)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> (\\<infinity> = 1 \\<longrightarrow>\n                       {\\<zero>\\<^bsub>Vr K v\\<^esub>} = vp K v) \\<and>\n                      (\\<infinity> \\<noteq> 1 \\<longrightarrow>\n                       vp K v \\<^bsup>\\<diamondsuit>Vr K v na 1\\<^esup> =\n                       vp K v)", "apply (cut_tac z_neq_inf[THEN not_sym, of \"1\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v t = 1; n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na 1\\<^esup>;\n     \\<infinity> \\<noteq> 1\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<^bsup>\\<diamondsuit>Vr K v na 1\\<^esup> =\n                      vp K v", "apply (simp only:an_1[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v t = an 1; n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (an 1)\\<^esup>;\n     \\<infinity> \\<noteq> an 1\\<rbrakk>\n    \\<Longrightarrow> vp K v\n                         \\<^bsup>\\<diamondsuit>Vr K v na (an 1)\\<^esup> =\n                      vp K v", "apply (simp add:na_an)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v t = an (Suc 0); n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub> carrier (Vr K v);\n     \\<infinity> \\<noteq> an (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n                      carrier (Vr K v) =\n                      vp K v", "apply (rule Ring.idealprod_whole_r[of \"Vr K v\" \"vp K v\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; v t = an (Suc 0); n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub> carrier (Vr K v);\n     \\<infinity> \\<noteq> an (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Ring (Vr K v)\n 2. \\<lbrakk>valuation K v; v t = an (Suc 0); n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub> carrier (Vr K v);\n     \\<infinity> \\<noteq> an (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (vp K v)", "apply (simp add:Vr_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v t = an (Suc 0); n_val K v = v;\n     Vr K v \\<diamondsuit>\\<^sub>p t =\n     vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub> carrier (Vr K v);\n     \\<infinity> \\<noteq> an (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (vp K v)", "apply (simp add:vp_ideal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  Vr K v \\<diamondsuit>\\<^sub>p t = vp K v\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in Corps) t_vp_apow:\"\\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk> \\<Longrightarrow>\n                        (Vr K v) \\<diamondsuit>\\<^sub>p (t^\\<^bsup>(Vr K v) n\\<^esup>) = (vp K v)\\<^bsup>(Vr K v) (an n)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p\n                      (t^\\<^bsup>Vr K v n\\<^esup>) =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "(*\napply (frule Vr_ring[of v],\n       subst Ring.principal_ideal_n_pow[THEN sym, of \"Vr K v\" t \"vp K v\" n],\n       assumption+)\napply (cut_tac a0_less_1, rule val_poss_mem_Vr[of v], assumption+)\napply (simp, simp add:t_gen_vp,\n       simp add:r_apow_def)\n apply (rule conjI, rule impI,\n        simp only:an_0[THEN sym], frule an_inj[of n 0], simp)\napply (rule impI)\n apply (rule conjI, rule impI)\n apply (simp add:an_def)\napply (rule impI, cut_tac an_nat_pos[of n], simp add:na_an)\ndone *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p\n                      (t^\\<^bsup>Vr K v n\\<^esup>) =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p\n                      (t^\\<^bsup>Vr K v n\\<^esup>) =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "assume  a1:\"valuation K v\" and\n        a2:\"t \\<in> carrier K\" and\n        a3:\"v t = 1\""], ["proof (state)\nthis:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p\n                      (t^\\<^bsup>Vr K v n\\<^esup>) =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "from a1"], ["proof (chain)\npicking this:\n  valuation K v", "have h1:\"Ring (Vr K v)\""], ["proof (prove)\nusing this:\n  valuation K v\n\ngoal (1 subgoal):\n 1. Ring (Vr K v)", "by (simp add:Vr_ring[of v])"], ["proof (state)\nthis:\n  Ring (Vr K v)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p\n                      (t^\\<^bsup>Vr K v n\\<^esup>) =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "from a1 and a2 and a3"], ["proof (chain)\npicking this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1", "have h2:\"t \\<in> carrier (Vr K v)\""], ["proof (prove)\nusing this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1\n\ngoal (1 subgoal):\n 1. t \\<in> carrier (Vr K v)", "apply (cut_tac a0_less_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; 0 < 1\\<rbrakk>\n    \\<Longrightarrow> t \\<in> carrier (Vr K v)", "apply (rule val_poss_mem_Vr)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; 0 < 1\\<rbrakk>\n    \\<Longrightarrow> valuation K v\n 2. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; 0 < 1\\<rbrakk>\n    \\<Longrightarrow> t \\<in> carrier K\n 3. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; 0 < 1\\<rbrakk>\n    \\<Longrightarrow> 0 < v t", "apply assumption+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; 0 < 1\\<rbrakk>\n    \\<Longrightarrow> 0 < v t", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  t \\<in> carrier (Vr K v)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p\n                      (t^\\<^bsup>Vr K v n\\<^esup>) =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "from a1 and a2 and a3 and h1 and h2"], ["proof (chain)\npicking this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1\n  Ring (Vr K v)\n  t \\<in> carrier (Vr K v)", "show ?thesis"], ["proof (prove)\nusing this:\n  valuation K v\n  t \\<in> carrier K\n  v t = 1\n  Ring (Vr K v)\n  t \\<in> carrier (Vr K v)\n\ngoal (1 subgoal):\n 1. Vr K v \\<diamondsuit>\\<^sub>p (t^\\<^bsup>Vr K v n\\<^esup>) =\n    vp K v\\<^bsup> Vr K v an n\\<^esup>", "apply (subst Ring.principal_ideal_n_pow[THEN sym, of \"Vr K v\" t \"vp K v\" n])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> Ring (Vr K v)\n 2. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> t \\<in> carrier (Vr K v)\n 3. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> vp K v = Vr K v \\<diamondsuit>\\<^sub>p t\n 4. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> vp K v = Vr K v \\<diamondsuit>\\<^sub>p t\n 2. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "apply (simp add:t_gen_vp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      vp K v\\<^bsup> Vr K v an n\\<^esup>", "apply (simp add:r_apow_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                       carrier (Vr K v)) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                        {\\<zero>\\<^bsub>Vr K v\\<^esub>}) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                        vp K v\n                           \\<^bsup>\\<diamondsuit>Vr K v na (an n)\\<^esup>))", "apply (rule conjI, rule impI,\n        simp only:an_0[THEN sym], frule an_inj[of n 0], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> an n \\<noteq> 0 \\<longrightarrow>\n                      (an n = \\<infinity> \\<longrightarrow>\n                       vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                       {\\<zero>\\<^bsub>Vr K v\\<^esub>}) \\<and>\n                      (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                       vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                       vp K v\n                          \\<^bsup>\\<diamondsuit>Vr K v na (an n)\\<^esup>)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v); an n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> (an n = \\<infinity> \\<longrightarrow>\n                       vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                       {\\<zero>\\<^bsub>Vr K v\\<^esub>}) \\<and>\n                      (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                       vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                       vp K v\n                          \\<^bsup>\\<diamondsuit>Vr K v na (an n)\\<^esup>)", "apply (rule conjI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v); an n \\<noteq> 0; an n = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      {\\<zero>\\<^bsub>Vr K v\\<^esub>}\n 2. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v); an n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> an n \\<noteq> \\<infinity> \\<longrightarrow>\n                      vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      vp K v \\<^bsup>\\<diamondsuit>Vr K v na (an n)\\<^esup>", "apply (simp add:an_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; t \\<in> carrier K; v t = 1; Ring (Vr K v);\n     t \\<in> carrier (Vr K v); an n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> an n \\<noteq> \\<infinity> \\<longrightarrow>\n                      vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n                      vp K v \\<^bsup>\\<diamondsuit>Vr K v na (an n)\\<^esup>", "apply (rule impI, cut_tac an_nat_pos[of n], simp add:na_an)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  Vr K v \\<diamondsuit>\\<^sub>p (t^\\<^bsup>Vr K v n\\<^esup>) =\n  vp K v\\<^bsup> Vr K v an n\\<^esup>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in Corps) nonzeroelem_gen_nonzero:\"\\<lbrakk>valuation K v; x \\<noteq> \\<zero>;\n                 x \\<in> carrier (Vr K v)\\<rbrakk> \\<Longrightarrow>  Vr K v \\<diamondsuit>\\<^sub>p x \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<noteq> \\<zero>;\n     x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p x \\<noteq>\n                      {\\<zero>\\<^bsub>Vr K v\\<^esub>}", "by (frule Vr_ring[of v],\n    frule_tac a = x in Ring.a_in_principal[of \"Vr K v\"], assumption+,\n    rule contrapos_pp, simp+, simp add:Vr_0_f_0)"], ["", "subsection \"Amin lemma (in Corps)s \""], ["", "lemma (in Corps)  Amin_le_addTr:\"valuation K v \\<Longrightarrow>\n(\\<forall>j \\<le> n. f j \\<in> carrier K) \\<longrightarrow> Amin n (v \\<circ> f) \\<le> (v (nsum K f n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    (\\<forall>j\\<le>n. f j \\<in> carrier K) \\<longrightarrow>\n    Amin n (v \\<circ> f) \\<le> v (\\<Sigma>\\<^sub>e K f n)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. valuation K v \\<Longrightarrow>\n    (\\<forall>j\\<le>0. f j \\<in> carrier K) \\<longrightarrow>\n    Amin 0 (v \\<circ> f) \\<le> v (\\<Sigma>\\<^sub>e K f 0)\n 2. \\<And>n.\n       \\<lbrakk>valuation K v;\n        (\\<forall>j\\<le>n. f j \\<in> carrier K) \\<longrightarrow>\n        Amin n (v \\<circ> f) \\<le> v (\\<Sigma>\\<^sub>e K f n)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> carrier K) \\<longrightarrow>\n                         Amin (Suc n) (v \\<circ> f)\n                         \\<le> v (\\<Sigma>\\<^sub>e K f Suc n)", "apply (rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>valuation K v;\n        (\\<forall>j\\<le>n. f j \\<in> carrier K) \\<longrightarrow>\n        Amin n (v \\<circ> f) \\<le> v (\\<Sigma>\\<^sub>e K f n)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> carrier K) \\<longrightarrow>\n                         Amin (Suc n) (v \\<circ> f)\n                         \\<le> v (\\<Sigma>\\<^sub>e K f Suc n)", "apply (rule impI,\n       simp,\n       frule_tac x = \"\\<Sigma>\\<^sub>e K f n\" and y = \"f (Suc n)\" in amin_le_plus[of v],\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       cut_tac n = n in aGroup.nsum_mem[of K _ f], assumption,\n       rule allI, simp add:funcset_mem, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>valuation K v;\n        Amin n (\\<lambda>a. v (f a)) \\<le> v (\\<Sigma>\\<^sub>e K f n);\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier K;\n        amin (v (\\<Sigma>\\<^sub>e K f n)) (v (f (Suc n)))\n        \\<le> v (\\<Sigma>\\<^sub>e K f n \\<plusminus> f (Suc n))\\<rbrakk>\n       \\<Longrightarrow> amin (Amin n (\\<lambda>a. v (f a))) (v (f (Suc n)))\n                         \\<le> v (\\<Sigma>\\<^sub>e K f n \\<plusminus>\n                                  f (Suc n))", "apply (frule_tac z = \"Amin n (\\<lambda>u. v (f u))\" and z' = \"v (\\<Sigma>\\<^sub>e K f n)\" and\n        w = \"v (f (Suc n))\" in amin_aminTr,\n        rule_tac i = \"amin (Amin n (\\<lambda>u. v (f u))) (v (f (Suc n)))\" and\n        j = \"amin (v (\\<Sigma>\\<^sub>e K f n)) (v (f (Suc n)))\" and\n        k = \"v (\\<Sigma>\\<^sub>e K f n \\<plusminus> (f (Suc n)))\" in ale_trans, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Amin_le_add:\"\\<lbrakk>valuation K v; \\<forall>j \\<le> n. f j \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n                      Amin n (v \\<circ> f) \\<le> (v (nsum K f n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<forall>j\\<le>n. f j \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> Amin n (v \\<circ> f) \\<le> v (\\<Sigma>\\<^sub>e K f n)", "by (frule Amin_le_addTr[of v n f], simp)"], ["", "lemma (in Corps) value_ge_add:\"\\<lbrakk>valuation K v; \\<forall>j \\<le> n. f j \\<in> carrier K;\n                     \\<forall>j \\<le> n. z \\<le> ((v \\<circ> f) j)\\<rbrakk>  \\<Longrightarrow> z \\<le> (v (\\<Sigma>\\<^sub>e K f n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<forall>j\\<le>n. f j \\<in> carrier K;\n     \\<forall>j\\<le>n. z \\<le> (v \\<circ> f) j\\<rbrakk>\n    \\<Longrightarrow> z \\<le> v (\\<Sigma>\\<^sub>e K f n)", "apply (frule Amin_le_add[of v n f], assumption+,\n       cut_tac Amin_ge[of n \"v \\<circ> f\" z],\n       rule ale_trans, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; \\<forall>j\\<le>n. f j \\<in> carrier K;\n     \\<forall>j\\<le>n. z \\<le> (v \\<circ> f) j;\n     Amin n (v \\<circ> f) \\<le> v (\\<Sigma>\\<^sub>e K f n)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         (v \\<circ> f) j \\<in> Z\\<^sub>\\<infinity>\n 2. \\<lbrakk>valuation K v; \\<forall>j\\<le>n. f j \\<in> carrier K;\n     \\<forall>j\\<le>n. z \\<le> (v \\<circ> f) j;\n     Amin n (v \\<circ> f) \\<le> v (\\<Sigma>\\<^sub>e K f n)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. z \\<le> (v \\<circ> f) j", "apply (rule allI, rule impI,\n       simp add:comp_def Zset_def,\n       rule value_in_aug_inf[of v], assumption+, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_ideal_powTr1:\"\\<lbrakk>valuation K v; ideal (Vr K v) I;\n I \\<noteq> carrier (Vr K v); b \\<in> I\\<rbrakk>  \\<Longrightarrow> b \\<in> (vp K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; ideal (Vr K v) I; I \\<noteq> carrier (Vr K v);\n     b \\<in> I\\<rbrakk>\n    \\<Longrightarrow> b \\<in> vp K v", "by (frule ideal_sub_vp[of v I], assumption+, simp add:subsetD)"], ["", "section \\<open>pow of vp and \\<open>n_value\\<close> -- convergence --\\<close>"], ["", "lemma (in Corps) n_value_x_1:\"\\<lbrakk>valuation K v; 0 \\<le> n;\n                    x \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\\<rbrakk> \\<Longrightarrow>  n \\<le> (n_val K v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n;\n     x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v x", "(* 1. prove that x \\<in> carrier (Vr K v) and that x \\<in> carrier K *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n;\n     x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v x", "apply ((case_tac \"n = \\<infinity>\", simp add:r_apow_def,\n        simp add:Vr_0_f_0, cut_tac field_is_ring,\n        frule Ring.ring_zero[of \"K\"], frule val_inf_n_val_inf[of v \\<zero>],\n        assumption+, simp add:value_of_zero),\n       (case_tac \"n = 0\", simp add:r_apow_def,\n        subst val_pos_n_val_pos[THEN sym, of v x], assumption+,\n        simp add:Vr_mem_f_mem,\n        subst val_pos_mem_Vr[of v x], assumption+,\n        simp add:Vr_mem_f_mem, assumption,\n        simp add:r_apow_def, frule Vr_ring[of v],\n        frule vp_pow_ideal[of v \"na n\"],\n        frule Ring.ideal_subset[of \"Vr K v\" \"(vp K v) \\<^bsup>\\<diamondsuit>(Vr K v) (na n)\\<^esup>\" x],\n        assumption+, frule Vr_mem_f_mem[of v x], assumption+))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v na n\\<^esup>;\n     n \\<noteq> \\<infinity>; n \\<noteq> 0; Ring (Vr K v);\n     ideal (Vr K v) (vp K v \\<^bsup>\\<diamondsuit>Vr K v na n\\<^esup>);\n     x \\<in> carrier (Vr K v); x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v x", "(* 1. done *)\n\n(** 2. Show that\n  v (I_gen K v (vpr K  v)^\\<^sup>Vr K v\\<^sup> \\<^sup>nat n) \\<le> v x.  the key lemma (in Corps)  is\n \"val_Rxa_gt_a\"                  **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v na n\\<^esup>;\n     n \\<noteq> \\<infinity>; n \\<noteq> 0; Ring (Vr K v);\n     ideal (Vr K v) (vp K v \\<^bsup>\\<diamondsuit>Vr K v na n\\<^esup>);\n     x \\<in> carrier (Vr K v); x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v x", "apply (case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\", simp,\n      frule value_of_zero[of v],\n      simp add:val_inf_n_val_inf,\n      simp add:n_value_idealTr[of v \"na n\"],\n\n      frule val_Pg[of v], erule conjE, simp, erule conjE,\n      frule Lv_pos[of v],\n      rotate_tac -4, frule sym, thin_tac \"v (Pg K v) = Lv K v\", simp,\n      frule val_poss_mem_Vr[of v \"Pg K v\"], assumption+,\n      frule val_Rxa_gt_a[of v \"Pg K v^\\<^bsup>(Vr K v) (na n)\\<^esup>\" x],\n\n      frule Vr_integral[of v],\n      simp only:Vr_0_f_0[of v, THEN sym],\n      frule Idomain.idom_potent_nonzero[of \"Vr K v\" \"Pg K v\" \"na n\"],\n      assumption+, simp, simp add:Ring.npClose, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     0 < v (Pg K v); valuation K v; 0 \\<le> n;\n     x \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n             (Pg K v^\\<^bsup>Vr K v na n\\<^esup>);\n     n \\<noteq> \\<infinity>; n \\<noteq> 0; Ring (Vr K v);\n     ideal (Vr K v)\n      (Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v na n\\<^esup>));\n     x \\<in> carrier (Vr K v); x \\<in> carrier K; x \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); Pg K v \\<in> carrier (Vr K v);\n     v (Pg K v^\\<^bsup>Vr K v na n\\<^esup>) \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v x", "apply (thin_tac \"x \\<in> Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>(Vr K v) (na n)\\<^esup>)\",\n       thin_tac \"ideal (Vr K v) (Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>(Vr K v) (na n)\\<^esup>))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     0 < v (Pg K v); valuation K v; 0 \\<le> n; n \\<noteq> \\<infinity>;\n     n \\<noteq> 0; Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x \\<in> carrier K; x \\<noteq> \\<zero>; Lv K v = v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v);\n     v (Pg K v^\\<^bsup>Vr K v na n\\<^esup>) \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v x", "apply (simp add:Vr_exp_f_exp[of v \"Pg K v\"],\n       simp add:val_exp_ring[THEN sym, of v \"Pg K v\"],\n       simp add:n_val[THEN sym, of v x],\n       frule val_nonzero_z[of v \"Pg K v\"], assumption+,\n         erule exE, simp,\n       frule aposs_na_poss[of \"n\"], simp add: less_le,\n       simp add:asprod_amult,\n\n       frule_tac w = z in amult_pos_mono_r[of _ \"ant (int (na n))\"\n                   \"n_val K v x\"], simp,\n       cut_tac an_na[of \"n\"], simp add:an_def, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_value_x_1_nat:\"\\<lbrakk>valuation K v; x \\<in> (vp K v)\\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup> \\<rbrakk> \\<Longrightarrow>\n             (an n) \\<le> (n_val K v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply (cut_tac an_nat_pos[of \"n\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>;\n     0 \\<le> an n\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply( frule n_value_x_1[of  \"v\" \"an n\" \"x\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>;\n     0 \\<le> an n\\<rbrakk>\n    \\<Longrightarrow> x \\<in> vp K v\\<^bsup> Vr K v an n\\<^esup>\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply (simp add:r_apow_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       x \\<in> carrier (Vr K v)) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        x = \\<zero>\\<^bsub>Vr K v\\<^esub>) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        x \\<in> vp K v\n                                   \\<^bsup>\\<diamondsuit>Vr K\n                    v na (an n)\\<^esup>))\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply (case_tac \"n = 0\", simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 < n\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       x \\<in> carrier (Vr K v)) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        x = \\<zero>\\<^bsub>Vr K v\\<^esub>) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        x \\<in> vp K v\n                                   \\<^bsup>\\<diamondsuit>Vr K\n                    v na (an n)\\<^esup>))\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply (cut_tac aless_nat_less[THEN sym, of \"0\" \"n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 < n;\n     (0 < n) = (an 0 < an n)\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       x \\<in> carrier (Vr K v)) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        x = \\<zero>\\<^bsub>Vr K v\\<^esub>) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        x \\<in> vp K v\n                                   \\<^bsup>\\<diamondsuit>Vr K\n                    v na (an n)\\<^esup>))\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 < an n;\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       x \\<in> carrier (Vr K v)) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        x = \\<zero>\\<^bsub>Vr K v\\<^esub>) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        x \\<in> vp K v\n                                   \\<^bsup>\\<diamondsuit>Vr K\n                    v na (an n)\\<^esup>))\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "unfolding less_le"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>;\n     0 \\<le> an n \\<and> 0 \\<noteq> an n;\n     0 \\<le> n \\<and> 0 \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> (an n = 0 \\<longrightarrow>\n                       x \\<in> carrier (Vr K v)) \\<and>\n                      (an n \\<noteq> 0 \\<longrightarrow>\n                       (an n = \\<infinity> \\<longrightarrow>\n                        x = \\<zero>\\<^bsub>Vr K v\\<^esub>) \\<and>\n                       (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                        x \\<in> vp K v\n                                   \\<^bsup>\\<diamondsuit>Vr K\n                    v na (an n)\\<^esup>))\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; an n \\<noteq> 0;\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> (an n = \\<infinity> \\<longrightarrow>\n                       x = \\<zero>\\<^bsub>Vr K v\\<^esub>) \\<and>\n                      (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                       x \\<in> vp K v\n                                  \\<^bsup>\\<diamondsuit>Vr K\n                   v na (an n)\\<^esup>)\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply (cut_tac an_neq_inf [of \"n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; an n \\<noteq> 0;\n     0 < n; an n \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> (an n = \\<infinity> \\<longrightarrow>\n                       x = \\<zero>\\<^bsub>Vr K v\\<^esub>) \\<and>\n                      (an n \\<noteq> \\<infinity> \\<longrightarrow>\n                       x \\<in> vp K v\n                                  \\<^bsup>\\<diamondsuit>Vr K\n                   v na (an n)\\<^esup>)\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; an n \\<noteq> 0;\n     0 < n; an n \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> vp K v\n                                 \\<^bsup>\\<diamondsuit>Vr K\n                  v na (an n)\\<^esup>\n 2. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply (simp add: na_an)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>; 0 \\<le> an n;\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> an n \\<le> n_val K v x", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_value_x_2:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n        n \\<le> (n_val K v x);  0 \\<le> n\\<rbrakk> \\<Longrightarrow>  x \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); n \\<le> n_val K v x;\n     0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (frule Vr_ring[of v],\n       frule val_Pg[of v], erule conjE,\n       simp, erule conjE, drule sym,\n       frule Lv_pos[of v], simp,\n       frule val_poss_mem_Vr[of v \"Pg K v\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); n \\<le> n_val K v x;\n     0 \\<le> n; Ring (Vr K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v); 0 < v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (case_tac \"n = \\<infinity>\",\n       simp add:r_apow_def, cut_tac inf_ge_any[of \"n_val K v x\"],\n       frule ale_antisym[of \"n_val K v x\" \"\\<infinity>\"], assumption+,\n       frule val_inf_n_val_inf[THEN sym, of v \"x\"],\n       simp add:Vr_mem_f_mem, simp,\n       frule value_inf_zero[of v x],\n       simp add:Vr_mem_f_mem, simp+, simp add:Vr_0_f_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); n \\<le> n_val K v x;\n     0 \\<le> n; Ring (Vr K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v); 0 < v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v); n \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (case_tac \"n = 0\",\n       simp add:r_apow_def,\n       simp add:r_apow_def,\n       subst n_value_idealTr[of v \"na n\"], assumption+,\n       simp add:apos_na_pos)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); n \\<le> n_val K v x;\n     0 \\<le> n; Ring (Vr K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v); 0 < v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v); n \\<noteq> \\<infinity>;\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> x \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                              (Pg K v^\\<^bsup>Vr K v na n\\<^esup>)", "apply (rule val_Rxa_gt_a_1[of v \"Pg K v^\\<^bsup>(Vr K v) (na n)\\<^esup>\" x],\n            assumption+,\n       rule Ring.npClose, assumption+,\n       simp add:Vr_0_f_0[THEN sym, of v],\n       frule Vr_integral[of v],\n       frule val_poss_mem_Vr[of v \"Pg K v\"], assumption+,\n       simp add:Idomain.idom_potent_nonzero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); n \\<le> n_val K v x;\n     0 \\<le> n; Ring (Vr K v); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v); 0 < v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v); n \\<noteq> \\<infinity>;\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> v (Pg K v^\\<^bsup>Vr K v na n\\<^esup>) \\<le> v x", "apply (simp add:Vr_exp_f_exp,\n      simp add:val_exp_ring[THEN sym, of v],\n      rotate_tac -5, drule sym,\n      frule Lv_z[of v], erule exE, simp,\n      frule aposs_na_poss[of \"n\"], simp add: less_le,\n      simp add:asprod_amult, subst n_val[THEN sym, of v x],\n      assumption+,\n      simp add:Vr_mem_f_mem, simp,\n      subst amult_pos_mono_r[of _ \"ant (int (na n))\" \"n_val K v x\"],\n         assumption,\n      cut_tac an_na[of \"n\"], simp add:an_def, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_value_x_2_nat:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n      (an n) \\<le> ((n_val K v) x)\\<rbrakk> \\<Longrightarrow>  x \\<in> (vp K v)\\<^bsup>\\<diamondsuit>(Vr K  v)  n\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n     an n \\<le> n_val K v x\\<rbrakk>\n    \\<Longrightarrow> x \\<in> vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup>", "by (frule n_value_x_2[of v x \"an n\"], assumption+,\n       simp, simp add:r_apow_def,\n       case_tac \"an n = \\<infinity>\", simp add:an_def, simp,\n       case_tac \"n = 0\", simp,\n       subgoal_tac \"an n \\<noteq> 0\", simp, simp add:na_an,\n       rule contrapos_pp, simp+, simp add:an_def)"], ["", "lemma (in Corps) n_val_n_pow:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n         (n \\<le> (n_val K v x)) = (x \\<in> (vp K v) \\<^bsup>(Vr K v)  n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (n \\<le> n_val K v x) =\n                      (x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>)", "by (rule iffI, simp add:n_value_x_2, simp add:n_value_x_1)"], ["", "lemma (in Corps) eqval_in_vpr_apow:\"\\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> n;\n      y \\<in> carrier K; n_val K v x = n_val K v y; x \\<in> (vp K v)\\<^bsup>(Vr K v) n\\<^esup>\\<rbrakk> \\<Longrightarrow>\n      y \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> n; y \\<in> carrier K;\n     n_val K v x = n_val K v y;\n     x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> y \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (frule n_value_x_1[of v n x], assumption+, simp,\n       rule n_value_x_2[of v y n], assumption+,\n       frule mem_vp_apow_mem_Vr[of v n x], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> n; y \\<in> carrier K;\n     n_val K v x = n_val K v y; x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>;\n     n \\<le> n_val K v y; x \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> y \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> n; y \\<in> carrier K;\n     n_val K v x = n_val K v y; x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>;\n     n \\<le> n_val K v y\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v y\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; 0 \\<le> n; y \\<in> carrier K;\n     n_val K v x = n_val K v y; x \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>;\n     n \\<le> n_val K v y\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n", "apply (frule val_pos_mem_Vr[THEN sym, of v x], assumption+, simp,\n       simp add:val_pos_n_val_pos[of v x],\n       simp add:val_pos_n_val_pos[THEN sym, of v y],\n       simp add:val_pos_mem_Vr, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) convergenceTr:\"\\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n  b \\<in> (vp K v)\\<^bsup>(Vr K v) n\\<^esup>; (Abs (n_val K v x)) \\<le> n\\<rbrakk> \\<Longrightarrow>\n                x \\<cdot>\\<^sub>r b \\<in> (vp K v)\\<^bsup>(Vr K v) (n + (n_val K v x))\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>;\n     Abs (n_val K v x) \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b\n                      \\<in> vp K v\\<^bsup> Vr K v n + n_val K v x\\<^esup>", "(** Valuation ring is a ring **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>;\n     Abs (n_val K v x) \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b\n                      \\<in> vp K v\\<^bsup> Vr K v n + n_val K v x\\<^esup>", "apply (cut_tac Abs_pos[of \"n_val K v x\"],\n       frule ale_trans[of \"0\" \"Abs (n_val K v x)\" \"n\"], assumption+,\n       thin_tac \"0 \\<le> Abs (n_val K v x)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b\n                      \\<in> vp K v\\<^bsup> Vr K v n + n_val K v x\\<^esup>", "apply (frule Vr_ring[of v],\n       frule_tac aadd_le_mono[of \"Abs (n_val K v x)\" \"n\" \"n_val K v x\"],\n       cut_tac Abs_x_plus_x_pos[of \"n_val K v x\"],\n       frule ale_trans[of \"0\" \"Abs (n_val K v x) + n_val K v x\"\n        \"n + n_val K v x\"], assumption+,\n       thin_tac \"0 \\<le> Abs (n_val K v x) + n_val K v x\",\n       thin_tac \"Abs (n_val K v x) + n_val K v x \\<le> n + n_val K v x\",\n       rule n_value_x_2[of v \"x \\<cdot>\\<^sub>r b\" \"n + n_val K v x\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> n + n_val K v x \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n + n_val K v x", "apply (frule n_value_x_1[of v n b], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x;\n     n \\<le> n_val K v b\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> n + n_val K v x \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n + n_val K v x", "apply (frule aadd_le_mono[of \"n\" \"n_val K v b\" \"n_val K v x\"],\n       frule ale_trans[of \"0\" \"n + n_val K v x\" \"n_val K v b + n_val K v x\"],\n       assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x; n \\<le> n_val K v b;\n     n + n_val K v x \\<le> n_val K v b + n_val K v x;\n     0 \\<le> n_val K v b + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> n + n_val K v x \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n + n_val K v x", "apply (thin_tac \"0 \\<le> n + n_val K v x\",\n        thin_tac \"n \\<le> n_val K v b\",\n        thin_tac \"n + n_val K v x \\<le> n_val K v b + n_val K v x\",\n       simp add:aadd_commute[of \"n_val K v b\" \"n_val K v x\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n_val K v x + n_val K v b\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> n + n_val K v x \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; b \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>; Abs (n_val K v x) \\<le> n;\n     0 \\<le> n; Ring (Vr K v); 0 \\<le> n + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n + n_val K v x", "apply (frule n_val_valuation[of v],\n       simp add:val_t2p[THEN sym, of \"n_val K v\" x b],\n       cut_tac field_is_ring,\n       frule Ring.ring_tOp_closed[of \"K\" \"x\" \"b\"], assumption+,\n       simp add:val_pos_n_val_pos[THEN sym, of v \"x \\<cdot>\\<^sub>r b\"],\n       simp add:val_pos_mem_Vr,\n       frule n_val_valuation[of v],\n       subst val_t2p[of \"n_val K v\"], assumption+,\n       frule n_value_x_1[of v n b], assumption+,\n       simp add:aadd_commute[of \"n_val K v x\" \"n_val K v b\"],\n       rule aadd_le_mono[of n \"n_val K v b\" \"n_val K v x\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) convergenceTr1:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n      b \\<in> (vp K v)\\<^bsup>(Vr K v) (n + Abs (n_val K v x))\\<^esup>; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n                                 x \\<cdot>\\<^sub>r b \\<in> (vp K v) \\<^bsup>(Vr K v) n\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>;\n     0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b\n                      \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (cut_tac field_is_ring,\n       frule Vr_ring[of v],\n       frule vp_apow_ideal[of v \"n + Abs (n_val K v x)\"],\n       cut_tac Abs_pos[of \"n_val K v x\"],\n       rule aadd_two_pos[of \"n\" \"Abs (n_val K v x)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v)\n      (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b\n                      \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (frule Ring.ideal_subset[of \"Vr K v\" \"vp K v\\<^bsup> (Vr K v) (n + Abs (n_val K v x))\\<^esup>\"\n        \"b\"], assumption+,\n       frule Vr_mem_f_mem[of v b], assumption,\n       frule convergenceTr[of v x b \"n +  Abs (n_val K v x)\"], assumption+,\n       rule aadd_pos_le[of \"n\" \"Abs (n_val K v x)\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K\n                       v n + Abs (n_val K v x) +\n                         n_val K v x\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b\n                      \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (frule  apos_in_aug_inf[of \"n\"],\n       cut_tac Abs_pos[of \"n_val K v x\"],\n       frule apos_in_aug_inf[of \"Abs (n_val K v x)\"],\n       frule n_value_in_aug_inf[of v x], assumption+,\n       frule aadd_assoc_i[of \"n\" \"Abs (n_val K v x)\" \"n_val K v x\"],\n              assumption+,\n       cut_tac Abs_x_plus_x_pos[of \"n_val K v x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b\n                      \\<in> vp K v\\<^bsup> Vr K v n\\<^esup>", "apply (frule_tac Ring.ring_tOp_closed[of K x b], assumption+,\n       rule n_value_x_2[of v \"x \\<cdot>\\<^sub>r b\" n], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n", "apply (subst val_pos_mem_Vr[THEN sym, of v \"x \\<cdot>\\<^sub>r b\"], assumption+,\n       subst val_pos_n_val_pos[of v \"x \\<cdot>\\<^sub>r b\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n", "apply (frule n_value_x_1[of \"v\" \"n + Abs(n_val K v x) + n_val K v x\" \"x \\<cdot>\\<^sub>r b\"],\n       subst aadd_assoc_i, assumption+,\n       rule aadd_two_pos[of \"n\"], assumption+,\n       rule ale_trans[of \"0\" \"n + Abs (n_val K v x) + n_val K v x\"\n                \"n_val K v (x \\<cdot>\\<^sub>r b)\"],\n       simp, simp add:aadd_two_pos, assumption,\n       frule n_value_x_1[of \"v\" \"n + Abs (n_val K v x)\" \" b\"],\n       cut_tac Abs_pos[of \"n_val K v x\"],\n       rule aadd_two_pos[of \"n\" \"Abs (n_val K v x)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K;\n     n + Abs (n_val K v x) \\<le> n_val K v b\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v (x \\<cdot>\\<^sub>r b)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n", "apply (frule n_val_valuation[of v],\n        subst val_t2p[of  \"n_val K v\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K;\n     n + Abs (n_val K v x) \\<le> n_val K v b;\n     valuation K (n_val K v)\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n_val K v x + n_val K v b\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     b \\<in> vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>; 0 \\<le> n;\n     Ring K; Ring (Vr K v);\n     ideal (Vr K v) (vp K v\\<^bsup> Vr K v n + Abs (n_val K v x)\\<^esup>);\n     b \\<in> carrier (Vr K v); b \\<in> carrier K;\n     x \\<cdot>\\<^sub>r b\n     \\<in> vp K\n            v\\<^bsup> Vr K v n + Abs (n_val K v x) + n_val K v x\\<^esup>;\n     n \\<in> Z\\<^sub>\\<infinity>; 0 \\<le> Abs (n_val K v x);\n     Abs (n_val K v x) \\<in> Z\\<^sub>\\<infinity>;\n     n_val K v x \\<in> Z\\<^sub>\\<infinity>;\n     n + Abs (n_val K v x) + n_val K v x =\n     n + (Abs (n_val K v x) + n_val K v x);\n     0 \\<le> Abs (n_val K v x) + n_val K v x;\n     x \\<cdot>\\<^sub>r b \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> n", "apply (frule aadd_le_mono[of \"n + Abs (n_val K v x)\" \"n_val K v b\"\n                              \"n_val K v x\"],\n        simp add:aadd_commute[of \"n_val K v b\" \"n_val K v x\"],\n        rule ale_trans[of \"n\" \"n + (Abs (n_val K v x) + n_val K v x)\"\n           \"n_val K v x + n_val K v b\"],\n        frule aadd_pos_le[of \"Abs (n_val K v x) + n_val K v x\" \"n\"],\n        simp add:aadd_commute[of \"n\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vp_potent_zero:\"\\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk> \\<Longrightarrow>\n             (n = \\<infinity>) = (vp K v \\<^bsup>(Vr K v) n\\<^esup> = {\\<zero>\\<^bsub>Vr K v\\<^esub>})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (n = \\<infinity>) =\n                      (vp K v\\<^bsup> Vr K v n\\<^esup> =\n                       {\\<zero>\\<^bsub>Vr K v\\<^esub>})", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; n = \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> vp K v\\<^bsup> Vr K v n\\<^esup> =\n                      {\\<zero>\\<^bsub>Vr K v\\<^esub>}\n 2. \\<lbrakk>valuation K v; 0 \\<le> n;\n     vp K v\\<^bsup> Vr K v n\\<^esup> =\n     {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> n = \\<infinity>", "apply (simp add:r_apow_def, rule contrapos_pp, simp+,\n       frule apos_neq_minf[of \"n\"],\n       cut_tac mem_ant[of \"n\"], simp, erule exE, simp,\n       simp add:ant_0[THEN sym], thin_tac \"n = ant z\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; 0 \\<le> z;\n        vp K v\\<^bsup> Vr K v ant z\\<^esup> =\n        {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (case_tac \"z = 0\", simp add:ant_0, simp add:r_apow_def,\n       frule Vr_ring[of v],\n       frule Ring.ring_one[of \"Vr K v\"], simp,\n       simp add:Vr_0_f_0, simp add:Vr_1_f_1,\n       frule value_of_one[of v], simp, simp add:value_of_zero,\n       cut_tac n = z in zneq_aneq[of _ \"0\"], simp only:ant_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; 0 \\<le> z;\n        vp K v\\<^bsup> Vr K v ant z\\<^esup> =\n        {\\<zero>\\<^bsub>Vr K v\\<^esub>};\n        ant z \\<noteq> 0; (z \\<noteq> 0) = (\\<not> False)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:r_apow_def,\n       frule_tac n = \"na (ant z)\" in n_value_idealTr[of v],\n       simp add:na_def,\n       simp, thin_tac \"vp K v \\<^bsup>\\<diamondsuit>(Vr K v) (na (ant z))\\<^esup> = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\",\n       frule Vr_ring[of v],\n       frule  Pg_in_Vr[of v],\n       frule_tac n = \"na (ant z)\" in Ring.npClose[of \"Vr K v\" \"Pg K v\"],\n       assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; 0 \\<le> z;\n        Vr K v \\<diamondsuit>\\<^sub>p\n        (Pg K v^\\<^bsup>Vr K v na (ant z)\\<^esup>) =\n        {\\<zero>\\<^bsub>Vr K v\\<^esub>};\n        z \\<noteq> 0; Ring (Vr K v); Pg K v \\<in> carrier (Vr K v);\n        Pg K v^\\<^bsup>Vr K v na (ant z)\\<^esup>\n        \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = \"(Pg K v)^\\<^bsup>(Vr K v) (na (ant z))\\<^esup>\" in\n                   Ring.a_in_principal[of \"Vr K v\"], assumption,\n       simp, frule Vr_integral[of \"v\"],\n       frule val_Pg[of v], simp, (erule conjE)+,\n       frule_tac n = \"na (ant z)\" in Idomain.idom_potent_nonzero[of \"Vr K v\"\n        \"Pg K v\"], assumption+,\n       simp add:Vr_0_f_0, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_potent_eqTr1:\"\\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n        (vp K v) \\<^bsup>(Vr K v) n\\<^esup> = (vp K v) \\<^bsup>(Vr K v) m\\<^esup>; m = 0\\<rbrakk>  \\<Longrightarrow>  n = m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n     vp K v\\<^bsup> Vr K v n\\<^esup> = vp K v\\<^bsup> Vr K v m\\<^esup>;\n     m = 0\\<rbrakk>\n    \\<Longrightarrow> n = m", "(*** compare the value of the generator of each ideal ***)\n(** express each ideal as a principal ideal **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n     vp K v\\<^bsup> Vr K v n\\<^esup> = vp K v\\<^bsup> Vr K v m\\<^esup>;\n     m = 0\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (frule Vr_ring[of v],\n       simp add:r_apow_def,\n       case_tac \"n = 0\", simp,\n       case_tac \"n = \\<infinity>\", simp,\n       frule val_Pg[of v], erule conjE, simp,\n       erule conjE,\n       rotate_tac -3, drule sym,\n       frule Lv_pos[of v], simp,\n       frule val_poss_mem_Vr[of v \"Pg K v\"], assumption+,\n       drule sym, simp, simp add:Vr_0_f_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n;\n     (if n = \\<infinity> then {\\<zero>\\<^bsub>Vr K v\\<^esub>}\n      else if n = 0 then carrier (Vr K v)\n           else vp K v \\<^bsup>\\<diamondsuit>Vr K v na n\\<^esup>) =\n     carrier (Vr K v);\n     m = 0; Ring (Vr K v); n \\<noteq> 0; n \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> n = 0", "apply (simp,\n       drule sym,\n       frule Ring.ring_one[of \"Vr K v\"], simp,\n\n       frule n_value_x_1_nat[of v \"1\\<^sub>r\\<^bsub>(Vr K v)\\<^esub>\" \"na n\"], assumption,\n       simp add:an_na, simp add:Vr_1_f_1,\n       frule n_val_valuation[of v],\n       simp add:value_of_one[of \"n_val K v\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_potent_eqTr2:\"\\<lbrakk>valuation K v;\n        (vp K v) \\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup> = (vp K v) \\<^bsup>\\<diamondsuit>(Vr K v) m\\<^esup>\\<rbrakk>  \\<Longrightarrow>   n = m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> n = m", "(** 1. express each ideal as a principal ideal **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (frule Vr_ring[of v],\n       frule val_Pg[of v], simp, (erule conjE)+,\n       rotate_tac -1, frule sym, thin_tac \"v (Pg K v) = Lv K v\",\n       frule Lv_pos[of v], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (subgoal_tac \"0 \\<le> int n\", subgoal_tac \"0 \\<le> int m\",\n       frule n_value_idealTr[of \"v\" \"m\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n;\n     0 \\<le> int m\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n; 0 \\<le> int m;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup> =\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v m\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> n = m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 4. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n; 0 \\<le> int m;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup> =\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v m\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> n = m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v);\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup> =\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v m\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> n = m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply(\n       thin_tac \"vp K v \\<^bsup>\\<diamondsuit>(Vr K v) m\\<^esup> = Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>(Vr K v) m\\<^esup>)\",\n       frule n_value_idealTr[of \"v\" \"n\"], simp, simp,\n       thin_tac \"vp K v \\<^bsup>\\<diamondsuit>(Vr K v) n\\<^esup> = Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>(Vr K v) m\\<^esup>)\",\n       frule val_poss_mem_Vr[of  \"v\" \"Pg K v\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v;\n     Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n     Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> n = m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "(** 2. the value of generators should coincide **)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v;\n     Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n     Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> n = m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply (frule Lv_z[of v], erule exE,\n        rotate_tac -4, drule sym, simp,\n        frule eq_ideal_eq_val[of \"v\" \"Pg K v^\\<^bsup>(Vr K v) n\\<^esup>\" \"Pg K v^\\<^bsup>(Vr K v) m\\<^esup>\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>0 < z; Pg K v \\<in> carrier (Vr K v); Lv K v = ant z;\n        valuation K v;\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n        Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n        v (Pg K v) = ant z\\<rbrakk>\n       \\<Longrightarrow> Pg K v^\\<^bsup>Vr K v n\\<^esup>\n                         \\<in> carrier (Vr K v)\n 2. \\<And>z.\n       \\<lbrakk>0 < z; Pg K v \\<in> carrier (Vr K v); Lv K v = ant z;\n        valuation K v;\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n        Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n        v (Pg K v) = ant z\\<rbrakk>\n       \\<Longrightarrow> Pg K v^\\<^bsup>Vr K v m\\<^esup>\n                         \\<in> carrier (Vr K v)\n 3. \\<And>z.\n       \\<lbrakk>0 < z; Pg K v \\<in> carrier (Vr K v); Lv K v = ant z;\n        valuation K v;\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n        Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n        v (Pg K v) = ant z\\<rbrakk>\n       \\<Longrightarrow> Vr K v \\<diamondsuit>\\<^sub>p\n                         (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n                         Vr K v \\<diamondsuit>\\<^sub>p\n                         (Pg K v^\\<^bsup>Vr K v m\\<^esup>)\n 4. \\<And>z.\n       \\<lbrakk>0 < z; Pg K v \\<in> carrier (Vr K v); Lv K v = ant z;\n        valuation K v;\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n        Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n        v (Pg K v) = ant z;\n        v (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n        v (Pg K v^\\<^bsup>Vr K v m\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> n = m\n 5. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 6. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply (rule Ring.npClose, assumption+, rule Ring.npClose, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>0 < z; Pg K v \\<in> carrier (Vr K v); Lv K v = ant z;\n        valuation K v;\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n        Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>Vr K v m\\<^esup>);\n        Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n        v (Pg K v) = ant z;\n        v (Pg K v^\\<^bsup>Vr K v n\\<^esup>) =\n        v (Pg K v^\\<^bsup>Vr K v m\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> n = m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply (simp only:Vr_exp_f_exp,\n        simp add:val_exp_ring[THEN sym, of v \"Pg K v\"],\n        thin_tac \"Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>K n\\<^esup>) = Vr K v \\<diamondsuit>\\<^sub>p (Pg K v^\\<^bsup>K m\\<^esup>)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>0 < z; Pg K v \\<in> carrier (Vr K v); Lv K v = ant z;\n        valuation K v; Ring (Vr K v); Pg K v \\<in> carrier K;\n        Pg K v \\<noteq> \\<zero>; v (Pg K v) = ant z;\n        int n *\\<^sub>a ant z = int m *\\<^sub>a ant z\\<rbrakk>\n       \\<Longrightarrow> n = m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply (case_tac \"n = 0\", simp, case_tac \"m = 0\", simp,\n       simp only:of_nat_0_less_iff[THEN sym, of \"m\"],\n       simp only:asprod_amult a_z_z,\n       simp only:ant_0[THEN sym], simp only:aeq_zeq, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>0 < z; Pg K v \\<in> carrier (Vr K v); Lv K v = ant z;\n        valuation K v; Ring (Vr K v); Pg K v \\<in> carrier K;\n        Pg K v \\<noteq> \\<zero>; v (Pg K v) = ant z;\n        int n *\\<^sub>a ant z = int m *\\<^sub>a ant z; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> n = m\n 2. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v); 0 \\<le> int n\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int m\n 3. \\<lbrakk>valuation K v;\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v n\\<^esup> =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v m\\<^esup>;\n     Ring (Vr K v); Pg K v \\<in> carrier K; Pg K v \\<noteq> \\<zero>;\n     Lv K v = v (Pg K v); 0 < v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> int n", "apply (auto simp add: asprod_mult)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_potent_eq:\"\\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n              (vp K v) \\<^bsup>(Vr K v) n\\<^esup> = (vp K v) \\<^bsup>(Vr K v) m\\<^esup>\\<rbrakk> \\<Longrightarrow>  n = m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n     vp K v\\<^bsup> Vr K v n\\<^esup> =\n     vp K v\\<^bsup> Vr K v m\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (frule n_val_valuation[of v],\n       case_tac \"m = 0\",\n       simp add:Vr_potent_eqTr1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n     vp K v\\<^bsup> Vr K v n\\<^esup> = vp K v\\<^bsup> Vr K v m\\<^esup>;\n     valuation K (n_val K v); m \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (case_tac \"n = 0\",\n       frule sym, thin_tac \"vp K v\\<^bsup> (Vr K v) n\\<^esup> = vp K v\\<^bsup> (Vr K v) m\\<^esup>\",\n       frule Vr_potent_eqTr1[of v m n], assumption+,\n       rule sym, assumption,\n       frule vp_potent_zero[of  \"v\" \"n\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n     vp K v\\<^bsup> Vr K v n\\<^esup> = vp K v\\<^bsup> Vr K v m\\<^esup>;\n     valuation K (n_val K v); m \\<noteq> 0; n \\<noteq> 0;\n     (n = \\<infinity>) =\n     (vp K v\\<^bsup> Vr K v n\\<^esup> =\n      {\\<zero>\\<^bsub>Vr K v\\<^esub>})\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (case_tac \"n = \\<infinity>\", simp,\n       thin_tac \"vp K v\\<^bsup> (Vr K v) \\<infinity>\\<^esup> = {\\<zero>\\<^bsub>Vr K v\\<^esub>}\",\n       frule vp_potent_zero[THEN sym, of v m], assumption+, simp,\n       simp,\n       frule vp_potent_zero[THEN sym, of v \"m\"], assumption+, simp,\n       thin_tac \"vp K v\\<^bsup> (Vr K v) m\\<^esup> \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 \\<le> n; 0 \\<le> m;\n     vp K v\\<^bsup> Vr K v n\\<^esup> = vp K v\\<^bsup> Vr K v m\\<^esup>;\n     valuation K (n_val K v); m \\<noteq> 0; n \\<noteq> 0;\n     m \\<noteq> \\<infinity>; n \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> n = m", "apply (frule aposs_na_poss[of \"n\"], subst less_le, simp,\n       frule aposs_na_poss[of \"m\"], subst less_le, simp,\n       simp add:r_apow_def,\n       frule Vr_potent_eqTr2[of  \"v\" \"na n\" \"na m\"], assumption+,\n       thin_tac \"vp K v \\<^bsup>\\<diamondsuit>(Vr K v) (na n)\\<^esup> = vp K v \\<^bsup>\\<diamondsuit>(Vr K v) (na m)\\<^esup>\",\n       simp add:aeq_nat_eq[THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>the following two lemma (in Corps) s are used in completion of K\\<close>"], ["", "lemma (in Corps) Vr_prime_maximalTr1:\"\\<lbrakk>valuation K v; x \\<in> carrier (Vr K v);\n       Suc 0 < n\\<rbrakk>  \\<Longrightarrow> x \\<cdot>\\<^sub>r\\<^bsub>(Vr K v)\\<^esub> (x^\\<^bsup>K (n - Suc 0)\\<^esup>) \\<in> (Vr K v) \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n                      x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K n\\<^esup>)", "apply (frule Vr_ring[of v],\n       subgoal_tac \"x^\\<^bsup>K n\\<^esup> = x^\\<^bsup>K (Suc (n - Suc 0))\\<^esup>\",\n       simp del:Suc_pred,\n       rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v);\n     x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r x =\n     x^\\<^bsup>K n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n                      x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                             x)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> =\n                      x^\\<^bsup>K Suc (n - Suc 0)\\<^esup>", "apply (subst Vr_tOp_f_tOp, assumption+,\n       subst Vr_exp_f_exp[of v, THEN sym], assumption+,\n       simp only:Ring.npClose, simp del:Suc_pred)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v);\n     x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r x =\n     x^\\<^bsup>K n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K n\\<^esup>)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> =\n                      x^\\<^bsup>K Suc (n - Suc 0)\\<^esup>", "apply (cut_tac field_is_ring,\n       frule Ring.npClose[of K x \"n - Suc 0\"],\n       frule Vr_mem_f_mem[of v x], assumption+,\n       frule Vr_mem_f_mem[of v x], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v);\n     x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r x =\n     x^\\<^bsup>K n\\<^esup>;\n     Ring K; x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<in> carrier K;\n     x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K n\\<^esup>)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> =\n                      x^\\<^bsup>K Suc (n - Suc 0)\\<^esup>", "apply (simp add:Ring.ring_tOp_commute[of K x \"x^\\<^bsup>K (n - Suc 0)\\<^esup>\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v);\n     x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r x =\n     x^\\<^bsup>K n\\<^esup>;\n     Ring K; x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<in> carrier K;\n     x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K n\\<^esup>)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> =\n                      x^\\<^bsup>K Suc (n - Suc 0)\\<^esup>", "apply (rule Ring.a_in_principal, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v);\n     x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r x =\n     x^\\<^bsup>K n\\<^esup>;\n     Ring K; x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<in> carrier K;\n     x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> =\n                      x^\\<^bsup>K Suc (n - Suc 0)\\<^esup>", "apply (frule Ring.npClose[of \"Vr K v\" x n], assumption,\n        simp add:Vr_exp_f_exp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier (Vr K v); Suc 0 < n;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> =\n                      x^\\<^bsup>K Suc (n - Suc 0)\\<^esup>", "apply (simp only:Suc_pred)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vr_prime_maximalTr2:\"\\<lbrakk> valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>;\n  Suc 0 < n\\<rbrakk> \\<Longrightarrow> x \\<notin> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>) \\<and> x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<notin> (Vr K v) \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>;\n     Suc 0 < n\\<rbrakk>\n    \\<Longrightarrow> x \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                                 (x^\\<^bsup>K n\\<^esup>) \\<and>\n                      x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (frule Vr_ring[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                                 (x^\\<^bsup>K n\\<^esup>) \\<and>\n                      x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (frule vp_mem_Vr_mem[of v x], assumption,\n       frule Ring.npClose[of \"Vr K v\" x n],\n       simp only:Vr_exp_f_exp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                                 (x^\\<^bsup>K n\\<^esup>) \\<and>\n                      x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (cut_tac field_is_ring,\n       cut_tac field_is_idom,\n       frule Vr_mem_f_mem[of v x], assumption+,\n       frule Idomain.idom_potent_nonzero[of K x n], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                                 (x^\\<^bsup>K n\\<^esup>) \\<and>\n                      x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                                 (x^\\<^bsup>K n\\<^esup>)\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (frule val_Rxa_gt_a[of v \"x^\\<^bsup>K n\\<^esup>\" x],\n        simp, simp add:Vr_exp_f_exp, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     v (x^\\<^bsup>K n\\<^esup>) \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (simp add:val_exp_ring[THEN sym, of v x n])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     int n *\\<^sub>a v x \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (frule val_nonzero_z[of v x], assumption+, erule exE,\n        simp add:asprod_amult a_z_z)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>;\n        Suc 0 < n; Ring (Vr K v); x \\<in> carrier (Vr K v);\n        x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K;\n        Idomain K; x \\<in> carrier K;\n        x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n        x \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n        int n * z \\<le> z; v x = ant z\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (simp add:vp_mem_val_poss[of v x])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n                               (x^\\<^bsup>K n\\<^esup>)", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule val_Rxa_gt_a[of v \"x^\\<^bsup>K n\\<^esup>\" \"x^\\<^bsup>K (n - Suc 0)\\<^esup>\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup>\n                      \\<in> carrier (Vr K v) - {\\<zero>}\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<in> carrier (Vr K v)\n 3. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K n\\<^esup>)\n 4. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     v (x^\\<^bsup>K n\\<^esup>)\n     \\<le> v (x^\\<^bsup>K (n - Suc 0)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp, frule Ring.npClose[of \"Vr K v\" \"x\" \"n - Suc 0\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     x^\\<^bsup>Vr K v (n - Suc 0)\\<^esup> \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<in> carrier (Vr K v)\n 3. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K n\\<^esup>)\n 4. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     v (x^\\<^bsup>K n\\<^esup>)\n     \\<le> v (x^\\<^bsup>K (n - Suc 0)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:Vr_exp_f_exp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup> \\<in> carrier (Vr K v)\n 2. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K (n - Suc 0)\\<^esup>\n                      \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n                            (x^\\<^bsup>K n\\<^esup>)\n 3. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     v (x^\\<^bsup>K n\\<^esup>)\n     \\<le> v (x^\\<^bsup>K (n - Suc 0)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule Ring.npClose[of \"Vr K v\" \"x\" \"n - Suc 0\"], assumption+,\n        simp add:Vr_exp_f_exp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     v (x^\\<^bsup>K n\\<^esup>)\n     \\<le> v (x^\\<^bsup>K (n - Suc 0)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:val_exp_ring[THEN sym, of v x])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> vp K v; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     int n *\\<^sub>a v x \\<le> int (n - Suc 0) *\\<^sub>a v x\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:vp_mem_val_poss[of \"v\" \"x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; 0 < v x; x \\<noteq> \\<zero>; Suc 0 < n;\n     Ring (Vr K v); x \\<in> carrier (Vr K v);\n     x^\\<^bsup>Vr K v n\\<^esup> \\<in> carrier (Vr K v); Ring K; Idomain K;\n     x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>;\n     x^\\<^bsup>K (n - Suc 0)\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p (x^\\<^bsup>K n\\<^esup>);\n     int n *\\<^sub>a v x \\<le> int (n - Suc 0) *\\<^sub>a v x\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule val_nonzero_z[of  \"v\" \"x\"], assumption+, erule exE,\n        simp add:asprod_amult a_z_z)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Vring_prime_maximal:\"\\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n      I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk> \\<Longrightarrow> maximal_ideal (Vr K v) I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule Vr_ring[of v],\n       frule Ring.prime_ideal_proper[of \"Vr K v\" \"I\"], assumption+,\n       frule Ring.prime_ideal_ideal[of \"Vr K v\" \"I\"], assumption+,\n       frule ideal_pow_vp[of v I],\n       frule n_value_idealTr[of \"v\" \"na (n_val K v (Ig K v I))\"],\n                  simp, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v\n        \\<^bsup>\\<diamondsuit>Vr K\n                               v na (n_val K v (Ig K v I))\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (case_tac \"na (n_val K v (Ig K v I)) = 0\",\n       simp, frule Ring.Rxa_one[of \"Vr K v\"], simp,\n       frule Suc_leI[of \"0\" \"na (n_val K v (Ig K v I))\"],\n       thin_tac \"0 < na (n_val K v (Ig K v I))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Vr K v \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> =\n     carrier (Vr K v);\n     Suc 0 \\<le> na (n_val K v (Ig K v I))\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (case_tac \"na (n_val K v (Ig K v I)) = Suc 0\", simp,\n       frule Pg_in_Vr[of v])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v;\n     prime_ideal (Vr K v)\n      (vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n       carrier (Vr K v));\n     vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     carrier (Vr K v) \\<noteq>\n     {\\<zero>\\<^bsub>Vr K v\\<^esub>};\n     Ring (Vr K v);\n     vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     carrier (Vr K v) \\<noteq>\n     carrier (Vr K v);\n     ideal (Vr K v)\n      (vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n       carrier (Vr K v));\n     I =\n     vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub> carrier (Vr K v);\n     Vr K v \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> =\n     carrier (Vr K v);\n     na (n_val K v\n          (Ig K v\n            (vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n             carrier (Vr K v)))) =\n     Suc 0;\n     Pg K v \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v)\n                       (vp K v \\<diamondsuit>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n                        carrier (Vr K v))\n 2. \\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Vr K v \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> =\n     carrier (Vr K v);\n     Suc 0 \\<le> na (n_val K v (Ig K v I));\n     na (n_val K v (Ig K v I)) \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule vp_maximal[of v],\n       frule Ring.maximal_ideal_ideal[of \"Vr K v\" \"vp K v\"], assumption+,\n       subst Ring.idealprod_whole_r[of \"Vr K v\" \"vp K v\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Vr K v \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> =\n     carrier (Vr K v);\n     Suc 0 \\<le> na (n_val K v (Ig K v I));\n     na (n_val K v (Ig K v I)) \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (rotate_tac -1, drule not_sym,\n       frule le_neq_implies_less[of \"Suc 0\" \"na (n_val K v (Ig K v I))\"],\n       assumption+,\n       thin_tac \"Suc 0 \\<le> na (n_val K v (Ig K v I))\",\n       thin_tac \"Suc 0 \\<noteq> na (n_val K v (Ig K v I))\",\n       thin_tac \"Vr K v \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> = carrier (Vr K v)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Suc 0 < na (n_val K v (Ig K v I))\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule val_Pg[of v], simp, (erule conjE)+,\n       frule Lv_pos[of v], rotate_tac -2, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v)\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule val_poss_mem_Vr[of \"v\" \"Pg K v\"],\n        frule vp_mem_val_poss[THEN sym, of \"v\" \"Pg K v\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule Vr_prime_maximalTr2[of v \"Pg K v\"\n                            \"na (n_val K v (Ig K v I))\"],\n       simp add:vp_mem_val_poss[of v \"Pg K v\"], assumption+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v);\n     Pg K v\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule Ring.npMulDistr[of \"Vr K v\" \"Pg K v\" \"na 1\" \"na (n_val K v (Ig K v I)) - Suc 0\"], assumption+, simp add:na_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < v (Pg K v); valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Lv K v = v (Pg K v);\n     Pg K v \\<in> carrier (Vr K v);\n     Pg K v\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>Vr K v (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> =\n     Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (rotate_tac 8, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n     Pg K v\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>Vr K v (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> =\n     Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     0 < v (Pg K v); valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     v (Pg K v) = Lv K v\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule Ring.a_in_principal[of \"Vr K v\"\n         \"Pg K v^\\<^bsup>(Vr K v) (na (n_val K v (Ig K v I)))\\<^esup>\"], simp add:Ring.npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n     Pg K v\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>Vr K v (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> =\n     Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     0 < v (Pg K v); valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     v (Pg K v) = Lv K v;\n     Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n           (Pg K\n             v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (simp add:Vr_exp_f_exp[of \"v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n     Pg K v\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> =\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>;\n     0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     v (Pg K v) = Lv K v;\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n           (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (simp add:Ring.ring_l_one[of \"Vr K v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n     Pg K v\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> =\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>;\n     0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     v (Pg K v) = Lv K v;\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n           (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (frule n_value_idealTr[THEN sym,\n                       of v \"na (n_val K v (Ig K v I))\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n     Pg K v\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> Vr K v \\<diamondsuit>\\<^sub>p\n              (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> =\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>;\n     0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     v (Pg K v) = Lv K v;\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>\n     \\<in> Vr K v \\<diamondsuit>\\<^sub>p\n           (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>);\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>Vr K v na (n_val K v (Ig K v I))\\<^esup>) =\n     vp K v\n        \\<^bsup>\\<diamondsuit>Vr K\n                               v na (n_val K v (Ig K v I))\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (simp add:Vr_exp_f_exp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> =\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>;\n     0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     v (Pg K v) = Lv K v;\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup> \\<in> I;\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup>) =\n     I\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (rotate_tac 6, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     I \\<noteq> carrier (Vr K v); ideal (Vr K v) I;\n     I =\n     vp K v \\<^bsup>\\<diamondsuit>Vr K v na (n_val K v (Ig K v I))\\<^esup>;\n     v (Pg K v) = Lv K v;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I;\n     Vr K v \\<diamondsuit>\\<^sub>p\n     (Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n      Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>) =\n     I;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier K;\n     Pg K v \\<noteq> \\<zero>; Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I;\n     Pg K v^\\<^bsup>K na (n_val K v (Ig K v I))\\<^esup> =\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (thin_tac \"I \\<noteq> carrier (Vr K v)\",\n   thin_tac \"I = vp K v \\<^bsup>\\<diamondsuit>(Vr K v) (na (n_val K v (Ig K v I)))\\<^esup>\",\n   thin_tac \"v (Pg K v) = Lv K v\",\n thin_tac \"(Vr K v) \\<diamondsuit>\\<^sub>p ((Pg K v) \\<cdot>\\<^sub>r\\<^bsub>(Vr K v)\\<^esub>\n                   ((Pg K v)^\\<^bsup>K (na ((n_val K v) (Ig K v I)) - (Suc 0))\\<^esup>)) =\n    I\",\n   thin_tac \"Pg K v \\<in> carrier K\",\n   thin_tac \"Pg K v \\<noteq> \\<zero>\",\n   thin_tac \"Pg K v^\\<^bsup>K (na ((n_val K v) (Ig K v I)))\\<^esup> =\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> Pg K v^\\<^bsup>K ((na ((n_val K v) (Ig K v I))) - Suc 0)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < Lv K v; valuation K v; prime_ideal (Vr K v) I;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     ideal (Vr K v) I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (simp add:prime_ideal_def, erule conjE,\n      drule_tac x = \"Pg K v\" in bspec, assumption,\n      drule_tac x = \"Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup> \" in bspec)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < Lv K v; valuation K v;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     ideal (Vr K v) I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I;\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> Pg K\n                       v^\\<^bsup>K (na (n_val K v (Ig K v I)) -\n                                    Suc 0)\\<^esup>\n                      \\<in> carrier (Vr K v)\n 2. \\<lbrakk>0 < Lv K v; valuation K v;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     ideal (Vr K v) I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I;\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I \\<longrightarrow>\n     Pg K v \\<in> I \\<or>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (simp add:Vr_exp_f_exp[THEN sym, of v])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < Lv K v; valuation K v;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     ideal (Vr K v) I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>Vr K v (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>Vr K v (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I;\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> Pg K\n                       v^\\<^bsup>Vr K\n                                  v (na (n_val K v (Ig K v I)) -\n                                     Suc 0)\\<^esup>\n                      \\<in> carrier (Vr K v)\n 2. \\<lbrakk>0 < Lv K v; valuation K v;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     ideal (Vr K v) I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I;\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I \\<longrightarrow>\n     Pg K v \\<in> I \\<or>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply (rule Ring.npClose[of \"Vr K v\" \"Pg K v\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < Lv K v; valuation K v;\n     I \\<noteq> {\\<zero>\\<^bsub>Vr K v\\<^esub>}; Ring (Vr K v);\n     ideal (Vr K v) I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I;\n     Suc 0 < na (n_val K v (Ig K v I)); Pg K v \\<in> carrier (Vr K v);\n     Pg K v \\<notin> I;\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<notin> I;\n     1\\<^sub>r\\<^bsub>Vr K v\\<^esub> \\<notin> I;\n     Pg K v \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I \\<longrightarrow>\n     Pg K v \\<in> I \\<or>\n     Pg K v^\\<^bsup>K (na (n_val K v (Ig K v I)) - Suc 0)\\<^esup>\n     \\<in> I\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v) I", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>From the above lemma (in Corps) , we see that a valuation ring is of dimension one.\\<close>"], ["", "lemma (in Corps) field_frac1:\"\\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow> x = x \\<cdot>\\<^sub>r ((1\\<^sub>r)\\<^bsup>\\<hyphen>K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x =\n                      x \\<cdot>\\<^sub>r 1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup>", "by (simp add:invf_one,\n       cut_tac field_is_ring,\n       simp add:Ring.ring_r_one[THEN sym])"], ["", "lemma (in Corps) field_frac2:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x = (1\\<^sub>r) \\<cdot>\\<^sub>r ((x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsup>\\<hyphen>K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x =\n                      1\\<^sub>r \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>", "by (cut_tac field_is_ring, simp add:field_inv_inv,\n       simp add:Ring.ring_l_one[THEN sym])"], ["", "lemma (in Corps) val_nonpos_inv_pos:\"\\<lbrakk>valuation K v; x \\<in> carrier K;\n        \\<not> 0 \\<le> (v x)\\<rbrakk>  \\<Longrightarrow> 0 < (v (x\\<^bsup>\\<hyphen>K\\<^esup>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> 0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>)", "by (case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\", simp add:value_of_zero,\n       frule Vr_ring[of v],\n       simp add:aneg_le[of \"0\" \"v x\"],\n       frule value_of_inv[THEN sym, of v x], assumption+,\n       frule aless_minus[of \"v x\" \"0\"], simp)"], ["", "lemma (in Corps) frac_Vr_is_K:\"\\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk> \\<Longrightarrow>\n \\<exists>s\\<in>carrier (Vr K v). \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}. x = s \\<cdot>\\<^sub>r (t\\<^bsup>\\<hyphen>K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>carrier (Vr K v).\n                         \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}.\n                            x =\n                            s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>", "apply (frule Vr_ring[of v],\n       frule has_val_one_neq_zero[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; Ring (Vr K v);\n     1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>carrier (Vr K v).\n                         \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}.\n                            x =\n                            s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>", "apply (case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\",\n       frule Ring.ring_one[of \"Vr K v\"],\n       frule field_frac1[of x],\n       simp only:Vr_1_f_1, frule Ring.ring_zero[of \"Vr K v\"],\n       simp add:Vr_0_f_0 Vr_1_f_1, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; Ring (Vr K v);\n     1\\<^sub>r \\<noteq> \\<zero>; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>carrier (Vr K v).\n                         \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}.\n                            x =\n                            s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>", "apply (case_tac \"0 \\<le> (v x)\",\n       frule val_pos_mem_Vr[THEN sym, of v x], assumption+, simp,\n       frule field_frac1[of x], assumption+,\n       frule has_val_one_neq_zero[of v],\n       frule Ring.ring_one[of \"Vr K v\"], simp only:Vr_1_f_1, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; Ring (Vr K v);\n     1\\<^sub>r \\<noteq> \\<zero>; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>carrier (Vr K v).\n                         \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}.\n                            x =\n                            s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>", "apply (frule val_nonpos_inv_pos[of v x], assumption+,\n       cut_tac invf_inv[of x], erule conjE,\n       frule val_poss_mem_Vr[of v \"x\\<^bsup>\\<hyphen>K\\<^esup>\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; Ring (Vr K v);\n     1\\<^sub>r \\<noteq> \\<zero>; x \\<noteq> \\<zero>; \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>carrier (Vr K v).\n                         \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}.\n                            x =\n                            s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; Ring (Vr K v);\n     1\\<^sub>r \\<noteq> \\<zero>; x \\<noteq> \\<zero>; \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (frule Ring.ring_one[of \"Vr K v\"], simp only:Vr_1_f_1,\n       frule field_frac2[of x], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; Ring (Vr K v);\n     1\\<^sub>r \\<noteq> \\<zero>; x \\<noteq> \\<zero>; \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n     1\\<^sub>r \\<in> carrier (Vr K v);\n     x =\n     1\\<^sub>r \\<cdot>\\<^sub>r\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>s\\<in>carrier (Vr K v).\n                         \\<exists>t\\<in>carrier (Vr K v) - {\\<zero>}.\n                            x =\n                            s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; Ring (Vr K v);\n     1\\<^sub>r \\<noteq> \\<zero>; x \\<noteq> \\<zero>; \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (cut_tac invf_closed1[of x], blast, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) valuations_eqTr1:\"\\<lbrakk>valuation K v; valuation K v';\n Vr K v = Vr K v'; \\<forall>x\\<in>carrier (Vr K v). v x = v' x\\<rbrakk> \\<Longrightarrow> v = v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; Vr K v = Vr K v';\n     \\<forall>x\\<in>carrier (Vr K v). v x = v' x\\<rbrakk>\n    \\<Longrightarrow> v = v'", "apply (rule funcset_eq [of _  \"carrier K\"],\n       simp add:valuation_def, simp add:valuation_def,\n       rule ballI,\n       frule_tac x = x in frac_Vr_is_K[of v], assumption+,\n        (erule bexE)+, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x s t.\n       \\<lbrakk>valuation K v; valuation K v'; Vr K v = Vr K v';\n        \\<forall>x\\<in>carrier (Vr K v'). v x = v' x;\n        s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        s \\<in> carrier (Vr K v');\n        x = s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>;\n        t \\<in> carrier (Vr K v'); t \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> v (s \\<cdot>\\<^sub>r\n                            t\\<^bsup>\\<hyphen> K\\<^esup>) =\n                         v' (s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (frule_tac x = t in Vr_mem_f_mem[of v'], assumption,\n       cut_tac x = t in invf_closed1, simp, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x s t.\n       \\<lbrakk>valuation K v; valuation K v'; Vr K v = Vr K v';\n        \\<forall>x\\<in>carrier (Vr K v'). v x = v' x;\n        s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        s \\<in> carrier (Vr K v');\n        x = s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>;\n        t \\<in> carrier (Vr K v'); t \\<noteq> \\<zero>; t \\<in> carrier K;\n        t\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        t\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> v (s \\<cdot>\\<^sub>r\n                            t\\<^bsup>\\<hyphen> K\\<^esup>) =\n                         v' (s \\<cdot>\\<^sub>r t\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (frule_tac x = s in Vr_mem_f_mem[of \"v'\"], assumption+,\n       simp add:val_t2p, simp add:value_of_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) ridmap_rhom:\"\\<lbrakk> valuation K v; valuation K v';\n carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk> \\<Longrightarrow>\n      ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')", "apply (frule Vr_ring[of \"v\"], frule Vr_ring[of \"v'\"],\n       subst rHom_def, simp, rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ridmap (Vr K v) \\<in> aHom (Vr K v) (Vr K v')\n 2. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (Vr K v).\n                          \\<forall>y\\<in>carrier (Vr K v).\n                             ridmap (Vr K v)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y) =\n                             ridmap (Vr K v)\n                              x \\<cdot>\\<^sub>r\\<^bsub>Vr K v'\\<^esub>\n                             ridmap (Vr K v) y) \\<and>\n                      ridmap (Vr K v) 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> =\n                      1\\<^sub>r\\<^bsub>Vr K v'\\<^esub>", "apply (simp add:aHom_def, rule conjI,\n       rule Pi_I, simp add:ridmap_def subsetD,\n       simp add:ridmap_def restrict_def extensional_def,\n       (rule ballI)+,\n       frule Ring.ring_is_ag[of \"Vr K v\"], simp add:aGroup.ag_pOp_closed,\n        simp add:Vr_pOp_f_pOp subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (Vr K v).\n                          \\<forall>y\\<in>carrier (Vr K v).\n                             ridmap (Vr K v)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>Vr K v\\<^esub> y) =\n                             ridmap (Vr K v)\n                              x \\<cdot>\\<^sub>r\\<^bsub>Vr K v'\\<^esub>\n                             ridmap (Vr K v) y) \\<and>\n                      ridmap (Vr K v) 1\\<^sub>r\\<^bsub>Vr K v\\<^esub> =\n                      1\\<^sub>r\\<^bsub>Vr K v'\\<^esub>", "apply (rule conjI, (rule ballI)+, simp add:ridmap_def,\n       simp add:Ring.ring_tOp_closed, simp add:Vr_tOp_f_tOp subsetD,\n      frule Ring.ring_one[of \"Vr K v\"], frule Ring.ring_one[of \"Vr K v'\"],\n      simp add:Vr_1_f_1, simp add:ridmap_def )"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) contract_ideal:\"\\<lbrakk>valuation K v; valuation K v';\n                 carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk> \\<Longrightarrow>\n                       ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')", "apply (frule_tac ridmap_rhom[of \"v\" \"v'\"], assumption+,\n      frule Vr_ring[of \"v\"], frule Vr_ring[of \"v'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')", "apply (cut_tac TwoRings.i_contract_ideal[of \"Vr K v\" \"Vr K v'\"\n        \"ridmap (Vr K v)\" \"vp K v'\"],\n       subgoal_tac \"(i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v')\n                      (vp K v')) = (carrier (Vr K v) \\<inter> vp K v')\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v');\n     ideal (Vr K v)\n      (i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v') (vp K v'));\n     i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v') (vp K v') =\n     carrier (Vr K v) \\<inter> vp K v'\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\n 2. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v');\n     ideal (Vr K v)\n      (i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v') (vp K v'))\\<rbrakk>\n    \\<Longrightarrow> i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v')\n                       (vp K v') =\n                      carrier (Vr K v) \\<inter> vp K v'\n 3. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> TwoRings (Vr K v) (Vr K v')\n 4. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')\n 5. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v') (vp K v')", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v');\n     ideal (Vr K v)\n      (i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v') (vp K v'))\\<rbrakk>\n    \\<Longrightarrow> i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v')\n                       (vp K v') =\n                      carrier (Vr K v) \\<inter> vp K v'\n 2. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> TwoRings (Vr K v) (Vr K v')\n 3. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')\n 4. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v') (vp K v')", "apply(thin_tac \"ideal (Vr K v) (i_contract (ridmap (Vr K v))\n            (Vr K v) (Vr K v') (vp K v'))\",\n       simp add:i_contract_def invim_def ridmap_def, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> TwoRings (Vr K v) (Vr K v')\n 2. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')\n 3. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v') (vp K v')", "apply (simp add:TwoRings_def TwoRings_axioms_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ideal (Vr K v') (vp K v')", "apply (simp add:vp_ideal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) contract_prime:\"\\<lbrakk>valuation K v; valuation K v';\n      carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>  \\<Longrightarrow>\n      prime_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> prime_ideal (Vr K v)\n                       (carrier (Vr K v) \\<inter> vp K v')", "apply (frule_tac ridmap_rhom[of \"v\" \"v'\"], assumption+,\n     frule Vr_ring[of \"v\"],\n     frule Vr_ring[of \"v'\"],\n     cut_tac TwoRings.i_contract_prime[of \"Vr K v\" \"Vr K v'\" \"ridmap (Vr K v)\"\n        \"vp K v'\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v');\n     prime_ideal (Vr K v)\n      (i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v') (vp K v'))\\<rbrakk>\n    \\<Longrightarrow> prime_ideal (Vr K v)\n                       (carrier (Vr K v) \\<inter> vp K v')\n 2. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> TwoRings (Vr K v) (Vr K v')\n 3. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')\n 4. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> prime_ideal (Vr K v') (vp K v')", "apply (subgoal_tac \"(i_contract (ridmap (Vr K v)) (Vr K v) (Vr K v')\n          (vp K v')) = (carrier (Vr K v) \\<inter> vp K v')\",\n      simp,\n      thin_tac \"prime_ideal (Vr K v) (i_contract\n       (ridmap (Vr K v))  (Vr K  v) (Vr K v') (vp K v'))\",\n      simp add:i_contract_def invim_def ridmap_def, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> TwoRings (Vr K v) (Vr K v')\n 2. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v')\n 3. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> prime_ideal (Vr K v') (vp K v')", "apply (simp add:TwoRings_def TwoRings_axioms_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     ridmap (Vr K v) \\<in> rHom (Vr K v) (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> prime_ideal (Vr K v') (vp K v')", "apply (simp add:vp_prime)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(* \\<forall>x\\<in>carrier K. 0 \\<le> (v x) \\<longrightarrow> 0 \\<le> (v' x) *)"], ["", "lemma (in Corps) valuation_equivTr:\"\\<lbrakk>valuation K v; valuation K v';\n      x \\<in> carrier K;  0 < (v' x); carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n      \\<Longrightarrow> 0 \\<le> (v x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; x \\<in> carrier K; 0 < v' x;\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v x", "apply (rule contrapos_pp, simp+,\n       frule val_nonpos_inv_pos[of \"v\" \"x\"], assumption+,\n       case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\", simp add:value_of_zero[of \"v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; x \\<in> carrier K; 0 < v' x;\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>); x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (\n       cut_tac invf_closed1[of  \"x\"], simp, erule conjE,\n       frule aless_imp_le[of \"0\" \"v (x\\<^bsup>\\<hyphen>K\\<^esup>)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v'; x \\<in> carrier K; 0 < v' x;\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>); x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n     0 \\<le> v (x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; valuation K v'; x \\<in> carrier K; 0 < v' x;\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>); x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:val_pos_mem_Vr[of v \"x\\<^bsup>\\<hyphen>K\\<^esup>\"],\n      frule subsetD[of \"carrier (Vr K v)\" \"carrier (Vr K v')\" \"x\\<^bsup>\\<hyphen>K\\<^esup>\"],\n      assumption+,\n      frule val_pos_mem_Vr[THEN sym, of \"v'\" \"x\\<^bsup>\\<hyphen>K\\<^esup>\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v'; x \\<in> carrier K; 0 < v' x;\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>); x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v');\n     (x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v')) =\n     (0 \\<le> v' (x\\<^bsup>\\<hyphen> K\\<^esup>))\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>valuation K v; valuation K v'; x \\<in> carrier K; 0 < v' x;\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); \\<not> 0 \\<le> v x;\n     0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>); x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp, simp add:value_of_inv[of \"v'\" \"x\"],\n       cut_tac ale_minus[of \"0\" \"- v' x\"], thin_tac \"0 \\<le> - v' x\",\n       simp only:a_minus_minus,\n       cut_tac aneg_less[THEN sym, of \"v' x\" \"- 0\"], simp,\n       assumption, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) contract_maximal:\"\\<lbrakk>valuation K v; valuation K v';\n  carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk> \\<Longrightarrow>\n  maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal (Vr K v)\n                       (carrier (Vr K v) \\<inter> vp K v')", "apply (frule Vr_ring[of \"v\"],\n       frule Vr_ring[of \"v'\"],\n       rule Vring_prime_maximal, assumption+,\n       simp add:contract_prime)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> carrier (Vr K v) \\<inter> vp K v' \\<noteq>\n                      {\\<zero>\\<^bsub>Vr K v\\<^esub>}", "apply (frule vp_nonzero[of  \"v'\"],\n       frule vp_ideal[of  \"v'\"],\n       frule Ring.ideal_zero[of \"Vr K v'\" \"vp K v'\"], assumption+,\n       frule sets_not_eq[of \"vp K v'\" \"{\\<zero>\\<^bsub>(Vr K v')\\<^esub>}\"],\n       simp add: singleton_sub[of \"\\<zero>\\<^bsub>(Vr K v')\\<^esub>\" \"carrier (Vr K v')\"],\n       erule bexE, simp add:Vr_0_f_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n        Ring (Vr K v'); vp K v' \\<noteq> {\\<zero>};\n        ideal (Vr K v') (vp K v'); \\<zero> \\<in> vp K v'; a \\<in> vp K v';\n        a \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> carrier (Vr K v) \\<inter> vp K v' \\<noteq>\n                         {\\<zero>}", "apply (case_tac \"a \\<in> carrier (Vr K v)\", blast,\n       frule_tac x = a in vp_mem_Vr_mem[of \"v'\"], assumption+,\n       frule_tac x = a in Vr_mem_f_mem[of  \"v'\"], assumption+,\n       subgoal_tac \"a \\<in> carrier (Vr K v)\", blast,\n       frule_tac x1 = a in val_pos_mem_Vr[THEN sym, of \"v\"], assumption+,\n       simp, frule val_nonpos_inv_pos[of  \"v\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n        Ring (Vr K v'); vp K v' \\<noteq> {\\<zero>};\n        ideal (Vr K v') (vp K v'); \\<zero> \\<in> vp K v'; a \\<in> vp K v';\n        a \\<noteq> \\<zero>; \\<not> 0 \\<le> v a; a \\<in> carrier (Vr K v');\n        a \\<in> carrier K; a \\<notin> carrier (Vr K v);\n        0 < v (a\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac y = \"v (a\\<^bsup>\\<hyphen>K\\<^esup>)\" in aless_imp_le[of \"0\"],\n       cut_tac x = a in invf_closed1, simp,\n       frule_tac x = \"a\\<^bsup>\\<hyphen>K\\<^esup>\" in val_poss_mem_Vr[of v], simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n        Ring (Vr K v'); vp K v' \\<noteq> {\\<zero>};\n        ideal (Vr K v') (vp K v'); \\<zero> \\<in> vp K v'; a \\<in> vp K v';\n        a \\<noteq> \\<zero>; \\<not> 0 \\<le> v a; a \\<in> carrier (Vr K v');\n        a \\<in> carrier K; a \\<notin> carrier (Vr K v);\n        0 < v (a\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 \\<le> v (a\\<^bsup>\\<hyphen> K\\<^esup>);\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac c = \"a\\<^bsup>\\<hyphen>K\\<^esup>\" in subsetD[of \"carrier (Vr K v)\"\n        \"carrier (Vr K v')\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n        Ring (Vr K v'); vp K v' \\<noteq> {\\<zero>};\n        ideal (Vr K v') (vp K v'); \\<zero> \\<in> vp K v'; a \\<in> vp K v';\n        a \\<noteq> \\<zero>; \\<not> 0 \\<le> v a; a \\<in> carrier (Vr K v');\n        a \\<in> carrier K; a \\<notin> carrier (Vr K v);\n        0 < v (a\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 \\<le> v (a\\<^bsup>\\<hyphen> K\\<^esup>);\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v')\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n        frule_tac x = \"a\\<^bsup>\\<hyphen>K\\<^esup>\" in val_pos_mem_Vr[of \"v'\"],\n        simp, simp only:value_of_inv[of \"v'\"], simp,\n        simp add:value_of_inv[of  \"v'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v'); Ring (Vr K v);\n        Ring (Vr K v'); vp K v' \\<noteq> {\\<zero>};\n        ideal (Vr K v') (vp K v'); \\<zero> \\<in> vp K v'; a \\<in> vp K v';\n        a \\<noteq> \\<zero>; \\<not> 0 \\<le> v a; a \\<in> carrier (Vr K v');\n        a \\<in> carrier K; a \\<notin> carrier (Vr K v);\n        0 < v (a\\<^bsup>\\<hyphen> K\\<^esup>);\n        0 \\<le> v (a\\<^bsup>\\<hyphen> K\\<^esup>);\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v');\n        0 \\<le> - v' a\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac y = \"- v' a\" in ale_minus[of \"0\"], simp add:a_minus_minus,\n       frule_tac x = a in vp_mem_val_poss[of \"v'\"], assumption+,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Equivalent valuations\""], ["", "definition\n  v_equiv :: \"[_ , 'r \\<Rightarrow> ant, 'r \\<Rightarrow> ant] \\<Rightarrow> bool\" where\n  \"v_equiv K v1 v2 \\<longleftrightarrow> n_val K v1 = n_val K v2\""], ["", "lemma (in Corps) valuation_equivTr1:\"\\<lbrakk>valuation K v; valuation K v';\n \\<forall>x\\<in>carrier K. 0 \\<le> (v x) \\<longrightarrow> 0 \\<le> (v' x)\\<rbrakk> \\<Longrightarrow>\n                carrier (Vr K v) \\<subseteq> carrier (Vr K v')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K.\n        0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x\\<rbrakk>\n    \\<Longrightarrow> carrier (Vr K v) \\<subseteq> carrier (Vr K v')", "apply (frule Vr_ring[of  \"v\"],\n       frule Vr_ring[of  \"v'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> carrier (Vr K v) \\<subseteq> carrier (Vr K v')", "apply (rule subsetI,\n       case_tac \"x = \\<zero>\\<^bsub>K\\<^esub>\", simp, simp add:Vr_def Sr_def,\n       frule_tac x1 = x in val_pos_mem_Vr[THEN sym, of \"v\"],\n       frule_tac x = x in Vr_mem_f_mem[of \"v\"],\n       simp, frule_tac x = x in Vr_mem_f_mem[of \"v\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        \\<forall>x\\<in>carrier K.\n           0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n        Ring (Vr K v); Ring (Vr K v'); x \\<in> carrier (Vr K v);\n        x \\<noteq> \\<zero>;\n        (x \\<in> carrier (Vr K v)) = (0 \\<le> v x)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (Vr K v')", "apply (drule_tac x = x in bspec, simp add:Vr_mem_f_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v); x \\<noteq> \\<zero>;\n        (x \\<in> carrier (Vr K v)) = (0 \\<le> v x);\n        0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (Vr K v')", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v'; Ring (Vr K v);\n        Ring (Vr K v'); 0 \\<le> v x; x \\<noteq> \\<zero>;\n        x \\<in> carrier (Vr K v); 0 \\<le> v' x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (Vr K v')", "apply (subst val_pos_mem_Vr[THEN sym, of v'], assumption+,\n       simp add:Vr_mem_f_mem, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) valuation_equivTr2:\"\\<lbrakk>valuation K v; valuation K v';\n carrier (Vr K v) \\<subseteq> carrier (Vr K v'); vp K v = carrier (Vr K v) \\<inter> vp K v'\\<rbrakk>\n  \\<Longrightarrow>  carrier (Vr K v') \\<subseteq> carrier (Vr K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     vp K v = carrier (Vr K v) \\<inter> vp K v'\\<rbrakk>\n    \\<Longrightarrow> carrier (Vr K v') \\<subseteq> carrier (Vr K v)", "apply (frule Vr_ring[of \"v\"], frule Vr_ring[of \"v'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n     Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> carrier (Vr K v') \\<subseteq> carrier (Vr K v)", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v')\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (Vr K v)", "apply (case_tac \"x = \\<zero>\\<^bsub>(Vr K v')\\<^esub>\", simp,\n       subst Vr_0_f_0[of \"v'\"], assumption+,\n       subst Vr_0_f_0[of \"v\", THEN sym], assumption,\n       simp add:Ring.ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v');\n        x \\<noteq> \\<zero>\\<^bsub>Vr K v'\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (Vr K v)", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v');\n        x \\<noteq> \\<zero>\\<^bsub>Vr K v'\\<^esub>;\n        x \\<notin> carrier (Vr K v)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = x in Vr_mem_f_mem[of \"v'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v');\n        x \\<noteq> \\<zero>\\<^bsub>Vr K v'\\<^esub>;\n        x \\<notin> carrier (Vr K v); x \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:val_pos_mem_Vr[THEN sym, of \"v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v');\n        x \\<noteq> \\<zero>\\<^bsub>Vr K v'\\<^esub>; \\<not> 0 \\<le> v x;\n        x \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac y = \"v x\" in aneg_le[of \"0\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v');\n        x \\<noteq> \\<zero>\\<^bsub>Vr K v'\\<^esub>; v x < 0;\n        x \\<in> carrier K; \\<not> 0 \\<le> v x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:Vr_0_f_0[of \"v'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        v x < 0; x \\<in> carrier K; \\<not> 0 \\<le> v x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"v x\" in aless_minus[of _ \"0\"], simp,\n       thin_tac \"v x < 0\", thin_tac \"\\<not> 0 \\<le> v x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; 0 < - v x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:value_of_inv[THEN sym, of \"v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; 0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac x = x in invf_closed1, simp, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; 0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x1 = \"x\\<^bsup>\\<hyphen>K\\<^esup>\" in vp_mem_val_poss[THEN sym, of \"v\"],\n       assumption, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v'\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule vp_ideal [of \"v'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v')\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"x\\<^bsup>\\<hyphen>K\\<^esup>\" and r = x in Ring.ideal_ring_multiple[of \"Vr K v'\"\n       \"vp K v'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v');\n        x \\<cdot>\\<^sub>r\\<^bsub>Vr K v'\\<^esub>\n        x\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> vp K v'\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"x\\<^bsup>\\<hyphen>K\\<^esup>\" in vp_mem_Vr_mem[of \"v'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v');\n        x \\<cdot>\\<^sub>r\\<^bsub>Vr K v'\\<^esub>\n        x\\<^bsup>\\<hyphen> K\\<^esup>\n        \\<in> vp K v';\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v')\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = x and y = \"x\\<^bsup>\\<hyphen>K\\<^esup>\" in Ring.ring_tOp_commute[of \"Vr K v'\"],\n        assumption+, simp,\n        thin_tac \"x \\<cdot>\\<^sub>r\\<^bsub>Vr K v'\\<^esub> x\\<^bsup>\\<hyphen> K\\<^esup> = x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>Vr K v'\\<^esub> x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v');\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>Vr K v'\\<^esub>\n        x\n        \\<in> vp K v';\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v')\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:Vr_tOp_f_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v');\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x \\<in> vp K v';\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v')\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac x = x in  linvf, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v'); 1\\<^sub>r \\<in> vp K v';\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v');\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac field_is_ring, frule Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v'); 1\\<^sub>r \\<in> vp K v';\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v');\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x = 1\\<^sub>r; Ring K;\n        1\\<^sub>r \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule ideal_inc_elem0val_whole[of \"v'\" \"1\\<^sub>r\" \"vp K v'\"],\n        assumption+, simp add:value_of_one, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v';\n        carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n        vp K v = carrier (Vr K v) \\<inter> vp K v'; Ring (Vr K v);\n        Ring (Vr K v'); x \\<in> carrier (Vr K v'); x \\<noteq> \\<zero>;\n        x \\<in> carrier K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        0 < v (x\\<^bsup>\\<hyphen> K\\<^esup>);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v);\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> vp K v';\n        ideal (Vr K v') (vp K v'); 1\\<^sub>r \\<in> vp K v';\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier (Vr K v');\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x = 1\\<^sub>r; Ring K;\n        1\\<^sub>r \\<in> carrier K; vp K v' = carrier (Vr K v')\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule vp_not_whole[of \"v'\"], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) eq_carr_eq_Vring:\" \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) = carrier (Vr K v')\\<rbrakk> \\<Longrightarrow> Vr K v = Vr K v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     carrier (Vr K v) = carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> Vr K v = Vr K v'", "apply (simp add:Vr_def Sr_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) valuations_equiv:\"\\<lbrakk>valuation K v; valuation K v';\n    \\<forall>x\\<in>carrier K. 0 \\<le> (v x) \\<longrightarrow> 0 \\<le> (v' x)\\<rbrakk>  \\<Longrightarrow> v_equiv K v v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K.\n        0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "(** step0. preliminaries. **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K.\n        0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (frule Vr_ring[of \"v\"], frule Vr_ring[of \"v'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "(** step1.  show carrier (Vr K v) \\<subseteq> carrier (Vr K v') **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (frule valuation_equivTr1[of \"v\" \"v'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "(** step2.  maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> (vp K v')).\n    contract of the maximal ideal is prime, and a prime is maximal **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (frule contract_maximal [of \"v\" \"v'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "(** step3. Vring is a local ring, we have (vp K v) =\n    (carrier (Vr K v) \\<inter> (vp  K v')) **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (frule Vr_local[of \"v\" \"(carrier (Vr K v) \\<inter> vp K v')\"],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v');\n     vp K v = carrier (Vr K v) \\<inter> vp K v'\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "(** step4. show  carrier (Vr K v') \\<subseteq> carrier (Vr K v) **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     carrier (Vr K v) \\<subseteq> carrier (Vr K v');\n     maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v');\n     vp K v = carrier (Vr K v) \\<inter> vp K v'\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (frule valuation_equivTr2[of \"v\" \"v'\"], assumption+,\n        frule equalityI[of \"carrier (Vr K v)\" \"carrier (Vr K v')\"],\n                                          assumption+,\n        thin_tac \"carrier (Vr K v) \\<subseteq> carrier (Vr K v')\",\n        thin_tac \"carrier (Vr K v') \\<subseteq> carrier (Vr K v)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v');\n     vp K v = carrier (Vr K v) \\<inter> vp K v';\n     carrier (Vr K v) = carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "(** step5. vp K v' = vp K v **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v';\n     \\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x;\n     Ring (Vr K v); Ring (Vr K v');\n     maximal_ideal (Vr K v) (carrier (Vr K v) \\<inter> vp K v');\n     vp K v = carrier (Vr K v) \\<inter> vp K v';\n     carrier (Vr K v) = carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (frule vp_ideal[of \"v'\"],\n        frule Ring.ideal_subset1[of \"Vr K v'\" \"vp K v'\"], assumption,\n        simp add:Int_absorb1,\n        thin_tac \"\\<forall>x\\<in>carrier K. 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x\",\n        thin_tac \"vp K v' \\<subseteq> carrier (Vr K v')\",\n        thin_tac \"ideal (Vr K v') (vp K v')\",\n        thin_tac \"maximal_ideal (Vr K v) (vp K v')\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; Ring (Vr K v); Ring (Vr K v');\n     vp K v = vp K v'; carrier (Vr K v) = carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "(** step6. to show v_equiv K v v', we check whether the normal valuations\n    derived from the valuations have the same value or not. if (Vr K\n(n_valuation K v)) = (Vr K (n_valuation K v')), then we have only to\ncheck the values of the elements in this valuation ring.\nWe see (Vr K v) = (Vr K  (n_valuation K G a i v)). **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; Ring (Vr K v); Ring (Vr K v');\n     vp K v = vp K v'; carrier (Vr K v) = carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (simp add:v_equiv_def,\n       rule valuations_eqTr1[of  \"n_val K v\" \"n_val K v'\"],\n       (simp add:n_val_valuation)+,\n       rule eq_carr_eq_Vring[of  \"n_val K v\" \"n_val K v'\"],\n       (simp add:n_val_valuation)+,\n       subst Vr_n_val_Vr[THEN sym, of \"v\"], assumption+,\n       subst Vr_n_val_Vr[THEN sym, of \"v'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; Ring (Vr K v); Ring (Vr K v');\n     vp K v = vp K v'; carrier (Vr K v) = carrier (Vr K v')\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier (Vr K (n_val K v)).\n                         n_val K v x = n_val K v' x", "apply (rule ballI,\n       frule n_val_valuation[of \"v\"],\n       frule n_val_valuation[of \"v'\"],\n       frule_tac x1 = x in val_pos_mem_Vr[THEN sym, of \"n_val K v\"],\n       simp add:Vr_mem_f_mem, simp,\n       frule Vr_n_val_Vr[THEN sym, of \"v\"], simp,\n       thin_tac \"carrier (Vr K (n_val K v)) = carrier (Vr K v')\",\n       frule_tac x1 = x in val_pos_mem_Vr[THEN sym, of \"v'\"],\n                            simp add:Vr_mem_f_mem,\n       simp,\n       frule_tac x = x in val_pos_n_val_pos[of \"v'\"],\n       simp add:Vr_mem_f_mem, simp,\n       frule_tac x = x in ideal_apow_n_val[of \"v\"],\n       simp add:Vr_n_val_Vr[THEN sym, of \"v\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v'; Ring (Vr K v);\n        Ring (Vr K v'); vp K v = vp K v';\n        carrier (Vr K v) = carrier (Vr K v'); 0 \\<le> n_val K v x;\n        valuation K (n_val K v); valuation K (n_val K v');\n        0 \\<le> n_val K v' x; x \\<in> carrier (Vr K v'); 0 \\<le> v' x;\n        Vr K v \\<diamondsuit>\\<^sub>p x =\n        vp K v'\\<^bsup> Vr K v n_val K v x\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> n_val K v x = n_val K v' x", "apply (frule eq_carr_eq_Vring[of \"v\" \"v'\"], assumption+,\n       frule_tac x = x in ideal_apow_n_val[of \"v'\"], assumption,\n       simp add:Vr_n_val_Vr[THEN sym, of \"v\"],\n       thin_tac \"Vr K v' \\<diamondsuit>\\<^sub>p x = vp K v'\\<^bsup> (Vr K v') (n_val K v x)\\<^esup>\",\n       frule_tac n = \"n_val K v' x\" and m = \"n_val K v x\" in\n                        Vr_potent_eq[of  \"v'\"], assumption+,\n       frule sym, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_equiv_axiom1:\"valuation K v \\<Longrightarrow> v_equiv K v v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> v_equiv K v v", "apply (simp add:v_equiv_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_equiv_axiom2:\"\\<lbrakk> valuation K v; valuation K v';\n      v_equiv K v v'\\<rbrakk> \\<Longrightarrow> v_equiv K v' v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; v_equiv K v v'\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v' v", "apply (simp add:v_equiv_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_equiv_axiom3:\"\\<lbrakk> valuation K v; valuation K v';\n valuation K v'; v_equiv K v v'; v_equiv K v' v''\\<rbrakk> \\<Longrightarrow>  v_equiv K v v''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; valuation K v'; v_equiv K v v';\n     v_equiv K v' v''\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v''", "apply (simp add:v_equiv_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_equiv_val:\"\\<lbrakk> valuation K v\\<rbrakk> \\<Longrightarrow>\n                               v_equiv K v (n_val K v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> v_equiv K v (n_val K v)", "apply (frule valuations_equiv[of \"v\" \"n_val K v\"], simp add:n_val_valuation)"], ["proof (prove)\ngoal (2 subgoals):\n 1. valuation K v \\<Longrightarrow>\n    \\<forall>x\\<in>carrier K.\n       0 \\<le> v x \\<longrightarrow> 0 \\<le> n_val K v x\n 2. \\<lbrakk>valuation K v; v_equiv K v (n_val K v)\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v (n_val K v)", "apply (rule ballI, rule impI, simp add:val_pos_n_val_pos,\n       assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Prime divisors\""], ["", "definition\n  prime_divisor :: \"[_, 'b \\<Rightarrow> ant] \\<Rightarrow>\n        ('b \\<Rightarrow> ant) set\"  (\"(2P\\<^bsub> _ _\\<^esub>)\" [96,97]96) where\n \"P\\<^bsub>K v\\<^esub> = {v'. valuation K v' \\<and> v_equiv K v v'}\""], ["", "definition\n  prime_divisors :: \"_ \\<Rightarrow> ('b \\<Rightarrow> ant) set set\" (\"Pds\\<index>\" 96) where\n  \"Pds\\<^bsub>K\\<^esub> = {P. \\<exists>v. valuation K v \\<and> P = P\\<^bsub> K v\\<^esub> }\""], ["", "definition\n  normal_valuation_belonging_to_prime_divisor ::\n    \"[_ ,  ('b \\<Rightarrow> ant) set] \\<Rightarrow> ('b \\<Rightarrow> ant)\"  (\"(\\<nu>\\<^bsub>_ _\\<^esub>)\" [96,97]96) where\n  \"\\<nu>\\<^bsub>K P\\<^esub> = n_val K (SOME v. v \\<in> P)\""], ["", "lemma (in Corps) val_in_P_valuation:\"\\<lbrakk>valuation K v; v' \\<in> P\\<^bsub>K v\\<^esub>\\<rbrakk> \\<Longrightarrow>\n       valuation K v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v' \\<in> P\\<^bsub> K v\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> valuation K v'", "apply (simp add:prime_divisor_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vals_in_P_equiv:\"\\<lbrakk> valuation K v; v' \\<in> P\\<^bsub>K v\\<^esub>\\<rbrakk> \\<Longrightarrow>\n       v_equiv K v v'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v' \\<in> P\\<^bsub> K v\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (simp add:prime_divisor_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) v_in_prime_v:\"valuation K v \\<Longrightarrow> v \\<in> P\\<^bsub>K v\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow> v \\<in> P\\<^bsub> K v\\<^esub>", "apply (simp add:prime_divisor_def,\n       frule val_equiv_axiom1[of \"v\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) some_in_prime_divisor:\"valuation K v \\<Longrightarrow>\n             (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>) \\<in>  P\\<^bsub>K v\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>", "apply (subgoal_tac \"P\\<^bsub> K v\\<^esub> \\<noteq> {}\",\n       rule nonempty_some[of \"P\\<^bsub> K v\\<^esub>\"], assumption+,\n       frule v_in_prime_v[of \"v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; v \\<in> P\\<^bsub> K v\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P\\<^bsub> K v\\<^esub> \\<noteq> {}", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) valuation_some_in_prime_divisor:\"valuation K v\n          \\<Longrightarrow>  valuation K (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    valuation K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)", "apply (frule some_in_prime_divisor[of \"v\"],\n       simp add:prime_divisor_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) valuation_some_in_prime_divisor1:\"P \\<in> Pds  \\<Longrightarrow>\n                  valuation K (SOME w. w \\<in> P)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<in> Pds \\<Longrightarrow> valuation K (SOME w. w \\<in> P)", "apply (simp add:prime_divisors_def, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v.\n       valuation K v \\<and> P = P\\<^bsub> K v\\<^esub> \\<Longrightarrow>\n       valuation K (SOME w. w \\<in> P)", "apply (simp add:valuation_some_in_prime_divisor)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) representative_of_pd_valuation:\n           \"P \\<in> Pds \\<Longrightarrow> valuation K (\\<nu>\\<^bsub>K P\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<in> Pds \\<Longrightarrow> valuation K (\\<nu>\\<^bsub>K P\\<^esub>)", "apply (simp add:prime_divisors_def,\n       erule exE, erule conjE,\n       simp add:normal_valuation_belonging_to_prime_divisor_def,\n       frule_tac v = v in valuation_some_in_prime_divisor)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v.\n       \\<lbrakk>valuation K v; P = P\\<^bsub> K v\\<^esub>;\n        valuation K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> valuation K\n                          (n_val K\n                            (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>))", "apply (rule n_val_valuation, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) some_in_P_equiv:\"valuation K v \\<Longrightarrow>\n                  v_equiv K v (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. valuation K v \\<Longrightarrow>\n    v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)", "apply (frule some_in_prime_divisor[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v;\n     (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n     \\<in> P\\<^bsub> K v\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)", "apply (rule vals_in_P_equiv, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_n_val1:\"P \\<in> Pds  \\<Longrightarrow> n_val K (\\<nu>\\<^bsub>K P\\<^esub>) = (\\<nu>\\<^bsub>K P\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<in> Pds \\<Longrightarrow>\n    n_val K (\\<nu>\\<^bsub>K P\\<^esub>) = \\<nu>\\<^bsub>K P\\<^esub>", "apply (simp add: normal_valuation_belonging_to_prime_divisor_def,\n       frule valuation_some_in_prime_divisor1[of P])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>P \\<in> Pds; valuation K (SOME w. w \\<in> P)\\<rbrakk>\n    \\<Longrightarrow> n_val K (n_val K (SOME v. v \\<in> P)) =\n                      n_val K (SOME v. v \\<in> P)", "apply (rule n_val_n_val[of \"SOME v. v \\<in> P\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) P_eq_val_equiv:\"\\<lbrakk>valuation K v; valuation K v'\\<rbrakk> \\<Longrightarrow>\n        (v_equiv K v v') = (P\\<^bsub>K v\\<^esub> =  P\\<^bsub>K v'\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v' =\n                      (P\\<^bsub> K v\\<^esub> = P\\<^bsub> K v'\\<^esub>)", "apply (rule iffI,\n       rule equalityI,\n       rule subsetI, simp add:prime_divisor_def, erule conjE,\n       frule val_equiv_axiom2[of \"v\" \"v'\"], assumption+,\n       rule val_equiv_axiom3[of \"v'\" \"v\"], assumption+,\n       rule subsetI, simp add:prime_divisor_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v'; v_equiv K v v';\n        valuation K x; v_equiv K v' x\\<rbrakk>\n       \\<Longrightarrow> v_equiv K v x\n 2. \\<lbrakk>valuation K v; valuation K v';\n     P\\<^bsub> K v\\<^esub> = P\\<^bsub> K v'\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> v_equiv K v v'", "apply (rule val_equiv_axiom3[of \"v\" \"v'\"], assumption+,\n       frule v_in_prime_v[of  \"v\"], simp,\n       thin_tac \"P\\<^bsub>K v\\<^esub> = P\\<^bsub>K v'\\<^esub>\",\n       simp add:prime_divisor_def,\n       rule val_equiv_axiom2[of \"v'\" \"v\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) unique_n_valuation:\"\\<lbrakk> P \\<in> Pds\\<^bsub>K\\<^esub>; P' \\<in> Pds\\<rbrakk> \\<Longrightarrow>\n                (P = P') =  (\\<nu>\\<^bsub>K P\\<^esub> = \\<nu>\\<^bsub>K P'\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds\\<rbrakk>\n    \\<Longrightarrow> (P = P') =\n                      (\\<nu>\\<^bsub>K P\\<^esub> = \\<nu>\\<^bsub>K P'\\<^esub>)", "apply (rule iffI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds;\n     \\<nu>\\<^bsub>K P\\<^esub> = \\<nu>\\<^bsub>K P'\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P = P'", "apply (simp add:prime_divisors_def,\n       (erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v va.\n       \\<lbrakk>\\<nu>\\<^bsub>K P\\<^esub> = \\<nu>\\<^bsub>K P'\\<^esub>;\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> P = P'", "apply (simp add:normal_valuation_belonging_to_prime_divisor_def,\n       frule_tac v = v in some_in_P_equiv,\n       frule_tac v = va in some_in_P_equiv,\n       subgoal_tac \"v_equiv K (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>) (SOME w. w \\<in> P\\<^bsub>K va\\<^esub>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> P\\<^bsub> K v\\<^esub> = P\\<^bsub> K va\\<^esub>\n 2. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n                          (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)", "apply (frule_tac v = v in some_in_prime_divisor,\n       frule_tac v = va in some_in_prime_divisor,\n       frule_tac v = v and v' = \"SOME w. w \\<in> P\\<^bsub>K v\\<^esub>\" and v'' =\n       \"SOME w. w \\<in> P\\<^bsub>K va\\<^esub>\" in val_equiv_axiom3)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>;\n        (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n        \\<in> P\\<^bsub> K va\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> valuation K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n 2. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>;\n        (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n        \\<in> P\\<^bsub> K va\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> valuation K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n 3. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>;\n        (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n        \\<in> P\\<^bsub> K va\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n 4. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>;\n        (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n        \\<in> P\\<^bsub> K va\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n                          (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n 5. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>;\n        (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n        \\<in> P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> P\\<^bsub> K v\\<^esub> = P\\<^bsub> K va\\<^esub>\n 6. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n                          (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)", "apply (simp add:prime_divisor_def,\n       simp add:prime_divisor_def, assumption+,\n       frule_tac v = va and v' = \"SOME w. w \\<in> P\\<^bsub>K va\\<^esub>\" in\n                      val_equiv_axiom2,\n       simp add:prime_divisor_def, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>;\n        (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n        \\<in> P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>) va\\<rbrakk>\n       \\<Longrightarrow> P\\<^bsub> K v\\<^esub> = P\\<^bsub> K va\\<^esub>\n 2. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n                          (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)", "apply (frule_tac v = v and v' = \"SOME w. w \\<in> P\\<^bsub>K va\\<^esub>\" and v'' = va in\n       val_equiv_axiom3,\n      simp add:prime_divisor_def,\n      simp add:prime_divisor_def, assumption+,\n      frule_tac v = v and v' = va in P_eq_val_equiv, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n         (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>) \\<in> P\\<^bsub> K v\\<^esub>;\n        (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\n        \\<in> P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>);\n        v_equiv K (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>) va;\n        v_equiv K v va;\n        v_equiv K v va =\n        (P\\<^bsub> K v\\<^esub> = P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> P\\<^bsub> K v\\<^esub> = P\\<^bsub> K va\\<^esub>\n 2. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n                          (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>v va.\n       \\<lbrakk>n_val K (SOME va. va \\<in> P\\<^bsub> K v\\<^esub>) =\n                n_val K (SOME v. v \\<in> P\\<^bsub> K va\\<^esub>);\n        valuation K v; P = P\\<^bsub> K v\\<^esub>; valuation K va;\n        P' = P\\<^bsub> K va\\<^esub>;\n        v_equiv K v (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>);\n        v_equiv K va (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> v_equiv K (SOME w. w \\<in> P\\<^bsub> K v\\<^esub>)\n                          (SOME w. w \\<in> P\\<^bsub> K va\\<^esub>)", "apply (simp add:v_equiv_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) n_val_representative:\"P \\<in> Pds \\<Longrightarrow>  (\\<nu>\\<^bsub>K P\\<^esub>) \\<in> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P \\<in> Pds \\<Longrightarrow> \\<nu>\\<^bsub>K P\\<^esub> \\<in> P", "apply (simp add:prime_divisors_def,\n       erule exE, erule conjE,\n       simp add:normal_valuation_belonging_to_prime_divisor_def,\n       frule_tac v = v in valuation_some_in_prime_divisor,\n       frule_tac v = \"SOME w. w \\<in> P\\<^bsub>K v\\<^esub>\" in\n           n_val_equiv_val,\n       frule_tac v = v in some_in_P_equiv,\n       frule_tac v = v and v' = \"SOME w. w \\<in> P\\<^bsub> K v\\<^esub>\" and v'' =\n        \"n_val K (SOME w. w \\<in> P\\<^bsub>K v\\<^esub>)\" in val_equiv_axiom3,\n       assumption+,\n       frule_tac v = v in n_val_valuation,\n       simp add:prime_divisor_def, simp add:n_val_valuation)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_equiv_eq_pdiv:\"\\<lbrakk> P \\<in> Pds\\<^bsub>K\\<^esub>; P'\\<in> Pds\\<^bsub>K\\<^esub>; valuation K v;\n         valuation K v'; v_equiv K v v'; v \\<in> P; v' \\<in> P' \\<rbrakk> \\<Longrightarrow>  P = P'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds; valuation K v; valuation K v';\n     v_equiv K v v'; v \\<in> P; v' \\<in> P'\\<rbrakk>\n    \\<Longrightarrow> P = P'", "apply (simp add:prime_divisors_def,\n       (erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>va vaa.\n       \\<lbrakk>valuation K v; valuation K v'; v_equiv K v v'; v \\<in> P;\n        v' \\<in> P'; valuation K va; P = P\\<^bsub> K va\\<^esub>;\n        valuation K vaa; P' = P\\<^bsub> K vaa\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> P = P'", "apply (rename_tac w w',\n       frule_tac v = w in vals_in_P_equiv[of _ \"v\"], simp,\n       frule_tac v = w' in vals_in_P_equiv[of _ \"v'\"], simp,\n       frule_tac v = w and v' = v and  v'' = v' in val_equiv_axiom3,\n       assumption+,\n       frule_tac v = w' in val_equiv_axiom2[of _ \"v'\"], assumption+,\n       frule_tac v = w and v' = v' and  v'' = w' in val_equiv_axiom3,\n          assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w w'.\n       \\<lbrakk>valuation K v; valuation K v'; v_equiv K v v'; v \\<in> P;\n        v' \\<in> P'; valuation K w; P = P\\<^bsub> K w\\<^esub>;\n        valuation K w'; P' = P\\<^bsub> K w'\\<^esub>; v_equiv K w v;\n        v_equiv K w' v'; v_equiv K w v'; v_equiv K v' w';\n        v_equiv K w w'\\<rbrakk>\n       \\<Longrightarrow> P = P'", "apply simp+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w w'.\n       \\<lbrakk>valuation K v; valuation K v'; v_equiv K v v';\n        v \\<in> P\\<^bsub> K w\\<^esub>; v' \\<in> P\\<^bsub> K w'\\<^esub>;\n        valuation K w; P = P\\<^bsub> K w\\<^esub>; valuation K w';\n        P' = P\\<^bsub> K w'\\<^esub>; v_equiv K w v; v_equiv K w' v';\n        v_equiv K w v'; v_equiv K v' w'; v_equiv K w w'\\<rbrakk>\n       \\<Longrightarrow> P\\<^bsub> K w\\<^esub> = P\\<^bsub> K w'\\<^esub>", "apply (simp add:P_eq_val_equiv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) distinct_p_divisors:\"\\<lbrakk> P \\<in> Pds\\<^bsub>K\\<^esub>; P' \\<in> Pds\\<^bsub>K\\<^esub>\\<rbrakk> \\<Longrightarrow>\n          (\\<not> P = P') =  (\\<not> v_equiv K (\\<nu>\\<^bsub>K P\\<^esub>) (\\<nu>\\<^bsub>K P'\\<^esub>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds\\<rbrakk>\n    \\<Longrightarrow> (P \\<noteq> P') =\n                      (\\<not> v_equiv K (\\<nu>\\<^bsub>K P\\<^esub>)\n                               (\\<nu>\\<^bsub>K P'\\<^esub>))", "apply (rule iffI,\n       rule contrapos_pp, simp+,\n       frule val_equiv_eq_pdiv[of \"P\" \"P'\" \"\\<nu>\\<^bsub>K P\\<^esub>\" \"\\<nu>\\<^bsub>K P'\\<^esub>\"], assumption+,\n       simp add: representative_of_pd_valuation,\n       simp add: representative_of_pd_valuation, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds; P \\<noteq> P';\n     v_equiv K (\\<nu>\\<^bsub>K P\\<^esub>)\n      (\\<nu>\\<^bsub>K P'\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<nu>\\<^bsub>K P\\<^esub> \\<in> P\n 2. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds; P \\<noteq> P';\n     v_equiv K (\\<nu>\\<^bsub>K P\\<^esub>)\n      (\\<nu>\\<^bsub>K P'\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<nu>\\<^bsub>K P'\\<^esub> \\<in> P'\n 3. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds; P \\<noteq> P';\n     v_equiv K (\\<nu>\\<^bsub>K P\\<^esub>) (\\<nu>\\<^bsub>K P'\\<^esub>);\n     P = P'\\<rbrakk>\n    \\<Longrightarrow> False\n 4. \\<lbrakk>P \\<in> Pds; P' \\<in> Pds;\n     \\<not> v_equiv K (\\<nu>\\<^bsub>K P\\<^esub>)\n             (\\<nu>\\<^bsub>K P'\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> P \\<noteq> P'", "apply (rule n_val_representative[of \"P\"], assumption,\n       rule n_val_representative[of \"P'\"], assumption,\n       simp,\n       rule contrapos_pp, simp+, frule sym, thin_tac \"P = P'\",\n       simp,\n       frule representative_of_pd_valuation[of P],\n       frule val_equiv_axiom1[of \"\\<nu>\\<^bsub>K P\\<^esub>\"], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Approximation\""], ["", "definition\n  valuations :: \"[_ , nat, nat \\<Rightarrow> ('r \\<Rightarrow> ant)] \\<Rightarrow> bool\" where\n  \"valuations K n vv \\<longleftrightarrow> (\\<forall>j \\<le> n. valuation K (vv j))\""], ["", "definition\n  vals_nonequiv :: \"[_, nat, nat \\<Rightarrow> ('r \\<Rightarrow> ant)] \\<Rightarrow> bool\" where\n  \"vals_nonequiv K n vv \\<longleftrightarrow> valuations K n vv \\<and>\n  (\\<forall>j\\<le>n. \\<forall>l \\<le> n. j \\<noteq> l \\<longrightarrow> \\<not> (v_equiv K (vv j) (vv l)))\""], ["", "definition\n  Ostrowski_elem :: \"[_, nat, nat \\<Rightarrow> ('b \\<Rightarrow> ant), 'b] \\<Rightarrow> bool\" where\n  \"Ostrowski_elem K n vv x \\<longleftrightarrow>\n       (0 < (vv 0 (1\\<^sub>r\\<^bsub>K\\<^esub> \\<plusminus>\\<^bsub>K\\<^esub> (-\\<^sub>a\\<^bsub>K\\<^esub> x)))) \\<and>  (\\<forall>j\\<in>nset (Suc 0) n. 0 < (vv j x))\""], ["", "(** vv 0, vv 1, vv 2,\\<dots>, vv n are valuations **)"], ["", "lemma (in Corps) Ostrowski_elem_0:\"\\<lbrakk>vals_nonequiv K n vv; x \\<in> carrier K;\n Ostrowski_elem K n vv x\\<rbrakk> \\<Longrightarrow> 0 < (vv 0 (1\\<^sub>r \\<plusminus> (-\\<^sub>a x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K n vv; x \\<in> carrier K;\n     Ostrowski_elem K n vv x\\<rbrakk>\n    \\<Longrightarrow> 0 < vv 0 (1\\<^sub>r \\<plusminus> -\\<^sub>a x)", "apply (simp add:Ostrowski_elem_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Ostrowski_elem_Suc:\"\\<lbrakk>vals_nonequiv K n vv; x \\<in> carrier K;\n  Ostrowski_elem K n vv x; j \\<in> nset (Suc 0) n\\<rbrakk> \\<Longrightarrow> 0 < (vv j x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K n vv; x \\<in> carrier K;\n     Ostrowski_elem K n vv x; j \\<in> nset (Suc 0) n\\<rbrakk>\n    \\<Longrightarrow> 0 < vv j x", "apply (simp add:Ostrowski_elem_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vals_nonequiv_valuation:\"\\<lbrakk>vals_nonequiv K n vv; m \\<le> n\\<rbrakk> \\<Longrightarrow>\n       valuation K (vv m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K n vv; m \\<le> n\\<rbrakk>\n    \\<Longrightarrow> valuation K (vv m)", "apply (simp add:vals_nonequiv_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<le> n; valuations K n vv;\n     \\<forall>j\\<le>n.\n        \\<forall>l\\<le>n.\n           j \\<noteq> l \\<longrightarrow>\n           \\<not> v_equiv K (vv j) (vv l)\\<rbrakk>\n    \\<Longrightarrow> valuation K (vv m)", "apply (thin_tac \"\\<forall>j\\<le>n. \\<forall>l\\<le> n. j \\<noteq> l \\<longrightarrow> \\<not> v_equiv K (vv j) (vv l)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>m \\<le> n; valuations K n vv\\<rbrakk>\n    \\<Longrightarrow> valuation K (vv m)", "apply (simp add:valuations_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) vals_nonequiv:\"\\<lbrakk> vals_nonequiv K (Suc (Suc n)) vv;\n i \\<le> (Suc (Suc n)); j \\<le> (Suc (Suc n)); i \\<noteq> j\\<rbrakk> \\<Longrightarrow>\n                                   \\<not> (v_equiv K (vv i) (vv j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; i \\<le> Suc (Suc n);\n     j \\<le> Suc (Suc n); i \\<noteq> j\\<rbrakk>\n    \\<Longrightarrow> \\<not> v_equiv K (vv i) (vv j)", "apply (simp add:vals_nonequiv_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) skip_vals_nonequiv:\"vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n  vals_nonequiv K (Suc n) (compose {l. l \\<le> (Suc n)} vv (skip j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip j))", "apply (subst vals_nonequiv_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    valuations K (Suc n) (compose {l. l \\<le> Suc n} vv (skip j)) \\<and>\n    (\\<forall>ja\\<le>Suc n.\n        \\<forall>l\\<le>Suc n.\n           ja \\<noteq> l \\<longrightarrow>\n           \\<not> v_equiv K (compose {l. l \\<le> Suc n} vv (skip j) ja)\n                   (compose {l. l \\<le> Suc n} vv (skip j) l))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    valuations K (Suc n) (compose {l. l \\<le> Suc n} vv (skip j))\n 2. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    \\<forall>ja\\<le>Suc n.\n       \\<forall>l\\<le>Suc n.\n          ja \\<noteq> l \\<longrightarrow>\n          \\<not> v_equiv K (compose {l. l \\<le> Suc n} vv (skip j) ja)\n                  (compose {l. l \\<le> Suc n} vv (skip j) l)", "apply (subst valuations_def, rule allI, rule impI,\n       simp add:compose_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ja.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; ja \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> valuation K (vv (skip j ja))\n 2. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    \\<forall>ja\\<le>Suc n.\n       \\<forall>l\\<le>Suc n.\n          ja \\<noteq> l \\<longrightarrow>\n          \\<not> v_equiv K (compose {l. l \\<le> Suc n} vv (skip j) ja)\n                  (compose {l. l \\<le> Suc n} vv (skip j) l)", "apply (cut_tac l = ja and n = \"Suc n\" in skip_mem[of _ _ \"j\"], simp,\n       frule_tac m = \"skip j ja\" in vals_nonequiv_valuation[of\n         \"Suc (Suc n)\" \"vv\"], simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    \\<forall>ja\\<le>Suc n.\n       \\<forall>l\\<le>Suc n.\n          ja \\<noteq> l \\<longrightarrow>\n          \\<not> v_equiv K (compose {l. l \\<le> Suc n} vv (skip j) ja)\n                  (compose {l. l \\<le> Suc n} vv (skip j) l)", "apply ((rule allI, rule impI)+, rule impI,\n       cut_tac l = ja and n = \"Suc n\" in skip_mem[of _ _ \"j\"], simp,\n       cut_tac l = l and n = \"Suc n\" in skip_mem[of _ _ \"j\"], simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ja l.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; ja \\<le> Suc n;\n        l \\<le> Suc n; ja \\<noteq> l; skip j ja \\<le> Suc (Suc n);\n        skip j l \\<le> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<not> v_equiv K\n                                 (compose {l. l \\<le> Suc n} vv (skip j) ja)\n                                 (compose {l. l \\<le> Suc n} vv (skip j) l)", "apply (cut_tac i = ja and j = l in skip_inj[of _ \"Suc n\" _ \"j\"], simp+,\n       simp add:compose_def,\n       rule_tac i = \"skip j ja\" and j = \"skip j l\" in\n       vals_nonequiv[of \"n\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) not_v_equiv_reflex:\"\\<lbrakk>valuation K v; valuation K v';\n \\<not> v_equiv K v v'\\<rbrakk> \\<Longrightarrow> \\<not> v_equiv K v' v \""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v'\\<rbrakk>\n    \\<Longrightarrow> \\<not> v_equiv K v' v", "apply (simp add:v_equiv_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) nonequiv_ex_Ostrowski_elem:\"\\<lbrakk>valuation K v; valuation K v';\n \\<not> v_equiv K v v'\\<rbrakk> \\<Longrightarrow> \\<exists>x\\<in>carrier K. 0 \\<le> (v x) \\<and> (v' x) < 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v'\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier K. 0 \\<le> v x \\<and> v' x < 0", "apply (subgoal_tac \"\\<not> (\\<forall>x\\<in>carrier K. 0 \\<le> (v x) \\<longrightarrow> 0 \\<le> (v' x))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v';\n     \\<not> (\\<forall>x\\<in>carrier K.\n                0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier K. 0 \\<le> v x \\<and> v' x < 0\n 2. \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v'\\<rbrakk>\n    \\<Longrightarrow> \\<not> (\\<forall>x\\<in>carrier K.\n                                 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x)", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v'\\<rbrakk>\n    \\<Longrightarrow> \\<not> (\\<forall>x\\<in>carrier K.\n                                 0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x)\n 2. \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v';\n     \\<not> (\\<forall>x\\<in>carrier K.\n                0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier K. 0 \\<le> v x \\<and> v' x < 0", "apply (rule contrapos_pp, simp+,\n        frule valuations_equiv[of \"v\" \"v'\"], assumption+,\n        simp add:val_equiv_axiom2[of v v'])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v';\n     \\<not> (\\<forall>x\\<in>carrier K.\n                0 \\<le> v x \\<longrightarrow> 0 \\<le> v' x)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier K. 0 \\<le> v x \\<and> v' x < 0", "apply (simp, erule bexE, erule conjE, simp add:aneg_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>valuation K v; valuation K v'; \\<not> v_equiv K v v';\n        x \\<in> carrier K; 0 \\<le> v x; v' x < 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier K.\n                            0 \\<le> v x \\<and> v' x < 0", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_op_minus:\"\\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                              -\\<^sub>a (a \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)) = (-\\<^sub>a a) \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K;\n     b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r\n                                b\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r\n                      b\\<^bsup>\\<hyphen> K\\<^esup>", "apply (cut_tac invf_closed1[of \"b\"], simp,\n       erule conjE, cut_tac field_is_ring,\n        simp add:Ring.ring_inv1[of \"K\" \"a\" \"b\\<^bsup>\\<hyphen>K\\<^esup>\"], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_one_plus_frac1:\"\\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>\\<rbrakk>\n \\<Longrightarrow> 1\\<^sub>r \\<plusminus> (a \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)) = (b \\<plusminus> a) \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K;\n     b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      a \\<cdot>\\<^sub>r b\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (b \\<plusminus> a) \\<cdot>\\<^sub>r\n                      b\\<^bsup>\\<hyphen> K\\<^esup>", "apply (cut_tac field_is_ring,\n       cut_tac invf_closed1[of b], simp+, erule conjE,\n       cut_tac field_is_idom)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>;\n     Ring K; b\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     b\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>; Idomain K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      a \\<cdot>\\<^sub>r b\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (b \\<plusminus> a) \\<cdot>\\<^sub>r\n                      b\\<^bsup>\\<hyphen> K\\<^esup>\n 2. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier K - {\\<zero>}", "apply (rule Idomain.idom_mult_cancel_r[of K \"1\\<^sub>r \\<plusminus> (a \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>))\"\n        \"(b \\<plusminus> a) \\<cdot>\\<^sub>r (b\\<^bsup>\\<hyphen>K\\<^esup>)\" \"b\"],  assumption+,\n       frule Idomain.idom_is_ring[of \"K\"], frule Ring.ring_is_ag[of \"K\"],\n       rule aGroup.ag_pOp_closed [of \"K\"], assumption+,\n       simp add:Ring.ring_one,rule Ring.ring_tOp_closed, assumption+,\n       rule Ring.ring_tOp_closed, assumption+,\n       frule Ring.ring_is_ag[of \"K\"],\n       rule aGroup.ag_pOp_closed, assumption+,\n       subst Ring.ring_distrib2[of \"K\" \"b\"], assumption+,\n       simp add:Ring.ring_one, simp add:Ring.ring_tOp_closed,\n       simp add:Ring.ring_l_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>;\n     Ring K; b\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     b\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>; Idomain K\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus>\n                      a \\<cdot>\\<^sub>r\n                      b\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                      b =\n                      (b \\<plusminus> a) \\<cdot>\\<^sub>r\n                      b\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                      b\n 2. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier K - {\\<zero>}", "thm Ring.ring_distrib2[of K \"b\\<^bsup>\\<hyphen>K\\<^esup>\"]"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>;\n     Ring K; b\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     b\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>; Idomain K\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus>\n                      a \\<cdot>\\<^sub>r\n                      b\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                      b =\n                      (b \\<plusminus> a) \\<cdot>\\<^sub>r\n                      b\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                      b\n 2. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K; b \\<noteq> \\<zero>;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier K - {\\<zero>}", "apply (subst Ring.ring_distrib2[of K \"b\\<^bsup>\\<hyphen>K\\<^esup>\"], assumption+,\n       simp add:Ring.ring_tOp_commute[of \"K\" \"b\" \"b\\<^bsup>\\<hyphen>K\\<^esup>\"],\n       subst linvf[of \"b\"], simp,\n       subst  Ring.ring_distrib2[of \"K\" \"b\"], assumption+,\n       simp add:Ring.ring_one, simp add:Ring.ring_tOp_closed,\n       simp add:Ring.ring_l_one, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_one_plus_frac2:\"\\<lbrakk>a \\<in> carrier K; b \\<in> carrier K;\n a \\<plusminus> b \\<noteq> \\<zero>\\<rbrakk>  \\<Longrightarrow> 1\\<^sub>r \\<plusminus> (-\\<^sub>a (a \\<cdot>\\<^sub>r (a \\<plusminus> b)\\<^bsup>\\<hyphen>K\\<^esup>)) = b \\<cdot>\\<^sub>r ((a \\<plusminus> b)\\<^bsup>\\<hyphen>K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K;\n     a \\<plusminus> b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r\n                                (a \\<plusminus>\n                                 b)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      b \\<cdot>\\<^sub>r\n                      (a \\<plusminus> b)\\<^bsup>\\<hyphen> K\\<^esup>", "apply (frule field_op_minus[of \"a\" \"a \\<plusminus> b\"],\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       simp add:aGroup.ag_pOp_closed, assumption, simp,\n       thin_tac \"-\\<^sub>a (a \\<cdot>\\<^sub>r (a \\<plusminus> b)\\<^bsup>\\<hyphen> K\\<^esup>) = (-\\<^sub>a a) \\<cdot>\\<^sub>r (a \\<plusminus> b)\\<^bsup>\\<hyphen> K\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; b \\<in> carrier K;\n     a \\<plusminus> b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r\n                      (a \\<plusminus> b)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      b \\<cdot>\\<^sub>r\n                      (a \\<plusminus> b)\\<^bsup>\\<hyphen> K\\<^esup>", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n        frule aGroup.ag_mOp_closed[of \"K\" \"a\"], assumption,\n        frule field_one_plus_frac1[of \"-\\<^sub>a a\" \"a \\<plusminus> b\"],\n        simp add:aGroup.ag_pOp_closed, simp, simp,\n        thin_tac \"1\\<^sub>r \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r (a \\<plusminus> b)\\<^bsup>\\<hyphen> K\\<^esup> = (a \\<plusminus> b \\<plusminus> -\\<^sub>a a) \\<cdot>\\<^sub>r (a \\<plusminus> b)\\<^bsup>\\<hyphen> K\\<^esup>\",\n        simp add:aGroup.ag_pOp_assoc[of \"K\" \"a\" \"b\" \"-\\<^sub>a a\"],\n        simp add:aGroup.ag_pOp_commute[of \"K\" \"b\" \"-\\<^sub>a a\"],\n        simp add:aGroup.ag_pOp_assoc[THEN sym],\n        simp add:aGroup.ag_r_inv1,\n        simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_one_plus_frac3:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n      1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow>\n      1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                    (1\\<^sub>r \\<plusminus> -\\<^sub>a x^\\<^bsup>K (Suc (Suc 0))\\<^esup>) \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r\n                                (1\\<^sub>r \\<plusminus>\n                                 x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a x^\\<^bsup>K Suc\n        (Suc 0)\\<^esup>) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag, frule Ring.ring_one,\n       cut_tac invf_closed1[of \"1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\"], simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r\n                                (1\\<^sub>r \\<plusminus>\n                                 x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                                 x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (subst Ring.ring_inv1_1, assumption+,\n        subst field_one_plus_frac1[of \"-\\<^sub>a x\" \"1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> carrier K\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n                      \\<zero>\n 4. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<plusminus>\n                       -\\<^sub>a x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                                 x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n 5. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (rule aGroup.ag_mOp_closed, assumption+,\n        rule aGroup.ag_pOp_closed, assumption+,\n        rule Ring.ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n                      \\<zero>\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<plusminus>\n                       -\\<^sub>a x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                                 x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n 4. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (rule aGroup.ag_pOp_closed, assumption+, rule aGroup.ag_mOp_closed,\n        assumption+,\n        subst Ring.ring_distrib1, assumption+,\n        rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus>\n                       (x \\<cdot>\\<^sub>r 1\\<^sub>r \\<plusminus>\n                        x \\<cdot>\\<^sub>r (-\\<^sub>a x)) \\<plusminus>\n                       -\\<^sub>a x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                                 x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (simp add:Ring.ring_r_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus>\n                       (x \\<plusminus>\n                        x \\<cdot>\\<^sub>r (-\\<^sub>a x)) \\<plusminus>\n                       -\\<^sub>a x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                                 x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (simp add:Ring.ring_inv1_2[THEN sym, of K x x])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus>\n                       (x \\<plusminus>\n                        -\\<^sub>a x \\<cdot>\\<^sub>r x) \\<plusminus>\n                       -\\<^sub>a x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                                 x) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (subgoal_tac \"1\\<^sub>r \\<plusminus> (x \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r x) \\<plusminus> -\\<^sub>a x = 1\\<^sub>r \\<plusminus> -\\<^sub>a x^\\<^bsup>K (Suc (Suc 0))\\<^esup>\",\n        simp,\n        frule Ring.ring_tOp_closed[of K x x], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     x \\<cdot>\\<^sub>r x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      (x \\<plusminus>\n                       -\\<^sub>a x \\<cdot>\\<^sub>r x) \\<plusminus>\n                      -\\<^sub>a x =\n                      1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a x^\\<^bsup>K Suc (Suc 0)\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (frule Ring.ring_tOp_closed[of K x x], assumption+,\n        frule aGroup.ag_mOp_closed[of K \"x \\<cdot>\\<^sub>r x\"], assumption+,\n        frule aGroup.ag_mOp_closed[of K x], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     -\\<^sub>a x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      (x \\<plusminus>\n                       -\\<^sub>a x \\<cdot>\\<^sub>r x) \\<plusminus>\n                      -\\<^sub>a x =\n                      1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a x^\\<^bsup>K Suc (Suc 0)\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (subst aGroup.ag_pOp_assoc, assumption+,\n        rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     -\\<^sub>a x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      (x \\<plusminus>\n                       -\\<^sub>a x \\<cdot>\\<^sub>r x \\<plusminus>\n                       -\\<^sub>a x) =\n                      1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a x^\\<^bsup>K Suc (Suc 0)\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (rule aGroup.ag_pOp_add_l[of K \"x \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r x \\<plusminus> -\\<^sub>a x\"\n         \"-\\<^sub>a x^\\<^bsup>K (Suc (Suc 0))\\<^esup>\" \"1\\<^sub>r\"], assumption+,\n         (rule aGroup.ag_pOp_closed, assumption+)+,\n         rule aGroup.ag_mOp_closed, assumption+, rule Ring.npClose,\n         assumption+,\n         subst aGroup.ag_pOp_commute, assumption+,\n         simp add:aGroup.ag_pOp_assoc aGroup.ag_r_inv1 aGroup.ag_r_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     -\\<^sub>a x \\<cdot>\\<^sub>r x \\<in> carrier K;\n     -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<cdot>\\<^sub>r x =\n                      -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                                x\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (simp add:Ring.ring_l_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Ring K; aGroup K; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K", "apply (rule aGroup.ag_pOp_closed, assumption+,\n        rule Ring.ring_tOp_closed, assumption+,\n        rule aGroup.ag_pOp_closed, assumption+,\n        rule aGroup.ag_mOp_closed[of K x], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr1:\"\\<lbrakk> valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n      0 \\<le> (v s); v t < 0\\<rbrakk>  \\<Longrightarrow> s \\<plusminus> t \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v s; v t < 0\\<rbrakk>\n    \\<Longrightarrow> s \\<plusminus> t \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+,\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       simp only:aGroup.ag_plus_zero[THEN sym, of \"K\" \"s\" \"t\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; -\\<^sub>a t \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v (-\\<^sub>a t); v t < 0; s = -\\<^sub>a t; Ring K;\n     aGroup K\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:val_minus_eq[of \"v\" \"t\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr2:\"\\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n  0 \\<le> (v s); v t < 0\\<rbrakk>  \\<Longrightarrow> 0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a ((t \\<cdot>\\<^sub>r ((s \\<plusminus> t)\\<^bsup>\\<hyphen>K\\<^esup>))))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v s; v t < 0\\<rbrakk>\n    \\<Longrightarrow> 0 < v (1\\<^sub>r \\<plusminus>\n                             -\\<^sub>a t \\<cdot>\\<^sub>r\n (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule OstrowskiTr1[of \"v\" \"s\" \"t\"], assumption+,\n       frule field_one_plus_frac2[of \"t\" \"s\"], assumption+,\n       simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v s; v t < 0; Ring K; aGroup K;\n     s \\<plusminus> t \\<noteq> \\<zero>;\n     1\\<^sub>r \\<plusminus>\n     -\\<^sub>a t \\<cdot>\\<^sub>r\n               (t \\<plusminus> s)\\<^bsup>\\<hyphen> K\\<^esup> =\n     s \\<cdot>\\<^sub>r\n     (t \\<plusminus> s)\\<^bsup>\\<hyphen> K\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> 0 < v (1\\<^sub>r \\<plusminus>\n                             -\\<^sub>a t \\<cdot>\\<^sub>r\n (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (subst aGroup.ag_pOp_commute[of \"K\" \"s\" \"t\"], assumption+, simp,\n       simp add:aGroup.ag_pOp_commute[of \"K\" \"t\" \"s\"],\n       thin_tac \"1\\<^sub>r \\<plusminus> -\\<^sub>a (t \\<cdot>\\<^sub>r (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>) = s \\<cdot>\\<^sub>r (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>\",\n       frule aGroup.ag_pOp_closed[of \"K\" \"s\" \"t\"], assumption+,\n       cut_tac invf_closed1[of \"s \\<plusminus> t\"], simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v s; v t < 0; Ring K; aGroup K;\n     s \\<plusminus> t \\<noteq> \\<zero>; s \\<plusminus> t \\<in> carrier K;\n     (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 0 < v (s \\<cdot>\\<^sub>r\n                             (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v s; v t < 0; Ring K; aGroup K;\n     s \\<plusminus> t \\<noteq> \\<zero>;\n     s \\<plusminus> t \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> s \\<plusminus> t \\<in> carrier K - {\\<zero>}", "apply (simp add:val_t2p,\n       simp add:value_of_inv,\n       frule aless_le_trans[of \"v t\" \"0\" \"v s\"], assumption+,\n       frule value_less_eq[THEN sym, of v t s], assumption+,\n       simp add:aGroup.ag_pOp_commute,\n       frule aless_diff_poss[of \"v t\" \"v s\"], simp add:diff_ant_def, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr3:\"\\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n      0 \\<le> (v t); v s < 0\\<rbrakk>  \\<Longrightarrow> 0 < (v (t \\<cdot>\\<^sub>r (( s \\<plusminus> t)\\<^bsup>\\<hyphen>K\\<^esup>)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v t; v s < 0\\<rbrakk>\n    \\<Longrightarrow> 0 < v (t \\<cdot>\\<^sub>r\n                             (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (frule aless_le_trans[of \"v s\" \"0\" \"v t\"], assumption+,\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule aGroup.ag_pOp_closed[of \"K\" \"s\" \"t\"], assumption+,\n       frule OstrowskiTr1[of v t s], assumption+,\n       frule value_less_eq[THEN sym, of v s t], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v t; v s < 0; v s < v t; Ring K; aGroup K;\n     s \\<plusminus> t \\<in> carrier K; t \\<plusminus> s \\<noteq> \\<zero>;\n     v (s \\<plusminus> t) = v s\\<rbrakk>\n    \\<Longrightarrow> 0 < v (t \\<cdot>\\<^sub>r\n                             (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>)", "apply (simp add:aGroup.ag_pOp_commute[of K t s],\n       cut_tac invf_closed1[of \"s \\<plusminus> t\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v t; v s < 0; v s < v t; Ring K; aGroup K;\n     s \\<plusminus> t \\<in> carrier K; s \\<plusminus> t \\<noteq> \\<zero>;\n     v (s \\<plusminus> t) = v s;\n     (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 0 < v (t \\<cdot>\\<^sub>r\n                             (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v t; v s < 0; v s < v t; Ring K; aGroup K;\n     s \\<plusminus> t \\<in> carrier K; s \\<plusminus> t \\<noteq> \\<zero>;\n     v (s \\<plusminus> t) = v s\\<rbrakk>\n    \\<Longrightarrow> s \\<plusminus> t \\<in> carrier K - {\\<zero>}", "apply (\n       erule conjE, simp add:val_t2p[of v], simp add:value_of_inv)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v t; v s < 0; v s < v t; Ring K; aGroup K;\n     s \\<plusminus> t \\<in> carrier K; s \\<plusminus> t \\<noteq> \\<zero>;\n     v (s \\<plusminus> t) = v s;\n     (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     (s \\<plusminus> t)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 0 < v t + - v s\n 2. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 \\<le> v t; v s < 0; v s < v t; Ring K; aGroup K;\n     s \\<plusminus> t \\<in> carrier K; s \\<plusminus> t \\<noteq> \\<zero>;\n     v (s \\<plusminus> t) = v s\\<rbrakk>\n    \\<Longrightarrow> s \\<plusminus> t \\<in> carrier K - {\\<zero>}", "apply (cut_tac aless_diff_poss[of \"v s\" \"v t\"],\n              simp add:diff_ant_def, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) restrict_Ostrowski_elem:\"\\<lbrakk> x \\<in> carrier K;\n  Ostrowski_elem K (Suc (Suc n)) vv x\\<rbrakk> \\<Longrightarrow> Ostrowski_elem K (Suc n) vv x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; Ostrowski_elem K (Suc (Suc n)) vv x\\<rbrakk>\n    \\<Longrightarrow> Ostrowski_elem K (Suc n) vv x", "apply (simp add:Ostrowski_elem_def,\n       erule conjE, rule ballI, simp add:nset_def,\n       insert lessI [of \"Suc n\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) restrict_vals_nonequiv:\"vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n                  vals_nonequiv K (Suc n) vv\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    vals_nonequiv K (Suc n) vv", "apply (simp add:vals_nonequiv_def,\n       erule conjE, simp add:valuations_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) restrict_vals_nonequiv1:\"vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n       vals_nonequiv K (Suc n) (compose {h. h \\<le> (Suc n)} vv (skip 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    vals_nonequiv K (Suc n) (compose {h. h \\<le> Suc n} vv (skip 1))", "apply (simp add:vals_nonequiv_def, (erule conjE)+,\n       rule conjI,\n       thin_tac \"\\<forall>j\\<le>Suc (Suc n). \\<forall>l\\<le>Suc (Suc n). j \\<noteq> l \\<longrightarrow>\n                                       \\<not> v_equiv K (vv j) (vv l)\",\n      simp add:valuations_def, rule allI, rule impI,\n      simp add:compose_def skip_def nset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuations K (Suc (Suc n)) vv;\n     \\<forall>j\\<le>Suc (Suc n).\n        \\<forall>l\\<le>Suc (Suc n).\n           j \\<noteq> l \\<longrightarrow>\n           \\<not> v_equiv K (vv j) (vv l)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         \\<forall>l\\<le>Suc n.\n                            j \\<noteq> l \\<longrightarrow>\n                            \\<not> v_equiv K\n                                    (compose {h. h \\<le> Suc n} vv\n(skip (Suc 0)) j)\n                                    (compose {h. h \\<le> Suc n} vv\n(skip (Suc 0)) l)", "apply ((rule allI, rule impI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j l.\n       \\<lbrakk>valuations K (Suc (Suc n)) vv;\n        \\<forall>j\\<le>Suc (Suc n).\n           \\<forall>l\\<le>Suc (Suc n).\n              j \\<noteq> l \\<longrightarrow> \\<not> v_equiv K (vv j) (vv l);\n        j \\<le> Suc n; l \\<le> Suc n; j \\<noteq> l\\<rbrakk>\n       \\<Longrightarrow> \\<not> v_equiv K\n                                 (compose {h. h \\<le> Suc n} vv\n                                   (skip (Suc 0)) j)\n                                 (compose {h. h \\<le> Suc n} vv\n                                   (skip (Suc 0)) l)", "apply (simp add:compose_def skip_def nset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) restrict_vals_nonequiv2:\"\\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv\\<rbrakk>\n      \\<Longrightarrow> vals_nonequiv K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vals_nonequiv K (Suc (Suc n)) vv \\<Longrightarrow>\n    vals_nonequiv K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2))", "apply (simp add:vals_nonequiv_def, (erule conjE)+,\n      rule conjI,\n      thin_tac \"\\<forall>j\\<le>Suc (Suc n). \\<forall>l\\<le>Suc (Suc n). j \\<noteq> l \\<longrightarrow>\n                                              \\<not> v_equiv K (vv j) (vv l)\",\n      simp add:valuations_def,\n      rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc (Suc n). valuation K (vv j);\n        j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> valuation K\n                          (compose {j. j \\<le> Suc n} vv (skip 2) j)\n 2. \\<lbrakk>valuations K (Suc (Suc n)) vv;\n     \\<forall>j\\<le>Suc (Suc n).\n        \\<forall>l\\<le>Suc (Suc n).\n           j \\<noteq> l \\<longrightarrow>\n           \\<not> v_equiv K (vv j) (vv l)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         \\<forall>l\\<le>Suc n.\n                            j \\<noteq> l \\<longrightarrow>\n                            \\<not> v_equiv K\n                                    (compose {j. j \\<le> Suc n} vv (skip 2)\nj)\n                                    (compose {j. j \\<le> Suc n} vv (skip 2)\nl)", "apply (simp add:compose_def skip_def nset_def,\n       (rule allI, rule impI)+, rule impI,\n       simp add:compose_def skip_def nset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps)  OstrowskiTr31:\"\\<lbrakk>valuation K v; s \\<in> carrier K;\n        0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a s)))\\<rbrakk> \\<Longrightarrow> s \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s)\\<rbrakk>\n    \\<Longrightarrow> s \\<noteq> \\<zero>", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s); Ring K; aGroup K\\<rbrakk>\n    \\<Longrightarrow> s \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<zero> \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a \\<zero>); Ring K; aGroup K;\n     s = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:aGroup.ag_inv_zero,\n        frule Ring.ring_one[of \"K\"], simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<zero> \\<in> carrier K; 0 < v 1\\<^sub>r;\n     Ring K; aGroup K; s = \\<zero>; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:value_of_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr32:\"\\<lbrakk>valuation K v; s \\<in> carrier K;\n           0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a s)))\\<rbrakk> \\<Longrightarrow> 0 \\<le> (v s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> v s", "apply (rule contrapos_pp, simp+,\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       simp add:aneg_le,\n       frule has_val_one_neq_zero[of \"v\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s); v s < 0; Ring K; aGroup K;\n     1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule OstrowskiTr31[of v s], assumption+,\n       frule not_sym,\n       frule Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s); v s < 0; Ring K; aGroup K;\n     1\\<^sub>r \\<noteq> \\<zero>; s \\<noteq> \\<zero>;\n     \\<zero> \\<noteq> 1\\<^sub>r; 1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule value_less_eq[THEN sym, of v \"-\\<^sub>a s\" \"1\\<^sub>r\"],\n       simp add:aGroup.ag_mOp_closed, assumption+,\n       simp add:val_minus_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s); v s < 0; Ring K; aGroup K;\n     s \\<noteq> \\<zero>; \\<zero> \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v s < v 1\\<^sub>r\n 2. \\<lbrakk>valuation K v; s \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s); v s < 0; Ring K; aGroup K;\n     1\\<^sub>r \\<noteq> \\<zero>; s \\<noteq> \\<zero>;\n     \\<zero> \\<noteq> 1\\<^sub>r; 1\\<^sub>r \\<in> carrier K;\n     v (-\\<^sub>a s \\<plusminus> 1\\<^sub>r) = v (-\\<^sub>a s)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:value_of_one,\n       frule aGroup.ag_mOp_closed[of \"K\" \"s\"], assumption+,\n       simp add:aGroup.ag_pOp_commute[of \"K\" \"-\\<^sub>a s\" \"1\\<^sub>r\"],\n       simp add:val_minus_eq)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr4:\"\\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n      0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a s))); 0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a t)))\\<rbrakk>  \\<Longrightarrow>\n                              0 < (v (1\\<^sub>r \\<plusminus> (-\\<^sub>a (s \\<cdot>\\<^sub>r t))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t)\\<rbrakk>\n    \\<Longrightarrow> 0 < v (1\\<^sub>r \\<plusminus>\n                             -\\<^sub>a s \\<cdot>\\<^sub>r t)", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 < v (1\\<^sub>r \\<plusminus>\n                             -\\<^sub>a s \\<cdot>\\<^sub>r t)", "apply (subgoal_tac \"1\\<^sub>r \\<plusminus> (-\\<^sub>a (s \\<cdot>\\<^sub>r t)) =\n                    1\\<^sub>r \\<plusminus> (-\\<^sub>a s) \\<plusminus> (s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> (-\\<^sub>a t)))\", simp,\n       thin_tac \"1\\<^sub>r \\<plusminus> -\\<^sub>a (s \\<cdot>\\<^sub>r t) = 1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus> s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n                             s \\<cdot>\\<^sub>r\n                             (1\\<^sub>r \\<plusminus> -\\<^sub>a t))\n 2. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<cdot>\\<^sub>r t =\n                      1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n                      s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)", "apply (frule aGroup.ag_mOp_closed[of K s], assumption+,\n       frule aGroup.ag_pOp_closed[of K \"1\\<^sub>r\" \"-\\<^sub>a s\"], assumption+,\n       frule aGroup.ag_mOp_closed[of \"K\" \"t\"], assumption+,\n       frule aGroup.ag_pOp_closed[of \"K\" \"1\\<^sub>r\" \"-\\<^sub>a t\"], assumption+,\n       frule Ring.ring_tOp_closed[of \"K\" \"s\" \"1\\<^sub>r \\<plusminus> (-\\<^sub>a t)\"], assumption+,\n       frule amin_le_plus[of v \"1\\<^sub>r \\<plusminus> (-\\<^sub>a s)\" \"s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> (-\\<^sub>a t))\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a s \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<in> carrier K;\n     -\\<^sub>a t \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a t \\<in> carrier K;\n     s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t) \\<in> carrier K;\n     amin (v (1\\<^sub>r \\<plusminus> -\\<^sub>a s))\n      (v (s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)))\n     \\<le> v (1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n              s \\<cdot>\\<^sub>r\n              (1\\<^sub>r \\<plusminus> -\\<^sub>a t))\\<rbrakk>\n    \\<Longrightarrow> 0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n                             s \\<cdot>\\<^sub>r\n                             (1\\<^sub>r \\<plusminus> -\\<^sub>a t))\n 2. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<cdot>\\<^sub>r t =\n                      1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n                      s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)", "apply (frule amin_gt[of \"0\" \"v (1\\<^sub>r \\<plusminus> -\\<^sub>a s)\" \"v (s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t))\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a s \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<in> carrier K;\n     -\\<^sub>a t \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a t \\<in> carrier K;\n     s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t) \\<in> carrier K;\n     amin (v (1\\<^sub>r \\<plusminus> -\\<^sub>a s))\n      (v (s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)))\n     \\<le> v (1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n              s \\<cdot>\\<^sub>r\n              (1\\<^sub>r \\<plusminus> -\\<^sub>a t))\\<rbrakk>\n    \\<Longrightarrow> 0 < v (s \\<cdot>\\<^sub>r\n                             (1\\<^sub>r \\<plusminus> -\\<^sub>a t))\n 2. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a s \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<in> carrier K;\n     -\\<^sub>a t \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a t \\<in> carrier K;\n     s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t) \\<in> carrier K;\n     amin (v (1\\<^sub>r \\<plusminus> -\\<^sub>a s))\n      (v (s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)))\n     \\<le> v (1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n              s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t));\n     0 < amin (v (1\\<^sub>r \\<plusminus> -\\<^sub>a s))\n          (v (s \\<cdot>\\<^sub>r\n              (1\\<^sub>r \\<plusminus> -\\<^sub>a t)))\\<rbrakk>\n    \\<Longrightarrow> 0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n                             s \\<cdot>\\<^sub>r\n                             (1\\<^sub>r \\<plusminus> -\\<^sub>a t))\n 3. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<cdot>\\<^sub>r t =\n                      1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n                      s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)", "apply (simp add:val_t2p,\n       frule OstrowskiTr32[of v s], assumption+,\n       rule aadd_pos_poss[of \"v s\" \"v (1\\<^sub>r \\<plusminus> -\\<^sub>a t)\"], assumption+,\n       simp add:Ring.ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; s \\<in> carrier K; t \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a s);\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a t); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<cdot>\\<^sub>r t =\n                      1\\<^sub>r \\<plusminus> -\\<^sub>a s \\<plusminus>\n                      s \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a t)", "apply (frule aGroup.ag_mOp_closed[of K t], assumption,\n       simp add:Ring.ring_distrib1 Ring.ring_r_one,\n       frule aGroup.ag_mOp_closed[of K s], assumption+,\n       subst aGroup.pOp_assocTr43, assumption+,\n       simp add:Ring.ring_tOp_closed,\n       simp add:aGroup.ag_l_inv1 aGroup.ag_r_zero,\n       simp add:Ring.ring_inv1_2)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr5:\"\\<lbrakk> vals_nonequiv K (Suc (Suc n)) vv;\n  s \\<in> carrier K; t \\<in> carrier K;\n  0 \\<le> (vv (Suc 0)) s \\<and> 0 \\<le> (vv (Suc (Suc 0))) t;\n  Ostrowski_elem K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 1)) s;\n  Ostrowski_elem K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 2)) t\\<rbrakk> \\<Longrightarrow>\n  Ostrowski_elem K (Suc (Suc n)) vv (s \\<cdot>\\<^sub>r t)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n     t \\<in> carrier K;\n     0 \\<le> vv (Suc 0) s \\<and> 0 \\<le> vv (Suc (Suc 0)) t;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2))\n      t\\<rbrakk>\n    \\<Longrightarrow> Ostrowski_elem K (Suc (Suc n)) vv\n                       (s \\<cdot>\\<^sub>r t)", "apply (erule conjE,\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule_tac x = s and y = t in Ring.ring_tOp_closed[of \"K\"], assumption+,\n       frule skip_vals_nonequiv[of n \"vv\" \"1\"],\n       frule skip_vals_nonequiv[of n \"vv\" \"2\"],\n       subst Ostrowski_elem_def, rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n     t \\<in> carrier K;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n     0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n     s \\<cdot>\\<^sub>r t \\<in> carrier K;\n     vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n     vals_nonequiv K (Suc n)\n      (compose {l. l \\<le> Suc n} vv (skip 2))\\<rbrakk>\n    \\<Longrightarrow> 0 < vv 0\n                           (1\\<^sub>r \\<plusminus>\n                            -\\<^sub>a s \\<cdot>\\<^sub>r t)\n 2. \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n     t \\<in> carrier K;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n     0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n     s \\<cdot>\\<^sub>r t \\<in> carrier K;\n     vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n     vals_nonequiv K (Suc n)\n      (compose {l. l \\<le> Suc n} vv (skip 2))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc 0) (Suc (Suc n)).\n                         0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (rule  OstrowskiTr4,\n       simp add:vals_nonequiv_valuation[of \"Suc (Suc n)\" \"vv\" \"0\"],\n       assumption+,\n       frule Ostrowski_elem_0[of  \"Suc n\"\n         \"compose {j. j \\<le> (Suc n)} vv (skip 1)\" \"s\"], assumption+,\n       simp add:skip_def compose_def,\n       frule Ostrowski_elem_0[of \"Suc n\"\n         \"compose {j. j \\<le> (Suc n)} vv (skip 2)\" \"t\"], assumption+,\n       simp add:skip_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n     t \\<in> carrier K;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n     Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n     0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n     s \\<cdot>\\<^sub>r t \\<in> carrier K;\n     vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n     vals_nonequiv K (Suc n)\n      (compose {l. l \\<le> Suc n} vv (skip 2))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc 0) (Suc (Suc n)).\n                         0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (rule ballI,\n      case_tac \"j = Suc 0\",\n      frule_tac j = \" Suc 0\" in Ostrowski_elem_Suc[of \"Suc n\"\n        \"compose {j. j \\<le> (Suc n)} vv (skip 2)\" \"t\"], assumption+,\n        simp add:nset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j = Suc 0;\n        0 < compose {j. j \\<le> Suc n} vv (skip 2) (Suc 0) t\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)\n 2. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (\n thin_tac \"Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s\",\n thin_tac \"Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t\",\n thin_tac \"vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1))\",\n      frule vals_nonequiv_valuation[of  \"Suc n\"\n       \"compose {j. j \\<le> (Suc n)} vv (skip 2)\" \"Suc 0\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K; 0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t;\n        Ring K; aGroup K; s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j = Suc 0;\n        0 < compose {j. j \\<le> Suc n} vv (skip 2) (Suc 0) t\\<rbrakk>\n       \\<Longrightarrow> Suc 0 \\<le> Suc n\n 2. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K; 0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t;\n        Ring K; aGroup K; s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j = Suc 0;\n        0 < compose {j. j \\<le> Suc n} vv (skip 2) (Suc 0) t;\n        valuation K\n         (compose {j. j \\<le> Suc n} vv (skip 2) (Suc 0))\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)\n 3. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "apply simp+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K; 0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t;\n        Ring K; aGroup K; s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        Suc 0 \\<in> nset (Suc 0) (Suc (Suc n)); j = Suc 0;\n        0 < compose {j. j \\<le> Suc n} vv (skip 2) (Suc 0) t;\n        valuation K\n         (compose {j. j \\<le> Suc n} vv (skip 2) (Suc 0))\\<rbrakk>\n       \\<Longrightarrow> 0 < vv (Suc 0) (s \\<cdot>\\<^sub>r t)\n 2. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (simp add:skip_def compose_def,\n        simp add:val_t2p, simp add:aadd_pos_poss)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "(** Ostrowski_elem_Suc case j = Suc (Suc 0) **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (case_tac \"j = Suc (Suc 0)\",\n       frule vals_nonequiv_valuation[of \"Suc n\"\n        \"compose {j. j \\<le> Suc n} vv (skip 1)\" \"Suc 0\"],\n        simp,\n       frule_tac j = \" Suc 0\" in Ostrowski_elem_Suc[of \"Suc n\"\n        \"compose {j. j \\<le> (Suc n)} vv (skip 1)\" \"s\"],\n         assumption+, simp add:nset_def,\n         simp add:skip_def compose_def,\n       simp add:val_t2p, rule aadd_poss_pos, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0;\n        j \\<noteq> Suc (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (frule_tac j = j in nsetTr1[of _ \"Suc 0\" \"Suc (Suc n)\"], assumption,\n       frule_tac j = j in nsetTr2[of _ \"Suc 0\" \"Suc n\"],\n       thin_tac \"j \\<in> nset (Suc (Suc 0)) (Suc (Suc n))\",\n       frule_tac j = \"j - Suc 0\" in Ostrowski_elem_Suc[of \"Suc n\"\n                \"compose {j. j \\<le> (Suc n)} vv (skip 1)\" \"s\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 1)) s;\n        Ostrowski_elem K (Suc n) (compose {j. j \\<le> Suc n} vv (skip 2)) t;\n        0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t; Ring K; aGroup K;\n        s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 1));\n        vals_nonequiv K (Suc n) (compose {l. l \\<le> Suc n} vv (skip 2));\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0;\n        j \\<noteq> Suc (Suc 0); j - Suc 0 \\<in> nset (Suc 0) (Suc n);\n        0 < compose {j. j \\<le> Suc n} vv (skip 1) (j - Suc 0) s\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (frule_tac j = \"j - Suc 0\" in Ostrowski_elem_Suc[of \"Suc n\"\n                 \"compose {j. j \\<le> (Suc n)} vv (skip 2)\" \"t\"], assumption+,\n thin_tac \"Ostrowski_elem K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 1)) s\",\n thin_tac \"Ostrowski_elem K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 2)) t\",\n thin_tac \"vals_nonequiv K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 1))\",\n thin_tac \"vals_nonequiv K (Suc n) (compose {j. j \\<le> (Suc n)} vv (skip 2))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K; 0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t;\n        Ring K; aGroup K; s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        j \\<in> nset (Suc 0) (Suc (Suc n)); j \\<noteq> Suc 0;\n        j \\<noteq> Suc (Suc 0); j - Suc 0 \\<in> nset (Suc 0) (Suc n);\n        0 < compose {j. j \\<le> Suc n} vv (skip 1) (j - Suc 0) s;\n        0 < compose {j. j \\<le> Suc n} vv (skip 2) (j - Suc 0) t\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)", "apply (simp add:compose_def skip_def nset_def,\n      (erule conjE)+, simp, subgoal_tac \"\\<not> (j - Suc 0 \\<le> Suc 0)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K; 0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t;\n        Ring K; aGroup K; s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        j \\<noteq> Suc 0; j \\<noteq> Suc (Suc 0); 0 < vv j s; 0 < vv j t;\n        Suc 0 \\<le> j; j \\<le> Suc (Suc n); j - Suc 0 \\<le> Suc n;\n        \\<not> j - Suc 0 \\<le> Suc 0\\<rbrakk>\n       \\<Longrightarrow> 0 < vv j (s \\<cdot>\\<^sub>r t)\n 2. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K; 0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t;\n        Ring K; aGroup K; s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        j \\<noteq> Suc 0; j \\<noteq> Suc (Suc 0); 0 < vv j s;\n        0 < vv (if j - Suc 0 = Suc 0 then j - Suc 0 else Suc (j - Suc 0)) t;\n        Suc 0 \\<le> j; j \\<le> Suc (Suc n); Suc 0 \\<le> j - Suc 0;\n        j - Suc 0 \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<not> j - Suc 0 \\<le> Suc 0", "apply (frule_tac m = j in vals_nonequiv_valuation[of \"Suc (Suc n)\"],\n       assumption+,\n      simp add:val_t2p,\n      rule_tac x = \"vv j s\" and y = \"vv j t\" in aadd_pos_poss,\n      simp add:aless_imp_le, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>vals_nonequiv K (Suc (Suc n)) vv; s \\<in> carrier K;\n        t \\<in> carrier K; 0 \\<le> vv (Suc 0) s; 0 \\<le> vv (Suc (Suc 0)) t;\n        Ring K; aGroup K; s \\<cdot>\\<^sub>r t \\<in> carrier K;\n        j \\<noteq> Suc 0; j \\<noteq> Suc (Suc 0); 0 < vv j s;\n        0 < vv (if j - Suc 0 = Suc 0 then j - Suc 0 else Suc (j - Suc 0)) t;\n        Suc 0 \\<le> j; j \\<le> Suc (Suc n); Suc 0 \\<le> j - Suc 0;\n        j - Suc 0 \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<not> j - Suc 0 \\<le> Suc 0", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) one_plus_x_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0\\<rbrakk>\n      \\<Longrightarrow> 1\\<^sub>r \\<plusminus> x \\<in> carrier K \\<and> v (1\\<^sub>r \\<plusminus> x) < 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> x \\<in> carrier K \\<and>\n                      v (1\\<^sub>r \\<plusminus> x) < 0", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule Ring.ring_one[of \"K\"],\n       frule aGroup.ag_pOp_closed[of \"K\" \"1\\<^sub>r\" \"x\"], assumption+,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0; Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v (1\\<^sub>r \\<plusminus> x) < 0", "apply (frule value_less_eq[of \"v\" \"x\" \"1\\<^sub>r\"], assumption+,\n       simp add:value_of_one, simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps)  val_neg_nonzero:\"\\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0\\<rbrakk> \\<Longrightarrow>\n                                     x \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+, simp add:value_of_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; \\<zero> \\<in> carrier K; \\<infinity> < 0;\n     x = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule aless_imp_le[of \"\\<infinity>\" \"0\"],\n        cut_tac inf_ge_any[of \"0\"],\n        frule ale_antisym[of \"0\" \"\\<infinity>\"], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr6:\"\\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> (v x)\\<rbrakk> \\<Longrightarrow>\n       (1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<in> carrier K - {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (simp add:aneg_le,\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule aGroup.ag_mOp_closed[of \"K\" \"x\"], assumption+,\n       frule one_plus_x_nonzero[of \"v\" \"-\\<^sub>a x\"], assumption+,\n        simp add:val_minus_eq, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0; Ring K; aGroup K;\n     -\\<^sub>a x \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K;\n     v (1\\<^sub>r \\<plusminus> -\\<^sub>a x) < 0\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K \\<and>\n                      1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n                      \\<zero>", "apply (rule conjI,\n       rule aGroup.ag_pOp_closed[of \"K\"], assumption+,\n       simp add:Ring.ring_one, rule Ring.ring_tOp_closed[of \"K\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; v x < 0; Ring K; aGroup K;\n     -\\<^sub>a x \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K;\n     v (1\\<^sub>r \\<plusminus> -\\<^sub>a x) < 0\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n                      \\<zero>", "apply (frule val_t2p[of v x \"1\\<^sub>r \\<plusminus> (-\\<^sub>a x)\"], assumption+,\n       frule val_neg_nonzero[of v x], assumption+,\n       frule val_nonzero_z[of v x], assumption+, erule exE,\n       frule_tac z = z in aadd_less_mono_z[of \"v (1\\<^sub>r \\<plusminus> (-\\<^sub>a x))\" \"0\"],\n       simp add:aadd_0_l,\n       simp only:aadd_commute[of \"v (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\"],\n       frule_tac x = \"ant z + v (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\" and y =\"ant z\" in\n         aless_trans[of _ _ \"0\"], assumption,\n       drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z.\n       \\<lbrakk>valuation K v; x \\<in> carrier K; ant z < 0; Ring K;\n        aGroup K; -\\<^sub>a x \\<in> carrier K;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K;\n        v (1\\<^sub>r \\<plusminus> -\\<^sub>a x) < 0; x \\<noteq> \\<zero>;\n        v x = ant z;\n        v (x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) < ant z;\n        v (x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) < 0;\n        ant z + v (1\\<^sub>r \\<plusminus> -\\<^sub>a x) =\n        v (x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                         x \\<cdot>\\<^sub>r\n                         (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n                         \\<zero>", "apply (frule_tac x = x and y = \"1\\<^sub>r \\<plusminus> -\\<^sub>a x\" in Ring.ring_tOp_closed[of \"K\"],\n             assumption+,\n       frule one_plus_x_nonzero[of v \"x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> (-\\<^sub>a x))\"],\n                      assumption+, erule conjE,\n       rule val_neg_nonzero[of v], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) OstrowskiTr7:\"\\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> (v x)\\<rbrakk> \\<Longrightarrow>\n  1\\<^sub>r \\<plusminus> -\\<^sub>a (x \\<cdot>\\<^sub>r ((1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen>K\\<^esup>)) =\n     (1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r ((1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen>K\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r\n                                (1\\<^sub>r \\<plusminus>\n                                 x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> =\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>", "apply (cut_tac field_is_ring,\n       frule OstrowskiTr6[of v x], assumption+, simp, erule conjE,\n       cut_tac field_is_idom,\n       cut_tac invf_closed1[of \"1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\"], simp,\n       frule Ring.ring_is_ag[of \"K\"],\n       frule aGroup.ag_mOp_closed[of \"K\" \"x\"], assumption+,\n       frule Ring.ring_one[of \"K\"],\n       frule aGroup.ag_pOp_closed[of \"K\" \"1\\<^sub>r\" \"-\\<^sub>a x\"], assumption+,\n       rule Idomain.idom_mult_cancel_r[of K \"1\\<^sub>r \\<plusminus> -\\<^sub>a (x \\<cdot>\\<^sub>r ((1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r\n       (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen>K\\<^esup>))\" \"(1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r\n       ((1\\<^sub>r \\<plusminus>  x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen>K\\<^esup>)\" \"(1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\"],\n       assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r\n                                (1\\<^sub>r \\<plusminus>\n                                 x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n                      \\<in> carrier K\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n                      \\<in> carrier K\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K\n 4. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n                      \\<zero>\n 5. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  x \\<cdot>\\<^sub>r\n                                  (1\\<^sub>r \\<plusminus>\n                                   -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) =\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\n 6. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (rule aGroup.ag_pOp_closed, assumption+, rule aGroup.ag_mOp_closed,\n       assumption+,\n       rule Ring.ring_tOp_closed, assumption+, simp, rule Ring.ring_tOp_closed,\n       assumption+,\n       (rule aGroup.ag_pOp_closed, assumption+)+,\n       rule  Ring.ring_tOp_closed, assumption+, simp, assumption+,\n       subst Ring.ring_tOp_assoc, assumption+,\n       rule aGroup.ag_pOp_closed, assumption+,\n       simp add:Ring.ring_tOp_closed, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (1\\<^sub>r \\<plusminus>\n                       -\\<^sub>a x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  x \\<cdot>\\<^sub>r\n                                  (1\\<^sub>r \\<plusminus>\n                                   -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) =\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r\n                      ((1\\<^sub>r \\<plusminus>\n                        x \\<cdot>\\<^sub>r\n                        (1\\<^sub>r \\<plusminus>\n                         -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus>\n                        x \\<cdot>\\<^sub>r\n                        (1\\<^sub>r \\<plusminus> -\\<^sub>a x)))\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (subst linvf[of \"1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\"], simp,\n       (subst Ring.ring_distrib2, assumption+)+, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K; aGroup K; -\\<^sub>a x \\<in> carrier K;\n     1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<cdot>\\<^sub>r\n                                (1\\<^sub>r \\<plusminus>\n                                 x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n                      \\<in> carrier K\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<plusminus>\n                      (-\\<^sub>a x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  x \\<cdot>\\<^sub>r\n                                  (1\\<^sub>r \\<plusminus>\n                                   -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) =\n                      (1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<cdot>\\<^sub>r\n                      1\\<^sub>r\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (rule aGroup.ag_mOp_closed, assumption,\n       rule Ring.ring_tOp_closed, assumption+,\n       subst Ring.ring_r_one, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K;\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K \\<and>\n     (1\\<^sub>r \\<plusminus>\n      x \\<cdot>\\<^sub>r\n      (1\\<^sub>r \\<plusminus>\n       -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     aGroup K; -\\<^sub>a x \\<in> carrier K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) \\<plusminus>\n                      (-\\<^sub>a x \\<cdot>\\<^sub>r\n                                 (1\\<^sub>r \\<plusminus>\n                                  x \\<cdot>\\<^sub>r\n                                  (1\\<^sub>r \\<plusminus>\n                                   -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>) \\<cdot>\\<^sub>r\n                      (1\\<^sub>r \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) =\n                      1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n 3. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply (rule aGroup.ag_pOp_closed, assumption+,\n       rule Ring.ring_tOp_closed, assumption+,\n       erule conjE,\n       simp add:Ring.ring_inv1_1,\n       simp add:Ring.ring_tOp_assoc[of K \"-\\<^sub>a x\" \"(1\\<^sub>r \\<plusminus> x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<^bsup>\\<hyphen> K\\<^esup>\"],\n       simp add:linvf, simp add:Ring.ring_r_one Ring.ring_l_one,\n       frule Ring.ring_tOp_closed[of K x \"1\\<^sub>r \\<plusminus> -\\<^sub>a x\"], assumption+,\n       simp add:aGroup.ag_pOp_assoc, simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K; \\<not> 0 \\<le> v x; Ring K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n     \\<in> carrier K;\n     1\\<^sub>r \\<plusminus>\n     x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x) \\<noteq>\n     \\<zero>;\n     Idomain K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus>\n                      x \\<cdot>\\<^sub>r (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\n                      \\<in> carrier K - {\\<zero>}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Ostrowski_elem_nonzero:\"\\<lbrakk>vals_nonequiv K (Suc n) vv;\n x \\<in> carrier K; Ostrowski_elem K (Suc n) vv x\\<rbrakk> \\<Longrightarrow> x \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K (Suc n) vv; x \\<in> carrier K;\n     Ostrowski_elem K (Suc n) vv x\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<zero>", "apply (simp add:Ostrowski_elem_def,\n       frule conjunct1, fold Ostrowski_elem_def,\n       frule vals_nonequiv_valuation[of \"Suc n\" \"vv\" \"0\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K (Suc n) vv; x \\<in> carrier K;\n     Ostrowski_elem K (Suc n) vv x;\n     0 < vv 0 (1\\<^sub>r \\<plusminus> -\\<^sub>a x);\n     valuation K (vv 0)\\<rbrakk>\n    \\<Longrightarrow> x \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+,\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       simp add:aGroup.ag_inv_zero, frule Ring.ring_one[of \"K\"],\n       simp add:aGroup.ag_r_zero, simp add:value_of_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) Ostrowski_elem_not_one:\"\\<lbrakk>vals_nonequiv K (Suc n) vv;\n      x \\<in> carrier K; Ostrowski_elem K (Suc n) vv x\\<rbrakk>  \\<Longrightarrow>  1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K (Suc n) vv; x \\<in> carrier K;\n     Ostrowski_elem K (Suc n) vv x\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<noteq> \\<zero>", "apply (frule vals_nonequiv_valuation [of \"Suc n\" \"vv\" \"Suc 0\"],\n       simp,\n       simp add:Ostrowski_elem_def, frule conjunct2,\n       fold Ostrowski_elem_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>vals_nonequiv K (Suc n) vv; x \\<in> carrier K;\n     Ostrowski_elem K (Suc n) vv x; valuation K (vv (Suc 0));\n     \\<forall>j\\<in>nset (Suc 0) (Suc n). 0 < vv j x\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<noteq> \\<zero>", "apply (subgoal_tac \"0 < (vv (Suc 0) x)\",\n       rule contrapos_pp, simp+,\n       cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule Ring.ring_one[of \"K\"],\n       simp only:aGroup.ag_eq_diffzero[THEN sym, of \"K\" \"1\\<^sub>r\" \"x\"],\n       drule sym, simp, simp add:value_of_one,\n       subgoal_tac \"Suc 0 \\<in> nset (Suc 0) (Suc n)\", simp,\n       simp add:nset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) val_unit_cond:\"\\<lbrakk> valuation K v; x \\<in> carrier K;\n      0 < (v (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<rbrakk>  \\<Longrightarrow> v x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (cut_tac field_is_ring, frule Ring.ring_is_ag[of \"K\"],\n       frule Ring.ring_one[of \"K\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (frule aGroup.ag_mOp_closed[of \"K\" \"1\\<^sub>r\"], assumption+,\n       frule has_val_one_neq_zero[of v])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (frule aGroup.ag_pOp_assoc[of \"K\" \"-\\<^sub>a 1\\<^sub>r\" \"1\\<^sub>r\" \"-\\<^sub>a x\"], assumption+,\n       simp add:aGroup.ag_mOp_closed, simp add:aGroup.ag_l_inv1,\n       frule aGroup.ag_mOp_closed[of \"K\" \"x\"], assumption+,\n       simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>;\n     -\\<^sub>a x =\n     -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x);\n     -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (subgoal_tac \"v (-\\<^sub>a x) = v ( -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>;\n     -\\<^sub>a x =\n     -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x);\n     -\\<^sub>a x \\<in> carrier K;\n     v (-\\<^sub>a x) =\n     v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n        (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<rbrakk>\n    \\<Longrightarrow> v x = 0\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>;\n     -\\<^sub>a x =\n     -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x);\n     -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v (-\\<^sub>a x) =\n                      v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n                         (1\\<^sub>r \\<plusminus> -\\<^sub>a x))", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>;\n     -\\<^sub>a x =\n     -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x);\n     -\\<^sub>a x \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> v (-\\<^sub>a x) =\n                      v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n                         (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\n 2. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>;\n     -\\<^sub>a x =\n     -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x);\n     -\\<^sub>a x \\<in> carrier K;\n     v (-\\<^sub>a x) =\n     v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n        (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>;\n     -\\<^sub>a x =\n     -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x);\n     -\\<^sub>a x \\<in> carrier K;\n     v (-\\<^sub>a x) =\n     v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n        (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<rbrakk>\n    \\<Longrightarrow> v x = 0", "apply (thin_tac \"-\\<^sub>a x =  -\\<^sub>a 1\\<^sub>r \\<plusminus> (1\\<^sub>r \\<plusminus> -\\<^sub>a x)\",\n       frule value_less_eq[of \"v\" \"-\\<^sub>a 1\\<^sub>r\" \"1\\<^sub>r \\<plusminus> -\\<^sub>a x\"],\n                                  assumption+,\n       rule aGroup.ag_pOp_closed, assumption+,\n       simp add:val_minus_eq value_of_one, simp add:val_minus_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>valuation K v; x \\<in> carrier K;\n     0 < v (1\\<^sub>r \\<plusminus> -\\<^sub>a x); Ring K; aGroup K;\n     1\\<^sub>r \\<in> carrier K; -\\<^sub>a 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r \\<noteq> \\<zero>; -\\<^sub>a x \\<in> carrier K;\n     v x =\n     v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n        (1\\<^sub>r \\<plusminus> -\\<^sub>a x));\n     v 1\\<^sub>r =\n     v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n        (1\\<^sub>r \\<plusminus> -\\<^sub>a x))\\<rbrakk>\n    \\<Longrightarrow> v (-\\<^sub>a 1\\<^sub>r \\<plusminus>\n                         (1\\<^sub>r \\<plusminus> -\\<^sub>a x)) =\n                      0", "apply (simp add: value_of_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "end"]]}