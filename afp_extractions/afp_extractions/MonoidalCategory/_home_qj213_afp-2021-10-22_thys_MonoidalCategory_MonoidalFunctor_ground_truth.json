{"file_name": "/home/qj213/afp-2021-10-22/thys/MonoidalCategory/MonoidalFunctor.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/MonoidalCategory", "problem_names": ["lemma \\<phi>_in_hom:\n    assumes \"C.ide a\" and \"C.ide b\"\n    shows \"\\<guillemotleft>\\<phi> (a, b) : F a \\<otimes>\\<^sub>D F b \\<rightarrow>\\<^sub>D F (a \\<otimes>\\<^sub>C b)\\<guillemotright>\"", "lemma \\<iota>\\<^sub>1_in_hom:\n    shows \"\\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>\"", "lemma \\<iota>\\<^sub>1_is_iso:\n    shows \"D.iso \\<iota>\\<^sub>1\"", "lemma \\<I>\\<^sub>1_char [simp]:\n    shows \"\\<I>\\<^sub>1 = F \\<I>\\<^sub>C\"", "lemma \\<psi>_char:\n    shows \"\\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>\" and \"D.iso \\<psi>\" and \"\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\"\n    and \"\\<exists>!\\<psi>. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<psi> \\<and> \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\"", "lemma \\<psi>_eqI:\n    assumes \"\\<guillemotleft>f: \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>\" and \"D.iso f\" and \"f \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (f \\<otimes>\\<^sub>D f)\"\n    shows \"f = \\<psi>\"", "lemma lunit_coherence1:\n    assumes \"C.ide a\"\n    shows \"\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) = \\<l>\\<^sub>D[F a]\"", "lemma lunit_coherence2:\n    assumes \"C.ide a\"\n    shows \"F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) = \\<l>\\<^sub>1[F a]\"", "lemma lunit_coherence:\n    assumes \"C.ide a\"\n    shows \"\\<l>\\<^sub>D[F a] = F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)\"", "lemma induces_monoidal_functor_between_opposites:\n    shows \"monoidal_functor C C'.T C'.\\<alpha> \\<iota>\\<^sub>C D D'.T D'.\\<alpha> \\<iota>\\<^sub>D F (\\<lambda>f. \\<phi> (snd f, fst f))\"", "lemma runit_coherence:\n    assumes \"C.ide a\"\n    shows \"\\<r>\\<^sub>D[F a] = F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (a, \\<I>\\<^sub>C) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)\"", "lemma strictly_preserves_tensor:\n    assumes \"C.arr f\" and \"C.arr g\"\n    shows \"F (f \\<otimes>\\<^sub>C g) = F f \\<otimes>\\<^sub>D F g\"", "lemma strictly_preserves_\\<alpha>:\n    assumes \"C.arr f\" and \"C.arr g\" and \"C.arr h\"\n    shows \"F (\\<alpha>\\<^sub>C (f, g, h)) = \\<alpha>\\<^sub>D (F f, F g, F h)\"", "lemma strictly_preserves_unity:\n    shows \"F \\<I>\\<^sub>C = \\<I>\\<^sub>D\"", "lemma strictly_preserves_assoc:\n    assumes \"C.arr a\" and \"C.arr b\" and \"C.arr c\"\n    shows \"F \\<a>\\<^sub>C[a, b, c] = \\<a>\\<^sub>D[F a, F b, F c] \"", "lemma strictly_preserves_lunit:\n    assumes \"C.ide a\"\n    shows \"F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]\"", "lemma strictly_preserves_runit:\n    assumes \"C.ide a\"\n    shows \"F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]\"", "lemma structure_is_trivial:\n    shows \"T\\<^sub>DoFF.map = FoT\\<^sub>C.map\"", "lemma structure_is_natural_isomorphism:\n    shows \"natural_isomorphism C.CC.comp D T\\<^sub>DoFF.map FoT\\<^sub>C.map \\<phi>\"", "lemma strict_monoidal_functors_compose:\n  assumes \"strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C F\"\n  and \"strict_monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D G\"\n  shows \"strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D (G o F)\""], "translations": [["", "lemma \\<phi>_in_hom:\n    assumes \"C.ide a\" and \"C.ide b\"\n    shows \"\\<guillemotleft>\\<phi> (a, b) : F a \\<otimes>\\<^sub>D F b \\<rightarrow>\\<^sub>D F (a \\<otimes>\\<^sub>C b)\\<guillemotright>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<phi>\n                     (a, b) : F a \\<otimes>\\<^sub>D\n                              F b \\<rightarrow>\\<^sub>D F\n                   (a \\<otimes>\\<^sub>C b)\\<guillemotright>", "using assms"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<phi>\n                     (a, b) : F a \\<otimes>\\<^sub>D\n                              F b \\<rightarrow>\\<^sub>D F\n                   (a \\<otimes>\\<^sub>C b)\\<guillemotright>", "by auto"], ["", "text \\<open>\n      We wish to exhibit a canonical definition of an isomorphism\n      @{term \"\\<psi> \\<in> D.hom \\<I>\\<^sub>D (F \\<I>\\<^sub>C)\"} that satisfies certain coherence conditions that\n      involve the left and right unitors.  In \\cite{Etingof15}, the isomorphism @{term \\<psi>}\n      is defined by the equation @{term \"\\<l>\\<^sub>D[F \\<I>\\<^sub>C] = F \\<l>\\<^sub>C[\\<I>\\<^sub>C] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\"},\n      which suffices for the definition because the functor \\<open>- \\<otimes>\\<^sub>D F \\<I>\\<^sub>C\\<close> is fully faithful.\n      It is then asserted (Proposition 2.4.3) that the coherence condition\n      @{term \"\\<l>\\<^sub>D[F a] = F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)\"} is satisfied for any object @{term a}\n      of \\<open>C\\<close>, as well as the corresponding condition for the right unitor.\n      However, the proof is left as an exercise (Exercise 2.4.4).\n      The organization of the presentation suggests that that one should derive the\n      general coherence condition from the special case\n      @{term \"\\<l>\\<^sub>D[F \\<I>\\<^sub>C] = F \\<l>\\<^sub>C[\\<I>\\<^sub>C] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\"} used as the definition of @{term \\<psi>}.\n      However, I did not see how to do it that way, so I used a different approach.\n      The isomorphism @{term \"\\<iota>\\<^sub>D' \\<equiv> F \\<iota>\\<^sub>C \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C)\"} serves as an alternative unit for the\n      monoidal category \\<open>D\\<close>.  There is consequently a unique isomorphism that maps\n      @{term \"\\<iota>\\<^sub>D\"} to @{term \"\\<iota>\\<^sub>D'\"}.  We define @{term \\<psi>} to be this isomorphism and then use\n      the definition to establish the desired coherence conditions.\n\\<close>"], ["", "abbreviation \\<iota>\\<^sub>1\n    where \"\\<iota>\\<^sub>1 \\<equiv> F \\<iota>\\<^sub>C \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C)\""], ["", "lemma \\<iota>\\<^sub>1_in_hom:\n    shows \"\\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\nF \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>", "using C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\nF \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>", "by (intro D.in_homI, auto)"], ["", "lemma \\<iota>\\<^sub>1_is_iso:\n    shows \"D.iso \\<iota>\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.iso \\<iota>\\<^sub>1", "using C.\\<iota>_is_iso C.\\<iota>_in_hom \\<phi>_in_hom D.isos_compose"], ["proof (prove)\nusing this:\n  C.iso \\<iota>\\<^sub>C\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n  \\<lbrakk>D.iso ?f; D.iso ?f'; D.seq ?f' ?f\\<rbrakk>\n  \\<Longrightarrow> D.iso (?f' \\<cdot>\\<^sub>D ?f)\n\ngoal (1 subgoal):\n 1. D.iso \\<iota>\\<^sub>1", "by auto"], ["", "interpretation D: monoidal_category_with_alternate_unit D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1"], ["proof (prove)\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "have 1: \"\\<exists>\\<psi>. \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and> D.iso \\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n       D.iso \\<psi>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n       D.iso \\<psi>", "obtain \\<psi>' where \\<psi>': \"\\<guillemotleft>\\<psi>' : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<psi>'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>'.\n        \\<guillemotleft>\\<psi>' : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n        D.iso \\<psi>' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using preserves_unity"], ["proof (prove)\nusing this:\n  D.isomorphic \\<I>\\<^sub>D (F \\<I>\\<^sub>C)\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>'.\n        \\<guillemotleft>\\<psi>' : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n        D.iso \\<psi>' \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  \\<guillemotleft>\\<psi>' : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                          \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<psi>'\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n       D.iso \\<psi>", "have \"\\<guillemotleft>D.inv \\<psi>' : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and> D.iso (D.inv \\<psi>')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft>D.inv\n                     \\<psi>' : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n    D.iso (D.inv \\<psi>')", "using \\<psi>'"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi>' : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                          \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<psi>'\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>D.inv\n                     \\<psi>' : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n    D.iso (D.inv \\<psi>')", "by simp"], ["proof (state)\nthis:\n  \\<guillemotleft>D.inv\n                   \\<psi>' : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n  D.iso (D.inv \\<psi>')\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n       D.iso \\<psi>", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<guillemotleft>D.inv\n                   \\<psi>' : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n  D.iso (D.inv \\<psi>')\n\ngoal (1 subgoal):\n 1. \\<exists>\\<psi>.\n       \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n       D.iso \\<psi>", "by auto"], ["proof (state)\nthis:\n  \\<exists>\\<psi>.\n     \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n     D.iso \\<psi>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>\\<psi>.\n     \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n     D.iso \\<psi>\n\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "obtain \\<psi> where \\<psi>: \"\\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and> D.iso \\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n        D.iso \\<psi> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using 1"], ["proof (prove)\nusing this:\n  \\<exists>\\<psi>.\n     \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n     D.iso \\<psi>\n\ngoal (1 subgoal):\n 1. (\\<And>\\<psi>.\n        \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n        D.iso \\<psi> \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n  D.iso \\<psi>\n\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "interpret L: equivalence_functor D D \\<open>\\<lambda>f. (D.cod \\<iota>\\<^sub>1) \\<otimes>\\<^sub>D f\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "interpret L: \"functor\" D D \\<open>\\<lambda>f. (F \\<I>\\<^sub>C) \\<otimes>\\<^sub>D f\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))", "using D.T.fixing_ide_gives_functor_1"], ["proof (prove)\nusing this:\n  D.ide ?a1.0 \\<Longrightarrow>\n  functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D) ((\\<otimes>\\<^sub>D) ?a1.0)\n\ngoal (1 subgoal):\n 1. functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))", "by simp"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "interpret L: endofunctor D \\<open>\\<lambda>f. (F \\<I>\\<^sub>C) \\<otimes>\\<^sub>D f\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. endofunctor (\\<cdot>\\<^sub>D) ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "interpret \\<psi>x: natural_transformation D D \\<open>\\<lambda>f. (F \\<I>\\<^sub>C) \\<otimes>\\<^sub>D f\\<close> \\<open>\\<lambda>f. \\<I>\\<^sub>D \\<otimes>\\<^sub>D f\\<close>\n                        \\<open>\\<lambda>f. \\<psi> \\<otimes>\\<^sub>D f\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_transformation (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))\n     ((\\<otimes>\\<^sub>D) \\<I>\\<^sub>D) ((\\<otimes>\\<^sub>D) \\<psi>)", "using \\<psi> D.T.fixing_arr_gives_natural_transformation_1 [of \\<psi>]"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n  D.iso \\<psi>\n  D.arr \\<psi> \\<Longrightarrow>\n  natural_transformation (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) (D.dom \\<psi>)) ((\\<otimes>\\<^sub>D) (D.cod \\<psi>))\n   ((\\<otimes>\\<^sub>D) \\<psi>)\n\ngoal (1 subgoal):\n 1. natural_transformation (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))\n     ((\\<otimes>\\<^sub>D) \\<I>\\<^sub>D) ((\\<otimes>\\<^sub>D) \\<psi>)", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "interpret \\<psi>x: natural_isomorphism D D \\<open>\\<lambda>f. (F \\<I>\\<^sub>C) \\<otimes>\\<^sub>D f\\<close> \\<open>\\<lambda>f. \\<I>\\<^sub>D \\<otimes>\\<^sub>D f\\<close> \\<open>\\<lambda>f. \\<psi> \\<otimes>\\<^sub>D f\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))\n     ((\\<otimes>\\<^sub>D) \\<I>\\<^sub>D) ((\\<otimes>\\<^sub>D) \\<psi>)", "apply unfold_locales"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a. D.ide a \\<Longrightarrow> D.iso (\\<psi> \\<otimes>\\<^sub>D a)", "using \\<psi> D.tensor_preserves_iso"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n  D.iso \\<psi>\n  \\<lbrakk>D.iso ?f; D.iso ?g\\<rbrakk>\n  \\<Longrightarrow> D.iso (?f \\<otimes>\\<^sub>D ?g)\n\ngoal (1 subgoal):\n 1. \\<And>a. D.ide a \\<Longrightarrow> D.iso (\\<psi> \\<otimes>\\<^sub>D a)", "by simp"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "interpret \\<ll>\\<^sub>Do\\<psi>x: vertical_composite D D \\<open>\\<lambda>f. (F \\<I>\\<^sub>C) \\<otimes>\\<^sub>D f\\<close> \\<open>\\<lambda>f. \\<I>\\<^sub>D \\<otimes>\\<^sub>D f\\<close> D.map\n                                           \\<open>\\<lambda>f. \\<psi> \\<otimes>\\<^sub>D f\\<close> D.\\<ll>"], ["proof (prove)\ngoal (1 subgoal):\n 1. vertical_composite (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))\n     ((\\<otimes>\\<^sub>D) \\<I>\\<^sub>D) D.map ((\\<otimes>\\<^sub>D) \\<psi>)\n     D.\\<ll>", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "interpret \\<ll>\\<^sub>Do\\<psi>x: natural_isomorphism D D \\<open>\\<lambda>f. (F \\<I>\\<^sub>C) \\<otimes>\\<^sub>D f\\<close> D.map \\<ll>\\<^sub>Do\\<psi>x.map"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C)) D.map \\<ll>\\<^sub>Do\\<psi>x.map", "using \\<psi>x.natural_isomorphism_axioms D.\\<ll>.natural_isomorphism_axioms\n                natural_isomorphisms_compose"], ["proof (prove)\nusing this:\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C)) ((\\<otimes>\\<^sub>D) \\<I>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) \\<psi>)\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) \\<I>\\<^sub>D) D.map D.\\<ll>\n  \\<lbrakk>natural_isomorphism ?A ?B ?F ?G ?\\<sigma>;\n   natural_isomorphism ?A ?B ?G ?H ?\\<tau>\\<rbrakk>\n  \\<Longrightarrow> natural_isomorphism ?A ?B ?F ?H\n                     (vertical_composite.map ?A ?B ?\\<sigma> ?\\<tau>)\n\ngoal (1 subgoal):\n 1. natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C)) D.map \\<ll>\\<^sub>Do\\<psi>x.map", "by blast"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "interpret L: equivalence_functor D D \\<open>\\<lambda>f. (F \\<I>\\<^sub>C) \\<otimes>\\<^sub>D f\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))", "using L.isomorphic_to_identity_is_equivalence \\<ll>\\<^sub>Do\\<psi>x.natural_isomorphism_axioms"], ["proof (prove)\nusing this:\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C)) D.map ?\\<phi> \\<Longrightarrow>\n  equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C)) D.map \\<ll>\\<^sub>Do\\<psi>x.map\n\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))", "by simp"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "show \"equivalence_functor D D (\\<lambda>f. (D.cod \\<iota>\\<^sub>1) \\<otimes>\\<^sub>D f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "using L.equivalence_functor_axioms C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) (F \\<I>\\<^sub>C))\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))", "by auto"], ["proof (state)\nthis:\n  equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   ((\\<otimes>\\<^sub>D) (D.cod \\<iota>\\<^sub>1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "interpret R: equivalence_functor D D \\<open>\\<lambda>f. T\\<^sub>D (f, D.cod \\<iota>\\<^sub>1)\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "interpret R: \"functor\" D D \\<open>\\<lambda>f. T\\<^sub>D (f, F \\<I>\\<^sub>C)\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)", "using D.T.fixing_ide_gives_functor_2"], ["proof (prove)\nusing this:\n  D.ide ?a2.0 \\<Longrightarrow>\n  functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f1. f1 \\<otimes>\\<^sub>D ?a2.0)\n\ngoal (1 subgoal):\n 1. functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)", "by simp"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "interpret R: endofunctor D \\<open>\\<lambda>f. T\\<^sub>D (f, F \\<I>\\<^sub>C)\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. endofunctor (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "interpret x\\<psi>: natural_transformation D D \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D (F \\<I>\\<^sub>C)\\<close> \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D\\<close>\n                        \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_transformation (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>)", "using \\<psi> D.T.fixing_arr_gives_natural_transformation_2 [of \\<psi>]"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n  D.iso \\<psi>\n  D.arr \\<psi> \\<Longrightarrow>\n  natural_transformation (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f1. f1 \\<otimes>\\<^sub>D D.dom \\<psi>)\n   (\\<lambda>f1. f1 \\<otimes>\\<^sub>D D.cod \\<psi>)\n   (\\<lambda>f1. f1 \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (1 subgoal):\n 1. natural_transformation (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>)", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "interpret x\\<psi>: natural_isomorphism D D \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D (F \\<I>\\<^sub>C)\\<close> \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D\\<close> \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>)", "using \\<psi> D.tensor_preserves_iso"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi> : F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright> \\<and>\n  D.iso \\<psi>\n  \\<lbrakk>D.iso ?f; D.iso ?g\\<rbrakk>\n  \\<Longrightarrow> D.iso (?f \\<otimes>\\<^sub>D ?g)\n\ngoal (1 subgoal):\n 1. natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>)", "by (unfold_locales, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "interpret \\<rho>\\<^sub>Dox\\<psi>: vertical_composite D D \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D (F \\<I>\\<^sub>C)\\<close> \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D\\<close> D.map\n                                                \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>\\<close> D.\\<rho>"], ["proof (prove)\ngoal (1 subgoal):\n 1. vertical_composite (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D) D.map\n     (\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>) D.\\<rho>", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "interpret \\<rho>\\<^sub>Dox\\<psi>: natural_isomorphism D D \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D (F \\<I>\\<^sub>C)\\<close> D.map \\<rho>\\<^sub>Dox\\<psi>.map"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C) D.map\n     \\<rho>\\<^sub>Dox\\<psi>.map", "using x\\<psi>.natural_isomorphism_axioms D.\\<rho>.natural_isomorphism_axioms\n                natural_isomorphisms_compose"], ["proof (prove)\nusing this:\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D \\<psi>)\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D \\<I>\\<^sub>D) D.map D.\\<rho>\n  \\<lbrakk>natural_isomorphism ?A ?B ?F ?G ?\\<sigma>;\n   natural_isomorphism ?A ?B ?G ?H ?\\<tau>\\<rbrakk>\n  \\<Longrightarrow> natural_isomorphism ?A ?B ?F ?H\n                     (vertical_composite.map ?A ?B ?\\<sigma> ?\\<tau>)\n\ngoal (1 subgoal):\n 1. natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C) D.map\n     \\<rho>\\<^sub>Dox\\<psi>.map", "by blast"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "interpret R: equivalence_functor D D \\<open>\\<lambda>f. f \\<otimes>\\<^sub>D (F \\<I>\\<^sub>C)\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)", "using R.isomorphic_to_identity_is_equivalence \\<rho>\\<^sub>Dox\\<psi>.natural_isomorphism_axioms"], ["proof (prove)\nusing this:\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C) D.map\n   ?\\<phi> \\<Longrightarrow>\n  equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n  natural_isomorphism (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C) D.map\n   \\<rho>\\<^sub>Dox\\<psi>.map\n\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)", "by simp"], ["proof (state)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "show \"equivalence_functor D D (\\<lambda>f. f \\<otimes>\\<^sub>D (D.cod \\<iota>\\<^sub>1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "using R.equivalence_functor_axioms C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D F \\<I>\\<^sub>C)\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n     (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)", "by auto"], ["proof (state)\nthis:\n  equivalence_functor (\\<cdot>\\<^sub>D) (\\<cdot>\\<^sub>D)\n   (\\<lambda>f. f \\<otimes>\\<^sub>D D.cod \\<iota>\\<^sub>1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "show \"monoidal_category_with_alternate_unit D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "using D.pentagon C.\\<iota>_is_iso C.\\<iota>_in_hom preserves_hom \\<iota>\\<^sub>1_is_iso \\<iota>\\<^sub>1_in_hom"], ["proof (prove)\nusing this:\n  \\<lbrakk>D.ide ?a; D.ide ?b; D.ide ?c; D.ide ?d\\<rbrakk>\n  \\<Longrightarrow> (?a \\<otimes>\\<^sub>D\n                     \\<a>\\<^sub>D[?b, ?c, ?d]) \\<cdot>\\<^sub>D\n                    \\<a>\\<^sub>D[?a, ?b \\<otimes>\\<^sub>D\n                                     ?c, ?d] \\<cdot>\\<^sub>D\n                    (\\<a>\\<^sub>D[?a, ?b, ?c] \\<otimes>\\<^sub>D ?d) =\n                    \\<a>\\<^sub>D[?a, ?b, ?c \\<otimes>\\<^sub>D\n   ?d] \\<cdot>\\<^sub>D\n                    \\<a>\\<^sub>D[?a \\<otimes>\\<^sub>D ?b, ?c, ?d]\n  C.iso \\<iota>\\<^sub>C\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n  \\<guillemotleft>?f : ?a \\<rightarrow>\\<^sub>C ?b\\<guillemotright> \\<Longrightarrow>\n  \\<guillemotleft>F ?f : F ?a \\<rightarrow>\\<^sub>D F ?b\\<guillemotright>\n  D.iso \\<iota>\\<^sub>1\n  \\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n                                    F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F\n                                    \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n     \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1", "by (unfold_locales, auto)"], ["proof (state)\nthis:\n  monoidal_category_with_alternate_unit (\\<cdot>\\<^sub>D) T\\<^sub>D\n   \\<alpha>\\<^sub>D \\<iota>\\<^sub>D \\<iota>\\<^sub>1\n\ngoal:\nNo subgoals!", "qed"], ["", "no_notation D.tensor   (infixr \"\\<otimes>\\<^sub>D\" 53)"], ["", "notation D.C\\<^sub>1.tensor   (infixr \"\\<otimes>\\<^sub>D\" 53)"], ["", "(* equal to D.tensor *)"], ["", "no_notation D.assoc    (\"\\<a>\\<^sub>D[_, _, _]\")"], ["", "notation D.C\\<^sub>1.assoc    (\"\\<a>\\<^sub>D[_, _, _]\")"], ["", "(* equal to D.assoc *)"], ["", "no_notation D.assoc'   (\"\\<a>\\<^sub>D\\<^sup>-\\<^sup>1[_, _, _]\")"], ["", "notation D.C\\<^sub>1.assoc'   (\"\\<a>\\<^sub>D\\<^sup>-\\<^sup>1[_, _, _]\")"], ["", "(* equal to D.assoc' *)"], ["", "notation D.C\\<^sub>1.unity    (\"\\<I>\\<^sub>1\")"], ["", "notation D.C\\<^sub>1.lunit    (\"\\<l>\\<^sub>1[_]\")"], ["", "notation D.C\\<^sub>1.runit    (\"\\<r>\\<^sub>1[_]\")"], ["", "lemma \\<I>\\<^sub>1_char [simp]:\n    shows \"\\<I>\\<^sub>1 = F \\<I>\\<^sub>C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<I>\\<^sub>1 = F \\<I>\\<^sub>C", "using D.C\\<^sub>1.unity_def \\<iota>\\<^sub>1_in_hom"], ["proof (prove)\nusing this:\n  \\<I>\\<^sub>1 \\<equiv> D.cod \\<iota>\\<^sub>1\n  \\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n                                    F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F\n                                    \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. \\<I>\\<^sub>1 = F \\<I>\\<^sub>C", "by auto"], ["", "definition \\<psi>\n    where \"\\<psi> \\<equiv> THE \\<psi>. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<psi> \\<and> \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\""], ["", "lemma \\<psi>_char:\n    shows \"\\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>\" and \"D.iso \\<psi>\" and \"\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\"\n    and \"\\<exists>!\\<psi>. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<psi> \\<and> \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                            \\<I>\\<^sub>C\\<guillemotright> &&&\n     D.iso \\<psi>) &&&\n    \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>) &&&\n    \\<exists>!\\<psi>.\n       \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                              \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso \\<psi> \\<and>\n       \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "proof -"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                           \\<I>\\<^sub>C\\<guillemotright>\n 2. D.iso \\<psi>\n 3. \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n 4. \\<exists>!\\<psi>.\n       \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                              \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso \\<psi> \\<and>\n       \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "show \"\\<exists>!\\<psi>. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<psi> \\<and> \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>!\\<psi>.\n       \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                              \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso \\<psi> \\<and>\n       \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "using D.unit_unique_upto_unique_iso \\<iota>\\<^sub>1_in_hom D.C\\<^sub>1.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  \\<exists>!f.\n     \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D \\<I>\\<^sub>1\\<guillemotright> \\<and>\n     D.iso f \\<and>\n     f \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (f \\<otimes>\\<^sub>D f)\n  \\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n                                    F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F\n                                    \\<I>\\<^sub>C\\<guillemotright>\n  \\<guillemotleft>\\<iota>\\<^sub>1 : \\<I>\\<^sub>1 \\<otimes>\\<^sub>D\n                                    \\<I>\\<^sub>1 \\<rightarrow>\\<^sub>D \\<I>\\<^sub>1\\<guillemotright>\n\ngoal (1 subgoal):\n 1. \\<exists>!\\<psi>.\n       \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                              \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso \\<psi> \\<and>\n       \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "by (elim D.in_homE, auto)"], ["proof (state)\nthis:\n  \\<exists>!\\<psi>.\n     \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                            \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso \\<psi> \\<and>\n     \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (3 subgoals):\n 1. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                           \\<I>\\<^sub>C\\<guillemotright>\n 2. D.iso \\<psi>\n 3. \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "hence 1: \"\\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<psi> \\<and> \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\""], ["proof (prove)\nusing this:\n  \\<exists>!\\<psi>.\n     \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                            \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso \\<psi> \\<and>\n     \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                           \\<I>\\<^sub>C\\<guillemotright> \\<and>\n    D.iso \\<psi> \\<and>\n    \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "unfolding \\<psi>_def"], ["proof (prove)\nusing this:\n  \\<exists>!\\<psi>.\n     \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                            \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso \\<psi> \\<and>\n     \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>THE \\<psi>.\n                       \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n        \\<I>\\<^sub>C\\<guillemotright> \\<and>\n                       D.iso \\<psi> \\<and>\n                       \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n                       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n                       (\\<psi> \\<otimes>\\<^sub>D\n                        \\<psi>) : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n    D.iso\n     (THE \\<psi>.\n         \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n         D.iso \\<psi> \\<and>\n         \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n         \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n         (\\<psi> \\<otimes>\\<^sub>D \\<psi>)) \\<and>\n    (THE \\<psi>.\n        \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                               \\<I>\\<^sub>C\\<guillemotright> \\<and>\n        D.iso \\<psi> \\<and>\n        \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n        \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n        (\\<psi> \\<otimes>\\<^sub>D \\<psi>)) \\<cdot>\\<^sub>D\n    \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n    ((THE \\<psi>.\n         \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n         D.iso \\<psi> \\<and>\n         \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n         \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n         (\\<psi> \\<otimes>\\<^sub>D \\<psi>)) \\<otimes>\\<^sub>D\n     (THE \\<psi>.\n         \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n         D.iso \\<psi> \\<and>\n         \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n         \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)))", "using theI' [of \"\\<lambda>\\<psi>. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<psi> \\<and> \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\"]"], ["proof (prove)\nusing this:\n  \\<exists>!\\<psi>.\n     \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                            \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso \\<psi> \\<and>\n     \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n  \\<exists>!x.\n     \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                       \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso x \\<and>\n     x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n     (x \\<otimes>\\<^sub>D x) \\<Longrightarrow>\n  \\<guillemotleft>THE x.\n                     \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n \\<I>\\<^sub>C\\<guillemotright> \\<and>\n                     D.iso x \\<and>\n                     x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n                     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n                     (x \\<otimes>\\<^sub>D\n                      x) : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso\n   (THE x.\n       \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso x \\<and>\n       x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (x \\<otimes>\\<^sub>D x)) \\<and>\n  (THE x.\n      \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                        \\<I>\\<^sub>C\\<guillemotright> \\<and>\n      D.iso x \\<and>\n      x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n      \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n      (x \\<otimes>\\<^sub>D x)) \\<cdot>\\<^sub>D\n  \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n  ((THE x.\n       \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso x \\<and>\n       x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n       (x \\<otimes>\\<^sub>D x)) \\<otimes>\\<^sub>D\n   (THE x.\n       \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso x \\<and>\n       x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (x \\<otimes>\\<^sub>D x)))\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>THE \\<psi>.\n                       \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n        \\<I>\\<^sub>C\\<guillemotright> \\<and>\n                       D.iso \\<psi> \\<and>\n                       \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n                       \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n                       (\\<psi> \\<otimes>\\<^sub>D\n                        \\<psi>) : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n    D.iso\n     (THE \\<psi>.\n         \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n         D.iso \\<psi> \\<and>\n         \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n         \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n         (\\<psi> \\<otimes>\\<^sub>D \\<psi>)) \\<and>\n    (THE \\<psi>.\n        \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                               \\<I>\\<^sub>C\\<guillemotright> \\<and>\n        D.iso \\<psi> \\<and>\n        \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n        \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n        (\\<psi> \\<otimes>\\<^sub>D \\<psi>)) \\<cdot>\\<^sub>D\n    \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n    ((THE \\<psi>.\n         \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n         D.iso \\<psi> \\<and>\n         \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n         \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n         (\\<psi> \\<otimes>\\<^sub>D \\<psi>)) \\<otimes>\\<^sub>D\n     (THE \\<psi>.\n         \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n         D.iso \\<psi> \\<and>\n         \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n         \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)))", "by fast"], ["proof (state)\nthis:\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<psi> \\<and>\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (3 subgoals):\n 1. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                           \\<I>\\<^sub>C\\<guillemotright>\n 2. D.iso \\<psi>\n 3. \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "show \"\\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                           \\<I>\\<^sub>C\\<guillemotright>", "using 1"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<psi> \\<and>\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                           \\<I>\\<^sub>C\\<guillemotright>", "by simp"], ["proof (state)\nthis:\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (2 subgoals):\n 1. D.iso \\<psi>\n 2. \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "show \"D.iso \\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.iso \\<psi>", "using 1"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<psi> \\<and>\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (1 subgoal):\n 1. D.iso \\<psi>", "by simp"], ["proof (state)\nthis:\n  D.iso \\<psi>\n\ngoal (1 subgoal):\n 1. \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "show \"\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "using 1"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<psi> \\<and>\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal (1 subgoal):\n 1. \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)", "by simp"], ["proof (state)\nthis:\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma \\<psi>_eqI:\n    assumes \"\\<guillemotleft>f: \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright>\" and \"D.iso f\" and \"f \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (f \\<otimes>\\<^sub>D f)\"\n    shows \"f = \\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f = \\<psi>", "using assms \\<psi>_def \\<psi>_char\n            the1_equality [of \"\\<lambda>f. \\<guillemotleft>f: \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso f \\<and> f \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (f \\<otimes>\\<^sub>D f)\" f]"], ["proof (prove)\nusing this:\n  \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                    \\<I>\\<^sub>C\\<guillemotright>\n  D.iso f\n  f \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (f \\<otimes>\\<^sub>D f)\n  \\<psi> \\<equiv>\n  THE \\<psi>.\n     \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                            \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso \\<psi> \\<and>\n     \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n  \\<exists>!\\<psi>.\n     \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                            \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso \\<psi> \\<and>\n     \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n     \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n  \\<lbrakk>\\<exists>!x.\n              \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                \\<I>\\<^sub>C\\<guillemotright> \\<and>\n              D.iso x \\<and>\n              x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n              \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (x \\<otimes>\\<^sub>D x);\n   \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                     \\<I>\\<^sub>C\\<guillemotright> \\<and>\n   D.iso f \\<and>\n   f \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n   \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (f \\<otimes>\\<^sub>D f)\\<rbrakk>\n  \\<Longrightarrow> (THE x.\n                        \\<guillemotleft>x : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n    \\<I>\\<^sub>C\\<guillemotright> \\<and>\n                        D.iso x \\<and>\n                        x \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n                        \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D\n                        (x \\<otimes>\\<^sub>D x)) =\n                    f\n\ngoal (1 subgoal):\n 1. f = \\<psi>", "by simp"], ["", "lemma lunit_coherence1:\n    assumes \"C.ide a\"\n    shows \"\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) = \\<l>\\<^sub>D[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "have \"D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)) \\<l>\\<^sub>D[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n     \\<l>\\<^sub>D[F a]", "using assms D.C\\<^sub>1.lunit_in_hom D.tensor_in_hom D.lunit_in_hom \\<psi>_char(1) C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  D.ide ?a \\<Longrightarrow>\n  \\<guillemotleft>\\<l>\\<^sub>1[?a] : \\<I>\\<^sub>1 \\<otimes>\\<^sub>D\n                                     ?a \\<rightarrow>\\<^sub>D ?a\\<guillemotright>\n  \\<lbrakk>\\<guillemotleft>?f : ?a \\<rightarrow>\\<^sub>D ?b\\<guillemotright>;\n   \\<guillemotleft>?g : ?c \\<rightarrow>\\<^sub>D ?d\\<guillemotright>\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>?f \\<otimes>\\<^sub>D\n                                    ?g : ?a \\<otimes>\\<^sub>D\n   ?c \\<rightarrow>\\<^sub>D ?b \\<otimes>\\<^sub>D ?d\\<guillemotright>\n  D.ide ?a \\<Longrightarrow>\n  \\<guillemotleft>\\<l>\\<^sub>D[?a] : \\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                                     ?a \\<rightarrow>\\<^sub>D ?a\\<guillemotright>\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n     \\<l>\\<^sub>D[F a]", "by auto"], ["proof (state)\nthis:\n  D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n   \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "text \\<open>\n        The upper left triangle in the following diagram commutes.\n\\<close>"], ["proof (state)\nthis:\n  D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n   \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "text \\<open>\n\\newcommand\\xIc{{\\cal I}}\n\\newcommand\\xId{{\\cal I}}\n\\newcommand\\xac[3]{{\\scriptsize \\<open>\\<a>\\<close>}[{#1},{#2},{#3}]}\n\\newcommand\\xad[3]{{\\scriptsize \\<open>\\<a>\\<close>}[{#1},{#2},{#3}]}\n\\newcommand\\xlc[1]{{\\scriptsize \\<open>\\<l>\\<close>}[{#1}]}\n\\newcommand\\xld[1]{{\\scriptsize \\<open>\\<l>\\<close>}[{#1}]}\n\\newcommand\\xldp[1]{{\\scriptsize \\<open>\\<l>\\<close>}_1[{#1}]}\n$$\\xymatrix{\n  {\\xId\\otimes F a}\n     \\ar[rrr]^{\\psi\\otimes F a}\n  & & &\n  {F\\xIc\\otimes F a}\n  \\\\\n  &\n  {\\xId\\otimes(F\\xIc \\otimes F a)}\n     \\ar[ul]_{\\xId\\otimes\\xldp{F a}}\n     \\ar[ddr]^{\\psi\\otimes(F\\xIc\\otimes F a)}\n  \\\\ \\\\\n  &\n  {\\xId\\otimes(\\xId \\otimes F a)}\n     \\ar[r]_{\\psi\\otimes(\\psi\\otimes F a)}\n     \\ar[uuul]^{\\xId\\otimes\\xld{F a}}\n     \\ar[uu]_{\\xId\\otimes(\\psi\\otimes F a)}\n  &\n  {F\\xIc\\otimes (F\\xIc\\otimes F a)}\n     \\ar[uuur]^{F\\xIc\\otimes\\xldp{F a}}\n  \\\\ \\\\\n  {(\\xId\\otimes\\xId)\\otimes F a}\n     \\ar[uuuuu]^{\\iota\\otimes F a}\n     \\ar[uur]_{\\xad{\\xId}{\\xId}{F a}}\n     \\ar[rrr]^{(\\psi\\otimes\\psi)\\otimes F a}\n  & & &\n  {(F\\xIc\\otimes F\\xIc)\\otimes F a}\n     \\ar[uuuuu]_{\\iota_1\\otimes F a}\n     \\ar[uul]^{\\xad{F\\xIc}{F\\xIc}{F a}}\n}$$\n\\<close>"], ["proof (state)\nthis:\n  D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n   \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "moreover"], ["proof (state)\nthis:\n  D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n   \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "have \"(\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) = \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "have \"(\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n                = (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D\n     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "using assms \\<psi>_char(1-2) D.interchange [of \"D.inv \\<psi>\"] D.comp_cod_arr\n                D.inv_is_inverse D.comp_inv_arr"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  \\<lbrakk>D.seq (D.inv \\<psi>) ?g; D.seq ?h' ?g'\\<rbrakk>\n  \\<Longrightarrow> (D.inv \\<psi> \\<otimes>\\<^sub>D ?h') \\<cdot>\\<^sub>D\n                    (?g \\<otimes>\\<^sub>D ?g') =\n                    D.inv \\<psi> \\<cdot>\\<^sub>D ?g \\<otimes>\\<^sub>D\n                    ?h' \\<cdot>\\<^sub>D ?g'\n  \\<lbrakk>D.arr ?f; D.cod ?f = ?b\\<rbrakk>\n  \\<Longrightarrow> ?b \\<cdot>\\<^sub>D ?f = ?f\n  D.iso ?f \\<Longrightarrow> D.inverse_arrows ?f (D.inv ?f)\n  D.inverse_arrows ?f ?g \\<Longrightarrow> ?g \\<cdot>\\<^sub>D ?f = D.dom ?f\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D\n     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "by (elim D.in_homE, simp)"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D\n   F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "also"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D\n   F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "have \"... = (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D\n     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D\n     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "have \"(\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) =\n                (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "using assms \\<psi>_char(1-2) D.interchange [of \"\\<I>\\<^sub>D\"] D.interchange [of \"D.inv \\<psi>\"]\n                  D.comp_arr_dom D.comp_cod_arr"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  \\<lbrakk>D.seq \\<I>\\<^sub>D ?g; D.seq ?h' ?g'\\<rbrakk>\n  \\<Longrightarrow> (\\<I>\\<^sub>D \\<otimes>\\<^sub>D ?h') \\<cdot>\\<^sub>D\n                    (?g \\<otimes>\\<^sub>D ?g') =\n                    \\<I>\\<^sub>D \\<cdot>\\<^sub>D ?g \\<otimes>\\<^sub>D\n                    ?h' \\<cdot>\\<^sub>D ?g'\n  \\<lbrakk>D.seq (D.inv \\<psi>) ?g; D.seq ?h' ?g'\\<rbrakk>\n  \\<Longrightarrow> (D.inv \\<psi> \\<otimes>\\<^sub>D ?h') \\<cdot>\\<^sub>D\n                    (?g \\<otimes>\\<^sub>D ?g') =\n                    D.inv \\<psi> \\<cdot>\\<^sub>D ?g \\<otimes>\\<^sub>D\n                    ?h' \\<cdot>\\<^sub>D ?g'\n  \\<lbrakk>D.arr ?f; D.dom ?f = ?a\\<rbrakk>\n  \\<Longrightarrow> ?f \\<cdot>\\<^sub>D ?a = ?f\n  \\<lbrakk>D.arr ?f; D.cod ?f = ?b\\<rbrakk>\n  \\<Longrightarrow> ?b \\<cdot>\\<^sub>D ?f = ?f\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "by (elim D.in_homE, auto)"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D\n     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D\n     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "using assms \\<psi>_char(1-2) D.inv_in_hom\n                  D.comp_permute [of \"\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\" \"D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a\"\n                                     \"D.inv \\<psi> \\<otimes>\\<^sub>D F a\" \"F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\"]"], ["proof (prove)\nusing this:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  \\<lbrakk>D.iso ?f;\n   \\<guillemotleft>?f : ?a \\<rightarrow>\\<^sub>D ?b\\<guillemotright>\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>D.inv\n                                     ?f : ?b \\<rightarrow>\\<^sub>D ?a\\<guillemotright>\n  \\<lbrakk>(\\<I>\\<^sub>D \\<otimes>\\<^sub>D\n            \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n           (D.inv \\<psi> \\<otimes>\\<^sub>D\n            F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) =\n           (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n           (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]);\n   D.seq (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a);\n   D.seq\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a)\n    ?h\\<rbrakk>\n  \\<Longrightarrow> (\\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                     \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n                    (D.inv \\<psi> \\<otimes>\\<^sub>D\n                     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n                    ?h =\n                    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n                    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n                     \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n                    ?h\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (D.inv \\<psi> \\<otimes>\\<^sub>D\n     F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "by (elim D.in_homE, auto)"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D\n   F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D\n   F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "also"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (D.inv \\<psi> \\<otimes>\\<^sub>D\n   F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "have \"... = (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n                         (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n            \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "using assms \\<psi>_char(1-2) D.C\\<^sub>1.lunit_char(2) D.comp_assoc"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  D.ide ?a \\<Longrightarrow>\n  \\<I>\\<^sub>1 \\<otimes>\\<^sub>D \\<l>\\<^sub>1[?a] =\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D ?a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>1, \\<I>\\<^sub>1, ?a]\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n            \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)", "by auto"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n          \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "also"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n          \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "have \"... = ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n                         D.inv \\<a>\\<^sub>D[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n            \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]", "using assms \\<psi>_char(1-2) D.assoc'_naturality [of \\<psi> \\<psi> \"F a\"] D.comp_assoc"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  \\<lbrakk>D.arr \\<psi>; D.arr \\<psi>; D.arr (F a)\\<rbrakk>\n  \\<Longrightarrow> ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n                     F a) \\<cdot>\\<^sub>D\n                    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[D.dom\n            \\<psi>, D.dom \\<psi>, D.dom (F a)] =\n                    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[D.cod\n            \\<psi>, D.cod \\<psi>, D.cod (F a)] \\<cdot>\\<^sub>D\n                    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a)\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n            \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]", "by auto"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n          \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "also"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F\n          \\<I>\\<^sub>C, F a] \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "have \"... = (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D D.inv \\<a>\\<^sub>D[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]", "have \"(D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) = \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "have \"(D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n                  D.inv \\<psi> \\<cdot>\\<^sub>D \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    D.inv \\<psi> \\<cdot>\\<^sub>D\n    \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n    F a", "using assms \\<psi>_char(1-3) D.\\<iota>_in_hom \\<iota>\\<^sub>1_in_hom D.interchange"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D \\<psi>)\n  \\<guillemotleft>\\<iota>\\<^sub>D : \\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                                    \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright>\n  \\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n                                    F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F\n                                    \\<I>\\<^sub>C\\<guillemotright>\n  \\<lbrakk>D.seq ?h ?g; D.seq ?h' ?g'\\<rbrakk>\n  \\<Longrightarrow> (?h \\<otimes>\\<^sub>D ?h') \\<cdot>\\<^sub>D\n                    (?g \\<otimes>\\<^sub>D ?g') =\n                    ?h \\<cdot>\\<^sub>D ?g \\<otimes>\\<^sub>D\n                    ?h' \\<cdot>\\<^sub>D ?g'\n\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    D.inv \\<psi> \\<cdot>\\<^sub>D\n    \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n    F a", "by (elim D.in_homE, auto)"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n  D.inv \\<psi> \\<cdot>\\<^sub>D\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n  F a\n\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "also"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n  D.inv \\<psi> \\<cdot>\\<^sub>D\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n  F a\n\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "have \"... = \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.inv \\<psi> \\<cdot>\\<^sub>D\n    \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n    F a =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "using assms \\<psi>_char(1-2) D.inv_is_inverse D.comp_inv_arr D.comp_cod_arr\n                    D.comp_reduce D.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  D.iso \\<psi>\n  D.iso ?f \\<Longrightarrow> D.inverse_arrows ?f (D.inv ?f)\n  D.inverse_arrows ?f ?g \\<Longrightarrow> ?g \\<cdot>\\<^sub>D ?f = D.dom ?f\n  \\<lbrakk>D.arr ?f; D.cod ?f = ?b\\<rbrakk>\n  \\<Longrightarrow> ?b \\<cdot>\\<^sub>D ?f = ?f\n  \\<lbrakk>?f \\<cdot>\\<^sub>D ?g = ?k; D.seq ?f ?g; D.seq ?g ?h\\<rbrakk>\n  \\<Longrightarrow> ?f \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?h =\n                    ?k \\<cdot>\\<^sub>D ?h\n  \\<guillemotleft>\\<iota>\\<^sub>D : \\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                                    \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright>\n\ngoal (1 subgoal):\n 1. D.inv \\<psi> \\<cdot>\\<^sub>D\n    \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n    F a =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "by (elim D.in_homE, auto)"], ["proof (state)\nthis:\n  D.inv \\<psi> \\<cdot>\\<^sub>D\n  \\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n  F a =\n  \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\n\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "finally"], ["proof (chain)\npicking this:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n  \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "show ?thesis"], ["proof (prove)\nusing this:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n  \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\n\ngoal (1 subgoal):\n 1. (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n    \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a", "by blast"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n  \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n  \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\n\ngoal (1 subgoal):\n 1. ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]", "thus ?thesis"], ["proof (prove)\nusing this:\n  (D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D F a) =\n  \\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a\n\ngoal (1 subgoal):\n 1. ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]", "by simp"], ["proof (state)\nthis:\n  ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "also"], ["proof (state)\nthis:\n  ((D.inv \\<psi> \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   ((\\<psi> \\<otimes>\\<^sub>D \\<psi>) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a]\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "have \"... = \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "using assms D.lunit_char"], ["proof (prove)\nusing this:\n  C.ide a\n  D.ide ?a \\<Longrightarrow>\n  \\<guillemotleft>\\<l>\\<^sub>D[?a] : \\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                                     ?a \\<rightarrow>\\<^sub>D ?a\\<guillemotright>\n  D.ide ?a \\<Longrightarrow>\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[?a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D ?a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, ?a]\n  D.ide ?a \\<Longrightarrow>\n  \\<exists>!f.\n     \\<guillemotleft>f : \\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                         ?a \\<rightarrow>\\<^sub>D ?a\\<guillemotright> \\<and>\n     \\<I>\\<^sub>D \\<otimes>\\<^sub>D f =\n     (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D ?a) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, ?a]\n\ngoal (1 subgoal):\n 1. (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "by simp"], ["proof (state)\nthis:\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>D, \\<I>\\<^sub>D, F a] =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "finally"], ["proof (chain)\npicking this:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n    (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "by blast"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "ultimately"], ["proof (chain)\npicking this:\n  D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n   \\<l>\\<^sub>D[F a]\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]", "show ?thesis"], ["proof (prove)\nusing this:\n  D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n   \\<l>\\<^sub>D[F a]\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "using D.L.is_faithful [of \"\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)\" \"\\<l>\\<^sub>D[F a]\"] D.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  D.par (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a))\n   \\<l>\\<^sub>D[F a]\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n  (\\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\n  \\<lbrakk>D.par\n            (\\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D\n             (\\<psi> \\<otimes>\\<^sub>D F a))\n            \\<l>\\<^sub>D[F a];\n   D.cod \\<iota>\\<^sub>D \\<otimes>\\<^sub>D\n   \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n   D.cod \\<iota>\\<^sub>D \\<otimes>\\<^sub>D \\<l>\\<^sub>D[F a]\\<rbrakk>\n  \\<Longrightarrow> \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D\n                    (\\<psi> \\<otimes>\\<^sub>D F a) =\n                    \\<l>\\<^sub>D[F a]\n  \\<guillemotleft>\\<iota>\\<^sub>D : \\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                                    \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D \\<I>\\<^sub>D\\<guillemotright>\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>D[F a]", "by force"], ["proof (state)\nthis:\n  \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<l>\\<^sub>D[F a]\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma lunit_coherence2:\n    assumes \"C.ide a\"\n    shows \"F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) = \\<l>\\<^sub>1[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "text \\<open>\n        We show that the lower left triangle in the following diagram commutes.\n\\<close>"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "text \\<open>\n\\newcommand\\xIc{{\\cal I}}\n\\newcommand\\xId{{\\cal I}}\n\\newcommand\\xac[3]{{\\scriptsize \\<open>\\<a>\\<close>}[{#1},{#2},{#3}]}\n\\newcommand\\xad[3]{{\\scriptsize \\<open>\\<a>\\<close>}[{#1},{#2},{#3}]}\n\\newcommand\\xlc[1]{{\\scriptsize \\<open>\\<l>\\<close>}[{#1}]}\n\\newcommand\\xld[1]{{\\scriptsize \\<open>\\<l>\\<close>}[{#1}]}\n\\newcommand\\xldp[1]{{\\scriptsize \\<open>\\<l>\\<close>}_1[{#1}]}\n$$\\xymatrix{\n  {(F\\xIc\\otimes F\\xIc)\\otimes F a}\n      \\ar[rrrrr]^{\\phi(\\xIc,\\xIc)\\otimes F a}\n      \\ar[ddd]_{\\xad{F\\xIc}{F\\xIc}{Fa}}\n      \\ar[dddrr]^{\\iota_1\\otimes F a}\n  &&&&&{F(\\xIc\\otimes\\xIc)\\otimes F a}\n      \\ar[ddd]^{\\phi(\\xIc\\otimes\\xIc, a)}\n      \\ar[dddlll]_{F\\iota\\otimes F a}\n  \\\\ \\\\ \\\\\n  {F\\xIc\\otimes(F\\xIc\\otimes F a)}\n      \\ar[ddd]_{F\\xIc\\otimes\\phi(\\xIc, a)}\n      \\ar[rr]_{F\\xIc\\otimes\\xldp{Fa}}\n  &&{F\\xIc\\otimes F a}\n      \\ar[r]_{\\phi(\\xIc, a)}\n  &{F(\\xIc\\otimes a)}\n  &&{F((\\xIc\\otimes\\xIc)\\otimes a)}\n      \\ar[ddd]^{F\\xac{\\xIc}{\\xIc}{a}}\n      \\ar[ll]^{F(\\iota\\otimes a)}\n  \\\\ \\\\ \\\\\n  {F\\xIc\\otimes F (\\xIc\\otimes a)}\n      \\ar[rrrrr]_{\\phi(\\xIc, \\xIc\\otimes a)}\n      \\ar[uuurr]_{F\\xIc\\otimes F\\xlc{a}}\n  &&&&&{F(\\xIc\\otimes (\\xIc \\otimes a))}\n      \\ar[uuull]^{F(\\xIc\\otimes\\xlc{a})}\n}$$\n\\<close>"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "have \"(F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) = F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"(F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n                = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n                  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "have \"D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n                       (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a)\n                   = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using assms \\<phi>_in_hom assoc_coherence D.invert_side_of_triangle(1)"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n  \\<lbrakk>C.ide ?a; C.ide ?b; C.ide ?c\\<rbrakk>\n  \\<Longrightarrow> F \\<a>\\<^sub>C[?a, ?b, ?c] \\<cdot>\\<^sub>D\n                    \\<phi> (?a \\<otimes>\\<^sub>C ?b, ?c) \\<cdot>\\<^sub>D\n                    (\\<phi> (?a, ?b) \\<otimes>\\<^sub>D F ?c) =\n                    \\<phi> (?a, ?b \\<otimes>\\<^sub>C ?c) \\<cdot>\\<^sub>D\n                    (F ?a \\<otimes>\\<^sub>D \\<phi> (?b, ?c)) \\<cdot>\\<^sub>D\n                    \\<a>\\<^sub>D[F ?a, F ?b, F ?c]\n  \\<lbrakk>D.arr ?h; ?f \\<cdot>\\<^sub>D ?g = ?h; D.iso ?f\\<rbrakk>\n  \\<Longrightarrow> D.seq (D.inv ?f) ?h \\<and>\n                    ?g = D.inv ?f \\<cdot>\\<^sub>D ?h\n\ngoal (1 subgoal):\n 1. D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by simp"], ["proof (state)\nthis:\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "hence \"F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\n                    = (D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n                      (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\nusing this:\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n     (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using assms \\<phi>_in_hom D.invert_side_of_triangle(2)"], ["proof (prove)\nusing this:\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n  C.ide a\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n  \\<lbrakk>D.arr ?h; ?f \\<cdot>\\<^sub>D ?g = ?h; D.iso ?g\\<rbrakk>\n  \\<Longrightarrow> D.seq ?h (D.inv ?g) \\<and>\n                    ?f = ?h \\<cdot>\\<^sub>D D.inv ?g\n\ngoal (1 subgoal):\n 1. F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n     (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by simp"], ["proof (state)\nthis:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "thus ?thesis"], ["proof (prove)\nusing this:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using D.comp_assoc"], ["proof (prove)\nusing this:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by simp"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n                         (D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n                         \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n                         D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    (D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    (D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "have 1: \"F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) = F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a])", "using assms C.lunit_char(1-2) C.\\<iota>_in_hom preserves_inv"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  \\<guillemotleft>\\<l>\\<^sub>C[?a] : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                     ?a \\<rightarrow>\\<^sub>C ?a\\<guillemotright>\n  C.ide ?a \\<Longrightarrow>\n  \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[?a] =\n  (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C ?a) \\<cdot>\\<^sub>C\n  C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C ?a\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n  C.iso ?f \\<Longrightarrow> F (C.inv ?f) = D.inv (F ?f)\n\ngoal (1 subgoal):\n 1. F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a])", "by auto"], ["proof (state)\nthis:\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n  F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a])\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    (D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "hence \"F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] = D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)\""], ["proof (prove)\nusing this:\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n  F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a])\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a]) \\<Longrightarrow>\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)", "have \"F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D D.inv (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a))\n                    = D.inv (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C ,a]))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    D.inv (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n    D.inv\n     (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n      D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a]))", "using assms 1 preserves_iso C.ide_is_iso C.\\<iota>_is_iso C.ide_unity C.iso_assoc\n                    C.iso_lunit C.tensor_preserves_iso D.inv_comp D.inv_inv\n                    D.iso_inv_iso D.iso_is_arr"], ["proof (prove)\nusing this:\n  C.ide a\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n  F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a])\n  C.iso ?f \\<Longrightarrow> D.iso (F ?f)\n  C.ide ?a \\<Longrightarrow> C.iso ?a\n  C.iso \\<iota>\\<^sub>C\n  C.ide \\<I>\\<^sub>C\n  \\<lbrakk>C.ide ?a; C.ide ?b; C.ide ?c\\<rbrakk>\n  \\<Longrightarrow> C.iso \\<a>\\<^sub>C[?a, ?b, ?c]\n  C.ide ?a \\<Longrightarrow> C.iso \\<l>\\<^sub>C[?a]\n  \\<lbrakk>C.iso ?f; C.iso ?g\\<rbrakk>\n  \\<Longrightarrow> C.iso (?f \\<otimes>\\<^sub>C ?g)\n  \\<lbrakk>D.iso ?f; D.iso ?g; D.seq ?g ?f\\<rbrakk>\n  \\<Longrightarrow> D.inv (?g \\<cdot>\\<^sub>D ?f) =\n                    D.inv ?f \\<cdot>\\<^sub>D D.inv ?g\n  D.iso ?f \\<Longrightarrow> D.inv (D.inv ?f) = ?f\n  D.iso ?f \\<Longrightarrow> D.iso (D.inv ?f)\n  D.iso ?f \\<Longrightarrow> D.arr ?f\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    D.inv (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n    D.inv\n     (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n      D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a]))", "by metis"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  D.inv (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n  D.inv\n   (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a]))\n\ngoal (1 subgoal):\n 1. F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a]) \\<Longrightarrow>\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)", "thus ?thesis"], ["proof (prove)\nusing this:\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  D.inv (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n  D.inv\n   (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a]))\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)", "using assms 1 preserves_iso C.ide_is_iso C.\\<iota>_is_iso C.ide_unity C.iso_assoc\n                    C.iso_lunit C.tensor_preserves_iso D.inv_comp D.inv_inv\n                    D.iso_inv_iso D.iso_is_arr D.invert_side_of_triangle(2)"], ["proof (prove)\nusing this:\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  D.inv (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n  D.inv\n   (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a]))\n  C.ide a\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) =\n  F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  D.inv (F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a])\n  C.iso ?f \\<Longrightarrow> D.iso (F ?f)\n  C.ide ?a \\<Longrightarrow> C.iso ?a\n  C.iso \\<iota>\\<^sub>C\n  C.ide \\<I>\\<^sub>C\n  \\<lbrakk>C.ide ?a; C.ide ?b; C.ide ?c\\<rbrakk>\n  \\<Longrightarrow> C.iso \\<a>\\<^sub>C[?a, ?b, ?c]\n  C.ide ?a \\<Longrightarrow> C.iso \\<l>\\<^sub>C[?a]\n  \\<lbrakk>C.iso ?f; C.iso ?g\\<rbrakk>\n  \\<Longrightarrow> C.iso (?f \\<otimes>\\<^sub>C ?g)\n  \\<lbrakk>D.iso ?f; D.iso ?g; D.seq ?g ?f\\<rbrakk>\n  \\<Longrightarrow> D.inv (?g \\<cdot>\\<^sub>D ?f) =\n                    D.inv ?f \\<cdot>\\<^sub>D D.inv ?g\n  D.iso ?f \\<Longrightarrow> D.inv (D.inv ?f) = ?f\n  D.iso ?f \\<Longrightarrow> D.iso (D.inv ?f)\n  D.iso ?f \\<Longrightarrow> D.arr ?f\n  \\<lbrakk>D.arr ?h; ?f \\<cdot>\\<^sub>D ?g = ?h; D.iso ?g\\<rbrakk>\n  \\<Longrightarrow> D.seq ?h (D.inv ?g) \\<and>\n                    ?f = ?h \\<cdot>\\<^sub>D D.inv ?g\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)", "by metis"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    (D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "thus ?thesis"], ["proof (prove)\nusing this:\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] =\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    (D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by argo"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  (D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  (D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  F \\<a>\\<^sub>C[\\<I>\\<^sub>C, \\<I>\\<^sub>C, a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  (D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n                         D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n                         (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    (D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n     \\<phi>\n      (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using D.comp_assoc"], ["proof (prove)\nusing this:\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    (D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n     \\<phi>\n      (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by auto"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  (D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  (D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n                         D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n                         (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n     \\<phi>\n      (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n     (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using assms \\<phi>.naturality [of \"(\\<iota>\\<^sub>C, a)\"] C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  C.CC.arr (\\<iota>\\<^sub>C, a) \\<Longrightarrow>\n  \\<phi> (C.CC.cod (\\<iota>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  T\\<^sub>DoFF.map (\\<iota>\\<^sub>C, a) =\n  FoT\\<^sub>C.map (\\<iota>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  \\<phi> (C.CC.dom (\\<iota>\\<^sub>C, a))\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n     \\<phi>\n      (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n     (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by auto"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n   (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (F (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n   (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n                         D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n                         ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n                         D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n     (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using D.comp_assoc"], ["proof (prove)\nusing this:\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n     (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n     F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by auto"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n   (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n   (F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n   F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n                         D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n                         D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using assms D.interchange C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<lbrakk>D.seq ?h ?g; D.seq ?h' ?g'\\<rbrakk>\n  \\<Longrightarrow> (?h \\<otimes>\\<^sub>D ?h') \\<cdot>\\<^sub>D\n                    (?g \\<otimes>\\<^sub>D ?g') =\n                    ?h \\<cdot>\\<^sub>D ?g \\<otimes>\\<^sub>D\n                    ?h' \\<cdot>\\<^sub>D ?g'\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n      F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by auto"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<iota>\\<^sub>C \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C) \\<otimes>\\<^sub>D\n    F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n                         D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n                         ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n                         D.inv \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "have \"(\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] = F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "using assms D.C\\<^sub>1.lunit_char [of \"F a\"]"], ["proof (prove)\nusing this:\n  C.ide a\n  D.ide (F a) \\<Longrightarrow>\n  \\<guillemotleft>\\<l>\\<^sub>1[F a] : \\<I>\\<^sub>1 \\<otimes>\\<^sub>D\nF a \\<rightarrow>\\<^sub>D F a\\<guillemotright>\n  D.ide (F a) \\<Longrightarrow>\n  \\<I>\\<^sub>1 \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a] =\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>1, \\<I>\\<^sub>1, F a]\n  D.ide (F a) \\<Longrightarrow>\n  \\<exists>!f.\n     \\<guillemotleft>f : \\<I>\\<^sub>1 \\<otimes>\\<^sub>D\n                         F a \\<rightarrow>\\<^sub>D F\n              a\\<guillemotright> \\<and>\n     \\<I>\\<^sub>1 \\<otimes>\\<^sub>D f =\n     (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[\\<I>\\<^sub>1, \\<I>\\<^sub>1, F a]\n\ngoal (1 subgoal):\n 1. (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "by auto"], ["proof (state)\nthis:\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "using assms D.inv_is_inverse \\<iota>\\<^sub>1_in_hom \\<phi>_in_hom D.invert_side_of_triangle(2)"], ["proof (prove)\nusing this:\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n  C.ide a\n  D.iso ?f \\<Longrightarrow> D.inverse_arrows ?f (D.inv ?f)\n  \\<guillemotleft>\\<iota>\\<^sub>1 : F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n                                    F \\<I>\\<^sub>C \\<rightarrow>\\<^sub>D F\n                                    \\<I>\\<^sub>C\\<guillemotright>\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n  \\<lbrakk>D.arr ?h; ?f \\<cdot>\\<^sub>D ?g = ?h; D.iso ?g\\<rbrakk>\n  \\<Longrightarrow> D.seq ?h (D.inv ?g) \\<and>\n                    ?f = ?h \\<cdot>\\<^sub>D D.inv ?g\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]", "by simp"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n   \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n   \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  (\\<iota>\\<^sub>1 \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n   \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n                         (D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n                         (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "using assms D.comp_arr_dom [of \"F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\"] D.comp_assoc"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<lbrakk>D.arr (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]);\n   D.dom (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) = ?a\\<rbrakk>\n  \\<Longrightarrow> (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n                     \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n                    ?a =\n                    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n     \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "by auto"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n   \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) \\<cdot>\\<^sub>D\n   \\<a>\\<^sub>D[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a]) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F \\<I>\\<^sub>C, F \\<I>\\<^sub>C, F a] =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "have \"D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])\n                   = D.inv (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n    D.inv\n     (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n      F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n      \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a))", "using assms \\<phi>.naturality [of \"(\\<I>\\<^sub>C, \\<l>\\<^sub>C[a])\"] D.invert_side_of_triangle(1)"], ["proof (prove)\nusing this:\n  C.ide a\n  C.CC.arr (\\<I>\\<^sub>C, \\<l>\\<^sub>C[a]) \\<Longrightarrow>\n  \\<phi> (C.CC.cod (\\<I>\\<^sub>C, \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  T\\<^sub>DoFF.map (\\<I>\\<^sub>C, \\<l>\\<^sub>C[a]) =\n  FoT\\<^sub>C.map (\\<I>\\<^sub>C, \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  \\<phi> (C.CC.dom (\\<I>\\<^sub>C, \\<l>\\<^sub>C[a]))\n  \\<lbrakk>D.arr ?h; ?f \\<cdot>\\<^sub>D ?g = ?h; D.iso ?f\\<rbrakk>\n  \\<Longrightarrow> D.seq (D.inv ?f) ?h \\<and>\n                    ?g = D.inv ?f \\<cdot>\\<^sub>D ?h\n\ngoal (1 subgoal):\n 1. D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n    D.inv\n     (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n      F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n      \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a))", "by simp"], ["proof (state)\nthis:\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n  D.inv\n   (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a))\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "also"], ["proof (state)\nthis:\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n  D.inv\n   (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a))\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "have \"... = D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.inv\n     (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n      F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n      \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a)", "using assms D.inv_comp D.inv_is_inverse D.isos_compose D.comp_assoc"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<lbrakk>D.iso ?f; D.iso ?g; D.seq ?g ?f\\<rbrakk>\n  \\<Longrightarrow> D.inv (?g \\<cdot>\\<^sub>D ?f) =\n                    D.inv ?f \\<cdot>\\<^sub>D D.inv ?g\n  D.iso ?f \\<Longrightarrow> D.inverse_arrows ?f (D.inv ?f)\n  \\<lbrakk>D.iso ?f; D.iso ?f'; D.seq ?f' ?f\\<rbrakk>\n  \\<Longrightarrow> D.iso (?f' \\<cdot>\\<^sub>D ?f)\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. D.inv\n     (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n      F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n      \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a)", "by simp"], ["proof (state)\nthis:\n  D.inv\n   (D.inv (\\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) =\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "finally"], ["proof (chain)\npicking this:\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a)", "have \"D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])\n                          = D.inv (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\""], ["proof (prove)\nusing this:\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n    D.inv\n     (\\<phi>\n       (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n    D.inv\n     (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a)", "by blast"], ["proof (state)\nthis:\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "thus ?thesis"], ["proof (prove)\nusing this:\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) =\n  D.inv\n   (\\<phi> (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n  D.inv (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (D.inv\n      (\\<phi>\n        (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n     D.inv\n      (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "by argo"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (D.inv\n    (\\<phi>\n      (\\<I>\\<^sub>C, \\<I>\\<^sub>C \\<otimes>\\<^sub>C a)) \\<cdot>\\<^sub>D\n   D.inv\n    (F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n     D.inv\n      (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "using assms D.tensor_preserves_iso D.comp_assoc"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<lbrakk>D.iso ?f; D.iso ?g\\<rbrakk>\n  \\<Longrightarrow> D.iso (?f \\<otimes>\\<^sub>D ?g)\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    D.inv\n     (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n     D.inv\n      (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])", "by simp"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n   D.inv\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "also"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  D.inv (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n   D.inv\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a])\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "have \"... = F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n     D.inv\n      (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "using assms D.tensor_preserves_iso D.comp_arr_inv D.inv_is_inverse D.comp_cod_arr\n                D.interchange"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<lbrakk>D.iso ?f; D.iso ?g\\<rbrakk>\n  \\<Longrightarrow> D.iso (?f \\<otimes>\\<^sub>D ?g)\n  D.inverse_arrows ?f ?g \\<Longrightarrow> ?f \\<cdot>\\<^sub>D ?g = D.dom ?g\n  D.iso ?f \\<Longrightarrow> D.inverse_arrows ?f (D.inv ?f)\n  \\<lbrakk>D.arr ?f; D.cod ?f = ?b\\<rbrakk>\n  \\<Longrightarrow> ?b \\<cdot>\\<^sub>D ?f = ?f\n  \\<lbrakk>D.seq ?h ?g; D.seq ?h' ?g'\\<rbrakk>\n  \\<Longrightarrow> (?h \\<otimes>\\<^sub>D ?h') \\<cdot>\\<^sub>D\n                    (?g \\<otimes>\\<^sub>D ?g') =\n                    ?h \\<cdot>\\<^sub>D ?g \\<otimes>\\<^sub>D\n                    ?h' \\<cdot>\\<^sub>D ?g'\n\ngoal (1 subgoal):\n 1. ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n     D.inv\n      (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "by simp"], ["proof (state)\nthis:\n  ((F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n   D.inv\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a])) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "finally"], ["proof (chain)\npicking this:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "show ?thesis"], ["proof (prove)\nusing this:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n    (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "by blast"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "hence \"F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) = F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\""], ["proof (prove)\nusing this:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "using assms \\<phi>_in_hom D.interchange"], ["proof (prove)\nusing this:\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a]) \\<cdot>\\<^sub>D\n  (F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n  C.ide a\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n  \\<lbrakk>D.seq ?h ?g; D.seq ?h' ?g'\\<rbrakk>\n  \\<Longrightarrow> (?h \\<otimes>\\<^sub>D ?h') \\<cdot>\\<^sub>D\n                    (?g \\<otimes>\\<^sub>D ?g') =\n                    ?h \\<cdot>\\<^sub>D ?g \\<otimes>\\<^sub>D\n                    ?h' \\<cdot>\\<^sub>D ?g'\n\ngoal (1 subgoal):\n 1. F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]", "by simp"], ["proof (state)\nthis:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "moreover"], ["proof (state)\nthis:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "have \"D.par (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) \\<l>\\<^sub>1[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.par (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n     \\<l>\\<^sub>1[F a]", "using assms \\<phi>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n\ngoal (1 subgoal):\n 1. D.par (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n     \\<l>\\<^sub>1[F a]", "by simp"], ["proof (state)\nthis:\n  D.par (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n   \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "ultimately"], ["proof (chain)\npicking this:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n  D.par (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n   \\<l>\\<^sub>1[F a]", "show ?thesis"], ["proof (prove)\nusing this:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n  D.par (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n   \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "using D.C\\<^sub>1.L.is_faithful [of \"F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\" \"\\<l>\\<^sub>1[F a]\"] D.C\\<^sub>1.unity_def"], ["proof (prove)\nusing this:\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  F \\<I>\\<^sub>C \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\n  D.par (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n   \\<l>\\<^sub>1[F a]\n  \\<lbrakk>D.par\n            (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a))\n            \\<l>\\<^sub>1[F a];\n   D.cod \\<iota>\\<^sub>1 \\<otimes>\\<^sub>D\n   F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n   D.cod \\<iota>\\<^sub>1 \\<otimes>\\<^sub>D \\<l>\\<^sub>1[F a]\\<rbrakk>\n  \\<Longrightarrow> F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n                    \\<phi> (\\<I>\\<^sub>C, a) =\n                    \\<l>\\<^sub>1[F a]\n  \\<I>\\<^sub>1 \\<equiv> D.cod \\<iota>\\<^sub>1\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n    \\<l>\\<^sub>1[F a]", "by simp"], ["proof (state)\nthis:\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) =\n  \\<l>\\<^sub>1[F a]\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n      Combining the two previous lemmas yields the coherence result we seek.\n      This is the condition that is traditionally taken as part of the definition\n      of monoidal functor.\n\\<close>"], ["", "lemma lunit_coherence:\n    assumes \"C.ide a\"\n    shows \"\\<l>\\<^sub>D[F a] = F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "have \"\\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) = \\<l>\\<^sub>1[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>1[F a]", "using assms lunit_coherence1 \\<psi>_char(2)\n              D.invert_side_of_triangle(2) [of \"\\<l>\\<^sub>D[F a]\" \"\\<l>\\<^sub>1[F a]\" \"\\<psi> \\<otimes>\\<^sub>D F a\"]"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  \\<l>\\<^sub>1[F ?a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F ?a) =\n  \\<l>\\<^sub>D[F ?a]\n  D.iso \\<psi>\n  \\<lbrakk>D.arr \\<l>\\<^sub>D[F a];\n   \\<l>\\<^sub>1[F a] \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a) =\n   \\<l>\\<^sub>D[F a];\n   D.iso (\\<psi> \\<otimes>\\<^sub>D F a)\\<rbrakk>\n  \\<Longrightarrow> D.seq \\<l>\\<^sub>D[F a]\n                     (D.inv (\\<psi> \\<otimes>\\<^sub>D F a)) \\<and>\n                    \\<l>\\<^sub>1[F a] =\n                    \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D\n                    D.inv (\\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n    \\<l>\\<^sub>1[F a]", "by auto"], ["proof (state)\nthis:\n  \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "also"], ["proof (state)\nthis:\n  \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n  \\<l>\\<^sub>1[F a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "have \"... = F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)", "using assms lunit_coherence2"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  F \\<l>\\<^sub>C[?a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, ?a) =\n  \\<l>\\<^sub>1[F ?a]\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>1[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)", "by simp"], ["proof (state)\nthis:\n  \\<l>\\<^sub>1[F a] =\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "finally"], ["proof (chain)\npicking this:\n  \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)", "have \"\\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) = F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\""], ["proof (prove)\nusing this:\n  \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)", "by blast"], ["proof (state)\nthis:\n  \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "hence \"\\<l>\\<^sub>D[F a] = (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)\""], ["proof (prove)\nusing this:\n  \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D F a)", "using assms \\<psi>_char(2) \\<phi>_in_hom\n              D.invert_side_of_triangle(2) [of \"F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\" \"\\<l>\\<^sub>D[F a]\" \"D.inv (\\<psi> \\<otimes>\\<^sub>D F a)\"]"], ["proof (prove)\nusing this:\n  \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a)\n  C.ide a\n  D.iso \\<psi>\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n  \\<lbrakk>D.seq (F \\<l>\\<^sub>C[a]) (\\<phi> (\\<I>\\<^sub>C, a));\n   \\<l>\\<^sub>D[F a] \\<cdot>\\<^sub>D D.inv (\\<psi> \\<otimes>\\<^sub>D F a) =\n   F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (\\<I>\\<^sub>C, a);\n   D.iso (D.inv (\\<psi> \\<otimes>\\<^sub>D F a))\\<rbrakk>\n  \\<Longrightarrow> D.seq\n                     (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n                      \\<phi> (\\<I>\\<^sub>C, a))\n                     (D.inv (D.inv (\\<psi> \\<otimes>\\<^sub>D F a))) \\<and>\n                    \\<l>\\<^sub>D[F a] =\n                    (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n                     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n                    D.inv (D.inv (\\<psi> \\<otimes>\\<^sub>D F a))\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n     \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n    (\\<psi> \\<otimes>\\<^sub>D F a)", "by simp"], ["proof (state)\nthis:\n  \\<l>\\<^sub>D[F a] =\n  (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<l>\\<^sub>D[F a] =\n  (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "using assms \\<psi>_char(1) D.comp_assoc"], ["proof (prove)\nusing this:\n  \\<l>\\<^sub>D[F a] =\n  (F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n   \\<phi> (\\<I>\\<^sub>C, a)) \\<cdot>\\<^sub>D\n  (\\<psi> \\<otimes>\\<^sub>D F a)\n  C.ide a\n  \\<guillemotleft>\\<psi> : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright>\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>D[F a] =\n    F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)", "by auto"], ["proof (state)\nthis:\n  \\<l>\\<^sub>D[F a] =\n  F \\<l>\\<^sub>C[a] \\<cdot>\\<^sub>D\n  \\<phi> (\\<I>\\<^sub>C, a) \\<cdot>\\<^sub>D (\\<psi> \\<otimes>\\<^sub>D F a)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n      We now want to obtain the corresponding result for the right unitor.\n      To avoid a repetition of what would amount to essentially the same tedious diagram chases\n      that were carried out above, we instead show here that @{term F} becomes a monoidal functor\n      from the opposite of \\<open>C\\<close> to the opposite of \\<open>D\\<close>,\n      with @{term \"\\<lambda>f. \\<phi> (snd f, fst f)\"} as the structure map.\n      The fact that in the opposite monoidal categories the left and right unitors are exchanged\n      then permits us to obtain the result for the right unitor from the result already proved\n      for the left unitor.\n\\<close>"], ["", "interpretation C': opposite_monoidal_category C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C"], ["proof (prove)\ngoal (1 subgoal):\n 1. opposite_monoidal_category (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C", ".."], ["", "interpretation D': opposite_monoidal_category D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D"], ["proof (prove)\ngoal (1 subgoal):\n 1. opposite_monoidal_category (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D", ".."], ["", "interpretation T\\<^sub>D'oFF: composite_functor C.CC.comp D.CC.comp D FF.map D'.T"], ["proof (prove)\ngoal (1 subgoal):\n 1. composite_functor C.CC.comp D.CC.comp (\\<cdot>\\<^sub>D) FF.map D'.T", ".."], ["", "interpretation FoT\\<^sub>C': composite_functor C.CC.comp C D C'.T F"], ["proof (prove)\ngoal (1 subgoal):\n 1. composite_functor C.CC.comp (\\<cdot>\\<^sub>C) (\\<cdot>\\<^sub>D) C'.T F", ".."], ["", "interpretation \\<phi>': natural_transformation C.CC.comp D T\\<^sub>D'oFF.map FoT\\<^sub>C'.map\n                                              \\<open>\\<lambda>f. \\<phi> (snd f, fst f)\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_transformation C.CC.comp (\\<cdot>\\<^sub>D) T\\<^sub>D'oFF.map\n     FoT\\<^sub>C'.map (\\<lambda>f. \\<phi> (snd f, fst f))", "using \\<phi>.is_natural_1 \\<phi>.is_natural_2 \\<phi>.is_extensional"], ["proof (prove)\nusing this:\n  C.CC.arr ?f \\<Longrightarrow>\n  FoT\\<^sub>C.map ?f \\<cdot>\\<^sub>D \\<phi> (C.CC.dom ?f) = \\<phi> ?f\n  C.CC.arr ?f \\<Longrightarrow>\n  \\<phi> (C.CC.cod ?f) \\<cdot>\\<^sub>D T\\<^sub>DoFF.map ?f = \\<phi> ?f\n  \\<not> C.CC.arr ?f \\<Longrightarrow> \\<phi> ?f = D.null\n\ngoal (1 subgoal):\n 1. natural_transformation C.CC.comp (\\<cdot>\\<^sub>D) T\\<^sub>D'oFF.map\n     FoT\\<^sub>C'.map (\\<lambda>f. \\<phi> (snd f, fst f))", "by (unfold_locales, auto)"], ["", "interpretation \\<phi>': natural_isomorphism C.CC.comp D T\\<^sub>D'oFF.map FoT\\<^sub>C'.map\n                                           \\<open>\\<lambda>f. \\<phi> (snd f, fst f)\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_isomorphism C.CC.comp (\\<cdot>\\<^sub>D) T\\<^sub>D'oFF.map\n     FoT\\<^sub>C'.map (\\<lambda>f. \\<phi> (snd f, fst f))", "by (unfold_locales, simp)"], ["", "interpretation F': monoidal_functor C C'.T C'.\\<alpha> \\<iota>\\<^sub>C D D'.T D'.\\<alpha> \\<iota>\\<^sub>D F \\<open>\\<lambda>f. \\<phi> (snd f, fst f)\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) C'.T C'.\\<alpha> \\<iota>\\<^sub>C\n     (\\<cdot>\\<^sub>D) D'.T D'.\\<alpha> \\<iota>\\<^sub>D F\n     (\\<lambda>f. \\<phi> (snd f, fst f))", "using preserves_unity"], ["proof (prove)\nusing this:\n  D.isomorphic D'.unity (F C'.unity)\n\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) C'.T C'.\\<alpha> \\<iota>\\<^sub>C\n     (\\<cdot>\\<^sub>D) D'.T D'.\\<alpha> \\<iota>\\<^sub>D F\n     (\\<lambda>f. \\<phi> (snd f, fst f))", "apply (unfold_locales; simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c;\n        D.isomorphic D'.unity (F C'.unity)\\<rbrakk>\n       \\<Longrightarrow> F (C.assoc' c b a) \\<cdot>\\<^sub>D\n                         \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n                         (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n                         \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n                         (\\<phi> (c, b) \\<otimes>\\<^sub>D\n                          F a) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c;\n        D.isomorphic D'.unity (F C'.unity)\\<rbrakk>\n       \\<Longrightarrow> F (C.assoc' c b a) \\<cdot>\\<^sub>D\n                         \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n                         (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n                         \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n                         (\\<phi> (c, b) \\<otimes>\\<^sub>D\n                          F a) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]", "fix a b c"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c;\n        D.isomorphic D'.unity (F C'.unity)\\<rbrakk>\n       \\<Longrightarrow> F (C.assoc' c b a) \\<cdot>\\<^sub>D\n                         \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n                         (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n                         \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n                         (\\<phi> (c, b) \\<otimes>\\<^sub>D\n                          F a) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]", "assume a: \"C.ide a\" and b: \"C.ide b\" and c: \"C.ide c\""], ["proof (state)\nthis:\n  C.ide a\n  C.ide b\n  C.ide c\n\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c;\n        D.isomorphic D'.unity (F C'.unity)\\<rbrakk>\n       \\<Longrightarrow> F (C.assoc' c b a) \\<cdot>\\<^sub>D\n                         \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n                         (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n                         \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n                         (\\<phi> (c, b) \\<otimes>\\<^sub>D\n                          F a) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]", "have \"(\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n            F (C.assoc' c b a) \\<cdot>\\<^sub>D \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D (F c \\<otimes>\\<^sub>D \\<phi> (b, a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "have \"D.seq (F \\<a>\\<^sub>C[c, b, a]) (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.seq (F \\<a>\\<^sub>C[c, b, a])\n     (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n      (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))", "using a b c \\<phi>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n  C.ide c\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n\ngoal (1 subgoal):\n 1. D.seq (F \\<a>\\<^sub>C[c, b, a])\n     (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n      (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))", "by simp"], ["proof (state)\nthis:\n  D.seq (F \\<a>\\<^sub>C[c, b, a])\n   (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "moreover"], ["proof (state)\nthis:\n  D.seq (F \\<a>\\<^sub>C[c, b, a])\n   (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "have \"D.seq (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<a>\\<^sub>D[F c, F b, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.seq\n     (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n      (F c \\<otimes>\\<^sub>D \\<phi> (b, a)))\n     \\<a>\\<^sub>D[F c, F b, F a]", "using a b c \\<phi>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n  C.ide c\n  \\<lbrakk>C.ide ?a; C.ide ?b\\<rbrakk>\n  \\<Longrightarrow> \\<guillemotleft>\\<phi>\n                                     (?a,\n?b) : F ?a \\<otimes>\\<^sub>D\n      F ?b \\<rightarrow>\\<^sub>D F (?a \\<otimes>\\<^sub>C\n                                    ?b)\\<guillemotright>\n\ngoal (1 subgoal):\n 1. D.seq\n     (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n      (F c \\<otimes>\\<^sub>D \\<phi> (b, a)))\n     \\<a>\\<^sub>D[F c, F b, F a]", "by simp"], ["proof (state)\nthis:\n  D.seq\n   (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a)))\n   \\<a>\\<^sub>D[F c, F b, F a]\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "moreover"], ["proof (state)\nthis:\n  D.seq\n   (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a)))\n   \\<a>\\<^sub>D[F c, F b, F a]\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "have\n             \"F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n              (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D \\<a>\\<^sub>D[F c, F b, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D\n    \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n    (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n     (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F c, F b, F a]", "using a b c assoc_coherence D.comp_assoc"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n  C.ide c\n  \\<lbrakk>C.ide ?a; C.ide ?b; C.ide ?c\\<rbrakk>\n  \\<Longrightarrow> F \\<a>\\<^sub>C[?a, ?b, ?c] \\<cdot>\\<^sub>D\n                    \\<phi> (?a \\<otimes>\\<^sub>C ?b, ?c) \\<cdot>\\<^sub>D\n                    (\\<phi> (?a, ?b) \\<otimes>\\<^sub>D F ?c) =\n                    \\<phi> (?a, ?b \\<otimes>\\<^sub>C ?c) \\<cdot>\\<^sub>D\n                    (F ?a \\<otimes>\\<^sub>D \\<phi> (?b, ?c)) \\<cdot>\\<^sub>D\n                    \\<a>\\<^sub>D[F ?a, F ?b, F ?c]\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D\n    \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n    (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n     (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F c, F b, F a]", "by simp"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D\n  \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n  (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n  (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F c, F b, F a]\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "moreover"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D\n  \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n  (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n  (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F c, F b, F a]\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "have \"D.iso (F \\<a>\\<^sub>C[c,b,a])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.iso (F \\<a>\\<^sub>C[c, b, a])", "using a b c"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n  C.ide c\n\ngoal (1 subgoal):\n 1. D.iso (F \\<a>\\<^sub>C[c, b, a])", "by simp"], ["proof (state)\nthis:\n  D.iso (F \\<a>\\<^sub>C[c, b, a])\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "moreover"], ["proof (state)\nthis:\n  D.iso (F \\<a>\\<^sub>C[c, b, a])\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "have \"D.iso \\<a>\\<^sub>D[F c, F b, F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.iso \\<a>\\<^sub>D[F c, F b, F a]", "using a b c"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n  C.ide c\n\ngoal (1 subgoal):\n 1. D.iso \\<a>\\<^sub>D[F c, F b, F a]", "by simp"], ["proof (state)\nthis:\n  D.iso \\<a>\\<^sub>D[F c, F b, F a]\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "moreover"], ["proof (state)\nthis:\n  D.iso \\<a>\\<^sub>D[F c, F b, F a]\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "have \"D.inv (F \\<a>\\<^sub>C[c,b,a]) = F (C.assoc' c b a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.inv (F \\<a>\\<^sub>C[c, b, a]) = F (C.assoc' c b a)", "using a b c preserves_inv"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n  C.ide c\n  C.iso ?f \\<Longrightarrow> F (C.inv ?f) = D.inv (F ?f)\n\ngoal (1 subgoal):\n 1. D.inv (F \\<a>\\<^sub>C[c, b, a]) = F (C.assoc' c b a)", "by simp"], ["proof (state)\nthis:\n  D.inv (F \\<a>\\<^sub>C[c, b, a]) = F (C.assoc' c b a)\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "ultimately"], ["proof (chain)\npicking this:\n  D.seq (F \\<a>\\<^sub>C[c, b, a])\n   (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))\n  D.seq\n   (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a)))\n   \\<a>\\<^sub>D[F c, F b, F a]\n  F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D\n  \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n  (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n  (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F c, F b, F a]\n  D.iso (F \\<a>\\<^sub>C[c, b, a])\n  D.iso \\<a>\\<^sub>D[F c, F b, F a]\n  D.inv (F \\<a>\\<^sub>C[c, b, a]) = F (C.assoc' c b a)", "show ?thesis"], ["proof (prove)\nusing this:\n  D.seq (F \\<a>\\<^sub>C[c, b, a])\n   (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))\n  D.seq\n   (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a)))\n   \\<a>\\<^sub>D[F c, F b, F a]\n  F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D\n  \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n  (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n  (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F c, F b, F a]\n  D.iso (F \\<a>\\<^sub>C[c, b, a])\n  D.iso \\<a>\\<^sub>D[F c, F b, F a]\n  D.inv (F \\<a>\\<^sub>C[c, b, a]) = F (C.assoc' c b a)\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "using D.invert_opposite_sides_of_square"], ["proof (prove)\nusing this:\n  D.seq (F \\<a>\\<^sub>C[c, b, a])\n   (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a))\n  D.seq\n   (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a)))\n   \\<a>\\<^sub>D[F c, F b, F a]\n  F \\<a>\\<^sub>C[c, b, a] \\<cdot>\\<^sub>D\n  \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n  (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) =\n  (\\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n   (F c \\<otimes>\\<^sub>D \\<phi> (b, a))) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F c, F b, F a]\n  D.iso (F \\<a>\\<^sub>C[c, b, a])\n  D.iso \\<a>\\<^sub>D[F c, F b, F a]\n  D.inv (F \\<a>\\<^sub>C[c, b, a]) = F (C.assoc' c b a)\n  \\<lbrakk>D.seq ?f ?g; ?f \\<cdot>\\<^sub>D ?g = ?h \\<cdot>\\<^sub>D ?k;\n   D.iso ?f; D.iso ?k\\<rbrakk>\n  \\<Longrightarrow> D.seq ?g (D.inv ?k) \\<and>\n                    D.seq (D.inv ?f) ?h \\<and>\n                    ?g \\<cdot>\\<^sub>D D.inv ?k =\n                    D.inv ?f \\<cdot>\\<^sub>D ?h\n\ngoal (1 subgoal):\n 1. (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n     (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n    F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a))", "by simp"], ["proof (state)\nthis:\n  (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n   (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n  F (C.assoc' c b a) \\<cdot>\\<^sub>D\n  \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  (F c \\<otimes>\\<^sub>D \\<phi> (b, a))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n   (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n  F (C.assoc' c b a) \\<cdot>\\<^sub>D\n  \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  (F c \\<otimes>\\<^sub>D \\<phi> (b, a))\n\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c;\n        D.isomorphic D'.unity (F C'.unity)\\<rbrakk>\n       \\<Longrightarrow> F (C.assoc' c b a) \\<cdot>\\<^sub>D\n                         \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n                         (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n                         \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n                         (\\<phi> (c, b) \\<otimes>\\<^sub>D\n                          F a) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]", "thus \"F (C.assoc' c b a) \\<cdot>\\<^sub>D \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n            \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]\""], ["proof (prove)\nusing this:\n  (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n   (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n  F (C.assoc' c b a) \\<cdot>\\<^sub>D\n  \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  (F c \\<otimes>\\<^sub>D \\<phi> (b, a))\n\ngoal (1 subgoal):\n 1. F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n    \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]", "using D.comp_assoc"], ["proof (prove)\nusing this:\n  (\\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n   (\\<phi> (c, b) \\<otimes>\\<^sub>D F a)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a] =\n  F (C.assoc' c b a) \\<cdot>\\<^sub>D\n  \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  (F c \\<otimes>\\<^sub>D \\<phi> (b, a))\n  (?h \\<cdot>\\<^sub>D ?g) \\<cdot>\\<^sub>D ?f =\n  ?h \\<cdot>\\<^sub>D ?g \\<cdot>\\<^sub>D ?f\n\ngoal (1 subgoal):\n 1. F (C.assoc' c b a) \\<cdot>\\<^sub>D\n    \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n    (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n    \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n    (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]", "by simp"], ["proof (state)\nthis:\n  F (C.assoc' c b a) \\<cdot>\\<^sub>D\n  \\<phi> (c, b \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>D\n  (F c \\<otimes>\\<^sub>D \\<phi> (b, a)) =\n  \\<phi> (c \\<otimes>\\<^sub>C b, a) \\<cdot>\\<^sub>D\n  (\\<phi> (c, b) \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D\\<^sup>-\\<^sup>1[F c, F b, F a]\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma induces_monoidal_functor_between_opposites:\n    shows \"monoidal_functor C C'.T C'.\\<alpha> \\<iota>\\<^sub>C D D'.T D'.\\<alpha> \\<iota>\\<^sub>D F (\\<lambda>f. \\<phi> (snd f, fst f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) C'.T C'.\\<alpha> \\<iota>\\<^sub>C\n     (\\<cdot>\\<^sub>D) D'.T D'.\\<alpha> \\<iota>\\<^sub>D F\n     (\\<lambda>f. \\<phi> (snd f, fst f))", ".."], ["", "lemma runit_coherence:\n    assumes \"C.ide a\"\n    shows \"\\<r>\\<^sub>D[F a] = F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D \\<phi> (a, \\<I>\\<^sub>C) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "have \"C'.lunit a = \\<r>\\<^sub>C[a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C'.lunit a = \\<r>\\<^sub>C[a]", "using assms C'.lunit_simp"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide ?a \\<Longrightarrow> C'.lunit ?a = \\<r>\\<^sub>C[?a]\n\ngoal (1 subgoal):\n 1. C'.lunit a = \\<r>\\<^sub>C[a]", "by simp"], ["proof (state)\nthis:\n  C'.lunit a = \\<r>\\<^sub>C[a]\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "moreover"], ["proof (state)\nthis:\n  C'.lunit a = \\<r>\\<^sub>C[a]\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "have \"D'.lunit (F a) = \\<r>\\<^sub>D[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D'.lunit (F a) = \\<r>\\<^sub>D[F a]", "using assms D'.lunit_simp"], ["proof (prove)\nusing this:\n  C.ide a\n  D.ide ?a \\<Longrightarrow> D'.lunit ?a = \\<r>\\<^sub>D[?a]\n\ngoal (1 subgoal):\n 1. D'.lunit (F a) = \\<r>\\<^sub>D[F a]", "by simp"], ["proof (state)\nthis:\n  D'.lunit (F a) = \\<r>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "moreover"], ["proof (state)\nthis:\n  D'.lunit (F a) = \\<r>\\<^sub>D[F a]\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "have \"F'.\\<psi> = \\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F'.\\<psi> = \\<psi>", "proof (intro \\<psi>_eqI)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<guillemotleft>F'.\\<psi> : D'.unity \\<rightarrow>\\<^sub>D F\n                          C'.unity\\<guillemotright>\n 2. D.iso F'.\\<psi>\n 3. F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (F'.\\<psi> \\<otimes>\\<^sub>D F'.\\<psi>)", "show \"\\<guillemotleft>F'.\\<psi> : D'.unity \\<rightarrow>\\<^sub>D F C'.unity\\<guillemotright>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft>F'.\\<psi> : D'.unity \\<rightarrow>\\<^sub>D F\n                          C'.unity\\<guillemotright>", "using F'.\\<psi>_char(1)"], ["proof (prove)\nusing this:\n  \\<guillemotleft>F'.\\<psi> : D'.unity \\<rightarrow>\\<^sub>D F\n                        C'.unity\\<guillemotright>\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>F'.\\<psi> : D'.unity \\<rightarrow>\\<^sub>D F\n                          C'.unity\\<guillemotright>", "by simp"], ["proof (state)\nthis:\n  \\<guillemotleft>F'.\\<psi> : D'.unity \\<rightarrow>\\<^sub>D F\n                        C'.unity\\<guillemotright>\n\ngoal (2 subgoals):\n 1. D.iso F'.\\<psi>\n 2. F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (F'.\\<psi> \\<otimes>\\<^sub>D F'.\\<psi>)", "show \"D.iso F'.\\<psi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.iso F'.\\<psi>", "using F'.\\<psi>_char(2)"], ["proof (prove)\nusing this:\n  D.iso F'.\\<psi>\n\ngoal (1 subgoal):\n 1. D.iso F'.\\<psi>", "by simp"], ["proof (state)\nthis:\n  D.iso F'.\\<psi>\n\ngoal (1 subgoal):\n 1. F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (F'.\\<psi> \\<otimes>\\<^sub>D F'.\\<psi>)", "show \"F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D = \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (F'.\\<psi> \\<otimes>\\<^sub>D F'.\\<psi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (F'.\\<psi> \\<otimes>\\<^sub>D F'.\\<psi>)", "using F'.\\<psi>_char(3)"], ["proof (prove)\nusing this:\n  F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  F'.\\<iota>\\<^sub>1 \\<cdot>\\<^sub>D D'.T (F'.\\<psi>, F'.\\<psi>)\n\ngoal (1 subgoal):\n 1. F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n    \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (F'.\\<psi> \\<otimes>\\<^sub>D F'.\\<psi>)", "by simp"], ["proof (state)\nthis:\n  F'.\\<psi> \\<cdot>\\<^sub>D \\<iota>\\<^sub>D =\n  \\<iota>\\<^sub>1 \\<cdot>\\<^sub>D (F'.\\<psi> \\<otimes>\\<^sub>D F'.\\<psi>)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F'.\\<psi> = \\<psi>\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "moreover"], ["proof (state)\nthis:\n  F'.\\<psi> = \\<psi>\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "have \"D'.lunit (F a) = F (C'.lunit a) \\<cdot>\\<^sub>D \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D F'.\\<psi>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D'.lunit (F a) =\n    F (C'.lunit a) \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D F'.\\<psi>)", "using assms F'.lunit_coherence"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  D'.lunit (F ?a) =\n  F (C'.lunit ?a) \\<cdot>\\<^sub>D\n  \\<phi> (snd (C'.unity, ?a), fst (C'.unity, ?a)) \\<cdot>\\<^sub>D\n  D'.T (F'.\\<psi>, F ?a)\n\ngoal (1 subgoal):\n 1. D'.lunit (F a) =\n    F (C'.lunit a) \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D F'.\\<psi>)", "by simp"], ["proof (state)\nthis:\n  D'.lunit (F a) =\n  F (C'.lunit a) \\<cdot>\\<^sub>D\n  \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D F'.\\<psi>)\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "ultimately"], ["proof (chain)\npicking this:\n  C'.lunit a = \\<r>\\<^sub>C[a]\n  D'.lunit (F a) = \\<r>\\<^sub>D[F a]\n  F'.\\<psi> = \\<psi>\n  D'.lunit (F a) =\n  F (C'.lunit a) \\<cdot>\\<^sub>D\n  \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D F'.\\<psi>)", "show ?thesis"], ["proof (prove)\nusing this:\n  C'.lunit a = \\<r>\\<^sub>C[a]\n  D'.lunit (F a) = \\<r>\\<^sub>D[F a]\n  F'.\\<psi> = \\<psi>\n  D'.lunit (F a) =\n  F (C'.lunit a) \\<cdot>\\<^sub>D\n  \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D F'.\\<psi>)\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>D[F a] =\n    F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n    \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)", "by simp"], ["proof (state)\nthis:\n  \\<r>\\<^sub>D[F a] =\n  F \\<r>\\<^sub>C[a] \\<cdot>\\<^sub>D\n  \\<phi> (a, C'.unity) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<psi>)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "section \"Strict Monoidal Functor\""], ["", "text \\<open>\n    A strict monoidal functor preserves the monoidal structure ``on the nose''.\n\\<close>"], ["", "locale strict_monoidal_functor =\n    C: monoidal_category C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C +\n    D: monoidal_category D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D +\n    \"functor\" C D F\n  for C :: \"'c comp\"                    (infixr \"\\<cdot>\\<^sub>C\" 55)\n  and T\\<^sub>C :: \"'c * 'c \\<Rightarrow> 'c\"\n  and \\<alpha>\\<^sub>C :: \"'c * 'c * 'c \\<Rightarrow> 'c\"\n  and \\<iota>\\<^sub>C :: \"'c\"\n  and D :: \"'d comp\"                    (infixr \"\\<cdot>\\<^sub>D\" 55)\n  and T\\<^sub>D :: \"'d * 'd \\<Rightarrow> 'd\"\n  and \\<alpha>\\<^sub>D :: \"'d * 'd * 'd \\<Rightarrow> 'd\"\n  and \\<iota>\\<^sub>D :: \"'d\"\n  and F :: \"'c \\<Rightarrow> 'd\" +\n  assumes strictly_preserves_\\<iota>: \"F \\<iota>\\<^sub>C = \\<iota>\\<^sub>D\"\n  and strictly_preserves_T: \"\\<lbrakk> C.arr f; C.arr g \\<rbrakk> \\<Longrightarrow> F (T\\<^sub>C (f, g)) = T\\<^sub>D (F f, F g)\"\n  and strictly_preserves_\\<alpha>_ide: \"\\<lbrakk> C.ide a; C.ide b; C.ide c \\<rbrakk> \\<Longrightarrow>\n                                   F (\\<alpha>\\<^sub>C (a, b, c)) = \\<alpha>\\<^sub>D (F a, F b, F c)\"\n  begin"], ["", "notation C.tensor                  (infixr \"\\<otimes>\\<^sub>C\" 53)\n    and C.unity                        (\"\\<I>\\<^sub>C\")\n    and C.lunit                        (\"\\<l>\\<^sub>C[_]\")\n    and C.runit                        (\"\\<r>\\<^sub>C[_]\")\n    and C.assoc                        (\"\\<a>\\<^sub>C[_, _, _]\")\n    and D.tensor                       (infixr \"\\<otimes>\\<^sub>D\" 53)\n    and D.unity                        (\"\\<I>\\<^sub>D\")\n    and D.lunit                        (\"\\<l>\\<^sub>D[_]\")\n    and D.runit                        (\"\\<r>\\<^sub>D[_]\")\n    and D.assoc                        (\"\\<a>\\<^sub>D[_, _, _]\")"], ["", "lemma strictly_preserves_tensor:\n    assumes \"C.arr f\" and \"C.arr g\"\n    shows \"F (f \\<otimes>\\<^sub>C g) = F f \\<otimes>\\<^sub>D F g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (f \\<otimes>\\<^sub>C g) = F f \\<otimes>\\<^sub>D F g", "using assms strictly_preserves_T"], ["proof (prove)\nusing this:\n  C.arr f\n  C.arr g\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n\ngoal (1 subgoal):\n 1. F (f \\<otimes>\\<^sub>C g) = F f \\<otimes>\\<^sub>D F g", "by blast"], ["", "lemma strictly_preserves_\\<alpha>:\n    assumes \"C.arr f\" and \"C.arr g\" and \"C.arr h\"\n    shows \"F (\\<alpha>\\<^sub>C (f, g, h)) = \\<alpha>\\<^sub>D (F f, F g, F h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "have \"F (\\<alpha>\\<^sub>C (f, g, h)) = F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C \\<alpha>\\<^sub>C (C.dom f, C.dom g, C.dom h))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] =\n    F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n       \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h])", "using assms C.\\<alpha>.is_natural_1 [of \"(f, g, h)\"] C.T.ToCT_simp"], ["proof (prove)\nusing this:\n  C.arr f\n  C.arr g\n  C.arr h\n  C.CCC.arr (f, g, h) \\<Longrightarrow>\n  C.T.ToCT (f, g, h) \\<cdot>\\<^sub>C\n  \\<alpha>\\<^sub>C (C.CCC.dom (f, g, h)) =\n  \\<a>\\<^sub>C[f, g, h]\n  \\<lbrakk>C.arr ?f; C.arr ?g; C.arr ?h\\<rbrakk>\n  \\<Longrightarrow> C.T.ToCT (?f, ?g, ?h) =\n                    ?f \\<otimes>\\<^sub>C ?g \\<otimes>\\<^sub>C ?h\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] =\n    F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n       \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h])", "by force"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[f, g, h] =\n  F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h])\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "also"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[f, g, h] =\n  F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h])\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "have \"... = (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D \\<alpha>\\<^sub>D (D.dom (F f), D.dom (F g), D.dom (F h))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n       \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h]) =\n    (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[D.dom (F f), D.dom (F g), D.dom (F h)]", "using assms strictly_preserves_\\<alpha>_ide strictly_preserves_tensor"], ["proof (prove)\nusing this:\n  C.arr f\n  C.arr g\n  C.arr h\n  \\<lbrakk>C.ide ?a; C.ide ?b; C.ide ?c\\<rbrakk>\n  \\<Longrightarrow> F \\<a>\\<^sub>C[?a, ?b, ?c] =\n                    \\<a>\\<^sub>D[F ?a, F ?b, F ?c]\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n\ngoal (1 subgoal):\n 1. F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n       \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h]) =\n    (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[D.dom (F f), D.dom (F g), D.dom (F h)]", "by simp"], ["proof (state)\nthis:\n  F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h]) =\n  (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[D.dom (F f), D.dom (F g), D.dom (F h)]\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "also"], ["proof (state)\nthis:\n  F ((f \\<otimes>\\<^sub>C g \\<otimes>\\<^sub>C h) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[C.dom f, C.dom g, C.dom h]) =\n  (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[D.dom (F f), D.dom (F g), D.dom (F h)]\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "have \"... = \\<alpha>\\<^sub>D (F f, F g, F h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[D.dom (F f), D.dom (F g), D.dom (F h)] =\n    \\<a>\\<^sub>D[F f, F g, F h]", "using assms D.\\<alpha>.is_natural_1 [of \"(F f, F g, F h)\"]"], ["proof (prove)\nusing this:\n  C.arr f\n  C.arr g\n  C.arr h\n  D.CCC.arr (F f, F g, F h) \\<Longrightarrow>\n  D.T.ToCT (F f, F g, F h) \\<cdot>\\<^sub>D\n  \\<alpha>\\<^sub>D (D.CCC.dom (F f, F g, F h)) =\n  \\<a>\\<^sub>D[F f, F g, F h]\n\ngoal (1 subgoal):\n 1. (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[D.dom (F f), D.dom (F g), D.dom (F h)] =\n    \\<a>\\<^sub>D[F f, F g, F h]", "by simp"], ["proof (state)\nthis:\n  (F f \\<otimes>\\<^sub>D F g \\<otimes>\\<^sub>D F h) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[D.dom (F f), D.dom (F g), D.dom (F h)] =\n  \\<a>\\<^sub>D[F f, F g, F h]\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "finally"], ["proof (chain)\npicking this:\n  F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "show ?thesis"], ["proof (prove)\nusing this:\n  F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]", "by blast"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[f, g, h] = \\<a>\\<^sub>D[F f, F g, F h]\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma strictly_preserves_unity:\n    shows \"F \\<I>\\<^sub>C = \\<I>\\<^sub>D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<I>\\<^sub>C = \\<I>\\<^sub>D", "using C.\\<iota>_in_hom strictly_preserves_\\<iota> C.unity_def D.unity_def"], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n  F \\<iota>\\<^sub>C = \\<iota>\\<^sub>D\n  \\<I>\\<^sub>C \\<equiv> C.cod \\<iota>\\<^sub>C\n  \\<I>\\<^sub>D \\<equiv> D.cod \\<iota>\\<^sub>D\n\ngoal (1 subgoal):\n 1. F \\<I>\\<^sub>C = \\<I>\\<^sub>D", "by auto"], ["", "lemma strictly_preserves_assoc:\n    assumes \"C.arr a\" and \"C.arr b\" and \"C.arr c\"\n    shows \"F \\<a>\\<^sub>C[a, b, c] = \\<a>\\<^sub>D[F a, F b, F c] \""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[a, b, c] = \\<a>\\<^sub>D[F a, F b, F c]", "using assms strictly_preserves_\\<alpha>"], ["proof (prove)\nusing this:\n  C.arr a\n  C.arr b\n  C.arr c\n  \\<lbrakk>C.arr ?f; C.arr ?g; C.arr ?h\\<rbrakk>\n  \\<Longrightarrow> F \\<a>\\<^sub>C[?f, ?g, ?h] =\n                    \\<a>\\<^sub>D[F ?f, F ?g, F ?h]\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[a, b, c] = \\<a>\\<^sub>D[F a, F b, F c]", "by simp"], ["", "lemma strictly_preserves_lunit:\n    assumes \"C.ide a\"\n    shows \"F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "let ?P = \"\\<lambda>f. f \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and> \\<I>\\<^sub>C \\<otimes>\\<^sub>C f = (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a\""], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "let ?Q = \"\\<lambda>f. f \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n                    \\<I>\\<^sub>D \\<otimes>\\<^sub>D f = (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\""], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "have 1: \"?P \\<l>\\<^sub>C[a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a", "using assms C.lunit_char"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  \\<guillemotleft>\\<l>\\<^sub>C[?a] : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                     ?a \\<rightarrow>\\<^sub>C ?a\\<guillemotright>\n  C.ide ?a \\<Longrightarrow>\n  \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[?a] =\n  (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C ?a) \\<cdot>\\<^sub>C\n  C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C ?a\n  C.ide ?a \\<Longrightarrow>\n  \\<exists>!f.\n     \\<guillemotleft>f : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                         ?a \\<rightarrow>\\<^sub>C ?a\\<guillemotright> \\<and>\n     \\<I>\\<^sub>C \\<otimes>\\<^sub>C f =\n     (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C ?a) \\<cdot>\\<^sub>C\n     C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C ?a\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a", "by simp"], ["proof (state)\nthis:\n  \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n  \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n  C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "hence \"?Q (F \\<l>\\<^sub>C[a])\""], ["proof (prove)\nusing this:\n  \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n  \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n  C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a \\<Longrightarrow>\n    F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "have \"F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)", "using assms 1 strictly_preserves_unity strictly_preserves_tensor"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n  \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n  C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a\n  F \\<I>\\<^sub>C = \\<I>\\<^sub>D\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)", "by auto"], ["proof (state)\nthis:\n  F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a \\<Longrightarrow>\n    F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "moreover"], ["proof (state)\nthis:\n  F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a \\<Longrightarrow>\n    F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "have\n            \"F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) = (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n       C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "using assms 1 strictly_preserves_\\<iota> strictly_preserves_assoc strictly_preserves_unity\n                strictly_preserves_tensor preserves_inv C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n  \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n  C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a\n  F \\<iota>\\<^sub>C = \\<iota>\\<^sub>D\n  \\<lbrakk>C.arr ?a; C.arr ?b; C.arr ?c\\<rbrakk>\n  \\<Longrightarrow> F \\<a>\\<^sub>C[?a, ?b, ?c] =\n                    \\<a>\\<^sub>D[F ?a, F ?b, F ?c]\n  F \\<I>\\<^sub>C = \\<I>\\<^sub>D\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n  C.iso ?f \\<Longrightarrow> F (C.inv ?f) = D.inv (F ?f)\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n       C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "by auto"], ["proof (state)\nthis:\n  F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n     C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a \\<Longrightarrow>\n    F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "moreover"], ["proof (state)\nthis:\n  F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n     C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a \\<Longrightarrow>\n    F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "have \"\\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] = F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])", "using assms strictly_preserves_unity strictly_preserves_tensor"], ["proof (prove)\nusing this:\n  C.ide a\n  F \\<I>\\<^sub>C = \\<I>\\<^sub>D\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n\ngoal (1 subgoal):\n 1. \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])", "by simp"], ["proof (state)\nthis:\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])\n\ngoal (1 subgoal):\n 1. \\<l>\\<^sub>C[a] \\<in> C.hom (\\<I>\\<^sub>C \\<otimes>\\<^sub>C a) a \\<and>\n    \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n    C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a \\<Longrightarrow>\n    F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "ultimately"], ["proof (chain)\npicking this:\n  F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)\n  F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n     C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])", "show ?thesis"], ["proof (prove)\nusing this:\n  F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)\n  F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n     C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "using assms C.lunit_char(2)"], ["proof (prove)\nusing this:\n  F \\<l>\\<^sub>C[a] \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a)\n  F ((\\<iota>\\<^sub>C \\<otimes>\\<^sub>C a) \\<cdot>\\<^sub>C\n     C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C a) =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  F (\\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[a])\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  \\<I>\\<^sub>C \\<otimes>\\<^sub>C \\<l>\\<^sub>C[?a] =\n  (\\<iota>\\<^sub>C \\<otimes>\\<^sub>C ?a) \\<cdot>\\<^sub>C\n  C.assoc' \\<I>\\<^sub>C \\<I>\\<^sub>C ?a\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a]\n    \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n    \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n    (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n    D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)", "by simp"], ["proof (state)\nthis:\n  F \\<l>\\<^sub>C[a]\n  \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F \\<l>\\<^sub>C[a]\n  \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "thus ?thesis"], ["proof (prove)\nusing this:\n  F \\<l>\\<^sub>C[a]\n  \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "using assms D.lunit_eqI"], ["proof (prove)\nusing this:\n  F \\<l>\\<^sub>C[a]\n  \\<in> D.hom (\\<I>\\<^sub>D \\<otimes>\\<^sub>D F a) (F a) \\<and>\n  \\<I>\\<^sub>D \\<otimes>\\<^sub>D F \\<l>\\<^sub>C[a] =\n  (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D F a) \\<cdot>\\<^sub>D\n  D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D (F a)\n  C.ide a\n  \\<lbrakk>\\<guillemotleft>?f : \\<I>\\<^sub>D \\<otimes>\\<^sub>D\n                                ?a \\<rightarrow>\\<^sub>D ?a\\<guillemotright>;\n   \\<I>\\<^sub>D \\<otimes>\\<^sub>D ?f =\n   (\\<iota>\\<^sub>D \\<otimes>\\<^sub>D ?a) \\<cdot>\\<^sub>D\n   D.assoc' \\<I>\\<^sub>D \\<I>\\<^sub>D ?a\\<rbrakk>\n  \\<Longrightarrow> ?f = \\<l>\\<^sub>D[?a]\n\ngoal (1 subgoal):\n 1. F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]", "by simp"], ["proof (state)\nthis:\n  F \\<l>\\<^sub>C[a] = \\<l>\\<^sub>D[F a]\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma strictly_preserves_runit:\n    assumes \"C.ide a\"\n    shows \"F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "let ?P = \"\\<lambda>f. f \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and> f \\<otimes>\\<^sub>C \\<I>\\<^sub>C = (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C C.assoc a \\<I>\\<^sub>C \\<I>\\<^sub>C\""], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "let ?Q = \"\\<lambda>f. f \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n                    f \\<otimes>\\<^sub>D \\<I>\\<^sub>D = (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D D.assoc (F a) \\<I>\\<^sub>D \\<I>\\<^sub>D\""], ["proof (state)\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "have 1: \"?P \\<r>\\<^sub>C[a]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]", "using assms C.runit_char"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  \\<guillemotleft>\\<r>\\<^sub>C[?a] : ?a \\<otimes>\\<^sub>C\n                                     \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C ?a\\<guillemotright>\n  C.ide ?a \\<Longrightarrow>\n  \\<r>\\<^sub>C[?a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n  (?a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n  \\<a>\\<^sub>C[?a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]\n  C.ide ?a \\<Longrightarrow>\n  \\<exists>!f.\n     \\<guillemotleft>f : ?a \\<otimes>\\<^sub>C\n                         \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C ?a\\<guillemotright> \\<and>\n     f \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n     (?a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[?a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]", "by simp"], ["proof (state)\nthis:\n  \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n  \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n  (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n  \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "hence \"?Q (F \\<r>\\<^sub>C[a])\""], ["proof (prove)\nusing this:\n  \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n  \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n  (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n  \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C] \\<Longrightarrow>\n    F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "have \"F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)", "using assms 1 strictly_preserves_unity strictly_preserves_tensor"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n  \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n  (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n  \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]\n  F \\<I>\\<^sub>C = \\<I>\\<^sub>D\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)", "by auto"], ["proof (state)\nthis:\n  F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C] \\<Longrightarrow>\n    F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "moreover"], ["proof (state)\nthis:\n  F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C] \\<Longrightarrow>\n    F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "have \"F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C C.assoc a \\<I>\\<^sub>C \\<I>\\<^sub>C)\n                         = (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D D.assoc (F a) \\<I>\\<^sub>D \\<I>\\<^sub>D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n       \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]) =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "using assms 1 strictly_preserves_\\<iota> strictly_preserves_assoc strictly_preserves_unity\n                strictly_preserves_tensor preserves_inv C.\\<iota>_in_hom"], ["proof (prove)\nusing this:\n  C.ide a\n  \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n  \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n  (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n  \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]\n  F \\<iota>\\<^sub>C = \\<iota>\\<^sub>D\n  \\<lbrakk>C.arr ?a; C.arr ?b; C.arr ?c\\<rbrakk>\n  \\<Longrightarrow> F \\<a>\\<^sub>C[?a, ?b, ?c] =\n                    \\<a>\\<^sub>D[F ?a, F ?b, F ?c]\n  F \\<I>\\<^sub>C = \\<I>\\<^sub>D\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n  C.iso ?f \\<Longrightarrow> F (C.inv ?f) = D.inv (F ?f)\n  \\<guillemotleft>\\<iota>\\<^sub>C : \\<I>\\<^sub>C \\<otimes>\\<^sub>C\n                                    \\<I>\\<^sub>C \\<rightarrow>\\<^sub>C \\<I>\\<^sub>C\\<guillemotright>\n\ngoal (1 subgoal):\n 1. F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n       \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]) =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "by auto"], ["proof (state)\nthis:\n  F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]) =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C] \\<Longrightarrow>\n    F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "moreover"], ["proof (state)\nthis:\n  F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]) =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C] \\<Longrightarrow>\n    F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "have \"F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D = F (\\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    F (\\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C)", "using assms strictly_preserves_unity strictly_preserves_tensor"], ["proof (prove)\nusing this:\n  C.ide a\n  F \\<I>\\<^sub>C = \\<I>\\<^sub>D\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    F (\\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C)", "by simp"], ["proof (state)\nthis:\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  F (\\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C)\n\ngoal (1 subgoal):\n 1. \\<r>\\<^sub>C[a] \\<in> C.hom (a \\<otimes>\\<^sub>C \\<I>\\<^sub>C) a \\<and>\n    \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n    (a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n    \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C] \\<Longrightarrow>\n    F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "ultimately"], ["proof (chain)\npicking this:\n  F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)\n  F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]) =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  F (\\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C)", "show ?thesis"], ["proof (prove)\nusing this:\n  F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)\n  F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]) =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  F (\\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C)\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "using assms C.runit_char(2)"], ["proof (prove)\nusing this:\n  F \\<r>\\<^sub>C[a] \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a)\n  F ((a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n     \\<a>\\<^sub>C[a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]) =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  F (\\<r>\\<^sub>C[a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C)\n  C.ide a\n  C.ide ?a \\<Longrightarrow>\n  \\<r>\\<^sub>C[?a] \\<otimes>\\<^sub>C \\<I>\\<^sub>C =\n  (?a \\<otimes>\\<^sub>C \\<iota>\\<^sub>C) \\<cdot>\\<^sub>C\n  \\<a>\\<^sub>C[?a, \\<I>\\<^sub>C, \\<I>\\<^sub>C]\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a]\n    \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n    F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n    (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]", "by simp"], ["proof (state)\nthis:\n  F \\<r>\\<^sub>C[a]\n  \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  F \\<r>\\<^sub>C[a]\n  \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "thus ?thesis"], ["proof (prove)\nusing this:\n  F \\<r>\\<^sub>C[a]\n  \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "using assms D.runit_eqI"], ["proof (prove)\nusing this:\n  F \\<r>\\<^sub>C[a]\n  \\<in> D.hom (F a \\<otimes>\\<^sub>D \\<I>\\<^sub>D) (F a) \\<and>\n  F \\<r>\\<^sub>C[a] \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n  (F a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\n  C.ide a\n  \\<lbrakk>\\<guillemotleft>?f : ?a \\<otimes>\\<^sub>D\n                                \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D ?a\\<guillemotright>;\n   ?f \\<otimes>\\<^sub>D \\<I>\\<^sub>D =\n   (?a \\<otimes>\\<^sub>D \\<iota>\\<^sub>D) \\<cdot>\\<^sub>D\n   \\<a>\\<^sub>D[?a, \\<I>\\<^sub>D, \\<I>\\<^sub>D]\\<rbrakk>\n  \\<Longrightarrow> ?f = \\<r>\\<^sub>D[?a]\n\ngoal (1 subgoal):\n 1. F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]", "by simp"], ["proof (state)\nthis:\n  F \\<r>\\<^sub>C[a] = \\<r>\\<^sub>D[F a]\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n      The following are used to simplify the expression of the sublocale relationship between\n      @{locale strict_monoidal_functor} and @{locale monoidal_functor}, as the definition of\n      the latter mentions the structure map @{term \\<phi>}.  For a strict monoidal functor,\n      this is an identity transformation.\n\\<close>"], ["", "interpretation FF: product_functor C C D D F F"], ["proof (prove)\ngoal (1 subgoal):\n 1. product_functor (\\<cdot>\\<^sub>C) (\\<cdot>\\<^sub>C) (\\<cdot>\\<^sub>D)\n     (\\<cdot>\\<^sub>D) F F", ".."], ["", "interpretation FoT\\<^sub>C: composite_functor C.CC.comp C D T\\<^sub>C F"], ["proof (prove)\ngoal (1 subgoal):\n 1. composite_functor C.CC.comp (\\<cdot>\\<^sub>C) (\\<cdot>\\<^sub>D)\n     T\\<^sub>C F", ".."], ["", "interpretation T\\<^sub>DoFF: composite_functor C.CC.comp D.CC.comp D FF.map T\\<^sub>D"], ["proof (prove)\ngoal (1 subgoal):\n 1. composite_functor C.CC.comp D.CC.comp (\\<cdot>\\<^sub>D) FF.map T\\<^sub>D", ".."], ["", "lemma structure_is_trivial:\n    shows \"T\\<^sub>DoFF.map = FoT\\<^sub>C.map\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T\\<^sub>DoFF.map = FoT\\<^sub>C.map", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "have \"C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "assume x: \"C.CC.arr x\""], ["proof (state)\nthis:\n  C.CC.arr x\n\ngoal (1 subgoal):\n 1. C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "have \"T\\<^sub>DoFF.map x = F (fst x) \\<otimes>\\<^sub>D F (snd x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. T\\<^sub>DoFF.map x = F (fst x) \\<otimes>\\<^sub>D F (snd x)", "using x"], ["proof (prove)\nusing this:\n  C.CC.arr x\n\ngoal (1 subgoal):\n 1. T\\<^sub>DoFF.map x = F (fst x) \\<otimes>\\<^sub>D F (snd x)", "by simp"], ["proof (state)\nthis:\n  T\\<^sub>DoFF.map x = F (fst x) \\<otimes>\\<^sub>D F (snd x)\n\ngoal (1 subgoal):\n 1. C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "also"], ["proof (state)\nthis:\n  T\\<^sub>DoFF.map x = F (fst x) \\<otimes>\\<^sub>D F (snd x)\n\ngoal (1 subgoal):\n 1. C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "have \"... = FoT\\<^sub>C.map x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F (fst x) \\<otimes>\\<^sub>D F (snd x) = FoT\\<^sub>C.map x", "using x strictly_preserves_tensor [of \"fst x\" \"snd x\"]"], ["proof (prove)\nusing this:\n  C.CC.arr x\n  \\<lbrakk>C.arr (fst x); C.arr (snd x)\\<rbrakk>\n  \\<Longrightarrow> F (fst x \\<otimes>\\<^sub>C snd x) =\n                    F (fst x) \\<otimes>\\<^sub>D F (snd x)\n\ngoal (1 subgoal):\n 1. F (fst x) \\<otimes>\\<^sub>D F (snd x) = FoT\\<^sub>C.map x", "by simp"], ["proof (state)\nthis:\n  F (fst x) \\<otimes>\\<^sub>D F (snd x) = FoT\\<^sub>C.map x\n\ngoal (1 subgoal):\n 1. C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "finally"], ["proof (chain)\npicking this:\n  T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "show \"T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\""], ["proof (prove)\nusing this:\n  T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n\ngoal (1 subgoal):\n 1. T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "by simp"], ["proof (state)\nthis:\n  T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n\ngoal (1 subgoal):\n 1. \\<And>x. T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "moreover"], ["proof (state)\nthis:\n  C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n\ngoal (1 subgoal):\n 1. \\<And>x. T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "have \"\\<not> C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> C.CC.arr x \\<Longrightarrow>\n    T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "using T\\<^sub>DoFF.is_extensional FoT\\<^sub>C.is_extensional"], ["proof (prove)\nusing this:\n  \\<not> C.CC.arr ?f \\<Longrightarrow> T\\<^sub>DoFF.map ?f = D.null\n  \\<not> C.CC.arr ?f \\<Longrightarrow> FoT\\<^sub>C.map ?f = D.null\n\ngoal (1 subgoal):\n 1. \\<not> C.CC.arr x \\<Longrightarrow>\n    T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "by simp"], ["proof (state)\nthis:\n  \\<not> C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n\ngoal (1 subgoal):\n 1. \\<And>x. T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "ultimately"], ["proof (chain)\npicking this:\n  C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n  \\<not> C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "show \"T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\""], ["proof (prove)\nusing this:\n  C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n  \\<not> C.CC.arr x \\<Longrightarrow> T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n\ngoal (1 subgoal):\n 1. T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x", "by blast"], ["proof (state)\nthis:\n  T\\<^sub>DoFF.map x = FoT\\<^sub>C.map x\n\ngoal:\nNo subgoals!", "qed"], ["", "abbreviation \\<phi> where \"\\<phi> \\<equiv> T\\<^sub>DoFF.map\""], ["", "lemma structure_is_natural_isomorphism:\n    shows \"natural_isomorphism C.CC.comp D T\\<^sub>DoFF.map FoT\\<^sub>C.map \\<phi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_isomorphism C.CC.comp (\\<cdot>\\<^sub>D) \\<phi> FoT\\<^sub>C.map\n     \\<phi>", "using T\\<^sub>DoFF.natural_isomorphism_axioms structure_is_trivial"], ["proof (prove)\nusing this:\n  natural_isomorphism C.CC.comp (\\<cdot>\\<^sub>D) \\<phi> \\<phi> \\<phi>\n  \\<phi> = FoT\\<^sub>C.map\n\ngoal (1 subgoal):\n 1. natural_isomorphism C.CC.comp (\\<cdot>\\<^sub>D) \\<phi> FoT\\<^sub>C.map\n     \\<phi>", "by force"], ["", "end"], ["", "text \\<open>\n    A strict monoidal functor is a monoidal functor.\n\\<close>"], ["", "sublocale strict_monoidal_functor \\<subseteq> monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D F \\<phi>"], ["proof (prove)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D F \\<phi>", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D F \\<phi>", "interpret FF: product_functor C C D D F F"], ["proof (prove)\ngoal (1 subgoal):\n 1. product_functor (\\<cdot>\\<^sub>C) (\\<cdot>\\<^sub>C) (\\<cdot>\\<^sub>D)\n     (\\<cdot>\\<^sub>D) F F", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D F \\<phi>", "interpret FoT\\<^sub>C: composite_functor C.CC.comp C D T\\<^sub>C F"], ["proof (prove)\ngoal (1 subgoal):\n 1. composite_functor C.CC.comp (\\<cdot>\\<^sub>C) (\\<cdot>\\<^sub>D)\n     T\\<^sub>C F", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D F \\<phi>", "interpret T\\<^sub>DoFF: composite_functor C.CC.comp D.CC.comp D FF.map T\\<^sub>D"], ["proof (prove)\ngoal (1 subgoal):\n 1. composite_functor C.CC.comp D.CC.comp (\\<cdot>\\<^sub>D) FF.map T\\<^sub>D", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D F T\\<^sub>DoFF.map", "interpret \\<phi>: natural_isomorphism C.CC.comp D T\\<^sub>DoFF.map FoT\\<^sub>C.map \\<phi>"], ["proof (prove)\ngoal (1 subgoal):\n 1. natural_isomorphism C.CC.comp (\\<cdot>\\<^sub>D) T\\<^sub>DoFF.map\n     FoT\\<^sub>C.map T\\<^sub>DoFF.map", "using structure_is_natural_isomorphism"], ["proof (prove)\nusing this:\n  natural_isomorphism C.CC.comp (\\<cdot>\\<^sub>D) T\\<^sub>DoFF.map\n   FoT\\<^sub>C.map T\\<^sub>DoFF.map\n\ngoal (1 subgoal):\n 1. natural_isomorphism C.CC.comp (\\<cdot>\\<^sub>D) T\\<^sub>DoFF.map\n     FoT\\<^sub>C.map T\\<^sub>DoFF.map", "by simp"], ["proof (state)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D F T\\<^sub>DoFF.map", "show \"monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D F \\<phi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n     \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n     \\<iota>\\<^sub>D F T\\<^sub>DoFF.map", "proof"], ["proof (state)\ngoal (2 subgoals):\n 1. D.isomorphic \\<I>\\<^sub>D (F \\<I>\\<^sub>C)\n 2. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c\\<rbrakk>\n       \\<Longrightarrow> F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n                         T\\<^sub>DoFF.map\n                          (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n                         (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n                         T\\<^sub>DoFF.map\n                          (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n                         (F a \\<otimes>\\<^sub>D\n                          T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D[F a, F b, F c]", "show \"D.isomorphic \\<I>\\<^sub>D (F \\<I>\\<^sub>C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. D.isomorphic \\<I>\\<^sub>D (F \\<I>\\<^sub>C)", "proof (unfold D.isomorphic_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>f.\n       \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso f", "have \"\\<guillemotleft>\\<I>\\<^sub>D : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso \\<I>\\<^sub>D\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<I>\\<^sub>D : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                 \\<I>\\<^sub>C\\<guillemotright> \\<and>\n    D.iso \\<I>\\<^sub>D", "using strictly_preserves_unity"], ["proof (prove)\nusing this:\n  F \\<I>\\<^sub>C = \\<I>\\<^sub>D\n\ngoal (1 subgoal):\n 1. \\<guillemotleft>\\<I>\\<^sub>D : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                                 \\<I>\\<^sub>C\\<guillemotright> \\<and>\n    D.iso \\<I>\\<^sub>D", "by auto"], ["proof (state)\nthis:\n  \\<guillemotleft>\\<I>\\<^sub>D : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                               \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<I>\\<^sub>D\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso f", "thus \"\\<exists>f. \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F \\<I>\\<^sub>C\\<guillemotright> \\<and> D.iso f\""], ["proof (prove)\nusing this:\n  \\<guillemotleft>\\<I>\\<^sub>D : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                               \\<I>\\<^sub>C\\<guillemotright> \\<and>\n  D.iso \\<I>\\<^sub>D\n\ngoal (1 subgoal):\n 1. \\<exists>f.\n       \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                         \\<I>\\<^sub>C\\<guillemotright> \\<and>\n       D.iso f", "by blast"], ["proof (state)\nthis:\n  \\<exists>f.\n     \\<guillemotleft>f : \\<I>\\<^sub>D \\<rightarrow>\\<^sub>D F\n                       \\<I>\\<^sub>C\\<guillemotright> \\<and>\n     D.iso f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  D.isomorphic \\<I>\\<^sub>D (F \\<I>\\<^sub>C)\n\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c\\<rbrakk>\n       \\<Longrightarrow> F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n                         T\\<^sub>DoFF.map\n                          (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n                         (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n                         T\\<^sub>DoFF.map\n                          (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n                         (F a \\<otimes>\\<^sub>D\n                          T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D[F a, F b, F c]", "fix a b c"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c\\<rbrakk>\n       \\<Longrightarrow> F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n                         T\\<^sub>DoFF.map\n                          (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n                         (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n                         T\\<^sub>DoFF.map\n                          (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n                         (F a \\<otimes>\\<^sub>D\n                          T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D[F a, F b, F c]", "assume a: \"C.ide a\""], ["proof (state)\nthis:\n  C.ide a\n\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c\\<rbrakk>\n       \\<Longrightarrow> F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n                         T\\<^sub>DoFF.map\n                          (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n                         (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n                         T\\<^sub>DoFF.map\n                          (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n                         (F a \\<otimes>\\<^sub>D\n                          T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D[F a, F b, F c]", "assume b: \"C.ide b\""], ["proof (state)\nthis:\n  C.ide b\n\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c\\<rbrakk>\n       \\<Longrightarrow> F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n                         T\\<^sub>DoFF.map\n                          (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n                         (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n                         T\\<^sub>DoFF.map\n                          (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n                         (F a \\<otimes>\\<^sub>D\n                          T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D[F a, F b, F c]", "assume c: \"C.ide c\""], ["proof (state)\nthis:\n  C.ide c\n\ngoal (1 subgoal):\n 1. \\<And>a b c.\n       \\<lbrakk>C.ide a; C.ide b; C.ide c\\<rbrakk>\n       \\<Longrightarrow> F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n                         T\\<^sub>DoFF.map\n                          (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n                         (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n                         T\\<^sub>DoFF.map\n                          (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n                         (F a \\<otimes>\\<^sub>D\n                          T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n                         \\<a>\\<^sub>D[F a, F b, F c]", "show \"F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D \\<phi> (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D (\\<phi> (a, b) \\<otimes>\\<^sub>D F c) =\n            \\<phi> (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D (F a \\<otimes>\\<^sub>D \\<phi> (b, c)) \\<cdot>\\<^sub>D \\<a>\\<^sub>D[F a, F b, F c]\""], ["proof (prove)\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n    T\\<^sub>DoFF.map (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n    (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n    T\\<^sub>DoFF.map (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n    (F a \\<otimes>\\<^sub>D T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, F b, F c]", "using a b c strictly_preserves_tensor strictly_preserves_assoc\n              D.comp_arr_dom D.comp_cod_arr"], ["proof (prove)\nusing this:\n  C.ide a\n  C.ide b\n  C.ide c\n  \\<lbrakk>C.arr ?f; C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (?f \\<otimes>\\<^sub>C ?g) =\n                    F ?f \\<otimes>\\<^sub>D F ?g\n  \\<lbrakk>C.arr ?a; C.arr ?b; C.arr ?c\\<rbrakk>\n  \\<Longrightarrow> F \\<a>\\<^sub>C[?a, ?b, ?c] =\n                    \\<a>\\<^sub>D[F ?a, F ?b, F ?c]\n  \\<lbrakk>D.arr ?f; D.dom ?f = ?a\\<rbrakk>\n  \\<Longrightarrow> ?f \\<cdot>\\<^sub>D ?a = ?f\n  \\<lbrakk>D.arr ?f; D.cod ?f = ?b\\<rbrakk>\n  \\<Longrightarrow> ?b \\<cdot>\\<^sub>D ?f = ?f\n\ngoal (1 subgoal):\n 1. F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n    T\\<^sub>DoFF.map (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n    (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n    T\\<^sub>DoFF.map (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n    (F a \\<otimes>\\<^sub>D T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n    \\<a>\\<^sub>D[F a, F b, F c]", "by simp"], ["proof (state)\nthis:\n  F \\<a>\\<^sub>C[a, b, c] \\<cdot>\\<^sub>D\n  T\\<^sub>DoFF.map (a \\<otimes>\\<^sub>C b, c) \\<cdot>\\<^sub>D\n  (T\\<^sub>DoFF.map (a, b) \\<otimes>\\<^sub>D F c) =\n  T\\<^sub>DoFF.map (a, b \\<otimes>\\<^sub>C c) \\<cdot>\\<^sub>D\n  (F a \\<otimes>\\<^sub>D T\\<^sub>DoFF.map (b, c)) \\<cdot>\\<^sub>D\n  \\<a>\\<^sub>D[F a, F b, F c]\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  monoidal_functor (\\<cdot>\\<^sub>C) T\\<^sub>C \\<alpha>\\<^sub>C\n   \\<iota>\\<^sub>C (\\<cdot>\\<^sub>D) T\\<^sub>D \\<alpha>\\<^sub>D\n   \\<iota>\\<^sub>D F T\\<^sub>DoFF.map\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma strict_monoidal_functors_compose:\n  assumes \"strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C F\"\n  and \"strict_monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D G\"\n  shows \"strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D (G o F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D (G \\<circ> F)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D (G \\<circ> F)", "interpret F: strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C F"], ["proof (prove)\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B C\n     T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C F", "using assms(1)"], ["proof (prove)\nusing this:\n  strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B C\n   T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C F\n\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B C\n     T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C F", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D (G \\<circ> F)", "interpret G: strict_monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D G"], ["proof (prove)\ngoal (1 subgoal):\n 1. strict_monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D G", "using assms(2)"], ["proof (prove)\nusing this:\n  strict_monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D\n   T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D G\n\ngoal (1 subgoal):\n 1. strict_monoidal_functor C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D G", "by auto"], ["proof (state)\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D (G \\<circ> F)", "interpret GoF: composite_functor B C D F G"], ["proof (prove)\ngoal (1 subgoal):\n 1. composite_functor B C D F G", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D GoF.map", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D GoF.map", "using F.strictly_preserves_T F.strictly_preserves_\\<iota> F.strictly_preserves_\\<alpha>\n            G.strictly_preserves_T G.strictly_preserves_\\<iota> G.strictly_preserves_\\<alpha>"], ["proof (prove)\nusing this:\n  \\<lbrakk>F.C.arr ?f; F.C.arr ?g\\<rbrakk>\n  \\<Longrightarrow> F (F.C.tensor ?f ?g) = F.D.tensor (F ?f) (F ?g)\n  F \\<iota>\\<^sub>B = \\<iota>\\<^sub>C\n  \\<lbrakk>F.C.arr ?f; F.C.arr ?g; F.C.arr ?h\\<rbrakk>\n  \\<Longrightarrow> F (F.C.assoc ?f ?g ?h) = F.D.assoc (F ?f) (F ?g) (F ?h)\n  \\<lbrakk>F.D.arr ?f; F.D.arr ?g\\<rbrakk>\n  \\<Longrightarrow> G (F.D.tensor ?f ?g) = G.D.tensor (G ?f) (G ?g)\n  G \\<iota>\\<^sub>C = \\<iota>\\<^sub>D\n  \\<lbrakk>F.D.arr ?f; F.D.arr ?g; F.D.arr ?h\\<rbrakk>\n  \\<Longrightarrow> G (F.D.assoc ?f ?g ?h) = G.D.assoc (G ?f) (G ?g) (G ?h)\n\ngoal (1 subgoal):\n 1. strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n     T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D GoF.map", "by (unfold_locales, simp_all)"], ["proof (state)\nthis:\n  strict_monoidal_functor B T\\<^sub>B \\<alpha>\\<^sub>B \\<iota>\\<^sub>B D\n   T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D GoF.map\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n    An equivalence of monoidal categories is a monoidal functor whose underlying\n    ordinary functor is also part of an ordinary equivalence of categories.\n\\<close>"], ["", "locale equivalence_of_monoidal_categories =\n    C: monoidal_category C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C +\n    D: monoidal_category D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D +\n    equivalence_of_categories C D F G \\<eta> \\<epsilon> +\n    monoidal_functor D T\\<^sub>D \\<alpha>\\<^sub>D \\<iota>\\<^sub>D C T\\<^sub>C \\<alpha>\\<^sub>C \\<iota>\\<^sub>C F \\<phi>\n  for C :: \"'c comp\"                    (infixr \"\\<cdot>\\<^sub>C\" 55)\n  and T\\<^sub>C :: \"'c * 'c \\<Rightarrow> 'c\"\n  and \\<alpha>\\<^sub>C :: \"'c * 'c * 'c \\<Rightarrow> 'c\"\n  and \\<iota>\\<^sub>C :: \"'c\"\n  and D :: \"'d comp\"                    (infixr \"\\<cdot>\\<^sub>D\" 55)\n  and T\\<^sub>D :: \"'d * 'd \\<Rightarrow> 'd\"\n  and \\<alpha>\\<^sub>D :: \"'d * 'd * 'd \\<Rightarrow> 'd\"\n  and \\<iota>\\<^sub>D :: \"'d\"\n  and F :: \"'d \\<Rightarrow> 'c\"\n  and \\<phi> :: \"'d * 'd \\<Rightarrow> 'c\"\n  and \\<iota> :: 'c\n  and G :: \"'c \\<Rightarrow> 'd\"\n  and \\<eta> :: \"'d \\<Rightarrow> 'd\"\n  and \\<epsilon> :: \"'c \\<Rightarrow> 'c\""], ["", "end"]]}