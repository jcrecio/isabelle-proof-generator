{"file_name": "/home/qj213/afp-2021-10-22/thys/Types_To_Sets_Extension/Examples/SML_Relativization/Foundations/Transfer_Ext.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Types_To_Sets_Extension", "problem_names": ["lemma bi_unique_intersect_r:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T (a \\<inter> b) xr\" \n  shows \"a' \\<inter> b' = xr\"", "lemma bi_unique_intersect_l:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T xl (a' \\<inter> b')\" \n  shows \"a \\<inter> b = xl\"", "lemma bi_unique_intersect:\n  assumes \"bi_unique T\" and \"rel_set T a a'\" and \"rel_set T b b'\" \n  shows \"rel_set T (a \\<inter> b) (a' \\<inter> b')\"", "lemma bi_unique_union_r:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T (a \\<union> b) xr\" \n  shows \"a' \\<union> b' = xr\"", "lemma bi_unique_union_l:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T xl (a' \\<union> b')\" \n  shows \"a \\<union> b = xl\"", "lemma bi_unique_union:\n  assumes \"bi_unique T\" and \"rel_set T a a'\" and \"rel_set T b b'\" \n  shows \"rel_set T (a \\<union> b) (a' \\<union> b')\"", "lemma bi_unique_Union_r:\n  fixes T :: \"['a, 'b] \\<Rightarrow> bool\" and K\n  defines K':  \"K' \\<equiv> {(x, y). rel_set T x y} `` K\"\n  assumes \"bi_unique T\" \n    and \"\\<Union>K \\<subseteq> Collect (Domainp T)\" \n    and \"rel_set T (\\<Union>K) xr\" \n  shows \"\\<Union>K' = xr\"", "lemma bi_unique_Union_l:\n  fixes T :: \"['a, 'b] \\<Rightarrow> bool\" and K'\n  defines K: \"K \\<equiv> {(x, y). rel_set (\\<lambda> y x. T x y) x y} `` K'\"\n  assumes \"bi_unique T\" \n    and \"\\<Union>K' \\<subseteq> Collect (Rangep T)\" \n    and \"rel_set T xl (\\<Union>K')\" \n  shows \"\\<Union>K = xl\"", "lemma Domainp_applyI:\n  includes lifting_syntax\n  shows \"(A ===> B) f g \\<Longrightarrow> A x y \\<Longrightarrow> Domainp B (f x)\"", "lemma Domainp_fun:\n  assumes \"left_unique A\" \n  shows \n    \"Domainp (rel_fun A B) = \n      (\\<lambda>f. f ` (Collect (Domainp A)) \\<subseteq> (Collect (Domainp B)))\"", "lemma Bex_fun_transfer[transfer_rule]:\n  assumes \"bi_unique A\" \"right_total B\"\n  shows \n    \"(((A ===> B) ===> (=)) ===> (=)) \n      (Bex (Collect (\\<lambda>f. f ` (Collect (Domainp A)) \\<subseteq> (Collect (Domainp B))))) \n      Ex\""], "translations": [["", "lemma bi_unique_intersect_r:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T (a \\<inter> b) xr\" \n  shows \"a' \\<inter> b' = xr\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "assume \"x \\<in> a \\<inter> b\""], ["proof (state)\nthis:\n  x \\<in> a \\<inter> b\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "then"], ["proof (chain)\npicking this:\n  x \\<in> a \\<inter> b", "have \"x \\<in> a\" and \"x \\<in> b\""], ["proof (prove)\nusing this:\n  x \\<in> a \\<inter> b\n\ngoal (1 subgoal):\n 1. x \\<in> a &&& x \\<in> b", "by simp+"], ["proof (state)\nthis:\n  x \\<in> a\n  x \\<in> b\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "from assms(2) \\<open>x \\<in> a\\<close>"], ["proof (chain)\npicking this:\n  rel_set T a a'\n  x \\<in> a", "have \"\\<exists>y \\<in> a'. T x y\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n  x \\<in> a\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a'. T x y", "by (rule rel_setD1)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "moreover"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "from assms(3) \\<open>x \\<in> b\\<close>"], ["proof (chain)\npicking this:\n  rel_set T b b'\n  x \\<in> b", "have \"\\<exists>y \\<in> b'. T x y\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n  x \\<in> b\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>b'. T x y", "by (rule rel_setD1)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>b'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "ultimately"], ["proof (chain)\npicking this:\n  \\<exists>y\\<in>a'. T x y\n  \\<exists>y\\<in>b'. T x y", "have \"\\<exists>y \\<in> a' \\<inter> b'. T x y\""], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>a'. T x y\n  \\<exists>y\\<in>b'. T x y\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a' \\<inter> b'. T x y", "using assms(1)"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>a'. T x y\n  \\<exists>y\\<in>b'. T x y\n  bi_unique T\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a' \\<inter> b'. T x y", "by (auto dest: bi_uniqueDr)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a' \\<inter> b'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "}"], ["proof (state)\nthis:\n  ?x2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<inter> b'. T ?x2 y\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "note unique_r = this"], ["proof (state)\nthis:\n  ?x2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<inter> b'. T ?x2 y\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "{"], ["proof (state)\nthis:\n  ?x2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<inter> b'. T ?x2 y\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "assume \"x \\<in> a' \\<inter> b'\""], ["proof (state)\nthis:\n  x \\<in> a' \\<inter> b'\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "then"], ["proof (chain)\npicking this:\n  x \\<in> a' \\<inter> b'", "have \"x \\<in> a'\" and \"x \\<in> b'\""], ["proof (prove)\nusing this:\n  x \\<in> a' \\<inter> b'\n\ngoal (1 subgoal):\n 1. x \\<in> a' &&& x \\<in> b'", "by simp+"], ["proof (state)\nthis:\n  x \\<in> a'\n  x \\<in> b'\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "from assms(2) \\<open>x \\<in> a'\\<close>"], ["proof (chain)\npicking this:\n  rel_set T a a'\n  x \\<in> a'", "have \"\\<exists>y \\<in> a. T y x\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n  x \\<in> a'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a. T y x", "by (rule rel_setD2)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a. T y x\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "moreover"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a. T y x\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "from assms(3) \\<open>x \\<in> b'\\<close>"], ["proof (chain)\npicking this:\n  rel_set T b b'\n  x \\<in> b'", "have \"\\<exists>y \\<in> b. T y x\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n  x \\<in> b'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>b. T y x", "by (rule rel_setD2)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>b. T y x\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "ultimately"], ["proof (chain)\npicking this:\n  \\<exists>y\\<in>a. T y x\n  \\<exists>y\\<in>b. T y x", "have \"\\<exists>y \\<in> a \\<inter> b. T y x\""], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>a. T y x\n  \\<exists>y\\<in>b. T y x\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a \\<inter> b. T y x", "using assms(1)"], ["proof (prove)\nusing this:\n  \\<exists>y\\<in>a. T y x\n  \\<exists>y\\<in>b. T y x\n  bi_unique T\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a \\<inter> b. T y x", "by (auto dest: bi_uniqueDl)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a \\<inter> b. T y x\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "}"], ["proof (state)\nthis:\n  ?x2 \\<in> a' \\<inter> b' \\<Longrightarrow>\n  \\<exists>y\\<in>a \\<inter> b. T y ?x2\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "with unique_r"], ["proof (chain)\npicking this:\n  ?x2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<inter> b'. T ?x2 y\n  ?x2 \\<in> a' \\<inter> b' \\<Longrightarrow>\n  \\<exists>y\\<in>a \\<inter> b. T y ?x2", "have \"rel_set T (a \\<inter> b) (a' \\<inter> b')\""], ["proof (prove)\nusing this:\n  ?x2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<inter> b'. T ?x2 y\n  ?x2 \\<in> a' \\<inter> b' \\<Longrightarrow>\n  \\<exists>y\\<in>a \\<inter> b. T y ?x2\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "using rel_setI"], ["proof (prove)\nusing this:\n  ?x2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<inter> b'. T ?x2 y\n  ?x2 \\<in> a' \\<inter> b' \\<Longrightarrow>\n  \\<exists>y\\<in>a \\<inter> b. T y ?x2\n  \\<lbrakk>\\<And>x. x \\<in> ?A \\<Longrightarrow> \\<exists>y\\<in>?B. ?R x y;\n   \\<And>y. y \\<in> ?B \\<Longrightarrow> \\<exists>x\\<in>?A. ?R x y\\<rbrakk>\n  \\<Longrightarrow> rel_set ?R ?A ?B\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "by blast"], ["proof (state)\nthis:\n  rel_set T (a \\<inter> b) (a' \\<inter> b')\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "with assms(1,4)"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T (a \\<inter> b) xr\n  rel_set T (a \\<inter> b) (a' \\<inter> b')", "show ?thesis"], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T (a \\<inter> b) xr\n  rel_set T (a \\<inter> b) (a' \\<inter> b')\n\ngoal (1 subgoal):\n 1. a' \\<inter> b' = xr", "by (auto dest: bi_uniqueDr bi_unique_rel_set)"], ["proof (state)\nthis:\n  a' \\<inter> b' = xr\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bi_unique_intersect_l:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T xl (a' \\<inter> b')\" \n  shows \"a \\<inter> b = xl\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "let ?T' = \"\\<lambda> y x. T x y\""], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "from assms(1)"], ["proof (chain)\npicking this:\n  bi_unique T", "have \"bi_unique ?T'\""], ["proof (prove)\nusing this:\n  bi_unique T\n\ngoal (1 subgoal):\n 1. bi_unique (\\<lambda>y x. T x y)", "unfolding bi_unique_def"], ["proof (prove)\nusing this:\n  (\\<forall>x y z.\n      T x y \\<longrightarrow> T x z \\<longrightarrow> y = z) \\<and>\n  (\\<forall>x y z. T x z \\<longrightarrow> T y z \\<longrightarrow> x = y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x y z.\n        T y x \\<longrightarrow> T z x \\<longrightarrow> y = z) \\<and>\n    (\\<forall>x y z. T z x \\<longrightarrow> T z y \\<longrightarrow> x = y)", "by simp"], ["proof (state)\nthis:\n  bi_unique (\\<lambda>y x. T x y)\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "moreover"], ["proof (state)\nthis:\n  bi_unique (\\<lambda>y x. T x y)\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "from assms(2)"], ["proof (chain)\npicking this:\n  rel_set T a a'", "have \"rel_set ?T' a' a\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n\ngoal (1 subgoal):\n 1. rel_set (\\<lambda>y x. T x y) a' a", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>a. Bex a' (T x)) \\<and>\n  (\\<forall>y\\<in>a'. \\<exists>x\\<in>a. T x y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>a'. \\<exists>xa\\<in>a. T xa x) \\<and>\n    (\\<forall>y\\<in>a. Bex a' (T y))", "by simp"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) a' a\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "moreover"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) a' a\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "from assms(3)"], ["proof (chain)\npicking this:\n  rel_set T b b'", "have \"rel_set ?T' b' b\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n\ngoal (1 subgoal):\n 1. rel_set (\\<lambda>y x. T x y) b' b", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>b. Bex b' (T x)) \\<and>\n  (\\<forall>y\\<in>b'. \\<exists>x\\<in>b. T x y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>b'. \\<exists>xa\\<in>b. T xa x) \\<and>\n    (\\<forall>y\\<in>b. Bex b' (T y))", "by simp"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) b' b\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "moreover"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) b' b\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "from assms(4)"], ["proof (chain)\npicking this:\n  rel_set T xl (a' \\<inter> b')", "have \"rel_set ?T' (a' \\<inter> b') xl\""], ["proof (prove)\nusing this:\n  rel_set T xl (a' \\<inter> b')\n\ngoal (1 subgoal):\n 1. rel_set (\\<lambda>y x. T x y) (a' \\<inter> b') xl", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>xl. Bex (a' \\<inter> b') (T x)) \\<and>\n  (\\<forall>y\\<in>a' \\<inter> b'. \\<exists>x\\<in>xl. T x y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>a' \\<inter> b'. \\<exists>xa\\<in>xl. T xa x) \\<and>\n    (\\<forall>y\\<in>xl. Bex (a' \\<inter> b') (T y))", "by simp"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) (a' \\<inter> b') xl\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "ultimately"], ["proof (chain)\npicking this:\n  bi_unique (\\<lambda>y x. T x y)\n  rel_set (\\<lambda>y x. T x y) a' a\n  rel_set (\\<lambda>y x. T x y) b' b\n  rel_set (\\<lambda>y x. T x y) (a' \\<inter> b') xl", "show ?thesis"], ["proof (prove)\nusing this:\n  bi_unique (\\<lambda>y x. T x y)\n  rel_set (\\<lambda>y x. T x y) a' a\n  rel_set (\\<lambda>y x. T x y) b' b\n  rel_set (\\<lambda>y x. T x y) (a' \\<inter> b') xl\n\ngoal (1 subgoal):\n 1. a \\<inter> b = xl", "by (rule bi_unique_intersect_r)"], ["proof (state)\nthis:\n  a \\<inter> b = xl\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bi_unique_intersect:\n  assumes \"bi_unique T\" and \"rel_set T a a'\" and \"rel_set T b b'\" \n  shows \"rel_set T (a \\<inter> b) (a' \\<inter> b')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "fix xl"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "assume \"xl \\<in> a \\<inter> b\""], ["proof (state)\nthis:\n  xl \\<in> a \\<inter> b\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "then"], ["proof (chain)\npicking this:\n  xl \\<in> a \\<inter> b", "have \"xl \\<in> a\" and \"xl \\<in> b\""], ["proof (prove)\nusing this:\n  xl \\<in> a \\<inter> b\n\ngoal (1 subgoal):\n 1. xl \\<in> a &&& xl \\<in> b", "by simp+"], ["proof (state)\nthis:\n  xl \\<in> a\n  xl \\<in> b\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with assms(3)"], ["proof (chain)\npicking this:\n  rel_set T b b'\n  xl \\<in> a\n  xl \\<in> b", "obtain xr where \"T xl xr\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n  xl \\<in> a\n  xl \\<in> b\n\ngoal (1 subgoal):\n 1. (\\<And>xr. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>b. Bex b' (T x)) \\<and>\n  (\\<forall>y\\<in>b'. \\<exists>x\\<in>b. T x y)\n  xl \\<in> a\n  xl \\<in> b\n\ngoal (1 subgoal):\n 1. (\\<And>xr. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with assms(1,2) \\<open>xl \\<in> a\\<close>"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T a a'\n  xl \\<in> a\n  T xl xr", "have \"xr \\<in> a'\""], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T a a'\n  xl \\<in> a\n  T xl xr\n\ngoal (1 subgoal):\n 1. xr \\<in> a'", "by (auto dest: bi_uniqueDr rel_setD1)"], ["proof (state)\nthis:\n  xr \\<in> a'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "moreover"], ["proof (state)\nthis:\n  xr \\<in> a'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with assms(1,3) \\<open>xl \\<in> b\\<close> \\<open>T xl xr\\<close>"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T b b'\n  xl \\<in> b\n  T xl xr\n  xr \\<in> a'", "have \"xr \\<in> b'\""], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T b b'\n  xl \\<in> b\n  T xl xr\n  xr \\<in> a'\n\ngoal (1 subgoal):\n 1. xr \\<in> b'", "by (auto dest: bi_uniqueDr rel_setD1)"], ["proof (state)\nthis:\n  xr \\<in> b'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "ultimately"], ["proof (chain)\npicking this:\n  xr \\<in> a'\n  xr \\<in> b'", "have \"xr \\<in> a' \\<inter> b'\""], ["proof (prove)\nusing this:\n  xr \\<in> a'\n  xr \\<in> b'\n\ngoal (1 subgoal):\n 1. xr \\<in> a' \\<inter> b'", "by simp"], ["proof (state)\nthis:\n  xr \\<in> a' \\<inter> b'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with \\<open>T xl xr\\<close>"], ["proof (chain)\npicking this:\n  T xl xr\n  xr \\<in> a' \\<inter> b'", "have \"\\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  T xl xr\n  xr \\<in> a' \\<inter> b'\n\ngoal (1 subgoal):\n 1. \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr", "by auto"], ["proof (state)\nthis:\n  \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "}"], ["proof (state)\nthis:\n  ?xl2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T ?xl2 xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "then"], ["proof (chain)\npicking this:\n  ?xl2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T ?xl2 xr", "have prem_lhs: \"\\<forall>xl \\<in> a \\<inter> b. \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  ?xl2 \\<in> a \\<inter> b \\<Longrightarrow>\n  \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T ?xl2 xr\n\ngoal (1 subgoal):\n 1. \\<forall>xl\\<in>a \\<inter> b.\n       \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr", "by simp"], ["proof (state)\nthis:\n  \\<forall>xl\\<in>a \\<inter> b.\n     \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "{"], ["proof (state)\nthis:\n  \\<forall>xl\\<in>a \\<inter> b.\n     \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "fix xr"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "assume \"xr \\<in> a' \\<inter> b'\""], ["proof (state)\nthis:\n  xr \\<in> a' \\<inter> b'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "then"], ["proof (chain)\npicking this:\n  xr \\<in> a' \\<inter> b'", "have \"xr \\<in> a'\" and \"xr \\<in> b'\""], ["proof (prove)\nusing this:\n  xr \\<in> a' \\<inter> b'\n\ngoal (1 subgoal):\n 1. xr \\<in> a' &&& xr \\<in> b'", "by simp+"], ["proof (state)\nthis:\n  xr \\<in> a'\n  xr \\<in> b'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with assms(3)"], ["proof (chain)\npicking this:\n  rel_set T b b'\n  xr \\<in> a'\n  xr \\<in> b'", "obtain xl where \"T xl xr\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n  xr \\<in> a'\n  xr \\<in> b'\n\ngoal (1 subgoal):\n 1. (\\<And>xl. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>b. Bex b' (T x)) \\<and>\n  (\\<forall>y\\<in>b'. \\<exists>x\\<in>b. T x y)\n  xr \\<in> a'\n  xr \\<in> b'\n\ngoal (1 subgoal):\n 1. (\\<And>xl. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with assms(1,2) \\<open>xr \\<in> a'\\<close>"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T a a'\n  xr \\<in> a'\n  T xl xr", "have \"xl \\<in> a\""], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T a a'\n  xr \\<in> a'\n  T xl xr\n\ngoal (1 subgoal):\n 1. xl \\<in> a", "by (auto dest: bi_uniqueDl rel_setD2)"], ["proof (state)\nthis:\n  xl \\<in> a\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "moreover"], ["proof (state)\nthis:\n  xl \\<in> a\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with assms(1,3) \\<open>xr \\<in> b'\\<close> \\<open>T xl xr\\<close>"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T b b'\n  xr \\<in> b'\n  T xl xr\n  xl \\<in> a", "have \"xl \\<in> b\""], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T b b'\n  xr \\<in> b'\n  T xl xr\n  xl \\<in> a\n\ngoal (1 subgoal):\n 1. xl \\<in> b", "by (auto dest: bi_uniqueDl rel_setD2)"], ["proof (state)\nthis:\n  xl \\<in> b\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "ultimately"], ["proof (chain)\npicking this:\n  xl \\<in> a\n  xl \\<in> b", "have \"xl \\<in> a \\<inter> b\""], ["proof (prove)\nusing this:\n  xl \\<in> a\n  xl \\<in> b\n\ngoal (1 subgoal):\n 1. xl \\<in> a \\<inter> b", "by simp"], ["proof (state)\nthis:\n  xl \\<in> a \\<inter> b\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "with \\<open>T xl xr\\<close>"], ["proof (chain)\npicking this:\n  T xl xr\n  xl \\<in> a \\<inter> b", "have \"\\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  T xl xr\n  xl \\<in> a \\<inter> b\n\ngoal (1 subgoal):\n 1. \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr", "by auto"], ["proof (state)\nthis:\n  \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "}"], ["proof (state)\nthis:\n  ?xr2 \\<in> a' \\<inter> b' \\<Longrightarrow>\n  \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl ?xr2\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "then"], ["proof (chain)\npicking this:\n  ?xr2 \\<in> a' \\<inter> b' \\<Longrightarrow>\n  \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl ?xr2", "have prem_rhs: \"\\<forall>xr \\<in> a' \\<inter> b'. \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  ?xr2 \\<in> a' \\<inter> b' \\<Longrightarrow>\n  \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl ?xr2\n\ngoal (1 subgoal):\n 1. \\<forall>xr\\<in>a' \\<inter> b'.\n       \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr", "by simp"], ["proof (state)\nthis:\n  \\<forall>xr\\<in>a' \\<inter> b'.\n     \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "from prem_lhs prem_rhs"], ["proof (chain)\npicking this:\n  \\<forall>xl\\<in>a \\<inter> b.\n     \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\n  \\<forall>xr\\<in>a' \\<inter> b'.\n     \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>xl\\<in>a \\<inter> b.\n     \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\n  \\<forall>xr\\<in>a' \\<inter> b'.\n     \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<inter> b) (a' \\<inter> b')", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  \\<forall>xl\\<in>a \\<inter> b.\n     \\<exists>xr. xr \\<in> a' \\<inter> b' \\<and> T xl xr\n  \\<forall>xr\\<in>a' \\<inter> b'.\n     \\<exists>xl. xl \\<in> a \\<inter> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>a \\<inter> b. Bex (a' \\<inter> b') (T x)) \\<and>\n    (\\<forall>y\\<in>a' \\<inter> b'. \\<exists>x\\<in>a \\<inter> b. T x y)", "by auto"], ["proof (state)\nthis:\n  rel_set T (a \\<inter> b) (a' \\<inter> b')\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bi_unique_union_r:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T (a \\<union> b) xr\" \n  shows \"a' \\<union> b' = xr\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "assume \"x \\<in> a \\<union> b\""], ["proof (state)\nthis:\n  x \\<in> a \\<union> b\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "then"], ["proof (chain)\npicking this:\n  x \\<in> a \\<union> b", "have \"x \\<in> a \\<or> x \\<in> b\""], ["proof (prove)\nusing this:\n  x \\<in> a \\<union> b\n\ngoal (1 subgoal):\n 1. x \\<in> a \\<or> x \\<in> b", "by simp"], ["proof (state)\nthis:\n  x \\<in> a \\<or> x \\<in> b\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "from assms(2)"], ["proof (chain)\npicking this:\n  rel_set T a a'", "have \"\\<exists>y \\<in> a'. T x y\" if \"x \\<in> a\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a'. T x y", "using that"], ["proof (prove)\nusing this:\n  rel_set T a a'\n  x \\<in> a\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a'. T x y", "by (rule rel_setD1)"], ["proof (state)\nthis:\n  x \\<in> a \\<Longrightarrow> \\<exists>y\\<in>a'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "moreover"], ["proof (state)\nthis:\n  x \\<in> a \\<Longrightarrow> \\<exists>y\\<in>a'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "from assms(3)"], ["proof (chain)\npicking this:\n  rel_set T b b'", "have \"\\<exists>y \\<in> b'. T x y\" if \"x \\<in> b\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>b'. T x y", "using that"], ["proof (prove)\nusing this:\n  rel_set T b b'\n  x \\<in> b\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>b'. T x y", "by (rule rel_setD1)"], ["proof (state)\nthis:\n  x \\<in> b \\<Longrightarrow> \\<exists>y\\<in>b'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "ultimately"], ["proof (chain)\npicking this:\n  x \\<in> a \\<Longrightarrow> \\<exists>y\\<in>a'. T x y\n  x \\<in> b \\<Longrightarrow> \\<exists>y\\<in>b'. T x y", "have \"\\<exists>y \\<in> a' \\<union> b'. T x y\""], ["proof (prove)\nusing this:\n  x \\<in> a \\<Longrightarrow> \\<exists>y\\<in>a'. T x y\n  x \\<in> b \\<Longrightarrow> \\<exists>y\\<in>b'. T x y\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a' \\<union> b'. T x y", "using \\<open>x \\<in> a \\<or> x \\<in> b\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> a \\<Longrightarrow> \\<exists>y\\<in>a'. T x y\n  x \\<in> b \\<Longrightarrow> \\<exists>y\\<in>b'. T x y\n  x \\<in> a \\<or> x \\<in> b\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a' \\<union> b'. T x y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a' \\<union> b'. T x y\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "}"], ["proof (state)\nthis:\n  ?x2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<union> b'. T ?x2 y\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "note unique_r = this"], ["proof (state)\nthis:\n  ?x2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<union> b'. T ?x2 y\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "{"], ["proof (state)\nthis:\n  ?x2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<union> b'. T ?x2 y\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "assume \"x \\<in> a' \\<union> b'\""], ["proof (state)\nthis:\n  x \\<in> a' \\<union> b'\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "then"], ["proof (chain)\npicking this:\n  x \\<in> a' \\<union> b'", "have \"x \\<in> a' \\<or> x \\<in> b'\""], ["proof (prove)\nusing this:\n  x \\<in> a' \\<union> b'\n\ngoal (1 subgoal):\n 1. x \\<in> a' \\<or> x \\<in> b'", "by simp"], ["proof (state)\nthis:\n  x \\<in> a' \\<or> x \\<in> b'\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "from assms(2)"], ["proof (chain)\npicking this:\n  rel_set T a a'", "have \"\\<exists>y \\<in> a. T y x\" if \"x \\<in> a'\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a. T y x", "using that"], ["proof (prove)\nusing this:\n  rel_set T a a'\n  x \\<in> a'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a. T y x", "by (rule rel_setD2)"], ["proof (state)\nthis:\n  x \\<in> a' \\<Longrightarrow> \\<exists>y\\<in>a. T y x\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "moreover"], ["proof (state)\nthis:\n  x \\<in> a' \\<Longrightarrow> \\<exists>y\\<in>a. T y x\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "from assms(3)"], ["proof (chain)\npicking this:\n  rel_set T b b'", "have \"\\<exists>y \\<in> b. T y x\" if \"x \\<in> b'\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>b. T y x", "using that"], ["proof (prove)\nusing this:\n  rel_set T b b'\n  x \\<in> b'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>b. T y x", "by (rule rel_setD2)"], ["proof (state)\nthis:\n  x \\<in> b' \\<Longrightarrow> \\<exists>y\\<in>b. T y x\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "ultimately"], ["proof (chain)\npicking this:\n  x \\<in> a' \\<Longrightarrow> \\<exists>y\\<in>a. T y x\n  x \\<in> b' \\<Longrightarrow> \\<exists>y\\<in>b. T y x", "have \"\\<exists>y \\<in> a \\<union> b. T y x\""], ["proof (prove)\nusing this:\n  x \\<in> a' \\<Longrightarrow> \\<exists>y\\<in>a. T y x\n  x \\<in> b' \\<Longrightarrow> \\<exists>y\\<in>b. T y x\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a \\<union> b. T y x", "using \\<open>x \\<in> a' \\<or> x \\<in> b'\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> a' \\<Longrightarrow> \\<exists>y\\<in>a. T y x\n  x \\<in> b' \\<Longrightarrow> \\<exists>y\\<in>b. T y x\n  x \\<in> a' \\<or> x \\<in> b'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>a \\<union> b. T y x", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>a \\<union> b. T y x\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "}"], ["proof (state)\nthis:\n  ?x2 \\<in> a' \\<union> b' \\<Longrightarrow>\n  \\<exists>y\\<in>a \\<union> b. T y ?x2\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "with unique_r"], ["proof (chain)\npicking this:\n  ?x2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<union> b'. T ?x2 y\n  ?x2 \\<in> a' \\<union> b' \\<Longrightarrow>\n  \\<exists>y\\<in>a \\<union> b. T y ?x2", "have \"rel_set T (a \\<union> b) (a' \\<union> b')\""], ["proof (prove)\nusing this:\n  ?x2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>y\\<in>a' \\<union> b'. T ?x2 y\n  ?x2 \\<in> a' \\<union> b' \\<Longrightarrow>\n  \\<exists>y\\<in>a \\<union> b. T y ?x2\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "by (auto intro: rel_setI)"], ["proof (state)\nthis:\n  rel_set T (a \\<union> b) (a' \\<union> b')\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "with assms(1,4)"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T (a \\<union> b) xr\n  rel_set T (a \\<union> b) (a' \\<union> b')", "show ?thesis"], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T (a \\<union> b) xr\n  rel_set T (a \\<union> b) (a' \\<union> b')\n\ngoal (1 subgoal):\n 1. a' \\<union> b' = xr", "by (auto dest: bi_uniqueDr bi_unique_rel_set)"], ["proof (state)\nthis:\n  a' \\<union> b' = xr\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bi_unique_union_l:\n  assumes \"bi_unique T\" \n    and \"rel_set T a a'\" \n    and \"rel_set T b b'\" \n    and \"rel_set T xl (a' \\<union> b')\" \n  shows \"a \\<union> b = xl\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "let ?T' = \"\\<lambda>y x. T x y\""], ["proof (state)\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "from assms(1)"], ["proof (chain)\npicking this:\n  bi_unique T", "have \"bi_unique ?T'\""], ["proof (prove)\nusing this:\n  bi_unique T\n\ngoal (1 subgoal):\n 1. bi_unique (\\<lambda>y x. T x y)", "unfolding bi_unique_def"], ["proof (prove)\nusing this:\n  (\\<forall>x y z.\n      T x y \\<longrightarrow> T x z \\<longrightarrow> y = z) \\<and>\n  (\\<forall>x y z. T x z \\<longrightarrow> T y z \\<longrightarrow> x = y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x y z.\n        T y x \\<longrightarrow> T z x \\<longrightarrow> y = z) \\<and>\n    (\\<forall>x y z. T z x \\<longrightarrow> T z y \\<longrightarrow> x = y)", "by simp"], ["proof (state)\nthis:\n  bi_unique (\\<lambda>y x. T x y)\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "moreover"], ["proof (state)\nthis:\n  bi_unique (\\<lambda>y x. T x y)\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "from assms(2)"], ["proof (chain)\npicking this:\n  rel_set T a a'", "have \"rel_set ?T' a' a\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n\ngoal (1 subgoal):\n 1. rel_set (\\<lambda>y x. T x y) a' a", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>a. Bex a' (T x)) \\<and>\n  (\\<forall>y\\<in>a'. \\<exists>x\\<in>a. T x y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>a'. \\<exists>xa\\<in>a. T xa x) \\<and>\n    (\\<forall>y\\<in>a. Bex a' (T y))", "by simp"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) a' a\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "moreover"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) a' a\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "from assms(3)"], ["proof (chain)\npicking this:\n  rel_set T b b'", "have \"rel_set ?T' b' b\""], ["proof (prove)\nusing this:\n  rel_set T b b'\n\ngoal (1 subgoal):\n 1. rel_set (\\<lambda>y x. T x y) b' b", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>b. Bex b' (T x)) \\<and>\n  (\\<forall>y\\<in>b'. \\<exists>x\\<in>b. T x y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>b'. \\<exists>xa\\<in>b. T xa x) \\<and>\n    (\\<forall>y\\<in>b. Bex b' (T y))", "by simp"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) b' b\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "moreover"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) b' b\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "from assms(4)"], ["proof (chain)\npicking this:\n  rel_set T xl (a' \\<union> b')", "have \"rel_set ?T' (a' \\<union> b') xl\""], ["proof (prove)\nusing this:\n  rel_set T xl (a' \\<union> b')\n\ngoal (1 subgoal):\n 1. rel_set (\\<lambda>y x. T x y) (a' \\<union> b') xl", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>xl. Bex (a' \\<union> b') (T x)) \\<and>\n  (\\<forall>y\\<in>a' \\<union> b'. \\<exists>x\\<in>xl. T x y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>a' \\<union> b'. \\<exists>xa\\<in>xl. T xa x) \\<and>\n    (\\<forall>y\\<in>xl. Bex (a' \\<union> b') (T y))", "by simp"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) (a' \\<union> b') xl\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "ultimately"], ["proof (chain)\npicking this:\n  bi_unique (\\<lambda>y x. T x y)\n  rel_set (\\<lambda>y x. T x y) a' a\n  rel_set (\\<lambda>y x. T x y) b' b\n  rel_set (\\<lambda>y x. T x y) (a' \\<union> b') xl", "show ?thesis"], ["proof (prove)\nusing this:\n  bi_unique (\\<lambda>y x. T x y)\n  rel_set (\\<lambda>y x. T x y) a' a\n  rel_set (\\<lambda>y x. T x y) b' b\n  rel_set (\\<lambda>y x. T x y) (a' \\<union> b') xl\n\ngoal (1 subgoal):\n 1. a \\<union> b = xl", "by (rule bi_unique_union_r)"], ["proof (state)\nthis:\n  a \\<union> b = xl\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bi_unique_union:\n  assumes \"bi_unique T\" and \"rel_set T a a'\" and \"rel_set T b b'\" \n  shows \"rel_set T (a \\<union> b) (a' \\<union> b')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "fix xl"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "assume \"xl \\<in> a \\<union> b\""], ["proof (state)\nthis:\n  xl \\<in> a \\<union> b\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "with assms(2,3)"], ["proof (chain)\npicking this:\n  rel_set T a a'\n  rel_set T b b'\n  xl \\<in> a \\<union> b", "obtain xr where \"T xl xr\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n  rel_set T b b'\n  xl \\<in> a \\<union> b\n\ngoal (1 subgoal):\n 1. (\\<And>xr. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>a. Bex a' (T x)) \\<and>\n  (\\<forall>y\\<in>a'. \\<exists>x\\<in>a. T x y)\n  (\\<forall>x\\<in>b. Bex b' (T x)) \\<and>\n  (\\<forall>y\\<in>b'. \\<exists>x\\<in>b. T x y)\n  xl \\<in> a \\<union> b\n\ngoal (1 subgoal):\n 1. (\\<And>xr. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "with assms \\<open>xl \\<in> a \\<union> b\\<close>"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T a a'\n  rel_set T b b'\n  xl \\<in> a \\<union> b\n  T xl xr", "have \"xr \\<in> a' \\<union> b'\""], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T a a'\n  rel_set T b b'\n  xl \\<in> a \\<union> b\n  T xl xr\n\ngoal (1 subgoal):\n 1. xr \\<in> a' \\<union> b'", "unfolding bi_unique_def"], ["proof (prove)\nusing this:\n  (\\<forall>x y z.\n      T x y \\<longrightarrow> T x z \\<longrightarrow> y = z) \\<and>\n  (\\<forall>x y z. T x z \\<longrightarrow> T y z \\<longrightarrow> x = y)\n  rel_set T a a'\n  rel_set T b b'\n  xl \\<in> a \\<union> b\n  T xl xr\n\ngoal (1 subgoal):\n 1. xr \\<in> a' \\<union> b'", "using Un_iff"], ["proof (prove)\nusing this:\n  (\\<forall>x y z.\n      T x y \\<longrightarrow> T x z \\<longrightarrow> y = z) \\<and>\n  (\\<forall>x y z. T x z \\<longrightarrow> T y z \\<longrightarrow> x = y)\n  rel_set T a a'\n  rel_set T b b'\n  xl \\<in> a \\<union> b\n  T xl xr\n  (?c \\<in> ?A \\<union> ?B) = (?c \\<in> ?A \\<or> ?c \\<in> ?B)\n\ngoal (1 subgoal):\n 1. xr \\<in> a' \\<union> b'", "by (metis Un_iff rel_setD1)"], ["proof (state)\nthis:\n  xr \\<in> a' \\<union> b'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "with \\<open>T xl xr\\<close>"], ["proof (chain)\npicking this:\n  T xl xr\n  xr \\<in> a' \\<union> b'", "have \"\\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  T xl xr\n  xr \\<in> a' \\<union> b'\n\ngoal (1 subgoal):\n 1. \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr", "by auto"], ["proof (state)\nthis:\n  \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "}"], ["proof (state)\nthis:\n  ?xl2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T ?xl2 xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "then"], ["proof (chain)\npicking this:\n  ?xl2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T ?xl2 xr", "have prem_lhs: \"\\<forall>xl \\<in> a \\<union> b. \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  ?xl2 \\<in> a \\<union> b \\<Longrightarrow>\n  \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T ?xl2 xr\n\ngoal (1 subgoal):\n 1. \\<forall>xl\\<in>a \\<union> b.\n       \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr", "by simp"], ["proof (state)\nthis:\n  \\<forall>xl\\<in>a \\<union> b.\n     \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "{"], ["proof (state)\nthis:\n  \\<forall>xl\\<in>a \\<union> b.\n     \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "fix xr"], ["proof (state)\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "assume \"xr \\<in> a' \\<union> b'\""], ["proof (state)\nthis:\n  xr \\<in> a' \\<union> b'\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "with assms(2,3)"], ["proof (chain)\npicking this:\n  rel_set T a a'\n  rel_set T b b'\n  xr \\<in> a' \\<union> b'", "obtain xl where \"T xl xr\""], ["proof (prove)\nusing this:\n  rel_set T a a'\n  rel_set T b b'\n  xr \\<in> a' \\<union> b'\n\ngoal (1 subgoal):\n 1. (\\<And>xl. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>a. Bex a' (T x)) \\<and>\n  (\\<forall>y\\<in>a'. \\<exists>x\\<in>a. T x y)\n  (\\<forall>x\\<in>b. Bex b' (T x)) \\<and>\n  (\\<forall>y\\<in>b'. \\<exists>x\\<in>b. T x y)\n  xr \\<in> a' \\<union> b'\n\ngoal (1 subgoal):\n 1. (\\<And>xl. T xl xr \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by auto"], ["proof (state)\nthis:\n  T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "with assms \\<open>xr \\<in> a' \\<union> b'\\<close>"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T a a'\n  rel_set T b b'\n  xr \\<in> a' \\<union> b'\n  T xl xr", "have \"xl \\<in> a \\<union> b\""], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T a a'\n  rel_set T b b'\n  xr \\<in> a' \\<union> b'\n  T xl xr\n\ngoal (1 subgoal):\n 1. xl \\<in> a \\<union> b", "unfolding bi_unique_def"], ["proof (prove)\nusing this:\n  (\\<forall>x y z.\n      T x y \\<longrightarrow> T x z \\<longrightarrow> y = z) \\<and>\n  (\\<forall>x y z. T x z \\<longrightarrow> T y z \\<longrightarrow> x = y)\n  rel_set T a a'\n  rel_set T b b'\n  xr \\<in> a' \\<union> b'\n  T xl xr\n\ngoal (1 subgoal):\n 1. xl \\<in> a \\<union> b", "by (metis Un_iff rel_setD2)"], ["proof (state)\nthis:\n  xl \\<in> a \\<union> b\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "with \\<open>T xl xr\\<close>"], ["proof (chain)\npicking this:\n  T xl xr\n  xl \\<in> a \\<union> b", "have \"\\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  T xl xr\n  xl \\<in> a \\<union> b\n\ngoal (1 subgoal):\n 1. \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr", "by auto"], ["proof (state)\nthis:\n  \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "}"], ["proof (state)\nthis:\n  ?xr2 \\<in> a' \\<union> b' \\<Longrightarrow>\n  \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl ?xr2\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "then"], ["proof (chain)\npicking this:\n  ?xr2 \\<in> a' \\<union> b' \\<Longrightarrow>\n  \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl ?xr2", "have prem_rhs: \"\\<forall>xr \\<in> a' \\<union> b'. \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr\""], ["proof (prove)\nusing this:\n  ?xr2 \\<in> a' \\<union> b' \\<Longrightarrow>\n  \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl ?xr2\n\ngoal (1 subgoal):\n 1. \\<forall>xr\\<in>a' \\<union> b'.\n       \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr", "by simp"], ["proof (state)\nthis:\n  \\<forall>xr\\<in>a' \\<union> b'.\n     \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "from prem_lhs prem_rhs"], ["proof (chain)\npicking this:\n  \\<forall>xl\\<in>a \\<union> b.\n     \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\n  \\<forall>xr\\<in>a' \\<union> b'.\n     \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>xl\\<in>a \\<union> b.\n     \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\n  \\<forall>xr\\<in>a' \\<union> b'.\n     \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. rel_set T (a \\<union> b) (a' \\<union> b')", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  \\<forall>xl\\<in>a \\<union> b.\n     \\<exists>xr. xr \\<in> a' \\<union> b' \\<and> T xl xr\n  \\<forall>xr\\<in>a' \\<union> b'.\n     \\<exists>xl. xl \\<in> a \\<union> b \\<and> T xl xr\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>a \\<union> b. Bex (a' \\<union> b') (T x)) \\<and>\n    (\\<forall>y\\<in>a' \\<union> b'. \\<exists>x\\<in>a \\<union> b. T x y)", "by auto"], ["proof (state)\nthis:\n  rel_set T (a \\<union> b) (a' \\<union> b')\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bi_unique_Union_r:\n  fixes T :: \"['a, 'b] \\<Rightarrow> bool\" and K\n  defines K':  \"K' \\<equiv> {(x, y). rel_set T x y} `` K\"\n  assumes \"bi_unique T\" \n    and \"\\<Union>K \\<subseteq> Collect (Domainp T)\" \n    and \"rel_set T (\\<Union>K) xr\" \n  shows \"\\<Union>K' = xr\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "assume \"x \\<in> \\<Union>K\""], ["proof (state)\nthis:\n  x \\<in> \\<Union> K\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "then"], ["proof (chain)\npicking this:\n  x \\<in> \\<Union> K", "obtain k where \"x \\<in> k\" and \"k \\<in> K\""], ["proof (prove)\nusing this:\n  x \\<in> \\<Union> K\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>x \\<in> k; k \\<in> K\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by clarsimp"], ["proof (state)\nthis:\n  x \\<in> k\n  k \\<in> K\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "from assms"], ["proof (chain)\npicking this:\n  K' \\<equiv> {(x, y). rel_set T x y} `` K\n  bi_unique T\n  \\<Union> K \\<subseteq> Collect (Domainp T)\n  rel_set T (\\<Union> K) xr", "have ex_k'_prem: \"\\<forall>k \\<in> K. \\<forall>x \\<in> k. \\<exists>x'. T x x'\""], ["proof (prove)\nusing this:\n  K' \\<equiv> {(x, y). rel_set T x y} `` K\n  bi_unique T\n  \\<Union> K \\<subseteq> Collect (Domainp T)\n  rel_set T (\\<Union> K) xr\n\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>K. \\<forall>x\\<in>k. \\<exists>x'. T x x'", "by auto"], ["proof (state)\nthis:\n  \\<forall>k\\<in>K. \\<forall>x\\<in>k. \\<exists>x'. T x x'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "define k' where k': \"k' = {x'. \\<exists>x \\<in> k. T x x'}\""], ["proof (state)\nthis:\n  k' = {x'. \\<exists>x\\<in>k. T x x'}\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "have \"rel_set T k k'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rel_set T k k'", "unfolding rel_set_def Bex_def k'"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>k.\n        \\<exists>xa.\n           xa \\<in> {x'. \\<exists>x. x \\<in> k \\<and> T x x'} \\<and>\n           T x xa) \\<and>\n    (\\<forall>y\\<in>{x'. \\<exists>x. x \\<in> k \\<and> T x x'}.\n        \\<exists>x. x \\<in> k \\<and> T x y)", "using \\<open>k \\<in> K\\<close>"], ["proof (prove)\nusing this:\n  k \\<in> K\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>k.\n        \\<exists>xa.\n           xa \\<in> {x'. \\<exists>x. x \\<in> k \\<and> T x x'} \\<and>\n           T x xa) \\<and>\n    (\\<forall>y\\<in>{x'. \\<exists>x. x \\<in> k \\<and> T x x'}.\n        \\<exists>x. x \\<in> k \\<and> T x y)", "by (blast dest: ex_k'_prem[rule_format])"], ["proof (state)\nthis:\n  rel_set T k k'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "with \\<open>k \\<in> K\\<close>"], ["proof (chain)\npicking this:\n  k \\<in> K\n  rel_set T k k'", "have \"k' \\<in> K'\""], ["proof (prove)\nusing this:\n  k \\<in> K\n  rel_set T k k'\n\ngoal (1 subgoal):\n 1. k' \\<in> K'", "unfolding K'"], ["proof (prove)\nusing this:\n  k \\<in> K\n  rel_set T k k'\n\ngoal (1 subgoal):\n 1. k' \\<in> {(x, y). rel_set T x y} `` K", "by auto"], ["proof (state)\nthis:\n  k' \\<in> K'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "from \\<open>rel_set T k k'\\<close> \\<open>x \\<in> k\\<close>"], ["proof (chain)\npicking this:\n  rel_set T k k'\n  x \\<in> k", "obtain y where \"y \\<in> k' \\<and> T x y\""], ["proof (prove)\nusing this:\n  rel_set T k k'\n  x \\<in> k\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        y \\<in> k' \\<and> T x y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto dest: rel_setD1)"], ["proof (state)\nthis:\n  y \\<in> k' \\<and> T x y\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "then"], ["proof (chain)\npicking this:\n  y \\<in> k' \\<and> T x y", "have \"\\<exists>y \\<in> \\<Union>K'. T x y\""], ["proof (prove)\nusing this:\n  y \\<in> k' \\<and> T x y\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>\\<Union> K'. T x y", "using \\<open>k' \\<in> K'\\<close>"], ["proof (prove)\nusing this:\n  y \\<in> k' \\<and> T x y\n  k' \\<in> K'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>\\<Union> K'. T x y", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>\\<Union> K'. T x y\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "}"], ["proof (state)\nthis:\n  ?x2 \\<in> \\<Union> K \\<Longrightarrow> \\<exists>y\\<in>\\<Union> K'. T ?x2 y\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "note unique_r = this"], ["proof (state)\nthis:\n  ?x2 \\<in> \\<Union> K \\<Longrightarrow> \\<exists>y\\<in>\\<Union> K'. T ?x2 y\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "{"], ["proof (state)\nthis:\n  ?x2 \\<in> \\<Union> K \\<Longrightarrow> \\<exists>y\\<in>\\<Union> K'. T ?x2 y\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "fix x'"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "assume \"x' \\<in> \\<Union>K'\""], ["proof (state)\nthis:\n  x' \\<in> \\<Union> K'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "then"], ["proof (chain)\npicking this:\n  x' \\<in> \\<Union> K'", "obtain k' where \"x' \\<in> k'\" and \"k' \\<in> K'\""], ["proof (prove)\nusing this:\n  x' \\<in> \\<Union> K'\n\ngoal (1 subgoal):\n 1. (\\<And>k'.\n        \\<lbrakk>x' \\<in> k'; k' \\<in> K'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by clarsimp"], ["proof (state)\nthis:\n  x' \\<in> k'\n  k' \\<in> K'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "then"], ["proof (chain)\npicking this:\n  x' \\<in> k'\n  k' \\<in> K'", "have ex_k_prem: \"\\<forall>k' \\<in> K'. \\<forall>x \\<in> k'. \\<exists>x. T x x'\""], ["proof (prove)\nusing this:\n  x' \\<in> k'\n  k' \\<in> K'\n\ngoal (1 subgoal):\n 1. \\<forall>k'\\<in>K'. \\<forall>x\\<in>k'. \\<exists>x. T x x'", "unfolding K'"], ["proof (prove)\nusing this:\n  x' \\<in> k'\n  k' \\<in> {(x, y). rel_set T x y} `` K\n\ngoal (1 subgoal):\n 1. \\<forall>k'\\<in>{(x, y). rel_set T x y} `` K.\n       \\<forall>x\\<in>k'. \\<exists>x. T x x'", "by (auto dest: rel_setD2)"], ["proof (state)\nthis:\n  \\<forall>k'\\<in>K'. \\<forall>x\\<in>k'. \\<exists>x. T x x'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "define k where k: \"k = {x. \\<exists>x' \\<in> k'. T x x'}\""], ["proof (state)\nthis:\n  k = {x. \\<exists>x'\\<in>k'. T x x'}\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "have \"rel_set T k k'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. rel_set T k k'", "unfolding rel_set_def Bex_def k"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>{x. \\<exists>xa. xa \\<in> k' \\<and> T x xa}.\n        \\<exists>xa. xa \\<in> k' \\<and> T x xa) \\<and>\n    (\\<forall>y\\<in>k'.\n        \\<exists>x.\n           x \\<in> {x. \\<exists>xa. xa \\<in> k' \\<and> T x xa} \\<and> T x y)", "using \\<open>k' \\<in> K'\\<close> K'"], ["proof (prove)\nusing this:\n  k' \\<in> K'\n  K' \\<equiv> {(x, y). rel_set T x y} `` K\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>{x. \\<exists>xa. xa \\<in> k' \\<and> T x xa}.\n        \\<exists>xa. xa \\<in> k' \\<and> T x xa) \\<and>\n    (\\<forall>y\\<in>k'.\n        \\<exists>x.\n           x \\<in> {x. \\<exists>xa. xa \\<in> k' \\<and> T x xa} \\<and> T x y)", "by (blast dest: rel_setD2)"], ["proof (state)\nthis:\n  rel_set T k k'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "from assms(2)"], ["proof (chain)\npicking this:\n  bi_unique T", "have \"bi_unique (rel_set T)\""], ["proof (prove)\nusing this:\n  bi_unique T\n\ngoal (1 subgoal):\n 1. bi_unique (rel_set T)", "by (rule bi_unique_rel_set)"], ["proof (state)\nthis:\n  bi_unique (rel_set T)\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "with \\<open>rel_set T k k'\\<close>"], ["proof (chain)\npicking this:\n  rel_set T k k'\n  bi_unique (rel_set T)", "have \"\\<exists>!k. rel_set T k k'\""], ["proof (prove)\nusing this:\n  rel_set T k k'\n  bi_unique (rel_set T)\n\ngoal (1 subgoal):\n 1. \\<exists>!k. rel_set T k k'", "by (auto dest: bi_uniqueDl)"], ["proof (state)\nthis:\n  \\<exists>!k. rel_set T k k'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "with \\<open>rel_set T k k'\\<close> K' \\<open>k' \\<in> K'\\<close>"], ["proof (chain)\npicking this:\n  rel_set T k k'\n  K' \\<equiv> {(x, y). rel_set T x y} `` K\n  k' \\<in> K'\n  \\<exists>!k. rel_set T k k'", "have \"k \\<in> K\""], ["proof (prove)\nusing this:\n  rel_set T k k'\n  K' \\<equiv> {(x, y). rel_set T x y} `` K\n  k' \\<in> K'\n  \\<exists>!k. rel_set T k k'\n\ngoal (1 subgoal):\n 1. k \\<in> K", "by auto"], ["proof (state)\nthis:\n  k \\<in> K\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "from \\<open>rel_set T k k'\\<close> \\<open>x' \\<in> k'\\<close>"], ["proof (chain)\npicking this:\n  rel_set T k k'\n  x' \\<in> k'", "obtain y where \"y \\<in> k \\<and> T y x'\""], ["proof (prove)\nusing this:\n  rel_set T k k'\n  x' \\<in> k'\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        y \\<in> k \\<and> T y x' \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto dest: rel_setD2)"], ["proof (state)\nthis:\n  y \\<in> k \\<and> T y x'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "then"], ["proof (chain)\npicking this:\n  y \\<in> k \\<and> T y x'", "have \"\\<exists>y \\<in> \\<Union>K. T y x'\""], ["proof (prove)\nusing this:\n  y \\<in> k \\<and> T y x'\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>\\<Union> K. T y x'", "using \\<open>k \\<in> K\\<close>"], ["proof (prove)\nusing this:\n  y \\<in> k \\<and> T y x'\n  k \\<in> K\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>\\<Union> K. T y x'", "by auto"], ["proof (state)\nthis:\n  \\<exists>y\\<in>\\<Union> K. T y x'\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "}"], ["proof (state)\nthis:\n  ?x'2 \\<in> \\<Union> K' \\<Longrightarrow>\n  \\<exists>y\\<in>\\<Union> K. T y ?x'2\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "with unique_r"], ["proof (chain)\npicking this:\n  ?x2 \\<in> \\<Union> K \\<Longrightarrow> \\<exists>y\\<in>\\<Union> K'. T ?x2 y\n  ?x'2 \\<in> \\<Union> K' \\<Longrightarrow>\n  \\<exists>y\\<in>\\<Union> K. T y ?x'2", "have \"rel_set T (\\<Union>K) (\\<Union>K')\""], ["proof (prove)\nusing this:\n  ?x2 \\<in> \\<Union> K \\<Longrightarrow> \\<exists>y\\<in>\\<Union> K'. T ?x2 y\n  ?x'2 \\<in> \\<Union> K' \\<Longrightarrow>\n  \\<exists>y\\<in>\\<Union> K. T y ?x'2\n\ngoal (1 subgoal):\n 1. rel_set T (\\<Union> K) (\\<Union> K')", "by (intro rel_setI)"], ["proof (state)\nthis:\n  rel_set T (\\<Union> K) (\\<Union> K')\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "with assms(2,4)"], ["proof (chain)\npicking this:\n  bi_unique T\n  rel_set T (\\<Union> K) xr\n  rel_set T (\\<Union> K) (\\<Union> K')", "show ?thesis"], ["proof (prove)\nusing this:\n  bi_unique T\n  rel_set T (\\<Union> K) xr\n  rel_set T (\\<Union> K) (\\<Union> K')\n\ngoal (1 subgoal):\n 1. \\<Union> K' = xr", "by (auto dest: bi_uniqueDr bi_unique_rel_set)"], ["proof (state)\nthis:\n  \\<Union> K' = xr\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma bi_unique_Union_l:\n  fixes T :: \"['a, 'b] \\<Rightarrow> bool\" and K'\n  defines K: \"K \\<equiv> {(x, y). rel_set (\\<lambda> y x. T x y) x y} `` K'\"\n  assumes \"bi_unique T\" \n    and \"\\<Union>K' \\<subseteq> Collect (Rangep T)\" \n    and \"rel_set T xl (\\<Union>K')\" \n  shows \"\\<Union>K = xl\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "let ?T' = \"\\<lambda> y x. T x y\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "from assms(2)"], ["proof (chain)\npicking this:\n  bi_unique T", "have \"bi_unique ?T'\""], ["proof (prove)\nusing this:\n  bi_unique T\n\ngoal (1 subgoal):\n 1. bi_unique (\\<lambda>y x. T x y)", "unfolding bi_unique_def"], ["proof (prove)\nusing this:\n  (\\<forall>x y z.\n      T x y \\<longrightarrow> T x z \\<longrightarrow> y = z) \\<and>\n  (\\<forall>x y z. T x z \\<longrightarrow> T y z \\<longrightarrow> x = y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x y z.\n        T y x \\<longrightarrow> T z x \\<longrightarrow> y = z) \\<and>\n    (\\<forall>x y z. T z x \\<longrightarrow> T z y \\<longrightarrow> x = y)", "by simp"], ["proof (state)\nthis:\n  bi_unique (\\<lambda>y x. T x y)\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "moreover"], ["proof (state)\nthis:\n  bi_unique (\\<lambda>y x. T x y)\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "from assms(3)"], ["proof (chain)\npicking this:\n  \\<Union> K' \\<subseteq> Collect (Rangep T)", "have \"\\<Union>K' \\<subseteq> Collect (Domainp ?T')\""], ["proof (prove)\nusing this:\n  \\<Union> K' \\<subseteq> Collect (Rangep T)\n\ngoal (1 subgoal):\n 1. \\<Union> K' \\<subseteq> Collect (Domainp (\\<lambda>y x. T x y))", "by blast"], ["proof (state)\nthis:\n  \\<Union> K' \\<subseteq> Collect (Domainp (\\<lambda>y x. T x y))\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "moreover"], ["proof (state)\nthis:\n  \\<Union> K' \\<subseteq> Collect (Domainp (\\<lambda>y x. T x y))\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "from assms(4)"], ["proof (chain)\npicking this:\n  rel_set T xl (\\<Union> K')", "have \"rel_set ?T' (\\<Union>K') xl\""], ["proof (prove)\nusing this:\n  rel_set T xl (\\<Union> K')\n\ngoal (1 subgoal):\n 1. rel_set (\\<lambda>y x. T x y) (\\<Union> K') xl", "unfolding rel_set_def"], ["proof (prove)\nusing this:\n  (\\<forall>x\\<in>xl. Bex (\\<Union> K') (T x)) \\<and>\n  (\\<forall>y\\<in>\\<Union> K'. \\<exists>x\\<in>xl. T x y)\n\ngoal (1 subgoal):\n 1. (\\<forall>x\\<in>\\<Union> K'. \\<exists>xa\\<in>xl. T xa x) \\<and>\n    (\\<forall>y\\<in>xl. Bex (\\<Union> K') (T y))", "by simp"], ["proof (state)\nthis:\n  rel_set (\\<lambda>y x. T x y) (\\<Union> K') xl\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "ultimately"], ["proof (chain)\npicking this:\n  bi_unique (\\<lambda>y x. T x y)\n  \\<Union> K' \\<subseteq> Collect (Domainp (\\<lambda>y x. T x y))\n  rel_set (\\<lambda>y x. T x y) (\\<Union> K') xl", "have \"\\<Union>({(x, y). rel_set ?T' x y} `` K') = xl\""], ["proof (prove)\nusing this:\n  bi_unique (\\<lambda>y x. T x y)\n  \\<Union> K' \\<subseteq> Collect (Domainp (\\<lambda>y x. T x y))\n  rel_set (\\<lambda>y x. T x y) (\\<Union> K') xl\n\ngoal (1 subgoal):\n 1. \\<Union> ({(x, y). rel_set (\\<lambda>y x. T x y) x y} `` K') = xl", "by (rule bi_unique_Union_r)"], ["proof (state)\nthis:\n  \\<Union> ({(x, y). rel_set (\\<lambda>y x. T x y) x y} `` K') = xl\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<Union> ({(x, y). rel_set (\\<lambda>y x. T x y) x y} `` K') = xl\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "using K"], ["proof (prove)\nusing this:\n  \\<Union> ({(x, y). rel_set (\\<lambda>y x. T x y) x y} `` K') = xl\n  K \\<equiv> {(x, y). rel_set (\\<lambda>y x. T x y) x y} `` K'\n\ngoal (1 subgoal):\n 1. \\<Union> K = xl", "by simp"], ["proof (state)\nthis:\n  \\<Union> K = xl\n\ngoal:\nNo subgoals!", "qed"], ["", "context\n  includes lifting_syntax\nbegin"], ["", "text\\<open>\nThe lemma \\<^text>\\<open>Domainp_applyI\\<close> was adopted from the lemma with the \nidentical name in the theory \\<^text>\\<open>Types_To_Sets/Group_on_With.thy\\<close>.\n\\<close>"], ["", "lemma Domainp_applyI:\n  includes lifting_syntax\n  shows \"(A ===> B) f g \\<Longrightarrow> A x y \\<Longrightarrow> Domainp B (f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>(A ===> B) f g; A x y\\<rbrakk>\n    \\<Longrightarrow> Domainp B (f x)", "by (auto simp: rel_fun_def)"], ["", "lemma Domainp_fun:\n  assumes \"left_unique A\" \n  shows \n    \"Domainp (rel_fun A B) = \n      (\\<lambda>f. f ` (Collect (Domainp A)) \\<subseteq> (Collect (Domainp B)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Domainp (A ===> B) =\n    (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Domainp (A ===> B) =\n    (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))", "have \n    \"pred_fun (Domainp A) (Domainp B) = \n      (\\<lambda>f. f ` (Collect (Domainp A)) \\<subseteq> (Collect (Domainp B)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pred_fun (Domainp A) (Domainp B) =\n    (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))", "by (simp add: image_subset_iff)"], ["proof (state)\nthis:\n  pred_fun (Domainp A) (Domainp B) =\n  (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))\n\ngoal (1 subgoal):\n 1. Domainp (A ===> B) =\n    (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))", "from Domainp_pred_fun_eq[OF \\<open>left_unique A\\<close>, of B, unfolded this]"], ["proof (chain)\npicking this:\n  Domainp (A ===> B) =\n  (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))", "show ?thesis"], ["proof (prove)\nusing this:\n  Domainp (A ===> B) =\n  (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))\n\ngoal (1 subgoal):\n 1. Domainp (A ===> B) =\n    (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))", "."], ["proof (state)\nthis:\n  Domainp (A ===> B) =\n  (\\<lambda>f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Bex_fun_transfer[transfer_rule]:\n  assumes \"bi_unique A\" \"right_total B\"\n  shows \n    \"(((A ===> B) ===> (=)) ===> (=)) \n      (Bex (Collect (\\<lambda>f. f ` (Collect (Domainp A)) \\<subseteq> (Collect (Domainp B))))) \n      Ex\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (((A ===> B) ===> (=)) ===> (=))\n     (Bex {f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B)}) Ex", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (((A ===> B) ===> (=)) ===> (=))\n     (Bex {f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B)}) Ex", "from assms(1)"], ["proof (chain)\npicking this:\n  bi_unique A", "have \"left_unique A\""], ["proof (prove)\nusing this:\n  bi_unique A\n\ngoal (1 subgoal):\n 1. left_unique A", "by (simp add: bi_unique_alt_def)"], ["proof (state)\nthis:\n  left_unique A\n\ngoal (1 subgoal):\n 1. (((A ===> B) ===> (=)) ===> (=))\n     (Bex {f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B)}) Ex", "note right_total_BA[transfer_rule] = \n    right_total_fun[\n      OF conjunct2[OF bi_unique_alt_def[THEN iffD1, OF assms(1)]] assms(2)\n      ]"], ["proof (state)\nthis:\n  right_total (A ===> B)\n\ngoal (1 subgoal):\n 1. (((A ===> B) ===> (=)) ===> (=))\n     (Bex {f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B)}) Ex", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (((A ===> B) ===> (=)) ===> (=))\n     (Bex {f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B)}) Ex", "unfolding Domainp_fun[OF \\<open>left_unique A\\<close>, symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (((A ===> B) ===> (=)) ===> (=)) (Bex (Collect (Domainp (A ===> B)))) Ex", "by transfer_prover"], ["proof (state)\nthis:\n  (((A ===> B) ===> (=)) ===> (=))\n   (Bex {f. f ` Collect (Domainp A) \\<subseteq> Collect (Domainp B)}) Ex\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "text\\<open>\\newpage\\<close>"], ["", "end"]]}