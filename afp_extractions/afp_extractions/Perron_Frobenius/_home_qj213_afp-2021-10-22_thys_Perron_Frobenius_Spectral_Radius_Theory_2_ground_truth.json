{"file_name": "/home/qj213/afp-2021-10-22/thys/Perron_Frobenius/Spectral_Radius_Theory_2.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Perron_Frobenius", "problem_names": ["lemma jnf_complexity_generic: fixes A :: \"complex mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n  and sr: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> cmod x \\<le> 1\"\n  and 1: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> cmod x = 1 \\<Longrightarrow>\n    order x (char_poly A) > d + 1 \\<Longrightarrow>\n    (\\<forall> bsize \\<in> fst ` set (compute_set_of_jordan_blocks A x). bsize \\<le> d + 1)\"\nshows \"\\<exists>c1 c2. \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * of_nat k ^ d)\"", "lemma norm_bound_complex_to_real: fixes A :: \"real mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n    and bnd: \"\\<exists>c1 c2. \\<forall>k. norm_bound ((map_mat complex_of_real A) ^\\<^sub>m k) (c1 + c2 * of_nat k ^ d)\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * of_nat k ^ d)\"", "lemma dim_gen_eigenspace_max_jordan_block: assumes jnf: \"jordan_nf A n_as\" \n  shows \"dim_gen_eigenspace A l d = order l (char_poly A) \\<longleftrightarrow> \n    (\\<forall> n. (n,l) \\<in> set n_as \\<longrightarrow> n \\<le> d)\"", "lemma jnf_complexity_1_complex: fixes A :: \"complex mat\"\n  assumes A: \"A \\<in> carrier_mat n n\" \n  and nonneg: \"real_nonneg_mat A\" \n  and sr: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> cmod x \\<le> 1\" \n  and 1: \"poly (char_poly A) 1 = 0 \\<Longrightarrow>  \n    order 1 (char_poly A) > d + 1 \\<Longrightarrow> \n    dim_gen_eigenspace A 1 (d+1) = order 1 (char_poly A)\" \nshows \"\\<exists>c1 c2. \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * of_nat k ^ d)\"", "lemma jnf_complexity_1_real: fixes A :: \"real mat\"\n  assumes A: \"A \\<in> carrier_mat n n\" \n  and nonneg: \"nonneg_mat A\" \n  and sr: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\" \n  and jb: \"poly (char_poly A) 1 = 0 \\<Longrightarrow>  \n    order 1 (char_poly A) > d + 1 \\<Longrightarrow> \n    dim_gen_eigenspace A 1 (d+1) = order 1 (char_poly A)\" \nshows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d\""], "translations": [["", "lemma jnf_complexity_generic: fixes A :: \"complex mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n  and sr: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> cmod x \\<le> 1\"\n  and 1: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> cmod x = 1 \\<Longrightarrow>\n    order x (char_poly A) > d + 1 \\<Longrightarrow>\n    (\\<forall> bsize \\<in> fst ` set (compute_set_of_jordan_blocks A x). bsize \\<le> d + 1)\"\nshows \"\\<exists>c1 c2. \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * of_nat k ^ d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "from char_poly_factorized[OF A]"], ["proof (chain)\npicking this:\n  \\<exists>as.\n     char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:]) \\<and> length as = n", "obtain as where cA: \"char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:])\"\n    and lenn: \"length as = n\""], ["proof (prove)\nusing this:\n  \\<exists>as.\n     char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:]) \\<and> length as = n\n\ngoal (1 subgoal):\n 1. (\\<And>as.\n        \\<lbrakk>char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:]);\n         length as = n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:])\n  length as = n\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "from jordan_nf_exists[OF A cA]"], ["proof (chain)\npicking this:\n  \\<exists>n_as. jordan_nf A n_as", "obtain n_xs where jnf: \"jordan_nf A n_xs\""], ["proof (prove)\nusing this:\n  \\<exists>n_as. jordan_nf A n_as\n\ngoal (1 subgoal):\n 1. (\\<And>n_xs.\n        jordan_nf A n_xs \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", ".."], ["proof (state)\nthis:\n  jordan_nf A n_xs\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "have dd: \"x ^ d = x ^((d + 1) - 1)\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. x ^ d = x ^ (d + 1 - 1)", "by simp"], ["proof (state)\nthis:\n  ?x1 ^ d = ?x1 ^ (d + 1 - 1)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "unfolding dd"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k.\n          norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d + 1 - 1))", "proof (rule jordan_nf_matrix_poly_bound[OF A _ _ jnf])"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "fix n x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "assume nx: \"(n,x) \\<in> set n_xs\""], ["proof (state)\nthis:\n  (n, x) \\<in> set n_xs\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "from jordan_nf_block_size_order_bound[OF jnf nx]"], ["proof (chain)\npicking this:\n  n \\<le> order x (char_poly A)", "have no: \"n \\<le> order x (char_poly A)\""], ["proof (prove)\nusing this:\n  n \\<le> order x (char_poly A)\n\ngoal (1 subgoal):\n 1. n \\<le> order x (char_poly A)", "by auto"], ["proof (state)\nthis:\n  n \\<le> order x (char_poly A)\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "{"], ["proof (state)\nthis:\n  n \\<le> order x (char_poly A)\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "assume \"0 < n\""], ["proof (state)\nthis:\n  0 < n\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "with no"], ["proof (chain)\npicking this:\n  n \\<le> order x (char_poly A)\n  0 < n", "have \"order x (char_poly A) \\<noteq> 0\""], ["proof (prove)\nusing this:\n  n \\<le> order x (char_poly A)\n  0 < n\n\ngoal (1 subgoal):\n 1. order x (char_poly A) \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  order x (char_poly A) \\<noteq> 0\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "hence rt: \"poly (char_poly A) x = 0\""], ["proof (prove)\nusing this:\n  order x (char_poly A) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. poly (char_poly A) x = 0", "unfolding order_root"], ["proof (prove)\nusing this:\n  order x (char_poly A) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. char_poly A = 0 \\<or> order x (char_poly A) \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  poly (char_poly A) x = 0\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "from sr[OF this]"], ["proof (chain)\npicking this:\n  cmod x \\<le> 1", "show \"cmod x \\<le> 1\""], ["proof (prove)\nusing this:\n  cmod x \\<le> 1\n\ngoal (1 subgoal):\n 1. cmod x \\<le> 1", "."], ["proof (state)\nthis:\n  cmod x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "note rt"], ["proof (state)\nthis:\n  poly (char_poly A) x = 0\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "}"], ["proof (state)\nthis:\n  0 < n \\<Longrightarrow> poly (char_poly A) x = 0\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "note sr = this"], ["proof (state)\nthis:\n  0 < n \\<Longrightarrow> poly (char_poly A) x = 0\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "assume c1: \"cmod x = 1\""], ["proof (state)\nthis:\n  cmod x = 1\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_xs; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "show \"n \\<le> d + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<le> d + 1", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "assume \"\\<not> n \\<le> d + 1\""], ["proof (state)\nthis:\n  \\<not> n \\<le> d + 1\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "hence lt: \"n > d + 1\""], ["proof (prove)\nusing this:\n  \\<not> n \\<le> d + 1\n\ngoal (1 subgoal):\n 1. d + 1 < n", "by auto"], ["proof (state)\nthis:\n  d + 1 < n\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "with sr"], ["proof (chain)\npicking this:\n  0 < n \\<Longrightarrow> poly (char_poly A) x = 0\n  d + 1 < n", "have rt: \"poly (char_poly A) x = 0\""], ["proof (prove)\nusing this:\n  0 < n \\<Longrightarrow> poly (char_poly A) x = 0\n  d + 1 < n\n\ngoal (1 subgoal):\n 1. poly (char_poly A) x = 0", "by auto"], ["proof (state)\nthis:\n  poly (char_poly A) x = 0\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "from lt no"], ["proof (chain)\npicking this:\n  d + 1 < n\n  n \\<le> order x (char_poly A)", "have ord: \"d + 1 < order x (char_poly A)\""], ["proof (prove)\nusing this:\n  d + 1 < n\n  n \\<le> order x (char_poly A)\n\ngoal (1 subgoal):\n 1. d + 1 < order x (char_poly A)", "by auto"], ["proof (state)\nthis:\n  d + 1 < order x (char_poly A)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "from 1[OF rt c1 ord, unfolded compute_set_of_jordan_blocks[OF jnf]] nx lt"], ["proof (chain)\npicking this:\n  \\<forall>bsize\\<in>fst ` (set n_xs \\<inter> UNIV \\<times> {x}).\n     bsize \\<le> d + 1\n  (n, x) \\<in> set n_xs\n  d + 1 < n", "show False"], ["proof (prove)\nusing this:\n  \\<forall>bsize\\<in>fst ` (set n_xs \\<inter> UNIV \\<times> {x}).\n     bsize \\<le> d + 1\n  (n, x) \\<in> set n_xs\n  d + 1 < n\n\ngoal (1 subgoal):\n 1. False", "by force"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  n \\<le> d + 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma norm_bound_complex_to_real: fixes A :: \"real mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n    and bnd: \"\\<exists>c1 c2. \\<forall>k. norm_bound ((map_mat complex_of_real A) ^\\<^sub>m k) (c1 + c2 * of_nat k ^ d)\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * of_nat k ^ d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "let ?B = \"map_mat complex_of_real A\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "from bnd"], ["proof (chain)\npicking this:\n  \\<exists>c1 c2.\n     \\<forall>k.\n        norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n         (c1 + c2 * real k ^ d)", "obtain c1 c2 where nb: \"\\<And> k. norm_bound (?B ^\\<^sub>m k) (c1 + c2 * real k ^ d)\""], ["proof (prove)\nusing this:\n  \\<exists>c1 c2.\n     \\<forall>k.\n        norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n         (c1 + c2 * real k ^ d)\n\ngoal (1 subgoal):\n 1. (\\<And>c1 c2.\n        (\\<And>k.\n            norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n             (c1 + c2 * real k ^ d)) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  norm_bound (of_real_hom.mat_hom A ^\\<^sub>m ?k) (c1 + c2 * real ?k ^ d)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "proof (rule exI[of _ c1], rule exI[of _ c2], intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "fix k a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "assume \"a \\<in> elements_mat (A ^\\<^sub>m k)\""], ["proof (state)\nthis:\n  a \\<in> elements_mat (A ^\\<^sub>m k)\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "with pow_carrier_mat[OF A]"], ["proof (chain)\npicking this:\n  A ^\\<^sub>m ?k \\<in> carrier_mat n n\n  a \\<in> elements_mat (A ^\\<^sub>m k)", "obtain i j where a: \"a = (A ^\\<^sub>m k) $$ (i,j)\" and ij: \"i < n\" \"j < n\""], ["proof (prove)\nusing this:\n  A ^\\<^sub>m ?k \\<in> carrier_mat n n\n  a \\<in> elements_mat (A ^\\<^sub>m k)\n\ngoal (1 subgoal):\n 1. (\\<And>i j.\n        \\<lbrakk>a = (A ^\\<^sub>m k) $$ (i, j); i < n; j < n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding elements_mat"], ["proof (prove)\nusing this:\n  A ^\\<^sub>m ?k \\<in> carrier_mat n n\n  a \\<in> {(A ^\\<^sub>m k) $$ (i, j) |i j.\n           i < dim_row (A ^\\<^sub>m k) \\<and> j < dim_col (A ^\\<^sub>m k)}\n\ngoal (1 subgoal):\n 1. (\\<And>i j.\n        \\<lbrakk>a = (A ^\\<^sub>m k) $$ (i, j); i < n; j < n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  a = (A ^\\<^sub>m k) $$ (i, j)\n  i < n\n  j < n\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "from ij nb[of k] A"], ["proof (chain)\npicking this:\n  i < n\n  j < n\n  norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k) (c1 + c2 * real k ^ d)\n  A \\<in> carrier_mat n n", "have \"norm ((?B ^\\<^sub>m k) $$ (i,j)) \\<le> c1 + c2 * real k ^ d\""], ["proof (prove)\nusing this:\n  i < n\n  j < n\n  norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k) (c1 + c2 * real k ^ d)\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n    \\<le> c1 + c2 * real k ^ d", "unfolding norm_bound_def"], ["proof (prove)\nusing this:\n  i < n\n  j < n\n  \\<forall>i j.\n     i < dim_row (of_real_hom.mat_hom A ^\\<^sub>m k) \\<longrightarrow>\n     j < dim_col (of_real_hom.mat_hom A ^\\<^sub>m k) \\<longrightarrow>\n     cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n     \\<le> c1 + c2 * real k ^ d\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n    \\<le> c1 + c2 * real k ^ d", "by auto"], ["proof (state)\nthis:\n  cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n  \\<le> c1 + c2 * real k ^ d\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "also"], ["proof (state)\nthis:\n  cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n  \\<le> c1 + c2 * real k ^ d\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "have \"(?B ^\\<^sub>m k) $$ (i,j) = of_real a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j) = complex_of_real a", "unfolding of_real_hom.mat_hom_pow[OF A, symmetric] a"], ["proof (prove)\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom (A ^\\<^sub>m k) $$ (i, j) =\n    complex_of_real ((A ^\\<^sub>m k) $$ (i, j))", "using ij A"], ["proof (prove)\nusing this:\n  i < n\n  j < n\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom (A ^\\<^sub>m k) $$ (i, j) =\n    complex_of_real ((A ^\\<^sub>m k) $$ (i, j))", "by auto"], ["proof (state)\nthis:\n  (of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j) = complex_of_real a\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "also"], ["proof (state)\nthis:\n  (of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j) = complex_of_real a\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "have \"norm (complex_of_real a) = abs a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (complex_of_real a) = \\<bar>a\\<bar>", "by auto"], ["proof (state)\nthis:\n  cmod (complex_of_real a) = \\<bar>a\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "finally"], ["proof (chain)\npicking this:\n  \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "show \"abs a \\<le> (c1 + c2 * real k ^ d)\""], ["proof (prove)\nusing this:\n  \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d\n\ngoal (1 subgoal):\n 1. \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "."], ["proof (state)\nthis:\n  \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k a.\n        a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n        \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma dim_gen_eigenspace_max_jordan_block: assumes jnf: \"jordan_nf A n_as\" \n  shows \"dim_gen_eigenspace A l d = order l (char_poly A) \\<longleftrightarrow> \n    (\\<forall> n. (n,l) \\<in> set n_as \\<longrightarrow> n \\<le> d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "let ?list = \"[(n, e)\\<leftarrow>n_as . e = l]\""], ["proof (state)\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "define list where \"list = [na\\<leftarrow>n_as . snd na = l]\""], ["proof (state)\nthis:\n  list = filter (\\<lambda>na. snd na = l) n_as\n\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "have list: \"?list = list\""], ["proof (prove)\ngoal (1 subgoal):\n 1. filter (\\<lambda>(n, e). e = l) n_as = list", "unfolding list_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. filter (\\<lambda>(n, e). e = l) n_as =\n    filter (\\<lambda>na. snd na = l) n_as", "by (induct n_as, force+)"], ["proof (state)\nthis:\n  filter (\\<lambda>(n, e). e = l) n_as = list\n\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "have id: \"(\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d) = (\\<forall> n \\<in> set (map fst list). n \\<le> d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d) =\n    (\\<forall>n\\<in>set (map fst list). n \\<le> d)", "unfolding list_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d) =\n    (\\<forall>n\\<in>set (map fst (filter (\\<lambda>na. snd na = l) n_as)).\n        n \\<le> d)", "by auto"], ["proof (state)\nthis:\n  (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d) =\n  (\\<forall>n\\<in>set (map fst list). n \\<le> d)\n\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "define ns where \"ns = map fst list\""], ["proof (state)\nthis:\n  ns = map fst list\n\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (dim_gen_eigenspace A l d = order l (char_poly A)) =\n    (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)", "unfolding dim_gen_eigenspace[OF jnf] jordan_nf_order[OF jnf] list list_def[symmetric] id"], ["proof (prove)\ngoal (1 subgoal):\n 1. (sum_list (map (min d) (map fst list)) = sum_list (map fst list)) =\n    (\\<forall>n\\<in>set (map fst list). n \\<le> d)", "unfolding ns_def[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (sum_list (map (min d) ns) = sum_list ns) =\n    (\\<forall>n\\<in>set ns. n \\<le> d)", "proof (induct ns)"], ["proof (state)\ngoal (2 subgoals):\n 1. (sum_list (map (min d) []) = sum_list []) =\n    (\\<forall>n\\<in>set []. n \\<le> d)\n 2. \\<And>a ns.\n       (sum_list (map (min d) ns) = sum_list ns) =\n       (\\<forall>n\\<in>set ns. n \\<le> d) \\<Longrightarrow>\n       (sum_list (map (min d) (a # ns)) = sum_list (a # ns)) =\n       (\\<forall>n\\<in>set (a # ns). n \\<le> d)", "case (Cons n ns)"], ["proof (state)\nthis:\n  (sum_list (map (min d) ns) = sum_list ns) =\n  (\\<forall>n\\<in>set ns. n \\<le> d)\n\ngoal (2 subgoals):\n 1. (sum_list (map (min d) []) = sum_list []) =\n    (\\<forall>n\\<in>set []. n \\<le> d)\n 2. \\<And>a ns.\n       (sum_list (map (min d) ns) = sum_list ns) =\n       (\\<forall>n\\<in>set ns. n \\<le> d) \\<Longrightarrow>\n       (sum_list (map (min d) (a # ns)) = sum_list (a # ns)) =\n       (\\<forall>n\\<in>set (a # ns). n \\<le> d)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "proof (cases \"n \\<le> d\")"], ["proof (state)\ngoal (2 subgoals):\n 1. n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)\n 2. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "case True"], ["proof (state)\nthis:\n  n \\<le> d\n\ngoal (2 subgoals):\n 1. n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)\n 2. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "thus ?thesis"], ["proof (prove)\nusing this:\n  n \\<le> d\n\ngoal (1 subgoal):\n 1. (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "using Cons"], ["proof (prove)\nusing this:\n  n \\<le> d\n  (sum_list (map (min d) ns) = sum_list ns) =\n  (\\<forall>n\\<in>set ns. n \\<le> d)\n\ngoal (1 subgoal):\n 1. (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "by auto"], ["proof (state)\nthis:\n  (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n  (\\<forall>n\\<in>set (n # ns). n \\<le> d)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "case False"], ["proof (state)\nthis:\n  \\<not> n \\<le> d\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "hence \"n > d\""], ["proof (prove)\nusing this:\n  \\<not> n \\<le> d\n\ngoal (1 subgoal):\n 1. d < n", "by auto"], ["proof (state)\nthis:\n  d < n\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "moreover"], ["proof (state)\nthis:\n  d < n\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "have \"sum_list (map (min d) ns) \\<le> sum_list ns\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_list (map (min d) ns) \\<le> sum_list ns", "by (induct ns, auto)"], ["proof (state)\nthis:\n  sum_list (map (min d) ns) \\<le> sum_list ns\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d \\<Longrightarrow>\n    (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "ultimately"], ["proof (chain)\npicking this:\n  d < n\n  sum_list (map (min d) ns) \\<le> sum_list ns", "show ?thesis"], ["proof (prove)\nusing this:\n  d < n\n  sum_list (map (min d) ns) \\<le> sum_list ns\n\ngoal (1 subgoal):\n 1. (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n    (\\<forall>n\\<in>set (n # ns). n \\<le> d)", "by auto"], ["proof (state)\nthis:\n  (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n  (\\<forall>n\\<in>set (n # ns). n \\<le> d)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (sum_list (map (min d) (n # ns)) = sum_list (n # ns)) =\n  (\\<forall>n\\<in>set (n # ns). n \\<le> d)\n\ngoal (1 subgoal):\n 1. (sum_list (map (min d) []) = sum_list []) =\n    (\\<forall>n\\<in>set []. n \\<le> d)", "qed auto"], ["proof (state)\nthis:\n  (dim_gen_eigenspace A l d = order l (char_poly A)) =\n  (\\<forall>n. (n, l) \\<in> set n_as \\<longrightarrow> n \\<le> d)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma jnf_complexity_1_complex: fixes A :: \"complex mat\"\n  assumes A: \"A \\<in> carrier_mat n n\" \n  and nonneg: \"real_nonneg_mat A\" \n  and sr: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> cmod x \\<le> 1\" \n  and 1: \"poly (char_poly A) 1 = 0 \\<Longrightarrow>  \n    order 1 (char_poly A) > d + 1 \\<Longrightarrow> \n    dim_gen_eigenspace A 1 (d+1) = order 1 (char_poly A)\" \nshows \"\\<exists>c1 c2. \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * of_nat k ^ d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "from char_poly_factorized[OF A]"], ["proof (chain)\npicking this:\n  \\<exists>as.\n     char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:]) \\<and> length as = n", "obtain as where cA: \"char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:])\" \n    and lenn: \"length as = n\""], ["proof (prove)\nusing this:\n  \\<exists>as.\n     char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:]) \\<and> length as = n\n\ngoal (1 subgoal):\n 1. (\\<And>as.\n        \\<lbrakk>char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:]);\n         length as = n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  char_poly A = (\\<Prod>a\\<leftarrow>as. [:- a, 1:])\n  length as = n\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "from jordan_nf_exists[OF A cA]"], ["proof (chain)\npicking this:\n  \\<exists>n_as. jordan_nf A n_as", "obtain n_as where jnf: \"jordan_nf A n_as\""], ["proof (prove)\nusing this:\n  \\<exists>n_as. jordan_nf A n_as\n\ngoal (1 subgoal):\n 1. (\\<And>n_as.\n        jordan_nf A n_as \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", ".."], ["proof (state)\nthis:\n  jordan_nf A n_as\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "have dd: \"x ^ d = x ^((d + 1) - 1)\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. x ^ d = x ^ (d + 1 - 1)", "by simp"], ["proof (state)\nthis:\n  ?x1 ^ d = ?x1 ^ (d + 1 - 1)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "let ?n = n"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)", "unfolding dd"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k.\n          norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d + 1 - 1))", "proof (rule jordan_nf_matrix_poly_bound[OF A _ _ jnf])"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "fix n a"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "assume na: \"(n,a) \\<in> set n_as\""], ["proof (state)\nthis:\n  (n, a) \\<in> set n_as\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "from jordan_nf_root_char_poly[OF jnf na]"], ["proof (chain)\npicking this:\n  poly (char_poly A) a = 0", "have rt: \"poly (char_poly A) a = 0\""], ["proof (prove)\nusing this:\n  poly (char_poly A) a = 0\n\ngoal (1 subgoal):\n 1. poly (char_poly A) a = 0", "by auto"], ["proof (state)\nthis:\n  poly (char_poly A) a = 0\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "with degree_monic_char_poly[OF A]"], ["proof (chain)\npicking this:\n  degree (char_poly A) = n \\<and> coeff (char_poly A) n = 1\n  poly (char_poly A) a = 0", "have n0: \"?n > 0\""], ["proof (prove)\nusing this:\n  degree (char_poly A) = n \\<and> coeff (char_poly A) n = 1\n  poly (char_poly A) a = 0\n\ngoal (1 subgoal):\n 1. 0 < n", "by (cases ?n, auto dest: degree0_coeffs)"], ["proof (state)\nthis:\n  0 < n\n\ngoal (2 subgoals):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; 0 < n\\<rbrakk>\n       \\<Longrightarrow> cmod a \\<le> 1\n 2. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "from sr[OF rt]"], ["proof (chain)\npicking this:\n  cmod a \\<le> 1", "show \"cmod a \\<le> 1\""], ["proof (prove)\nusing this:\n  cmod a \\<le> 1\n\ngoal (1 subgoal):\n 1. cmod a \\<le> 1", "."], ["proof (state)\nthis:\n  cmod a \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "assume a: \"cmod a = 1\""], ["proof (state)\nthis:\n  cmod a = 1\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "from rt"], ["proof (chain)\npicking this:\n  poly (char_poly A) a = 0", "have \"a \\<in> spectrum A\""], ["proof (prove)\nusing this:\n  poly (char_poly A) a = 0\n\ngoal (1 subgoal):\n 1. a \\<in> spectrum A", "using A spectrum_root_char_poly"], ["proof (prove)\nusing this:\n  poly (char_poly A) a = 0\n  A \\<in> carrier_mat n n\n  ?A \\<in> carrier_mat ?n ?n \\<Longrightarrow>\n  spectrum ?A = {k. poly (char_poly ?A) k = (0::?'a)}\n\ngoal (1 subgoal):\n 1. a \\<in> spectrum A", "by auto"], ["proof (state)\nthis:\n  a \\<in> spectrum A\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "hence 11: \"1 \\<in> cmod ` spectrum A\""], ["proof (prove)\nusing this:\n  a \\<in> spectrum A\n\ngoal (1 subgoal):\n 1. 1 \\<in> cmod ` spectrum A", "using a"], ["proof (prove)\nusing this:\n  a \\<in> spectrum A\n  cmod a = 1\n\ngoal (1 subgoal):\n 1. 1 \\<in> cmod ` spectrum A", "by auto"], ["proof (state)\nthis:\n  1 \\<in> cmod ` spectrum A\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "note spec = spectral_radius_mem_max[OF A n0]"], ["proof (state)\nthis:\n  spectral_radius A \\<in> cmod ` spectrum A\n  ?a \\<in> cmod ` spectrum A \\<Longrightarrow> ?a \\<le> spectral_radius A\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "from spec(2)[OF 11]"], ["proof (chain)\npicking this:\n  1 \\<le> spectral_radius A", "have le: \"1 \\<le> spectral_radius A\""], ["proof (prove)\nusing this:\n  1 \\<le> spectral_radius A\n\ngoal (1 subgoal):\n 1. 1 \\<le> spectral_radius A", "."], ["proof (state)\nthis:\n  1 \\<le> spectral_radius A\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "from spec(1)[unfolded spectrum_root_char_poly[OF A]] sr"], ["proof (chain)\npicking this:\n  spectral_radius A \\<in> cmod ` {k. poly (char_poly A) k = 0}\n  poly (char_poly A) ?x = 0 \\<Longrightarrow> cmod ?x \\<le> 1", "have \"spectral_radius A \\<le> 1\""], ["proof (prove)\nusing this:\n  spectral_radius A \\<in> cmod ` {k. poly (char_poly A) k = 0}\n  poly (char_poly A) ?x = 0 \\<Longrightarrow> cmod ?x \\<le> 1\n\ngoal (1 subgoal):\n 1. spectral_radius A \\<le> 1", "by auto"], ["proof (state)\nthis:\n  spectral_radius A \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "with le"], ["proof (chain)\npicking this:\n  1 \\<le> spectral_radius A\n  spectral_radius A \\<le> 1", "have sr: \"spectral_radius A = 1\""], ["proof (prove)\nusing this:\n  1 \\<le> spectral_radius A\n  spectral_radius A \\<le> 1\n\ngoal (1 subgoal):\n 1. spectral_radius A = 1", "by auto"], ["proof (state)\nthis:\n  spectral_radius A = 1\n\ngoal (1 subgoal):\n 1. \\<And>n a.\n       \\<lbrakk>(n, a) \\<in> set n_as; cmod a = 1\\<rbrakk>\n       \\<Longrightarrow> n \\<le> d + 1", "show \"n \\<le> d + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<le> d + 1", "proof (rule ccontr)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "assume \"\\<not> ?thesis\""], ["proof (state)\nthis:\n  \\<not> n \\<le> d + 1\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "hence nd: \"n > d + 1\""], ["proof (prove)\nusing this:\n  \\<not> n \\<le> d + 1\n\ngoal (1 subgoal):\n 1. d + 1 < n", "by auto"], ["proof (state)\nthis:\n  d + 1 < n\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "from real_nonneg_mat_spectral_radius_largest_jordan_block[OF nonneg jnf na, unfolded sr a]"], ["proof (chain)\npicking this:\n  1 = 1 \\<Longrightarrow>\n  \\<exists>M\\<ge>n. (M, complex_of_real 1) \\<in> set n_as", "obtain N where N: \"N \\<ge> n\" and mem: \"(N, 1) \\<in> set n_as\""], ["proof (prove)\nusing this:\n  1 = 1 \\<Longrightarrow>\n  \\<exists>M\\<ge>n. (M, complex_of_real 1) \\<in> set n_as\n\ngoal (1 subgoal):\n 1. (\\<And>N.\n        \\<lbrakk>n \\<le> N; (N, 1) \\<in> set n_as\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  n \\<le> N\n  (N, 1) \\<in> set n_as\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "from jordan_nf_root_char_poly[OF jnf mem]"], ["proof (chain)\npicking this:\n  poly (char_poly A) 1 = 0", "have rt: \"poly (char_poly A) 1 = 0\""], ["proof (prove)\nusing this:\n  poly (char_poly A) 1 = 0\n\ngoal (1 subgoal):\n 1. poly (char_poly A) 1 = 0", "."], ["proof (state)\nthis:\n  poly (char_poly A) 1 = 0\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "from jordan_nf_block_size_order_bound[OF jnf mem]"], ["proof (chain)\npicking this:\n  N \\<le> order 1 (char_poly A)", "have \"N \\<le> order 1 (char_poly A)\""], ["proof (prove)\nusing this:\n  N \\<le> order 1 (char_poly A)\n\ngoal (1 subgoal):\n 1. N \\<le> order 1 (char_poly A)", "."], ["proof (state)\nthis:\n  N \\<le> order 1 (char_poly A)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "with N nd"], ["proof (chain)\npicking this:\n  n \\<le> N\n  d + 1 < n\n  N \\<le> order 1 (char_poly A)", "have \"d + 1 < order 1 (char_poly A)\""], ["proof (prove)\nusing this:\n  n \\<le> N\n  d + 1 < n\n  N \\<le> order 1 (char_poly A)\n\ngoal (1 subgoal):\n 1. d + 1 < order 1 (char_poly A)", "by simp"], ["proof (state)\nthis:\n  d + 1 < order 1 (char_poly A)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> d + 1 \\<Longrightarrow> False", "from 1[OF rt this, unfolded dim_gen_eigenspace_max_jordan_block[OF jnf]] mem N nd"], ["proof (chain)\npicking this:\n  \\<forall>n. (n, 1) \\<in> set n_as \\<longrightarrow> n \\<le> d + 1\n  (N, 1) \\<in> set n_as\n  n \\<le> N\n  d + 1 < n", "show False"], ["proof (prove)\nusing this:\n  \\<forall>n. (n, 1) \\<in> set n_as \\<longrightarrow> n \\<le> d + 1\n  (N, 1) \\<in> set n_as\n  n \\<le> N\n  d + 1 < n\n\ngoal (1 subgoal):\n 1. False", "by force"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  n \\<le> d + 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ d)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma jnf_complexity_1_real: fixes A :: \"real mat\"\n  assumes A: \"A \\<in> carrier_mat n n\" \n  and nonneg: \"nonneg_mat A\" \n  and sr: \"\\<And> x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\" \n  and jb: \"poly (char_poly A) 1 = 0 \\<Longrightarrow>  \n    order 1 (char_poly A) > d + 1 \\<Longrightarrow> \n    dim_gen_eigenspace A 1 (d+1) = order 1 (char_poly A)\" \nshows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "let ?c = \"complex_of_real\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "let ?A = \"map_mat ?c A\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "have A': \"?A \\<in> carrier_mat n n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom A \\<in> carrier_mat n n", "using A"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom A \\<in> carrier_mat n n", "by auto"], ["proof (state)\nthis:\n  of_real_hom.mat_hom A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "have nn: \"real_nonneg_mat ?A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_nonneg_mat (of_real_hom.mat_hom A)", "using nonneg A"], ["proof (prove)\nusing this:\n  nonneg_mat A\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. real_nonneg_mat (of_real_hom.mat_hom A)", "unfolding nonneg_mat_def real_nonneg_mat_def"], ["proof (prove)\nusing this:\n  \\<forall>a\\<in>elements_mat A. 0 \\<le> a\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>elements_mat (of_real_hom.mat_hom A).\n       a \\<in> \\<real> \\<and> 0 \\<le> Re a", "by (force simp: elements_mat)"], ["proof (state)\nthis:\n  real_nonneg_mat (of_real_hom.mat_hom A)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "have 1: \"1 = ?c 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 = complex_of_real 1", "by auto"], ["proof (state)\nthis:\n  1 = complex_of_real 1\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "note cp = of_real_hom.char_poly_hom[OF A]"], ["proof (state)\nthis:\n  char_poly (of_real_hom.mat_hom A) = map_poly of_real (char_poly A)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "have hom: \"map_poly_inj_idom_divide_hom complex_of_real\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map_poly_inj_idom_divide_hom complex_of_real", ".."], ["proof (state)\nthis:\n  map_poly_inj_idom_divide_hom complex_of_real\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d", "proof (rule norm_bound_complex_to_real[OF A jnf_complexity_1_complex[OF A' nn]],\n      unfold cp of_real_hom.poly_map_poly_1, unfold 1\n      of_real_hom.hom_dim_gen_eigenspace[OF A]\n      map_poly_inj_idom_divide_hom.order_hom[OF hom], goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1\n 2. \\<lbrakk>complex_of_real (poly (char_poly A) 1) = 0;\n     d + 1 < order 1 (char_poly A)\\<rbrakk>\n    \\<Longrightarrow> dim_gen_eigenspace A 1 (d + 1) = order 1 (char_poly A)", "case 2"], ["proof (state)\nthis:\n  complex_of_real (poly (char_poly A) 1) = 0\n  d + 1 < order 1 (char_poly A)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1\n 2. \\<lbrakk>complex_of_real (poly (char_poly A) 1) = 0;\n     d + 1 < order 1 (char_poly A)\\<rbrakk>\n    \\<Longrightarrow> dim_gen_eigenspace A 1 (d + 1) = order 1 (char_poly A)", "thus ?case"], ["proof (prove)\nusing this:\n  complex_of_real (poly (char_poly A) 1) = 0\n  d + 1 < order 1 (char_poly A)\n\ngoal (1 subgoal):\n 1. dim_gen_eigenspace A 1 (d + 1) = order 1 (char_poly A)", "using jb"], ["proof (prove)\nusing this:\n  complex_of_real (poly (char_poly A) 1) = 0\n  d + 1 < order 1 (char_poly A)\n  \\<lbrakk>poly (char_poly A) 1 = 0; d + 1 < order 1 (char_poly A)\\<rbrakk>\n  \\<Longrightarrow> dim_gen_eigenspace A 1 (d + 1) = order 1 (char_poly A)\n\ngoal (1 subgoal):\n 1. dim_gen_eigenspace A 1 (d + 1) = order 1 (char_poly A)", "by auto"], ["proof (state)\nthis:\n  dim_gen_eigenspace A 1 (d + 1) = order 1 (char_poly A)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "case (1 x)"], ["proof (state)\nthis:\n  poly (map_poly complex_of_real (char_poly A)) x = 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "let ?cp = \"char_poly A\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "assume rt: \"poly (map_poly ?c ?cp) x = 0\""], ["proof (state)\nthis:\n  poly (map_poly complex_of_real (char_poly A)) x = 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "with degree_monic_char_poly[OF A', unfolded cp]"], ["proof (chain)\npicking this:\n  degree (map_poly complex_of_real (char_poly A)) = n \\<and>\n  coeff (map_poly complex_of_real (char_poly A)) n = 1\n  poly (map_poly complex_of_real (char_poly A)) x = 0", "have n0: \"n \\<noteq> 0\""], ["proof (prove)\nusing this:\n  degree (map_poly complex_of_real (char_poly A)) = n \\<and>\n  coeff (map_poly complex_of_real (char_poly A)) n = 1\n  poly (map_poly complex_of_real (char_poly A)) x = 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0", "using degree0_coeffs[of ?cp]"], ["proof (prove)\nusing this:\n  degree (map_poly complex_of_real (char_poly A)) = n \\<and>\n  coeff (map_poly complex_of_real (char_poly A)) n = 1\n  poly (map_poly complex_of_real (char_poly A)) x = 0\n  degree (char_poly A) = 0 \\<Longrightarrow> \\<exists>a. char_poly A = [:a:]\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0", "by (cases n, auto)"], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "from perron_frobenius_nonneg[OF A nonneg n0]"], ["proof (chain)\npicking this:\n  \\<exists>sr ks f.\n     0 \\<le> sr \\<and>\n     0 \\<notin> set ks \\<and>\n     ks \\<noteq> [] \\<and>\n     char_poly A =\n     (\\<Prod>k\\<leftarrow>ks. monom 1 k - [:sr ^ k:]) * f \\<and>\n     (\\<forall>x.\n         poly (map_poly complex_of_real f) x = 0 \\<longrightarrow>\n         cmod x < sr)", "obtain sr ks f where sr0: \"0 \\<le> sr\" and ks: \"0 \\<notin> set ks\" \"ks \\<noteq> []\"\n      and cp: \"?cp = (\\<Prod>k\\<leftarrow>ks. monom 1 k - [:sr ^ k:]) * f\" \n      and rtf: \"poly (map_poly ?c f) x = 0 \\<Longrightarrow> cmod x < sr\""], ["proof (prove)\nusing this:\n  \\<exists>sr ks f.\n     0 \\<le> sr \\<and>\n     0 \\<notin> set ks \\<and>\n     ks \\<noteq> [] \\<and>\n     char_poly A =\n     (\\<Prod>k\\<leftarrow>ks. monom 1 k - [:sr ^ k:]) * f \\<and>\n     (\\<forall>x.\n         poly (map_poly complex_of_real f) x = 0 \\<longrightarrow>\n         cmod x < sr)\n\ngoal (1 subgoal):\n 1. (\\<And>sr ks f.\n        \\<lbrakk>0 \\<le> sr; 0 \\<notin> set ks; ks \\<noteq> [];\n         char_poly A = (\\<Prod>k\\<leftarrow>ks. monom 1 k - [:sr ^ k:]) * f;\n         poly (map_poly complex_of_real f) x = 0 \\<Longrightarrow>\n         cmod x < sr\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  0 \\<le> sr\n  0 \\<notin> set ks\n  ks \\<noteq> []\n  char_poly A = (\\<Prod>k\\<leftarrow>ks. monom 1 k - [:sr ^ k:]) * f\n  poly (map_poly complex_of_real f) x = 0 \\<Longrightarrow> cmod x < sr\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "have sr_rt: \"poly ?cp sr = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. poly (char_poly A) sr = 0", "unfolding cp poly_prod_list_zero_iff poly_mult_zero_iff"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<exists>p\\<in>set (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks).\n        poly p sr = 0) \\<or>\n    poly f sr = 0", "using ks"], ["proof (prove)\nusing this:\n  0 \\<notin> set ks\n  ks \\<noteq> []\n\ngoal (1 subgoal):\n 1. (\\<exists>p\\<in>set (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks).\n        poly p sr = 0) \\<or>\n    poly f sr = 0", "by (cases ks, auto simp: poly_monom)"], ["proof (state)\nthis:\n  poly (char_poly A) sr = 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "from sr[OF sr_rt]"], ["proof (chain)\npicking this:\n  sr \\<le> 1", "have sr1: \"sr \\<le> 1\""], ["proof (prove)\nusing this:\n  sr \\<le> 1\n\ngoal (1 subgoal):\n 1. sr \\<le> 1", "."], ["proof (state)\nthis:\n  sr \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "interpret c: map_poly_comm_ring_hom ?c"], ["proof (prove)\ngoal (1 subgoal):\n 1. map_poly_comm_ring_hom complex_of_real", ".."], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       poly (map_poly complex_of_real (char_poly A)) x = 0 \\<Longrightarrow>\n       cmod x \\<le> 1", "from rt[unfolded cp c.hom_mult c.hom_prod_list poly_mult_zero_iff poly_prod_list_zero_iff]"], ["proof (chain)\npicking this:\n  (\\<exists>p\\<in>set (map (map_poly complex_of_real)\n                        (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n      poly p x = 0) \\<or>\n  poly (map_poly complex_of_real f) x = 0", "show \"cmod x \\<le> 1\""], ["proof (prove)\nusing this:\n  (\\<exists>p\\<in>set (map (map_poly complex_of_real)\n                        (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n      poly p x = 0) \\<or>\n  poly (map_poly complex_of_real f) x = 0\n\ngoal (1 subgoal):\n 1. cmod x \\<le> 1", "proof (standard, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1\n 2. poly (map_poly complex_of_real f) x = 0 \\<Longrightarrow> cmod x \\<le> 1", "case 2"], ["proof (state)\nthis:\n  poly (map_poly complex_of_real f) x = 0\n\ngoal (2 subgoals):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1\n 2. poly (map_poly complex_of_real f) x = 0 \\<Longrightarrow> cmod x \\<le> 1", "with rtf sr1"], ["proof (chain)\npicking this:\n  poly (map_poly complex_of_real f) x = 0 \\<Longrightarrow> cmod x < sr\n  sr \\<le> 1\n  poly (map_poly complex_of_real f) x = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  poly (map_poly complex_of_real f) x = 0 \\<Longrightarrow> cmod x < sr\n  sr \\<le> 1\n  poly (map_poly complex_of_real f) x = 0\n\ngoal (1 subgoal):\n 1. cmod x \\<le> 1", "by auto"], ["proof (state)\nthis:\n  cmod x \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1", "case 1"], ["proof (state)\nthis:\n  \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                       (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n     poly p x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1", "from this ks"], ["proof (chain)\npicking this:\n  \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                       (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n     poly p x = 0\n  0 \\<notin> set ks\n  ks \\<noteq> []", "obtain p where p: \"p \\<in> set ks\" \n        and rt: \"poly (map_poly ?c (monom 1 p - [:sr ^ p:])) x = 0\""], ["proof (prove)\nusing this:\n  \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                       (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n     poly p x = 0\n  0 \\<notin> set ks\n  ks \\<noteq> []\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> set ks;\n         poly (map_poly complex_of_real (monom 1 p - [:sr ^ p:])) x =\n         0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  p \\<in> set ks\n  poly (map_poly complex_of_real (monom 1 p - [:sr ^ p:])) x = 0\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1", "from p ks(1)"], ["proof (chain)\npicking this:\n  p \\<in> set ks\n  0 \\<notin> set ks", "have p: \"p \\<noteq> 0\""], ["proof (prove)\nusing this:\n  p \\<in> set ks\n  0 \\<notin> set ks\n\ngoal (1 subgoal):\n 1. p \\<noteq> 0", "by metis"], ["proof (state)\nthis:\n  p \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1", "from rt"], ["proof (chain)\npicking this:\n  poly (map_poly complex_of_real (monom 1 p - [:sr ^ p:])) x = 0", "have \"x^p = (?c sr)^p\""], ["proof (prove)\nusing this:\n  poly (map_poly complex_of_real (monom 1 p - [:sr ^ p:])) x = 0\n\ngoal (1 subgoal):\n 1. x ^ p = complex_of_real sr ^ p", "unfolding c.hom_minus"], ["proof (prove)\nusing this:\n  poly\n   (map_poly complex_of_real (monom 1 p) -\n    map_poly complex_of_real [:sr ^ p:])\n   x =\n  0\n\ngoal (1 subgoal):\n 1. x ^ p = complex_of_real sr ^ p", "by (simp add: poly_monom of_real_hom.map_poly_pCons_hom)"], ["proof (state)\nthis:\n  x ^ p = complex_of_real sr ^ p\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1", "hence \"cmod x = cmod (?c sr)\""], ["proof (prove)\nusing this:\n  x ^ p = complex_of_real sr ^ p\n\ngoal (1 subgoal):\n 1. cmod x = cmod (complex_of_real sr)", "using p power_eq_imp_eq_norm"], ["proof (prove)\nusing this:\n  x ^ p = complex_of_real sr ^ p\n  p \\<noteq> 0\n  \\<lbrakk>?w ^ ?n = ?z ^ ?n; 0 < ?n\\<rbrakk>\n  \\<Longrightarrow> norm ?w = norm ?z\n\ngoal (1 subgoal):\n 1. cmod x = cmod (complex_of_real sr)", "by blast"], ["proof (state)\nthis:\n  cmod x = cmod (complex_of_real sr)\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>set (map (map_poly complex_of_real)\n                         (map (\\<lambda>k. monom 1 k - [:sr ^ k:]) ks)).\n       poly p x = 0 \\<Longrightarrow>\n    cmod x \\<le> 1", "with sr0 sr1"], ["proof (chain)\npicking this:\n  0 \\<le> sr\n  sr \\<le> 1\n  cmod x = cmod (complex_of_real sr)", "show \"cmod x \\<le> 1\""], ["proof (prove)\nusing this:\n  0 \\<le> sr\n  sr \\<le> 1\n  cmod x = cmod (complex_of_real sr)\n\ngoal (1 subgoal):\n 1. cmod x \\<le> 1", "by auto"], ["proof (state)\nthis:\n  cmod x \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  cmod x \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k a.\n        a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n        \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ d\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}