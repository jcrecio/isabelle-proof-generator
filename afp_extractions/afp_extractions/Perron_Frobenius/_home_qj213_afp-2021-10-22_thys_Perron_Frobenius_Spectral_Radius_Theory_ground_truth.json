{"file_name": "/home/qj213/afp-2021-10-22/thys/Perron_Frobenius/Spectral_Radius_Theory.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Perron_Frobenius", "problem_names": ["lemma perron_frobenius_spectral_radius_complex: fixes A :: \"complex mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n  and real_nonneg: \"real_nonneg_mat A\"\n  and ev_le_1: \"\\<And> x. poly (char_poly (map_mat Re A)) x = 0 \\<Longrightarrow> x \\<le> 1\"\n  and ev_order: \"\\<And> x. norm x = 1 \\<Longrightarrow> order x (char_poly A) \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\"", "lemma perron_frobenius_spectral_radius: fixes A :: \"real mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n  and nonneg: \"nonneg_mat A\"\n  and ev_le_1: \"\\<forall> x. poly (char_poly A) x = 0 \\<longrightarrow> x \\<le> 1\"\n  and ev_order: \"\\<forall> x :: complex. norm x = 1 \\<longrightarrow> order x (map_poly of_real (char_poly A)) \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\"", "lemma perron_frobenius_spectral_type_based: \n  assumes \"non_neg_mat (A :: real ^ 'n ^ 'n)\"\n  and \"\\<forall> x. poly (charpoly A) x = 0 \\<longrightarrow> x \\<le> 1\"\n  and \"\\<forall> x :: complex. norm x = 1 \\<longrightarrow> order x (map_poly of_real (charpoly A)) \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat_h (matpow A k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\"", "lemma assumes \"A \\<in> carrier_mat n n\"\n  and \"nonneg_mat A\"\n  and \"\\<forall> x. poly (char_poly A) x = 0 \\<longrightarrow> x \\<le> 1\"\n  and \"\\<forall> x :: complex. norm x = 1 \\<longrightarrow> order x (map_poly of_real (char_poly A)) \\<le> d\"\n  and \"n \\<noteq> 0\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\"", "lemma perron_frobenius_spectral_radius_yun: \n  assumes bnd: \"\\<And> f\\<^sub>i i. (f\\<^sub>i,i) \\<in> set fis \n    \\<Longrightarrow> (\\<exists> x :: complex. poly (map_poly of_real f\\<^sub>i) x = 0 \\<and> norm x = 1) \n    \\<Longrightarrow> Suc i \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\"", "lemma perron_frobenius_spectral_radius_yun_real_roots: \n  assumes bnd: \"\\<And> f\\<^sub>i i. (f\\<^sub>i,i) \\<in> set fis \n    \\<Longrightarrow> card { x. poly f\\<^sub>i x = 0} \\<noteq> degree f\\<^sub>i \\<or> poly f\\<^sub>i 1 = 0 \\<or> poly f\\<^sub>i (-1) = 0 \n    \\<Longrightarrow> Suc i \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\""], "translations": [["", "lemma perron_frobenius_spectral_radius_complex: fixes A :: \"complex mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n  and real_nonneg: \"real_nonneg_mat A\"\n  and ev_le_1: \"\\<And> x. poly (char_poly (map_mat Re A)) x = 0 \\<Longrightarrow> x \\<le> 1\"\n  and ev_order: \"\\<And> x. norm x = 1 \\<Longrightarrow> order x (char_poly A) \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "proof (cases \"n = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "case False"], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "hence n: \"n > 0\" \"n \\<noteq> 0\""], ["proof (prove)\nusing this:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < n &&& n \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  0 < n\n  n \\<noteq> 0\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "define sr where \"sr = spectral_radius A\""], ["proof (state)\nthis:\n  sr = Spectral_Radius_Theory.spectral_radius A\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "note sr = spectral_radius_mem_max[OF A n(1), folded sr_def]"], ["proof (state)\nthis:\n  sr \\<in> cmod ` spectrum A\n  ?a \\<in> cmod ` spectrum A \\<Longrightarrow> ?a \\<le> sr\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "proof (rule spectral_radius_poly_bound[OF A], unfold sr_def[symmetric])"], ["proof (state)\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "let ?cr = \"complex_of_real\""], ["proof (state)\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "text \\<open>here is the transition from type-based perron-frobenius to set-based\\<close>"], ["proof (state)\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "from perron_frobenius[untransferred, cancel_card_constraint, OF A real_nonneg n(2)]"], ["proof (chain)\npicking this:\n  \\<exists>v\\<in>{v. v \\<in> carrier_vec n}.\n     eigenvector A v\n      (complex_of_real (Spectral_Radius_Theory.spectral_radius A)) \\<and>\n     real_nonneg_vec v", "obtain v where v: \"v \\<in> carrier_vec n\" and ev: \"eigenvector A v (?cr sr)\" and \n      rnn: \"real_nonneg_vec v\""], ["proof (prove)\nusing this:\n  \\<exists>v\\<in>{v. v \\<in> carrier_vec n}.\n     eigenvector A v\n      (complex_of_real (Spectral_Radius_Theory.spectral_radius A)) \\<and>\n     real_nonneg_vec v\n\ngoal (1 subgoal):\n 1. (\\<And>v.\n        \\<lbrakk>v \\<in> carrier_vec n;\n         eigenvector A v (complex_of_real sr); real_nonneg_vec v\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding sr_def"], ["proof (prove)\nusing this:\n  \\<exists>v\\<in>{v. v \\<in> carrier_vec n}.\n     eigenvector A v\n      (complex_of_real (Spectral_Radius_Theory.spectral_radius A)) \\<and>\n     real_nonneg_vec v\n\ngoal (1 subgoal):\n 1. (\\<And>v.\n        \\<lbrakk>v \\<in> carrier_vec n;\n         eigenvector A v\n          (complex_of_real (Spectral_Radius_Theory.spectral_radius A));\n         real_nonneg_vec v\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  v \\<in> carrier_vec n\n  eigenvector A v (complex_of_real sr)\n  real_nonneg_vec v\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "define B where \"B = map_mat Re A\""], ["proof (state)\nthis:\n  B = map_mat Re A\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "let ?A = \"map_mat ?cr B\""], ["proof (state)\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "have AB: \"A = ?A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A = of_real_hom.mat_hom B", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. A = of_real_hom.mat_hom (map_mat Re A)", "by (rule eq_matI, insert real_nonneg[unfolded real_nonneg_mat_def elements_mat_def], auto)"], ["proof (state)\nthis:\n  A = of_real_hom.mat_hom B\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "define w where \"w = map_vec Re v\""], ["proof (state)\nthis:\n  w = map_vec Re v\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "let ?v = \"map_vec ?cr w\""], ["proof (state)\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "have vw: \"v = ?v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v = of_real_hom.vec_hom w", "unfolding w_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. v = of_real_hom.vec_hom (map_vec Re v)", "by (rule eq_vecI, insert rnn[unfolded real_nonneg_vec_def vec_elements_def], auto)"], ["proof (state)\nthis:\n  v = of_real_hom.vec_hom w\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "have B: \"B \\<in> carrier_mat n n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B \\<in> carrier_mat n n", "unfolding B_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. map_mat Re A \\<in> carrier_mat n n", "using A"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. map_mat Re A \\<in> carrier_mat n n", "by auto"], ["proof (state)\nthis:\n  B \\<in> carrier_mat n n\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "from AB vw ev"], ["proof (chain)\npicking this:\n  A = of_real_hom.mat_hom B\n  v = of_real_hom.vec_hom w\n  eigenvector A v (complex_of_real sr)", "have ev: \"eigenvector ?A ?v (?cr sr)\""], ["proof (prove)\nusing this:\n  A = of_real_hom.mat_hom B\n  v = of_real_hom.vec_hom w\n  eigenvector A v (complex_of_real sr)\n\ngoal (1 subgoal):\n 1. eigenvector (of_real_hom.mat_hom B) (of_real_hom.vec_hom w)\n     (complex_of_real sr)", "by simp"], ["proof (state)\nthis:\n  eigenvector (of_real_hom.mat_hom B) (of_real_hom.vec_hom w)\n   (complex_of_real sr)\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "have \"eigenvector B w sr\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eigenvector B w sr", "by (rule of_real_hom.eigenvector_hom_rev[OF B ev])"], ["proof (state)\nthis:\n  eigenvector B w sr\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "hence \"eigenvalue B sr\""], ["proof (prove)\nusing this:\n  eigenvector B w sr\n\ngoal (1 subgoal):\n 1. eigenvalue B sr", "unfolding eigenvalue_def"], ["proof (prove)\nusing this:\n  eigenvector B w sr\n\ngoal (1 subgoal):\n 1. \\<exists>v. eigenvector B v sr", "by blast"], ["proof (state)\nthis:\n  eigenvalue B sr\n\ngoal (2 subgoals):\n 1. sr \\<le> 1\n 2. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "from ev_le_1[folded B_def, OF this[unfolded eigenvalue_root_char_poly[OF B]]]"], ["proof (chain)\npicking this:\n  sr \\<le> 1", "show \"sr \\<le> 1\""], ["proof (prove)\nusing this:\n  sr \\<le> 1\n\ngoal (1 subgoal):\n 1. sr \\<le> 1", "."], ["proof (state)\nthis:\n  sr \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "fix ev"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "assume \"cmod ev = 1\""], ["proof (state)\nthis:\n  cmod ev = 1\n\ngoal (1 subgoal):\n 1. \\<And>ev k.\n       \\<lbrakk>poly (char_poly A) ev = 0; cmod ev = 1\\<rbrakk>\n       \\<Longrightarrow> order ev (char_poly A) \\<le> d", "thus \"order ev (char_poly A) \\<le> d\""], ["proof (prove)\nusing this:\n  cmod ev = 1\n\ngoal (1 subgoal):\n 1. order ev (char_poly A) \\<le> d", "by (rule ev_order)"], ["proof (state)\nthis:\n  order ev (char_poly A) \\<le> d\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\n\ngoal (1 subgoal):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "case True"], ["proof (state)\nthis:\n  n = 0\n\ngoal (1 subgoal):\n 1. n = 0 \\<Longrightarrow>\n    \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "with A"], ["proof (chain)\npicking this:\n  A \\<in> carrier_mat n n\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat n n\n  n = 0\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))", "by (intro exI[of _ 0], auto simp: norm_bound_def)"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k. norm_bound (A ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>The following lemma is the same as @{thm perron_frobenius_spectral_radius_complex}, \n  except that now the type @{typ real} is used instead of @{typ complex}.\\<close>"], ["", "lemma perron_frobenius_spectral_radius: fixes A :: \"real mat\"\n  assumes A: \"A \\<in> carrier_mat n n\"\n  and nonneg: \"nonneg_mat A\"\n  and ev_le_1: \"\\<forall> x. poly (char_poly A) x = 0 \\<longrightarrow> x \\<le> 1\"\n  and ev_order: \"\\<forall> x :: complex. norm x = 1 \\<longrightarrow> order x (map_poly of_real (char_poly A)) \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "let ?cr = \"complex_of_real\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "let ?B = \"map_mat ?cr A\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "have B: \"?B \\<in> carrier_mat n n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom A \\<in> carrier_mat n n", "using A"], ["proof (prove)\nusing this:\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom A \\<in> carrier_mat n n", "by auto"], ["proof (state)\nthis:\n  of_real_hom.mat_hom A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "have rnn: \"real_nonneg_mat ?B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_nonneg_mat (of_real_hom.mat_hom A)", "using nonneg"], ["proof (prove)\nusing this:\n  nonneg_mat A\n\ngoal (1 subgoal):\n 1. real_nonneg_mat (of_real_hom.mat_hom A)", "unfolding real_nonneg_mat_def nonneg_mat_def"], ["proof (prove)\nusing this:\n  \\<forall>a\\<in>elements_mat A. 0 \\<le> a\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>elements_mat (of_real_hom.mat_hom A).\n       a \\<in> \\<real> \\<and> 0 \\<le> Re a", "by (auto simp: elements_mat_def)"], ["proof (state)\nthis:\n  real_nonneg_mat (of_real_hom.mat_hom A)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "have id: \"map_mat Re ?B = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. map_mat Re (of_real_hom.mat_hom A) = A", "by (rule eq_matI, auto)"], ["proof (state)\nthis:\n  map_mat Re (of_real_hom.mat_hom A) = A\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "have \"\\<exists>c1 c2. \\<forall>k. norm_bound (?B ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k.\n          norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n           (c1 + c2 * real k ^ (d - 1))", "by (rule perron_frobenius_spectral_radius_complex[OF B rnn], unfold id, \n    insert ev_le_1 ev_order, auto simp: of_real_hom.char_poly_hom[OF A])"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k.\n        norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n         (c1 + c2 * real k ^ (d - 1))\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "then"], ["proof (chain)\npicking this:\n  \\<exists>c1 c2.\n     \\<forall>k.\n        norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n         (c1 + c2 * real k ^ (d - 1))", "obtain c1 c2 where nb: \"\\<And> k. norm_bound (?B ^\\<^sub>m k) (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\nusing this:\n  \\<exists>c1 c2.\n     \\<forall>k.\n        norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n         (c1 + c2 * real k ^ (d - 1))\n\ngoal (1 subgoal):\n 1. (\\<And>c1 c2.\n        (\\<And>k.\n            norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n             (c1 + c2 * real k ^ (d - 1))) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  norm_bound (of_real_hom.mat_hom A ^\\<^sub>m ?k)\n   (c1 + c2 * real ?k ^ (d - 1))\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "proof (rule exI[of _ c1], rule exI[of _ c2], intro allI impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "fix k a"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "assume \"a \\<in> elements_mat (A ^\\<^sub>m k)\""], ["proof (state)\nthis:\n  a \\<in> elements_mat (A ^\\<^sub>m k)\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "with pow_carrier_mat[OF A]"], ["proof (chain)\npicking this:\n  A ^\\<^sub>m ?k \\<in> carrier_mat n n\n  a \\<in> elements_mat (A ^\\<^sub>m k)", "obtain i j where a: \"a = (A ^\\<^sub>m k) $$ (i,j)\" and ij: \"i < n\" \"j < n\""], ["proof (prove)\nusing this:\n  A ^\\<^sub>m ?k \\<in> carrier_mat n n\n  a \\<in> elements_mat (A ^\\<^sub>m k)\n\ngoal (1 subgoal):\n 1. (\\<And>i j.\n        \\<lbrakk>a = (A ^\\<^sub>m k) $$ (i, j); i < n; j < n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding elements_mat"], ["proof (prove)\nusing this:\n  A ^\\<^sub>m ?k \\<in> carrier_mat n n\n  a \\<in> {(A ^\\<^sub>m k) $$ (i, j) |i j.\n           i < dim_row (A ^\\<^sub>m k) \\<and> j < dim_col (A ^\\<^sub>m k)}\n\ngoal (1 subgoal):\n 1. (\\<And>i j.\n        \\<lbrakk>a = (A ^\\<^sub>m k) $$ (i, j); i < n; j < n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  a = (A ^\\<^sub>m k) $$ (i, j)\n  i < n\n  j < n\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "from ij nb[of k] A"], ["proof (chain)\npicking this:\n  i < n\n  j < n\n  norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n   (c1 + c2 * real k ^ (d - 1))\n  A \\<in> carrier_mat n n", "have \"norm ((?B ^\\<^sub>m k) $$ (i,j)) \\<le> c1 + c2 * real k ^ (d - 1)\""], ["proof (prove)\nusing this:\n  i < n\n  j < n\n  norm_bound (of_real_hom.mat_hom A ^\\<^sub>m k)\n   (c1 + c2 * real k ^ (d - 1))\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n    \\<le> c1 + c2 * real k ^ (d - 1)", "unfolding norm_bound_def"], ["proof (prove)\nusing this:\n  i < n\n  j < n\n  \\<forall>i j.\n     i < dim_row (of_real_hom.mat_hom A ^\\<^sub>m k) \\<longrightarrow>\n     j < dim_col (of_real_hom.mat_hom A ^\\<^sub>m k) \\<longrightarrow>\n     cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n     \\<le> c1 + c2 * real k ^ (d - 1)\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n    \\<le> c1 + c2 * real k ^ (d - 1)", "by auto"], ["proof (state)\nthis:\n  cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n  \\<le> c1 + c2 * real k ^ (d - 1)\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "also"], ["proof (state)\nthis:\n  cmod ((of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j))\n  \\<le> c1 + c2 * real k ^ (d - 1)\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "have \"(?B ^\\<^sub>m k) $$ (i,j) = ?cr a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j) = complex_of_real a", "unfolding of_real_hom.mat_hom_pow[OF A, symmetric] a"], ["proof (prove)\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom (A ^\\<^sub>m k) $$ (i, j) =\n    complex_of_real ((A ^\\<^sub>m k) $$ (i, j))", "using ij A"], ["proof (prove)\nusing this:\n  i < n\n  j < n\n  A \\<in> carrier_mat n n\n\ngoal (1 subgoal):\n 1. of_real_hom.mat_hom (A ^\\<^sub>m k) $$ (i, j) =\n    complex_of_real ((A ^\\<^sub>m k) $$ (i, j))", "by auto"], ["proof (state)\nthis:\n  (of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j) = complex_of_real a\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "also"], ["proof (state)\nthis:\n  (of_real_hom.mat_hom A ^\\<^sub>m k) $$ (i, j) = complex_of_real a\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "have \"norm (?cr a) = abs a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (complex_of_real a) = \\<bar>a\\<bar>", "by auto"], ["proof (state)\nthis:\n  cmod (complex_of_real a) = \\<bar>a\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>k a.\n       a \\<in> elements_mat (A ^\\<^sub>m k) \\<Longrightarrow>\n       \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "finally"], ["proof (chain)\npicking this:\n  \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "show \"abs a \\<le> (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\nusing this:\n  \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)\n\ngoal (1 subgoal):\n 1. \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "."], ["proof (state)\nthis:\n  \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>c1 c2.\n     \\<forall>k a.\n        a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n        \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>We can also convert the set-based lemma @{thm perron_frobenius_spectral_radius}\n  to a type-based version.\\<close>"], ["", "lemma perron_frobenius_spectral_type_based: \n  assumes \"non_neg_mat (A :: real ^ 'n ^ 'n)\"\n  and \"\\<forall> x. poly (charpoly A) x = 0 \\<longrightarrow> x \\<le> 1\"\n  and \"\\<forall> x :: complex. norm x = 1 \\<longrightarrow> order x (map_poly of_real (charpoly A)) \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat_h (matpow A k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat_h (matpow A k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "using assms perron_frobenius_spectral_radius"], ["proof (prove)\nusing this:\n  non_neg_mat A\n  \\<forall>x. poly (charpoly A) x = 0 \\<longrightarrow> x \\<le> 1\n  \\<forall>x.\n     cmod x = 1 \\<longrightarrow>\n     order x (map_poly complex_of_real (charpoly A)) \\<le> d\n  \\<lbrakk>?A \\<in> carrier_mat ?n ?n; nonneg_mat ?A;\n   \\<forall>x. poly (char_poly ?A) x = 0 \\<longrightarrow> x \\<le> 1;\n   \\<forall>x.\n      cmod x = 1 \\<longrightarrow>\n      order x (map_poly complex_of_real (char_poly ?A)) \\<le> ?d\\<rbrakk>\n  \\<Longrightarrow> \\<exists>c1 c2.\n                       \\<forall>k a.\n                          a \\<in> elements_mat\n                                   (?A ^\\<^sub>m k) \\<longrightarrow>\n                          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (?d - 1)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat_h (matpow A k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "by (transfer, blast)"], ["", "text \\<open>And of course, we can also transfer the type-based lemma back to a set-based setting, \n  only that -- without further case-analysis -- \n  we get the additional assumption @{term \"(n :: nat) \\<noteq> 0\"}.\\<close>"], ["", "lemma assumes \"A \\<in> carrier_mat n n\"\n  and \"nonneg_mat A\"\n  and \"\\<forall> x. poly (char_poly A) x = 0 \\<longrightarrow> x \\<le> 1\"\n  and \"\\<forall> x :: complex. norm x = 1 \\<longrightarrow> order x (map_poly of_real (char_poly A)) \\<le> d\"\n  and \"n \\<noteq> 0\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "using perron_frobenius_spectral_type_based[untransferred, cancel_card_constraint, OF assms]"], ["proof (prove)\nusing this:\n  \\<exists>c1 c2.\n     \\<forall>k a.\n        a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n        \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)\n\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "."], ["", "text \\<open>Note that the precondition eigenvalue-at-most-1 can easily be formulated as a cardinality\n  constraints which can be decided by Sturm's theorem. \n  And in order to obtain a bound on the order, one can \n  perform a square-free-factorization (via Yun's factorization algorithm) \n  of the characteristic polynomial into\n  $f_1^1 \\cdot \\ldots f_d^d$ where each $f_i$ has precisely the roots of order $i$.\\<close>"], ["", "context \n  fixes A :: \"real mat\" and c :: real and fis and n :: nat\n  assumes A: \"A \\<in> carrier_mat n n\"\n  and nonneg: \"nonneg_mat A\"\n  and yun: \"yun_factorization gcd (char_poly A) = (c,fis)\"\n  and ev_le_1: \"card {x. poly (char_poly A) x = 0 \\<and> x > 1} = 0\"\nbegin"], ["", "text \\<open>Note that @{const yun_factorization} has an offset by 1, \n  so the pair @{term \"(f\\<^sub>i,i) \\<in> set fis\"} encodes @{term \"f\\<^sub>i^(Suc i)\"}.\\<close>"], ["", "lemma perron_frobenius_spectral_radius_yun: \n  assumes bnd: \"\\<And> f\\<^sub>i i. (f\\<^sub>i,i) \\<in> set fis \n    \\<Longrightarrow> (\\<exists> x :: complex. poly (map_poly of_real f\\<^sub>i) x = 0 \\<and> norm x = 1) \n    \\<Longrightarrow> Suc i \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "proof (rule perron_frobenius_spectral_radius[OF A nonneg]; intro allI impI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "let ?cr = complex_of_real"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "let ?cp = \"map_poly ?cr (char_poly A)\""], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "fix x :: complex"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "assume x: \"norm x = 1\""], ["proof (state)\nthis:\n  cmod x = 1\n\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "have A0: \"char_poly A \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. char_poly A \\<noteq> 0", "using degree_monic_char_poly[OF A]"], ["proof (prove)\nusing this:\n  degree (char_poly A) = n \\<and> coeff (char_poly A) n = 1\n\ngoal (1 subgoal):\n 1. char_poly A \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  char_poly A \\<noteq> 0\n\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "interpret field_hom_0' ?cr"], ["proof (prove)\ngoal (1 subgoal):\n 1. field_hom_0' complex_of_real", "by (standard, auto)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "from A0"], ["proof (chain)\npicking this:\n  char_poly A \\<noteq> 0", "have cp0: \"?cp \\<noteq> 0\""], ["proof (prove)\nusing this:\n  char_poly A \\<noteq> 0\n\ngoal (1 subgoal):\n 1. map_poly complex_of_real (char_poly A) \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  map_poly complex_of_real (char_poly A) \\<noteq> 0\n\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "obtain ox where ox: \"order x ?cp = ox\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>ox.\n        order x (map_poly complex_of_real (char_poly A)) =\n        ox \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  order x (map_poly complex_of_real (char_poly A)) = ox\n\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "note sff = square_free_factorization_order_root[OF yun_factorization(1)[OF \n    yun_factorization_hom[of \"char_poly A\", unfolded yun map_prod_def split]] cp0, of x ox, unfolded ox]"], ["proof (state)\nthis:\n  (ox = ox) =\n  (ox = 0 \\<and>\n   (\\<forall>a j.\n       (a, j)\n       \\<in> set (map (\\<lambda>(f, y). (map_poly complex_of_real f, y))\n                   fis) \\<longrightarrow>\n       poly a x \\<noteq> 0) \\<or>\n   (\\<exists>a j.\n       (a, j)\n       \\<in> set (map (\\<lambda>(f, y). (map_poly complex_of_real f, y))\n                   fis) \\<and>\n       poly a x = 0 \\<and> ox = Suc j))\n\ngoal (2 subgoals):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1\n 2. \\<And>x.\n       cmod x = 1 \\<Longrightarrow>\n       order x (map_poly complex_of_real (char_poly A)) \\<le> d", "show \"order x ?cp \\<le> d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. order x (map_poly complex_of_real (char_poly A)) \\<le> d", "unfolding ox"], ["proof (prove)\ngoal (1 subgoal):\n 1. ox \\<le> d", "proof (cases ox)"], ["proof (state)\ngoal (2 subgoals):\n 1. ox = 0 \\<Longrightarrow> ox \\<le> d\n 2. \\<And>nat. ox = Suc nat \\<Longrightarrow> ox \\<le> d", "case (Suc oo)"], ["proof (state)\nthis:\n  ox = Suc oo\n\ngoal (2 subgoals):\n 1. ox = 0 \\<Longrightarrow> ox \\<le> d\n 2. \\<And>nat. ox = Suc nat \\<Longrightarrow> ox \\<le> d", "with sff"], ["proof (chain)\npicking this:\n  (ox = ox) =\n  (ox = 0 \\<and>\n   (\\<forall>a j.\n       (a, j)\n       \\<in> set (map (\\<lambda>(f, y). (map_poly complex_of_real f, y))\n                   fis) \\<longrightarrow>\n       poly a x \\<noteq> 0) \\<or>\n   (\\<exists>a j.\n       (a, j)\n       \\<in> set (map (\\<lambda>(f, y). (map_poly complex_of_real f, y))\n                   fis) \\<and>\n       poly a x = 0 \\<and> ox = Suc j))\n  ox = Suc oo", "obtain fi where mem: \"(fi,oo) \\<in> set fis\" and rt: \"poly (map_poly ?cr fi) x = 0\""], ["proof (prove)\nusing this:\n  (ox = ox) =\n  (ox = 0 \\<and>\n   (\\<forall>a j.\n       (a, j)\n       \\<in> set (map (\\<lambda>(f, y). (map_poly complex_of_real f, y))\n                   fis) \\<longrightarrow>\n       poly a x \\<noteq> 0) \\<or>\n   (\\<exists>a j.\n       (a, j)\n       \\<in> set (map (\\<lambda>(f, y). (map_poly complex_of_real f, y))\n                   fis) \\<and>\n       poly a x = 0 \\<and> ox = Suc j))\n  ox = Suc oo\n\ngoal (1 subgoal):\n 1. (\\<And>fi.\n        \\<lbrakk>(fi, oo) \\<in> set fis;\n         poly (map_poly complex_of_real fi) x = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  (fi, oo) \\<in> set fis\n  poly (map_poly complex_of_real fi) x = 0\n\ngoal (2 subgoals):\n 1. ox = 0 \\<Longrightarrow> ox \\<le> d\n 2. \\<And>nat. ox = Suc nat \\<Longrightarrow> ox \\<le> d", "from bnd[OF mem exI[of _ x], OF conjI[OF rt x]]"], ["proof (chain)\npicking this:\n  Suc oo \\<le> d", "show \"ox \\<le> d\""], ["proof (prove)\nusing this:\n  Suc oo \\<le> d\n\ngoal (1 subgoal):\n 1. ox \\<le> d", "unfolding Suc"], ["proof (prove)\nusing this:\n  Suc oo \\<le> d\n\ngoal (1 subgoal):\n 1. Suc oo \\<le> d", "."], ["proof (state)\nthis:\n  ox \\<le> d\n\ngoal (1 subgoal):\n 1. ox = 0 \\<Longrightarrow> ox \\<le> d", "qed auto"], ["proof (state)\nthis:\n  order x (map_poly complex_of_real (char_poly A)) \\<le> d\n\ngoal (1 subgoal):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1", "let ?L = \"{x. poly (char_poly A) x = 0 \\<and> x > 1}\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1", "fix x :: real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1", "assume rt: \"poly (char_poly A) x = 0\""], ["proof (state)\nthis:\n  poly (char_poly A) x = 0\n\ngoal (1 subgoal):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1", "have \"finite ?L\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {x. poly (char_poly A) x = 0 \\<and> 1 < x}", "by (rule finite_subset[OF _ poly_roots_finite[of \"char_poly A\"]],\n      insert degree_monic_char_poly[OF A], auto)"], ["proof (state)\nthis:\n  finite {x. poly (char_poly A) x = 0 \\<and> 1 < x}\n\ngoal (1 subgoal):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1", "with ev_le_1"], ["proof (chain)\npicking this:\n  card {x. poly (char_poly A) x = 0 \\<and> 1 < x} = 0\n  finite {x. poly (char_poly A) x = 0 \\<and> 1 < x}", "have \"?L = {}\""], ["proof (prove)\nusing this:\n  card {x. poly (char_poly A) x = 0 \\<and> 1 < x} = 0\n  finite {x. poly (char_poly A) x = 0 \\<and> 1 < x}\n\ngoal (1 subgoal):\n 1. {x. poly (char_poly A) x = 0 \\<and> 1 < x} = {}", "by simp"], ["proof (state)\nthis:\n  {x. poly (char_poly A) x = 0 \\<and> 1 < x} = {}\n\ngoal (1 subgoal):\n 1. \\<And>x. poly (char_poly A) x = 0 \\<Longrightarrow> x \\<le> 1", "with rt"], ["proof (chain)\npicking this:\n  poly (char_poly A) x = 0\n  {x. poly (char_poly A) x = 0 \\<and> 1 < x} = {}", "show \"x \\<le> 1\""], ["proof (prove)\nusing this:\n  poly (char_poly A) x = 0\n  {x. poly (char_poly A) x = 0 \\<and> 1 < x} = {}\n\ngoal (1 subgoal):\n 1. x \\<le> 1", "by auto"], ["proof (state)\nthis:\n  x \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>Note that the only remaining problem in applying \n  @{thm perron_frobenius_spectral_radius_yun} is to check the\n  condition @{term \"\\<exists> x :: complex. poly (map_poly of_real f\\<^sub>i) x = 0 \\<and> norm x = 1\"}.\n  Here, there are at least three possibilities.\n  First, one can just ignore this precondition and weaken the statement.\n  Second, one can apply Sturm's theorem to determine whether all roots are real.\n  This can be done by comparing the number of distinct real roots with the degree of @{term f\\<^sub>i},\n    since @{term f\\<^sub>i} is square-free. If all roots are real, then one can decide the criterion\n    by checking the only two possible real roots with norm equal to 1, namely 1 and -1.\n    If on the other hand there are complex roots, then we loose precision at this point.\n  Third, one uses a factorization algorithm (e.g., via complex algebraic numbers) to\n  precisely determine the complex roots and decide the condition.\n\n  The second approach is illustrated in the following theorem. Note that all preconditions --\n  including the ones from the context --\n  can easily be checked with the help of Sturm's method.\n  This method is used as a fast approximative technique in CeTA \\cite{CeTA}. Only if the desired degree\n  cannot be ensured by this method, the more costly complex algebraic number based \n  factorization is applied.\\<close>"], ["", "lemma perron_frobenius_spectral_radius_yun_real_roots: \n  assumes bnd: \"\\<And> f\\<^sub>i i. (f\\<^sub>i,i) \\<in> set fis \n    \\<Longrightarrow> card { x. poly f\\<^sub>i x = 0} \\<noteq> degree f\\<^sub>i \\<or> poly f\\<^sub>i 1 = 0 \\<or> poly f\\<^sub>i (-1) = 0 \n    \\<Longrightarrow> Suc i \\<le> d\"\n  shows \"\\<exists>c1 c2. \\<forall>k a. a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow> abs a \\<le> (c1 + c2 * real k ^ (d - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c1 c2.\n       \\<forall>k a.\n          a \\<in> elements_mat (A ^\\<^sub>m k) \\<longrightarrow>\n          \\<bar>a\\<bar> \\<le> c1 + c2 * real k ^ (d - 1)", "proof (rule perron_frobenius_spectral_radius_yun)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f\\<^sub>i i.\n       \\<lbrakk>(f\\<^sub>i, i) \\<in> set fis;\n        \\<exists>x.\n           poly (map_poly complex_of_real f\\<^sub>i) x = 0 \\<and>\n           cmod x = 1\\<rbrakk>\n       \\<Longrightarrow> Suc i \\<le> d", "fix fi i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f\\<^sub>i i.\n       \\<lbrakk>(f\\<^sub>i, i) \\<in> set fis;\n        \\<exists>x.\n           poly (map_poly complex_of_real f\\<^sub>i) x = 0 \\<and>\n           cmod x = 1\\<rbrakk>\n       \\<Longrightarrow> Suc i \\<le> d", "let ?cr = complex_of_real"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f\\<^sub>i i.\n       \\<lbrakk>(f\\<^sub>i, i) \\<in> set fis;\n        \\<exists>x.\n           poly (map_poly complex_of_real f\\<^sub>i) x = 0 \\<and>\n           cmod x = 1\\<rbrakk>\n       \\<Longrightarrow> Suc i \\<le> d", "let ?cp = \"map_poly ?cr\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f\\<^sub>i i.\n       \\<lbrakk>(f\\<^sub>i, i) \\<in> set fis;\n        \\<exists>x.\n           poly (map_poly complex_of_real f\\<^sub>i) x = 0 \\<and>\n           cmod x = 1\\<rbrakk>\n       \\<Longrightarrow> Suc i \\<le> d", "assume fi: \"(fi, i) \\<in> set fis\"\n    and \"\\<exists> x. poly (map_poly ?cr fi) x = 0 \\<and> norm x = 1\""], ["proof (state)\nthis:\n  (fi, i) \\<in> set fis\n  \\<exists>x. poly (map_poly complex_of_real fi) x = 0 \\<and> cmod x = 1\n\ngoal (1 subgoal):\n 1. \\<And>f\\<^sub>i i.\n       \\<lbrakk>(f\\<^sub>i, i) \\<in> set fis;\n        \\<exists>x.\n           poly (map_poly complex_of_real f\\<^sub>i) x = 0 \\<and>\n           cmod x = 1\\<rbrakk>\n       \\<Longrightarrow> Suc i \\<le> d", "then"], ["proof (chain)\npicking this:\n  (fi, i) \\<in> set fis\n  \\<exists>x. poly (map_poly complex_of_real fi) x = 0 \\<and> cmod x = 1", "obtain x where rt: \"poly (?cp fi) x = 0\" and x: \"norm x = 1\""], ["proof (prove)\nusing this:\n  (fi, i) \\<in> set fis\n  \\<exists>x. poly (map_poly complex_of_real fi) x = 0 \\<and> cmod x = 1\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>poly (map_poly complex_of_real fi) x = 0;\n         cmod x = 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  poly (map_poly complex_of_real fi) x = 0\n  cmod x = 1\n\ngoal (1 subgoal):\n 1. \\<And>f\\<^sub>i i.\n       \\<lbrakk>(f\\<^sub>i, i) \\<in> set fis;\n        \\<exists>x.\n           poly (map_poly complex_of_real f\\<^sub>i) x = 0 \\<and>\n           cmod x = 1\\<rbrakk>\n       \\<Longrightarrow> Suc i \\<le> d", "show \"Suc i \\<le> d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc i \\<le> d", "proof (rule bnd[OF fi])"], ["proof (state)\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "consider (c) \"x \\<notin> \\<real>\" | (1) \"x = 1\" | (m1) \"x = -1\" | (r) \"x \\<in> \\<real>\" \"x \\<notin> {1, -1}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<notin> \\<real> \\<Longrightarrow> thesis;\n     x = 1 \\<Longrightarrow> thesis; x = - 1 \\<Longrightarrow> thesis;\n     \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n     \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by (cases \"x \\<in> \\<real>\"; auto)"], ["proof (state)\nthis:\n  \\<lbrakk>x \\<notin> \\<real> \\<Longrightarrow> ?thesis;\n   x = 1 \\<Longrightarrow> ?thesis; x = - 1 \\<Longrightarrow> ?thesis;\n   \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n   \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "thus \"card {x. poly fi x = 0} \\<noteq> degree fi \\<or> poly fi 1 = 0 \\<or> poly fi (- 1) = 0\""], ["proof (prove)\nusing this:\n  \\<lbrakk>x \\<notin> \\<real> \\<Longrightarrow> ?thesis;\n   x = 1 \\<Longrightarrow> ?thesis; x = - 1 \\<Longrightarrow> ?thesis;\n   \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n   \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "proof (cases)"], ["proof (state)\ngoal (4 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 4. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "case 1"], ["proof (state)\nthis:\n  x = 1\n\ngoal (4 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 4. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "from rt"], ["proof (chain)\npicking this:\n  poly (map_poly complex_of_real fi) x = 0", "have \"poly fi 1 = 0\""], ["proof (prove)\nusing this:\n  poly (map_poly complex_of_real fi) x = 0\n\ngoal (1 subgoal):\n 1. poly fi 1 = 0", "unfolding 1"], ["proof (prove)\nusing this:\n  poly (map_poly complex_of_real fi) 1 = 0\n\ngoal (1 subgoal):\n 1. poly fi 1 = 0", "by simp"], ["proof (state)\nthis:\n  poly fi 1 = 0\n\ngoal (4 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 4. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  poly fi 1 = 0\n\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "by simp"], ["proof (state)\nthis:\n  card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n  poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n\ngoal (3 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "case m1"], ["proof (state)\nthis:\n  x = - 1\n\ngoal (3 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "have id: \"-1 = ?cr (-1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - 1 = complex_of_real (- 1)", "by simp"], ["proof (state)\nthis:\n  - 1 = complex_of_real (- 1)\n\ngoal (3 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "from rt"], ["proof (chain)\npicking this:\n  poly (map_poly complex_of_real fi) x = 0", "have \"poly fi (-1) = 0\""], ["proof (prove)\nusing this:\n  poly (map_poly complex_of_real fi) x = 0\n\ngoal (1 subgoal):\n 1. poly fi (- 1) = 0", "unfolding m1 id of_real_hom.hom_zero[where 'a=complex,symmetric] of_real_hom.poly_map_poly"], ["proof (prove)\nusing this:\n  complex_of_real (poly fi (- 1)) = complex_of_real 0\n\ngoal (1 subgoal):\n 1. poly fi (- 1) = 0", "by simp"], ["proof (state)\nthis:\n  poly fi (- 1) = 0\n\ngoal (3 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. x = - 1 \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 3. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  poly fi (- 1) = 0\n\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "by simp"], ["proof (state)\nthis:\n  card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n  poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n\ngoal (2 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "case r"], ["proof (state)\nthis:\n  x \\<in> \\<real>\n  x \\<notin> {1, - 1}\n\ngoal (2 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "then"], ["proof (chain)\npicking this:\n  x \\<in> \\<real>\n  x \\<notin> {1, - 1}", "obtain y where xy: \"x = of_real y\""], ["proof (prove)\nusing this:\n  x \\<in> \\<real>\n  x \\<notin> {1, - 1}\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        x = complex_of_real y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding Reals_def"], ["proof (prove)\nusing this:\n  x \\<in> range complex_of_real\n  x \\<notin> {1, - 1}\n\ngoal (1 subgoal):\n 1. (\\<And>y.\n        x = complex_of_real y \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x = complex_of_real y\n\ngoal (2 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "from r(2)[unfolded xy]"], ["proof (chain)\npicking this:\n  complex_of_real y \\<notin> {1, - 1}", "have y: \"y \\<notin> {1,-1}\""], ["proof (prove)\nusing this:\n  complex_of_real y \\<notin> {1, - 1}\n\ngoal (1 subgoal):\n 1. y \\<notin> {1, - 1}", "by auto"], ["proof (state)\nthis:\n  y \\<notin> {1, - 1}\n\ngoal (2 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "from x[unfolded xy]"], ["proof (chain)\npicking this:\n  cmod (complex_of_real y) = 1", "have \"abs y = 1\""], ["proof (prove)\nusing this:\n  cmod (complex_of_real y) = 1\n\ngoal (1 subgoal):\n 1. \\<bar>y\\<bar> = 1", "by auto"], ["proof (state)\nthis:\n  \\<bar>y\\<bar> = 1\n\ngoal (2 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "with y"], ["proof (chain)\npicking this:\n  y \\<notin> {1, - 1}\n  \\<bar>y\\<bar> = 1", "have False"], ["proof (prove)\nusing this:\n  y \\<notin> {1, - 1}\n  \\<bar>y\\<bar> = 1\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal (2 subgoals):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n 2. \\<lbrakk>x \\<in> \\<real>; x \\<notin> {1, - 1}\\<rbrakk>\n    \\<Longrightarrow> card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n                      poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  False\n\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", ".."], ["proof (state)\nthis:\n  card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n  poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "case c"], ["proof (state)\nthis:\n  x \\<notin> \\<real>\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "from yun_factorization(2)[OF yun] fi"], ["proof (chain)\npicking this:\n  (?b, ?i) \\<in> set (snd (c, fis)) \\<Longrightarrow> monic ?b\n  (fi, i) \\<in> set fis", "have \"monic fi\""], ["proof (prove)\nusing this:\n  (?b, ?i) \\<in> set (snd (c, fis)) \\<Longrightarrow> monic ?b\n  (fi, i) \\<in> set fis\n\ngoal (1 subgoal):\n 1. monic fi", "by auto"], ["proof (state)\nthis:\n  monic fi\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "hence fi: \"?cp fi \\<noteq> 0\""], ["proof (prove)\nusing this:\n  monic fi\n\ngoal (1 subgoal):\n 1. map_poly complex_of_real fi \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  map_poly complex_of_real fi \\<noteq> 0\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "hence fin: \"finite {x. poly (?cp fi) x = 0}\""], ["proof (prove)\nusing this:\n  map_poly complex_of_real fi \\<noteq> 0\n\ngoal (1 subgoal):\n 1. finite {x. poly (map_poly complex_of_real fi) x = 0}", "by (rule poly_roots_finite)"], ["proof (state)\nthis:\n  finite {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "have \"?cr ` {x. poly (?cp fi) (?cr x) = 0} \\<subset> {x. poly (?cp fi) x = 0}\" (is \"?l \\<subset> ?r\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0}\n    \\<subset> {x. poly (map_poly complex_of_real fi) x = 0}", "proof (rule, force)"], ["proof (state)\ngoal (1 subgoal):\n 1. complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} \\<noteq>\n    {x. poly (map_poly complex_of_real fi) x = 0}", "have \"x \\<in> ?r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {x. poly (map_poly complex_of_real fi) x = 0}", "using rt"], ["proof (prove)\nusing this:\n  poly (map_poly complex_of_real fi) x = 0\n\ngoal (1 subgoal):\n 1. x \\<in> {x. poly (map_poly complex_of_real fi) x = 0}", "by auto"], ["proof (state)\nthis:\n  x \\<in> {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal (1 subgoal):\n 1. complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} \\<noteq>\n    {x. poly (map_poly complex_of_real fi) x = 0}", "moreover"], ["proof (state)\nthis:\n  x \\<in> {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal (1 subgoal):\n 1. complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} \\<noteq>\n    {x. poly (map_poly complex_of_real fi) x = 0}", "have \"x \\<notin> ?l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<notin> complex_of_real `\n               {x. poly (map_poly complex_of_real fi) (complex_of_real x) =\n                   0}", "using c"], ["proof (prove)\nusing this:\n  x \\<notin> \\<real>\n\ngoal (1 subgoal):\n 1. x \\<notin> complex_of_real `\n               {x. poly (map_poly complex_of_real fi) (complex_of_real x) =\n                   0}", "unfolding Reals_def"], ["proof (prove)\nusing this:\n  x \\<notin> range complex_of_real\n\ngoal (1 subgoal):\n 1. x \\<notin> complex_of_real `\n               {x. poly (map_poly complex_of_real fi) (complex_of_real x) =\n                   0}", "by auto"], ["proof (state)\nthis:\n  x \\<notin> complex_of_real `\n             {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0}\n\ngoal (1 subgoal):\n 1. complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} \\<noteq>\n    {x. poly (map_poly complex_of_real fi) x = 0}", "ultimately"], ["proof (chain)\npicking this:\n  x \\<in> {x. poly (map_poly complex_of_real fi) x = 0}\n  x \\<notin> complex_of_real `\n             {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0}", "show \"?l \\<noteq> ?r\""], ["proof (prove)\nusing this:\n  x \\<in> {x. poly (map_poly complex_of_real fi) x = 0}\n  x \\<notin> complex_of_real `\n             {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0}\n\ngoal (1 subgoal):\n 1. complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} \\<noteq>\n    {x. poly (map_poly complex_of_real fi) x = 0}", "by blast"], ["proof (state)\nthis:\n  complex_of_real `\n  {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} \\<noteq>\n  {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  complex_of_real `\n  {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0}\n  \\<subset> {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "from psubset_card_mono[OF fin this]"], ["proof (chain)\npicking this:\n  card\n   (complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0})\n  < card {x. poly (map_poly complex_of_real fi) x = 0}", "have \"card ?l < card ?r\""], ["proof (prove)\nusing this:\n  card\n   (complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0})\n  < card {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal (1 subgoal):\n 1. card\n     (complex_of_real `\n      {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0})\n    < card {x. poly (map_poly complex_of_real fi) x = 0}", "."], ["proof (state)\nthis:\n  card\n   (complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0})\n  < card {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "also"], ["proof (state)\nthis:\n  card\n   (complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0})\n  < card {x. poly (map_poly complex_of_real fi) x = 0}\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "have \"\\<dots> \\<le> degree (?cp fi)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card {x. poly (map_poly complex_of_real fi) x = 0}\n    \\<le> degree (map_poly complex_of_real fi)", "by (rule poly_roots_degree[OF fi])"], ["proof (state)\nthis:\n  card {x. poly (map_poly complex_of_real fi) x = 0}\n  \\<le> degree (map_poly complex_of_real fi)\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "also"], ["proof (state)\nthis:\n  card {x. poly (map_poly complex_of_real fi) x = 0}\n  \\<le> degree (map_poly complex_of_real fi)\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "have \"\\<dots> = degree fi\""], ["proof (prove)\ngoal (1 subgoal):\n 1. degree (map_poly complex_of_real fi) = degree fi", "by simp"], ["proof (state)\nthis:\n  degree (map_poly complex_of_real fi) = degree fi\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "also"], ["proof (state)\nthis:\n  degree (map_poly complex_of_real fi) = degree fi\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "have \"?l = ?cr ` {x. poly fi x = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real `\n    {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} =\n    complex_of_real ` {x. poly fi x = 0}", "by auto"], ["proof (state)\nthis:\n  complex_of_real `\n  {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} =\n  complex_of_real ` {x. poly fi x = 0}\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "also"], ["proof (state)\nthis:\n  complex_of_real `\n  {x. poly (map_poly complex_of_real fi) (complex_of_real x) = 0} =\n  complex_of_real ` {x. poly fi x = 0}\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "have \"card \\<dots> = card {x. poly fi x = 0}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card (complex_of_real ` {x. poly fi x = 0}) = card {x. poly fi x = 0}", "by (rule card_image, auto simp: inj_on_def)"], ["proof (state)\nthis:\n  card (complex_of_real ` {x. poly fi x = 0}) = card {x. poly fi x = 0}\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "finally"], ["proof (chain)\npicking this:\n  card {x. poly fi x = 0} < degree fi", "have \"card {x. poly fi x = 0} \\<noteq> degree fi\""], ["proof (prove)\nusing this:\n  card {x. poly fi x = 0} < degree fi\n\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi", "by simp"], ["proof (state)\nthis:\n  card {x. poly fi x = 0} \\<noteq> degree fi\n\ngoal (1 subgoal):\n 1. x \\<notin> \\<real> \\<Longrightarrow>\n    card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  card {x. poly fi x = 0} \\<noteq> degree fi\n\ngoal (1 subgoal):\n 1. card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n    poly fi 1 = 0 \\<or> poly fi (- 1) = 0", "by auto"], ["proof (state)\nthis:\n  card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n  poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  card {x. poly fi x = 0} \\<noteq> degree fi \\<or>\n  poly fi 1 = 0 \\<or> poly fi (- 1) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Suc i \\<le> d\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "thm perron_frobenius_spectral_radius_yun_real_roots"], ["", "end"]]}