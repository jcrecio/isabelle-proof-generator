{"file_name": "/home/qj213/afp-2021-10-22/thys/Perron_Frobenius/Perron_Frobenius.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Perron_Frobenius", "problem_names": ["lemma max_v_ev:\n  \"eigen_vector A max_v max_ev\"\n  \"norm max_ev = sr\"\n  \"norm1 max_v = 1\"", "lemma closedS: \"closed S\"", "lemma boundedS: \"bounded S\"", "lemma compactS: \"compact S\"", "lemmas rnn = real_non_neg_matD[OF rnnA]", "lemma B_norm: \"B $ i $ j = norm (A $ i $ j)\"", "lemma mult_B_mono: assumes \"\\<And> i. v $ i \\<ge> w $ i\"\n  shows \"(B *v v) $ i \\<ge> (B *v w) $ i\"", "lemma non_emptyS: \"S \\<noteq> {}\"", "lemma convexS: \"convex S\"", "lemma rv_0: \"(rv v = 0) = (v = 0)\"", "lemma rv_mult: \"A *v rv v = rv (B *v v)\"", "lemma normB_S: assumes v: \"v \\<in> S\"\n  shows \"norm1 (B *v v) \\<noteq> 0\"", "lemma image_f: \"f ` S \\<subseteq> S\"", "lemma cont_f: \"continuous_on S f\"", "lemma perron_frobenius_positive_ev:\n  \"\\<exists> v. eigen_vector A v (r sr) \\<and> real_non_neg_vec v\"", "lemma perron_frobenius_both:\n  \"\\<exists> v. eigen_vector A v (r sr) \\<and> real_non_neg_vec v\"", "lemma perron_frobenius:\n  assumes \"real_non_neg_mat A\"\n  shows \"\\<exists>v. eigen_vector A v (of_real (spectral_radius A)) \\<and> real_non_neg_vec v\"", "lemma perron_frobenius_eigen_value:\n  assumes \"real_non_neg_mat A\"\n  shows \"eigen_value A (of_real (spectral_radius A))\""], "translations": [["", "lemma max_v_ev:\n  \"eigen_vector A max_v max_ev\"\n  \"norm max_ev = sr\"\n  \"norm1 max_v = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eigen_vector A max_v max_ev &&&\n    cmod max_ev = HMA_Connect.spectral_radius A &&& norm1 max_v = 1", "proof -"], ["proof (state)\ngoal (3 subgoals):\n 1. eigen_vector A max_v max_ev\n 2. cmod max_ev = HMA_Connect.spectral_radius A\n 3. norm1 max_v = 1", "obtain v ev where id: \"max_v_ev = (v,ev)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>v ev.\n        max_v_ev = (v, ev) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by force"], ["proof (state)\nthis:\n  max_v_ev = (v, ev)\n\ngoal (3 subgoals):\n 1. eigen_vector A max_v max_ev\n 2. cmod max_ev = HMA_Connect.spectral_radius A\n 3. norm1 max_v = 1", "from spectral_radius_ev[of A] someI_ex[of \"\\<lambda> v_ev. eigen_vector A (fst v_ev) (snd v_ev)\n  \\<and> norm (snd v_ev) = sr\", folded max_v_ev_def, unfolded id]"], ["proof (chain)\npicking this:\n  \\<exists>ev v.\n     eigen_vector A v ev \\<and> cmod ev = HMA_Connect.spectral_radius A\n  \\<exists>x.\n     eigen_vector A (fst x) (snd x) \\<and>\n     cmod (snd x) = HMA_Connect.spectral_radius A \\<Longrightarrow>\n  eigen_vector A (fst (v, ev)) (snd (v, ev)) \\<and>\n  cmod (snd (v, ev)) = HMA_Connect.spectral_radius A", "have v: \"eigen_vector A v ev\" and ev: \"norm ev = sr\""], ["proof (prove)\nusing this:\n  \\<exists>ev v.\n     eigen_vector A v ev \\<and> cmod ev = HMA_Connect.spectral_radius A\n  \\<exists>x.\n     eigen_vector A (fst x) (snd x) \\<and>\n     cmod (snd x) = HMA_Connect.spectral_radius A \\<Longrightarrow>\n  eigen_vector A (fst (v, ev)) (snd (v, ev)) \\<and>\n  cmod (snd (v, ev)) = HMA_Connect.spectral_radius A\n\ngoal (1 subgoal):\n 1. eigen_vector A v ev &&& cmod ev = HMA_Connect.spectral_radius A", "by auto"], ["proof (state)\nthis:\n  eigen_vector A v ev\n  cmod ev = HMA_Connect.spectral_radius A\n\ngoal (3 subgoals):\n 1. eigen_vector A max_v max_ev\n 2. cmod max_ev = HMA_Connect.spectral_radius A\n 3. norm1 max_v = 1", "from normalize_eigen_vector[OF v] ev"], ["proof (chain)\npicking this:\n  eigen_vector A ((1 / norm1 v) *\\<^sub>R v) ev\n  norm1 ((1 / norm1 v) *\\<^sub>R v) = 1\n  cmod ev = HMA_Connect.spectral_radius A", "show \"eigen_vector A max_v max_ev\" \"norm max_ev = sr\" \"norm1 max_v = 1\""], ["proof (prove)\nusing this:\n  eigen_vector A ((1 / norm1 v) *\\<^sub>R v) ev\n  norm1 ((1 / norm1 v) *\\<^sub>R v) = 1\n  cmod ev = HMA_Connect.spectral_radius A\n\ngoal (1 subgoal):\n 1. eigen_vector A max_v max_ev &&&\n    cmod max_ev = HMA_Connect.spectral_radius A &&& norm1 max_v = 1", "unfolding max_v_def max_ev_def id"], ["proof (prove)\nusing this:\n  eigen_vector A ((1 / norm1 v) *\\<^sub>R v) ev\n  norm1 ((1 / norm1 v) *\\<^sub>R v) = 1\n  cmod ev = HMA_Connect.spectral_radius A\n\ngoal (1 subgoal):\n 1. eigen_vector A ((1 / norm1 (fst (v, ev))) *\\<^sub>R fst (v, ev))\n     (snd (v, ev)) &&&\n    cmod (snd (v, ev)) = HMA_Connect.spectral_radius A &&&\n    norm1 ((1 / norm1 (fst (v, ev))) *\\<^sub>R fst (v, ev)) = 1", "by auto"], ["proof (state)\nthis:\n  eigen_vector A max_v max_ev\n  cmod max_ev = HMA_Connect.spectral_radius A\n  norm1 max_v = 1\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>In the definition of S, we use the linear norm instead of the\n  default euclidean norm which is defined via the type-class.\n  The reason is that S is not convex if one uses the euclidean norm.\\<close>"], ["", "private"], ["", "definition B :: \"real ^ 'n ^ 'n\" where \"B \\<equiv> \\<chi> i j. Re (A $ i $ j)\""], ["", "private"], ["", "definition S where \"S = {v :: real ^ 'n . norm1 v = 1 \\<and> (\\<forall> i. v $ i \\<ge> 0) \\<and>\n  (\\<forall> i. (B *v v) $ i \\<ge> sr * (v $ i))}\""], ["", "private"], ["", "definition f :: \"real ^ 'n \\<Rightarrow> real ^ 'n\" where\n  \"f v = (1 / norm1 (B *v v)) *\\<^sub>R (B *v v)\""], ["", "private"], ["", "lemma closedS: \"closed S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. closed S", "unfolding S_def matrix_vector_mult_def[abs_def]"], ["proof (prove)\ngoal (1 subgoal):\n 1. closed\n     {v. norm1 v = 1 \\<and>\n         (\\<forall>i. 0 \\<le> v $h i) \\<and>\n         (\\<forall>i.\n             HMA_Connect.spectral_radius A * v $h i\n             \\<le> (\\<chi>i. \\<Sum>j\\<in>UNIV. B $h i $h j * v $h j) $h i)}", "proof (intro closed_Collect_conj closed_Collect_all closed_Collect_le closed_Collect_eq)"], ["proof (state)\ngoal (6 subgoals):\n 1. continuous_on UNIV norm1\n 2. continuous_on UNIV (\\<lambda>x. 1)\n 3. \\<And>i. continuous_on UNIV (\\<lambda>x. 0)\n 4. \\<And>i. continuous_on UNIV (\\<lambda>x. x $h i)\n 5. \\<And>i.\n       continuous_on UNIV\n        (\\<lambda>x. HMA_Connect.spectral_radius A * x $h i)\n 6. \\<And>i.\n       continuous_on UNIV\n        (\\<lambda>x. (\\<chi>i. \\<Sum>j\\<in>UNIV. B $h i $h j * x $h j) $h i)", "show \"continuous_on UNIV norm1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on UNIV norm1", "by (simp add: continuous_at_imp_continuous_on)"], ["proof (state)\nthis:\n  continuous_on UNIV norm1\n\ngoal (5 subgoals):\n 1. continuous_on UNIV (\\<lambda>x. 1)\n 2. \\<And>i. continuous_on UNIV (\\<lambda>x. 0)\n 3. \\<And>i. continuous_on UNIV (\\<lambda>x. x $h i)\n 4. \\<And>i.\n       continuous_on UNIV\n        (\\<lambda>x. HMA_Connect.spectral_radius A * x $h i)\n 5. \\<And>i.\n       continuous_on UNIV\n        (\\<lambda>x. (\\<chi>i. \\<Sum>j\\<in>UNIV. B $h i $h j * x $h j) $h i)", "qed (auto intro!: continuous_intros continuous_on_component)"], ["", "private"], ["", "lemma boundedS: \"bounded S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bounded S", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. bounded S", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. bounded S", "fix v :: \"real ^ 'n\""], ["proof (state)\ngoal (1 subgoal):\n 1. bounded S", "from norm1_ge_norm[of v]"], ["proof (chain)\npicking this:\n  norm v \\<le> norm1 v", "have \"norm1 v = 1 \\<Longrightarrow> norm v \\<le> 1\""], ["proof (prove)\nusing this:\n  norm v \\<le> norm1 v\n\ngoal (1 subgoal):\n 1. norm1 v = 1 \\<Longrightarrow> norm v \\<le> 1", "by auto"], ["proof (state)\nthis:\n  norm1 v = 1 \\<Longrightarrow> norm v \\<le> 1\n\ngoal (1 subgoal):\n 1. bounded S", "}"], ["proof (state)\nthis:\n  norm1 ?v2 = 1 \\<Longrightarrow> norm ?v2 \\<le> 1\n\ngoal (1 subgoal):\n 1. bounded S", "thus ?thesis"], ["proof (prove)\nusing this:\n  norm1 ?v2 = 1 \\<Longrightarrow> norm ?v2 \\<le> 1\n\ngoal (1 subgoal):\n 1. bounded S", "unfolding S_def bounded_iff"], ["proof (prove)\nusing this:\n  norm1 ?v2 = 1 \\<Longrightarrow> norm ?v2 \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>a.\n       \\<forall>x\\<in>{v. norm1 v = 1 \\<and>\n                          (\\<forall>i. 0 \\<le> v $h i) \\<and>\n                          (\\<forall>i.\n                              HMA_Connect.spectral_radius A * v $h i\n                              \\<le> (B *v v) $h i)}.\n          norm x \\<le> a", "by (auto intro!: exI[of _ 1])"], ["proof (state)\nthis:\n  bounded S\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma compactS: \"compact S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. compact S", "using boundedS closedS"], ["proof (prove)\nusing this:\n  bounded S\n  closed S\n\ngoal (1 subgoal):\n 1. compact S", "by (simp add: compact_eq_bounded_closed)"], ["", "private"], ["", "lemmas rnn = real_non_neg_matD[OF rnnA]"], ["", "lemma B_norm: \"B $ i $ j = norm (A $ i $ j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B $h i $h j = cmod (A $h i $h j)", "using rnn[of i j]"], ["proof (prove)\nusing this:\n  A $h i $h j \\<in> \\<real>\n  0 \\<le> Re (A $h i $h j)\n\ngoal (1 subgoal):\n 1. B $h i $h j = cmod (A $h i $h j)", "by (cases \"A $ i $ j\", auto simp: B_def)"], ["", "lemma mult_B_mono: assumes \"\\<And> i. v $ i \\<ge> w $ i\"\n  shows \"(B *v v) $ i \\<ge> (B *v w) $ i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (B *v w) $h i \\<le> (B *v v) $h i", "unfolding matrix_vector_mult_def vec_lambda_beta"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j\\<in>UNIV. B $h i $h j * w $h j)\n    \\<le> (\\<Sum>j\\<in>UNIV. B $h i $h j * v $h j)", "by (rule sum_mono, rule mult_left_mono[OF assms], unfold B_norm, auto)"], ["", "private"], ["", "lemma non_emptyS: \"S \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "let ?v = \"(\\<chi> i. norm (max_v $ i)) :: real ^ 'n\""], ["proof (state)\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "have \"norm1 max_v = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm1 max_v = 1", "by (rule max_v_ev(3))"], ["proof (state)\nthis:\n  norm1 max_v = 1\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "hence nv: \"norm1 ?v = 1\""], ["proof (prove)\nusing this:\n  norm1 max_v = 1\n\ngoal (1 subgoal):\n 1. norm1 (\\<chi>i. cmod (max_v $h i)) = 1", "unfolding norm1_def"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>UNIV. cmod (max_v $h i)) = 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. norm ((\\<chi>i. cmod (max_v $h i)) $h i)) = 1", "by auto"], ["proof (state)\nthis:\n  norm1 (\\<chi>i. cmod (max_v $h i)) = 1\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "{"], ["proof (state)\nthis:\n  norm1 (\\<chi>i. cmod (max_v $h i)) = 1\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "have \"sr * (?v $ i) = sr * norm (max_v $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h i =\n    HMA_Connect.spectral_radius A * cmod (max_v $h i)", "by auto"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h i =\n  HMA_Connect.spectral_radius A * cmod (max_v $h i)\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "also"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h i =\n  HMA_Connect.spectral_radius A * cmod (max_v $h i)\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "have \"\\<dots> = (norm max_ev) * norm (max_v $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A * cmod (max_v $h i) =\n    cmod max_ev * cmod (max_v $h i)", "using max_v_ev"], ["proof (prove)\nusing this:\n  eigen_vector A max_v max_ev\n  cmod max_ev = HMA_Connect.spectral_radius A\n  norm1 max_v = 1\n\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A * cmod (max_v $h i) =\n    cmod max_ev * cmod (max_v $h i)", "by auto"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * cmod (max_v $h i) =\n  cmod max_ev * cmod (max_v $h i)\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "also"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * cmod (max_v $h i) =\n  cmod max_ev * cmod (max_v $h i)\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "have \"\\<dots> = norm ((max_ev *s max_v) $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod max_ev * cmod (max_v $h i) = cmod ((max_ev *s max_v) $h i)", "by (auto simp: norm_mult)"], ["proof (state)\nthis:\n  cmod max_ev * cmod (max_v $h i) = cmod ((max_ev *s max_v) $h i)\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "also"], ["proof (state)\nthis:\n  cmod max_ev * cmod (max_v $h i) = cmod ((max_ev *s max_v) $h i)\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "have \"max_ev *s max_v = A *v max_v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. max_ev *s max_v = A *v max_v", "using max_v_ev(1)[unfolded eigen_vector_def]"], ["proof (prove)\nusing this:\n  max_v \\<noteq> 0 \\<and> A *v max_v = max_ev *s max_v\n\ngoal (1 subgoal):\n 1. max_ev *s max_v = A *v max_v", "by auto"], ["proof (state)\nthis:\n  max_ev *s max_v = A *v max_v\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "also"], ["proof (state)\nthis:\n  max_ev *s max_v = A *v max_v\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "have \"norm ((A *v max_v) $ i) \\<le> (B *v ?v) $ i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod ((A *v max_v) $h i) \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h i", "unfolding matrix_vector_mult_def vec_lambda_beta"], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (\\<Sum>j\\<in>UNIV. A $h i $h j * max_v $h j)\n    \\<le> (\\<Sum>j\\<in>UNIV. B $h i $h j * cmod (max_v $h j))", "by (rule sum_norm_le, auto simp: norm_mult B_norm)"], ["proof (state)\nthis:\n  cmod ((A *v max_v) $h i) \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h i\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "finally"], ["proof (chain)\npicking this:\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h i\n  \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h i", "have \"sr * (?v $ i) \\<le> (B *v ?v) $ i\""], ["proof (prove)\nusing this:\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h i\n  \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h i\n\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h i\n    \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h i", "."], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h i\n  \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h i\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "}"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h ?i2\n  \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h ?i2\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "note le = this"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h ?i2\n  \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h ?i2\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "have \"?v \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i. cmod (max_v $h i)) \\<in> S", "unfolding S_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i. cmod (max_v $h i))\n    \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}", "using nv le"], ["proof (prove)\nusing this:\n  norm1 (\\<chi>i. cmod (max_v $h i)) = 1\n  HMA_Connect.spectral_radius A * (\\<chi>i. cmod (max_v $h i)) $h ?i2\n  \\<le> (B *v (\\<chi>i. cmod (max_v $h i))) $h ?i2\n\ngoal (1 subgoal):\n 1. (\\<chi>i. cmod (max_v $h i))\n    \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}", "by auto"], ["proof (state)\nthis:\n  (\\<chi>i. cmod (max_v $h i)) \\<in> S\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<chi>i. cmod (max_v $h i)) \\<in> S\n\ngoal (1 subgoal):\n 1. S \\<noteq> {}", "by blast"], ["proof (state)\nthis:\n  S \\<noteq> {}\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma convexS: \"convex S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. convex S", "proof (rule convexI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "fix v w a b"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "assume *: \"v \\<in> S\" \"w \\<in> S\" \"0 \\<le> a\" \"0 \\<le> b\" \"a + b = (1 :: real)\""], ["proof (state)\nthis:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "let ?lin = \"a *\\<^sub>R v + b *\\<^sub>R w\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "from *"], ["proof (chain)\npicking this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1", "have 1: \"norm1 v = 1\" \"norm1 w = 1\""], ["proof (prove)\nusing this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. norm1 v = 1 &&& norm1 w = 1", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  w \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. norm1 v = 1 &&& norm1 w = 1", "by auto"], ["proof (state)\nthis:\n  norm1 v = 1\n  norm1 w = 1\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "have \"norm1 ?lin = a * norm1 v + b * norm1 w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = a * norm1 v + b * norm1 w", "unfolding norm1_def sum_distrib_left sum.distrib[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>UNIV. norm ((a *\\<^sub>R v + b *\\<^sub>R w) $h i)) =\n    (\\<Sum>x\\<in>UNIV. a * norm (v $h x) + b * norm (w $h x))", "proof (rule sum.cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. UNIV = UNIV\n 2. \\<And>x.\n       x \\<in> UNIV \\<Longrightarrow>\n       norm ((a *\\<^sub>R v + b *\\<^sub>R w) $h x) =\n       a * norm (v $h x) + b * norm (w $h x)", "fix i :: 'n"], ["proof (state)\ngoal (2 subgoals):\n 1. UNIV = UNIV\n 2. \\<And>x.\n       x \\<in> UNIV \\<Longrightarrow>\n       norm ((a *\\<^sub>R v + b *\\<^sub>R w) $h x) =\n       a * norm (v $h x) + b * norm (w $h x)", "from *"], ["proof (chain)\npicking this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1", "have \"v $ i \\<ge> 0\" \"w $ i \\<ge> 0\""], ["proof (prove)\nusing this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i &&& 0 \\<le> w $h i", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  w \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i &&& 0 \\<le> w $h i", "by auto"], ["proof (state)\nthis:\n  0 \\<le> v $h i\n  0 \\<le> w $h i\n\ngoal (2 subgoals):\n 1. UNIV = UNIV\n 2. \\<And>x.\n       x \\<in> UNIV \\<Longrightarrow>\n       norm ((a *\\<^sub>R v + b *\\<^sub>R w) $h x) =\n       a * norm (v $h x) + b * norm (w $h x)", "thus \"norm (?lin $ i) = a * norm (v $ i) + b * norm (w $ i)\""], ["proof (prove)\nusing this:\n  0 \\<le> v $h i\n  0 \\<le> w $h i\n\ngoal (1 subgoal):\n 1. norm ((a *\\<^sub>R v + b *\\<^sub>R w) $h i) =\n    a * norm (v $h i) + b * norm (w $h i)", "using *(3-4)"], ["proof (prove)\nusing this:\n  0 \\<le> v $h i\n  0 \\<le> w $h i\n  0 \\<le> a\n  0 \\<le> b\n\ngoal (1 subgoal):\n 1. norm ((a *\\<^sub>R v + b *\\<^sub>R w) $h i) =\n    a * norm (v $h i) + b * norm (w $h i)", "by auto"], ["proof (state)\nthis:\n  norm ((a *\\<^sub>R v + b *\\<^sub>R w) $h i) =\n  a * norm (v $h i) + b * norm (w $h i)\n\ngoal (1 subgoal):\n 1. UNIV = UNIV", "qed simp"], ["proof (state)\nthis:\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = a * norm1 v + b * norm1 w\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "also"], ["proof (state)\nthis:\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = a * norm1 v + b * norm1 w\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "have \"\\<dots> = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * norm1 v + b * norm1 w = 1", "using *(5) 1"], ["proof (prove)\nusing this:\n  a + b = 1\n  norm1 v = 1\n  norm1 w = 1\n\ngoal (1 subgoal):\n 1. a * norm1 v + b * norm1 w = 1", "by auto"], ["proof (state)\nthis:\n  a * norm1 v + b * norm1 w = 1\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "finally"], ["proof (chain)\npicking this:\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = 1", "have norm1: \"norm1 ?lin = 1\""], ["proof (prove)\nusing this:\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = 1\n\ngoal (1 subgoal):\n 1. norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = 1", "."], ["proof (state)\nthis:\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = 1\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "{"], ["proof (state)\nthis:\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = 1\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "from *"], ["proof (chain)\npicking this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1", "have \"0 \\<le> v $ i\" \"sr * v $ i \\<le> (B *v v) $ i\""], ["proof (prove)\nusing this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i &&&\n    HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  w \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i &&&\n    HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i", "by auto"], ["proof (state)\nthis:\n  0 \\<le> v $h i\n  HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "with \\<open>a \\<ge> 0\\<close>"], ["proof (chain)\npicking this:\n  0 \\<le> a\n  0 \\<le> v $h i\n  HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i", "have a: \"a * (sr * v $ i) \\<le> a * (B *v v) $ i\""], ["proof (prove)\nusing this:\n  0 \\<le> a\n  0 \\<le> v $h i\n  HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i\n\ngoal (1 subgoal):\n 1. a * (HMA_Connect.spectral_radius A * v $h i) \\<le> a * (B *v v) $h i", "by (intro mult_left_mono)"], ["proof (state)\nthis:\n  a * (HMA_Connect.spectral_radius A * v $h i) \\<le> a * (B *v v) $h i\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "from *"], ["proof (chain)\npicking this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1", "have \"0 \\<le> w $ i\" \"sr * w $ i \\<le> (B *v w) $ i\""], ["proof (prove)\nusing this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> w $h i &&&\n    HMA_Connect.spectral_radius A * w $h i \\<le> (B *v w) $h i", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  w \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n\ngoal (1 subgoal):\n 1. 0 \\<le> w $h i &&&\n    HMA_Connect.spectral_radius A * w $h i \\<le> (B *v w) $h i", "by auto"], ["proof (state)\nthis:\n  0 \\<le> w $h i\n  HMA_Connect.spectral_radius A * w $h i \\<le> (B *v w) $h i\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "with \\<open>b \\<ge> 0\\<close>"], ["proof (chain)\npicking this:\n  0 \\<le> b\n  0 \\<le> w $h i\n  HMA_Connect.spectral_radius A * w $h i \\<le> (B *v w) $h i", "have b: \"b * (sr * w $ i) \\<le> b * (B *v w) $ i\""], ["proof (prove)\nusing this:\n  0 \\<le> b\n  0 \\<le> w $h i\n  HMA_Connect.spectral_radius A * w $h i \\<le> (B *v w) $h i\n\ngoal (1 subgoal):\n 1. b * (HMA_Connect.spectral_radius A * w $h i) \\<le> b * (B *v w) $h i", "by (intro mult_left_mono)"], ["proof (state)\nthis:\n  b * (HMA_Connect.spectral_radius A * w $h i) \\<le> b * (B *v w) $h i\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "from a b"], ["proof (chain)\npicking this:\n  a * (HMA_Connect.spectral_radius A * v $h i) \\<le> a * (B *v v) $h i\n  b * (HMA_Connect.spectral_radius A * w $h i) \\<le> b * (B *v w) $h i", "have \"a * (sr * v $ i) + b * (sr * w $ i) \\<le> a * (B *v v) $ i + b * (B *v w) $ i\""], ["proof (prove)\nusing this:\n  a * (HMA_Connect.spectral_radius A * v $h i) \\<le> a * (B *v v) $h i\n  b * (HMA_Connect.spectral_radius A * w $h i) \\<le> b * (B *v w) $h i\n\ngoal (1 subgoal):\n 1. a * (HMA_Connect.spectral_radius A * v $h i) +\n    b * (HMA_Connect.spectral_radius A * w $h i)\n    \\<le> a * (B *v v) $h i + b * (B *v w) $h i", "by auto"], ["proof (state)\nthis:\n  a * (HMA_Connect.spectral_radius A * v $h i) +\n  b * (HMA_Connect.spectral_radius A * w $h i)\n  \\<le> a * (B *v v) $h i + b * (B *v w) $h i\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "}"], ["proof (state)\nthis:\n  a * (HMA_Connect.spectral_radius A * v $h ?i2) +\n  b * (HMA_Connect.spectral_radius A * w $h ?i2)\n  \\<le> a * (B *v v) $h ?i2 + b * (B *v w) $h ?i2\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "note le = this"], ["proof (state)\nthis:\n  a * (HMA_Connect.spectral_radius A * v $h ?i2) +\n  b * (HMA_Connect.spectral_radius A * w $h ?i2)\n  \\<le> a * (B *v v) $h ?i2 + b * (B *v w) $h ?i2\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "have switch[simp]: \"\\<And> x y. x * a * y = a * x * y\"  \"\\<And> x y. x * b * y = b * x * y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x y. x * a * y = a * x * y) &&&\n    (\\<And>x y. x * b * y = b * x * y)", "by auto"], ["proof (state)\nthis:\n  ?x * a * ?y = a * ?x * ?y\n  ?x * b * ?y = b * ?x * ?y\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "have [simp]: \"x \\<in> {v,w} \\<Longrightarrow> a * (r * x $h i) = r * (a * x $h i)\" for a r i x"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {v, w} \\<Longrightarrow> a * (r * x $h i) = r * (a * x $h i)", "by auto"], ["proof (state)\nthis:\n  ?x \\<in> {v, w} \\<Longrightarrow>\n  ?a * (?r * ?x $h ?i) = ?r * (?a * ?x $h ?i)\n\ngoal (1 subgoal):\n 1. \\<And>x y u v.\n       \\<lbrakk>x \\<in> S; y \\<in> S; 0 \\<le> u; 0 \\<le> v;\n        u + v = 1\\<rbrakk>\n       \\<Longrightarrow> u *\\<^sub>R x + v *\\<^sub>R y \\<in> S", "show \"a *\\<^sub>R v + b *\\<^sub>R w \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a *\\<^sub>R v + b *\\<^sub>R w \\<in> S", "using * norm1 le"], ["proof (prove)\nusing this:\n  v \\<in> S\n  w \\<in> S\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = 1\n  a * (HMA_Connect.spectral_radius A * v $h ?i2) +\n  b * (HMA_Connect.spectral_radius A * w $h ?i2)\n  \\<le> a * (B *v v) $h ?i2 + b * (B *v w) $h ?i2\n\ngoal (1 subgoal):\n 1. a *\\<^sub>R v + b *\\<^sub>R w \\<in> S", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  w \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  0 \\<le> a\n  0 \\<le> b\n  a + b = 1\n  norm1 (a *\\<^sub>R v + b *\\<^sub>R w) = 1\n  a * (HMA_Connect.spectral_radius A * v $h ?i2) +\n  b * (HMA_Connect.spectral_radius A * w $h ?i2)\n  \\<le> a * (B *v v) $h ?i2 + b * (B *v w) $h ?i2\n\ngoal (1 subgoal):\n 1. a *\\<^sub>R v + b *\\<^sub>R w\n    \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}", "by (auto simp: matrix_vect_scaleR matrix_vector_right_distrib ring_distribs)"], ["proof (state)\nthis:\n  a *\\<^sub>R v + b *\\<^sub>R w \\<in> S\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "abbreviation (input) r :: \"real \\<Rightarrow> complex\" where\n  \"r \\<equiv> of_real\""], ["", "private"], ["", "abbreviation rv :: \"real ^'n \\<Rightarrow> complex ^'n\" where\n  \"rv v \\<equiv> \\<chi> i. r (v $ i)\""], ["", "private"], ["", "lemma rv_0: \"(rv v = 0) = (v = 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<chi>i. complex_of_real (v $h i)) = 0) = (v = 0)", "by (simp add: of_real_hom.map_vector_0 map_vector_def vec_eq_iff)"], ["", "private"], ["", "lemma rv_mult: \"A *v rv v = rv (B *v v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", "have \"map_matrix r B = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HMA_Connect.map_matrix complex_of_real B = A", "using rnnA"], ["proof (prove)\nusing this:\n  real_non_neg_mat A\n\ngoal (1 subgoal):\n 1. HMA_Connect.map_matrix complex_of_real B = A", "unfolding map_matrix_def B_def real_non_neg_mat_def map_vector_def elements_mat_h_def"], ["proof (prove)\nusing this:\n  \\<forall>a\\<in>range (\\<lambda>(i, y). A $h i $h y).\n     a \\<in> \\<real> \\<and> 0 \\<le> Re a\n\ngoal (1 subgoal):\n 1. (\\<chi>i ia.\n        complex_of_real ((\\<chi>i j. Re (A $h i $h j)) $h i $h ia)) =\n    A", "by vector"], ["proof (state)\nthis:\n  HMA_Connect.map_matrix complex_of_real B = A\n\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", "thus ?thesis"], ["proof (prove)\nusing this:\n  HMA_Connect.map_matrix complex_of_real B = A\n\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", "using of_real_hom.matrix_vector_mult_hom[of B, where 'a = complex]"], ["proof (prove)\nusing this:\n  HMA_Connect.map_matrix complex_of_real B = A\n  HMA_Connect.map_matrix complex_of_real B *v\n  map_vector complex_of_real ?v =\n  map_vector complex_of_real (B *v ?v)\n\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", "unfolding map_vector_def"], ["proof (prove)\nusing this:\n  HMA_Connect.map_matrix complex_of_real B = A\n  HMA_Connect.map_matrix complex_of_real B *v\n  (\\<chi>i. complex_of_real (?v $h i)) =\n  (\\<chi>i. complex_of_real ((B *v ?v) $h i))\n\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", "by auto"], ["proof (state)\nthis:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  (\\<chi>i. complex_of_real ((B *v v) $h i))\n\ngoal:\nNo subgoals!", "qed"], ["", "context\n  assumes zero_no_ev: \"\\<And> v. v \\<in> S \\<Longrightarrow> A *v rv v \\<noteq> 0\"\nbegin"], ["", "private"], ["", "lemma normB_S: assumes v: \"v \\<in> S\"\n  shows \"norm1 (B *v v) \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm1 (B *v v) \\<noteq> 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. norm1 (B *v v) \\<noteq> 0", "from zero_no_ev[OF v, unfolded rv_mult rv_0]"], ["proof (chain)\npicking this:\n  B *v v \\<noteq> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  B *v v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. norm1 (B *v v) \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  norm1 (B *v v) \\<noteq> 0\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma image_f: \"f ` S \\<subseteq> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "fix v"], ["proof (state)\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "assume v: \"v \\<in> S\""], ["proof (state)\nthis:\n  v \\<in> S\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "hence norm: \"norm1 v = 1\" and ge: \"\\<And> i. v $ i \\<ge> 0\" \"\\<And> i. sr * v $ i \\<le> (B *v v) $ i\""], ["proof (prove)\nusing this:\n  v \\<in> S\n\ngoal (1 subgoal):\n 1. norm1 v = 1 &&&\n    (\\<And>i. 0 \\<le> v $h i) &&&\n    (\\<And>i. HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i)", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. norm1 v = 1 &&&\n    (\\<And>i. 0 \\<le> v $h i) &&&\n    (\\<And>i. HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i)", "by auto"], ["proof (state)\nthis:\n  norm1 v = 1\n  0 \\<le> v $h ?i\n  HMA_Connect.spectral_radius A * v $h ?i \\<le> (B *v v) $h ?i\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "from normB_S[OF v]"], ["proof (chain)\npicking this:\n  norm1 (B *v v) \\<noteq> 0", "have normB: \"norm1 (B *v v) > 0\""], ["proof (prove)\nusing this:\n  norm1 (B *v v) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < norm1 (B *v v)", "using norm1_nonzero"], ["proof (prove)\nusing this:\n  norm1 (B *v v) \\<noteq> 0\n  ?v \\<noteq> 0 \\<Longrightarrow> 0 < norm1 ?v\n\ngoal (1 subgoal):\n 1. 0 < norm1 (B *v v)", "by auto"], ["proof (state)\nthis:\n  0 < norm1 (B *v v)\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "have fv: \"f v = (1 / norm1 (B *v v)) *\\<^sub>R (B *v v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f v = (1 / norm1 (B *v v)) *\\<^sub>R (B *v v)", "unfolding f_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (1 / norm1 (B *v v)) *\\<^sub>R (B *v v) =\n    (1 / norm1 (B *v v)) *\\<^sub>R (B *v v)", "by auto"], ["proof (state)\nthis:\n  f v = (1 / norm1 (B *v v)) *\\<^sub>R (B *v v)\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "from normB"], ["proof (chain)\npicking this:\n  0 < norm1 (B *v v)", "have Bv0: \"B *v v \\<noteq> 0\""], ["proof (prove)\nusing this:\n  0 < norm1 (B *v v)\n\ngoal (1 subgoal):\n 1. B *v v \\<noteq> 0", "unfolding norm1_0_iff[symmetric]"], ["proof (prove)\nusing this:\n  0 < norm1 (B *v v)\n\ngoal (1 subgoal):\n 1. norm1 (B *v v) \\<noteq> 0", "by linarith"], ["proof (state)\nthis:\n  B *v v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "have norm: \"norm1 (f v) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. norm1 (f v) = 1", "unfolding fv"], ["proof (prove)\ngoal (1 subgoal):\n 1. norm1 ((1 / norm1 (B *v v)) *\\<^sub>R (B *v v)) = 1", "using normB Bv0"], ["proof (prove)\nusing this:\n  0 < norm1 (B *v v)\n  B *v v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. norm1 ((1 / norm1 (B *v v)) *\\<^sub>R (B *v v)) = 1", "by simp"], ["proof (state)\nthis:\n  norm1 (f v) = 1\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "define c where \"c = (1 / norm1 (B *v v))\""], ["proof (state)\nthis:\n  c = 1 / norm1 (B *v v)\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "have c: \"c > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < c", "unfolding c_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 / norm1 (B *v v)", "using normB"], ["proof (prove)\nusing this:\n  0 < norm1 (B *v v)\n\ngoal (1 subgoal):\n 1. 0 < 1 / norm1 (B *v v)", "by auto"], ["proof (state)\nthis:\n  0 < c\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "{"], ["proof (state)\nthis:\n  0 < c\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "fix i"], ["proof (state)\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "have 1: \"f v $ i \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> f v $h i", "unfolding fv c_def[symmetric]"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (c *\\<^sub>R (B *v v)) $h i", "using c ge"], ["proof (prove)\nusing this:\n  0 < c\n  0 \\<le> v $h ?i\n  HMA_Connect.spectral_radius A * v $h ?i \\<le> (B *v v) $h ?i\n\ngoal (1 subgoal):\n 1. 0 \\<le> (c *\\<^sub>R (B *v v)) $h i", "by (auto simp: matrix_vector_mult_def sum_distrib_left B_norm intro!: sum_nonneg)"], ["proof (state)\nthis:\n  0 \\<le> f v $h i\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "have id1: \"\\<And> i. (B *v f v) $ i = c * ((B *v (B *v v)) $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i. (B *v f v) $h i = c * (B *v (B *v v)) $h i", "unfolding f_def c_def matrix_vect_scaleR"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       ((1 / norm1 (B *v v)) *\\<^sub>R (B *v (B *v v))) $h i =\n       1 / norm1 (B *v v) * (B *v (B *v v)) $h i", "by simp"], ["proof (state)\nthis:\n  (B *v f v) $h ?i = c * (B *v (B *v v)) $h ?i\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "have id3: \"\\<And> i. sr * f v $ i = c * ((B *v (sr *\\<^sub>R v)) $ i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       HMA_Connect.spectral_radius A * f v $h i =\n       c * (B *v HMA_Connect.spectral_radius A *\\<^sub>R v) $h i", "unfolding f_def c_def[symmetric] matrix_vect_scaleR"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       HMA_Connect.spectral_radius A * (c *\\<^sub>R (B *v v)) $h i =\n       c * (HMA_Connect.spectral_radius A *\\<^sub>R (B *v v)) $h i", "by auto"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * f v $h ?i =\n  c * (B *v HMA_Connect.spectral_radius A *\\<^sub>R v) $h ?i\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "have 2: \"sr * f v $ i \\<le> (B *v f v) $ i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A * f v $h i \\<le> (B *v f v) $h i", "unfolding id1 id3"], ["proof (prove)\ngoal (1 subgoal):\n 1. c * (B *v HMA_Connect.spectral_radius A *\\<^sub>R v) $h i\n    \\<le> c * (B *v (B *v v)) $h i", "unfolding mult_le_cancel_iff2[OF \\<open>c > 0\\<close>]"], ["proof (prove)\ngoal (1 subgoal):\n 1. (B *v HMA_Connect.spectral_radius A *\\<^sub>R v) $h i\n    \\<le> (B *v (B *v v)) $h i", "by (rule mult_B_mono, insert ge(2), auto)"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * f v $h i \\<le> (B *v f v) $h i\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "note 1 2"], ["proof (state)\nthis:\n  0 \\<le> f v $h i\n  HMA_Connect.spectral_radius A * f v $h i \\<le> (B *v f v) $h i\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "}"], ["proof (state)\nthis:\n  0 \\<le> f v $h ?i2\n  HMA_Connect.spectral_radius A * f v $h ?i2 \\<le> (B *v f v) $h ?i2\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "with norm"], ["proof (chain)\npicking this:\n  norm1 (f v) = 1\n  0 \\<le> f v $h ?i2\n  HMA_Connect.spectral_radius A * f v $h ?i2 \\<le> (B *v f v) $h ?i2", "have \"f v \\<in> S\""], ["proof (prove)\nusing this:\n  norm1 (f v) = 1\n  0 \\<le> f v $h ?i2\n  HMA_Connect.spectral_radius A * f v $h ?i2 \\<le> (B *v f v) $h ?i2\n\ngoal (1 subgoal):\n 1. f v \\<in> S", "unfolding S_def"], ["proof (prove)\nusing this:\n  norm1 (f v) = 1\n  0 \\<le> f v $h ?i2\n  HMA_Connect.spectral_radius A * f v $h ?i2 \\<le> (B *v f v) $h ?i2\n\ngoal (1 subgoal):\n 1. f v\n    \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}", "by auto"], ["proof (state)\nthis:\n  f v \\<in> S\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "}"], ["proof (state)\nthis:\n  ?v2 \\<in> S \\<Longrightarrow> f ?v2 \\<in> S\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "thus ?thesis"], ["proof (prove)\nusing this:\n  ?v2 \\<in> S \\<Longrightarrow> f ?v2 \\<in> S\n\ngoal (1 subgoal):\n 1. f ` S \\<subseteq> S", "by blast"], ["proof (state)\nthis:\n  f ` S \\<subseteq> S\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma cont_f: \"continuous_on S f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on S f", "unfolding f_def[abs_def] continuous_on"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S.\n       ((\\<lambda>v.\n            (1 / norm1 (B *v v)) *\\<^sub>R (B *v v)) \\<longlongrightarrow>\n        (1 / norm1 (B *v x)) *\\<^sub>R (B *v x))\n        (at x within S)", "using normB_S"], ["proof (prove)\nusing this:\n  ?v \\<in> S \\<Longrightarrow> norm1 (B *v ?v) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S.\n       ((\\<lambda>v.\n            (1 / norm1 (B *v v)) *\\<^sub>R (B *v v)) \\<longlongrightarrow>\n        (1 / norm1 (B *v x)) *\\<^sub>R (B *v x))\n        (at x within S)", "unfolding norm1_def"], ["proof (prove)\nusing this:\n  ?v \\<in> S \\<Longrightarrow>\n  (\\<Sum>i\\<in>UNIV. norm ((B *v ?v) $h i)) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>S.\n       ((\\<lambda>v.\n            (1 / (\\<Sum>i\\<in>UNIV. norm ((B *v v) $h i))) *\\<^sub>R\n            (B *v v)) \\<longlongrightarrow>\n        (1 / (\\<Sum>i\\<in>UNIV. norm ((B *v x) $h i))) *\\<^sub>R (B *v x))\n        (at x within S)", "by (auto intro!: tendsto_eq_intros)"], ["", "qualified"], ["", "lemma perron_frobenius_positive_ev:\n  \"\\<exists> v. eigen_vector A v (r sr) \\<and> real_non_neg_vec v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from brouwer[OF compactS convexS non_emptyS cont_f image_f]"], ["proof (chain)\npicking this:\n  (\\<And>x.\n      \\<lbrakk>x \\<in> S; f x = x\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain v where v: \"v \\<in> S\" and fv: \"f v = v\""], ["proof (prove)\nusing this:\n  (\\<And>x.\n      \\<lbrakk>x \\<in> S; f x = x\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>v.\n        \\<lbrakk>v \\<in> S; f v = v\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  v \\<in> S\n  f v = v\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "define ev where \"ev = norm1 (B *v v)\""], ["proof (state)\nthis:\n  ev = norm1 (B *v v)\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from normB_S[OF v]"], ["proof (chain)\npicking this:\n  norm1 (B *v v) \\<noteq> 0", "have \"ev \\<noteq> 0\""], ["proof (prove)\nusing this:\n  norm1 (B *v v) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. ev \\<noteq> 0", "unfolding ev_def"], ["proof (prove)\nusing this:\n  norm1 (B *v v) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. norm1 (B *v v) \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  ev \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with norm1_ge_0[of \"B *v v\", folded ev_def]"], ["proof (chain)\npicking this:\n  0 \\<le> ev\n  ev \\<noteq> 0", "have norm: \"ev > 0\""], ["proof (prove)\nusing this:\n  0 \\<le> ev\n  ev \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 0 < ev", "by auto"], ["proof (state)\nthis:\n  0 < ev\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from arg_cong[OF fv[unfolded f_def], of \"\\<lambda> (w :: real ^ 'n). ev *\\<^sub>R w\"] norm"], ["proof (chain)\npicking this:\n  ev *\\<^sub>R (1 / norm1 (B *v v)) *\\<^sub>R (B *v v) = ev *\\<^sub>R v\n  0 < ev", "have ev: \"B *v v = ev *s v\""], ["proof (prove)\nusing this:\n  ev *\\<^sub>R (1 / norm1 (B *v v)) *\\<^sub>R (B *v v) = ev *\\<^sub>R v\n  0 < ev\n\ngoal (1 subgoal):\n 1. B *v v = ev *s v", "unfolding ev_def[symmetric] scalar_mult_eq_scaleR"], ["proof (prove)\nusing this:\n  ev *\\<^sub>R (1 / ev) *\\<^sub>R (B *v v) = ev *\\<^sub>R v\n  0 < ev\n\ngoal (1 subgoal):\n 1. B *v v = ev *\\<^sub>R v", "by simp"], ["proof (state)\nthis:\n  B *v v = ev *s v\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with v[unfolded S_def]"], ["proof (chain)\npicking this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  B *v v = ev *s v", "have ge: \"\\<And> i. sr * v $ i \\<le> ev * v $ i\""], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  B *v v = ev *s v\n\ngoal (1 subgoal):\n 1. \\<And>i. HMA_Connect.spectral_radius A * v $h i \\<le> ev * v $h i", "by auto"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * v $h ?i \\<le> ev * v $h ?i\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "have \"A *v rv v = rv (B *v v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", "unfolding rv_mult"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i. complex_of_real ((B *v v) $h i)) =\n    (\\<chi>i. complex_of_real ((B *v v) $h i))", ".."], ["proof (state)\nthis:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  (\\<chi>i. complex_of_real ((B *v v) $h i))\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "also"], ["proof (state)\nthis:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  (\\<chi>i. complex_of_real ((B *v v) $h i))\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "have \"\\<dots> = ev *s rv v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<chi>i. complex_of_real ((B *v v) $h i)) =\n    complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))", "unfolding ev vec_eq_iff"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i.\n       (\\<chi>i. complex_of_real ((ev *s v) $h i)) $h i =\n       (complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))) $h i", "by (simp add: scaleR_conv_of_real scaleR_vec_def)"], ["proof (state)\nthis:\n  (\\<chi>i. complex_of_real ((B *v v) $h i)) =\n  complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "finally"], ["proof (chain)\npicking this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))", "have ev: \"A *v rv v = ev *s rv v\""], ["proof (prove)\nusing this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))\n\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))", "."], ["proof (state)\nthis:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v"], ["proof (chain)\npicking this:\n  v \\<in> S", "have v0: \"v \\<noteq> 0\""], ["proof (prove)\nusing this:\n  v \\<in> S\n\ngoal (1 subgoal):\n 1. v \\<noteq> 0", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. v \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "hence \"rv v \\<noteq> 0\""], ["proof (prove)\nusing this:\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0", "unfolding rv_0"], ["proof (prove)\nusing this:\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. v \\<noteq> 0", "."], ["proof (state)\nthis:\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with ev"], ["proof (chain)\npicking this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0", "have ev: \"eigen_vector A (rv v) ev\""], ["proof (prove)\nusing this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. eigen_vector A (\\<chi>i. complex_of_real (v $h i)) (complex_of_real ev)", "unfolding eigen_vector_def"], ["proof (prove)\nusing this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0 \\<and>\n    A *v (\\<chi>i. complex_of_real (v $h i)) =\n    complex_of_real ev *s (\\<chi>i. complex_of_real (v $h i))", "by auto"], ["proof (state)\nthis:\n  eigen_vector A (\\<chi>i. complex_of_real (v $h i)) (complex_of_real ev)\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "hence \"eigen_value A ev\""], ["proof (prove)\nusing this:\n  eigen_vector A (\\<chi>i. complex_of_real (v $h i)) (complex_of_real ev)\n\ngoal (1 subgoal):\n 1. eigen_value A (complex_of_real ev)", "unfolding eigen_value_def"], ["proof (prove)\nusing this:\n  eigen_vector A (\\<chi>i. complex_of_real (v $h i)) (complex_of_real ev)\n\ngoal (1 subgoal):\n 1. \\<exists>v. eigen_vector A v (complex_of_real ev)", "by auto"], ["proof (state)\nthis:\n  eigen_value A (complex_of_real ev)\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from spectral_radius_max[OF this]"], ["proof (chain)\npicking this:\n  cmod (complex_of_real ev) \\<le> HMA_Connect.spectral_radius A", "have le: \"norm (r ev) \\<le> sr\""], ["proof (prove)\nusing this:\n  cmod (complex_of_real ev) \\<le> HMA_Connect.spectral_radius A\n\ngoal (1 subgoal):\n 1. cmod (complex_of_real ev) \\<le> HMA_Connect.spectral_radius A", "."], ["proof (state)\nthis:\n  cmod (complex_of_real ev) \\<le> HMA_Connect.spectral_radius A\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v0"], ["proof (chain)\npicking this:\n  v \\<noteq> 0", "obtain i where \"v $ i \\<noteq> 0\""], ["proof (prove)\nusing this:\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<And>i. v $h i \\<noteq> 0 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>i. v $h i = 0 $h i)\n\ngoal (1 subgoal):\n 1. (\\<And>i. v $h i \\<noteq> 0 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  v $h i \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v"], ["proof (chain)\npicking this:\n  v \\<in> S", "have \"v $ i \\<ge> 0\""], ["proof (prove)\nusing this:\n  v \\<in> S\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i", "by auto"], ["proof (state)\nthis:\n  0 \\<le> v $h i\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with \\<open>v $ i \\<noteq> 0\\<close>"], ["proof (chain)\npicking this:\n  v $h i \\<noteq> 0\n  0 \\<le> v $h i", "have \"v $ i > 0\""], ["proof (prove)\nusing this:\n  v $h i \\<noteq> 0\n  0 \\<le> v $h i\n\ngoal (1 subgoal):\n 1. 0 < v $h i", "by auto"], ["proof (state)\nthis:\n  0 < v $h i\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with ge[of i]"], ["proof (chain)\npicking this:\n  HMA_Connect.spectral_radius A * v $h i \\<le> ev * v $h i\n  0 < v $h i", "have ge: \"sr \\<le> ev\""], ["proof (prove)\nusing this:\n  HMA_Connect.spectral_radius A * v $h i \\<le> ev * v $h i\n  0 < v $h i\n\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A \\<le> ev", "by auto"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A \\<le> ev\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with le"], ["proof (chain)\npicking this:\n  cmod (complex_of_real ev) \\<le> HMA_Connect.spectral_radius A\n  HMA_Connect.spectral_radius A \\<le> ev", "have sr: \"r sr = ev\""], ["proof (prove)\nusing this:\n  cmod (complex_of_real ev) \\<le> HMA_Connect.spectral_radius A\n  HMA_Connect.spectral_radius A \\<le> ev\n\ngoal (1 subgoal):\n 1. complex_of_real (HMA_Connect.spectral_radius A) = complex_of_real ev", "by auto"], ["proof (state)\nthis:\n  complex_of_real (HMA_Connect.spectral_radius A) = complex_of_real ev\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v"], ["proof (chain)\npicking this:\n  v \\<in> S", "have *: \"real_non_neg_vec (rv v)\""], ["proof (prove)\nusing this:\n  v \\<in> S\n\ngoal (1 subgoal):\n 1. real_non_neg_vec (\\<chi>i. complex_of_real (v $h i))", "unfolding S_def real_non_neg_vec_def vec_elements_h_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>range (($h) (\\<chi>i. complex_of_real (v $h i))).\n       a \\<in> \\<real> \\<and> 0 \\<le> Re a", "by auto"], ["proof (state)\nthis:\n  real_non_neg_vec (\\<chi>i. complex_of_real (v $h i))\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "unfolding sr"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v (complex_of_real ev) \\<and> real_non_neg_vec v", "by (rule exI[of _ \"rv v\"], insert * ev norm, auto)"], ["proof (state)\nthis:\n  \\<exists>v.\n     eigen_vector A v\n      (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n     real_non_neg_vec v\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "qualified"], ["", "lemma perron_frobenius_both:\n  \"\\<exists> v. eigen_vector A v (r sr) \\<and> real_non_neg_vec v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "proof (cases \"\\<forall> v \\<in> S. A *v rv v \\<noteq> 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>v\\<in>S.\n       A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v\n 2. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "case True"], ["proof (state)\nthis:\n  \\<forall>v\\<in>S. A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0\n\ngoal (2 subgoals):\n 1. \\<forall>v\\<in>S.\n       A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0 \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v\n 2. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "by (rule Perron_Frobenius.perron_frobenius_positive_ev[OF rnnA], insert True, auto)"], ["proof (state)\nthis:\n  \\<exists>v.\n     eigen_vector A v\n      (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n     real_non_neg_vec v\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "case False"], ["proof (state)\nthis:\n  \\<not> (\\<forall>v\\<in>S.\n             A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0)\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "then"], ["proof (chain)\npicking this:\n  \\<not> (\\<forall>v\\<in>S.\n             A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0)", "obtain v where v: \"v \\<in> S\" and A0: \"A *v rv v = 0\""], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>v\\<in>S.\n             A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0)\n\ngoal (1 subgoal):\n 1. (\\<And>v.\n        \\<lbrakk>v \\<in> S;\n         A *v (\\<chi>i. complex_of_real (v $h i)) = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  v \\<in> S\n  A *v (\\<chi>i. complex_of_real (v $h i)) = 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "hence id: \"A *v rv v = 0 *s rv v\" and v0: \"v \\<noteq> 0\""], ["proof (prove)\nusing this:\n  v \\<in> S\n  A *v (\\<chi>i. complex_of_real (v $h i)) = 0\n\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    0 *s (\\<chi>i. complex_of_real (v $h i)) &&&\n    v \\<noteq> 0", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n  A *v (\\<chi>i. complex_of_real (v $h i)) = 0\n\ngoal (1 subgoal):\n 1. A *v (\\<chi>i. complex_of_real (v $h i)) =\n    0 *s (\\<chi>i. complex_of_real (v $h i)) &&&\n    v \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  0 *s (\\<chi>i. complex_of_real (v $h i))\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v0"], ["proof (chain)\npicking this:\n  v \\<noteq> 0", "have \"rv v \\<noteq> 0\""], ["proof (prove)\nusing this:\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0", "unfolding rv_0"], ["proof (prove)\nusing this:\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. v \\<noteq> 0", "."], ["proof (state)\nthis:\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with id"], ["proof (chain)\npicking this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  0 *s (\\<chi>i. complex_of_real (v $h i))\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0", "have ev: \"eigen_vector A (rv v) 0\""], ["proof (prove)\nusing this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  0 *s (\\<chi>i. complex_of_real (v $h i))\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. eigen_vector A (\\<chi>i. complex_of_real (v $h i)) 0", "unfolding eigen_vector_def"], ["proof (prove)\nusing this:\n  A *v (\\<chi>i. complex_of_real (v $h i)) =\n  0 *s (\\<chi>i. complex_of_real (v $h i))\n  (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<chi>i. complex_of_real (v $h i)) \\<noteq> 0 \\<and>\n    A *v (\\<chi>i. complex_of_real (v $h i)) =\n    0 *s (\\<chi>i. complex_of_real (v $h i))", "by auto"], ["proof (state)\nthis:\n  eigen_vector A (\\<chi>i. complex_of_real (v $h i)) 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "hence \"eigen_value A 0\""], ["proof (prove)\nusing this:\n  eigen_vector A (\\<chi>i. complex_of_real (v $h i)) 0\n\ngoal (1 subgoal):\n 1. eigen_value A 0", "unfolding eigen_value_def"], ["proof (prove)\nusing this:\n  eigen_vector A (\\<chi>i. complex_of_real (v $h i)) 0\n\ngoal (1 subgoal):\n 1. \\<exists>v. eigen_vector A v 0", ".."], ["proof (state)\nthis:\n  eigen_value A 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from spectral_radius_max[OF this]"], ["proof (chain)\npicking this:\n  cmod 0 \\<le> HMA_Connect.spectral_radius A", "have 0: \"0 \\<le> sr\""], ["proof (prove)\nusing this:\n  cmod 0 \\<le> HMA_Connect.spectral_radius A\n\ngoal (1 subgoal):\n 1. 0 \\<le> HMA_Connect.spectral_radius A", "by auto"], ["proof (state)\nthis:\n  0 \\<le> HMA_Connect.spectral_radius A\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v[unfolded S_def]"], ["proof (chain)\npicking this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}", "have ge: \"\\<And> i. sr * v $ i \\<le> (B *v v) $ i\""], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. \\<And>i. HMA_Connect.spectral_radius A * v $h i \\<le> (B *v v) $h i", "by auto"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A * v $h ?i \\<le> (B *v v) $h ?i\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v[unfolded S_def]"], ["proof (chain)\npicking this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}", "have rnn: \"real_non_neg_vec (rv v)\""], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. real_non_neg_vec (\\<chi>i. complex_of_real (v $h i))", "unfolding real_non_neg_vec_def vec_elements_h_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>range (($h) (\\<chi>i. complex_of_real (v $h i))).\n       a \\<in> \\<real> \\<and> 0 \\<le> Re a", "by auto"], ["proof (state)\nthis:\n  real_non_neg_vec (\\<chi>i. complex_of_real (v $h i))\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v0"], ["proof (chain)\npicking this:\n  v \\<noteq> 0", "obtain i where \"v $ i \\<noteq> 0\""], ["proof (prove)\nusing this:\n  v \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<And>i. v $h i \\<noteq> 0 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding vec_eq_iff"], ["proof (prove)\nusing this:\n  \\<not> (\\<forall>i. v $h i = 0 $h i)\n\ngoal (1 subgoal):\n 1. (\\<And>i. v $h i \\<noteq> 0 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  v $h i \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from v"], ["proof (chain)\npicking this:\n  v \\<in> S", "have \"v $ i \\<ge> 0\""], ["proof (prove)\nusing this:\n  v \\<in> S\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i", "unfolding S_def"], ["proof (prove)\nusing this:\n  v \\<in> {v. norm1 v = 1 \\<and>\n              (\\<forall>i. 0 \\<le> v $h i) \\<and>\n              (\\<forall>i.\n                  HMA_Connect.spectral_radius A * v $h i\n                  \\<le> (B *v v) $h i)}\n\ngoal (1 subgoal):\n 1. 0 \\<le> v $h i", "by auto"], ["proof (state)\nthis:\n  0 \\<le> v $h i\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with \\<open>v $ i \\<noteq> 0\\<close>"], ["proof (chain)\npicking this:\n  v $h i \\<noteq> 0\n  0 \\<le> v $h i", "have vi: \"v $ i > 0\""], ["proof (prove)\nusing this:\n  v $h i \\<noteq> 0\n  0 \\<le> v $h i\n\ngoal (1 subgoal):\n 1. 0 < v $h i", "by auto"], ["proof (state)\nthis:\n  0 < v $h i\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from rv_mult[of v, unfolded A0]"], ["proof (chain)\npicking this:\n  0 = (\\<chi>i. complex_of_real ((B *v v) $h i))", "have \"rv (B *v v) = 0\""], ["proof (prove)\nusing this:\n  0 = (\\<chi>i. complex_of_real ((B *v v) $h i))\n\ngoal (1 subgoal):\n 1. (\\<chi>i. complex_of_real ((B *v v) $h i)) = 0", "by simp"], ["proof (state)\nthis:\n  (\\<chi>i. complex_of_real ((B *v v) $h i)) = 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "hence \"B *v v = 0\""], ["proof (prove)\nusing this:\n  (\\<chi>i. complex_of_real ((B *v v) $h i)) = 0\n\ngoal (1 subgoal):\n 1. B *v v = 0", "unfolding rv_0"], ["proof (prove)\nusing this:\n  B *v v = 0\n\ngoal (1 subgoal):\n 1. B *v v = 0", "."], ["proof (state)\nthis:\n  B *v v = 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "from ge[of i, unfolded this] vi"], ["proof (chain)\npicking this:\n  HMA_Connect.spectral_radius A * v $h i \\<le> 0 $h i\n  0 < v $h i", "have ge: \"sr \\<le> 0\""], ["proof (prove)\nusing this:\n  HMA_Connect.spectral_radius A * v $h i \\<le> 0 $h i\n  0 < v $h i\n\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A \\<le> 0", "by (simp add: mult_le_0_iff)"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "with \\<open>0 \\<le> sr\\<close>"], ["proof (chain)\npicking this:\n  0 \\<le> HMA_Connect.spectral_radius A\n  HMA_Connect.spectral_radius A \\<le> 0", "have \"sr = 0\""], ["proof (prove)\nusing this:\n  0 \\<le> HMA_Connect.spectral_radius A\n  HMA_Connect.spectral_radius A \\<le> 0\n\ngoal (1 subgoal):\n 1. HMA_Connect.spectral_radius A = 0", "by auto"], ["proof (state)\nthis:\n  HMA_Connect.spectral_radius A = 0\n\ngoal (1 subgoal):\n 1. \\<not> (\\<forall>v\\<in>S.\n               A *v (\\<chi>i. complex_of_real (v $h i)) \\<noteq>\n               0) \\<Longrightarrow>\n    \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "unfolding \\<open>sr = 0\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v (complex_of_real 0) \\<and> real_non_neg_vec v", "using rnn ev"], ["proof (prove)\nusing this:\n  real_non_neg_vec (\\<chi>i. complex_of_real (v $h i))\n  eigen_vector A (\\<chi>i. complex_of_real (v $h i)) 0\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v (complex_of_real 0) \\<and> real_non_neg_vec v", "by auto"], ["proof (state)\nthis:\n  \\<exists>v.\n     eigen_vector A v\n      (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n     real_non_neg_vec v\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "text \\<open>Perron Frobenius: The largest complex eigenvalue of a real-valued non-negative matrix\n  is a real one, and it has a real-valued non-negative eigenvector.\\<close>"], ["", "lemma perron_frobenius:\n  assumes \"real_non_neg_mat A\"\n  shows \"\\<exists>v. eigen_vector A v (of_real (spectral_radius A)) \\<and> real_non_neg_vec v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v\n        (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n       real_non_neg_vec v", "by (rule Perron_Frobenius.perron_frobenius_both[OF assms])"], ["", "text \\<open>And a version which ignores the eigenvector.\\<close>"], ["", "lemma perron_frobenius_eigen_value:\n  assumes \"real_non_neg_mat A\"\n  shows \"eigen_value A (of_real (spectral_radius A))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. eigen_value A (complex_of_real (HMA_Connect.spectral_radius A))", "using perron_frobenius[OF assms]"], ["proof (prove)\nusing this:\n  \\<exists>v.\n     eigen_vector A v\n      (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n     real_non_neg_vec v\n\ngoal (1 subgoal):\n 1. eigen_value A (complex_of_real (HMA_Connect.spectral_radius A))", "unfolding eigen_value_def"], ["proof (prove)\nusing this:\n  \\<exists>v.\n     eigen_vector A v\n      (complex_of_real (HMA_Connect.spectral_radius A)) \\<and>\n     real_non_neg_vec v\n\ngoal (1 subgoal):\n 1. \\<exists>v.\n       eigen_vector A v (complex_of_real (HMA_Connect.spectral_radius A))", "by blast"], ["", "end"]]}