{"file_name": "/home/qj213/afp-2021-10-22/thys/Dirichlet_L/Dirichlet_Theorem.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Dirichlet_L", "problem_names": ["lemma sum_upto_mangoldt_le: \n  assumes \"x \\<ge> 0\"\n  shows   \"sum_upto mangoldt x \\<le> 3 / 2 * x\"", "lemma Mertens_bigo:\n  \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> real p \\<le> x. ln p / p) - ln x) \\<in> O(\\<lambda>_. 1)\"", "lemma Dirichlet_L_nonprincipal_mangoldt_bound_aux_strong:\n  assumes x: \"x > 0\"\n  shows   \"norm (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x - sum_upto (\\<lambda>k. \\<chi> k * ln k / k) x)\n             \\<le> 9 / 2 * real (totient n)\"", "lemma Dirichlet_L_nonprincipal_mangoldt_aux_bound:\n  \"(\\<lambda>x. L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x - sum_upto (\\<lambda>k. \\<chi> k * ln k / k) x) \\<in> O(\\<lambda>_. 1)\"", "lemma nonprincipal_mangoldt_bound:\n  \"(\\<lambda>x. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x) \\<in> O(\\<lambda>_. 1)\" (is \"?lhs \\<in> _\")", "lemma principal_dchar_sum_bound:\n  \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> real p \\<le> x. \\<chi>\\<^sub>0 p * (ln p / p)) - ln x) \\<in> O(\\<lambda>_. 1)\"", "lemma principal_dchar_sum_bound':\n  \"(\\<lambda>x. sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / k) x - Ln x) \\<in> O(\\<lambda>_. 1)\"", "lemma Dirichlet_strong:\n  assumes \"coprime h n\"\n  shows   \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x. ln p / p) - ln x / totient n)\n             \\<in> O(\\<lambda>_. 1)\" (is \"(\\<lambda>x. sum _ (?A x) - _) \\<in> _\")", "theorem Dirichlet:\n  assumes \"coprime h n\"\n  shows   \"infinite {p. prime p \\<and> [p = h] (mod n)}\""], "translations": [["", "lemma sum_upto_mangoldt_le: \n  assumes \"x \\<ge> 0\"\n  shows   \"sum_upto mangoldt x \\<le> 3 / 2 * x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "have \"sum_upto mangoldt x = psi (nat \\<lfloor>x\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto mangoldt x = psi (nat \\<lfloor>x\\<rfloor>)", "by (simp add: sum_upto_altdef psi_def atLeastSucAtMost_greaterThanAtMost)"], ["proof (state)\nthis:\n  sum_upto mangoldt x = psi (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "also"], ["proof (state)\nthis:\n  sum_upto mangoldt x = psi (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "have \"\\<dots> \\<le> 551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi (nat \\<lfloor>x\\<rfloor>)\n    \\<le> 551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)", "by (rule psi_ubound_log)"], ["proof (state)\nthis:\n  psi (nat \\<lfloor>x\\<rfloor>)\n  \\<le> 551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "also"], ["proof (state)\nthis:\n  psi (nat \\<lfloor>x\\<rfloor>)\n  \\<le> 551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "have \"\\<dots> \\<le> 3 / 2 * real (nat \\<lfloor>x\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)\n    \\<le> 3 / 2 * real (nat \\<lfloor>x\\<rfloor>)", "using Bertrand.ln_2_le"], ["proof (prove)\nusing this:\n  ln 2 \\<le> 355 / 512\n\ngoal (1 subgoal):\n 1. 551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)\n    \\<le> 3 / 2 * real (nat \\<lfloor>x\\<rfloor>)", "by (intro mult_right_mono) auto"], ["proof (state)\nthis:\n  551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)\n  \\<le> 3 / 2 * real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "also"], ["proof (state)\nthis:\n  551 / 256 * ln 2 * real (nat \\<lfloor>x\\<rfloor>)\n  \\<le> 3 / 2 * real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "have \"\\<dots> \\<le> 3 / 2 * x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 3 / 2 * real (nat \\<lfloor>x\\<rfloor>) \\<le> 3 / 2 * x", "using assms"], ["proof (prove)\nusing this:\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. 3 / 2 * real (nat \\<lfloor>x\\<rfloor>) \\<le> 3 / 2 * x", "by linarith"], ["proof (state)\nthis:\n  3 / 2 * real (nat \\<lfloor>x\\<rfloor>) \\<le> 3 / 2 * x\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "finally"], ["proof (chain)\npicking this:\n  sum_upto mangoldt x \\<le> 3 / 2 * x", "show ?thesis"], ["proof (prove)\nusing this:\n  sum_upto mangoldt x \\<le> 3 / 2 * x\n\ngoal (1 subgoal):\n 1. sum_upto mangoldt x \\<le> 3 / 2 * x", "."], ["proof (state)\nthis:\n  sum_upto mangoldt x \\<le> 3 / 2 * x\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  We can also, similarly, use the results from the Bertrand's postulate entry to show\n  that the sum of $\\ln p / p$ over all primes grows logarithmically.\n\\<close>"], ["", "lemma Mertens_bigo:\n  \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> real p \\<le> x. ln p / p) - ln x) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n        ln x)\n    \\<in> O(\\<lambda>_. 1)", "proof (intro bigoI[of _ 8] eventually_mono[OF eventually_gt_at_top[of 1]], goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "case (1 x)"], ["proof (state)\nthis:\n  1 < x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"\\<bar>(\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>. ln p / p) - ln x\\<bar> =\n          \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>. ln p / p) - ln (nat \\<lfloor>x\\<rfloor>) - (ln x - ln (nat \\<lfloor>x\\<rfloor>))\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n             ln (real x) / real x) -\n          ln x\\<bar> =\n    \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n             ln (real x) / real x) -\n          ln (real (nat \\<lfloor>x\\<rfloor>)) -\n          (ln x - ln (real (nat \\<lfloor>x\\<rfloor>)))\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln x\\<bar> =\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln (real (nat \\<lfloor>x\\<rfloor>)) -\n        (ln x - ln (real (nat \\<lfloor>x\\<rfloor>)))\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln x\\<bar> =\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln (real (nat \\<lfloor>x\\<rfloor>)) -\n        (ln x - ln (real (nat \\<lfloor>x\\<rfloor>)))\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"\\<dots> \\<le> \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>. ln p / p) - ln (nat \\<lfloor>x\\<rfloor>)\\<bar> + \\<bar>ln x - ln (nat \\<lfloor>x\\<rfloor>)\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n             ln (real x) / real x) -\n          ln (real (nat \\<lfloor>x\\<rfloor>)) -\n          (ln x - ln (real (nat \\<lfloor>x\\<rfloor>)))\\<bar>\n    \\<le> \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and>\n                                 p \\<le> nat \\<lfloor>x\\<rfloor>}.\n                   ln (real x) / real x) -\n                ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar> +\n          \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>", "by (rule abs_triangle_ineq4)"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln (real (nat \\<lfloor>x\\<rfloor>)) -\n        (ln x - ln (real (nat \\<lfloor>x\\<rfloor>)))\\<bar>\n  \\<le> \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and>\n                               p \\<le> nat \\<lfloor>x\\<rfloor>}.\n                 ln (real x) / real x) -\n              ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar> +\n        \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln (real (nat \\<lfloor>x\\<rfloor>)) -\n        (ln x - ln (real (nat \\<lfloor>x\\<rfloor>)))\\<bar>\n  \\<le> \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and>\n                               p \\<le> nat \\<lfloor>x\\<rfloor>}.\n                 ln (real x) / real x) -\n              ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar> +\n        \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"\\<bar>(\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>. ln p / p) - ln (nat \\<lfloor>x\\<rfloor>)\\<bar> \\<le> 7\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n             ln (real x) / real x) -\n          ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n    \\<le> 7", "using 1"], ["proof (prove)\nusing this:\n  1 < x\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n             ln (real x) / real x) -\n          ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n    \\<le> 7", "by (intro Mertens) auto"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n  \\<le> 7\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>x\\<in>{p. prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>}.\n           ln (real x) / real x) -\n        ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n  \\<le> 7\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"\\<bar>ln x - ln (nat \\<lfloor>x\\<rfloor>)\\<bar> = ln x - ln (nat \\<lfloor>x\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar> =\n    ln x - ln (real (nat \\<lfloor>x\\<rfloor>))", "using 1"], ["proof (prove)\nusing this:\n  1 < x\n\ngoal (1 subgoal):\n 1. \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar> =\n    ln x - ln (real (nat \\<lfloor>x\\<rfloor>))", "by (intro abs_of_nonneg) auto"], ["proof (state)\nthis:\n  \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar> =\n  ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar> =\n  ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "from 1"], ["proof (chain)\npicking this:\n  1 < x", "have \"\\<dots> \\<le> (x - nat \\<lfloor>x\\<rfloor>) / nat \\<lfloor>x\\<rfloor>\""], ["proof (prove)\nusing this:\n  1 < x\n\ngoal (1 subgoal):\n 1. ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\n    \\<le> (x - real (nat \\<lfloor>x\\<rfloor>)) /\n          real (nat \\<lfloor>x\\<rfloor>)", "by (intro ln_diff_le) auto"], ["proof (state)\nthis:\n  ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\n  \\<le> (x - real (nat \\<lfloor>x\\<rfloor>)) /\n        real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\n  \\<le> (x - real (nat \\<lfloor>x\\<rfloor>)) /\n        real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"\\<dots> \\<le> (x - nat \\<lfloor>x\\<rfloor>) / 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x - real (nat \\<lfloor>x\\<rfloor>)) / real (nat \\<lfloor>x\\<rfloor>)\n    \\<le> (x - real (nat \\<lfloor>x\\<rfloor>)) / 1", "using 1"], ["proof (prove)\nusing this:\n  1 < x\n\ngoal (1 subgoal):\n 1. (x - real (nat \\<lfloor>x\\<rfloor>)) / real (nat \\<lfloor>x\\<rfloor>)\n    \\<le> (x - real (nat \\<lfloor>x\\<rfloor>)) / 1", "by (intro divide_left_mono) auto"], ["proof (state)\nthis:\n  (x - real (nat \\<lfloor>x\\<rfloor>)) / real (nat \\<lfloor>x\\<rfloor>)\n  \\<le> (x - real (nat \\<lfloor>x\\<rfloor>)) / 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  (x - real (nat \\<lfloor>x\\<rfloor>)) / real (nat \\<lfloor>x\\<rfloor>)\n  \\<le> (x - real (nat \\<lfloor>x\\<rfloor>)) / 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"\\<dots> = x - nat \\<lfloor>x\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (x - real (nat \\<lfloor>x\\<rfloor>)) / 1 =\n    x - real (nat \\<lfloor>x\\<rfloor>)", "by simp"], ["proof (state)\nthis:\n  (x - real (nat \\<lfloor>x\\<rfloor>)) / 1 =\n  x - real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  (x - real (nat \\<lfloor>x\\<rfloor>)) / 1 =\n  x - real (nat \\<lfloor>x\\<rfloor>)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"\\<dots> \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x - real (nat \\<lfloor>x\\<rfloor>) \\<le> 1", "using 1"], ["proof (prove)\nusing this:\n  1 < x\n\ngoal (1 subgoal):\n 1. x - real (nat \\<lfloor>x\\<rfloor>) \\<le> 1", "by linarith"], ["proof (state)\nthis:\n  x - real (nat \\<lfloor>x\\<rfloor>) \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "also"], ["proof (state)\nthis:\n  x - real (nat \\<lfloor>x\\<rfloor>) \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "have \"(\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>. ln p / p) = (\\<Sum>p | prime p \\<and> real p \\<le> x. ln p / p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>.\n       ln (real p) / real p) =\n    (\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p)", "using 1"], ["proof (prove)\nusing this:\n  1 < x\n\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>.\n       ln (real p) / real p) =\n    (\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p)", "by (intro sum.cong refl) (auto simp: le_nat_iff le_floor_iff)"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p \\<le> nat \\<lfloor>x\\<rfloor>.\n     ln (real p) / real p) =\n  (\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       1 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n         ln x)\n       \\<le> 8 * norm 1", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>xa y.\n              xa \\<le> y \\<Longrightarrow>\n              xa + \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n              \\<le> y +\n                    \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 7 + x \\<le> 7 + y;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 7 + x \\<le> 7 + y;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 7 + x \\<le> 7 + y\\<rbrakk>\n  \\<Longrightarrow> \\<bar>(\\<Sum>p | prime p \\<and> real p \\<le> x.\n                             ln (real p) / real p) -\n                          ln x\\<bar>\n                    \\<le> 7 + 1", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>xa y.\n              xa \\<le> y \\<Longrightarrow>\n              xa + \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>\n              \\<le> y +\n                    \\<bar>ln x - ln (real (nat \\<lfloor>x\\<rfloor>))\\<bar>;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 7 + x \\<le> 7 + y;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 7 + x \\<le> 7 + y;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 7 + x \\<le> 7 + y\\<rbrakk>\n  \\<Longrightarrow> \\<bar>(\\<Sum>p | prime p \\<and> real p \\<le> x.\n                             ln (real p) / real p) -\n                          ln x\\<bar>\n                    \\<le> 7 + 1\n\ngoal (1 subgoal):\n 1. norm\n     ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) -\n      ln x)\n    \\<le> 8 * norm 1", "by simp"], ["proof (state)\nthis:\n  norm\n   ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln (real p) / real p) - ln x)\n  \\<le> 8 * norm 1\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>The contribution of the non-principal characters\\<close>"], ["", "text \\<open>\n  The estimates in the next two sections are partially inspired by John Harrison's\n  proof of Dirichlet's Theorem~\\cite{harrison-dirichlet}.\n\n  We first estimate the growth of the partial sums of\n    \\[-L'(1, \\chi)/L(1, \\chi) = \\sum_{k=1}^\\infty \\chi(k) \\frac{\\Lambda(k)}{k}\\]\n  for a non-principal character $\\chi$ and show that they are, in fact, bounded, which is \n  ultimately a consequence of the non-vanishing of $L(1, \\chi)$ for non-principal $\\chi$.\n\\<close>"], ["", "context dcharacter\nbegin"], ["", "context\n  includes no_vec_lambda_notation dcharacter_syntax\n  fixes L\n  assumes nonprincipal: \"\\<chi> \\<noteq> \\<chi>\\<^sub>0\"\n  defines \"L \\<equiv> Dirichlet_L n \\<chi> 1\"\nbegin"], ["", "lemma Dirichlet_L_nonprincipal_mangoldt_bound_aux_strong:\n  assumes x: \"x > 0\"\n  shows   \"norm (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x - sum_upto (\\<lambda>k. \\<chi> k * ln k / k) x)\n             \\<le> 9 / 2 * real (totient n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "define B where \"B = 3 * real (totient n)\""], ["proof (state)\nthis:\n  B = 3 * real (totient n)\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"sum_upto (\\<lambda>k. \\<chi> k * ln k / k) x = sum_upto (\\<lambda>k. \\<chi> k * (\\<Sum>d | d dvd k. mangoldt d) / k) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto\n     (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x =\n    sum_upto\n     (\\<lambda>k. \\<chi> k * (\\<Sum>d | d dvd k. mangoldt d) / of_nat k) x", "by (intro sum_upto_cong) (simp_all add: mangoldt_sum)"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k)\n   x =\n  sum_upto\n   (\\<lambda>k. \\<chi> k * (\\<Sum>d | d dvd k. mangoldt d) / of_nat k) x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k)\n   x =\n  sum_upto\n   (\\<lambda>k. \\<chi> k * (\\<Sum>d | d dvd k. mangoldt d) / of_nat k) x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"\\<dots> = sum_upto (\\<lambda>k. \\<Sum>d | d dvd k. \\<chi> k * mangoldt d / k) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto\n     (\\<lambda>k. \\<chi> k * (\\<Sum>d | d dvd k. mangoldt d) / of_nat k) x =\n    sum_upto\n     (\\<lambda>k. \\<Sum>d | d dvd k. \\<chi> k * mangoldt d / of_nat k) x", "by (simp add: sum_distrib_left sum_distrib_right sum_divide_distrib)"], ["proof (state)\nthis:\n  sum_upto\n   (\\<lambda>k. \\<chi> k * (\\<Sum>d | d dvd k. mangoldt d) / of_nat k) x =\n  sum_upto (\\<lambda>k. \\<Sum>d | d dvd k. \\<chi> k * mangoldt d / of_nat k)\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  sum_upto\n   (\\<lambda>k. \\<chi> k * (\\<Sum>d | d dvd k. mangoldt d) / of_nat k) x =\n  sum_upto (\\<lambda>k. \\<Sum>d | d dvd k. \\<chi> k * mangoldt d / of_nat k)\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"\\<dots> = sum_upto (\\<lambda>k. sum_upto (\\<lambda>d. \\<chi> (d * k) * mangoldt k / (d * k)) (x / real k)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto\n     (\\<lambda>k. \\<Sum>d | d dvd k. \\<chi> k * mangoldt d / of_nat k) x =\n    sum_upto\n     (\\<lambda>k.\n         sum_upto (\\<lambda>d. \\<chi> (d * k) * mangoldt k / of_nat (d * k))\n          (x / real k))\n     x", "by (rule sum_upto_sum_divisors)"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. \\<Sum>d | d dvd k. \\<chi> k * mangoldt d / of_nat k)\n   x =\n  sum_upto\n   (\\<lambda>k.\n       sum_upto (\\<lambda>d. \\<chi> (d * k) * mangoldt k / of_nat (d * k))\n        (x / real k))\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. \\<Sum>d | d dvd k. \\<chi> k * mangoldt d / of_nat k)\n   x =\n  sum_upto\n   (\\<lambda>k.\n       sum_upto (\\<lambda>d. \\<chi> (d * k) * mangoldt k / of_nat (d * k))\n        (x / real k))\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"\\<dots> = sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k * sum_upto (\\<lambda>d. \\<chi> d / d) (x / real k)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto\n     (\\<lambda>k.\n         sum_upto (\\<lambda>d. \\<chi> (d * k) * mangoldt k / of_nat (d * k))\n          (x / real k))\n     x =\n    sum_upto\n     (\\<lambda>k.\n         \\<chi> k * mangoldt k / of_nat k *\n         sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n     x", "by (simp add: sum_upto_def sum_distrib_left mult_ac)"], ["proof (state)\nthis:\n  sum_upto\n   (\\<lambda>k.\n       sum_upto (\\<lambda>d. \\<chi> (d * k) * mangoldt k / of_nat (d * k))\n        (x / real k))\n   x =\n  sum_upto\n   (\\<lambda>k.\n       \\<chi> k * mangoldt k / of_nat k *\n       sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  sum_upto\n   (\\<lambda>k.\n       sum_upto (\\<lambda>d. \\<chi> (d * k) * mangoldt k / of_nat (d * k))\n        (x / real k))\n   x =\n  sum_upto\n   (\\<lambda>k.\n       \\<chi> k * mangoldt k / of_nat k *\n       sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x - \\<dots> =\n              sum_upto (\\<lambda>k. (L - sum_upto (\\<lambda>d. \\<chi> d / d) (x / real k)) * (\\<chi> k * mangoldt k / k)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n    sum_upto\n     (\\<lambda>k.\n         \\<chi> k * mangoldt k / of_nat k *\n         sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n     x =\n    sum_upto\n     (\\<lambda>k.\n         (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n         (\\<chi> k * mangoldt k / of_nat k))\n     x", "unfolding ring_distribs"], ["proof (prove)\ngoal (1 subgoal):\n 1. L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n    sum_upto\n     (\\<lambda>k.\n         \\<chi> k * mangoldt k / of_nat k *\n         sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n     x =\n    sum_upto\n     (\\<lambda>k.\n         L * (\\<chi> k * mangoldt k / of_nat k) -\n         sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k) *\n         (\\<chi> k * mangoldt k / of_nat k))\n     x", "by (simp add: sum_upto_def sum_subtractf sum_distrib_left mult_ac)"], ["proof (state)\nthis:\n  L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n  sum_upto\n   (\\<lambda>k.\n       \\<chi> k * mangoldt k / of_nat k *\n       sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n   x =\n  sum_upto\n   (\\<lambda>k.\n       (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n       (\\<chi> k * mangoldt k / of_nat k))\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n  sum_upto\n   (\\<lambda>k.\n       \\<chi> k * mangoldt k / of_nat k *\n       sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n   x =\n  sum_upto\n   (\\<lambda>k.\n       (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n       (\\<chi> k * mangoldt k / of_nat k))\n   x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"norm \\<dots> \\<le> sum_upto (\\<lambda>k. B / x * mangoldt k) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod\n     (sum_upto\n       (\\<lambda>k.\n           (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n           (\\<chi> k * mangoldt k / of_nat k))\n       x)\n    \\<le> sum_upto (\\<lambda>k. B / x * mangoldt k) x", "unfolding sum_upto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod\n     (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n        (L -\n         (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real k}.\n            \\<chi> d / of_nat d)) *\n        (\\<chi> k * mangoldt k / of_nat k))\n    \\<le> (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}. B / x * mangoldt k)", "proof (rule sum_norm_le, goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       cmod\n        ((L -\n          (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real xa}.\n             \\<chi> d / of_nat d)) *\n         (\\<chi> xa * mangoldt xa / of_nat xa))\n       \\<le> B / x * mangoldt xa", "case (1 k)"], ["proof (state)\nthis:\n  k \\<in> {i. 0 < i \\<and> real i \\<le> x}\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       cmod\n        ((L -\n          (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real xa}.\n             \\<chi> d / of_nat d)) *\n         (\\<chi> xa * mangoldt xa / of_nat xa))\n       \\<le> B / x * mangoldt xa", "have \"norm ((L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / k)) * \\<chi> k * (mangoldt k / of_nat k)) \\<le>\n            (B * real k / x) * 1 * (mangoldt k / real k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod\n     ((L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n      \\<chi> k *\n      (mangoldt k / of_nat k))\n    \\<le> B * real k / x * 1 * (mangoldt k / real k)", "unfolding norm_mult norm_divide"], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n    cmod (\\<chi> k) *\n    (cmod (mangoldt k) / cmod (of_nat k))\n    \\<le> B * real k / x * 1 * (mangoldt k / real k)", "proof (intro mult_mono divide_left_mono)"], ["proof (state)\ngoal (7 subgoals):\n 1. cmod (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n    \\<le> B * real k / x\n 2. cmod (\\<chi> k) \\<le> 1\n 3. 0 \\<le> B * real k / x\n 4. 0 \\<le> cmod (\\<chi> k)\n 5. cmod (mangoldt k) / cmod (of_nat k) \\<le> mangoldt k / real k\n 6. 0 \\<le> B * real k / x * 1\n 7. 0 \\<le> cmod (mangoldt k) / cmod (of_nat k)", "show \"norm (L - sum_upto (\\<lambda>d. \\<chi> d / d) (x / k)) \\<le> B * real k / x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n    \\<le> B * real k / x", "using Dirichlet_L_minus_partial_sum_bound[OF nonprincipal, of 1 \"x / k\"] 1 x"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < Re 1; 0 < x / real k\\<rbrakk>\n  \\<Longrightarrow> cmod\n                     (sum_upto (\\<lambda>n. \\<chi> n * of_nat n powr - 1)\n                       (x / real k) -\n                      Dirichlet_L n \\<chi> 1)\n                    \\<le> real (totient n) * (2 + cmod 1 / Re 1) /\n                          (x / real k) powr Re 1\n  k \\<in> {i. 0 < i \\<and> real i \\<le> x}\n  0 < x\n\ngoal (1 subgoal):\n 1. cmod (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n    \\<le> B * real k / x", "by (simp add: powr_minus B_def L_def divide_simps norm_minus_commute)"], ["proof (state)\nthis:\n  cmod (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k))\n  \\<le> B * real k / x\n\ngoal (6 subgoals):\n 1. cmod (\\<chi> k) \\<le> 1\n 2. 0 \\<le> B * real k / x\n 3. 0 \\<le> cmod (\\<chi> k)\n 4. cmod (mangoldt k) / cmod (of_nat k) \\<le> mangoldt k / real k\n 5. 0 \\<le> B * real k / x * 1\n 6. 0 \\<le> cmod (mangoldt k) / cmod (of_nat k)", "qed (insert 1, auto intro!: divide_nonneg_pos mangoldt_nonneg norm_le_1 simp: B_def)"], ["proof (state)\nthis:\n  cmod\n   ((L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n    \\<chi> k *\n    (mangoldt k / of_nat k))\n  \\<le> B * real k / x * 1 * (mangoldt k / real k)\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       cmod\n        ((L -\n          (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real xa}.\n             \\<chi> d / of_nat d)) *\n         (\\<chi> xa * mangoldt xa / of_nat xa))\n       \\<le> B / x * mangoldt xa", "also"], ["proof (state)\nthis:\n  cmod\n   ((L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n    \\<chi> k *\n    (mangoldt k / of_nat k))\n  \\<le> B * real k / x * 1 * (mangoldt k / real k)\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       cmod\n        ((L -\n          (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real xa}.\n             \\<chi> d / of_nat d)) *\n         (\\<chi> xa * mangoldt xa / of_nat xa))\n       \\<le> B / x * mangoldt xa", "have \"\\<dots> =  B / x * mangoldt k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B * real k / x * 1 * (mangoldt k / real k) = B / x * mangoldt k", "using 1"], ["proof (prove)\nusing this:\n  k \\<in> {i. 0 < i \\<and> real i \\<le> x}\n\ngoal (1 subgoal):\n 1. B * real k / x * 1 * (mangoldt k / real k) = B / x * mangoldt k", "by simp"], ["proof (state)\nthis:\n  B * real k / x * 1 * (mangoldt k / real k) = B / x * mangoldt k\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       xa \\<in> {i. 0 < i \\<and> real i \\<le> x} \\<Longrightarrow>\n       cmod\n        ((L -\n          (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real xa}.\n             \\<chi> d / of_nat d)) *\n         (\\<chi> xa * mangoldt xa / of_nat xa))\n       \\<le> B / x * mangoldt xa", "finally"], ["proof (chain)\npicking this:\n  cmod\n   ((L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n    \\<chi> k *\n    (mangoldt k / of_nat k))\n  \\<le> B / x * mangoldt k", "show ?case"], ["proof (prove)\nusing this:\n  cmod\n   ((L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n    \\<chi> k *\n    (mangoldt k / of_nat k))\n  \\<le> B / x * mangoldt k\n\ngoal (1 subgoal):\n 1. cmod\n     ((L -\n       (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real k}.\n          \\<chi> d / of_nat d)) *\n      (\\<chi> k * mangoldt k / of_nat k))\n    \\<le> B / x * mangoldt k", "by (simp add: sum_upto_def mult_ac)"], ["proof (state)\nthis:\n  cmod\n   ((L -\n     (\\<Sum>d\\<in>{i. 0 < i \\<and> real i \\<le> x / real k}.\n        \\<chi> d / of_nat d)) *\n    (\\<chi> k * mangoldt k / of_nat k))\n  \\<le> B / x * mangoldt k\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  cmod\n   (sum_upto\n     (\\<lambda>k.\n         (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n         (\\<chi> k * mangoldt k / of_nat k))\n     x)\n  \\<le> sum_upto (\\<lambda>k. B / x * mangoldt k) x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  cmod\n   (sum_upto\n     (\\<lambda>k.\n         (L - sum_upto (\\<lambda>d. \\<chi> d / of_nat d) (x / real k)) *\n         (\\<chi> k * mangoldt k / of_nat k))\n     x)\n  \\<le> sum_upto (\\<lambda>k. B / x * mangoldt k) x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"\\<dots> = B / x * sum_upto mangoldt x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. B / x * mangoldt k) x =\n    B / x * sum_upto mangoldt x", "unfolding sum_upto_def sum_distrib_left"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}. B / x * mangoldt k) =\n    (\\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}. B / x * mangoldt n)", "by simp"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. B / x * mangoldt k) x = B / x * sum_upto mangoldt x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. B / x * mangoldt k) x = B / x * sum_upto mangoldt x\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"\\<dots> \\<le> B / x * (3 / 2 * x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B / x * sum_upto mangoldt x \\<le> B / x * (3 / 2 * x)", "using x"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. B / x * sum_upto mangoldt x \\<le> B / x * (3 / 2 * x)", "by (intro mult_left_mono sum_upto_mangoldt_le) (auto simp: B_def)"], ["proof (state)\nthis:\n  B / x * sum_upto mangoldt x \\<le> B / x * (3 / 2 * x)\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "also"], ["proof (state)\nthis:\n  B / x * sum_upto mangoldt x \\<le> B / x * (3 / 2 * x)\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "have \"\\<dots> = 9 / 2 * real (totient n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B / x * (3 / 2 * x) = 9 / 2 * real (totient n)", "using x"], ["proof (prove)\nusing this:\n  0 < x\n\ngoal (1 subgoal):\n 1. B / x * (3 / 2 * x) = 9 / 2 * real (totient n)", "by (simp add: B_def)"], ["proof (state)\nthis:\n  B / x * (3 / 2 * x) = 9 / 2 * real (totient n)\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "finally"], ["proof (chain)\npicking this:\n  cmod\n   (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n    sum_upto\n     (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n  \\<le> 9 / 2 * real (totient n)", "show ?thesis"], ["proof (prove)\nusing this:\n  cmod\n   (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n    sum_upto\n     (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n  \\<le> 9 / 2 * real (totient n)\n\ngoal (1 subgoal):\n 1. cmod\n     (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n    \\<le> 9 / 2 * real (totient n)", "by (simp add: B_def)"], ["proof (state)\nthis:\n  cmod\n   (L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n    sum_upto\n     (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n  \\<le> 9 / 2 * real (totient n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Dirichlet_L_nonprincipal_mangoldt_aux_bound:\n  \"(\\<lambda>x. L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x - sum_upto (\\<lambda>k. \\<chi> k * ln k / k) x) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n        sum_upto\n         (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k)\n         x)\n    \\<in> O(\\<lambda>_. 1)", "by (intro bigoI[of _ \"9 / 2 * real (totient n)\"] eventually_mono[OF eventually_gt_at_top[of 0]])\n     (use Dirichlet_L_nonprincipal_mangoldt_bound_aux_strong in simp_all)"], ["", "lemma nonprincipal_mangoldt_bound:\n  \"(\\<lambda>x. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x) \\<in> O(\\<lambda>_. 1)\" (is \"?lhs \\<in> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "have [simp]: \"L \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. L \\<noteq> 0", "using nonprincipal"], ["proof (prove)\nusing this:\n  \\<chi> \\<noteq> \\<chi>\\<^sub>0\n\ngoal (1 subgoal):\n 1. L \\<noteq> 0", "unfolding L_def"], ["proof (prove)\nusing this:\n  \\<chi> \\<noteq> \\<chi>\\<^sub>0\n\ngoal (1 subgoal):\n 1. Dirichlet_L n \\<chi> 1 \\<noteq> 0", "by (intro Dirichlet_L_Re_ge_1_nonzero_nonprincipal) auto"], ["proof (state)\nthis:\n  L \\<noteq> 0\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "have \"fds_converges (fds_deriv (fds \\<chi>)) 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fds_converges (fds_deriv (fds \\<chi>)) 1", "using conv_abscissa_le_0[OF nonprincipal]"], ["proof (prove)\nusing this:\n  conv_abscissa (fds \\<chi>) \\<le> 0\n\ngoal (1 subgoal):\n 1. fds_converges (fds_deriv (fds \\<chi>)) 1", "by (intro fds_converges_deriv) (auto intro: le_less_trans)"], ["proof (state)\nthis:\n  fds_converges (fds_deriv (fds \\<chi>)) 1\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "hence \"summable (\\<lambda>n. -(\\<chi> n * ln n / n))\""], ["proof (prove)\nusing this:\n  fds_converges (fds_deriv (fds \\<chi>)) 1\n\ngoal (1 subgoal):\n 1. summable\n     (\\<lambda>n. - (\\<chi> n * complex_of_real (ln (real n)) / of_nat n))", "by (auto simp: fds_converges_def fds_deriv_def scaleR_conv_of_real fds_nth_fds' algebra_simps)"], ["proof (state)\nthis:\n  summable\n   (\\<lambda>n. - (\\<chi> n * complex_of_real (ln (real n)) / of_nat n))\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "hence \"summable (\\<lambda>n. \\<chi> n * ln n / n)\""], ["proof (prove)\nusing this:\n  summable\n   (\\<lambda>n. - (\\<chi> n * complex_of_real (ln (real n)) / of_nat n))\n\ngoal (1 subgoal):\n 1. summable\n     (\\<lambda>n. \\<chi> n * complex_of_real (ln (real n)) / of_nat n)", "by (simp only: summable_minus_iff)"], ["proof (state)\nthis:\n  summable (\\<lambda>n. \\<chi> n * complex_of_real (ln (real n)) / of_nat n)\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "from summable_imp_convergent_sum_upto [OF this]"], ["proof (chain)\npicking this:\n  (\\<And>c.\n      (sum_upto\n        (\\<lambda>n.\n            \\<chi> n * complex_of_real (ln (real n)) /\n            of_nat n) \\<longlongrightarrow>\n       c)\n       at_top \\<Longrightarrow>\n      ?thesis) \\<Longrightarrow>\n  ?thesis", "obtain c where\n    \"(sum_upto (\\<lambda>n. \\<chi> n * ln n / n) \\<longlongrightarrow> c) at_top\""], ["proof (prove)\nusing this:\n  (\\<And>c.\n      (sum_upto\n        (\\<lambda>n.\n            \\<chi> n * complex_of_real (ln (real n)) /\n            of_nat n) \\<longlongrightarrow>\n       c)\n       at_top \\<Longrightarrow>\n      ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        (sum_upto\n          (\\<lambda>n.\n              \\<chi> n * complex_of_real (ln (real n)) /\n              of_nat n) \\<longlongrightarrow>\n         c)\n         at_top \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  (sum_upto\n    (\\<lambda>n.\n        \\<chi> n * complex_of_real (ln (real n)) /\n        of_nat n) \\<longlongrightarrow>\n   c)\n   at_top\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "hence *: \"sum_upto (\\<lambda>k. \\<chi> k * ln k / k) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\nusing this:\n  (sum_upto\n    (\\<lambda>n.\n        \\<chi> n * complex_of_real (ln (real n)) /\n        of_nat n) \\<longlongrightarrow>\n   c)\n   at_top\n\ngoal (1 subgoal):\n 1. sum_upto\n     (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "unfolding sum_upto_def"], ["proof (prove)\nusing this:\n  ((\\<lambda>x.\n       \\<Sum>n\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n         \\<chi> n * complex_of_real (ln (real n)) /\n         of_nat n) \\<longlongrightarrow>\n   c)\n   at_top\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        \\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n          \\<chi> k * complex_of_real (ln (real k)) / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "by (intro bigoI_tendsto[of _ _ c]) auto"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "from sum_in_bigo[OF Dirichlet_L_nonprincipal_mangoldt_aux_bound *]"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x +\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n  \\<in> O(\\<lambda>_. 1)\n  (\\<lambda>x.\n      L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n  \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x +\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n  \\<in> O(\\<lambda>_. 1)\n  (\\<lambda>x.\n      L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x -\n      sum_upto\n       (\\<lambda>k. \\<chi> k * complex_of_real (ln (real k)) / of_nat k) x)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)\n    \\<in> O(\\<lambda>_. 1)", "by (simp add: L_def)"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "thus ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      L * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n    \\<in> O(\\<lambda>_. 1)", "by simp"], ["proof (state)\nthis:\n  sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "end"], ["", "subsection \\<open>The contribution of the principal character\\<close>"], ["", "text \\<open>\n  Next, we turn to the analogous partial sum for the principal character and show that\n  it grows logarithmically and therefore is the dominant contribution.\n\\<close>"], ["", "context residues_nat\nbegin"], ["", "context\n  includes no_vec_lambda_notation dcharacter_syntax\nbegin"], ["", "lemma principal_dchar_sum_bound:\n  \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> real p \\<le> x. \\<chi>\\<^sub>0 p * (ln p / p)) - ln x) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "have fin [simp]: \"finite {p. prime p \\<and> real p \\<le> x \\<and> Q p}\" for Q x"], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> real p \\<le> x \\<and> Q p}", "by (rule finite_subset[of _ \"{..nat \\<lfloor>x\\<rfloor>}\"]) (auto simp: le_nat_iff le_floor_iff)"], ["proof (state)\nthis:\n  finite {p. prime p \\<and> real p \\<le> ?x \\<and> ?Q p}\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "from fin[of _ \"\\<lambda>_. True\"]"], ["proof (chain)\npicking this:\n  finite {p. prime p \\<and> real p \\<le> ?x \\<and> True}", "have [simp]: \"finite {p. prime p \\<and> real p \\<le> x}\" for x"], ["proof (prove)\nusing this:\n  finite {p. prime p \\<and> real p \\<le> ?x \\<and> True}\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> real p \\<le> x}", "by (simp del: fin)"], ["proof (state)\nthis:\n  finite {p. prime p \\<and> real p \\<le> ?x}\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "define P :: complex where \"P = (\\<Sum>p | prime p \\<and> p dvd n. of_real (ln p / p))\""], ["proof (state)\nthis:\n  P =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p dvd n}.\n     complex_of_real (ln (real x) / real x))\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> real p \\<le> x. \\<chi>\\<^sub>0 p * (ln p / p)) - ln x) \\<in>\n          \\<Theta>(\\<lambda>x. of_real ((\\<Sum>p | prime p \\<and> real p \\<le> x. ln p / p) - ln x) - P)\" (is \"_ \\<in> \\<Theta>(?f)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> \\<Theta>(\\<lambda>x.\n                      complex_of_real\n                       ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n                           ln (real x) / real x) -\n                        ln x) -\n                      P)", "proof (intro bigthetaI_cong eventually_mono[OF eventually_gt_at_top[of \"real n\"]], goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "case (1 x)"], ["proof (state)\nthis:\n  real n < x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "have *: \"{p. prime p \\<and> real p \\<le> x} = \n               {p. prime p \\<and> real p \\<le> x \\<and> p dvd n} \\<union> {p. prime p \\<and> real p \\<le> x \\<and> \\<not>p dvd n}\"\n      (is \"_ = ?A \\<union> ?B\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. {p. prime p \\<and> real p \\<le> x} =\n    {p. prime p \\<and> real p \\<le> x \\<and> p dvd n} \\<union>\n    {p. prime p \\<and> real p \\<le> x \\<and> \\<not> p dvd n}", "by auto"], ["proof (state)\nthis:\n  {p. prime p \\<and> real p \\<le> x} =\n  {p. prime p \\<and> real p \\<le> x \\<and> p dvd n} \\<union>\n  {p. prime p \\<and> real p \\<le> x \\<and> \\<not> p dvd n}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "have \"(\\<Sum>p | prime p \\<and> real p \\<le> x. of_real (ln p / p)) = \n            (\\<Sum>p\\<in>?A. of_real (ln p / p)) + (\\<Sum>p\\<in>?B. complex_of_real (ln p / p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n       complex_of_real (ln (real x) / real x)) =\n    (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> p dvd n.\n       complex_of_real (ln (real p) / real p)) +\n    (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> \\<not> p dvd n.\n       complex_of_real (ln (real p) / real p))", "by (subst *, subst sum.union_disjoint) auto"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n     complex_of_real (ln (real x) / real x)) =\n  (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> p dvd n.\n     complex_of_real (ln (real p) / real p)) +\n  (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> \\<not> p dvd n.\n     complex_of_real (ln (real p) / real p))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n     complex_of_real (ln (real x) / real x)) =\n  (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> p dvd n.\n     complex_of_real (ln (real p) / real p)) +\n  (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> \\<not> p dvd n.\n     complex_of_real (ln (real p) / real p))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "from 1"], ["proof (chain)\npicking this:\n  real n < x", "have \"?A = {p. prime p \\<and> p dvd n}\""], ["proof (prove)\nusing this:\n  real n < x\n\ngoal (1 subgoal):\n 1. {p. prime p \\<and> real p \\<le> x \\<and> p dvd n} =\n    {p. prime p \\<and> p dvd n}", "using n"], ["proof (prove)\nusing this:\n  real n < x\n  1 < n\n\ngoal (1 subgoal):\n 1. {p. prime p \\<and> real p \\<le> x \\<and> p dvd n} =\n    {p. prime p \\<and> p dvd n}", "by (auto dest: dvd_imp_le)"], ["proof (state)\nthis:\n  {p. prime p \\<and> real p \\<le> x \\<and> p dvd n} =\n  {p. prime p \\<and> p dvd n}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "also"], ["proof (state)\nthis:\n  {p. prime p \\<and> real p \\<le> x \\<and> p dvd n} =\n  {p. prime p \\<and> p dvd n}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "have \"(\\<Sum>p\\<in>\\<dots>. of_real (ln p / p)) = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p dvd n.\n       complex_of_real (ln (real p) / real p)) =\n    P", "by (simp add: P_def)"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p dvd n.\n     complex_of_real (ln (real p) / real p)) =\n  P\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "also"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p dvd n.\n     complex_of_real (ln (real p) / real p)) =\n  P\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "have \"(\\<Sum>p\\<in>?B. of_real (ln p / p)) = \n                 (\\<Sum>p | prime p \\<and> real p \\<le> x. \\<chi>\\<^sub>0 p * (ln p / p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> \\<not> p dvd n.\n       complex_of_real (ln (real p) / real p)) =\n    (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))", "by (intro sum.mono_neutral_cong_left)\n         (auto simp: principal_dchar_def prime_gt_0_nat coprime_absorb_left prime_imp_coprime)"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> real p \\<le> x \\<and> \\<not> p dvd n.\n     complex_of_real (ln (real p) / real p)) =\n  (\\<Sum>p | prime p \\<and> real p \\<le> x.\n     \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       real n < x \\<Longrightarrow>\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n       Ln (complex_of_real x) =\n       complex_of_real\n        ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x) -\n       P", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n     complex_of_real (ln (real x) / real x)) =\n  P +\n  (\\<Sum>p | prime p \\<and> real p \\<le> x.\n     \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))", "show ?case"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n     complex_of_real (ln (real x) / real x)) =\n  P +\n  (\\<Sum>p | prime p \\<and> real p \\<le> x.\n     \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))\n\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n    Ln (complex_of_real x) =\n    complex_of_real\n     ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n         ln (real x) / real x) -\n      ln x) -\n    P", "using 1"], ["proof (prove)\nusing this:\n  (\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n     complex_of_real (ln (real x) / real x)) =\n  P +\n  (\\<Sum>p | prime p \\<and> real p \\<le> x.\n     \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))\n  real n < x\n\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n    Ln (complex_of_real x) =\n    complex_of_real\n     ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n         ln (real x) / real x) -\n      ln x) -\n    P", "by (simp add: Ln_of_real)"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> real p \\<le> x.\n     \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n  Ln (complex_of_real x) =\n  complex_of_real\n   ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}. ln (real x) / real x) -\n    ln x) -\n  P\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n      Ln (complex_of_real x))\n  \\<in> \\<Theta>(\\<lambda>x.\n                    complex_of_real\n                     ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n                         ln (real x) / real x) -\n                      ln x) -\n                    P)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "also"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n      Ln (complex_of_real x))\n  \\<in> \\<Theta>(\\<lambda>x.\n                    complex_of_real\n                     ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n                         ln (real x) / real x) -\n                      ln x) -\n                    P)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "have \"?f \\<in> O(\\<lambda>_. of_real 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        complex_of_real\n         ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n             ln (real x) / real x) -\n          ln x) -\n        P)\n    \\<in> O(\\<lambda>_. complex_of_real 1)", "by (rule sum_in_bigo, subst landau_o.big.of_real_iff, rule Mertens_bigo) auto"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      complex_of_real\n       ((\\<Sum>x\\<in>{p. prime p \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x) -\n      P)\n  \\<in> O(\\<lambda>_. complex_of_real 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n      Ln (complex_of_real x))\n  \\<in> O(\\<lambda>_. complex_of_real 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n      Ln (complex_of_real x))\n  \\<in> O(\\<lambda>_. complex_of_real 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n      Ln (complex_of_real x))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma principal_dchar_sum_bound':\n  \"(\\<lambda>x. sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / k) x - Ln x) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / k) x -\n               (\\<Sum>p | prime p \\<and> real p \\<le> x. \\<chi>\\<^sub>0 p * (ln p / p))) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        (\\<Sum>p | prime p \\<and> real p \\<le> x.\n           \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n    \\<in> O(\\<lambda>_. 1)", "proof (intro bigoI[of _ 3] eventually_mono[OF eventually_gt_at_top[of 0]], goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       cmod\n        (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n         (\\<Sum>p | prime p \\<and> real p \\<le> x.\n            \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n       \\<le> 3 * cmod 1", "case (1 x)"], ["proof (state)\nthis:\n  0 < x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       cmod\n        (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n         (\\<Sum>p | prime p \\<and> real p \\<le> x.\n            \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n       \\<le> 3 * cmod 1", "have \"norm (complex_of_real (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / k) - \n                of_real (\\<Sum>p | prime p \\<and> p \\<in> {k. real k \\<le> x \\<and> coprime k n}. ln p / p)) \\<le> 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod\n     (complex_of_real\n       (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / real k) -\n      complex_of_real\n       (\\<Sum>x\\<in>{p. prime p \\<and>\n                        p \\<in> {k. real k \\<le> x \\<and> coprime k n}}.\n          ln (real x) / real x))\n    \\<le> 3", "unfolding of_real_diff [symmetric] norm_of_real"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>k | real k \\<le> x \\<and> coprime k n.\n             mangoldt k / real k) -\n          (\\<Sum>x\\<in>{p. prime p \\<and>\n                           p \\<in> {k. real k \\<le> x \\<and> coprime k n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "by (rule Mertens_mangoldt_versus_ln[where n = \"nat \\<lfloor>x\\<rfloor>\"])\n         (insert n, auto simp: Suc_le_eq le_nat_iff le_floor_iff intro!: Nat.gr0I)"], ["proof (state)\nthis:\n  cmod\n   (complex_of_real\n     (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / real k) -\n    complex_of_real\n     (\\<Sum>x\\<in>{p. prime p \\<and>\n                      p \\<in> {k. real k \\<le> x \\<and> coprime k n}}.\n        ln (real x) / real x))\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       cmod\n        (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n         (\\<Sum>p | prime p \\<and> real p \\<le> x.\n            \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n       \\<le> 3 * cmod 1", "also"], ["proof (state)\nthis:\n  cmod\n   (complex_of_real\n     (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / real k) -\n    complex_of_real\n     (\\<Sum>x\\<in>{p. prime p \\<and>\n                      p \\<in> {k. real k \\<le> x \\<and> coprime k n}}.\n        ln (real x) / real x))\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       cmod\n        (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n         (\\<Sum>p | prime p \\<and> real p \\<le> x.\n            \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n       \\<le> 3 * cmod 1", "have \"complex_of_real (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / k) =\n                 sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / k) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / real k) =\n    sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x", "unfolding sum_upto_def of_real_sum"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{k. real k \\<le> x \\<and> coprime k n}.\n       complex_of_real (mangoldt x / real x)) =\n    (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n       \\<chi>\\<^sub>0 k * mangoldt k / of_nat k)", "using n"], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{k. real k \\<le> x \\<and> coprime k n}.\n       complex_of_real (mangoldt x / real x)) =\n    (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n       \\<chi>\\<^sub>0 k * mangoldt k / of_nat k)", "by (intro sum.mono_neutral_cong_left) (auto simp: principal_dchar_def intro!: Nat.gr0I)"], ["proof (state)\nthis:\n  complex_of_real\n   (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / real k) =\n  sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       cmod\n        (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n         (\\<Sum>p | prime p \\<and> real p \\<le> x.\n            \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n       \\<le> 3 * cmod 1", "also"], ["proof (state)\nthis:\n  complex_of_real\n   (\\<Sum>k | real k \\<le> x \\<and> coprime k n. mangoldt k / real k) =\n  sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       cmod\n        (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n         (\\<Sum>p | prime p \\<and> real p \\<le> x.\n            \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n       \\<le> 3 * cmod 1", "have \"complex_of_real (\\<Sum>p | prime p \\<and> p \\<in> {k. real k \\<le> x \\<and> coprime k n}. ln p / p) =\n                 (\\<Sum>p | prime p \\<and> real p \\<le> x. \\<chi>\\<^sub>0 p * (ln p / p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (\\<Sum>x\\<in>{p. prime p \\<and>\n                      p \\<in> {k. real k \\<le> x \\<and> coprime k n}}.\n        ln (real x) / real x) =\n    (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))", "unfolding of_real_sum"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{p. prime p \\<and>\n                     p \\<in> {k. real k \\<le> x \\<and> coprime k n}}.\n       complex_of_real (ln (real x) / real x)) =\n    (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))", "by (intro sum.mono_neutral_cong_left)\n         (auto simp: principal_dchar_def le_nat_iff le_floor_iff prime_gt_0_nat\n               intro!: finite_subset[of _ \"{..nat \\<lfloor>x\\<rfloor>}\"])"], ["proof (state)\nthis:\n  complex_of_real\n   (\\<Sum>x\\<in>{p. prime p \\<and>\n                    p \\<in> {k. real k \\<le> x \\<and> coprime k n}}.\n      ln (real x) / real x) =\n  (\\<Sum>p | prime p \\<and> real p \\<le> x.\n     \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       cmod\n        (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n         (\\<Sum>p | prime p \\<and> real p \\<le> x.\n            \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n       \\<le> 3 * cmod 1", "finally"], ["proof (chain)\npicking this:\n  cmod\n   (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n    (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n  \\<le> 3", "show ?case"], ["proof (prove)\nusing this:\n  cmod\n   (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n    (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. cmod\n     (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n    \\<le> 3 * cmod 1", "by simp"], ["proof (state)\nthis:\n  cmod\n   (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n    (\\<Sum>p | prime p \\<and> real p \\<le> x.\n       \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n  \\<le> 3 * cmod 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "from sum_in_bigo(1)[OF principal_dchar_sum_bound this]"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n      Ln (complex_of_real x) +\n      (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))))\n  \\<in> O(\\<lambda>_. 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> real p \\<le> x.\n         \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p)) -\n      Ln (complex_of_real x) +\n      (sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       (\\<Sum>p | prime p \\<and> real p \\<le> x.\n          \\<chi>\\<^sub>0 p * (Ln (of_nat p) / of_nat p))))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. 1)", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n      Ln (complex_of_real x))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>The main result\\<close>"], ["", "text \\<open>\n  We can now show the main result by extracting the primes we want using the orthogonality\n  relation on characters, separating the principal part of the sum from the non-principal ones\n  and then applying the above estimates.\n\\<close>"], ["", "lemma Dirichlet_strong:\n  assumes \"coprime h n\"\n  shows   \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x. ln p / p) - ln x / totient n)\n             \\<in> O(\\<lambda>_. 1)\" (is \"(\\<lambda>x. sum _ (?A x) - _) \\<in> _\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "from assms"], ["proof (chain)\npicking this:\n  coprime h n", "obtain h' where h': \"[h * h' = Suc 0] (mod n)\""], ["proof (prove)\nusing this:\n  coprime h n\n\ngoal (1 subgoal):\n 1. (\\<And>h'.\n        [h * h' = Suc 0] (mod n) \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (subst (asm) coprime_iff_invertible_nat) blast"], ["proof (state)\nthis:\n  [h * h' = Suc 0] (mod n)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "let ?A' = \"\\<lambda>x. {p. p > 0 \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "let ?B = \"dcharacters n - {\\<chi>\\<^sub>0}\""], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "have [simp]: \"\\<chi>\\<^sub>0 \\<in> dcharacters n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<chi>\\<^sub>0 \\<in> dcharacters n", "by (auto simp: dcharacters_def principal.dcharacter_axioms)"], ["proof (state)\nthis:\n  \\<chi>\\<^sub>0 \\<in> dcharacters n\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. of_nat (totient n) * (\\<Sum>p\\<in>?A' x. mangoldt p / p) - ln x) \\<in>\n             \\<Theta>(\\<lambda>x. sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / k) x - ln x +\n                  (\\<Sum>\\<chi>\\<in>?B. \\<chi> h' * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / k) x))\"\n    (is \"_ \\<in> \\<Theta>(?f)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        complex_of_real\n         (real (totient n) *\n          (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n             mangoldt p / real p) -\n          ln x))\n    \\<in> \\<Theta>(\\<lambda>x.\n                      sum_upto\n                       (\\<lambda>k.\n                           \\<chi>\\<^sub>0 k * mangoldt k / of_nat k)\n                       x -\n                      Ln (complex_of_real x) +\n                      (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n                         \\<chi> h' *\n                         sum_upto\n                          (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x))", "proof (intro bigthetaI_cong eventually_mono[OF eventually_gt_at_top[of 0]], goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "case (1 x)"], ["proof (state)\nthis:\n  0 < x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "have \"of_nat (totient n) * (\\<Sum>p\\<in>?A' x. of_real (mangoldt p / p) :: complex) = \n            (\\<Sum>p\\<in>?A' x. of_nat (totient n) * of_real (mangoldt p / p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. of_nat (totient n) *\n    (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n       complex_of_real (mangoldt p / real p)) =\n    (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n       of_nat (totient n) * complex_of_real (mangoldt p / real p))", "by (subst sum_distrib_left) simp_all"], ["proof (state)\nthis:\n  of_nat (totient n) *\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     complex_of_real (mangoldt p / real p)) =\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     of_nat (totient n) * complex_of_real (mangoldt p / real p))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "also"], ["proof (state)\nthis:\n  of_nat (totient n) *\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     complex_of_real (mangoldt p / real p)) =\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     of_nat (totient n) * complex_of_real (mangoldt p / real p))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "have \"\\<dots> = sum_upto (\\<lambda>k. \\<Sum>\\<chi>\\<in>dcharacters n. \\<chi> (h' * k) * (mangoldt k / k)) x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n       of_nat (totient n) * complex_of_real (mangoldt p / real p)) =\n    sum_upto\n     (\\<lambda>k.\n         \\<Sum>\\<chi>\\<in>dcharacters n.\n           \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n     x", "unfolding sum_upto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n       of_nat (totient n) * complex_of_real (mangoldt p / real p)) =\n    (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n       \\<Sum>\\<chi>\\<in>dcharacters n.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))", "proof (intro sum.mono_neutral_cong_left ballI, goal_cases)"], ["proof (state)\ngoal (4 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>i.\n       i \\<in> {i. 0 < i \\<and> real i \\<le> x} -\n               {p. 0 < p \\<and>\n                   real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * i) * complex_of_real (mangoldt i / real i)) =\n       0\n 4. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "case (3 p)"], ["proof (state)\nthis:\n  p \\<in> {i. 0 < i \\<and> real i \\<le> x} -\n          {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n\ngoal (4 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>i.\n       i \\<in> {i. 0 < i \\<and> real i \\<le> x} -\n               {p. 0 < p \\<and>\n                   real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * i) * complex_of_real (mangoldt i / real i)) =\n       0\n 4. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "have \"[h' * p \\<noteq> 1] (mod n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. [h' * p \\<noteq> 1] (mod n)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n) \\<Longrightarrow> False", "assume \"[h' * p = 1] (mod n)\""], ["proof (state)\nthis:\n  [h' * p = 1] (mod n)\n\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n) \\<Longrightarrow> False", "hence \"[h * (h' * p) = h * 1] (mod n)\""], ["proof (prove)\nusing this:\n  [h' * p = 1] (mod n)\n\ngoal (1 subgoal):\n 1. [h * (h' * p) = h * 1] (mod n)", "by (rule cong_scalar_left)"], ["proof (state)\nthis:\n  [h * (h' * p) = h * 1] (mod n)\n\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n) \\<Longrightarrow> False", "hence \"[h = h * h' * p] (mod n)\""], ["proof (prove)\nusing this:\n  [h * (h' * p) = h * 1] (mod n)\n\ngoal (1 subgoal):\n 1. [h = h * h' * p] (mod n)", "by (simp add: mult_ac cong_sym)"], ["proof (state)\nthis:\n  [h = h * h' * p] (mod n)\n\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n) \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  [h = h * h' * p] (mod n)\n\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n) \\<Longrightarrow> False", "have \"[h * h' * p = 1 * p] (mod n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. [h * h' * p = 1 * p] (mod n)", "using h'"], ["proof (prove)\nusing this:\n  [h * h' = Suc 0] (mod n)\n\ngoal (1 subgoal):\n 1. [h * h' * p = 1 * p] (mod n)", "by (intro cong_scalar_right) auto"], ["proof (state)\nthis:\n  [h * h' * p = 1 * p] (mod n)\n\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n) \\<Longrightarrow> False", "finally"], ["proof (chain)\npicking this:\n  [h = 1 * p] (mod n)", "have \"[p = h] (mod n)\""], ["proof (prove)\nusing this:\n  [h = 1 * p] (mod n)\n\ngoal (1 subgoal):\n 1. [p = h] (mod n)", "by (simp add: cong_sym)"], ["proof (state)\nthis:\n  [p = h] (mod n)\n\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n) \\<Longrightarrow> False", "with 3"], ["proof (chain)\npicking this:\n  p \\<in> {i. 0 < i \\<and> real i \\<le> x} -\n          {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n  [p = h] (mod n)", "show False"], ["proof (prove)\nusing this:\n  p \\<in> {i. 0 < i \\<and> real i \\<le> x} -\n          {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n  [p = h] (mod n)\n\ngoal (1 subgoal):\n 1. False", "by auto"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  [h' * p \\<noteq> 1] (mod n)\n\ngoal (4 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>i.\n       i \\<in> {i. 0 < i \\<and> real i \\<le> x} -\n               {p. 0 < p \\<and>\n                   real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * i) * complex_of_real (mangoldt i / real i)) =\n       0\n 4. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "thus ?case"], ["proof (prove)\nusing this:\n  [h' * p \\<noteq> 1] (mod n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<chi> (h' * p) * complex_of_real (mangoldt p / real p)) =\n    0", "by (auto simp: sum_dcharacters sum_divide_distrib [symmetric] sum_distrib_right [symmetric])"], ["proof (state)\nthis:\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     \\<chi> (h' * p) * complex_of_real (mangoldt p / real p)) =\n  0\n\ngoal (3 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "case (4 p)"], ["proof (state)\nthis:\n  p \\<in> {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n\ngoal (3 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "hence \"[p * h' = h * h'] (mod n)\""], ["proof (prove)\nusing this:\n  p \\<in> {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n\ngoal (1 subgoal):\n 1. [p * h' = h * h'] (mod n)", "by (intro cong_scalar_right) auto"], ["proof (state)\nthis:\n  [p * h' = h * h'] (mod n)\n\ngoal (3 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "also"], ["proof (state)\nthis:\n  [p * h' = h * h'] (mod n)\n\ngoal (3 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "have \"[h * h' = 1] (mod n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. [h * h' = 1] (mod n)", "using h'"], ["proof (prove)\nusing this:\n  [h * h' = Suc 0] (mod n)\n\ngoal (1 subgoal):\n 1. [h * h' = 1] (mod n)", "by simp"], ["proof (state)\nthis:\n  [h * h' = 1] (mod n)\n\ngoal (3 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "finally"], ["proof (chain)\npicking this:\n  [p * h' = 1] (mod n)", "have \"[h' * p = 1] (mod n)\""], ["proof (prove)\nusing this:\n  [p * h' = 1] (mod n)\n\ngoal (1 subgoal):\n 1. [h' * p = 1] (mod n)", "by (simp add: mult_ac)"], ["proof (state)\nthis:\n  [h' * p = 1] (mod n)\n\ngoal (3 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}\n 3. \\<And>xa.\n       xa \\<in> {p. 0 < p \\<and>\n                    real p \\<le> x \\<and> [p = h] (mod n)} \\<Longrightarrow>\n       of_nat (totient n) * complex_of_real (mangoldt xa / real xa) =\n       (\\<Sum>\\<chi>\\<in>dcharacters n.\n          \\<chi> (h' * xa) * complex_of_real (mangoldt xa / real xa))", "thus ?case"], ["proof (prove)\nusing this:\n  [h' * p = 1] (mod n)\n\ngoal (1 subgoal):\n 1. of_nat (totient n) * complex_of_real (mangoldt p / real p) =\n    (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<chi> (h' * p) * complex_of_real (mangoldt p / real p))", "using h' 4"], ["proof (prove)\nusing this:\n  [h' * p = 1] (mod n)\n  [h * h' = Suc 0] (mod n)\n  p \\<in> {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n\ngoal (1 subgoal):\n 1. of_nat (totient n) * complex_of_real (mangoldt p / real p) =\n    (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<chi> (h' * p) * complex_of_real (mangoldt p / real p))", "by (auto simp: sum_dcharacters sum_divide_distrib [symmetric] sum_distrib_right [symmetric])"], ["proof (state)\nthis:\n  of_nat (totient n) * complex_of_real (mangoldt p / real p) =\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     \\<chi> (h' * p) * complex_of_real (mangoldt p / real p))\n\ngoal (2 subgoals):\n 1. finite {i. 0 < i \\<and> real i \\<le> x}\n 2. {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}\n    \\<subseteq> {i. 0 < i \\<and> real i \\<le> x}", "qed auto"], ["proof (state)\nthis:\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     of_nat (totient n) * complex_of_real (mangoldt p / real p)) =\n  sum_upto\n   (\\<lambda>k.\n       \\<Sum>\\<chi>\\<in>dcharacters n.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n   x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "also"], ["proof (state)\nthis:\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     of_nat (totient n) * complex_of_real (mangoldt p / real p)) =\n  sum_upto\n   (\\<lambda>k.\n       \\<Sum>\\<chi>\\<in>dcharacters n.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n   x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "have \"\\<dots> = (\\<Sum>\\<chi>\\<in>dcharacters n. sum_upto (\\<lambda>k. \\<chi> (h' * k) * (mangoldt k / k)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum_upto\n     (\\<lambda>k.\n         \\<Sum>\\<chi>\\<in>dcharacters n.\n           \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n     x =\n    (\\<Sum>\\<chi>\\<in>dcharacters n.\n       sum_upto\n        (\\<lambda>k.\n            \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n        x)", "unfolding sum_upto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n       \\<Sum>\\<chi>\\<in>dcharacters n.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k)) =\n    (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))", "by (rule sum.swap)"], ["proof (state)\nthis:\n  sum_upto\n   (\\<lambda>k.\n       \\<Sum>\\<chi>\\<in>dcharacters n.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n   x =\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     sum_upto\n      (\\<lambda>k. \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n      x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "also"], ["proof (state)\nthis:\n  sum_upto\n   (\\<lambda>k.\n       \\<Sum>\\<chi>\\<in>dcharacters n.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n   x =\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     sum_upto\n      (\\<lambda>k. \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n      x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "have \"\\<dots> = (\\<Sum>\\<chi>\\<in>dcharacters n. \\<chi> h' * sum_upto (\\<lambda>k. \\<chi> k * (mangoldt k / k)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<chi>\\<in>dcharacters n.\n       sum_upto\n        (\\<lambda>k.\n            \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n        x) =\n    (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<chi> h' *\n       sum_upto\n        (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k)) x)", "unfolding sum_upto_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n         \\<chi> (h' * k) * complex_of_real (mangoldt k / real k)) =\n    (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<chi> h' *\n       (\\<Sum>k\\<in>{i. 0 < i \\<and> real i \\<le> x}.\n          \\<chi> k * complex_of_real (mangoldt k / real k)))", "by (intro sum.cong refl) (auto simp: dcharacters_def dcharacter.mult sum_distrib_left mult_ac)"], ["proof (state)\nthis:\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     sum_upto\n      (\\<lambda>k. \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n      x) =\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "also"], ["proof (state)\nthis:\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     sum_upto\n      (\\<lambda>k. \\<chi> (h' * k) * complex_of_real (mangoldt k / real k))\n      x) =\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "have \"\\<dots> = \\<chi>\\<^sub>0 h' * sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * (mangoldt k / k)) x + \n                    (\\<Sum>\\<chi>\\<in>?B. \\<chi> h' * sum_upto (\\<lambda>k. \\<chi> k * (mangoldt k / k)) x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>\\<chi>\\<in>dcharacters n.\n       \\<chi> h' *\n       sum_upto\n        (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k)) x) =\n    \\<chi>\\<^sub>0 h' *\n    sum_upto\n     (\\<lambda>k. \\<chi>\\<^sub>0 k * complex_of_real (mangoldt k / real k))\n     x +\n    (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n       \\<chi> h' *\n       sum_upto\n        (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k)) x)", "by (subst sum.remove [symmetric]) (auto simp: sum_distrib_left)"], ["proof (state)\nthis:\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x) =\n  \\<chi>\\<^sub>0 h' *\n  sum_upto\n   (\\<lambda>k. \\<chi>\\<^sub>0 k * complex_of_real (mangoldt k / real k))\n   x +\n  (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "also"], ["proof (state)\nthis:\n  (\\<Sum>\\<chi>\\<in>dcharacters n.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x) =\n  \\<chi>\\<^sub>0 h' *\n  sum_upto\n   (\\<lambda>k. \\<chi>\\<^sub>0 k * complex_of_real (mangoldt k / real k))\n   x +\n  (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "have \"coprime h' n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. coprime h' n", "using h'"], ["proof (prove)\nusing this:\n  [h * h' = Suc 0] (mod n)\n\ngoal (1 subgoal):\n 1. coprime h' n", "by (subst coprime_iff_invertible_nat, subst (asm) mult.commute) auto"], ["proof (state)\nthis:\n  coprime h' n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "hence \"\\<chi>\\<^sub>0 h' = 1\""], ["proof (prove)\nusing this:\n  coprime h' n\n\ngoal (1 subgoal):\n 1. \\<chi>\\<^sub>0 h' = 1", "by (simp add: principal_dchar_def)"], ["proof (state)\nthis:\n  \\<chi>\\<^sub>0 h' = 1\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       complex_of_real\n        (real (totient n) *\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p) -\n         ln x) =\n       sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n       Ln (complex_of_real x) +\n       (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n          \\<chi> h' *\n          sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "finally"], ["proof (chain)\npicking this:\n  of_nat (totient n) *\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     complex_of_real (mangoldt p / real p)) =\n  1 *\n  sum_upto\n   (\\<lambda>k. \\<chi>\\<^sub>0 k * complex_of_real (mangoldt k / real k))\n   x +\n  (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x)", "show ?case"], ["proof (prove)\nusing this:\n  of_nat (totient n) *\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     complex_of_real (mangoldt p / real p)) =\n  1 *\n  sum_upto\n   (\\<lambda>k. \\<chi>\\<^sub>0 k * complex_of_real (mangoldt k / real k))\n   x +\n  (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x)\n\ngoal (1 subgoal):\n 1. complex_of_real\n     (real (totient n) *\n      (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n         mangoldt p / real p) -\n      ln x) =\n    sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n    Ln (complex_of_real x) +\n    (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n       \\<chi> h' *\n       sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "using n 1"], ["proof (prove)\nusing this:\n  of_nat (totient n) *\n  (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n     complex_of_real (mangoldt p / real p)) =\n  1 *\n  sum_upto\n   (\\<lambda>k. \\<chi>\\<^sub>0 k * complex_of_real (mangoldt k / real k))\n   x +\n  (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n     \\<chi> h' *\n     sum_upto (\\<lambda>k. \\<chi> k * complex_of_real (mangoldt k / real k))\n      x)\n  1 < n\n  0 < x\n\ngoal (1 subgoal):\n 1. complex_of_real\n     (real (totient n) *\n      (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n         mangoldt p / real p) -\n      ln x) =\n    sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n    Ln (complex_of_real x) +\n    (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n       \\<chi> h' *\n       sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)", "by (simp add: Ln_of_real)"], ["proof (state)\nthis:\n  complex_of_real\n   (real (totient n) *\n    (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n       mangoldt p / real p) -\n    ln x) =\n  sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n  Ln (complex_of_real x) +\n  (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n     \\<chi> h' * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      complex_of_real\n       (real (totient n) *\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        ln x))\n  \\<in> \\<Theta>(\\<lambda>x.\n                    sum_upto\n                     (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k)\n                     x -\n                    Ln (complex_of_real x) +\n                    (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n                       \\<chi> h' *\n                       sum_upto\n                        (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x))\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "also"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      complex_of_real\n       (real (totient n) *\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        ln x))\n  \\<in> \\<Theta>(\\<lambda>x.\n                    sum_upto\n                     (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k)\n                     x -\n                    Ln (complex_of_real x) +\n                    (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n                       \\<chi> h' *\n                       sum_upto\n                        (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x))\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "have \"?f \\<in> O(\\<lambda>_. complex_of_real 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x) +\n        (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n           \\<chi> h' *\n           sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x))\n    \\<in> O(\\<lambda>_. complex_of_real 1)", "proof (rule sum_in_bigo[OF _ big_sum_in_bigo], goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. complex_of_real 1)\n 2. \\<And>x.\n       x \\<in> dcharacters n - {\\<chi>\\<^sub>0} \\<Longrightarrow>\n       (\\<lambda>xa.\n           x h' * sum_upto (\\<lambda>k. x k * mangoldt k / of_nat k) xa)\n       \\<in> O(\\<lambda>_. complex_of_real 1)", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. complex_of_real 1)\n 2. \\<And>x.\n       x \\<in> dcharacters n - {\\<chi>\\<^sub>0} \\<Longrightarrow>\n       (\\<lambda>xa.\n           x h' * sum_upto (\\<lambda>k. x k * mangoldt k / of_nat k) xa)\n       \\<in> O(\\<lambda>_. complex_of_real 1)", "from principal_dchar_sum_bound'"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n      Ln (complex_of_real x))\n  \\<in> O(\\<lambda>_. 1)", "show ?case"], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n      Ln (complex_of_real x))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n        Ln (complex_of_real x))\n    \\<in> O(\\<lambda>_. complex_of_real 1)", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n      Ln (complex_of_real x))\n  \\<in> O(\\<lambda>_. complex_of_real 1)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> dcharacters n - {\\<chi>\\<^sub>0} \\<Longrightarrow>\n       (\\<lambda>xa.\n           x h' * sum_upto (\\<lambda>k. x k * mangoldt k / of_nat k) xa)\n       \\<in> O(\\<lambda>_. complex_of_real 1)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> dcharacters n - {\\<chi>\\<^sub>0} \\<Longrightarrow>\n       (\\<lambda>xa.\n           x h' * sum_upto (\\<lambda>k. x k * mangoldt k / of_nat k) xa)\n       \\<in> O(\\<lambda>_. complex_of_real 1)", "case (2 \\<chi>)"], ["proof (state)\nthis:\n  \\<chi> \\<in> dcharacters n - {\\<chi>\\<^sub>0}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> dcharacters n - {\\<chi>\\<^sub>0} \\<Longrightarrow>\n       (\\<lambda>xa.\n           x h' * sum_upto (\\<lambda>k. x k * mangoldt k / of_nat k) xa)\n       \\<in> O(\\<lambda>_. complex_of_real 1)", "then"], ["proof (chain)\npicking this:\n  \\<chi> \\<in> dcharacters n - {\\<chi>\\<^sub>0}", "interpret dcharacter n G \\<chi>"], ["proof (prove)\nusing this:\n  \\<chi> \\<in> dcharacters n - {\\<chi>\\<^sub>0}\n\ngoal (1 subgoal):\n 1. dcharacter n \\<chi> &&& G \\<equiv> residue_mult_group n", "by (simp_all add: G_def dcharacters_def)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> dcharacters n - {\\<chi>\\<^sub>0} \\<Longrightarrow>\n       (\\<lambda>xa.\n           x h' * sum_upto (\\<lambda>k. x k * mangoldt k / of_nat k) xa)\n       \\<in> O(\\<lambda>_. complex_of_real 1)", "from 2"], ["proof (chain)\npicking this:\n  \\<chi> \\<in> dcharacters n - {\\<chi>\\<^sub>0}", "have \"\\<chi> \\<noteq> \\<chi>\\<^sub>0\""], ["proof (prove)\nusing this:\n  \\<chi> \\<in> dcharacters n - {\\<chi>\\<^sub>0}\n\ngoal (1 subgoal):\n 1. \\<chi> \\<noteq> \\<chi>\\<^sub>0", "by auto"], ["proof (state)\nthis:\n  \\<chi> \\<noteq> \\<chi>\\<^sub>0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> dcharacters n - {\\<chi>\\<^sub>0} \\<Longrightarrow>\n       (\\<lambda>xa.\n           x h' * sum_upto (\\<lambda>k. x k * mangoldt k / of_nat k) xa)\n       \\<in> O(\\<lambda>_. complex_of_real 1)", "thus ?case"], ["proof (prove)\nusing this:\n  \\<chi> \\<noteq> \\<chi>\\<^sub>0\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        \\<chi> h' *\n        sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)\n    \\<in> O(\\<lambda>_. complex_of_real 1)", "unfolding of_real_1"], ["proof (prove)\nusing this:\n  \\<chi> \\<noteq> \\<chi>\\<^sub>0\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        \\<chi> h' *\n        sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)\n    \\<in> O(\\<lambda>_. 1)", "by (intro landau_o.big.mult_in_1 nonprincipal_mangoldt_bound) auto"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      \\<chi> h' * sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x)\n  \\<in> O(\\<lambda>_. complex_of_real 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      sum_upto (\\<lambda>k. \\<chi>\\<^sub>0 k * mangoldt k / of_nat k) x -\n      Ln (complex_of_real x) +\n      (\\<Sum>\\<chi>\\<in>dcharacters n - {\\<chi>\\<^sub>0}.\n         \\<chi> h' *\n         sum_upto (\\<lambda>k. \\<chi> k * mangoldt k / of_nat k) x))\n  \\<in> O(\\<lambda>_. complex_of_real 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      complex_of_real\n       (real (totient n) *\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        ln x))\n  \\<in> O(\\<lambda>_. complex_of_real 1)", "have *: \"(\\<lambda>x. real (totient n) * (\\<Sum>p\\<in>?A' x. mangoldt p / p) - ln x) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      complex_of_real\n       (real (totient n) *\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        ln x))\n  \\<in> O(\\<lambda>_. complex_of_real 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        real (totient n) *\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        ln x)\n    \\<in> O(\\<lambda>_. 1)", "by (subst (asm) landau_o.big.of_real_iff)"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      real (totient n) *\n      (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n         mangoldt p / real p) -\n      ln x)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. real (totient n) * ((\\<Sum>p\\<in>?A x. ln p / p) - (\\<Sum>p\\<in>?A' x. mangoldt p / p))) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        real (totient n) *\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p)))\n    \\<in> O(\\<lambda>_. 1)", "proof (intro landau_o.big.mult_in_1)"], ["proof (state)\ngoal (2 subgoals):\n 1. (\\<lambda>x. real (totient n)) \\<in> O(\\<lambda>_. 1)\n 2. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n           ln (real p) / real p) -\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p))\n    \\<in> O(\\<lambda>_. 1)", "show \"(\\<lambda>x. (\\<Sum>p\\<in>?A x. ln p / p) - (\\<Sum>p\\<in>?A' x. mangoldt p / p)) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n           ln (real p) / real p) -\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p))\n    \\<in> O(\\<lambda>_. 1)", "unfolding landau_o.big.of_real_iff"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n           ln (real p) / real p) -\n        (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p))\n    \\<in> O(\\<lambda>_. 1)", "proof (intro bigoI[of _ 3] eventually_mono[OF eventually_gt_at_top[of 0]], goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p))\n       \\<le> 3 * norm 1", "case (1 x)"], ["proof (state)\nthis:\n  0 < x\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p))\n       \\<le> 3 * norm 1", "have \"\\<bar>(\\<Sum>p\\<in>?A' x. mangoldt p / p) - (\\<Sum>p | prime p \\<and> p \\<in> ?A' x. ln p / p)\\<bar> \\<le> 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n             mangoldt p / real p) -\n          (\\<Sum>x\\<in>{p. prime p \\<and>\n                           p \\<in> {p. 0 < p \\<and>\n real p \\<le> x \\<and> [p = h] (mod n)}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "by (rule Mertens_mangoldt_versus_ln[where n = \"nat \\<lfloor>x\\<rfloor>\"])\n           (auto simp: le_nat_iff le_floor_iff)"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         p \\<in> {p. 0 < p \\<and>\n                                     real p \\<le> x \\<and>\n                                     [p = h] (mod n)}}.\n           ln (real x) / real x)\\<bar>\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p))\n       \\<le> 3 * norm 1", "also"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         p \\<in> {p. 0 < p \\<and>\n                                     real p \\<le> x \\<and>\n                                     [p = h] (mod n)}}.\n           ln (real x) / real x)\\<bar>\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p))\n       \\<le> 3 * norm 1", "have \"{p. prime p \\<and> p \\<in> ?A' x} = ?A x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {p. prime p \\<and>\n        p \\<in> {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}} =\n    {p. prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x}", "by (auto simp: prime_gt_0_nat)"], ["proof (state)\nthis:\n  {p. prime p \\<and>\n      p \\<in> {p. 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n)}} =\n  {p. prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       0 < x \\<Longrightarrow>\n       norm\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n            mangoldt p / real p))\n       \\<le> 3 * norm 1", "finally"], ["proof (chain)\npicking this:\n  \\<bar>(\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x)\\<bar>\n  \\<le> 3", "show ?case"], ["proof (prove)\nusing this:\n  \\<bar>(\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n           mangoldt p / real p) -\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x)\\<bar>\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. norm\n     ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n         mangoldt p / real p))\n    \\<le> 3 * norm 1", "by (simp add: abs_minus_commute)"], ["proof (state)\nthis:\n  norm\n   ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n       ln (real p) / real p) -\n    (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n       mangoldt p / real p))\n  \\<le> 3 * norm 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n         mangoldt p / real p))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x. real (totient n)) \\<in> O(\\<lambda>_. 1)", "qed auto"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      real (totient n) *\n      ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p) -\n       (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n          mangoldt p / real p)))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "from sum_in_bigo(1)[OF * this]"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      real (totient n) *\n      (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n         mangoldt p / real p) -\n      ln x +\n      real (totient n) *\n      ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p) -\n       (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n          mangoldt p / real p)))\n  \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. totient n * (\\<Sum>p\\<in>?A x. ln p / p) - ln x) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      real (totient n) *\n      (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n         mangoldt p / real p) -\n      ln x +\n      real (totient n) *\n      ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p) -\n       (\\<Sum>p | 0 < p \\<and> real p \\<le> x \\<and> [p = h] (mod n).\n          mangoldt p / real p)))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        real (totient n) *\n        (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n           ln (real p) / real p) -\n        ln x)\n    \\<in> O(\\<lambda>_. 1)", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      real (totient n) *\n      (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      ln x)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "also"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      real (totient n) *\n      (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      ln x)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. totient n * (\\<Sum>p\\<in>?A x. ln p / p) - ln x) =\n               (\\<lambda>x. totient n * ((\\<Sum>p\\<in>?A x. ln p / p) - ln x / totient n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        real (totient n) *\n        (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n           ln (real p) / real p) -\n        ln x) =\n    (\\<lambda>x.\n        real (totient n) *\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         ln x / real (totient n)))", "using n"], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        real (totient n) *\n        (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n           ln (real p) / real p) -\n        ln x) =\n    (\\<lambda>x.\n        real (totient n) *\n        ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n            ln (real p) / real p) -\n         ln x / real (totient n)))", "by (intro ext) (auto simp: field_simps)"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      real (totient n) *\n      (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      ln x) =\n  (\\<lambda>x.\n      real (totient n) *\n      ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p) -\n       ln x / real (totient n)))\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "also"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      real (totient n) *\n      (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      ln x) =\n  (\\<lambda>x.\n      real (totient n) *\n      ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p) -\n       ln x / real (totient n)))\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "have \"\\<dots> \\<in> O(\\<lambda>_. 1) \\<longleftrightarrow> ?thesis\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         real (totient n) *\n         ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n             ln (real p) / real p) -\n          ln x / real (totient n)))\n     \\<in> O(\\<lambda>_. 1)) =\n    ((\\<lambda>x.\n         (\\<Sum>x\\<in>{p. prime p \\<and>\n                          [p = h] (mod n) \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x / real (totient n))\n     \\<in> O(\\<lambda>_. 1))", "using n"], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         real (totient n) *\n         ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n             ln (real p) / real p) -\n          ln x / real (totient n)))\n     \\<in> O(\\<lambda>_. 1)) =\n    ((\\<lambda>x.\n         (\\<Sum>x\\<in>{p. prime p \\<and>\n                          [p = h] (mod n) \\<and> real p \\<le> x}.\n            ln (real x) / real x) -\n         ln x / real (totient n))\n     \\<in> O(\\<lambda>_. 1))", "by (intro landau_o.big.cmult_in_iff) auto"], ["proof (state)\nthis:\n  ((\\<lambda>x.\n       real (totient n) *\n       ((\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n           ln (real p) / real p) -\n        ln x / real (totient n)))\n   \\<in> O(\\<lambda>_. 1)) =\n  ((\\<lambda>x.\n       (\\<Sum>x\\<in>{p. prime p \\<and>\n                        [p = h] (mod n) \\<and> real p \\<le> x}.\n          ln (real x) / real x) -\n       ln x / real (totient n))\n   \\<in> O(\\<lambda>_. 1))\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      (\\<Sum>x\\<in>{p. prime p \\<and>\n                       [p = h] (mod n) \\<and> real p \\<le> x}.\n         ln (real x) / real x) -\n      ln x / real (totient n))\n  \\<in> O(\\<lambda>_. 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      (\\<Sum>x\\<in>{p. prime p \\<and>\n                       [p = h] (mod n) \\<and> real p \\<le> x}.\n         ln (real x) / real x) -\n      ln x / real (totient n))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        (\\<Sum>x\\<in>{p. prime p \\<and>\n                         [p = h] (mod n) \\<and> real p \\<le> x}.\n           ln (real x) / real x) -\n        ln x / real (totient n))\n    \\<in> O(\\<lambda>_. 1)", "."], ["proof (state)\nthis:\n  (\\<lambda>x.\n      (\\<Sum>x\\<in>{p. prime p \\<and>\n                       [p = h] (mod n) \\<and> real p \\<le> x}.\n         ln (real x) / real x) -\n      ln x / real (totient n))\n  \\<in> O(\\<lambda>_. 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  It is now obvious that the set of primes we are interested in is, in fact, infinite.\n\\<close>"], ["", "theorem Dirichlet:\n  assumes \"coprime h n\"\n  shows   \"infinite {p. prime p \\<and> [p = h] (mod n)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. infinite {p. prime p \\<and> [p = h] (mod n)}", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "assume \"finite {p. prime p \\<and> [p = h] (mod n)}\""], ["proof (state)\nthis:\n  finite {p. prime p \\<and> [p = h] (mod n)}\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "then"], ["proof (chain)\npicking this:\n  finite {p. prime p \\<and> [p = h] (mod n)}", "obtain K where K: \"{p. prime p \\<and> [p = h] (mod n)} \\<subseteq> {..<K}\""], ["proof (prove)\nusing this:\n  finite {p. prime p \\<and> [p = h] (mod n)}\n\ngoal (1 subgoal):\n 1. (\\<And>K.\n        {p. prime p \\<and> [p = h] (mod n)}\n        \\<subseteq> {..<K} \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: finite_nat_iff_bounded)"], ["proof (state)\nthis:\n  {p. prime p \\<and> [p = h] (mod n)} \\<subseteq> {..<K}\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "have \"eventually (\\<lambda>x. (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x. ln p / p) =\n                        (\\<Sum>p | prime p \\<and> [p = h] (mod n). ln p / p)) at_top\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_top.\n       (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p) =\n       (\\<Sum>p | prime p \\<and> [p = h] (mod n). ln (real p) / real p)", "using eventually_ge_at_top[of \"real K\"]"], ["proof (prove)\nusing this:\n  eventually ((\\<le>) (real K)) at_top\n\ngoal (1 subgoal):\n 1. \\<forall>\\<^sub>F x in at_top.\n       (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p) =\n       (\\<Sum>p | prime p \\<and> [p = h] (mod n). ln (real p) / real p)", "by eventually_elim (intro sum.cong, use K in auto)"], ["proof (state)\nthis:\n  \\<forall>\\<^sub>F x in at_top.\n     (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n        ln (real p) / real p) =\n     (\\<Sum>p | prime p \\<and> [p = h] (mod n). ln (real p) / real p)\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "hence \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x. ln p / p)) \\<in> \n            \\<Theta>(\\<lambda>_. (\\<Sum>p | prime p \\<and> [p = h] (mod n). ln p / p))\""], ["proof (prove)\nusing this:\n  \\<forall>\\<^sub>F x in at_top.\n     (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n        ln (real p) / real p) =\n     (\\<Sum>p | prime p \\<and> [p = h] (mod n). ln (real p) / real p)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        \\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p)\n    \\<in> \\<Theta>(\\<lambda>_.\n                      \\<Sum>p | prime p \\<and> [p = h] (mod n).\n                        ln (real p) / real p)", "by (intro bigthetaI_cong) auto"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      \\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n        ln (real p) / real p)\n  \\<in> \\<Theta>(\\<lambda>_.\n                    \\<Sum>p | prime p \\<and> [p = h] (mod n).\n                      ln (real p) / real p)\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "also"], ["proof (state)\nthis:\n  (\\<lambda>x.\n      \\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n        ln (real p) / real p)\n  \\<in> \\<Theta>(\\<lambda>_.\n                    \\<Sum>p | prime p \\<and> [p = h] (mod n).\n                      ln (real p) / real p)\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "have \"(\\<lambda>_. (\\<Sum>p | prime p \\<and> [p = h] (mod n). ln p / p)) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>_.\n        \\<Sum>p | prime p \\<and> [p = h] (mod n). ln (real p) / real p)\n    \\<in> O(\\<lambda>_. 1)", "by simp"], ["proof (state)\nthis:\n  (\\<lambda>_.\n      \\<Sum>p | prime p \\<and> [p = h] (mod n). ln (real p) / real p)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "finally"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      \\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n        ln (real p) / real p)\n  \\<in> O(\\<lambda>_. 1)", "have \"(\\<lambda>x. (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x. ln p / p)) \\<in> O(\\<lambda>_. 1)\""], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      \\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n        ln (real p) / real p)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. (\\<lambda>x.\n        \\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n          ln (real p) / real p)\n    \\<in> O(\\<lambda>_. 1)", "."], ["proof (state)\nthis:\n  (\\<lambda>x.\n      \\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n        ln (real p) / real p)\n  \\<in> O(\\<lambda>_. 1)\n\ngoal (1 subgoal):\n 1. finite {p. prime p \\<and> [p = h] (mod n)} \\<Longrightarrow> False", "from sum_in_bigo(2)[OF this Dirichlet_strong[OF assms]] and n"], ["proof (chain)\npicking this:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      ((\\<Sum>x\\<in>{p. prime p \\<and>\n                        [p = h] (mod n) \\<and> real p \\<le> x}.\n          ln (real x) / real x) -\n       ln x / real (totient n)))\n  \\<in> O(\\<lambda>_. 1)\n  1 < n", "show False"], ["proof (prove)\nusing this:\n  (\\<lambda>x.\n      (\\<Sum>p | prime p \\<and> [p = h] (mod n) \\<and> real p \\<le> x.\n         ln (real p) / real p) -\n      ((\\<Sum>x\\<in>{p. prime p \\<and>\n                        [p = h] (mod n) \\<and> real p \\<le> x}.\n          ln (real x) / real x) -\n       ln x / real (totient n)))\n  \\<in> O(\\<lambda>_. 1)\n  1 < n\n\ngoal (1 subgoal):\n 1. False", "by simp"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  In the future, one could extend this result to more precise estimates of the distribution\n  of primes in arithmetic progressions in a similar way to the Prime Number Theorem.\n\\<close>"], ["", "end"], ["", "end"], ["", "end"]]}