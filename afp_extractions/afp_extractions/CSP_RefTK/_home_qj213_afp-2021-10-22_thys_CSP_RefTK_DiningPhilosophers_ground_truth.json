{"file_name": "/home/qj213/afp-2021-10-22/thys/CSP_RefTK/DiningPhilosophers.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/CSP_RefTK", "problem_names": ["lemma Suc_mod: \"n > 1 \\<Longrightarrow> i \\<noteq> Suc i mod n\"", "lemmas suc_mods = Suc_mod Suc_mod[symmetric]", "lemma l_suc: \"n > 1 \\<Longrightarrow> \\<not> n \\<le> Suc 0\"", "lemma minus_suc: \"n > 0 \\<Longrightarrow> n - Suc 0 \\<noteq> n\"", "lemma numeral_4_eq_4:\"4 = Suc (Suc (Suc (Suc 0)))\"", "lemma numeral_5_eq_5:\"5 = Suc (Suc (Suc (Suc (Suc 0))))\"", "lemma RPHIL_rec:\n  \"RPHIL i = (picks i i \\<rightarrow> (picks i (i-1) \\<rightarrow> (putsdown i (i-1) \\<rightarrow> (putsdown i i  \\<rightarrow> RPHIL i))))\"", "lemma LPHIL0_rec:\n  \"LPHIL0 = (picks 0 (N-1) \\<rightarrow> (picks 0 0 \\<rightarrow> (putsdown 0 0 \\<rightarrow> (putsdown 0 (N-1) \\<rightarrow> LPHIL0))))\"", "lemma FORK_rec: \"FORK i = (  (picks i i \\<rightarrow> (putsdown i i \\<rightarrow> (FORK i)))\n                          \\<box> (picks ((i+1) mod N) i \\<rightarrow> (putsdown ((i+1) mod N) i \\<rightarrow> (FORK i))))\"", "lemma N_pos[simp]: \"N > 0\"", "lemmas N_pos_simps[simp] = suc_mods[OF N_g1] l_suc[OF N_g1] minus_suc[OF N_pos]", "lemma ev_fork_idx[simp]: \"e \\<in> Tr\\<^sub>f i s \\<Longrightarrow> fork e = i\"", "lemma FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>f i s) \\<rightarrow> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Up\\<^sub>f i s e))\"", "lemma FORK_refines_FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<sqsubseteq> FORK i\"", "lemma FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_FORK: \"FORK i \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\"", "lemma FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_FORK: \"FORK i = FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\"", "lemma forks_transitions_take: \"Tr\\<^sub>F n fs = Tr\\<^sub>F n (take n fs)\"", "lemma forks_update_take: \"take n (Up\\<^sub>F fs e) = Up\\<^sub>F (take n fs) e\"", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = (\\<lambda> fs. \\<box> e \\<in> (Tr\\<^sub>F n fs) \\<rightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>F fs e))\"", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_0: \"FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 fs = STOP\"", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir1: \"length fs > 0 \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs \\<sqsubseteq> (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs!0))\"", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir2: \"length fs > 0 \\<Longrightarrow> (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs!0)) \\<sqsubseteq> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs\"", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1: \"length fs > 0 \\<Longrightarrow> (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs!0)) = FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs\"", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_unfold:\n\"0 < n \\<Longrightarrow> length fs = Suc n \\<Longrightarrow>\n                              FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs = (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast fs)|||(FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (fs!n)))\"", "lemma ft: \"0 < n \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) = foldFORKs n\"", "lemma RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>r\\<^sub>p i s) \\<rightarrow> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Up\\<^sub>r\\<^sub>p i s e))\"", "lemma LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>l\\<^sub>p s) \\<rightarrow> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Up\\<^sub>l\\<^sub>p s e))\"", "lemma RPHIL_refines_RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:\n  assumes i_pos: \"i > 0\"\n  shows \"RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<sqsubseteq> RPHIL i\"", "lemma LPHIL0_refines_LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<sqsubseteq> LPHIL0\"", "lemma RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_RPHIL:\n  assumes i_pos: \"i > 0\"\n  shows \"RPHIL i \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\"", "lemma LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_LPHIL0: \"LPHIL0 \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\"", "lemma RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_RPHIL: \"i > 0 \\<Longrightarrow> RPHIL i = RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\"", "lemma LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_LPHIL0: \"LPHIL0 = LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\"", "lemma phils_transitions_take: \"0 < n \\<Longrightarrow> Tr\\<^sub>P n ps = Tr\\<^sub>P n (take n ps)\"", "lemma phils_update_take: \"take n (Up\\<^sub>P ps e) = Up\\<^sub>P (take n ps) e\"", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = (\\<lambda> ps. \\<box> e \\<in> (Tr\\<^sub>P n ps) \\<rightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>P ps e))\"", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir1: \"length ps > 0 \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps \\<sqsubseteq> (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps!0))\"", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir2: \"length ps > 0 \\<Longrightarrow> (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps!0)) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps\"", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1: \"length ps > 0 \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps = (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps!0))\"", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_unfold:\n  assumes n_pos:\"0 < n\"\n  shows \"length ps = Suc n \\<Longrightarrow>\n                            PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps = (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast ps)|||(RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps!n)))\"", "lemma pt: \"0 < n \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) = foldPHILs n\"", "lemma ltsDining_rec:  \"DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>D n s) \\<rightarrow> DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>D s e))\"", "lemma DINING_is_DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"DINING = DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)\"", "lemma dining_events:\n\"e \\<in> Tr\\<^sub>D N s \\<Longrightarrow>\n        (\\<exists>i\\<in>{1..<N}. e = picks i i \\<or> e = picks i (i-1)  \\<or> e = putsdown i i \\<or> e = putsdown i (i-1))\n     \\<or> (e = picks 0 0 \\<or> e = picks 0 (N-1) \\<or> e = putsdown 0 0 \\<or> e = putsdown 0 (N-1))\"", "lemma inv_DINING: \"s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D (replicate N 0, replicate N 0) \\<Longrightarrow> inv_dining (fst s) (snd s)\"", "lemma inv_implies_DF:\"inv_dining ps fs \\<Longrightarrow> Tr\\<^sub>D N (ps, fs) \\<noteq> {}\""], "translations": [["", "lemma Suc_mod: \"n > 1 \\<Longrightarrow> i \\<noteq> Suc i mod n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < n \\<Longrightarrow> i \\<noteq> Suc i mod n", "by (metis One_nat_def mod_Suc mod_if mod_mod_trivial n_not_Suc_n)"], ["", "lemmas suc_mods = Suc_mod Suc_mod[symmetric]"], ["", "lemma l_suc: \"n > 1 \\<Longrightarrow> \\<not> n \\<le> Suc 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < n \\<Longrightarrow> \\<not> n \\<le> Suc 0", "by simp"], ["", "lemma minus_suc: \"n > 0 \\<Longrightarrow> n - Suc 0 \\<noteq> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < n \\<Longrightarrow> n - Suc 0 \\<noteq> n", "by linarith"], ["", "lemma numeral_4_eq_4:\"4 = Suc (Suc (Suc (Suc 0)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 4 = Suc (Suc (Suc (Suc 0)))", "by simp"], ["", "lemma numeral_5_eq_5:\"5 = Suc (Suc (Suc (Suc (Suc 0))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 5 = Suc (Suc (Suc (Suc (Suc 0))))", "by simp"], ["", "subsection\\<open>The dining processes definition\\<close>"], ["", "locale DiningPhilosophers =\n\n  fixes N::nat\n  assumes N_g1[simp] : \"N > 1\"\n\nbegin"], ["", "datatype dining_event  = picks (phil:nat) (fork:nat)\n                       | putsdown (phil:nat) (fork:nat)"], ["", "definition RPHIL::  \"nat \\<Rightarrow> dining_event process\"\n where \"RPHIL i = (\\<mu> X. (picks i i \\<rightarrow> (picks i (i-1) \\<rightarrow> (putsdown i (i-1) \\<rightarrow> (putsdown i i \\<rightarrow> X)))))\""], ["", "definition LPHIL0::  \"dining_event process\"\n  where \"LPHIL0 = (\\<mu> X. (picks 0 (N-1) \\<rightarrow> (picks 0 0 \\<rightarrow> (putsdown 0 0 \\<rightarrow> (putsdown 0 (N-1) \\<rightarrow> X)))))\""], ["", "definition FORK  :: \"nat \\<Rightarrow> dining_event process\"\n  where \"FORK i = (\\<mu> X.   (picks i i \\<rightarrow> (putsdown i i \\<rightarrow> X))\n                        \\<box> (picks ((i+1) mod N) i \\<rightarrow> (putsdown ((i+1) mod N) i \\<rightarrow> X)))\""], ["", "abbreviation \"foldPHILs n \\<equiv> fold (\\<lambda> i P. P ||| RPHIL i) [1..< n] (LPHIL0)\""], ["", "abbreviation \"foldFORKs n \\<equiv> fold (\\<lambda> i P. P ||| FORK i) [1..< n] (FORK 0)\""], ["", "abbreviation \"PHILs \\<equiv> foldPHILs N\""], ["", "abbreviation \"FORKs \\<equiv> foldFORKs N\""], ["", "corollary FORKs_def2: \"FORKs = fold (\\<lambda> i P. P ||| FORK i) [0..< N] SKIP\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fold (\\<lambda>i P. P|||FORK i) [1..<N] (FORK 0) =\n    fold (\\<lambda>i P. P|||FORK i) [0..<N] SKIP", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. fold (\\<lambda>i P. P|||FORK i) [1..<N] (FORK 0) =\n    fold (\\<lambda>i P. P|||FORK i) [0..<N] SKIP", "by (subst (2) upt_rec, auto) (metis (no_types, lifting) Inter_commute Inter_skip1)"], ["", "corollary \"N = 3 \\<Longrightarrow> PHILs = (LPHIL0 ||| RPHIL 1 ||| RPHIL 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. N = 3 \\<Longrightarrow>\n    fold (\\<lambda>i P. P|||RPHIL i) [1..<N] LPHIL0 =\n    (LPHIL0|||RPHIL 1|||RPHIL 2)", "by (subst upt_rec, auto simp add:numeral_2_eq_2)+"], ["", "definition DINING :: \"dining_event process\"\n  where \"DINING = (FORKs || PHILs)\""], ["", "subsubsection \\<open>Unfolding rules\\<close>"], ["", "lemma RPHIL_rec:\n  \"RPHIL i = (picks i i \\<rightarrow> (picks i (i-1) \\<rightarrow> (putsdown i (i-1) \\<rightarrow> (putsdown i i  \\<rightarrow> RPHIL i))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. RPHIL i =\n    (picks i i \n        \\<rightarrow> picks i (i - 1) \n                         \\<rightarrow> putsdown i (i - 1) \n    \\<rightarrow> putsdown i i \\<rightarrow> RPHIL i)", "by (simp add:RPHIL_def write0_def, subst fix_eq, simp)"], ["", "lemma LPHIL0_rec:\n  \"LPHIL0 = (picks 0 (N-1) \\<rightarrow> (picks 0 0 \\<rightarrow> (putsdown 0 0 \\<rightarrow> (putsdown 0 (N-1) \\<rightarrow> LPHIL0))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LPHIL0 =\n    (picks 0 (N - 1) \n        \\<rightarrow> picks 0 0 \n                         \\<rightarrow> putsdown 0 0 \n    \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> LPHIL0)", "by (simp add:LPHIL0_def write0_def, subst fix_eq, simp)"], ["", "lemma FORK_rec: \"FORK i = (  (picks i i \\<rightarrow> (putsdown i i \\<rightarrow> (FORK i)))\n                          \\<box> (picks ((i+1) mod N) i \\<rightarrow> (putsdown ((i+1) mod N) i \\<rightarrow> (FORK i))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORK i =\n    (picks i i \\<rightarrow> putsdown i i \\<rightarrow> FORK i [+]\n     picks ((i + 1) mod N) i \n        \\<rightarrow> putsdown ((i + 1) mod N) i \\<rightarrow> FORK i)", "by (simp add:FORK_def write0_def, subst fix_eq, simp)"], ["", "subsection \\<open>Translation into normal form\\<close>"], ["", "lemma N_pos[simp]: \"N > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < N", "using N_g1 neq0_conv"], ["proof (prove)\nusing this:\n  1 < N\n  (?n \\<noteq> 0) = (0 < ?n)\n\ngoal (1 subgoal):\n 1. 0 < N", "by blast"], ["", "lemmas N_pos_simps[simp] = suc_mods[OF N_g1] l_suc[OF N_g1] minus_suc[OF N_pos]"], ["", "text \\<open>The one-fork process\\<close>"], ["", "type_synonym fork_id = nat"], ["", "type_synonym fork_state = nat"], ["", "definition fork_transitions:: \"fork_id \\<Rightarrow> fork_state \\<Rightarrow> dining_event set\" (\"Tr\\<^sub>f\")\n  where \"Tr\\<^sub>f i s = (if s = 0        then {picks i i} \\<union> {picks ((i+1) mod N) i}\n                    else if s = 1   then {putsdown i i}\n                    else if s = 2   then {putsdown ((i+1) mod N) i}\n                    else                 {})\""], ["", "declare Un_insert_right[simp del] Un_insert_left[simp del]"], ["", "lemma ev_fork_idx[simp]: \"e \\<in> Tr\\<^sub>f i s \\<Longrightarrow> fork e = i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e \\<in> Tr\\<^sub>f i s \\<Longrightarrow> fork e = i", "by (auto simp add:fork_transitions_def split:if_splits)"], ["", "definition fork_state_update:: \"fork_id \\<Rightarrow> fork_state \\<Rightarrow> dining_event \\<Rightarrow> fork_state\" (\"Up\\<^sub>f\")\n  where \"Up\\<^sub>f i s e = ( if e = (picks i i)                   then 1\n                      else if e = (picks ((i+1) mod N) i)  then 2\n                      else                                      0 )\""], ["", "definition FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:: \"fork_id \\<Rightarrow> fork_state \\<Rightarrow> dining_event process\"\n  where \"FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i = P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>f i ,Up\\<^sub>f i\\<rbrakk>\""], ["", "lemma FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>f i s) \\<rightarrow> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Up\\<^sub>f i s e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>f i s)\n         (\\<lambda>e.\n             FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Up\\<^sub>f i s e)))", "using fix_eq[of \"\\<Lambda> X. (\\<lambda>s. Mprefix (Tr\\<^sub>f i s) (\\<lambda>e. X (Up\\<^sub>f i s e)))\"] FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>f\n       i,Up\\<^sub>f i\\<rbrakk> =\n  (\\<Lambda> X.\n      (\\<lambda>s.\n          Mprefix (Tr\\<^sub>f i s)\n           (\\<lambda>e. X (Up\\<^sub>f i s e))))\\<cdot>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>f\n        i,Up\\<^sub>f i\\<rbrakk>)\n  FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?i =\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>f\n       ?i,Up\\<^sub>f ?i\\<rbrakk>\n\ngoal (1 subgoal):\n 1. FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>f i s)\n         (\\<lambda>e.\n             FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Up\\<^sub>f i s e)))", "by simp"], ["", "lemma FORK_refines_FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<sqsubseteq> FORK i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<sqsubseteq> FORK i", "proof(unfold FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n      induct rule:fix_ind_k_skip[where k=2 and f=\"\\<Lambda> x.(\\<lambda>s. Mprefix (Tr\\<^sub>f i s) (\\<lambda>e. x (Up\\<^sub>f i s e)))\"])"], ["proof (state)\ngoal (4 subgoals):\n 1. 1 \\<le> 2\n 2. adm (\\<lambda>a. a 0 \\<sqsubseteq> FORK i)\n 3. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i\n 4. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "show \"(1::nat) \\<le> 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> 2", "by simp"], ["proof (state)\nthis:\n  1 \\<le> 2\n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a. a 0 \\<sqsubseteq> FORK i)\n 2. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i\n 3. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a. a 0 \\<sqsubseteq> FORK i)\n 2. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i\n 3. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "show \"adm (\\<lambda>a. a 0 \\<sqsubseteq> FORK i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a. a (0::'a) \\<sqsubseteq> FORK i)", "by (simp add: cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a. a (0::?'a1) \\<sqsubseteq> FORK i)\n\ngoal (2 subgoals):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "case base_k_steps:3"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "show ?case (is \"\\<forall>j<2. (iterate j\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> FORK i\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "have less_2:\"\\<And>j. (j::nat) < 2 = (j = 0 \\<or> j = 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j. (j < 2) = (j = 0 \\<or> j = 1)", "by linarith"], ["proof (state)\nthis:\n  (?j < 2) = (?j = 0 \\<or> ?j = 1)\n\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "moreover"], ["proof (state)\nthis:\n  (?j < 2) = (?j = 0 \\<or> ?j = 1)\n\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "have \"(iterate 0\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> FORK i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 0\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>f i s)\n              (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    FORK i", "by simp"], ["proof (state)\nthis:\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  FORK i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "moreover"], ["proof (state)\nthis:\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  FORK i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "have \"(iterate 1\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> FORK i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>f i s)\n              (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    FORK i", "by (subst FORK_rec)\n         (simp add: write0_def\n                    fork_transitions_def\n                    mprefix_Un_distr mono_det_ref mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  FORK i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "ultimately"], ["proof (chain)\npicking this:\n  (?j < 2) = (?j = 0 \\<or> ?j = 1)\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  FORK i\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  FORK i", "show ?thesis"], ["proof (prove)\nusing this:\n  (?j < 2) = (?j = 0 \\<or> ?j = 1)\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  FORK i\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  FORK i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<2.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       FORK i", "by simp"], ["proof (state)\nthis:\n  \\<forall>ia<2.\n     (iterate ia\\<cdot>\n      (\\<Lambda> x.\n          (\\<lambda>s.\n              Mprefix (Tr\\<^sub>f i s)\n               (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n      \\<bottom>)\n      0 \\<sqsubseteq>\n     FORK i\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>ia<2.\n     (iterate ia\\<cdot>\n      (\\<Lambda> x.\n          (\\<lambda>s.\n              Mprefix (Tr\\<^sub>f i s)\n               (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n      \\<bottom>)\n      0 \\<sqsubseteq>\n     FORK i\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "case step:(4 x)"], ["proof (state)\nthis:\n  x 0 \\<sqsubseteq> FORK i\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> FORK i \\<Longrightarrow>\n       (iterate 2\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>f i s)\n                 (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       FORK i", "then"], ["proof (chain)\npicking this:\n  x 0 \\<sqsubseteq> FORK i", "show ?case (is \"(iterate 2\\<cdot>?f\\<cdot>x) 0 \\<sqsubseteq> FORK i\")"], ["proof (prove)\nusing this:\n  x 0 \\<sqsubseteq> FORK i\n\ngoal (1 subgoal):\n 1. (iterate 2\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>f i s)\n              (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n     x)\n     0 \\<sqsubseteq>\n    FORK i", "by (subst FORK_rec)\n       (simp add: write0_def numeral_2_eq_2\n                  fork_transitions_def fork_state_update_def\n                  mprefix_Un_distr mono_det_ref mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f i s)\n            (\\<lambda>e. x (Up\\<^sub>f i s e))))\\<cdot>\n   x)\n   0 \\<sqsubseteq>\n  FORK i\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_FORK: \"FORK i \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORK i \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "proof(unfold FORK_def,\n      induct rule:fix_ind_k_skip[where k=1])"], ["proof (state)\ngoal (4 subgoals):\n 1. 1 \\<le> 1\n 2. adm (\\<lambda>a.\n            a \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n 3. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 4. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show \"(1::nat) \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> 1", "by simp"], ["proof (state)\nthis:\n  1 \\<le> 1\n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n 2. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 3. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n 2. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 3. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show \"adm (\\<lambda>a. a \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)", "by simp"], ["proof (state)\nthis:\n  adm (\\<lambda>a. a \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n\ngoal (2 subgoals):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "case base_k_steps:3"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "by simp"], ["proof (state)\nthis:\n  \\<forall>ia<1.\n     iterate ia\\<cdot>\n     (\\<Lambda> x.\n         picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n         picks ((i + 1) mod N) i \n            \\<rightarrow> putsdown ((i + 1) mod N) i \\<rightarrow> x)\\<cdot>\n     \\<bottom> \\<sqsubseteq>\n     FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "case step:(4 x)"], ["proof (state)\nthis:\n  x \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n           picks ((i + 1) mod N) i \n              \\<rightarrow> putsdown ((i + 1) mod N) i \n                               \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "then"], ["proof (chain)\npicking this:\n  x \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show ?case (is \"iterate 1\\<cdot>?f\\<cdot>x \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\")"], ["proof (prove)\nusing this:\n  x \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal (1 subgoal):\n 1. iterate 1\\<cdot>\n    (\\<Lambda> x.\n        picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n        picks ((i + 1) mod N) i \n           \\<rightarrow> putsdown ((i + 1) mod N) i \\<rightarrow> x)\\<cdot>\n    x \\<sqsubseteq>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "apply (subst FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    iterate 1\\<cdot>\n    (\\<Lambda> x.\n        picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n        picks ((i + 1) mod N) i \n           \\<rightarrow> putsdown ((i + 1) mod N) i \\<rightarrow> x)\\<cdot>\n    x \\<sqsubseteq>\n    Mprefix (Tr\\<^sub>f i 0)\n     (\\<lambda>e. FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Up\\<^sub>f i 0 e))", "apply (simp add: write0_def\n                     fork_transitions_def fork_state_update_def\n                     mprefix_Un_distr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    (Mprefix {picks i i}\n      (\\<lambda>xa. Mprefix {putsdown i i} (\\<lambda>xa. x)) [+]\n     Mprefix {picks (Suc i mod N) i}\n      (\\<lambda>xa.\n          Mprefix {putsdown (Suc i mod N) i}\n           (\\<lambda>xa. x))) \\<sqsubseteq>\n    (Mprefix {picks i i}\n      (\\<lambda>e.\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n           (if e = picks i i then 1\n            else if e = picks ((i + 1) mod N) i then 2 else 0)) [+]\n     Mprefix {picks (Suc i mod N) i}\n      (\\<lambda>e.\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n           (if e = picks i i then 1\n            else if e = picks ((i + 1) mod N) i then 2 else 0)))", "by (subst (1 2) FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec)\n       (simp add: fork_transitions_def fork_state_update_def\n                  mprefix_Un_distr mono_det_ref mono_mprefix_ref)"], ["proof (state)\nthis:\n  iterate 1\\<cdot>\n  (\\<Lambda> x.\n      picks i i \\<rightarrow> putsdown i i \\<rightarrow> x [+]\n      picks ((i + 1) mod N) i \n         \\<rightarrow> putsdown ((i + 1) mod N) i \\<rightarrow> x)\\<cdot>\n  x \\<sqsubseteq>\n  FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_FORK: \"FORK i = FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORK i = FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "using FORK_refines_FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_FORK below_antisym"], ["proof (prove)\nusing this:\n  FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?i 0 \\<sqsubseteq> FORK ?i\n  FORK ?i \\<sqsubseteq> FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?i 0\n  \\<lbrakk>?x \\<sqsubseteq> ?y; ?y \\<sqsubseteq> ?x\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (1 subgoal):\n 1. FORK i = FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "by blast"], ["", "text \\<open>The all-forks process in normal form\\<close>"], ["", "type_synonym forks_state = \"nat list\""], ["", "definition forks_transitions:: \"nat \\<Rightarrow> forks_state \\<Rightarrow> dining_event set\" (\"Tr\\<^sub>F\")\n  where \"Tr\\<^sub>F n fs = (\\<Union>i<n. Tr\\<^sub>f i (fs!i))\""], ["", "lemma forks_transitions_take: \"Tr\\<^sub>F n fs = Tr\\<^sub>F n (take n fs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Tr\\<^sub>F n fs = Tr\\<^sub>F n (take n fs)", "by (simp add:forks_transitions_def)"], ["", "definition forks_state_update:: \"forks_state \\<Rightarrow> dining_event \\<Rightarrow> forks_state\" (\"Up\\<^sub>F\")\n  where \"Up\\<^sub>F fs e = (let i=(fork e) in fs[i:=(Up\\<^sub>f i (fs!i) e)])\""], ["", "lemma forks_update_take: \"take n (Up\\<^sub>F fs e) = Up\\<^sub>F (take n fs) e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. take n (Up\\<^sub>F fs e) = Up\\<^sub>F (take n fs) e", "unfolding forks_state_update_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. take n (let i = fork e in fs[i := Up\\<^sub>f i (fs ! i) e]) =\n    (let i = fork e in (take n fs)[i := Up\\<^sub>f i (take n fs ! i) e])", "by (metis nat_less_le nat_neq_iff nth_take order_refl take_update_cancel take_update_swap)"], ["", "definition FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:: \"nat \\<Rightarrow> forks_state \\<Rightarrow> dining_event process\"\n  where \"FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>F n ,Up\\<^sub>F\\<rbrakk>\""], ["", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = (\\<lambda> fs. \\<box> e \\<in> (Tr\\<^sub>F n fs) \\<rightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>F fs e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n =\n    (\\<lambda>fs.\n        Mprefix (Tr\\<^sub>F n fs)\n         (\\<lambda>e.\n             FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>F fs e)))", "using fix_eq[of \"\\<Lambda> X. (\\<lambda>fs. Mprefix (Tr\\<^sub>F n fs) (\\<lambda>e. X (Up\\<^sub>F fs e)))\"] FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>F\n       n,Up\\<^sub>F\\<rbrakk> =\n  (\\<Lambda> X.\n      (\\<lambda>fs.\n          Mprefix (Tr\\<^sub>F n fs)\n           (\\<lambda>e. X (Up\\<^sub>F fs e))))\\<cdot>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>F\n        n,Up\\<^sub>F\\<rbrakk>)\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?n =\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>F\n       ?n,Up\\<^sub>F\\<rbrakk>\n\ngoal (1 subgoal):\n 1. FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n =\n    (\\<lambda>fs.\n        Mprefix (Tr\\<^sub>F n fs)\n         (\\<lambda>e.\n             FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>F fs e)))", "by simp"], ["", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_0: \"FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 fs = STOP\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 fs = STOP", "by (subst FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add:forks_transitions_def Mprefix_STOP)"], ["", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir1: \"length fs > 0 \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs \\<sqsubseteq> (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs!0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < length fs \\<Longrightarrow>\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs \\<sqsubseteq>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs ! 0)", "proof(unfold FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n      induct arbitrary:fs rule:fix_ind_k[where k=1\n                                         and f=\"\\<Lambda> x. (\\<lambda>fs. Mprefix (Tr\\<^sub>F 1 fs) (\\<lambda>e. x (Up\\<^sub>F fs e)))\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a x \\<sqsubseteq>\n               FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0))\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>F 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "case adm:1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a x \\<sqsubseteq>\n               FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0))\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>F 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a x \\<sqsubseteq>\n               FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0))", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x.\n             0 < length x \\<longrightarrow>\n             a x \\<sqsubseteq>\n             FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0))\n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>F 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>F 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "case base_k_steps:2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>F 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>fs.\n                   Mprefix (Tr\\<^sub>F 1 fs)\n                    (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>fs.\n                 Mprefix (Tr\\<^sub>F 1 fs)\n                  (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n         \\<bottom>)\n         x \\<sqsubseteq>\n        FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "case step:(3 X)"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>fs.\n                 Mprefix (Tr\\<^sub>F 1 fs)\n                  (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n  0 < length fs\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "hence \"(\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)\""], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>fs.\n                 Mprefix (Tr\\<^sub>F 1 fs)\n                  (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n  0 < length fs\n\ngoal (1 subgoal):\n 1. (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)", "by auto"], ["proof (state)\nthis:\n  (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>F 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (s ! 0)", "with step"], ["proof (chain)\npicking this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>fs.\n                 Mprefix (Tr\\<^sub>F 1 fs)\n                  (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n  0 < length fs\n  (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>fs.\n                 Mprefix (Tr\\<^sub>F 1 fs)\n                  (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0)\n  0 < length fs\n  (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)\n\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>fs.\n             Mprefix (Tr\\<^sub>F 1 fs)\n              (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n     X)\n     fs \\<sqsubseteq>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs ! 0)", "apply (subst FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add:forks_state_update_def forks_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                x \\<noteq> [] \\<longrightarrow>\n                X x \\<sqsubseteq>\n                FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0);\n     fs \\<noteq> [];\n     (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) =\n     Tr\\<^sub>f 0 (fs ! 0)\\<rbrakk>\n    \\<Longrightarrow> Mprefix (Tr\\<^sub>f 0 (fs ! 0))\n                       (\\<lambda>e.\n                           X (let i = fork e\n                              in fs[i :=\nUp\\<^sub>f i (fs ! i) e])) \\<sqsubseteq>\n                      Mprefix (Tr\\<^sub>f 0 (fs ! 0))\n                       (\\<lambda>e.\n                           FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n                            (Up\\<^sub>f 0 (fs ! 0) e))", "apply (intro mono_mprefix_ref, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   x \\<noteq> [] \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (x ! 0);\n        fs \\<noteq> [];\n        (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0);\n        x \\<in> Tr\\<^sub>f 0 (fs ! 0)\\<rbrakk>\n       \\<Longrightarrow> X (let i = fork x\n                            in fs[i := Up\\<^sub>f i (fs ! i)\n  x]) \\<sqsubseteq>\n                         FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n                          (Up\\<^sub>f 0 (fs ! 0) x)", "by (metis ev_fork_idx step.prems list_update_nonempty nth_list_update_eq)"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>fs.\n           Mprefix (Tr\\<^sub>F 1 fs)\n            (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n   X)\n   fs \\<sqsubseteq>\n  FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs ! 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir2: \"length fs > 0 \\<Longrightarrow> (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs!0)) \\<sqsubseteq> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < length fs \\<Longrightarrow>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs ! 0) \\<sqsubseteq>\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "proof(unfold FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n      induct arbitrary:fs rule:fix_ind_k[where k=1\n                                         and f=\"\\<Lambda> x. (\\<lambda>s. Mprefix (Tr\\<^sub>f 0 s) (\\<lambda>e. x (Up\\<^sub>f 0 s e)))\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a (x ! 0) \\<sqsubseteq>\n               FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>f 0 s)\n                    (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 3. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "case adm:1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a (x ! 0) \\<sqsubseteq>\n               FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>f 0 s)\n                    (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 3. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a (x ! 0) \\<sqsubseteq>\n               FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x.\n             0 < length x \\<longrightarrow>\n             a (x ! 0) \\<sqsubseteq>\n             FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)\n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>f 0 s)\n                    (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 2. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>f 0 s)\n                    (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 2. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "case base_k_steps:2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>f 0 s)\n                    (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 2. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>f 0 s)\n                    (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>f 0 s)\n                  (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n         \\<bottom>)\n         (x ! 0) \\<sqsubseteq>\n        FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n\ngoal (1 subgoal):\n 1. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "case step:(3 X)"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>f 0 s)\n                  (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n         X)\n         (x ! 0) \\<sqsubseteq>\n        FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n  0 < length fs\n\ngoal (1 subgoal):\n 1. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "have \"(\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)", "by auto"], ["proof (state)\nthis:\n  (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)\n\ngoal (1 subgoal):\n 1. \\<And>x fs.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>f 0 s)\n                                (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length fs\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>f 0 s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>f 0 s e))))\\<cdot>\n                          x)\n                          (fs ! 0) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "with step"], ["proof (chain)\npicking this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>f 0 s)\n                  (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n         X)\n         (x ! 0) \\<sqsubseteq>\n        FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n  0 < length fs\n  (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>f 0 s)\n                  (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n         X)\n         (x ! 0) \\<sqsubseteq>\n        FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n  0 < length fs\n  (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0)\n\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>f 0 s)\n              (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n     X)\n     (fs ! 0) \\<sqsubseteq>\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "apply (subst FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add:forks_state_update_def forks_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                x \\<noteq> [] \\<longrightarrow>\n                X (x ! 0) \\<sqsubseteq>\n                FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x;\n     fs \\<noteq> [];\n     (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) =\n     Tr\\<^sub>f 0 (fs ! 0)\\<rbrakk>\n    \\<Longrightarrow> Mprefix (Tr\\<^sub>f 0 (fs ! 0))\n                       (\\<lambda>e.\n                           X (Up\\<^sub>f 0 (fs ! 0) e)) \\<sqsubseteq>\n                      Mprefix (Tr\\<^sub>f 0 (fs ! 0))\n                       (\\<lambda>e.\n                           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n                            (let i = fork e\n                             in fs[i := Up\\<^sub>f i (fs ! i) e]))", "apply (intro mono_mprefix_ref, safe)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   x \\<noteq> [] \\<longrightarrow>\n                   X (x ! 0) \\<sqsubseteq>\n                   FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x;\n        fs \\<noteq> [];\n        (\\<Union>i<Suc 0. Tr\\<^sub>f i (fs ! i)) = Tr\\<^sub>f 0 (fs ! 0);\n        x \\<in> Tr\\<^sub>f 0 (fs ! 0)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>f 0 (fs ! 0) x) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n                          (let i = fork x\n                           in fs[i := Up\\<^sub>f i (fs ! i) x])", "by (metis ev_fork_idx step.prems list_update_nonempty nth_list_update_eq)"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>f 0 s)\n            (\\<lambda>e. x (Up\\<^sub>f 0 s e))))\\<cdot>\n   X)\n   (fs ! 0) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1: \"length fs > 0 \\<Longrightarrow> (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs!0)) = FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < length fs \\<Longrightarrow>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs ! 0) =\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "using FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir1 FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir2 below_antisym"], ["proof (prove)\nusing this:\n  0 < length ?fs \\<Longrightarrow>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ?fs \\<sqsubseteq>\n  FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (?fs ! 0)\n  0 < length ?fs \\<Longrightarrow>\n  FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (?fs ! 0) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ?fs\n  \\<lbrakk>?x \\<sqsubseteq> ?y; ?y \\<sqsubseteq> ?x\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (1 subgoal):\n 1. 0 < length fs \\<Longrightarrow>\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 (fs ! 0) =\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 fs", "by blast"], ["", "lemma FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_unfold:\n\"0 < n \\<Longrightarrow> length fs = Suc n \\<Longrightarrow>\n                              FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs = (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast fs)|||(FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (fs!n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs =\n                      (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n))", "proof(rule below_antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n)\n                       fs \\<sqsubseteq>\n                      (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n))\n 2. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n)) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs", "show \"0 < n \\<Longrightarrow> length fs = Suc n \\<Longrightarrow>\n                               FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs \\<sqsubseteq> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (fs!n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n)\n                       fs \\<sqsubseteq>\n                      (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n))", "proof(subst FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n        induct arbitrary:fs\n               rule:fix_ind_k[where k=1\n                              and f=\"\\<Lambda> x. (\\<lambda>fs. Mprefix (Tr\\<^sub>F (Suc n) fs) (\\<lambda>e. x (Up\\<^sub>F fs e)))\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            0 < n \\<longrightarrow>\n            (\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                a x \\<sqsubseteq>\n                (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                  (butlast\n                    x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))))\n 2. \\<forall>i<1.\n       0 < n \\<longrightarrow>\n       (\\<forall>x.\n           length x = Suc n \\<longrightarrow>\n           (iterate i\\<cdot>\n            (\\<Lambda> x.\n                (\\<lambda>s.\n                    Mprefix (Tr\\<^sub>F (Suc n) s)\n                     (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n            \\<bottom>)\n            x \\<sqsubseteq>\n           (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n             (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "case adm:1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            0 < n \\<longrightarrow>\n            (\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                a x \\<sqsubseteq>\n                (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                  (butlast\n                    x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))))\n 2. \\<forall>i<1.\n       0 < n \\<longrightarrow>\n       (\\<forall>x.\n           length x = Suc n \\<longrightarrow>\n           (iterate i\\<cdot>\n            (\\<Lambda> x.\n                (\\<lambda>s.\n                    Mprefix (Tr\\<^sub>F (Suc n) s)\n                     (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n            \\<bottom>)\n            x \\<sqsubseteq>\n           (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n             (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            0 < n \\<longrightarrow>\n            (\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                a x \\<sqsubseteq>\n                (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                  (butlast\n                    x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))))", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          0 < n \\<longrightarrow>\n          (\\<forall>x.\n              length x = Suc n \\<longrightarrow>\n              a x \\<sqsubseteq>\n              (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                (butlast\n                  x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))))\n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       0 < n \\<longrightarrow>\n       (\\<forall>x.\n           length x = Suc n \\<longrightarrow>\n           (iterate i\\<cdot>\n            (\\<Lambda> x.\n                (\\<lambda>s.\n                    Mprefix (Tr\\<^sub>F (Suc n) s)\n                     (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n            \\<bottom>)\n            x \\<sqsubseteq>\n           (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n             (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       0 < n \\<longrightarrow>\n       (\\<forall>x.\n           length x = Suc n \\<longrightarrow>\n           (iterate i\\<cdot>\n            (\\<Lambda> x.\n                (\\<lambda>s.\n                    Mprefix (Tr\\<^sub>F (Suc n) s)\n                     (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n            \\<bottom>)\n            x \\<sqsubseteq>\n           (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n             (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "case base_k_steps:2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       0 < n \\<longrightarrow>\n       (\\<forall>x.\n           length x = Suc n \\<longrightarrow>\n           (iterate i\\<cdot>\n            (\\<Lambda> x.\n                (\\<lambda>s.\n                    Mprefix (Tr\\<^sub>F (Suc n) s)\n                     (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n            \\<bottom>)\n            x \\<sqsubseteq>\n           (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n             (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<1.\n       0 < n \\<longrightarrow>\n       (\\<forall>x.\n           length x = Suc n \\<longrightarrow>\n           (iterate i\\<cdot>\n            (\\<Lambda> x.\n                (\\<lambda>fs.\n                    Mprefix (Tr\\<^sub>F (Suc n) fs)\n                     (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n            \\<bottom>)\n            x \\<sqsubseteq>\n           (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n             (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     0 < n \\<longrightarrow>\n     (\\<forall>x.\n         length x = Suc n \\<longrightarrow>\n         (iterate i\\<cdot>\n          (\\<Lambda> x.\n              (\\<lambda>fs.\n                  Mprefix (Tr\\<^sub>F (Suc n) fs)\n                   (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n          \\<bottom>)\n          x \\<sqsubseteq>\n         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n           (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "case step:(3 X)"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     0 < n \\<longrightarrow>\n     (\\<forall>x.\n         length x = Suc n \\<longrightarrow>\n         (iterate i\\<cdot>\n          (\\<Lambda> x.\n              (\\<lambda>fs.\n                  Mprefix (Tr\\<^sub>F (Suc n) fs)\n                   (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n          X)\n          x \\<sqsubseteq>\n         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n           (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n  0 < n\n  length fs = Suc n\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "have indep:\"\\<forall>s\\<^sub>1 s\\<^sub>2. Tr\\<^sub>F n s\\<^sub>1 \\<inter> Tr\\<^sub>f n s\\<^sub>2 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s\\<^sub>1 s\\<^sub>2.\n       Tr\\<^sub>F n s\\<^sub>1 \\<inter> Tr\\<^sub>f n s\\<^sub>2 = {}", "by (auto simp add:forks_transitions_def fork_transitions_def)"], ["proof (state)\nthis:\n  \\<forall>s\\<^sub>1 s\\<^sub>2.\n     Tr\\<^sub>F n s\\<^sub>1 \\<inter> Tr\\<^sub>f n s\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   0 < n \\<longrightarrow>\n                   (\\<forall>xa.\n                       length xa = Suc n \\<longrightarrow>\n                       (iterate i\\<cdot>\n                        (\\<Lambda> x.\n                            (\\<lambda>s.\n                                Mprefix (Tr\\<^sub>F (Suc n) s)\n                                 (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                        x)\n                        xa \\<sqsubseteq>\n                       (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                         (butlast\n                           xa)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                  (xa ! n)));\n        0 < n; length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>F (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>F s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "from step"], ["proof (chain)\npicking this:\n  \\<forall>i<1.\n     0 < n \\<longrightarrow>\n     (\\<forall>x.\n         length x = Suc n \\<longrightarrow>\n         (iterate i\\<cdot>\n          (\\<Lambda> x.\n              (\\<lambda>fs.\n                  Mprefix (Tr\\<^sub>F (Suc n) fs)\n                   (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n          X)\n          x \\<sqsubseteq>\n         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n           (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n  0 < n\n  length fs = Suc n", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     0 < n \\<longrightarrow>\n     (\\<forall>x.\n         length x = Suc n \\<longrightarrow>\n         (iterate i\\<cdot>\n          (\\<Lambda> x.\n              (\\<lambda>fs.\n                  Mprefix (Tr\\<^sub>F (Suc n) fs)\n                   (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n          X)\n          x \\<sqsubseteq>\n         (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n           (butlast x)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n  0 < n\n  length fs = Suc n\n\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>fs.\n             Mprefix (Tr\\<^sub>F (Suc n) fs)\n              (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n     X)\n     fs \\<sqsubseteq>\n    (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (fs ! n))", "apply (auto simp add:indep dnorm_inter FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                X x \\<sqsubseteq>\n                (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                        case s of\n                        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                          Tr\\<^sub>F n s\\<^sub>1 \\<union>\n                          Tr\\<^sub>f n\n                           s\\<^sub>2,\\<lambda>s.\n  case s of\n  (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n    \\<lambda>e.\n       if e \\<in> Tr\\<^sub>F n s\\<^sub>1\n       then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n       else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n            then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n            else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                 (butlast x, x ! n);\n     0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> Mprefix (Tr\\<^sub>F (Suc n) fs)\n                       (\\<lambda>e. X (Up\\<^sub>F fs e)) \\<sqsubseteq>\n                      (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                              case s of\n                              (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                Tr\\<^sub>F n s\\<^sub>1 \\<union>\n                                Tr\\<^sub>f n\n                                 s\\<^sub>2,\\<lambda>s.\n        case s of\n        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n          \\<lambda>e.\n             if e \\<in> Tr\\<^sub>F n s\\<^sub>1\n             then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n             else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                  then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                  else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                       (butlast fs, fs ! n)", "apply (subst fix_eq, simp add:forks_transitions_def Un_commute lessThan_Suc nth_butlast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                X x \\<sqsubseteq>\n                (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                        case s of\n                        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                          Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                          (\\<Union>i<n.\n                              Tr\\<^sub>f i\n                               (s\\<^sub>1 !\n                                i)),\\<lambda>s.\n case s of\n (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n   \\<lambda>e.\n      if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n      then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n      else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n           then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n           else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                 (butlast x, x ! n);\n     0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> Mprefix\n                       (Tr\\<^sub>f n (fs ! n) \\<union>\n                        (\\<Union>x<n. Tr\\<^sub>f x (fs ! x)))\n                       (\\<lambda>e. X (Up\\<^sub>F fs e)) \\<sqsubseteq>\n                      Mprefix\n                       (Tr\\<^sub>f n (fs ! n) \\<union>\n                        (\\<Union>x<n. Tr\\<^sub>f x (fs ! x)))\n                       (\\<lambda>e.\n                           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                   case s of\n                                   (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                     Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                     (\\<Union>i<n.\n   Tr\\<^sub>f i\n    (s\\<^sub>1 !\n     i)),\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              \\<lambda>e.\n                 if \\<exists>x\\<in>{..<n}.\n                       e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                      then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                      else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                            (if \\<exists>x\\<in>{..<n}.\n                                   e \\<in> Tr\\<^sub>f x (fs ! x)\n                             then (Up\\<^sub>F (butlast fs) e, fs ! n)\n                             else if e \\<in> Tr\\<^sub>f n (fs ! n)\n                                  then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n                                  else (butlast fs, fs ! n)))", "proof(rule mono_mprefix_ref, safe, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f n (fs ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "case (1 e)"], ["proof (state)\nthis:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>f n s\\<^sub>2 \\<union>\n               (\\<Union>i<n.\n                   Tr\\<^sub>f i\n                    (s\\<^sub>1 !\n                     i)),\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if \\<exists>x\\<in>{..<n}.\n e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f n (fs ! n)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f n (fs ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "from 1(4)"], ["proof (chain)\npicking this:\n  e \\<in> Tr\\<^sub>f n (fs ! n)", "have a:\"fork e = n\""], ["proof (prove)\nusing this:\n  e \\<in> Tr\\<^sub>f n (fs ! n)\n\ngoal (1 subgoal):\n 1. fork e = n", "by (auto simp add:fork_transitions_def split:if_splits)"], ["proof (state)\nthis:\n  fork e = n\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f n (fs ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. X (Up\\<^sub>F fs e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>f n s\\<^sub>2 \\<union>\n              (\\<Union>i<n.\n                  Tr\\<^sub>f i\n                   (s\\<^sub>1 !\n                    i)),\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             \\<lambda>e.\n                                if \\<exists>x\\<in>{..<n}.\ne \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                     then (s\\<^sub>1,\n     Up\\<^sub>f n s\\<^sub>2 e)\n                                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n      then (Up\\<^sub>F (butlast fs) e, fs ! n)\n      else if e \\<in> Tr\\<^sub>f n (fs ! n)\n           then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n           else (butlast fs, fs ! n))", "using 1(1)[rule_format, of \"(Up\\<^sub>F fs e)\"]"], ["proof (prove)\nusing this:\n  length (Up\\<^sub>F fs e) = Suc n \\<Longrightarrow>\n  X (Up\\<^sub>F fs e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>f n s\\<^sub>2 \\<union>\n            (\\<Union>i<n.\n                Tr\\<^sub>f i\n                 (s\\<^sub>1 !\n                  i)),\\<lambda>s.\n                         case s of\n                         (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                           \\<lambda>e.\n                              if \\<exists>x\\<in>{..<n}.\n                                    e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                              then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                              else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                   then (s\\<^sub>1,\n   Up\\<^sub>f n s\\<^sub>2 e)\n                                   else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (butlast (Up\\<^sub>F fs e), Up\\<^sub>F fs e ! n)\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>F fs e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>f n s\\<^sub>2 \\<union>\n              (\\<Union>i<n.\n                  Tr\\<^sub>f i\n                   (s\\<^sub>1 !\n                    i)),\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             \\<lambda>e.\n                                if \\<exists>x\\<in>{..<n}.\ne \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                     then (s\\<^sub>1,\n     Up\\<^sub>f n s\\<^sub>2 e)\n                                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n      then (Up\\<^sub>F (butlast fs) e, fs ! n)\n      else if e \\<in> Tr\\<^sub>f n (fs ! n)\n           then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n           else (butlast fs, fs ! n))", "apply (simp add: 1 a butlast_list_update forks_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. X (fs[n := Up\\<^sub>f n (fs ! n) e]) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>f n s\\<^sub>2 \\<union>\n              (\\<Union>i<n.\n                  Tr\\<^sub>f i\n                   (s\\<^sub>1 !\n                    i)),\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             \\<lambda>e.\n                                if \\<exists>x\\<in>{..<n}.\ne \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                     then (s\\<^sub>1,\n     Up\\<^sub>f n s\\<^sub>2 e)\n                                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (butlast fs, Up\\<^sub>f n (fs ! n) e) \\<Longrightarrow>\n    (\\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)) \\<longrightarrow>\n    X (fs[n := Up\\<^sub>f n (fs ! n) e]) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>f n s\\<^sub>2 \\<union>\n              (\\<Union>i<n.\n                  Tr\\<^sub>f i\n                   (s\\<^sub>1 !\n                    i)),\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             \\<lambda>e.\n                                if \\<exists>x\\<in>{..<n}.\ne \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                     then (s\\<^sub>1,\n     Up\\<^sub>f n s\\<^sub>2 e)\n                                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (butlast fs, fs ! n)", "by (metis 1(4) ev_fork_idx lessThan_iff less_not_refl)"], ["proof (state)\nthis:\n  X (Up\\<^sub>F fs e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>f n s\\<^sub>2 \\<union>\n            (\\<Union>i<n.\n                Tr\\<^sub>f i\n                 (s\\<^sub>1 !\n                  i)),\\<lambda>s.\n                         case s of\n                         (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                           \\<lambda>e.\n                              if \\<exists>x\\<in>{..<n}.\n                                    e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                              then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                              else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                   then (s\\<^sub>1,\n   Up\\<^sub>f n s\\<^sub>2 e)\n                                   else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n    then (Up\\<^sub>F (butlast fs) e, fs ! n)\n    else if e \\<in> Tr\\<^sub>f n (fs ! n)\n         then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n         else (butlast fs, fs ! n))\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "case (2 e m)"], ["proof (state)\nthis:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>f n s\\<^sub>2 \\<union>\n               (\\<Union>i<n.\n                   Tr\\<^sub>f i\n                    (s\\<^sub>1 !\n                     i)),\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if \\<exists>x\\<in>{..<n}.\n e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "hence a:\"e \\<notin> Tr\\<^sub>f n (fs ! n)\""], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>f n s\\<^sub>2 \\<union>\n               (\\<Union>i<n.\n                   Tr\\<^sub>f i\n                    (s\\<^sub>1 !\n                     i)),\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if \\<exists>x\\<in>{..<n}.\n e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n\ngoal (1 subgoal):\n 1. e \\<notin> Tr\\<^sub>f n (fs ! n)", "using ev_fork_idx"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>f n s\\<^sub>2 \\<union>\n               (\\<Union>i<n.\n                   Tr\\<^sub>f i\n                    (s\\<^sub>1 !\n                     i)),\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if \\<exists>x\\<in>{..<n}.\n e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n  ?e \\<in> Tr\\<^sub>f ?i ?s \\<Longrightarrow> fork ?e = ?i\n\ngoal (1 subgoal):\n 1. e \\<notin> Tr\\<^sub>f n (fs ! n)", "by fastforce"], ["proof (state)\nthis:\n  e \\<notin> Tr\\<^sub>f n (fs ! n)\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "hence c:\"Up\\<^sub>F fs e ! n = fs ! n\""], ["proof (prove)\nusing this:\n  e \\<notin> Tr\\<^sub>f n (fs ! n)\n\ngoal (1 subgoal):\n 1. Up\\<^sub>F fs e ! n = fs ! n", "by (metis 2(4) ev_fork_idx forks_state_update_def nth_list_update_neq)"], ["proof (state)\nthis:\n  Up\\<^sub>F fs e ! n = fs ! n\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "have d:\"Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)", "apply(simp add:forks_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (let i = fork e in (butlast fs)[i := Up\\<^sub>f i (butlast fs ! i) e]) =\n    butlast (let i = fork e in fs[i := Up\\<^sub>f i (fs ! i) e])", "by (metis butlast_conv_take forks_state_update_def forks_update_take length_list_update)"], ["proof (state)\nthis:\n  Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                             (\\<Union>i<n.\n                                 Tr\\<^sub>f i\n                                  (s\\<^sub>1 !\n                                   i)),\\<lambda>s.\n    case s of\n    (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n      \\<lambda>e.\n         if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n         then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n         else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n              then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n              else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>F fs x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>f n s\\<^sub>2 \\<union>\n                                   (\\<Union>i<n.\n Tr\\<^sub>f i\n  (s\\<^sub>1 !\n   i)),\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            \\<lambda>e.\n               if \\<exists>x\\<in>{..<n}.\n                     e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n               then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n               else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                    then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if \\<exists>xa\\<in>{..<n}.\n                                 x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                           then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                           else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                else (butlast fs, fs ! n))", "from 2 a"], ["proof (chain)\npicking this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>f n s\\<^sub>2 \\<union>\n               (\\<Union>i<n.\n                   Tr\\<^sub>f i\n                    (s\\<^sub>1 !\n                     i)),\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if \\<exists>x\\<in>{..<n}.\n e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n  e \\<notin> Tr\\<^sub>f n (fs ! n)", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>f n s\\<^sub>2 \\<union>\n               (\\<Union>i<n.\n                   Tr\\<^sub>f i\n                    (s\\<^sub>1 !\n                     i)),\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if \\<exists>x\\<in>{..<n}.\n e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n  e \\<notin> Tr\\<^sub>f n (fs ! n)\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>F fs e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>f n s\\<^sub>2 \\<union>\n              (\\<Union>i<n.\n                  Tr\\<^sub>f i\n                   (s\\<^sub>1 !\n                    i)),\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             \\<lambda>e.\n                                if \\<exists>x\\<in>{..<n}.\ne \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                     then (s\\<^sub>1,\n     Up\\<^sub>f n s\\<^sub>2 e)\n                                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n      then (Up\\<^sub>F (butlast fs) e, fs ! n)\n      else if e \\<in> Tr\\<^sub>f n (fs ! n)\n           then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n           else (butlast fs, fs ! n))", "using 2(1)[rule_format, of \"(Up\\<^sub>F fs e)\"] c d forks_state_update_def"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>f n s\\<^sub>2 \\<union>\n               (\\<Union>i<n.\n                   Tr\\<^sub>f i\n                    (s\\<^sub>1 !\n                     i)),\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if \\<exists>x\\<in>{..<n}.\n e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                 then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n  e \\<notin> Tr\\<^sub>f n (fs ! n)\n  length (Up\\<^sub>F fs e) = Suc n \\<Longrightarrow>\n  X (Up\\<^sub>F fs e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>f n s\\<^sub>2 \\<union>\n            (\\<Union>i<n.\n                Tr\\<^sub>f i\n                 (s\\<^sub>1 !\n                  i)),\\<lambda>s.\n                         case s of\n                         (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                           \\<lambda>e.\n                              if \\<exists>x\\<in>{..<n}.\n                                    e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                              then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                              else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                   then (s\\<^sub>1,\n   Up\\<^sub>f n s\\<^sub>2 e)\n                                   else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (butlast (Up\\<^sub>F fs e), Up\\<^sub>F fs e ! n)\n  Up\\<^sub>F fs e ! n = fs ! n\n  Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)\n  Up\\<^sub>F ?fs ?e =\n  (let i = fork ?e in ?fs[i := Up\\<^sub>f i (?fs ! i) ?e])\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>F fs e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>f n s\\<^sub>2 \\<union>\n              (\\<Union>i<n.\n                  Tr\\<^sub>f i\n                   (s\\<^sub>1 !\n                    i)),\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             \\<lambda>e.\n                                if \\<exists>x\\<in>{..<n}.\ne \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                                then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                                else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                     then (s\\<^sub>1,\n     Up\\<^sub>f n s\\<^sub>2 e)\n                                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n      then (Up\\<^sub>F (butlast fs) e, fs ! n)\n      else if e \\<in> Tr\\<^sub>f n (fs ! n)\n           then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n           else (butlast fs, fs ! n))", "by auto"], ["proof (state)\nthis:\n  X (Up\\<^sub>F fs e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>f n s\\<^sub>2 \\<union>\n            (\\<Union>i<n.\n                Tr\\<^sub>f i\n                 (s\\<^sub>1 !\n                  i)),\\<lambda>s.\n                         case s of\n                         (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                           \\<lambda>e.\n                              if \\<exists>x\\<in>{..<n}.\n                                    e \\<in> Tr\\<^sub>f x (s\\<^sub>1 ! x)\n                              then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n                              else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                                   then (s\\<^sub>1,\n   Up\\<^sub>f n s\\<^sub>2 e)\n                                   else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n    then (Up\\<^sub>F (butlast fs) e, fs ! n)\n    else if e \\<in> Tr\\<^sub>f n (fs ! n)\n         then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n         else (butlast fs, fs ! n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>fs.\n           Mprefix (Tr\\<^sub>F (Suc n) fs)\n            (\\<lambda>e. x (Up\\<^sub>F fs e))))\\<cdot>\n   X)\n   fs \\<sqsubseteq>\n  (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n    (butlast fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (fs ! n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n  \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n)\n                     fs \\<sqsubseteq>\n                    (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                      (butlast\n                        fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                               (fs ! n))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n)) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n)) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs", "have indep:\"\\<forall>s\\<^sub>1 s\\<^sub>2. Tr\\<^sub>F n s\\<^sub>1 \\<inter> Tr\\<^sub>f n s\\<^sub>2 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s\\<^sub>1 s\\<^sub>2.\n       Tr\\<^sub>F n s\\<^sub>1 \\<inter> Tr\\<^sub>f n s\\<^sub>2 = {}", "by (auto simp add:forks_transitions_def fork_transitions_def)"], ["proof (state)\nthis:\n  \\<forall>s\\<^sub>1 s\\<^sub>2.\n     Tr\\<^sub>F n s\\<^sub>1 \\<inter> Tr\\<^sub>f n s\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n)) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs", "show \"0 < n \\<Longrightarrow> length fs = Suc n \\<Longrightarrow>\n                              (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (fs!n)) \\<sqsubseteq> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (fs ! n)) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs", "apply (subst FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def, auto simp add:indep dnorm_inter FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                              case s of\n                              (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                Tr\\<^sub>F n s\\<^sub>1 \\<union>\n                                Tr\\<^sub>f n\n                                 s\\<^sub>2,\\<lambda>s.\n        case s of\n        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n          \\<lambda>e.\n             if e \\<in> Tr\\<^sub>F n s\\<^sub>1\n             then (Up\\<^sub>F s\\<^sub>1 e, s\\<^sub>2)\n             else if e \\<in> Tr\\<^sub>f n s\\<^sub>2\n                  then (s\\<^sub>1, Up\\<^sub>f n s\\<^sub>2 e)\n                  else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                       (butlast fs, fs ! n) \\<sqsubseteq>\n                      FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs", "proof(rule fix_ind[where\n        P=\"\\<lambda>a. 0 < n \\<longrightarrow> (\\<forall>x. length x = Suc n \\<longrightarrow> a (butlast x, x ! n) \\<sqsubseteq> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x)\",\n        rule_format], simp_all, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> adm (\\<lambda>a.\n                              \\<forall>x.\n                                 length x = Suc n \\<longrightarrow>\n                                 a (butlast x, x ! n) \\<sqsubseteq>\n                                 FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n                                  (Suc n) x)\n 2. \\<And>x xa.\n       \\<lbrakk>length fs = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        0 < n; length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>F n (butlast xa) \\<union>\n                           Tr\\<^sub>f n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>F n (butlast xa)\n                                 then (Up\\<^sub>F (butlast xa) e, xa ! n)\n                                 else if e \\<in> Tr\\<^sub>f n (xa ! n)\nthen (butlast xa, Up\\<^sub>f n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "case base:1"], ["proof (state)\nthis:\n  0 < n\n  length fs = Suc n\n\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> adm (\\<lambda>a.\n                              \\<forall>x.\n                                 length x = Suc n \\<longrightarrow>\n                                 a (butlast x, x ! n) \\<sqsubseteq>\n                                 FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n                                  (Suc n) x)\n 2. \\<And>x xa.\n       \\<lbrakk>length fs = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        0 < n; length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>F n (butlast xa) \\<union>\n                           Tr\\<^sub>f n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>F n (butlast xa)\n                                 then (Up\\<^sub>F (butlast xa) e, xa ! n)\n                                 else if e \\<in> Tr\\<^sub>f n (xa ! n)\nthen (butlast xa, Up\\<^sub>f n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "then"], ["proof (chain)\npicking this:\n  0 < n\n  length fs = Suc n", "show ?case"], ["proof (prove)\nusing this:\n  0 < n\n  length fs = Suc n\n\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               length x = Suc n \\<longrightarrow>\n               a (butlast x, x ! n) \\<sqsubseteq>\n               FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x)", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x.\n             length x = Suc n \\<longrightarrow>\n             a (butlast x, x ! n) \\<sqsubseteq>\n             FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x)\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>length fs = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        0 < n; length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>F n (butlast xa) \\<union>\n                           Tr\\<^sub>f n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>F n (butlast xa)\n                                 then (Up\\<^sub>F (butlast xa) e, xa ! n)\n                                 else if e \\<in> Tr\\<^sub>f n (xa ! n)\nthen (butlast xa, Up\\<^sub>f n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>length fs = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        0 < n; length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>F n (butlast xa) \\<union>\n                           Tr\\<^sub>f n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>F n (butlast xa)\n                                 then (Up\\<^sub>F (butlast xa) e, xa ! n)\n                                 else if e \\<in> Tr\\<^sub>f n (xa ! n)\nthen (butlast xa, Up\\<^sub>f n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "case step:(2 X fs)"], ["proof (state)\nthis:\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>length fs = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        0 < n; length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>F n (butlast xa) \\<union>\n                           Tr\\<^sub>f n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>F n (butlast xa)\n                                 then (Up\\<^sub>F (butlast xa) e, xa ! n)\n                                 else if e \\<in> Tr\\<^sub>f n (xa ! n)\nthen (butlast xa, Up\\<^sub>f n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "then"], ["proof (chain)\npicking this:\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n", "show ?case"], ["proof (prove)\nusing this:\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n\n\ngoal (1 subgoal):\n 1. Mprefix (Tr\\<^sub>F n (butlast fs) \\<union> Tr\\<^sub>f n (fs ! n))\n     (\\<lambda>e.\n         X (if e \\<in> Tr\\<^sub>F n (butlast fs)\n            then (Up\\<^sub>F (butlast fs) e, fs ! n)\n            else if e \\<in> Tr\\<^sub>f n (fs ! n)\n                 then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n                 else (butlast fs, fs ! n))) \\<sqsubseteq>\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs", "apply (unfold FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def, subst fix_eq, simp add:forks_transitions_def\n                                                          Un_commute lessThan_Suc nth_butlast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<And>x.\n                length x = Suc n \\<Longrightarrow>\n                X (butlast x, x ! n) \\<sqsubseteq>\n                (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                        Tr\\<^sub>f n (s ! n) \\<union>\n                        (\\<Union>x<n.\n                            Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                 x;\n     length fs = Suc n;\n     \\<And>x.\n        length x = Suc n \\<Longrightarrow>\n        X (butlast x, x ! n) \\<sqsubseteq>\n        FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n     0 < n; length fs = Suc n\\<rbrakk>\n    \\<Longrightarrow> Mprefix\n                       (Tr\\<^sub>f n (fs ! n) \\<union>\n                        (\\<Union>x<n. Tr\\<^sub>f x (fs ! x)))\n                       (\\<lambda>e.\n                           X (if \\<exists>x\\<in>{..<n}.\n                                    e \\<in> Tr\\<^sub>f x (fs ! x)\n                              then (Up\\<^sub>F (butlast fs) e, fs ! n)\n                              else if e \\<in> Tr\\<^sub>f n (fs ! n)\n                                   then (butlast fs,\n   Up\\<^sub>f n (fs ! n) e)\n                                   else (butlast fs, fs ! n))) \\<sqsubseteq>\n                      Mprefix\n                       (Tr\\<^sub>f n (fs ! n) \\<union>\n                        (\\<Union>x<n. Tr\\<^sub>f x (fs ! x)))\n                       (\\<lambda>e.\n                           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                   Tr\\<^sub>f n (s ! n) \\<union>\n                                   (\\<Union>x<n.\n Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                            (Up\\<^sub>F fs e))", "proof(rule mono_mprefix_ref, safe, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f n (fs ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)\n 2. \\<And>x xa.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)", "case (1 e)"], ["proof (state)\nthis:\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   ?x\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f n (fs ! n)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f n (fs ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)\n 2. \\<And>x xa.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)", "from 1(6)"], ["proof (chain)\npicking this:\n  e \\<in> Tr\\<^sub>f n (fs ! n)", "have a:\"fork e = n\""], ["proof (prove)\nusing this:\n  e \\<in> Tr\\<^sub>f n (fs ! n)\n\ngoal (1 subgoal):\n 1. fork e = n", "by (auto simp add:fork_transitions_def split:if_splits)"], ["proof (state)\nthis:\n  fork e = n\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f n (fs ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)\n 2. \\<And>x xa.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. X (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n       then (Up\\<^sub>F (butlast fs) e, fs ! n)\n       else if e \\<in> Tr\\<^sub>f n (fs ! n)\n            then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n            else (butlast fs, fs ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n     (Up\\<^sub>F fs e)", "using 1(1)[rule_format, of \"(Up\\<^sub>F fs e)\"]"], ["proof (prove)\nusing this:\n  length (Up\\<^sub>F fs e) = Suc n \\<Longrightarrow>\n  X (butlast (Up\\<^sub>F fs e), Up\\<^sub>F fs e ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   (Up\\<^sub>F fs e)\n\ngoal (1 subgoal):\n 1. X (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n       then (Up\\<^sub>F (butlast fs) e, fs ! n)\n       else if e \\<in> Tr\\<^sub>f n (fs ! n)\n            then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n            else (butlast fs, fs ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n     (Up\\<^sub>F fs e)", "apply (simp add: 1 a butlast_list_update forks_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. X (butlast fs, Up\\<^sub>f n (fs ! n) e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n.\n                Tr\\<^sub>f x\n                 (s !\n                  x)),\\<lambda>s e.\n                         let i = fork e\n                         in s[i := Up\\<^sub>f i (s ! i) e]\\<rbrakk>)\n     (fs[n := Up\\<^sub>f n (fs ! n) e]) \\<Longrightarrow>\n    (\\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)) \\<longrightarrow>\n    X (butlast fs, fs ! n) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n.\n                Tr\\<^sub>f x\n                 (s !\n                  x)),\\<lambda>s e.\n                         let i = fork e\n                         in s[i := Up\\<^sub>f i (s ! i) e]\\<rbrakk>)\n     (fs[n := Up\\<^sub>f n (fs ! n) e])", "using a ev_fork_idx"], ["proof (prove)\nusing this:\n  fork e = n\n  ?e \\<in> Tr\\<^sub>f ?i ?s \\<Longrightarrow> fork ?e = ?i\n\ngoal (1 subgoal):\n 1. X (butlast fs, Up\\<^sub>f n (fs ! n) e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n.\n                Tr\\<^sub>f x\n                 (s !\n                  x)),\\<lambda>s e.\n                         let i = fork e\n                         in s[i := Up\\<^sub>f i (s ! i) e]\\<rbrakk>)\n     (fs[n := Up\\<^sub>f n (fs ! n) e]) \\<Longrightarrow>\n    (\\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)) \\<longrightarrow>\n    X (butlast fs, fs ! n) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n.\n                Tr\\<^sub>f x\n                 (s !\n                  x)),\\<lambda>s e.\n                         let i = fork e\n                         in s[i := Up\\<^sub>f i (s ! i) e]\\<rbrakk>)\n     (fs[n := Up\\<^sub>f n (fs ! n) e])", "by blast"], ["proof (state)\nthis:\n  X (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n     then (Up\\<^sub>F (butlast fs) e, fs ! n)\n     else if e \\<in> Tr\\<^sub>f n (fs ! n)\n          then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n          else (butlast fs, fs ! n)) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   (Up\\<^sub>F fs e)\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)", "case (2 e m)"], ["proof (state)\nthis:\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   ?x\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)", "have a:\"Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)", "apply(simp add:forks_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (let i = fork e in (butlast fs)[i := Up\\<^sub>f i (butlast fs ! i) e]) =\n    butlast (let i = fork e in fs[i := Up\\<^sub>f i (fs ! i) e])", "by (metis butlast_conv_take forks_state_update_def forks_update_take length_list_update)"], ["proof (state)\nthis:\n  Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<And>x.\n                   length x = Suc n \\<Longrightarrow>\n                   X (butlast x, x ! n) \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           Tr\\<^sub>f n (s ! n) \\<union>\n                           (\\<Union>x<n.\n                               Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n                    x;\n        length fs = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x;\n        0 < n; length fs = Suc n; x \\<in> Tr\\<^sub>f xa (fs ! xa);\n        xa < n\\<rbrakk>\n       \\<Longrightarrow> X (if \\<exists>xa\\<in>{..<n}.\n                                  x \\<in> Tr\\<^sub>f xa (fs ! xa)\n                            then (Up\\<^sub>F (butlast fs) x, fs ! n)\n                            else if x \\<in> Tr\\<^sub>f n (fs ! n)\n                                 then (butlast fs, Up\\<^sub>f n (fs ! n) x)\n                                 else (butlast fs, fs ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 Tr\\<^sub>f n (s ! n) \\<union>\n                                 (\\<Union>x<n.\n                                     Tr\\<^sub>f x\n(s ! x)),Up\\<^sub>F\\<rbrakk>)\n                          (Up\\<^sub>F fs x)", "from 2"], ["proof (chain)\npicking this:\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   ?x\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n", "show ?case"], ["proof (prove)\nusing this:\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   ?x\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n\ngoal (1 subgoal):\n 1. X (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n       then (Up\\<^sub>F (butlast fs) e, fs ! n)\n       else if e \\<in> Tr\\<^sub>f n (fs ! n)\n            then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n            else (butlast fs, fs ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n     (Up\\<^sub>F fs e)", "using 2(1)[rule_format, of \"(Up\\<^sub>F fs e)\"] a forks_state_update_def"], ["proof (prove)\nusing this:\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   ?x\n  length fs = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  0 < n\n  length fs = Suc n\n  e \\<in> Tr\\<^sub>f m (fs ! m)\n  m < n\n  length (Up\\<^sub>F fs e) = Suc n \\<Longrightarrow>\n  X (butlast (Up\\<^sub>F fs e), Up\\<^sub>F fs e ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   (Up\\<^sub>F fs e)\n  Up\\<^sub>F (butlast fs) e = butlast (Up\\<^sub>F fs e)\n  Up\\<^sub>F ?fs ?e =\n  (let i = fork ?e in ?fs[i := Up\\<^sub>f i (?fs ! i) ?e])\n\ngoal (1 subgoal):\n 1. X (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n       then (Up\\<^sub>F (butlast fs) e, fs ! n)\n       else if e \\<in> Tr\\<^sub>f n (fs ! n)\n            then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n            else (butlast fs, fs ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            Tr\\<^sub>f n (s ! n) \\<union>\n            (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n     (Up\\<^sub>F fs e)", "by auto"], ["proof (state)\nthis:\n  X (if \\<exists>x\\<in>{..<n}. e \\<in> Tr\\<^sub>f x (fs ! x)\n     then (Up\\<^sub>F (butlast fs) e, fs ! n)\n     else if e \\<in> Tr\\<^sub>f n (fs ! n)\n          then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n          else (butlast fs, fs ! n)) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          Tr\\<^sub>f n (s ! n) \\<union>\n          (\\<Union>x<n. Tr\\<^sub>f x (s ! x)),Up\\<^sub>F\\<rbrakk>)\n   (Up\\<^sub>F fs e)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Mprefix (Tr\\<^sub>F n (butlast fs) \\<union> Tr\\<^sub>f n (fs ! n))\n   (\\<lambda>e.\n       X (if e \\<in> Tr\\<^sub>F n (butlast fs)\n          then (Up\\<^sub>F (butlast fs) e, fs ! n)\n          else if e \\<in> Tr\\<^sub>f n (fs ! n)\n               then (butlast fs, Up\\<^sub>f n (fs ! n) e)\n               else (butlast fs, fs ! n))) \\<sqsubseteq>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>0 < n; length fs = Suc n\\<rbrakk>\n  \\<Longrightarrow> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                      (butlast\n                        fs)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                               (fs ! n)) \\<sqsubseteq>\n                    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) fs\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ft: \"0 < n \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) = foldFORKs n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < n \\<Longrightarrow>\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n    fold (\\<lambda>i P. P|||FORK i) [1..<n] (FORK 0)", "proof (induct n, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>0 < n \\<Longrightarrow>\n                FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n                fold (\\<lambda>i P. P|||FORK i) [1..<n] (FORK 0);\n        0 < Suc n\\<rbrakk>\n       \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n)\n                          (replicate (Suc n) 0) =\n                         fold (\\<lambda>i P. P|||FORK i) [1..<Suc n]\n                          (FORK 0)", "case (Suc n)"], ["proof (state)\nthis:\n  0 < n \\<Longrightarrow>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n  fold (\\<lambda>i P. P|||FORK i) [1..<n] (FORK 0)\n  0 < Suc n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>0 < n \\<Longrightarrow>\n                FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n                fold (\\<lambda>i P. P|||FORK i) [1..<n] (FORK 0);\n        0 < Suc n\\<rbrakk>\n       \\<Longrightarrow> FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n)\n                          (replicate (Suc n) 0) =\n                         fold (\\<lambda>i P. P|||FORK i) [1..<Suc n]\n                          (FORK 0)", "then"], ["proof (chain)\npicking this:\n  0 < n \\<Longrightarrow>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n  fold (\\<lambda>i P. P|||FORK i) [1..<n] (FORK 0)\n  0 < Suc n", "show ?case"], ["proof (prove)\nusing this:\n  0 < n \\<Longrightarrow>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n  fold (\\<lambda>i P. P|||FORK i) [1..<n] (FORK 0)\n  0 < Suc n\n\ngoal (1 subgoal):\n 1. FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (replicate (Suc n) 0) =\n    fold (\\<lambda>i P. P|||FORK i) [1..<Suc n] (FORK 0)", "apply (auto simp add: FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_unfold FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_FORK)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n             fold\n              (\\<lambda>i P. P|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n              [Suc 0..<n] (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 0);\n     Suc 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (0 #\n                         butlast\n                          (replicate n\n                            0))|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   0) =\n                      (fold\n                        (\\<lambda>i P.\n                            P|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n                        [Suc 0..<n]\n                        (FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n                          0)|||FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n 0)\n 2. \\<not> Suc 0 \\<le> n \\<Longrightarrow>\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (0 # replicate n 0) =\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 0", "apply (metis Suc_le_D butlast_snoc replicate_Suc replicate_append_same)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> Suc 0 \\<le> n \\<Longrightarrow>\n    FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (0 # replicate n 0) =\n    FORK\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 0", "by (metis FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1 One_nat_def leI length_replicate less_Suc0 nth_replicate replicate_Suc)"], ["proof (state)\nthis:\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (replicate (Suc n) 0) =\n  fold (\\<lambda>i P. P|||FORK i) [1..<Suc n] (FORK 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary FORKs_is_FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) = FORKs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) =\n    fold (\\<lambda>i P. P|||FORK i) [1..<N] (FORK 0)", "using ft N_pos"], ["proof (prove)\nusing this:\n  0 < ?n \\<Longrightarrow>\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?n (replicate ?n 0) =\n  fold (\\<lambda>i P. P|||FORK i) [1..<?n] (FORK 0)\n  0 < N\n\ngoal (1 subgoal):\n 1. FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) =\n    fold (\\<lambda>i P. P|||FORK i) [1..<N] (FORK 0)", "by simp"], ["", "text \\<open>The one-philosopher process in normal form:\\<close>"], ["", "type_synonym phil_id = nat"], ["", "type_synonym phil_state = nat"], ["", "definition rphil_transitions:: \"phil_id \\<Rightarrow> phil_state \\<Rightarrow> dining_event set\" (\"Tr\\<^sub>r\\<^sub>p\")\n  where \"Tr\\<^sub>r\\<^sub>p i s = ( if      s = 0  then {picks i i}\n                     else if s = 1  then {picks i (i-1)}\n                     else if s = 2  then {putsdown i (i-1)}\n                     else if s = 3  then {putsdown i i}\n                     else                {})\""], ["", "definition lphil0_transitions:: \"phil_state \\<Rightarrow> dining_event set\" (\"Tr\\<^sub>l\\<^sub>p\")\n    where \"Tr\\<^sub>l\\<^sub>p s = ( if s = 0       then {picks 0 (N-1)}\n                     else if s = 1  then {picks 0 0}\n                     else if s = 2  then {putsdown 0 0}\n                     else if s = 3  then {putsdown 0 (N-1)}\n                     else                {})\""], ["", "corollary rphil_phil: \"e \\<in> Tr\\<^sub>r\\<^sub>p i s \\<Longrightarrow> phil e = i\"\n      and lphil0_phil: \"e \\<in> Tr\\<^sub>l\\<^sub>p s \\<Longrightarrow> phil e = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (e \\<in> Tr\\<^sub>r\\<^sub>p i s \\<Longrightarrow> phil e = i) &&&\n    (e \\<in> Tr\\<^sub>l\\<^sub>p s \\<Longrightarrow> phil e = 0)", "by (simp_all add:rphil_transitions_def lphil0_transitions_def split:if_splits)"], ["", "definition rphil_state_update:: \"fork_id \\<Rightarrow> fork_state \\<Rightarrow> dining_event \\<Rightarrow> fork_state\" (\"Up\\<^sub>r\\<^sub>p\")\n  where \"Up\\<^sub>r\\<^sub>p i s e = ( if e = (picks i i)               then 1\n                       else if e = (picks i (i-1))      then 2\n                       else if e = (putsdown i (i-1))   then 3\n                       else                                  0 )\""], ["", "definition lphil0_state_update:: \"fork_state \\<Rightarrow> dining_event \\<Rightarrow> fork_state\" (\"Up\\<^sub>l\\<^sub>p\")\n  where \"Up\\<^sub>l\\<^sub>p s e = ( if e = (picks 0 (N-1))         then 1\n                     else if e = (picks 0 0)        then 2\n                     else if e = (putsdown 0 0)     then 3\n                     else                                0 )\""], ["", "definition RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:: \"fork_id \\<Rightarrow> fork_state \\<Rightarrow> dining_event process\"\n  where \"RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i = P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>r\\<^sub>p i,Up\\<^sub>r\\<^sub>p i\\<rbrakk>\""], ["", "definition LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:: \"fork_state \\<Rightarrow> dining_event process\"\n  where \"LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m = P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>l\\<^sub>p,Up\\<^sub>l\\<^sub>p\\<rbrakk>\""], ["", "lemma RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>r\\<^sub>p i s) \\<rightarrow> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Up\\<^sub>r\\<^sub>p i s e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n         (\\<lambda>e.\n             RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n              (Up\\<^sub>r\\<^sub>p i s e)))", "using fix_eq[of \"\\<Lambda> X. (\\<lambda>s. Mprefix (Tr\\<^sub>r\\<^sub>p i s) (\\<lambda>e. X (Up\\<^sub>r\\<^sub>p i s e)))\"] RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>r\\<^sub>p\n       i,Up\\<^sub>r\\<^sub>p i\\<rbrakk> =\n  (\\<Lambda> X.\n      (\\<lambda>s.\n          Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n           (\\<lambda>e. X (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>r\\<^sub>p\n        i,Up\\<^sub>r\\<^sub>p i\\<rbrakk>)\n  RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?i =\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>r\\<^sub>p\n       ?i,Up\\<^sub>r\\<^sub>p ?i\\<rbrakk>\n\ngoal (1 subgoal):\n 1. RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n         (\\<lambda>e.\n             RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n              (Up\\<^sub>r\\<^sub>p i s e)))", "by simp"], ["", "lemma LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>l\\<^sub>p s) \\<rightarrow> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Up\\<^sub>l\\<^sub>p s e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>l\\<^sub>p s)\n         (\\<lambda>e.\n             LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n              (Up\\<^sub>l\\<^sub>p s e)))", "using fix_eq[of \"\\<Lambda> X. (\\<lambda>s. Mprefix (Tr\\<^sub>l\\<^sub>p s) (\\<lambda>e. X (Up\\<^sub>l\\<^sub>p s e)))\"] LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>l\\<^sub>p,Up\\<^sub>l\\<^sub>p\\<rbrakk> =\n  (\\<Lambda> X.\n      (\\<lambda>s.\n          Mprefix (Tr\\<^sub>l\\<^sub>p s)\n           (\\<lambda>e. X (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>l\\<^sub>p,Up\\<^sub>l\\<^sub>p\\<rbrakk>)\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m =\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>l\\<^sub>p,Up\\<^sub>l\\<^sub>p\\<rbrakk>\n\ngoal (1 subgoal):\n 1. LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>l\\<^sub>p s)\n         (\\<lambda>e.\n             LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n              (Up\\<^sub>l\\<^sub>p s e)))", "by simp"], ["", "lemma RPHIL_refines_RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:\n  assumes i_pos: \"i > 0\"\n  shows \"RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<sqsubseteq> RPHIL i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<sqsubseteq> RPHIL i", "proof(unfold RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n      induct rule:fix_ind_k_skip[where k=4\n                                 and f=\"\\<Lambda> x. (\\<lambda>s. Mprefix (Tr\\<^sub>r\\<^sub>p i s) (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e)))\"])"], ["proof (state)\ngoal (4 subgoals):\n 1. 1 \\<le> 4\n 2. adm (\\<lambda>a. a 0 \\<sqsubseteq> RPHIL i)\n 3. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i\n 4. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "show \"(1::nat) \\<le> 4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> 4", "by simp"], ["proof (state)\nthis:\n  1 \\<le> 4\n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a. a 0 \\<sqsubseteq> RPHIL i)\n 2. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i\n 3. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a. a 0 \\<sqsubseteq> RPHIL i)\n 2. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i\n 3. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "show \"adm (\\<lambda>a. a 0 \\<sqsubseteq> RPHIL i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a. a (0::'a) \\<sqsubseteq> RPHIL i)", "by (simp add: cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a. a (0::?'a1) \\<sqsubseteq> RPHIL i)\n\ngoal (2 subgoals):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "case base_k_steps:3"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "show ?case (is \"\\<forall>j<4. (iterate j\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> RPHIL i\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "have less_2:\"\\<And>j. (j::nat) < 4 = (j = 0 \\<or> j = 1  \\<or> j = 2  \\<or> j = 3)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j. (j < 4) = (j = 0 \\<or> j = 1 \\<or> j = 2 \\<or> j = 3)", "by linarith"], ["proof (state)\nthis:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "moreover"], ["proof (state)\nthis:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "have \"(iterate 0\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> RPHIL i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 0\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n              (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    RPHIL i", "by simp"], ["proof (state)\nthis:\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "moreover"], ["proof (state)\nthis:\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "have \"(iterate 1\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> RPHIL i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n              (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    RPHIL i", "by (subst RPHIL_rec)\n         (simp add: write0_def rphil_transitions_def mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "moreover"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "have \"(iterate 2\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> RPHIL i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 2\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n              (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    RPHIL i", "by (subst RPHIL_rec)\n         (simp add: numeral_2_eq_2 write0_def rphil_transitions_def\n                    rphil_state_update_def mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "moreover"], ["proof (state)\nthis:\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "have \"(iterate 3\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> RPHIL i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 3\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n              (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    RPHIL i", "by (subst RPHIL_rec)\n         (simp add: numeral_3_eq_3 write0_def rphil_transitions_def\n                    rphil_state_update_def mono_mprefix_ref minus_suc[OF i_pos])"], ["proof (state)\nthis:\n  (iterate 3\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "ultimately"], ["proof (chain)\npicking this:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n  (iterate 3\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i", "show ?thesis"], ["proof (prove)\nusing this:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n  (iterate 3\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal (1 subgoal):\n 1. \\<forall>ia<4.\n       (iterate ia\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       RPHIL i", "by simp"], ["proof (state)\nthis:\n  \\<forall>ia<4.\n     (iterate ia\\<cdot>\n      (\\<Lambda> x.\n          (\\<lambda>s.\n              Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n               (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n      \\<bottom>)\n      0 \\<sqsubseteq>\n     RPHIL i\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>ia<4.\n     (iterate ia\\<cdot>\n      (\\<Lambda> x.\n          (\\<lambda>s.\n              Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n               (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n      \\<bottom>)\n      0 \\<sqsubseteq>\n     RPHIL i\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "case step:(4 x)"], ["proof (state)\nthis:\n  x 0 \\<sqsubseteq> RPHIL i\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n                 (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       RPHIL i", "then"], ["proof (chain)\npicking this:\n  x 0 \\<sqsubseteq> RPHIL i", "show ?case (is \"(iterate 4\\<cdot>?f\\<cdot>x) 0 \\<sqsubseteq> RPHIL i\")"], ["proof (prove)\nusing this:\n  x 0 \\<sqsubseteq> RPHIL i\n\ngoal (1 subgoal):\n 1. (iterate 4\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n              (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n     x)\n     0 \\<sqsubseteq>\n    RPHIL i", "apply (subst RPHIL_rec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n    (iterate 4\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n              (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n     x)\n     0 \\<sqsubseteq>\n    (picks i i \n        \\<rightarrow> picks i (i - 1) \n                         \\<rightarrow> putsdown i (i - 1) \n    \\<rightarrow> putsdown i i \\<rightarrow> RPHIL i)", "apply (simp add: write0_def numeral_4_eq_4 rphil_transitions_def rphil_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x 0 \\<sqsubseteq> RPHIL i \\<Longrightarrow>\n    Mprefix {picks i i}\n     (\\<lambda>e.\n         Mprefix\n          (if (if e = picks i i then 1\n               else if e = picks i (i - 1) then 2\n                    else if e = putsdown i (i - 1) then 3 else 0) =\n              0\n           then {picks i i}\n           else if (if e = picks i i then 1\n                    else if e = picks i (i - 1) then 2\n                         else if e = putsdown i (i - 1) then 3 else 0) =\n                   1\n                then {picks i (i - 1)}\n                else if (if e = picks i i then 1\n                         else if e = picks i (i - 1) then 2\n                              else if e = putsdown i (i - 1) then 3\n                                   else 0) =\n                        2\n                     then {putsdown i (i - 1)}\n                     else if (if e = picks i i then 1\n                              else if e = picks i (i - 1) then 2\n                                   else if e = putsdown i (i - 1) then 3\n  else 0) =\n                             3\n                          then {putsdown i i} else {})\n          (\\<lambda>e.\n              Mprefix\n               (if (if e = picks i i then 1\n                    else if e = picks i (i - 1) then 2\n                         else if e = putsdown i (i - 1) then 3 else 0) =\n                   0\n                then {picks i i}\n                else if (if e = picks i i then 1\n                         else if e = picks i (i - 1) then 2\n                              else if e = putsdown i (i - 1) then 3\n                                   else 0) =\n                        1\n                     then {picks i (i - 1)}\n                     else if (if e = picks i i then 1\n                              else if e = picks i (i - 1) then 2\n                                   else if e = putsdown i (i - 1) then 3\n  else 0) =\n                             2\n                          then {putsdown i (i - 1)}\n                          else if (if e = picks i i then 1\n                                   else if e = picks i (i - 1) then 2\n  else if e = putsdown i (i - 1) then 3 else 0) =\n                                  3\n                               then {putsdown i i} else {})\n               (\\<lambda>e.\n                   Mprefix\n                    (if (if e = picks i i then 1\n                         else if e = picks i (i - 1) then 2\n                              else if e = putsdown i (i - 1) then 3\n                                   else 0) =\n                        0\n                     then {picks i i}\n                     else if (if e = picks i i then 1\n                              else if e = picks i (i - 1) then 2\n                                   else if e = putsdown i (i - 1) then 3\n  else 0) =\n                             1\n                          then {picks i (i - 1)}\n                          else if (if e = picks i i then 1\n                                   else if e = picks i (i - 1) then 2\n  else if e = putsdown i (i - 1) then 3 else 0) =\n                                  2\n                               then {putsdown i (i - 1)}\n                               else if (if e = picks i i then 1\n  else if e = picks i (i - 1) then 2\n       else if e = putsdown i (i - 1) then 3 else 0) =\n 3\n                                    then {putsdown i i} else {})\n                    (\\<lambda>e.\n                        x (if e = picks i i then 1\n                           else if e = picks i (i - 1) then 2\n                                else if e = putsdown i (i - 1) then 3\n                                     else 0))))) \\<sqsubseteq>\n    Mprefix {picks i i}\n     (\\<lambda>x.\n         Mprefix {picks i (i - Suc 0)}\n          (\\<lambda>x.\n              Mprefix {putsdown i (i - Suc 0)}\n               (\\<lambda>x. Mprefix {putsdown i i} (\\<lambda>x. RPHIL i))))", "apply (rule mono_mprefix_ref, auto simp:minus_suc[OF i_pos])+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x 0 \\<sqsubseteq> RPHIL i; i = i - Suc 0\\<rbrakk>\n    \\<Longrightarrow> x 3 \\<sqsubseteq> RPHIL i", "using minus_suc[OF i_pos]"], ["proof (prove)\nusing this:\n  i - Suc 0 \\<noteq> i\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x 0 \\<sqsubseteq> RPHIL i; i = i - Suc 0\\<rbrakk>\n    \\<Longrightarrow> x 3 \\<sqsubseteq> RPHIL i", "by auto"], ["proof (state)\nthis:\n  (iterate 4\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>r\\<^sub>p i s)\n            (\\<lambda>e. x (Up\\<^sub>r\\<^sub>p i s e))))\\<cdot>\n   x)\n   0 \\<sqsubseteq>\n  RPHIL i\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma LPHIL0_refines_LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<sqsubseteq> LPHIL0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<sqsubseteq> LPHIL0", "proof(unfold LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n      induct rule:fix_ind_k_skip[where k=4 and f=\"\\<Lambda> x. (\\<lambda>s. Mprefix (Tr\\<^sub>l\\<^sub>p s) (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e)))\"])"], ["proof (state)\ngoal (4 subgoals):\n 1. 1 \\<le> 4\n 2. adm (\\<lambda>a. a 0 \\<sqsubseteq> LPHIL0)\n 3. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0\n 4. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "show \"(1::nat) \\<le> 4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> 4", "by simp"], ["proof (state)\nthis:\n  1 \\<le> 4\n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a. a 0 \\<sqsubseteq> LPHIL0)\n 2. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0\n 3. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a. a 0 \\<sqsubseteq> LPHIL0)\n 2. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0\n 3. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "show \"adm (\\<lambda>a. a 0 \\<sqsubseteq> LPHIL0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a. a (0::'a) \\<sqsubseteq> LPHIL0)", "by (simp add: cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a. a (0::?'a1) \\<sqsubseteq> LPHIL0)\n\ngoal (2 subgoals):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "case base_k_steps:3"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0\n 2. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "show ?case (is \"\\<forall>j<4. (iterate j\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> LPHIL0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "have less_2:\"\\<And>j. (j::nat) < 4 = (j = 0 \\<or> j = 1  \\<or> j = 2  \\<or> j = 3)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j. (j < 4) = (j = 0 \\<or> j = 1 \\<or> j = 2 \\<or> j = 3)", "by linarith"], ["proof (state)\nthis:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "moreover"], ["proof (state)\nthis:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "have \"(iterate 0\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> LPHIL0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 0\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>l\\<^sub>p s)\n              (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    LPHIL0", "by simp"], ["proof (state)\nthis:\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "moreover"], ["proof (state)\nthis:\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "have \"(iterate 1\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> LPHIL0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>l\\<^sub>p s)\n              (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    LPHIL0", "by (subst LPHIL0_rec)\n         (simp add: write0_def lphil0_transitions_def mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "moreover"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "have \"(iterate 2\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> LPHIL0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 2\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>l\\<^sub>p s)\n              (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    LPHIL0", "by (subst LPHIL0_rec)\n         (simp add: numeral_2_eq_2 write0_def lphil0_transitions_def\n                    lphil0_state_update_def mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "moreover"], ["proof (state)\nthis:\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "have \"(iterate 3\\<cdot>?f\\<cdot>\\<bottom>) 0 \\<sqsubseteq> LPHIL0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (iterate 3\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>l\\<^sub>p s)\n              (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n     \\<bottom>)\n     0 \\<sqsubseteq>\n    LPHIL0", "by (subst LPHIL0_rec)\n         (simp add: numeral_3_eq_3 write0_def lphil0_transitions_def\n                    lphil0_state_update_def mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 3\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "ultimately"], ["proof (chain)\npicking this:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n  (iterate 3\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0", "show ?thesis"], ["proof (prove)\nusing this:\n  (?j < 4) = (?j = 0 \\<or> ?j = 1 \\<or> ?j = 2 \\<or> ?j = 3)\n  (iterate 0\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n  (iterate 2\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n  (iterate 3\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   \\<bottom>)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal (1 subgoal):\n 1. \\<forall>i<4.\n       (iterate i\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        \\<bottom>)\n        0 \\<sqsubseteq>\n       LPHIL0", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<4.\n     (iterate i\\<cdot>\n      (\\<Lambda> x.\n          (\\<lambda>s.\n              Mprefix (Tr\\<^sub>l\\<^sub>p s)\n               (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n      \\<bottom>)\n      0 \\<sqsubseteq>\n     LPHIL0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>i<4.\n     (iterate i\\<cdot>\n      (\\<Lambda> x.\n          (\\<lambda>s.\n              Mprefix (Tr\\<^sub>l\\<^sub>p s)\n               (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n      \\<bottom>)\n      0 \\<sqsubseteq>\n     LPHIL0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "case step:(4 x)"], ["proof (state)\nthis:\n  x 0 \\<sqsubseteq> LPHIL0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x 0 \\<sqsubseteq> LPHIL0 \\<Longrightarrow>\n       (iterate 4\\<cdot>\n        (\\<Lambda> x.\n            (\\<lambda>s.\n                Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                 (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n        x)\n        0 \\<sqsubseteq>\n       LPHIL0", "then"], ["proof (chain)\npicking this:\n  x 0 \\<sqsubseteq> LPHIL0", "show ?case (is \"(iterate 4\\<cdot>?f\\<cdot>x) 0 \\<sqsubseteq> LPHIL0\")"], ["proof (prove)\nusing this:\n  x 0 \\<sqsubseteq> LPHIL0\n\ngoal (1 subgoal):\n 1. (iterate 4\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>l\\<^sub>p s)\n              (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n     x)\n     0 \\<sqsubseteq>\n    LPHIL0", "by (subst LPHIL0_rec)\n       (simp add: write0_def numeral_4_eq_4 lphil0_transitions_def\n                  lphil0_state_update_def mono_mprefix_ref)"], ["proof (state)\nthis:\n  (iterate 4\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   x)\n   0 \\<sqsubseteq>\n  LPHIL0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_RPHIL:\n  assumes i_pos: \"i > 0\"\n  shows \"RPHIL i \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. RPHIL i \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "proof(unfold RPHIL_def,\n      induct rule:fix_ind_k_skip[where k=1])"], ["proof (state)\ngoal (4 subgoals):\n 1. 1 \\<le> 1\n 2. adm (\\<lambda>a.\n            a \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n 3. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 4. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show \"(1::nat) \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> 1", "by simp"], ["proof (state)\nthis:\n  1 \\<le> 1\n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n 2. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 3. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n 2. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 3. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show \"adm (\\<lambda>a. a \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)", "by simp"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          a \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0)\n\ngoal (2 subgoals):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "case base_k_steps:3"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>ia<1.\n       iterate ia\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "by simp"], ["proof (state)\nthis:\n  \\<forall>ia<1.\n     iterate ia\\<cdot>\n     (\\<Lambda> x.\n         picks i i \n            \\<rightarrow> picks i (i - 1) \n                             \\<rightarrow> putsdown i (i - 1) \n        \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n     \\<bottom> \\<sqsubseteq>\n     RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "case step:(4 x)"], ["proof (state)\nthis:\n  x \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks i i \n              \\<rightarrow> picks i (i - 1) \n                               \\<rightarrow> putsdown i (i - 1) \n          \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "then"], ["proof (chain)\npicking this:\n  x \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "show ?case"], ["proof (prove)\nusing this:\n  x \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal (1 subgoal):\n 1. iterate 1\\<cdot>\n    (\\<Lambda> x.\n        picks i i \n           \\<rightarrow> picks i (i - 1) \n                            \\<rightarrow> putsdown i (i - 1) \n       \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n    x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "apply (subst RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def rphil_transitions_def rphil_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    Mprefix {picks i i}\n     (\\<lambda>xa.\n         Mprefix {picks i (i - Suc 0)}\n          (\\<lambda>xa.\n              Mprefix {putsdown i (i - Suc 0)}\n               (\\<lambda>xa.\n                   Mprefix {putsdown i i} (\\<lambda>xa. x)))) \\<sqsubseteq>\n    Mprefix {picks i i}\n     (\\<lambda>e.\n         RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n          (if e = picks i i then 1\n           else if e = picks i (i - 1) then 2\n                else if e = putsdown i (i - 1) then 3 else 0))", "apply (rule mono_mprefix_ref, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    Mprefix {picks i (i - Suc 0)}\n     (\\<lambda>xa.\n         Mprefix {putsdown i (i - Suc 0)}\n          (\\<lambda>xa.\n              Mprefix {putsdown i i} (\\<lambda>xa. x))) \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i (Suc 0)", "apply (subst RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def rphil_transitions_def rphil_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    Mprefix {picks i (i - Suc 0)}\n     (\\<lambda>xa.\n         Mprefix {putsdown i (i - Suc 0)}\n          (\\<lambda>xa.\n              Mprefix {putsdown i i} (\\<lambda>xa. x))) \\<sqsubseteq>\n    Mprefix {picks i (i - Suc 0)}\n     (\\<lambda>e.\n         RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n          (if e = picks i i then 1\n           else if e = picks i (i - 1) then 2\n                else if e = putsdown i (i - 1) then 3 else 0))", "apply (rule mono_mprefix_ref, simp add:minus_suc[OF i_pos])"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    Mprefix {putsdown i (i - Suc 0)}\n     (\\<lambda>xa. Mprefix {putsdown i i} (\\<lambda>xa. x)) \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 2", "apply (subst RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def rphil_transitions_def rphil_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    Mprefix {putsdown i (i - Suc 0)}\n     (\\<lambda>xa. Mprefix {putsdown i i} (\\<lambda>xa. x)) \\<sqsubseteq>\n    Mprefix {putsdown i (i - Suc 0)}\n     (\\<lambda>e.\n         RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n          (if e = picks i i then 1\n           else if e = picks i (i - 1) then 2\n                else if e = putsdown i (i - 1) then 3 else 0))", "apply (rule mono_mprefix_ref, simp add:minus_suc[OF i_pos])"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    Mprefix {putsdown i i} (\\<lambda>xa. x) \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 3", "apply (subst RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def rphil_transitions_def rphil_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    Mprefix {putsdown i i} (\\<lambda>xa. x) \\<sqsubseteq>\n    Mprefix {putsdown i i}\n     (\\<lambda>e.\n         RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i\n          (if e = picks i i then 1\n           else if e = picks i (i - 1) then 2\n                else if e = putsdown i (i - 1) then 3 else 0))", "apply (rule mono_mprefix_ref, simp add:minus_suc[OF i_pos])"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    i = i - Suc 0 \\<longrightarrow>\n    x \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 3", "using minus_suc[OF i_pos]"], ["proof (prove)\nusing this:\n  i - Suc 0 \\<noteq> i\n\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0 \\<Longrightarrow>\n    i = i - Suc 0 \\<longrightarrow>\n    x \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 3", "by auto"], ["proof (state)\nthis:\n  iterate 1\\<cdot>\n  (\\<Lambda> x.\n      picks i i \n         \\<rightarrow> picks i (i - 1) \n                          \\<rightarrow> putsdown i (i - 1) \n     \\<rightarrow> putsdown i i \\<rightarrow> x)\\<cdot>\n  x \\<sqsubseteq>\n  RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_LPHIL0: \"LPHIL0 \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LPHIL0 \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "proof(unfold LPHIL0_def,\n      induct rule:fix_ind_k_skip[where k=1])"], ["proof (state)\ngoal (4 subgoals):\n 1. 1 \\<le> 1\n 2. adm (\\<lambda>a.\n            a \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0)\n 3. \\<forall>i<1.\n       iterate i\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n 4. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "show \"(1::nat) \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> 1", "by simp"], ["proof (state)\nthis:\n  1 \\<le> 1\n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0)\n 2. \\<forall>i<1.\n       iterate i\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n 3. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0)\n 2. \\<forall>i<1.\n       iterate i\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n 3. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "show \"adm (\\<lambda>a. a \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            a \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0)", "by simp"], ["proof (state)\nthis:\n  adm (\\<lambda>a. a \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0)\n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       iterate i\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       iterate i\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "case base_k_steps:3"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       iterate i\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n 2. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<1.\n       iterate i\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       \\<bottom> \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     iterate i\\<cdot>\n     (\\<Lambda> x.\n         picks 0 (N - 1) \n            \\<rightarrow> picks 0 0 \n                             \\<rightarrow> putsdown 0 0 \n        \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n     \\<bottom> \\<sqsubseteq>\n     LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "case step:(4 x)"], ["proof (state)\nthis:\n  x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n       iterate 1\\<cdot>\n       (\\<Lambda> x.\n           picks 0 (N - 1) \n              \\<rightarrow> picks 0 0 \n                               \\<rightarrow> putsdown 0 0 \n          \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n       x \\<sqsubseteq>\n       LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "then"], ["proof (chain)\npicking this:\n  x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "show ?case (is \"iterate 1\\<cdot>?f\\<cdot>x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\")"], ["proof (prove)\nusing this:\n  x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n\ngoal (1 subgoal):\n 1. iterate 1\\<cdot>\n    (\\<Lambda> x.\n        picks 0 (N - 1) \n           \\<rightarrow> picks 0 0 \n                            \\<rightarrow> putsdown 0 0 \n       \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n    x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "apply (subst LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def lphil0_transitions_def lphil0_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n    Mprefix {picks 0 (N - Suc 0)}\n     (\\<lambda>xa.\n         Mprefix {picks 0 0}\n          (\\<lambda>xa.\n              Mprefix {putsdown 0 0}\n               (\\<lambda>xa.\n                   Mprefix {putsdown 0 (N - Suc 0)}\n                    (\\<lambda>xa. x)))) \\<sqsubseteq>\n    Mprefix {picks 0 (N - Suc 0)}\n     (\\<lambda>e.\n         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n          (if e = picks 0 (N - Suc 0) then 1\n           else if e = picks 0 0 then 2\n                else if e = putsdown 0 0 then 3 else 0))", "apply (rule mono_mprefix_ref, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n    Mprefix {picks 0 0}\n     (\\<lambda>xa.\n         Mprefix {putsdown 0 0}\n          (\\<lambda>xa.\n              Mprefix {putsdown 0 (N - Suc 0)}\n               (\\<lambda>xa. x))) \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)", "apply (subst LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def lphil0_transitions_def lphil0_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n    Mprefix {picks 0 0}\n     (\\<lambda>xa.\n         Mprefix {putsdown 0 0}\n          (\\<lambda>xa.\n              Mprefix {putsdown 0 (N - Suc 0)}\n               (\\<lambda>xa. x))) \\<sqsubseteq>\n    Mprefix {picks 0 0}\n     (\\<lambda>e.\n         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n          (if e = picks 0 (N - Suc 0) then 1\n           else if e = picks 0 0 then 2\n                else if e = putsdown 0 0 then 3 else 0))", "apply (rule mono_mprefix_ref, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n    Mprefix {putsdown 0 0}\n     (\\<lambda>xa.\n         Mprefix {putsdown 0 (N - Suc 0)} (\\<lambda>xa. x)) \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 2", "apply (subst LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def lphil0_transitions_def lphil0_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n    Mprefix {putsdown 0 0}\n     (\\<lambda>xa.\n         Mprefix {putsdown 0 (N - Suc 0)} (\\<lambda>xa. x)) \\<sqsubseteq>\n    Mprefix {putsdown 0 0}\n     (\\<lambda>e.\n         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n          (if e = picks 0 (N - Suc 0) then 1\n           else if e = picks 0 0 then 2\n                else if e = putsdown 0 0 then 3 else 0))", "apply (rule mono_mprefix_ref, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n    Mprefix {putsdown 0 (N - Suc 0)} (\\<lambda>xa. x) \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 3", "apply (subst LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add: write0_def lphil0_transitions_def lphil0_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<Longrightarrow>\n    Mprefix {putsdown 0 (N - Suc 0)} (\\<lambda>xa. x) \\<sqsubseteq>\n    Mprefix {putsdown 0 (N - Suc 0)}\n     (\\<lambda>e.\n         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n          (if e = picks 0 (N - Suc 0) then 1\n           else if e = picks 0 0 then 2\n                else if e = putsdown 0 0 then 3 else 0))", "apply (rule mono_mprefix_ref, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  iterate 1\\<cdot>\n  (\\<Lambda> x.\n      picks 0 (N - 1) \n         \\<rightarrow> picks 0 0 \n                          \\<rightarrow> putsdown 0 0 \n     \\<rightarrow> putsdown 0 (N - 1) \\<rightarrow> x)\\<cdot>\n  x \\<sqsubseteq>\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_RPHIL: \"i > 0 \\<Longrightarrow> RPHIL i = RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < i \\<Longrightarrow>\n    RPHIL i = RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "using RPHIL_refines_RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_RPHIL below_antisym"], ["proof (prove)\nusing this:\n  0 < ?i \\<Longrightarrow>\n  RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?i 0 \\<sqsubseteq> RPHIL ?i\n  0 < ?i \\<Longrightarrow>\n  RPHIL ?i \\<sqsubseteq> RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?i 0\n  \\<lbrakk>?x \\<sqsubseteq> ?y; ?y \\<sqsubseteq> ?x\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (1 subgoal):\n 1. 0 < i \\<Longrightarrow>\n    RPHIL i = RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m i 0", "by blast"], ["", "lemma LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_LPHIL0: \"LPHIL0 = LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. LPHIL0 = LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "using LPHIL0_refines_LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_refines_LPHIL0 below_antisym"], ["proof (prove)\nusing this:\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0 \\<sqsubseteq> LPHIL0\n  LPHIL0 \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0\n  \\<lbrakk>?x \\<sqsubseteq> ?y; ?y \\<sqsubseteq> ?x\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (1 subgoal):\n 1. LPHIL0 = LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "by blast"], ["", "subsection \\<open>The normal form for the global philosopher network\\<close>"], ["", "type_synonym phils_state = \"nat list\""], ["", "definition phils_transitions:: \"nat \\<Rightarrow> phils_state \\<Rightarrow> dining_event set\" (\"Tr\\<^sub>P\")\n  where \"Tr\\<^sub>P n ps = Tr\\<^sub>l\\<^sub>p (ps!0) \\<union> (\\<Union>i\\<in>{1..< n}. Tr\\<^sub>r\\<^sub>p i (ps!i))\""], ["", "corollary phils_phil: \"0 < n \\<Longrightarrow> e \\<in> Tr\\<^sub>P n s \\<Longrightarrow> phil e < n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; e \\<in> Tr\\<^sub>P n s\\<rbrakk>\n    \\<Longrightarrow> phil e < n", "by (auto simp add:phils_transitions_def lphil0_phil rphil_phil)"], ["", "lemma phils_transitions_take: \"0 < n \\<Longrightarrow> Tr\\<^sub>P n ps = Tr\\<^sub>P n (take n ps)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < n \\<Longrightarrow> Tr\\<^sub>P n ps = Tr\\<^sub>P n (take n ps)", "by (auto simp add:phils_transitions_def)"], ["", "definition phils_state_update:: \"phils_state \\<Rightarrow> dining_event \\<Rightarrow> phils_state\" (\"Up\\<^sub>P\")\n  where \"Up\\<^sub>P ps e = (let i=(phil e) in if i = 0 then ps[i:=(Up\\<^sub>l\\<^sub>p (ps!i) e)]\n                                       else          ps[i:=(Up\\<^sub>r\\<^sub>p i (ps!i) e)])\""], ["", "lemma phils_update_take: \"take n (Up\\<^sub>P ps e) = Up\\<^sub>P (take n ps) e\""], ["proof (prove)\ngoal (1 subgoal):\n 1. take n (Up\\<^sub>P ps e) = Up\\<^sub>P (take n ps) e", "by (cases e) (simp_all add: phils_state_update_def lphil0_state_update_def\n                              rphil_state_update_def take_update_swap)"], ["", "definition PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:: \"nat \\<Rightarrow> phils_state \\<Rightarrow> dining_event process\"\n  where \"PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P n,Up\\<^sub>P\\<rbrakk>\""], ["", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec:  \"PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = (\\<lambda> ps. \\<box> e \\<in> (Tr\\<^sub>P n ps) \\<rightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>P ps e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n =\n    (\\<lambda>ps.\n        Mprefix (Tr\\<^sub>P n ps)\n         (\\<lambda>e.\n             PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>P ps e)))", "using fix_eq[of \"\\<Lambda> X. (\\<lambda>ps. Mprefix (Tr\\<^sub>P n ps) (\\<lambda>e. X (Up\\<^sub>P ps e)))\"] PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n       n,Up\\<^sub>P\\<rbrakk> =\n  (\\<Lambda> X.\n      (\\<lambda>ps.\n          Mprefix (Tr\\<^sub>P n ps)\n           (\\<lambda>e. X (Up\\<^sub>P ps e))))\\<cdot>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        n,Up\\<^sub>P\\<rbrakk>)\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?n =\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n       ?n,Up\\<^sub>P\\<rbrakk>\n\ngoal (1 subgoal):\n 1. PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n =\n    (\\<lambda>ps.\n        Mprefix (Tr\\<^sub>P n ps)\n         (\\<lambda>e.\n             PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>P ps e)))", "by simp"], ["", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir1: \"length ps > 0 \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps \\<sqsubseteq> (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps!0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < length ps \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps ! 0)", "proof(unfold PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n      induct arbitrary:ps\n             rule:fix_ind_k[where k=1\n                            and f=\"\\<Lambda> x. (\\<lambda>ps. Mprefix (Tr\\<^sub>P 1 ps) (\\<lambda>e. x (Up\\<^sub>P ps e)))\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a x \\<sqsubseteq>\n               LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0))\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "case adm:1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a x \\<sqsubseteq>\n               LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0))\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a x \\<sqsubseteq>\n               LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0))", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x.\n             0 < length x \\<longrightarrow>\n             a x \\<sqsubseteq>\n             LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0))\n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "case base_k_steps:2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P 1 s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>ps.\n                   Mprefix (Tr\\<^sub>P 1 ps)\n                    (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P 1 ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         \\<bottom>)\n         x \\<sqsubseteq>\n        LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "case step:(3 X)"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P 1 ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n  0 < length ps\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P 1 s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (xa ! 0);\n        0 < length s\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P 1 s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (s ! 0)", "then"], ["proof (chain)\npicking this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P 1 ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n  0 < length ps", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P 1 ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n  0 < length ps\n\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>ps.\n             Mprefix (Tr\\<^sub>P 1 ps)\n              (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n     X)\n     ps \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps ! 0)", "apply (subst LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add:phils_state_update_def phils_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                x \\<noteq> [] \\<longrightarrow>\n                X x \\<sqsubseteq>\n                LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0);\n     ps \\<noteq> []\\<rbrakk>\n    \\<Longrightarrow> Mprefix (Tr\\<^sub>l\\<^sub>p (ps ! 0))\n                       (\\<lambda>e.\n                           X (let i = phil e\n                              in if i = 0\n                                 then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n                                 else ps\n[i := Up\\<^sub>r\\<^sub>p i (ps ! i) e])) \\<sqsubseteq>\n                      Mprefix (Tr\\<^sub>l\\<^sub>p (ps ! 0))\n                       (\\<lambda>e.\n                           LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n                            (Up\\<^sub>l\\<^sub>p (ps ! 0) e))", "proof (intro mono_mprefix_ref, safe, goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   x \\<noteq> [] \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0);\n        ps \\<noteq> []; x \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\\<rbrakk>\n       \\<Longrightarrow> X (let i = phil x\n                            in if i = 0\n                               then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) x]\n                               else ps[i :=\n   Up\\<^sub>r\\<^sub>p i (ps ! i) x]) \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n                          (Up\\<^sub>l\\<^sub>p (ps ! 0) x)", "case (1 e)"], ["proof (state)\nthis:\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   x \\<noteq> [] \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0);\n        ps \\<noteq> []; x \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\\<rbrakk>\n       \\<Longrightarrow> X (let i = phil x\n                            in if i = 0\n                               then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) x]\n                               else ps[i :=\n   Up\\<^sub>r\\<^sub>p i (ps ! i) x]) \\<sqsubseteq>\n                         LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n                          (Up\\<^sub>l\\<^sub>p (ps ! 0) x)", "with 1(2)"], ["proof (chain)\npicking this:\n  ps \\<noteq> []\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)", "show ?case"], ["proof (prove)\nusing this:\n  ps \\<noteq> []\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\n\ngoal (1 subgoal):\n 1. X (let i = phil e\n       in if i = 0 then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n          else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) e]) \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Up\\<^sub>l\\<^sub>p (ps ! 0) e)", "using 1(1)[rule_format, of \"ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e]\"]"], ["proof (prove)\nusing this:\n  ps \\<noteq> []\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X x \\<sqsubseteq> LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (x ! 0)\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\n  ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e] \\<noteq> [] \\<Longrightarrow>\n  X (ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e]) \\<sqsubseteq>\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n   (ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e] ! 0)\n\ngoal (1 subgoal):\n 1. X (let i = phil e\n       in if i = 0 then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n          else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) e]) \\<sqsubseteq>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Up\\<^sub>l\\<^sub>p (ps ! 0) e)", "by (simp add:lphil0_transitions_def split:if_splits)"], ["proof (state)\nthis:\n  X (let i = phil e\n     in if i = 0 then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n        else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) e]) \\<sqsubseteq>\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Up\\<^sub>l\\<^sub>p (ps ! 0) e)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>ps.\n           Mprefix (Tr\\<^sub>P 1 ps)\n            (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n   X)\n   ps \\<sqsubseteq>\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps ! 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir2: \"length ps > 0 \\<Longrightarrow> (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps!0)) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < length ps \\<Longrightarrow>\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps ! 0) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "proof(unfold LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n      induct arbitrary:ps rule:fix_ind_k[where k=1\n                                         and f=\"\\<Lambda> x. (\\<lambda>s. Mprefix (Tr\\<^sub>l\\<^sub>p s) (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e)))\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a (x ! 0) \\<sqsubseteq>\n               PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                    (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 3. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "case adm:1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a (x ! 0) \\<sqsubseteq>\n               PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)\n 2. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                    (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 3. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               0 < length x \\<longrightarrow>\n               a (x ! 0) \\<sqsubseteq>\n               PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x.\n             0 < length x \\<longrightarrow>\n             a (x ! 0) \\<sqsubseteq>\n             PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x)\n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                    (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 2. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                    (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 2. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "case base_k_steps:2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                    (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n 2. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          0 < length x \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                    (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n           \\<bottom>)\n           (x ! 0) \\<sqsubseteq>\n          PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                  (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n         \\<bottom>)\n         (x ! 0) \\<sqsubseteq>\n        PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n\ngoal (1 subgoal):\n 1. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "case step:(3 X)"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                  (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n         X)\n         (x ! 0) \\<sqsubseteq>\n        PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n  0 < length ps\n\ngoal (1 subgoal):\n 1. \\<And>x ps.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      0 < length xa \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                (\\<lambda>e.\n                                    x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                       x)\n                       (xa ! 0) \\<sqsubseteq>\n                      PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 xa;\n        0 < length ps\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                                   (\\<lambda>e.\n x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n                          x)\n                          (ps ! 0) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "then"], ["proof (chain)\npicking this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                  (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n         X)\n         (x ! 0) \\<sqsubseteq>\n        PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n  0 < length ps", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     \\<forall>x.\n        0 < length x \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>s.\n                 Mprefix (Tr\\<^sub>l\\<^sub>p s)\n                  (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n         X)\n         (x ! 0) \\<sqsubseteq>\n        PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 x\n  0 < length ps\n\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>s.\n             Mprefix (Tr\\<^sub>l\\<^sub>p s)\n              (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n     X)\n     (ps ! 0) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps", "apply (subst PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_rec, simp add:phils_state_update_def phils_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                x \\<noteq> [] \\<longrightarrow>\n                X (x ! 0) \\<sqsubseteq>\n                PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x;\n     ps \\<noteq> []\\<rbrakk>\n    \\<Longrightarrow> Mprefix (Tr\\<^sub>l\\<^sub>p (ps ! 0))\n                       (\\<lambda>e.\n                           X (Up\\<^sub>l\\<^sub>p (ps ! 0) e)) \\<sqsubseteq>\n                      Mprefix (Tr\\<^sub>l\\<^sub>p (ps ! 0))\n                       (\\<lambda>e.\n                           PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n                            (let i = phil e\n                             in if i = 0\n                                then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n                                else ps[i :=\n    Up\\<^sub>r\\<^sub>p i (ps ! i) e]))", "proof (intro mono_mprefix_ref, safe, goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   x \\<noteq> [] \\<longrightarrow>\n                   X (x ! 0) \\<sqsubseteq>\n                   PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x;\n        ps \\<noteq> []; x \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>l\\<^sub>p (ps ! 0) x) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n                          (let i = phil x\n                           in if i = 0\n                              then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) x]\n                              else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) x])", "case (1 e)"], ["proof (state)\nthis:\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X (x ! 0) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   x \\<noteq> [] \\<longrightarrow>\n                   X (x ! 0) \\<sqsubseteq>\n                   PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x;\n        ps \\<noteq> []; x \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>l\\<^sub>p (ps ! 0) x) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n                          (let i = phil x\n                           in if i = 0\n                              then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) x]\n                              else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) x])", "with 1(2)"], ["proof (chain)\npicking this:\n  ps \\<noteq> []\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X (x ! 0) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)", "show ?case"], ["proof (prove)\nusing this:\n  ps \\<noteq> []\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X (x ! 0) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>l\\<^sub>p (ps ! 0) e) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n     (let i = phil e\n      in if i = 0 then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n         else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) e])", "using 1(1)[rule_format, of \"ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e]\"]"], ["proof (prove)\nusing this:\n  ps \\<noteq> []\n  \\<forall>x.\n     x \\<noteq> [] \\<longrightarrow>\n     X (x ! 0) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0) x\n  ps \\<noteq> []\n  e \\<in> Tr\\<^sub>l\\<^sub>p (ps ! 0)\n  ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e] \\<noteq> [] \\<Longrightarrow>\n  X (ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e] ! 0) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n   (ps[0 := Up\\<^sub>l\\<^sub>p (ps ! 0) e])\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>l\\<^sub>p (ps ! 0) e) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n     (let i = phil e\n      in if i = 0 then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n         else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) e])", "by (simp add:lphil0_transitions_def split:if_splits)"], ["proof (state)\nthis:\n  X (Up\\<^sub>l\\<^sub>p (ps ! 0) e) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc 0)\n   (let i = phil e\n    in if i = 0 then ps[i := Up\\<^sub>l\\<^sub>p (ps ! i) e]\n       else ps[i := Up\\<^sub>r\\<^sub>p i (ps ! i) e])\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>s.\n           Mprefix (Tr\\<^sub>l\\<^sub>p s)\n            (\\<lambda>e. x (Up\\<^sub>l\\<^sub>p s e))))\\<cdot>\n   X)\n   (ps ! 0) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1: \"length ps > 0 \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps = (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps!0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < length ps \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps =\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps ! 0)", "using PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir1 PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1_dir2 below_antisym"], ["proof (prove)\nusing this:\n  0 < length ?ps \\<Longrightarrow>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ?ps \\<sqsubseteq>\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (?ps ! 0)\n  0 < length ?ps \\<Longrightarrow>\n  LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (?ps ! 0) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ?ps\n  \\<lbrakk>?x \\<sqsubseteq> ?y; ?y \\<sqsubseteq> ?x\\<rbrakk>\n  \\<Longrightarrow> ?x = ?y\n\ngoal (1 subgoal):\n 1. 0 < length ps \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 1 ps =\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (ps ! 0)", "by blast"], ["", "lemma PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_unfold:\n  assumes n_pos:\"0 < n\"\n  shows \"length ps = Suc n \\<Longrightarrow>\n                            PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps = (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast ps)|||(RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps!n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length ps = Suc n \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps =\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps ! n))", "proof(rule below_antisym)"], ["proof (state)\ngoal (2 subgoals):\n 1. length ps = Suc n \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps \\<sqsubseteq>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps ! n))\n 2. length ps = Suc n \\<Longrightarrow>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast\n        ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n               (ps ! n)) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps", "show \"length ps = Suc n \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps \\<sqsubseteq> (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps!n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length ps = Suc n \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps \\<sqsubseteq>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps ! n))", "proof(subst PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def,\n        induct arbitrary:ps\n               rule:fix_ind_k[where k=1\n                              and f=\"\\<Lambda> x. (\\<lambda>ps. Mprefix (Tr\\<^sub>P (Suc n) ps) (\\<lambda>e. x (Up\\<^sub>P ps e)))\"])"], ["proof (state)\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               length x = Suc n \\<longrightarrow>\n               a x \\<sqsubseteq>\n               (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                 (butlast\n                   x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n 2. \\<forall>i<1.\n       \\<forall>x.\n          length x = Suc n \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P (Suc n) s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n            (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "case adm:1"], ["proof (state)\nthis:\n  \n\ngoal (3 subgoals):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               length x = Suc n \\<longrightarrow>\n               a x \\<sqsubseteq>\n               (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                 (butlast\n                   x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n 2. \\<forall>i<1.\n       \\<forall>x.\n          length x = Suc n \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P (Suc n) s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n            (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n 3. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               length x = Suc n \\<longrightarrow>\n               a x \\<sqsubseteq>\n               (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                 (butlast\n                   x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x.\n             length x = Suc n \\<longrightarrow>\n             a x \\<sqsubseteq>\n             (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n               (butlast\n                 x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n)))\n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          length x = Suc n \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P (Suc n) s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n            (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          length x = Suc n \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P (Suc n) s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n            (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "case base_k_steps:2"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          length x = Suc n \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>s.\n                   Mprefix (Tr\\<^sub>P (Suc n) s)\n                    (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n            (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n 2. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i<1.\n       \\<forall>x.\n          length x = Suc n \\<longrightarrow>\n          (iterate i\\<cdot>\n           (\\<Lambda> x.\n               (\\<lambda>ps.\n                   Mprefix (Tr\\<^sub>P (Suc n) ps)\n                    (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n           \\<bottom>)\n           x \\<sqsubseteq>\n          (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n            (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))", "by simp"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        length x = Suc n \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P (Suc n) ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         \\<bottom>)\n         x \\<sqsubseteq>\n        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n          (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "case step:(3 X)"], ["proof (state)\nthis:\n  \\<forall>i<1.\n     \\<forall>x.\n        length x = Suc n \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P (Suc n) ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n          (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n  length ps = Suc n\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "have indep:\"\\<forall>s\\<^sub>1 s\\<^sub>2. Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s\\<^sub>1 s\\<^sub>2.\n       Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}", "using phils_phil rphil_phil n_pos"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < ?n; ?e \\<in> Tr\\<^sub>P ?n ?s\\<rbrakk>\n  \\<Longrightarrow> phil ?e < ?n\n  ?e \\<in> Tr\\<^sub>r\\<^sub>p ?i ?s \\<Longrightarrow> phil ?e = ?i\n  0 < n\n\ngoal (1 subgoal):\n 1. \\<forall>s\\<^sub>1 s\\<^sub>2.\n       Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}", "by blast"], ["proof (state)\nthis:\n  \\<forall>s\\<^sub>1 s\\<^sub>2.\n     Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "from step"], ["proof (chain)\npicking this:\n  \\<forall>i<1.\n     \\<forall>x.\n        length x = Suc n \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P (Suc n) ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n          (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n  length ps = Suc n", "have tra:\"(Tr\\<^sub>P (Suc n) ps) =(Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n))\""], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     \\<forall>x.\n        length x = Suc n \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P (Suc n) ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n          (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n  length ps = Suc n\n\ngoal (1 subgoal):\n 1. Tr\\<^sub>P (Suc n) ps =\n    Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n)", "by (auto simp add:n_pos phils_transitions_def nth_butlast Suc_leI\n                        atLeastLessThanSuc Un_commute Un_assoc)"], ["proof (state)\nthis:\n  Tr\\<^sub>P (Suc n) ps =\n  Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n\ngoal (1 subgoal):\n 1. \\<And>x s.\n       \\<lbrakk>\\<forall>i<1.\n                   \\<forall>xa.\n                      length xa = Suc n \\<longrightarrow>\n                      (iterate i\\<cdot>\n                       (\\<Lambda> x.\n                           (\\<lambda>s.\n                               Mprefix (Tr\\<^sub>P (Suc n) s)\n                                (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                       x)\n                       xa \\<sqsubseteq>\n                      (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (butlast\n                          xa)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                 (xa ! n));\n        length s = Suc n\\<rbrakk>\n       \\<Longrightarrow> (iterate 1\\<cdot>\n                          (\\<Lambda> x.\n                              (\\<lambda>s.\n                                  Mprefix (Tr\\<^sub>P (Suc n) s)\n                                   (\\<lambda>e. x (Up\\<^sub>P s e))))\\<cdot>\n                          x)\n                          s \\<sqsubseteq>\n                         (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                           (butlast\n                             s)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   (s ! n))", "from step"], ["proof (chain)\npicking this:\n  \\<forall>i<1.\n     \\<forall>x.\n        length x = Suc n \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P (Suc n) ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n          (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n  length ps = Suc n", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i<1.\n     \\<forall>x.\n        length x = Suc n \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P (Suc n) ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n          (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n  length ps = Suc n\n\ngoal (1 subgoal):\n 1. (iterate 1\\<cdot>\n     (\\<Lambda> x.\n         (\\<lambda>ps.\n             Mprefix (Tr\\<^sub>P (Suc n) ps)\n              (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n     X)\n     ps \\<sqsubseteq>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps ! n))", "apply (auto simp add:indep dnorm_inter PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                X x \\<sqsubseteq>\n                (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                        case s of\n                        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                          Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                          Tr\\<^sub>r\\<^sub>p n\n                           s\\<^sub>2,\\<lambda>s.\n  case s of\n  (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n    \\<lambda>e.\n       if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n       then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n       else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n            then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n            else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                 (butlast x, x ! n);\n     length ps = Suc n\\<rbrakk>\n    \\<Longrightarrow> Mprefix (Tr\\<^sub>P (Suc n) ps)\n                       (\\<lambda>e. X (Up\\<^sub>P ps e)) \\<sqsubseteq>\n                      (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                              case s of\n                              (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                Tr\\<^sub>r\\<^sub>p n\n                                 s\\<^sub>2,\\<lambda>s.\n        case s of\n        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n          \\<lambda>e.\n             if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n             then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n             else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                  then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                  else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                       (butlast ps, ps ! n)", "apply (subst fix_eq, auto simp add:tra)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                X x \\<sqsubseteq>\n                (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                        case s of\n                        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                          Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                          Tr\\<^sub>r\\<^sub>p n\n                           s\\<^sub>2,\\<lambda>s.\n  case s of\n  (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n    \\<lambda>e.\n       if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n       then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n       else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n            then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n            else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                 (butlast x, x ! n);\n     length ps = Suc n\\<rbrakk>\n    \\<Longrightarrow> Mprefix\n                       (Tr\\<^sub>P n (butlast ps) \\<union>\n                        Tr\\<^sub>r\\<^sub>p n (ps ! n))\n                       (\\<lambda>e. X (Up\\<^sub>P ps e)) \\<sqsubseteq>\n                      Mprefix\n                       (Tr\\<^sub>P n (butlast ps) \\<union>\n                        Tr\\<^sub>r\\<^sub>p n (ps ! n))\n                       (\\<lambda>e.\n                           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                   case s of\n                                   (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                     Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                     Tr\\<^sub>r\\<^sub>p n\ns\\<^sub>2,\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               \\<lambda>e.\n                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                  else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                       then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                       else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                            (if e \\<in> Tr\\<^sub>P n (butlast ps)\n                             then (Up\\<^sub>P (butlast ps) e, ps ! n)\n                             else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                  then (butlast ps,\n  Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n                                  else (butlast ps, ps ! n)))", "proof(rule mono_mprefix_ref, safe, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "case (1 e)"], ["proof (state)\nthis:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "hence c:\"Up\\<^sub>P ps e ! n = ps ! n\""], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n\ngoal (1 subgoal):\n 1. Up\\<^sub>P ps e ! n = ps ! n", "using 1(3) phils_phil phils_state_update_def step n_pos"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n  \\<lbrakk>0 < ?n; ?e \\<in> Tr\\<^sub>P ?n ?s\\<rbrakk>\n  \\<Longrightarrow> phil ?e < ?n\n  Up\\<^sub>P ?ps ?e =\n  (let i = phil ?e\n   in if i = 0 then ?ps[i := Up\\<^sub>l\\<^sub>p (?ps ! i) ?e]\n      else ?ps[i := Up\\<^sub>r\\<^sub>p i (?ps ! i) ?e])\n  \\<forall>i<1.\n     \\<forall>x.\n        length x = Suc n \\<longrightarrow>\n        (iterate i\\<cdot>\n         (\\<Lambda> x.\n             (\\<lambda>ps.\n                 Mprefix (Tr\\<^sub>P (Suc n) ps)\n                  (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n         X)\n         x \\<sqsubseteq>\n        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n          (butlast x)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (x ! n))\n  length ps = Suc n\n  0 < n\n\ngoal (1 subgoal):\n 1. Up\\<^sub>P ps e ! n = ps ! n", "by (cases \"phil e\", auto) (metis exists_least_iff nth_list_update_neq)"], ["proof (state)\nthis:\n  Up\\<^sub>P ps e ! n = ps ! n\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "have d:\"Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)", "by (cases \"phil e\", auto simp add:phils_state_update_def butlast_list_update\n                                          lphil0_state_update_def rphil_state_update_def)"], ["proof (state)\nthis:\n  Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "have e:\"length (Up\\<^sub>P ps e) = Suc n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (Up\\<^sub>P ps e) = Suc n", "by (metis (full_types) step(2) length_list_update phils_state_update_def)"], ["proof (state)\nthis:\n  length (Up\\<^sub>P ps e) = Suc n\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "from 1"], ["proof (chain)\npicking this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>P ps e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>P n s\\<^sub>1 \\<union>\n              Tr\\<^sub>r\\<^sub>p n\n               s\\<^sub>2,\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                 then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if e \\<in> Tr\\<^sub>P n (butlast ps)\n      then (Up\\<^sub>P (butlast ps) e, ps ! n)\n      else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n           then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n           else (butlast ps, ps ! n))", "using 1(1)[rule_format, of \"(Up\\<^sub>P ps e)\"] c d e"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n  length (Up\\<^sub>P ps e) = Suc n \\<Longrightarrow>\n  X (Up\\<^sub>P ps e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>P n s\\<^sub>1 \\<union>\n            Tr\\<^sub>r\\<^sub>p n\n             s\\<^sub>2,\\<lambda>s.\n                          case s of\n                          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                            \\<lambda>e.\n                               if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                               then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                               else if e\n \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                                    then (s\\<^sub>1,\n    Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (butlast (Up\\<^sub>P ps e), Up\\<^sub>P ps e ! n)\n  Up\\<^sub>P ps e ! n = ps ! n\n  Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)\n  length (Up\\<^sub>P ps e) = Suc n\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>P ps e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>P n s\\<^sub>1 \\<union>\n              Tr\\<^sub>r\\<^sub>p n\n               s\\<^sub>2,\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                 then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if e \\<in> Tr\\<^sub>P n (butlast ps)\n      then (Up\\<^sub>P (butlast ps) e, ps ! n)\n      else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n           then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n           else (butlast ps, ps ! n))", "by auto"], ["proof (state)\nthis:\n  X (Up\\<^sub>P ps e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>P n s\\<^sub>1 \\<union>\n            Tr\\<^sub>r\\<^sub>p n\n             s\\<^sub>2,\\<lambda>s.\n                          case s of\n                          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                            \\<lambda>e.\n                               if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                               then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                               else if e\n \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                                    then (s\\<^sub>1,\n    Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (if e \\<in> Tr\\<^sub>P n (butlast ps)\n    then (Up\\<^sub>P (butlast ps) e, ps ! n)\n    else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n         then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n         else (butlast ps, ps ! n))\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "case (2 e)"], ["proof (state)\nthis:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "have e:\"length (Up\\<^sub>P ps e) = Suc n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (Up\\<^sub>P ps e) = Suc n", "by (metis (full_types) step(2) length_list_update phils_state_update_def)"], ["proof (state)\nthis:\n  length (Up\\<^sub>P ps e) = Suc n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>x.\n                   length x = Suc n \\<longrightarrow>\n                   X x \\<sqsubseteq>\n                   (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                           case s of\n                           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                             Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                             Tr\\<^sub>r\\<^sub>p n\n                              s\\<^sub>2,\\<lambda>s.\n     case s of\n     (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n       \\<lambda>e.\n          if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n          then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n               then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n               else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                    (butlast x, x ! n);\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (Up\\<^sub>P ps x) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                                 case s of\n                                 (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                   Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                   Tr\\<^sub>r\\<^sub>p n\n                                    s\\<^sub>2,\\<lambda>s.\n           case s of\n           (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n             \\<lambda>e.\n                if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                     then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                     else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                          (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                           then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                           else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                then (butlast ps,\nUp\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                else (butlast ps, ps ! n))", "from 2"], ["proof (chain)\npicking this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>P ps e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>P n s\\<^sub>1 \\<union>\n              Tr\\<^sub>r\\<^sub>p n\n               s\\<^sub>2,\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                 then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if e \\<in> Tr\\<^sub>P n (butlast ps)\n      then (Up\\<^sub>P (butlast ps) e, ps ! n)\n      else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n           then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n           else (butlast ps, ps ! n))", "using 2(1)[rule_format, of \"(Up\\<^sub>P ps e)\", OF e] n_pos"], ["proof (prove)\nusing this:\n  \\<forall>x.\n     length x = Suc n \\<longrightarrow>\n     X x \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast x, x ! n)\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n  X (Up\\<^sub>P ps e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>P n s\\<^sub>1 \\<union>\n            Tr\\<^sub>r\\<^sub>p n\n             s\\<^sub>2,\\<lambda>s.\n                          case s of\n                          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                            \\<lambda>e.\n                               if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                               then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                               else if e\n \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                                    then (s\\<^sub>1,\n    Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (butlast (Up\\<^sub>P ps e), Up\\<^sub>P ps e ! n)\n  0 < n\n\ngoal (1 subgoal):\n 1. X (Up\\<^sub>P ps e) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>P n s\\<^sub>1 \\<union>\n              Tr\\<^sub>r\\<^sub>p n\n               s\\<^sub>2,\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                 then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (if e \\<in> Tr\\<^sub>P n (butlast ps)\n      then (Up\\<^sub>P (butlast ps) e, ps ! n)\n      else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n           then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n           else (butlast ps, ps ! n))", "apply(auto simp add: butlast_list_update rphil_phil phils_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x.\n                length x = Suc n \\<longrightarrow>\n                X x \\<sqsubseteq>\n                (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                        case s of\n                        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                          Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                          Tr\\<^sub>r\\<^sub>p n\n                           s\\<^sub>2,\\<lambda>s.\n  case s of\n  (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n    \\<lambda>e.\n       if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n       then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n       else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n            then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n            else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                 (butlast x, x ! n);\n     length ps = Suc n; e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n);\n     X (ps[n := Up\\<^sub>r\\<^sub>p n (ps ! n) e]) \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n             case s of\n             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n               Tr\\<^sub>P n s\\<^sub>1 \\<union>\n               Tr\\<^sub>r\\<^sub>p n\n                s\\<^sub>2,\\<lambda>s.\n                             case s of\n                             (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                               \\<lambda>e.\n                                  if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                  then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                  else if e\n    \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n      (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e);\n     0 < n; e \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n    \\<Longrightarrow> X (ps[n := Up\\<^sub>r\\<^sub>p n (ps ! n)\n                                  e]) \\<sqsubseteq>\n                      (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n                              case s of\n                              (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                                Tr\\<^sub>P n s\\<^sub>1 \\<union>\n                                Tr\\<^sub>r\\<^sub>p n\n                                 s\\<^sub>2,\\<lambda>s.\n        case s of\n        (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n          \\<lambda>e.\n             if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n             then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n             else if e \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                  then (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                  else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n                       (butlast ps, ps ! n)", "by (meson disjoint_iff_not_equal indep)"], ["proof (state)\nthis:\n  X (Up\\<^sub>P ps e) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n          case s of\n          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n            Tr\\<^sub>P n s\\<^sub>1 \\<union>\n            Tr\\<^sub>r\\<^sub>p n\n             s\\<^sub>2,\\<lambda>s.\n                          case s of\n                          (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                            \\<lambda>e.\n                               if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                               then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                               else if e\n \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\n                                    then (s\\<^sub>1,\n    Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\n                                    else (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n   (if e \\<in> Tr\\<^sub>P n (butlast ps)\n    then (Up\\<^sub>P (butlast ps) e, ps ! n)\n    else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n         then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n         else (butlast ps, ps ! n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (iterate 1\\<cdot>\n   (\\<Lambda> x.\n       (\\<lambda>ps.\n           Mprefix (Tr\\<^sub>P (Suc n) ps)\n            (\\<lambda>e. x (Up\\<^sub>P ps e))))\\<cdot>\n   X)\n   ps \\<sqsubseteq>\n  (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n    (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps ! n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  length ps = Suc n \\<Longrightarrow>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps \\<sqsubseteq>\n  (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n    (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps ! n))\n\ngoal (1 subgoal):\n 1. length ps = Suc n \\<Longrightarrow>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast\n        ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n               (ps ! n)) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. length ps = Suc n \\<Longrightarrow>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast\n        ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n               (ps ! n)) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps", "have indep:\"\\<forall>s\\<^sub>1 s\\<^sub>2. Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>s\\<^sub>1 s\\<^sub>2.\n       Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}", "using phils_phil rphil_phil"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < ?n; ?e \\<in> Tr\\<^sub>P ?n ?s\\<rbrakk>\n  \\<Longrightarrow> phil ?e < ?n\n  ?e \\<in> Tr\\<^sub>r\\<^sub>p ?i ?s \\<Longrightarrow> phil ?e = ?i\n\ngoal (1 subgoal):\n 1. \\<forall>s\\<^sub>1 s\\<^sub>2.\n       Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}", "using n_pos"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 < ?n; ?e \\<in> Tr\\<^sub>P ?n ?s\\<rbrakk>\n  \\<Longrightarrow> phil ?e < ?n\n  ?e \\<in> Tr\\<^sub>r\\<^sub>p ?i ?s \\<Longrightarrow> phil ?e = ?i\n  0 < n\n\ngoal (1 subgoal):\n 1. \\<forall>s\\<^sub>1 s\\<^sub>2.\n       Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}", "by blast"], ["proof (state)\nthis:\n  \\<forall>s\\<^sub>1 s\\<^sub>2.\n     Tr\\<^sub>P n s\\<^sub>1 \\<inter> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2 = {}\n\ngoal (1 subgoal):\n 1. length ps = Suc n \\<Longrightarrow>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast\n        ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n               (ps ! n)) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps", "show \"length ps = Suc n \\<Longrightarrow> (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (butlast ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps!n)) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length ps = Suc n \\<Longrightarrow>\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n      (butlast\n        ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n               (ps ! n)) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps", "apply (subst PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def, auto simp add:indep dnorm_inter RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. length ps = Suc n \\<Longrightarrow>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>P n s\\<^sub>1 \\<union>\n              Tr\\<^sub>r\\<^sub>p n\n               s\\<^sub>2,\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 if e \\<in> Tr\\<^sub>P n s\\<^sub>1\n                                 then (Up\\<^sub>P s\\<^sub>1 e, s\\<^sub>2)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n s\\<^sub>2\nthen (s\\<^sub>1, Up\\<^sub>r\\<^sub>p n s\\<^sub>2 e)\nelse (s\\<^sub>1, s\\<^sub>2)\\<rbrakk>)\n     (butlast ps, ps ! n) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps", "proof(rule fix_ind[where\n        P=\"\\<lambda>a. \\<forall>x. length x = Suc n \\<longrightarrow> a (butlast x, x ! n) \\<sqsubseteq> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x\", rule_format],\n        simp_all, goal_cases base step)"], ["proof (state)\ngoal (2 subgoals):\n 1. length ps = Suc n \\<Longrightarrow>\n    adm (\\<lambda>a.\n            \\<forall>x.\n               length x = Suc n \\<longrightarrow>\n               a (butlast x, x ! n) \\<sqsubseteq>\n               PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x)\n 2. \\<And>x xa.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>P n (butlast xa) \\<union>\n                           Tr\\<^sub>r\\<^sub>p n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>P n (butlast xa)\n                                 then (Up\\<^sub>P (butlast xa) e, xa ! n)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n (xa ! n)\nthen (butlast xa, Up\\<^sub>r\\<^sub>p n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "case base"], ["proof (state)\nthis:\n  length ps = Suc n\n\ngoal (2 subgoals):\n 1. length ps = Suc n \\<Longrightarrow>\n    adm (\\<lambda>a.\n            \\<forall>x.\n               length x = Suc n \\<longrightarrow>\n               a (butlast x, x ! n) \\<sqsubseteq>\n               PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x)\n 2. \\<And>x xa.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>P n (butlast xa) \\<union>\n                           Tr\\<^sub>r\\<^sub>p n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>P n (butlast xa)\n                                 then (Up\\<^sub>P (butlast xa) e, xa ! n)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n (xa ! n)\nthen (butlast xa, Up\\<^sub>r\\<^sub>p n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "then"], ["proof (chain)\npicking this:\n  length ps = Suc n", "show ?case"], ["proof (prove)\nusing this:\n  length ps = Suc n\n\ngoal (1 subgoal):\n 1. adm (\\<lambda>a.\n            \\<forall>x.\n               length x = Suc n \\<longrightarrow>\n               a (butlast x, x ! n) \\<sqsubseteq>\n               PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x)", "by (simp add:cont_fun)"], ["proof (state)\nthis:\n  adm (\\<lambda>a.\n          \\<forall>x.\n             length x = Suc n \\<longrightarrow>\n             a (butlast x, x ! n) \\<sqsubseteq>\n             PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) x)\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>P n (butlast xa) \\<union>\n                           Tr\\<^sub>r\\<^sub>p n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>P n (butlast xa)\n                                 then (Up\\<^sub>P (butlast xa) e, xa ! n)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n (xa ! n)\nthen (butlast xa, Up\\<^sub>r\\<^sub>p n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>P n (butlast xa) \\<union>\n                           Tr\\<^sub>r\\<^sub>p n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>P n (butlast xa)\n                                 then (Up\\<^sub>P (butlast xa) e, xa ! n)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n (xa ! n)\nthen (butlast xa, Up\\<^sub>r\\<^sub>p n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "case (step X ps)"], ["proof (state)\nthis:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  length ps = Suc n\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>P n (butlast xa) \\<union>\n                           Tr\\<^sub>r\\<^sub>p n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>P n (butlast xa)\n                                 then (Up\\<^sub>P (butlast xa) e, xa ! n)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n (xa ! n)\nthen (butlast xa, Up\\<^sub>r\\<^sub>p n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "hence tra:\"(Tr\\<^sub>P (Suc n) ps) =(Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n))\""], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  length ps = Suc n\n\ngoal (1 subgoal):\n 1. Tr\\<^sub>P (Suc n) ps =\n    Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n)", "by (auto simp add:n_pos phils_transitions_def nth_butlast\n                        Suc_leI atLeastLessThanSuc Un_commute Un_assoc)"], ["proof (state)\nthis:\n  Tr\\<^sub>P (Suc n) ps =\n  Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>xa.\n           length xa = Suc n \\<Longrightarrow>\n           x (butlast xa, xa ! n) \\<sqsubseteq>\n           PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa;\n        length xa = Suc n\\<rbrakk>\n       \\<Longrightarrow> Mprefix\n                          (Tr\\<^sub>P n (butlast xa) \\<union>\n                           Tr\\<^sub>r\\<^sub>p n (xa ! n))\n                          (\\<lambda>e.\n                              x (if e \\<in> Tr\\<^sub>P n (butlast xa)\n                                 then (Up\\<^sub>P (butlast xa) e, xa ! n)\n                                 else if e\n   \\<in> Tr\\<^sub>r\\<^sub>p n (xa ! n)\nthen (butlast xa, Up\\<^sub>r\\<^sub>p n (xa ! n) e)\nelse (butlast xa, xa ! n))) \\<sqsubseteq>\n                         PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) xa", "from step"], ["proof (chain)\npicking this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  length ps = Suc n", "show ?case"], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  length ps = Suc n\n\ngoal (1 subgoal):\n 1. Mprefix\n     (Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n))\n     (\\<lambda>e.\n         X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n            then (Up\\<^sub>P (butlast ps) e, ps ! n)\n            else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                 then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n                 else (butlast ps, ps ! n))) \\<sqsubseteq>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps", "apply (auto simp add:indep dnorm_inter PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>length ps = Suc n;\n     \\<And>x.\n        length x = Suc n \\<Longrightarrow>\n        X (butlast x, x ! n) \\<sqsubseteq>\n        (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n              (Suc n),Up\\<^sub>P\\<rbrakk>)\n         x;\n     length ps = Suc n\\<rbrakk>\n    \\<Longrightarrow> Mprefix\n                       (Tr\\<^sub>P n (butlast ps) \\<union>\n                        Tr\\<^sub>r\\<^sub>p n (ps ! n))\n                       (\\<lambda>e.\n                           X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n                              then (Up\\<^sub>P (butlast ps) e, ps ! n)\n                              else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                   then (butlast ps,\n   Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n                                   else (butlast ps, ps ! n))) \\<sqsubseteq>\n                      (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                            (Suc n),Up\\<^sub>P\\<rbrakk>)\n                       ps", "apply (subst fix_eq, auto simp add:tra)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>length ps = Suc n;\n     \\<And>x.\n        length x = Suc n \\<Longrightarrow>\n        X (butlast x, x ! n) \\<sqsubseteq>\n        (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n              (Suc n),Up\\<^sub>P\\<rbrakk>)\n         x;\n     length ps = Suc n\\<rbrakk>\n    \\<Longrightarrow> Mprefix\n                       (Tr\\<^sub>P n (butlast ps) \\<union>\n                        Tr\\<^sub>r\\<^sub>p n (ps ! n))\n                       (\\<lambda>e.\n                           X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n                              then (Up\\<^sub>P (butlast ps) e, ps ! n)\n                              else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                   then (butlast ps,\n   Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n                                   else (butlast ps, ps ! n))) \\<sqsubseteq>\n                      Mprefix\n                       (Tr\\<^sub>P n (butlast ps) \\<union>\n                        Tr\\<^sub>r\\<^sub>p n (ps ! n))\n                       (\\<lambda>e.\n                           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n                            (Up\\<^sub>P ps e))", "proof(rule mono_mprefix_ref, safe, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)\n 2. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "case (1 e)"], ["proof (state)\nthis:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)\n 2. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "hence c:\"Up\\<^sub>P ps e ! n = ps ! n\""], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n\ngoal (1 subgoal):\n 1. Up\\<^sub>P ps e ! n = ps ! n", "using 1(3) phils_phil phils_state_update_def step n_pos"], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n  length ps = Suc n\n  \\<lbrakk>0 < ?n; ?e \\<in> Tr\\<^sub>P ?n ?s\\<rbrakk>\n  \\<Longrightarrow> phil ?e < ?n\n  Up\\<^sub>P ?ps ?e =\n  (let i = phil ?e\n   in if i = 0 then ?ps[i := Up\\<^sub>l\\<^sub>p (?ps ! i) ?e]\n      else ?ps[i := Up\\<^sub>r\\<^sub>p i (?ps ! i) ?e])\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ?x\n  length ps = Suc n\n  0 < n\n\ngoal (1 subgoal):\n 1. Up\\<^sub>P ps e ! n = ps ! n", "by (cases \"phil e\", auto) (metis exists_least_iff nth_list_update_neq)"], ["proof (state)\nthis:\n  Up\\<^sub>P ps e ! n = ps ! n\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)\n 2. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "have d:\"Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)", "by (cases \"phil e\", auto simp add:phils_state_update_def butlast_list_update\n                                          lphil0_state_update_def rphil_state_update_def)"], ["proof (state)\nthis:\n  Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)\n 2. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "have e:\"length (Up\\<^sub>P ps e) = Suc n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (Up\\<^sub>P ps e) = Suc n", "by (metis (full_types) step(3) length_list_update phils_state_update_def)"], ["proof (state)\nthis:\n  length (Up\\<^sub>P ps e) = Suc n\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)\n 2. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "from 1"], ["proof (chain)\npicking this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)", "show ?case"], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n\ngoal (1 subgoal):\n 1. X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n       then (Up\\<^sub>P (butlast ps) e, ps ! n)\n       else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n            then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n            else (butlast ps, ps ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n          (Suc n),Up\\<^sub>P\\<rbrakk>)\n     (Up\\<^sub>P ps e)", "using 1(2)[rule_format, of \"(Up\\<^sub>P ps e)\", OF e] c d"], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>P n (butlast ps)\n  X (butlast (Up\\<^sub>P ps e), Up\\<^sub>P ps e ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   (Up\\<^sub>P ps e)\n  Up\\<^sub>P ps e ! n = ps ! n\n  Up\\<^sub>P (butlast ps) e = butlast (Up\\<^sub>P ps e)\n\ngoal (1 subgoal):\n 1. X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n       then (Up\\<^sub>P (butlast ps) e, ps ! n)\n       else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n            then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n            else (butlast ps, ps ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n          (Suc n),Up\\<^sub>P\\<rbrakk>)\n     (Up\\<^sub>P ps e)", "by auto"], ["proof (state)\nthis:\n  X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n     then (Up\\<^sub>P (butlast ps) e, ps ! n)\n     else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n          then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n          else (butlast ps, ps ! n)) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   (Up\\<^sub>P ps e)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "case (2 e)"], ["proof (state)\nthis:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "have e:\"length (Up\\<^sub>P ps e) = Suc n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. length (Up\\<^sub>P ps e) = Suc n", "by (metis (full_types) 2(3) length_list_update phils_state_update_def)"], ["proof (state)\nthis:\n  length (Up\\<^sub>P ps e) = Suc n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>length ps = Suc n;\n        \\<And>x.\n           length x = Suc n \\<Longrightarrow>\n           X (butlast x, x ! n) \\<sqsubseteq>\n           (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                 (Suc n),Up\\<^sub>P\\<rbrakk>)\n            x;\n        length ps = Suc n; x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\\<rbrakk>\n       \\<Longrightarrow> X (if x \\<in> Tr\\<^sub>P n (butlast ps)\n                            then (Up\\<^sub>P (butlast ps) x, ps ! n)\n                            else if x \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n                                 then (butlast ps,\n Up\\<^sub>r\\<^sub>p n (ps ! n) x)\n                                 else (butlast ps, ps ! n)) \\<sqsubseteq>\n                         (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                               (Suc n),Up\\<^sub>P\\<rbrakk>)\n                          (Up\\<^sub>P ps x)", "from 2"], ["proof (chain)\npicking this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)", "show ?case"], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n\ngoal (1 subgoal):\n 1. X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n       then (Up\\<^sub>P (butlast ps) e, ps ! n)\n       else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n            then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n            else (butlast ps, ps ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n          (Suc n),Up\\<^sub>P\\<rbrakk>)\n     (Up\\<^sub>P ps e)", "using 2(2)[rule_format, of \"(Up\\<^sub>P ps e)\", OF e] n_pos"], ["proof (prove)\nusing this:\n  length ps = Suc n\n  length ?x = Suc n \\<Longrightarrow>\n  X (butlast ?x, ?x ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   ?x\n  length ps = Suc n\n  e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n  X (butlast (Up\\<^sub>P ps e), Up\\<^sub>P ps e ! n) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   (Up\\<^sub>P ps e)\n  0 < n\n\ngoal (1 subgoal):\n 1. X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n       then (Up\\<^sub>P (butlast ps) e, ps ! n)\n       else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n            then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n            else (butlast ps, ps ! n)) \\<sqsubseteq>\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n          (Suc n),Up\\<^sub>P\\<rbrakk>)\n     (Up\\<^sub>P ps e)", "apply(auto simp add: butlast_list_update rphil_phil phils_state_update_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>length ps = Suc n;\n     \\<And>x.\n        length x = Suc n \\<Longrightarrow>\n        X (butlast x, x ! n) \\<sqsubseteq>\n        (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n              (Suc n),\\<lambda>s e.\n                         let i = phil e\n                         in if i = 0\n                            then s[i := Up\\<^sub>l\\<^sub>p (s ! i) e]\n                            else s[i := Up\\<^sub>r\\<^sub>p i (s ! i)\n   e]\\<rbrakk>)\n         x;\n     length ps = Suc n; e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n);\n     X (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e) \\<sqsubseteq>\n     (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n           (Suc n),\\<lambda>s e.\n                      let i = phil e\n                      in if i = 0 then s[i := Up\\<^sub>l\\<^sub>p (s ! i) e]\n                         else s[i := Up\\<^sub>r\\<^sub>p i (s ! i)\ne]\\<rbrakk>)\n      (ps[n := Up\\<^sub>r\\<^sub>p n (ps ! n) e]);\n     0 < n; e \\<in> Tr\\<^sub>P n (butlast ps)\\<rbrakk>\n    \\<Longrightarrow> X (butlast ps, ps ! n) \\<sqsubseteq>\n                      (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n                            (Suc n),\\<lambda>s e.\n let i = phil e\n in if i = 0 then s[i := Up\\<^sub>l\\<^sub>p (s ! i) e]\n    else s[i := Up\\<^sub>r\\<^sub>p i (s ! i) e]\\<rbrakk>)\n                       (ps[n := Up\\<^sub>r\\<^sub>p n (ps ! n) e])", "by (meson disjoint_iff_not_equal indep)"], ["proof (state)\nthis:\n  X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n     then (Up\\<^sub>P (butlast ps) e, ps ! n)\n     else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n          then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n          else (butlast ps, ps ! n)) \\<sqsubseteq>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>P\n        (Suc n),Up\\<^sub>P\\<rbrakk>)\n   (Up\\<^sub>P ps e)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Mprefix (Tr\\<^sub>P n (butlast ps) \\<union> Tr\\<^sub>r\\<^sub>p n (ps ! n))\n   (\\<lambda>e.\n       X (if e \\<in> Tr\\<^sub>P n (butlast ps)\n          then (Up\\<^sub>P (butlast ps) e, ps ! n)\n          else if e \\<in> Tr\\<^sub>r\\<^sub>p n (ps ! n)\n               then (butlast ps, Up\\<^sub>r\\<^sub>p n (ps ! n) e)\n               else (butlast ps, ps ! n))) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  length ps = Suc n \\<Longrightarrow>\n  (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n    (butlast\n      ps)|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (ps ! n)) \\<sqsubseteq>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) ps\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma pt: \"0 < n \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) = foldPHILs n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < n \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n    fold (\\<lambda>i P. P|||RPHIL i) [1..<n] LPHIL0", "proof (induct n, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>0 < n \\<Longrightarrow>\n                PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n                fold (\\<lambda>i P. P|||RPHIL i) [1..<n] LPHIL0;\n        0 < Suc n\\<rbrakk>\n       \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n)\n                          (replicate (Suc n) 0) =\n                         fold (\\<lambda>i P. P|||RPHIL i) [1..<Suc n] LPHIL0", "case (Suc n)"], ["proof (state)\nthis:\n  0 < n \\<Longrightarrow>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n  fold (\\<lambda>i P. P|||RPHIL i) [1..<n] LPHIL0\n  0 < Suc n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>0 < n \\<Longrightarrow>\n                PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n                fold (\\<lambda>i P. P|||RPHIL i) [1..<n] LPHIL0;\n        0 < Suc n\\<rbrakk>\n       \\<Longrightarrow> PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n)\n                          (replicate (Suc n) 0) =\n                         fold (\\<lambda>i P. P|||RPHIL i) [1..<Suc n] LPHIL0", "then"], ["proof (chain)\npicking this:\n  0 < n \\<Longrightarrow>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n  fold (\\<lambda>i P. P|||RPHIL i) [1..<n] LPHIL0\n  0 < Suc n", "show ?case"], ["proof (prove)\nusing this:\n  0 < n \\<Longrightarrow>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n  fold (\\<lambda>i P. P|||RPHIL i) [1..<n] LPHIL0\n  0 < Suc n\n\ngoal (1 subgoal):\n 1. PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (replicate (Suc n) 0) =\n    fold (\\<lambda>i P. P|||RPHIL i) [1..<Suc n] LPHIL0", "apply (auto simp add: PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_unfold LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_LPHIL0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (replicate n 0) =\n             fold (\\<lambda>i P. P|||RPHIL i) [Suc 0..<n]\n              (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0);\n     Suc 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                        (0 #\n                         butlast\n                          (replicate n\n                            0))|||RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n\n                                   0) =\n                      (fold (\\<lambda>i P. P|||RPHIL i) [Suc 0..<n]\n                        (LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\n                          0)|||RPHIL n)\n 2. \\<not> Suc 0 \\<le> n \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (0 # replicate n 0) =\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "apply (metis Suc_le_eq butlast.simps(2) butlast_snoc RPHIL\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_is_RPHIL\n                    nat_neq_iff replicate_append_same replicate_empty)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> Suc 0 \\<le> n \\<Longrightarrow>\n    PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (0 # replicate n 0) =\n    LPHIL0\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m 0", "by (metis One_nat_def leI length_replicate less_Suc0 PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_1 nth_Cons_0 replicate_Suc)"], ["proof (state)\nthis:\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m (Suc n) (replicate (Suc n) 0) =\n  fold (\\<lambda>i P. P|||RPHIL i) [1..<Suc n] LPHIL0\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary PHILs_is_PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) = PHILs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) =\n    fold (\\<lambda>i P. P|||RPHIL i) [1..<N] LPHIL0", "using pt N_pos"], ["proof (prove)\nusing this:\n  0 < ?n \\<Longrightarrow>\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?n (replicate ?n 0) =\n  fold (\\<lambda>i P. P|||RPHIL i) [1..<?n] LPHIL0\n  0 < N\n\ngoal (1 subgoal):\n 1. PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) =\n    fold (\\<lambda>i P. P|||RPHIL i) [1..<N] LPHIL0", "by simp"], ["", "subsection \\<open>The complete process system under normal form\\<close>"], ["", "definition dining_transitions:: \"nat \\<Rightarrow> phils_state \\<times> forks_state \\<Rightarrow> dining_event set\" (\"Tr\\<^sub>D\")\n  where \"Tr\\<^sub>D n = (\\<lambda>(ps,fs). (Tr\\<^sub>P n ps) \\<inter> (Tr\\<^sub>F n fs))\""], ["", "definition dining_state_update::\n  \"phils_state \\<times> forks_state \\<Rightarrow> dining_event \\<Rightarrow> phils_state \\<times> forks_state\" (\"Up\\<^sub>D\")\n  where \"Up\\<^sub>D = (\\<lambda>(ps,fs) e. (Up\\<^sub>P ps e, Up\\<^sub>F fs e))\""], ["", "definition DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m:: \"nat \\<Rightarrow> phils_state \\<times> forks_state \\<Rightarrow> dining_event process\"\n  where \"DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>D n, Up\\<^sub>D\\<rbrakk>\""], ["", "lemma ltsDining_rec:  \"DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n = (\\<lambda> s. \\<box> e \\<in> (Tr\\<^sub>D n s) \\<rightarrow> DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>D s e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>D n s)\n         (\\<lambda>e.\n             DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>D s e)))", "using fix_eq[of \"\\<Lambda> X. (\\<lambda>s. Mprefix (Tr\\<^sub>D n s) (\\<lambda>e. X (Up\\<^sub>D s e)))\"] DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def"], ["proof (prove)\nusing this:\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>D\n       n,Up\\<^sub>D\\<rbrakk> =\n  (\\<Lambda> X.\n      (\\<lambda>s.\n          Mprefix (Tr\\<^sub>D n s) (\\<lambda>e. X (Up\\<^sub>D s e))))\\<cdot>\n  (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>D\n        n,Up\\<^sub>D\\<rbrakk>)\n  DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m ?n =\n  P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>D\n       ?n,Up\\<^sub>D\\<rbrakk>\n\ngoal (1 subgoal):\n 1. DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n =\n    (\\<lambda>s.\n        Mprefix (Tr\\<^sub>D n s)\n         (\\<lambda>e.\n             DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m n (Up\\<^sub>D s e)))", "by simp"], ["", "lemma DINING_is_DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m: \"DINING = DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. DINING =\n    DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. DINING =\n    DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)", "have \"DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0) =\n                                        (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) || FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N\n     (replicate N 0, replicate N 0) =\n    (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N\n      (replicate N\n        0)||FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0))", "unfolding DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def dining_transitions_def\n              dining_state_update_def dnorm_par"], ["proof (prove)\ngoal (1 subgoal):\n 1. (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (ps, fs) \\<Rightarrow>\n              Tr\\<^sub>P N ps \\<inter>\n              Tr\\<^sub>F N\n               fs,\\<lambda>s.\n                     case s of\n                     (ps, fs) \\<Rightarrow>\n                       \\<lambda>e.\n                          (Up\\<^sub>P ps e, Up\\<^sub>F fs e)\\<rbrakk>)\n     (replicate N 0, replicate N 0) =\n    (P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>\\<lambda>s.\n            case s of\n            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n              Tr\\<^sub>P N s\\<^sub>1 \\<inter>\n              Tr\\<^sub>F N\n               s\\<^sub>2,\\<lambda>s.\n                            case s of\n                            (s\\<^sub>1, s\\<^sub>2) \\<Rightarrow>\n                              \\<lambda>e.\n                                 (Up\\<^sub>P s\\<^sub>1 e,\n                                  Up\\<^sub>F s\\<^sub>2 e)\\<rbrakk>)\n     (replicate N 0, replicate N 0)", "by simp"], ["proof (state)\nthis:\n  DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0) =\n  (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N\n    (replicate N\n      0)||FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0))\n\ngoal (1 subgoal):\n 1. DINING =\n    DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)", "thus ?thesis"], ["proof (prove)\nusing this:\n  DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0) =\n  (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N\n    (replicate N\n      0)||FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0))\n\ngoal (1 subgoal):\n 1. DINING =\n    DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)", "using PHILs_is_PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m FORKs_is_FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m DINING_def"], ["proof (prove)\nusing this:\n  DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0) =\n  (PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N\n    (replicate N\n      0)||FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0))\n  PHILs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) =\n  fold (\\<lambda>i P. P|||RPHIL i) [1..<N] LPHIL0\n  FORKs\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0) =\n  fold (\\<lambda>i P. P|||FORK i) [1..<N] (FORK 0)\n  DINING =\n  (fold (\\<lambda>i P. P|||FORK i) [1..<N]\n    (FORK 0)||fold (\\<lambda>i P. P|||RPHIL i) [1..<N] LPHIL0)\n\ngoal (1 subgoal):\n 1. DINING =\n    DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)", "by (simp add: par_comm)"], ["proof (state)\nthis:\n  DINING =\n  DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m N (replicate N 0, replicate N 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>And finally: Philosophers may dine ! Always !\\<close>"], ["", "corollary lphil_states:\"Up\\<^sub>l\\<^sub>p r e = 0 \\<or> Up\\<^sub>l\\<^sub>p r e = 1 \\<or> Up\\<^sub>l\\<^sub>p r e = 2 \\<or> Up\\<^sub>l\\<^sub>p r e = 3\"\n      and rphil_states:\"Up\\<^sub>r\\<^sub>p i r e = 0 \\<or> Up\\<^sub>r\\<^sub>p i r e = 1 \\<or> Up\\<^sub>r\\<^sub>p i r e = 2 \\<or> Up\\<^sub>r\\<^sub>p i r e = 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Up\\<^sub>l\\<^sub>p r e = 0 \\<or>\n    Up\\<^sub>l\\<^sub>p r e = 1 \\<or>\n    Up\\<^sub>l\\<^sub>p r e = 2 \\<or> Up\\<^sub>l\\<^sub>p r e = 3 &&&\n    Up\\<^sub>r\\<^sub>p i r e = 0 \\<or>\n    Up\\<^sub>r\\<^sub>p i r e = 1 \\<or>\n    Up\\<^sub>r\\<^sub>p i r e = 2 \\<or> Up\\<^sub>r\\<^sub>p i r e = 3", "unfolding lphil0_state_update_def rphil_state_update_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (if e = picks 0 (N - 1) then 1\n     else if e = picks 0 0 then 2 else if e = putsdown 0 0 then 3 else 0) =\n    0 \\<or>\n    (if e = picks 0 (N - 1) then 1\n     else if e = picks 0 0 then 2 else if e = putsdown 0 0 then 3 else 0) =\n    1 \\<or>\n    (if e = picks 0 (N - 1) then 1\n     else if e = picks 0 0 then 2 else if e = putsdown 0 0 then 3 else 0) =\n    2 \\<or>\n    (if e = picks 0 (N - 1) then 1\n     else if e = picks 0 0 then 2 else if e = putsdown 0 0 then 3 else 0) =\n    3 &&&\n    (if e = picks i i then 1\n     else if e = picks i (i - 1) then 2\n          else if e = putsdown i (i - 1) then 3 else 0) =\n    0 \\<or>\n    (if e = picks i i then 1\n     else if e = picks i (i - 1) then 2\n          else if e = putsdown i (i - 1) then 3 else 0) =\n    1 \\<or>\n    (if e = picks i i then 1\n     else if e = picks i (i - 1) then 2\n          else if e = putsdown i (i - 1) then 3 else 0) =\n    2 \\<or>\n    (if e = picks i i then 1\n     else if e = picks i (i - 1) then 2\n          else if e = putsdown i (i - 1) then 3 else 0) =\n    3", "by auto"], ["", "lemma dining_events:\n\"e \\<in> Tr\\<^sub>D N s \\<Longrightarrow>\n        (\\<exists>i\\<in>{1..<N}. e = picks i i \\<or> e = picks i (i-1)  \\<or> e = putsdown i i \\<or> e = putsdown i (i-1))\n     \\<or> (e = picks 0 0 \\<or> e = picks 0 (N-1) \\<or> e = putsdown 0 0 \\<or> e = putsdown 0 (N-1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e \\<in> Tr\\<^sub>D N s \\<Longrightarrow>\n    (\\<exists>i\\<in>{1..<N}.\n        e = picks i i \\<or>\n        e = picks i (i - 1) \\<or>\n        e = putsdown i i \\<or> e = putsdown i (i - 1)) \\<or>\n    e = picks 0 0 \\<or>\n    e = picks 0 (N - 1) \\<or> e = putsdown 0 0 \\<or> e = putsdown 0 (N - 1)", "by (auto simp add:dining_transitions_def phils_transitions_def rphil_transitions_def\n                    lphil0_transitions_def split:prod.splits if_splits)"], ["", "definition \"inv_dining ps fs \\<equiv>\n            (\\<forall>i. Suc i < N \\<longrightarrow>  ((fs!(Suc i) = 1) \\<longleftrightarrow> ps!Suc i \\<noteq> 0)) \\<and> (fs!(N-1) = 2 \\<longleftrightarrow> ps!0 \\<noteq> 0)\n          \\<and> (\\<forall>i < N - 1.                 fs!i = 2 \\<longleftrightarrow>  ps!Suc i = 2)  \\<and>   (fs!0 = 1 \\<longleftrightarrow> ps!0 = 2)\n          \\<and> (\\<forall>i < N. fs!i = 0 \\<or> fs!i = 1 \\<or> fs!i = 2)\n          \\<and> (\\<forall>i < N. ps!i = 0 \\<or> ps!i = 1 \\<or> ps!i = 2 \\<or> ps!i = 3)\n          \\<and> length fs = N \\<and> length ps = N\""], ["", "lemma inv_DINING: \"s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D (replicate N 0, replicate N 0) \\<Longrightarrow> inv_dining (fst s) (snd s)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D\n             (replicate N 0, replicate N 0) \\<Longrightarrow>\n    inv_dining (fst s) (snd s)", "proof(induct rule:\\<RR>.induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. inv_dining (fst (replicate N 0, replicate N 0))\n     (snd (replicate N 0, replicate N 0))\n 2. \\<And>s e.\n       \\<lbrakk>s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D\n                         (replicate N 0, replicate N 0);\n        inv_dining (fst s) (snd s); e \\<in> Tr\\<^sub>D N s\\<rbrakk>\n       \\<Longrightarrow> inv_dining (fst (Up\\<^sub>D s e))\n                          (snd (Up\\<^sub>D s e))", "case rbase"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. inv_dining (fst (replicate N 0, replicate N 0))\n     (snd (replicate N 0, replicate N 0))\n 2. \\<And>s e.\n       \\<lbrakk>s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D\n                         (replicate N 0, replicate N 0);\n        inv_dining (fst s) (snd s); e \\<in> Tr\\<^sub>D N s\\<rbrakk>\n       \\<Longrightarrow> inv_dining (fst (Up\\<^sub>D s e))\n                          (snd (Up\\<^sub>D s e))", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_dining (fst (replicate N 0, replicate N 0))\n     (snd (replicate N 0, replicate N 0))", "unfolding inv_dining_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (snd (replicate N 0, replicate N 0) ! Suc i = 1) =\n        (fst (replicate N 0, replicate N 0) ! Suc i \\<noteq> 0)) \\<and>\n    (snd (replicate N 0, replicate N 0) ! (N - 1) = 2) =\n    (fst (replicate N 0, replicate N 0) ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (snd (replicate N 0, replicate N 0) ! i = 2) =\n        (fst (replicate N 0, replicate N 0) ! Suc i = 2)) \\<and>\n    (snd (replicate N 0, replicate N 0) ! 0 = 1) =\n    (fst (replicate N 0, replicate N 0) ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        snd (replicate N 0, replicate N 0) ! i = 0 \\<or>\n        snd (replicate N 0, replicate N 0) ! i = 1 \\<or>\n        snd (replicate N 0, replicate N 0) ! i = 2) \\<and>\n    (\\<forall>i<N.\n        fst (replicate N 0, replicate N 0) ! i = 0 \\<or>\n        fst (replicate N 0, replicate N 0) ! i = 1 \\<or>\n        fst (replicate N 0, replicate N 0) ! i = 2 \\<or>\n        fst (replicate N 0, replicate N 0) ! i = 3) \\<and>\n    length (snd (replicate N 0, replicate N 0)) = N \\<and>\n    length (fst (replicate N 0, replicate N 0)) = N", "by (simp add:dining_transitions_def phils_transitions_def forks_transitions_def\n                 lphil0_transitions_def rphil_transitions_def fork_transitions_def)"], ["proof (state)\nthis:\n  inv_dining (fst (replicate N 0, replicate N 0))\n   (snd (replicate N 0, replicate N 0))\n\ngoal (1 subgoal):\n 1. \\<And>s e.\n       \\<lbrakk>s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D\n                         (replicate N 0, replicate N 0);\n        inv_dining (fst s) (snd s); e \\<in> Tr\\<^sub>D N s\\<rbrakk>\n       \\<Longrightarrow> inv_dining (fst (Up\\<^sub>D s e))\n                          (snd (Up\\<^sub>D s e))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>s e.\n       \\<lbrakk>s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D\n                         (replicate N 0, replicate N 0);\n        inv_dining (fst s) (snd s); e \\<in> Tr\\<^sub>D N s\\<rbrakk>\n       \\<Longrightarrow> inv_dining (fst (Up\\<^sub>D s e))\n                          (snd (Up\\<^sub>D s e))", "case (rstep s e)"], ["proof (state)\nthis:\n  s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D (replicate N 0, replicate N 0)\n  inv_dining (fst s) (snd s)\n  e \\<in> Tr\\<^sub>D N s\n\ngoal (1 subgoal):\n 1. \\<And>s e.\n       \\<lbrakk>s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D\n                         (replicate N 0, replicate N 0);\n        inv_dining (fst s) (snd s); e \\<in> Tr\\<^sub>D N s\\<rbrakk>\n       \\<Longrightarrow> inv_dining (fst (Up\\<^sub>D s e))\n                          (snd (Up\\<^sub>D s e))", "from rstep(2,3)"], ["proof (chain)\npicking this:\n  inv_dining (fst s) (snd s)\n  e \\<in> Tr\\<^sub>D N s", "show ?case"], ["proof (prove)\nusing this:\n  inv_dining (fst s) (snd s)\n  e \\<in> Tr\\<^sub>D N s\n\ngoal (1 subgoal):\n 1. inv_dining (fst (Up\\<^sub>D s e)) (snd (Up\\<^sub>D s e))", "apply(auto simp add:dining_transitions_def phils_transitions_def forks_transitions_def\n                       lphil0_transitions_def rphil_transitions_def fork_transitions_def\n                       lphil0_state_update_def rphil_state_update_def fork_state_update_def\n                       dining_state_update_def phils_state_update_def forks_state_update_def\n                   split:if_splits prod.split)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0; inv_dining x1 x2; s = (x1, x2);\n        x1 ! 0 = Suc 0\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[0 := 2]) (x2[0 := Suc 0])\n 2. \\<And>x1 x2.\n       \\<lbrakk>x2 ! (N - Suc 0) = 0; e = picks 0 (N - Suc 0);\n        inv_dining x1 x2; s = (x1, x2); x1 ! 0 = 0\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[0 := Suc 0]) (x2[N - Suc 0 := 2])\n 3. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0; inv_dining x1 x2; s = (x1, x2);\n        x1 ! 0 = Suc 0; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[0 := 2]) (x2[0 := 2])\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0; inv_dining x1 x2;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[0 := 3]) (x2[0 := 0])\n 5. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2; inv_dining x1 x2;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[0 := 3]) (x2[0 := 0])\n 6. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        inv_dining x1 x2; s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[0 := 0]) (x2[N - Suc 0 := 0])\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>inv_dining x1 x2; s = (x1, x2); xa < N; x2 ! xa = 0;\n        e = picks xa xa; Suc 0 \\<le> xa; x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[xa := Suc 0]) (x2[xa := Suc 0])\n 8. \\<And>x1 x2 xa.\n       \\<lbrakk>inv_dining x1 x2; s = (x1, x2); xa < N; x2 ! xa = 0;\n        e = picks (Suc xa mod N) xa; Suc 0 \\<le> Suc xa mod N;\n        x1 ! (Suc xa mod N) = Suc 0; xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[Suc xa mod N := 2]) (x2[xa := 2])\n 9. \\<And>x1 x2 xb.\n       \\<lbrakk>inv_dining x1 x2; s = (x1, x2); e = putsdown xb xb; xb < N;\n        x2 ! xb = Suc 0; Suc 0 \\<le> xb; x1 ! xb = 3;\n        xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> inv_dining (x1[xb := 0]) (x2[xb := 0])\n 10. \\<And>x1 x2 xa.\n        \\<lbrakk>inv_dining x1 x2; s = (x1, x2);\n         e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n         Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n         xa = Suc xa mod N - Suc 0\\<rbrakk>\n        \\<Longrightarrow> inv_dining (x1[Suc xa mod N := 3]) (x2[xa := 0])", "unfolding inv_dining_def"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := Suc 0] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := Suc 0] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := Suc 0] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := Suc 0] ! 0 = 1) =\n                         (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := Suc 0] ! i = 0 \\<or>\n                             x2[0 := Suc 0] ! i = 1 \\<or>\n                             x2[0 := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := Suc 0]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>x2 ! (N - Suc 0) = 0; e = picks 0 (N - Suc 0);\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 2] ! Suc i = 1) =\n                             (x1[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 2] ! i = 2) =\n                             (x1[0 := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 2] ! 0 = 1) =\n                         (x1[0 := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 2] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := Suc 0] ! i = 0 \\<or>\n                             x1[0 := Suc 0] ! i = 1 \\<or>\n                             x1[0 := Suc 0] ! i = 2 \\<or>\n                             x1[0 := Suc 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 2]) = N \\<and>\n                         length (x1[0 := Suc 0]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 5. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 6. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 8. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 9. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 10. \\<And>x1 x2 xa.\n        \\<lbrakk>(\\<forall>i.\n                     Suc i < N \\<longrightarrow>\n                     (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                 (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                 (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                 (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                 (\\<forall>i<N.\n                     x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                 (\\<forall>i<N.\n                     x1 ! i = 0 \\<or>\n                     x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                 length x2 = N \\<and> length x1 = N;\n         s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n         Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n         xa = Suc xa mod N - Suc 0\\<rbrakk>\n        \\<Longrightarrow> (\\<forall>i.\n                              Suc i < N \\<longrightarrow>\n                              (x2[xa := 0] ! Suc i = 1) =\n                              (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                               0)) \\<and>\n                          (x2[xa := 0] ! (N - 1) = 2) =\n                          (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                          (\\<forall>i<N - 1.\n                              (x2[xa := 0] ! i = 2) =\n                              (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                          (x2[xa := 0] ! 0 = 1) =\n                          (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                          (\\<forall>i<N.\n                              x2[xa := 0] ! i = 0 \\<or>\n                              x2[xa := 0] ! i = 1 \\<or>\n                              x2[xa := 0] ! i = 2) \\<and>\n                          (\\<forall>i<N.\n                              x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                          length (x2[xa := 0]) = N \\<and>\n                          length (x1[Suc xa mod N := 3]) = N", "proof(goal_cases)"], ["proof (state)\ngoal (10 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := Suc 0] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := Suc 0] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := Suc 0] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := Suc 0] ! 0 = 1) =\n                         (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := Suc 0] ! i = 0 \\<or>\n                             x2[0 := Suc 0] ! i = 1 \\<or>\n                             x2[0 := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := Suc 0]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>x2 ! (N - Suc 0) = 0; e = picks 0 (N - Suc 0);\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 2] ! Suc i = 1) =\n                             (x1[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 2] ! i = 2) =\n                             (x1[0 := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 2] ! 0 = 1) =\n                         (x1[0 := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 2] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := Suc 0] ! i = 0 \\<or>\n                             x1[0 := Suc 0] ! i = 1 \\<or>\n                             x1[0 := Suc 0] ! i = 2 \\<or>\n                             x1[0 := Suc 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 2]) = N \\<and>\n                         length (x1[0 := Suc 0]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 5. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 6. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 8. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 9. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 10. \\<And>x1 x2 xa.\n        \\<lbrakk>(\\<forall>i.\n                     Suc i < N \\<longrightarrow>\n                     (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                 (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                 (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                 (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                 (\\<forall>i<N.\n                     x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                 (\\<forall>i<N.\n                     x1 ! i = 0 \\<or>\n                     x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                 length x2 = N \\<and> length x1 = N;\n         s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n         Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n         xa = Suc xa mod N - Suc 0\\<rbrakk>\n        \\<Longrightarrow> (\\<forall>i.\n                              Suc i < N \\<longrightarrow>\n                              (x2[xa := 0] ! Suc i = 1) =\n                              (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                               0)) \\<and>\n                          (x2[xa := 0] ! (N - 1) = 2) =\n                          (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                          (\\<forall>i<N - 1.\n                              (x2[xa := 0] ! i = 2) =\n                              (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                          (x2[xa := 0] ! 0 = 1) =\n                          (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                          (\\<forall>i<N.\n                              x2[xa := 0] ! i = 0 \\<or>\n                              x2[xa := 0] ! i = 1 \\<or>\n                              x2[xa := 0] ! i = 2) \\<and>\n                          (\\<forall>i<N.\n                              x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                          length (x2[xa := 0]) = N \\<and>\n                          length (x1[Suc xa mod N := 3]) = N", "case (1 ps fs)"], ["proof (state)\nthis:\n  fs ! 0 = 0\n  e = picks 0 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = Suc 0\n\ngoal (10 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := Suc 0] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := Suc 0] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := Suc 0] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := Suc 0] ! 0 = 1) =\n                         (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := Suc 0] ! i = 0 \\<or>\n                             x2[0 := Suc 0] ! i = 1 \\<or>\n                             x2[0 := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := Suc 0]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>x2 ! (N - Suc 0) = 0; e = picks 0 (N - Suc 0);\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 2] ! Suc i = 1) =\n                             (x1[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 2] ! i = 2) =\n                             (x1[0 := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 2] ! 0 = 1) =\n                         (x1[0 := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 2] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := Suc 0] ! i = 0 \\<or>\n                             x1[0 := Suc 0] ! i = 1 \\<or>\n                             x1[0 := Suc 0] ! i = 2 \\<or>\n                             x1[0 := Suc 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 2]) = N \\<and>\n                         length (x1[0 := Suc 0]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 5. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 6. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 8. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 9. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 10. \\<And>x1 x2 xa.\n        \\<lbrakk>(\\<forall>i.\n                     Suc i < N \\<longrightarrow>\n                     (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                 (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                 (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                 (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                 (\\<forall>i<N.\n                     x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                 (\\<forall>i<N.\n                     x1 ! i = 0 \\<or>\n                     x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                 length x2 = N \\<and> length x1 = N;\n         s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n         Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n         xa = Suc xa mod N - Suc 0\\<rbrakk>\n        \\<Longrightarrow> (\\<forall>i.\n                              Suc i < N \\<longrightarrow>\n                              (x2[xa := 0] ! Suc i = 1) =\n                              (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                               0)) \\<and>\n                          (x2[xa := 0] ! (N - 1) = 2) =\n                          (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                          (\\<forall>i<N - 1.\n                              (x2[xa := 0] ! i = 2) =\n                              (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                          (x2[xa := 0] ! 0 = 1) =\n                          (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                          (\\<forall>i<N.\n                              x2[xa := 0] ! i = 0 \\<or>\n                              x2[xa := 0] ! i = 1 \\<or>\n                              x2[xa := 0] ! i = 2) \\<and>\n                          (\\<forall>i<N.\n                              x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                              x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                          length (x2[xa := 0]) = N \\<and>\n                          length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  fs ! 0 = 0\n  e = picks 0 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = Suc 0", "show ?case"], ["proof (prove)\nusing this:\n  fs ! 0 = 0\n  e = picks 0 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = Suc 0\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[0 := Suc 0] ! Suc i = 1) =\n        (ps[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[0 := Suc 0] ! (N - 1) = 2) = (ps[0 := 2] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[0 := Suc 0] ! i = 2) = (ps[0 := 2] ! Suc i = 2)) \\<and>\n    (fs[0 := Suc 0] ! 0 = 1) = (ps[0 := 2] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[0 := Suc 0] ! i = 0 \\<or>\n        fs[0 := Suc 0] ! i = 1 \\<or> fs[0 := Suc 0] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := 2] ! i = 0 \\<or>\n        ps[0 := 2] ! i = 1 \\<or>\n        ps[0 := 2] ! i = 2 \\<or> ps[0 := 2] ! i = 3) \\<and>\n    length (fs[0 := Suc 0]) = N \\<and> length (ps[0 := 2]) = N", "by (simp add:nth_list_update) force"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs[0 := Suc 0] ! Suc i = 1) = (ps[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n  (fs[0 := Suc 0] ! (N - 1) = 2) = (ps[0 := 2] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1.\n      (fs[0 := Suc 0] ! i = 2) = (ps[0 := 2] ! Suc i = 2)) \\<and>\n  (fs[0 := Suc 0] ! 0 = 1) = (ps[0 := 2] ! 0 = 2) \\<and>\n  (\\<forall>i<N.\n      fs[0 := Suc 0] ! i = 0 \\<or>\n      fs[0 := Suc 0] ! i = 1 \\<or> fs[0 := Suc 0] ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps[0 := 2] ! i = 0 \\<or>\n      ps[0 := 2] ! i = 1 \\<or>\n      ps[0 := 2] ! i = 2 \\<or> ps[0 := 2] ! i = 3) \\<and>\n  length (fs[0 := Suc 0]) = N \\<and> length (ps[0 := 2]) = N\n\ngoal (9 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! (N - Suc 0) = 0; e = picks 0 (N - Suc 0);\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 2] ! Suc i = 1) =\n                             (x1[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 2] ! i = 2) =\n                             (x1[0 := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 2] ! 0 = 1) =\n                         (x1[0 := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 2] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := Suc 0] ! i = 0 \\<or>\n                             x1[0 := Suc 0] ! i = 1 \\<or>\n                             x1[0 := Suc 0] ! i = 2 \\<or>\n                             x1[0 := Suc 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 2]) = N \\<and>\n                         length (x1[0 := Suc 0]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 5. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 8. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 9. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (9 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! (N - Suc 0) = 0; e = picks 0 (N - Suc 0);\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 2] ! Suc i = 1) =\n                             (x1[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 2] ! i = 2) =\n                             (x1[0 := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 2] ! 0 = 1) =\n                         (x1[0 := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 2] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := Suc 0] ! i = 0 \\<or>\n                             x1[0 := Suc 0] ! i = 1 \\<or>\n                             x1[0 := Suc 0] ! i = 2 \\<or>\n                             x1[0 := Suc 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 2]) = N \\<and>\n                         length (x1[0 := Suc 0]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 5. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 8. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 9. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (2 ps fs)"], ["proof (state)\nthis:\n  fs ! (N - Suc 0) = 0\n  e = picks 0 (N - Suc 0)\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 0\n\ngoal (9 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! (N - Suc 0) = 0; e = picks 0 (N - Suc 0);\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 2] ! Suc i = 1) =\n                             (x1[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 2] ! i = 2) =\n                             (x1[0 := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 2] ! 0 = 1) =\n                         (x1[0 := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 2] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := Suc 0] ! i = 0 \\<or>\n                             x1[0 := Suc 0] ! i = 1 \\<or>\n                             x1[0 := Suc 0] ! i = 2 \\<or>\n                             x1[0 := Suc 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 2]) = N \\<and>\n                         length (x1[0 := Suc 0]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 5. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 8. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 9. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  fs ! (N - Suc 0) = 0\n  e = picks 0 (N - Suc 0)\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 0", "show ?case"], ["proof (prove)\nusing this:\n  fs ! (N - Suc 0) = 0\n  e = picks 0 (N - Suc 0)\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 0\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[N - Suc 0 := 2] ! Suc i = 1) =\n        (ps[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[N - Suc 0 := 2] ! (N - 1) = 2) =\n    (ps[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[N - Suc 0 := 2] ! i = 2) = (ps[0 := Suc 0] ! Suc i = 2)) \\<and>\n    (fs[N - Suc 0 := 2] ! 0 = 1) = (ps[0 := Suc 0] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[N - Suc 0 := 2] ! i = 0 \\<or>\n        fs[N - Suc 0 := 2] ! i = 1 \\<or> fs[N - Suc 0 := 2] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := Suc 0] ! i = 0 \\<or>\n        ps[0 := Suc 0] ! i = 1 \\<or>\n        ps[0 := Suc 0] ! i = 2 \\<or> ps[0 := Suc 0] ! i = 3) \\<and>\n    length (fs[N - Suc 0 := 2]) = N \\<and> length (ps[0 := Suc 0]) = N", "by (auto simp add:nth_list_update)"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs[N - Suc 0 := 2] ! Suc i = 1) =\n      (ps[0 := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n  (fs[N - Suc 0 := 2] ! (N - 1) = 2) =\n  (ps[0 := Suc 0] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1.\n      (fs[N - Suc 0 := 2] ! i = 2) = (ps[0 := Suc 0] ! Suc i = 2)) \\<and>\n  (fs[N - Suc 0 := 2] ! 0 = 1) = (ps[0 := Suc 0] ! 0 = 2) \\<and>\n  (\\<forall>i<N.\n      fs[N - Suc 0 := 2] ! i = 0 \\<or>\n      fs[N - Suc 0 := 2] ! i = 1 \\<or> fs[N - Suc 0 := 2] ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps[0 := Suc 0] ! i = 0 \\<or>\n      ps[0 := Suc 0] ! i = 1 \\<or>\n      ps[0 := Suc 0] ! i = 2 \\<or> ps[0 := Suc 0] ! i = 3) \\<and>\n  length (fs[N - Suc 0 := 2]) = N \\<and> length (ps[0 := Suc 0]) = N\n\ngoal (8 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 7. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 8. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (8 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 7. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 8. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (3 ps fs)"], ["proof (state)\nthis:\n  fs ! 0 = 0\n  e = picks 0 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = Suc 0\n  of_bool (N \\<noteq> Suc 0) = 0\n\ngoal (8 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>x2 ! 0 = 0; e = picks 0 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = Suc 0;\n        of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 2] ! Suc i = 1) =\n                             (x1[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 2] ! (N - 1) = 2) =\n                         (x1[0 := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 2] ! i = 2) =\n                             (x1[0 := 2] ! Suc i = 2)) \\<and>\n                         (x2[0 := 2] ! 0 = 1) = (x1[0 := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 2] ! i = 0 \\<or>\n                             x2[0 := 2] ! i = 1 \\<or>\n                             x2[0 := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 2] ! i = 0 \\<or>\n                             x1[0 := 2] ! i = 1 \\<or>\n                             x1[0 := 2] ! i = 2 \\<or>\n                             x1[0 := 2] ! i = 3) \\<and>\n                         length (x2[0 := 2]) = N \\<and>\n                         length (x1[0 := 2]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 4. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 7. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 8. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  fs ! 0 = 0\n  e = picks 0 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = Suc 0\n  of_bool (N \\<noteq> Suc 0) = 0", "show ?case"], ["proof (prove)\nusing this:\n  fs ! 0 = 0\n  e = picks 0 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = Suc 0\n  of_bool (N \\<noteq> Suc 0) = 0\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[0 := 2] ! Suc i = 1) = (ps[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[0 := 2] ! (N - 1) = 2) = (ps[0 := 2] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[0 := 2] ! i = 2) = (ps[0 := 2] ! Suc i = 2)) \\<and>\n    (fs[0 := 2] ! 0 = 1) = (ps[0 := 2] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[0 := 2] ! i = 0 \\<or>\n        fs[0 := 2] ! i = 1 \\<or> fs[0 := 2] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := 2] ! i = 0 \\<or>\n        ps[0 := 2] ! i = 1 \\<or>\n        ps[0 := 2] ! i = 2 \\<or> ps[0 := 2] ! i = 3) \\<and>\n    length (fs[0 := 2]) = N \\<and> length (ps[0 := 2]) = N", "using N_g1"], ["proof (prove)\nusing this:\n  fs ! 0 = 0\n  e = picks 0 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = Suc 0\n  of_bool (N \\<noteq> Suc 0) = 0\n  1 < N\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[0 := 2] ! Suc i = 1) = (ps[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[0 := 2] ! (N - 1) = 2) = (ps[0 := 2] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[0 := 2] ! i = 2) = (ps[0 := 2] ! Suc i = 2)) \\<and>\n    (fs[0 := 2] ! 0 = 1) = (ps[0 := 2] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[0 := 2] ! i = 0 \\<or>\n        fs[0 := 2] ! i = 1 \\<or> fs[0 := 2] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := 2] ! i = 0 \\<or>\n        ps[0 := 2] ! i = 1 \\<or>\n        ps[0 := 2] ! i = 2 \\<or> ps[0 := 2] ! i = 3) \\<and>\n    length (fs[0 := 2]) = N \\<and> length (ps[0 := 2]) = N", "by auto"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs[0 := 2] ! Suc i = 1) = (ps[0 := 2] ! Suc i \\<noteq> 0)) \\<and>\n  (fs[0 := 2] ! (N - 1) = 2) = (ps[0 := 2] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs[0 := 2] ! i = 2) = (ps[0 := 2] ! Suc i = 2)) \\<and>\n  (fs[0 := 2] ! 0 = 1) = (ps[0 := 2] ! 0 = 2) \\<and>\n  (\\<forall>i<N.\n      fs[0 := 2] ! i = 0 \\<or>\n      fs[0 := 2] ! i = 1 \\<or> fs[0 := 2] ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps[0 := 2] ! i = 0 \\<or>\n      ps[0 := 2] ! i = 1 \\<or>\n      ps[0 := 2] ! i = 2 \\<or> ps[0 := 2] ! i = 3) \\<and>\n  length (fs[0 := 2]) = N \\<and> length (ps[0 := 2]) = N\n\ngoal (7 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 6. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (7 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 6. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (4 ps fs)"], ["proof (state)\nthis:\n  e = putsdown 0 0\n  fs ! 0 = Suc 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 2\n\ngoal (7 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = Suc 0;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 3. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 6. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 7. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  e = putsdown 0 0\n  fs ! 0 = Suc 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 2", "show ?case"], ["proof (prove)\nusing this:\n  e = putsdown 0 0\n  fs ! 0 = Suc 0\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 2\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[0 := 0] ! Suc i = 1) = (ps[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[0 := 0] ! (N - 1) = 2) = (ps[0 := 3] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[0 := 0] ! i = 2) = (ps[0 := 3] ! Suc i = 2)) \\<and>\n    (fs[0 := 0] ! 0 = 1) = (ps[0 := 3] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[0 := 0] ! i = 0 \\<or>\n        fs[0 := 0] ! i = 1 \\<or> fs[0 := 0] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := 3] ! i = 0 \\<or>\n        ps[0 := 3] ! i = 1 \\<or>\n        ps[0 := 3] ! i = 2 \\<or> ps[0 := 3] ! i = 3) \\<and>\n    length (fs[0 := 0]) = N \\<and> length (ps[0 := 3]) = N", "by (simp add:nth_list_update) force"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs[0 := 0] ! Suc i = 1) = (ps[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n  (fs[0 := 0] ! (N - 1) = 2) = (ps[0 := 3] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs[0 := 0] ! i = 2) = (ps[0 := 3] ! Suc i = 2)) \\<and>\n  (fs[0 := 0] ! 0 = 1) = (ps[0 := 3] ! 0 = 2) \\<and>\n  (\\<forall>i<N.\n      fs[0 := 0] ! i = 0 \\<or>\n      fs[0 := 0] ! i = 1 \\<or> fs[0 := 0] ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps[0 := 3] ! i = 0 \\<or>\n      ps[0 := 3] ! i = 1 \\<or>\n      ps[0 := 3] ! i = 2 \\<or> ps[0 := 3] ! i = 3) \\<and>\n  length (fs[0 := 0]) = N \\<and> length (ps[0 := 3]) = N\n\ngoal (6 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 5. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (6 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 5. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (5 ps fs)"], ["proof (state)\nthis:\n  e = putsdown 0 0\n  fs ! 0 = 2\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 2\n  of_bool (N \\<noteq> Suc 0) = 0\n\ngoal (6 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 0; x2 ! 0 = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 2; of_bool (N \\<noteq> Suc 0) = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[0 := 0] ! Suc i = 1) =\n                             (x1[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[0 := 0] ! i = 2) =\n                             (x1[0 := 3] ! Suc i = 2)) \\<and>\n                         (x2[0 := 0] ! 0 = 1) = (x1[0 := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[0 := 0] ! i = 0 \\<or>\n                             x2[0 := 0] ! i = 1 \\<or>\n                             x2[0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 3] ! i = 0 \\<or>\n                             x1[0 := 3] ! i = 1 \\<or>\n                             x1[0 := 3] ! i = 2 \\<or>\n                             x1[0 := 3] ! i = 3) \\<and>\n                         length (x2[0 := 0]) = N \\<and>\n                         length (x1[0 := 3]) = N\n 2. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 5. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 6. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  e = putsdown 0 0\n  fs ! 0 = 2\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 2\n  of_bool (N \\<noteq> Suc 0) = 0", "show ?case"], ["proof (prove)\nusing this:\n  e = putsdown 0 0\n  fs ! 0 = 2\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 2\n  of_bool (N \\<noteq> Suc 0) = 0\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[0 := 0] ! Suc i = 1) = (ps[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[0 := 0] ! (N - 1) = 2) = (ps[0 := 3] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[0 := 0] ! i = 2) = (ps[0 := 3] ! Suc i = 2)) \\<and>\n    (fs[0 := 0] ! 0 = 1) = (ps[0 := 3] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[0 := 0] ! i = 0 \\<or>\n        fs[0 := 0] ! i = 1 \\<or> fs[0 := 0] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := 3] ! i = 0 \\<or>\n        ps[0 := 3] ! i = 1 \\<or>\n        ps[0 := 3] ! i = 2 \\<or> ps[0 := 3] ! i = 3) \\<and>\n    length (fs[0 := 0]) = N \\<and> length (ps[0 := 3]) = N", "using N_g1"], ["proof (prove)\nusing this:\n  e = putsdown 0 0\n  fs ! 0 = 2\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 2\n  of_bool (N \\<noteq> Suc 0) = 0\n  1 < N\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[0 := 0] ! Suc i = 1) = (ps[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[0 := 0] ! (N - 1) = 2) = (ps[0 := 3] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[0 := 0] ! i = 2) = (ps[0 := 3] ! Suc i = 2)) \\<and>\n    (fs[0 := 0] ! 0 = 1) = (ps[0 := 3] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[0 := 0] ! i = 0 \\<or>\n        fs[0 := 0] ! i = 1 \\<or> fs[0 := 0] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := 3] ! i = 0 \\<or>\n        ps[0 := 3] ! i = 1 \\<or>\n        ps[0 := 3] ! i = 2 \\<or> ps[0 := 3] ! i = 3) \\<and>\n    length (fs[0 := 0]) = N \\<and> length (ps[0 := 3]) = N", "by linarith"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs[0 := 0] ! Suc i = 1) = (ps[0 := 3] ! Suc i \\<noteq> 0)) \\<and>\n  (fs[0 := 0] ! (N - 1) = 2) = (ps[0 := 3] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs[0 := 0] ! i = 2) = (ps[0 := 3] ! Suc i = 2)) \\<and>\n  (fs[0 := 0] ! 0 = 1) = (ps[0 := 3] ! 0 = 2) \\<and>\n  (\\<forall>i<N.\n      fs[0 := 0] ! i = 0 \\<or>\n      fs[0 := 0] ! i = 1 \\<or> fs[0 := 0] ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps[0 := 3] ! i = 0 \\<or>\n      ps[0 := 3] ! i = 1 \\<or>\n      ps[0 := 3] ! i = 2 \\<or> ps[0 := 3] ! i = 3) \\<and>\n  length (fs[0 := 0]) = N \\<and> length (ps[0 := 3]) = N\n\ngoal (5 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 4. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 4. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (6 ps fs)"], ["proof (state)\nthis:\n  e = putsdown 0 (N - Suc 0)\n  fs ! (N - Suc 0) = 2\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 3\n\ngoal (5 subgoals):\n 1. \\<And>x1 x2.\n       \\<lbrakk>e = putsdown 0 (N - Suc 0); x2 ! (N - Suc 0) = 2;\n        (\\<forall>i.\n            Suc i < N \\<longrightarrow>\n            (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n        (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n        (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n        (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n        (\\<forall>i<N. x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n        (\\<forall>i<N.\n            x1 ! i = 0 \\<or>\n            x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n        length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); x1 ! 0 = 3\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[N - Suc 0 := 0] ! Suc i = 1) =\n                             (x1[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[N - Suc 0 := 0] ! (N - 1) = 2) =\n                         (x1[0 := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[N - Suc 0 := 0] ! i = 2) =\n                             (x1[0 := 0] ! Suc i = 2)) \\<and>\n                         (x2[N - Suc 0 := 0] ! 0 = 1) =\n                         (x1[0 := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[N - Suc 0 := 0] ! i = 0 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 1 \\<or>\n                             x2[N - Suc 0 := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[0 := 0] ! i = 0 \\<or>\n                             x1[0 := 0] ! i = 1 \\<or>\n                             x1[0 := 0] ! i = 2 \\<or>\n                             x1[0 := 0] ! i = 3) \\<and>\n                         length (x2[N - Suc 0 := 0]) = N \\<and>\n                         length (x1[0 := 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 4. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 5. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  e = putsdown 0 (N - Suc 0)\n  fs ! (N - Suc 0) = 2\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 3", "show ?case"], ["proof (prove)\nusing this:\n  e = putsdown 0 (N - Suc 0)\n  fs ! (N - Suc 0) = 2\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  ps ! 0 = 3\n\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs[N - Suc 0 := 0] ! Suc i = 1) =\n        (ps[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n    (fs[N - Suc 0 := 0] ! (N - 1) = 2) = (ps[0 := 0] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1.\n        (fs[N - Suc 0 := 0] ! i = 2) = (ps[0 := 0] ! Suc i = 2)) \\<and>\n    (fs[N - Suc 0 := 0] ! 0 = 1) = (ps[0 := 0] ! 0 = 2) \\<and>\n    (\\<forall>i<N.\n        fs[N - Suc 0 := 0] ! i = 0 \\<or>\n        fs[N - Suc 0 := 0] ! i = 1 \\<or> fs[N - Suc 0 := 0] ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps[0 := 0] ! i = 0 \\<or>\n        ps[0 := 0] ! i = 1 \\<or>\n        ps[0 := 0] ! i = 2 \\<or> ps[0 := 0] ! i = 3) \\<and>\n    length (fs[N - Suc 0 := 0]) = N \\<and> length (ps[0 := 0]) = N", "by (auto simp add:nth_list_update)"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs[N - Suc 0 := 0] ! Suc i = 1) =\n      (ps[0 := 0] ! Suc i \\<noteq> 0)) \\<and>\n  (fs[N - Suc 0 := 0] ! (N - 1) = 2) = (ps[0 := 0] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1.\n      (fs[N - Suc 0 := 0] ! i = 2) = (ps[0 := 0] ! Suc i = 2)) \\<and>\n  (fs[N - Suc 0 := 0] ! 0 = 1) = (ps[0 := 0] ! 0 = 2) \\<and>\n  (\\<forall>i<N.\n      fs[N - Suc 0 := 0] ! i = 0 \\<or>\n      fs[N - Suc 0 := 0] ! i = 1 \\<or> fs[N - Suc 0 := 0] ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps[0 := 0] ! i = 0 \\<or>\n      ps[0 := 0] ! i = 1 \\<or>\n      ps[0 := 0] ! i = 2 \\<or> ps[0 := 0] ! i = 3) \\<and>\n  length (fs[N - Suc 0 := 0]) = N \\<and> length (ps[0 := 0]) = N\n\ngoal (4 subgoals):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 3. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 3. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (7 ps fs i)"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  i < N\n  fs ! i = 0\n  e = picks i i\n  Suc 0 \\<le> i\n  ps ! i = 0\n\ngoal (4 subgoals):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks xa xa; Suc 0 \\<le> xa;\n        x1 ! xa = 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := Suc 0] ! Suc i = 1) =\n                             (x1[xa := Suc 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xa := Suc 0] ! (N - 1) = 2) =\n                         (x1[xa := Suc 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := Suc 0] ! i = 2) =\n                             (x1[xa := Suc 0] ! Suc i = 2)) \\<and>\n                         (x2[xa := Suc 0] ! 0 = 1) =\n                         (x1[xa := Suc 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := Suc 0] ! i = 0 \\<or>\n                             x2[xa := Suc 0] ! i = 1 \\<or>\n                             x2[xa := Suc 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xa := Suc 0] ! i = 0 \\<or>\n                             x1[xa := Suc 0] ! i = 1 \\<or>\n                             x1[xa := Suc 0] ! i = 2 \\<or>\n                             x1[xa := Suc 0] ! i = 3) \\<and>\n                         length (x2[xa := Suc 0]) = N \\<and>\n                         length (x1[xa := Suc 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 3. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 4. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  i < N\n  fs ! i = 0\n  e = picks i i\n  Suc 0 \\<le> i\n  ps ! i = 0", "show ?case"], ["proof (prove)\nusing this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  i < N\n  fs ! i = 0\n  e = picks i i\n  Suc 0 \\<le> i\n  ps ! i = 0\n\ngoal (1 subgoal):\n 1. (\\<forall>ia.\n        Suc ia < N \\<longrightarrow>\n        (fs[i := Suc 0] ! Suc ia = 1) =\n        (ps[i := Suc 0] ! Suc ia \\<noteq> 0)) \\<and>\n    (fs[i := Suc 0] ! (N - 1) = 2) = (ps[i := Suc 0] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>ia<N - 1.\n        (fs[i := Suc 0] ! ia = 2) = (ps[i := Suc 0] ! Suc ia = 2)) \\<and>\n    (fs[i := Suc 0] ! 0 = 1) = (ps[i := Suc 0] ! 0 = 2) \\<and>\n    (\\<forall>ia<N.\n        fs[i := Suc 0] ! ia = 0 \\<or>\n        fs[i := Suc 0] ! ia = 1 \\<or> fs[i := Suc 0] ! ia = 2) \\<and>\n    (\\<forall>ia<N.\n        ps[i := Suc 0] ! ia = 0 \\<or>\n        ps[i := Suc 0] ! ia = 1 \\<or>\n        ps[i := Suc 0] ! ia = 2 \\<or> ps[i := Suc 0] ! ia = 3) \\<and>\n    length (fs[i := Suc 0]) = N \\<and> length (ps[i := Suc 0]) = N", "apply (simp add:nth_list_update, intro impI conjI, simp_all)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>(\\<forall>i.\n                 Suc i < N \\<longrightarrow>\n                 (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n             fs ! 0 \\<noteq> Suc 0 \\<and>\n             (\\<forall>i<N.\n                 fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n             (\\<forall>i<N.\n                 ps ! i = 0 \\<or>\n                 ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n     fs ! (N - Suc 0) = 0; ps ! (N - Suc 0) = 0; ps ! 0 = 0; i = N - Suc 0;\n     (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n     length fs = N \\<and> length ps = N;\n     s = (ps, fs); e = picks (N - Suc 0) (N - Suc 0);\n     Suc 0 \\<le> N - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i.\n                         N - Suc 0 = Suc i \\<longrightarrow>\n                         ps ! Suc i \\<noteq> 2\n 2. \\<lbrakk>(\\<forall>i.\n                 Suc i < N \\<longrightarrow>\n                 (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n             fs ! 0 \\<noteq> Suc 0 \\<and>\n             (\\<forall>i<N.\n                 fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n             (\\<forall>i<N.\n                 ps ! i = 0 \\<or>\n                 ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n     fs ! (N - Suc 0) = 0; ps ! (N - Suc 0) = 0; ps ! 0 = 0; i = N - Suc 0;\n     (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n     length fs = N \\<and> length ps = N;\n     s = (ps, fs); e = picks (N - Suc 0) (N - Suc 0);\n     Suc 0 \\<le> N - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i.\n                         N - Suc 0 \\<noteq> i \\<longrightarrow>\n                         i < N \\<longrightarrow>\n                         fs ! i = 0 \\<or>\n                         fs ! i = Suc 0 \\<or> ps ! Suc i = 2\n 3. \\<lbrakk>(\\<forall>i.\n                 Suc i < N \\<longrightarrow>\n                 (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n             (fs ! (N - Suc 0) = 2) = (0 < ps ! 0) \\<and>\n             (fs ! 0 = Suc 0) = (ps ! 0 = 2) \\<and>\n             (\\<forall>i<N.\n                 fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n             (\\<forall>i<N.\n                 ps ! i = 0 \\<or>\n                 ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n     i \\<noteq> N - Suc 0;\n     (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n     length fs = N \\<and> length ps = N;\n     s = (ps, fs); i < N; fs ! i = 0; e = picks i i; Suc 0 \\<le> i;\n     ps ! i = 0\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ia.\n                         (i = ia \\<longrightarrow>\n                          ia < N - Suc 0 \\<longrightarrow>\n                          ps ! Suc ia \\<noteq> 2) \\<and>\n                         (i \\<noteq> ia \\<longrightarrow>\n                          i = Suc ia \\<longrightarrow>\n                          ia < N - Suc 0 \\<longrightarrow>\n                          ps ! Suc ia \\<noteq> 2)", "by  auto[1] (metis N_pos Suc_pred less_antisym, metis zero_neq_numeral)"], ["proof (state)\nthis:\n  (\\<forall>ia.\n      Suc ia < N \\<longrightarrow>\n      (fs[i := Suc 0] ! Suc ia = 1) =\n      (ps[i := Suc 0] ! Suc ia \\<noteq> 0)) \\<and>\n  (fs[i := Suc 0] ! (N - 1) = 2) = (ps[i := Suc 0] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>ia<N - 1.\n      (fs[i := Suc 0] ! ia = 2) = (ps[i := Suc 0] ! Suc ia = 2)) \\<and>\n  (fs[i := Suc 0] ! 0 = 1) = (ps[i := Suc 0] ! 0 = 2) \\<and>\n  (\\<forall>ia<N.\n      fs[i := Suc 0] ! ia = 0 \\<or>\n      fs[i := Suc 0] ! ia = 1 \\<or> fs[i := Suc 0] ! ia = 2) \\<and>\n  (\\<forall>ia<N.\n      ps[i := Suc 0] ! ia = 0 \\<or>\n      ps[i := Suc 0] ! ia = 1 \\<or>\n      ps[i := Suc 0] ! ia = 2 \\<or> ps[i := Suc 0] ! ia = 3) \\<and>\n  length (fs[i := Suc 0]) = N \\<and> length (ps[i := Suc 0]) = N\n\ngoal (3 subgoals):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 2. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 2. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (8 ps fs i)"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  i < N\n  fs ! i = 0\n  e = picks (Suc i mod N) i\n  Suc 0 \\<le> Suc i mod N\n  ps ! (Suc i mod N) = Suc 0\n  i = Suc i mod N - Suc 0\n\ngoal (3 subgoals):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); xa < N; x2 ! xa = 0; e = picks (Suc xa mod N) xa;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = Suc 0;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 2] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 2] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 2] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 2] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 2] ! i = 2) =\n                             (x1[Suc xa mod N := 2] ! Suc i = 2)) \\<and>\n                         (x2[xa := 2] ! 0 = 1) =\n                         (x1[Suc xa mod N := 2] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 2] ! i = 0 \\<or>\n                             x2[xa := 2] ! i = 1 \\<or>\n                             x2[xa := 2] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 2] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 2] ! i = 3) \\<and>\n                         length (x2[xa := 2]) = N \\<and>\n                         length (x1[Suc xa mod N := 2]) = N\n 2. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 3. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  i < N\n  fs ! i = 0\n  e = picks (Suc i mod N) i\n  Suc 0 \\<le> Suc i mod N\n  ps ! (Suc i mod N) = Suc 0\n  i = Suc i mod N - Suc 0", "show ?case"], ["proof (prove)\nusing this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  i < N\n  fs ! i = 0\n  e = picks (Suc i mod N) i\n  Suc 0 \\<le> Suc i mod N\n  ps ! (Suc i mod N) = Suc 0\n  i = Suc i mod N - Suc 0\n\ngoal (1 subgoal):\n 1. (\\<forall>ia.\n        Suc ia < N \\<longrightarrow>\n        (fs[i := 2] ! Suc ia = 1) =\n        (ps[Suc i mod N := 2] ! Suc ia \\<noteq> 0)) \\<and>\n    (fs[i := 2] ! (N - 1) = 2) =\n    (ps[Suc i mod N := 2] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>ia<N - 1.\n        (fs[i := 2] ! ia = 2) = (ps[Suc i mod N := 2] ! Suc ia = 2)) \\<and>\n    (fs[i := 2] ! 0 = 1) = (ps[Suc i mod N := 2] ! 0 = 2) \\<and>\n    (\\<forall>ia<N.\n        fs[i := 2] ! ia = 0 \\<or>\n        fs[i := 2] ! ia = 1 \\<or> fs[i := 2] ! ia = 2) \\<and>\n    (\\<forall>ia<N.\n        ps[Suc i mod N := 2] ! ia = 0 \\<or>\n        ps[Suc i mod N := 2] ! ia = 1 \\<or>\n        ps[Suc i mod N := 2] ! ia = 2 \\<or>\n        ps[Suc i mod N := 2] ! ia = 3) \\<and>\n    length (fs[i := 2]) = N \\<and> length (ps[Suc i mod N := 2]) = N", "apply (simp add:nth_list_update, intro impI conjI allI, simp_all)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n                fs ! 0 \\<noteq> Suc 0 \\<and>\n                (\\<forall>i<N.\n                    fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    ps ! i = 0 \\<or>\n                    ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n        fs ! Suc ia = 0; Suc 0 \\<le> Suc (Suc ia) mod N;\n        ps ! (Suc (Suc ia) mod N) = Suc 0;\n        Suc ia = Suc (Suc ia) mod N - Suc 0; ps ! 0 = 0; i = Suc ia;\n        N - Suc 0 = Suc ia;\n        (\\<forall>i<Suc ia. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n        length fs = N \\<and> length ps = N;\n        s = (ps, fs); Suc ia < N;\n        e = picks (Suc (Suc ia) mod N) (Suc ia)\\<rbrakk>\n       \\<Longrightarrow> ps ! Suc ia = 0\n 2. \\<And>ia.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n                (fs ! (N - Suc 0) = 2) = (0 < ps ! 0) \\<and>\n                (fs ! 0 = Suc 0) = (ps ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    ps ! i = 0 \\<or>\n                    ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n        fs ! Suc ia = 0; ps ! Suc (Suc ia) = Suc 0;\n        Suc ia \\<noteq> N - Suc 0; i = Suc ia;\n        (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n        length fs = N \\<and> length ps = N;\n        s = (ps, fs); Suc ia < N; e = picks (Suc (Suc ia)) (Suc ia)\\<rbrakk>\n       \\<Longrightarrow> ps ! Suc ia = 0", "by (metis \"8\"(1) zero_neq_one)+"], ["proof (state)\nthis:\n  (\\<forall>ia.\n      Suc ia < N \\<longrightarrow>\n      (fs[i := 2] ! Suc ia = 1) =\n      (ps[Suc i mod N := 2] ! Suc ia \\<noteq> 0)) \\<and>\n  (fs[i := 2] ! (N - 1) = 2) = (ps[Suc i mod N := 2] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>ia<N - 1.\n      (fs[i := 2] ! ia = 2) = (ps[Suc i mod N := 2] ! Suc ia = 2)) \\<and>\n  (fs[i := 2] ! 0 = 1) = (ps[Suc i mod N := 2] ! 0 = 2) \\<and>\n  (\\<forall>ia<N.\n      fs[i := 2] ! ia = 0 \\<or>\n      fs[i := 2] ! ia = 1 \\<or> fs[i := 2] ! ia = 2) \\<and>\n  (\\<forall>ia<N.\n      ps[Suc i mod N := 2] ! ia = 0 \\<or>\n      ps[Suc i mod N := 2] ! ia = 1 \\<or>\n      ps[Suc i mod N := 2] ! ia = 2 \\<or>\n      ps[Suc i mod N := 2] ! ia = 3) \\<and>\n  length (fs[i := 2]) = N \\<and> length (ps[Suc i mod N := 2]) = N\n\ngoal (2 subgoals):\n 1. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (9 ps fs i)"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  e = putsdown i i\n  i < N\n  fs ! i = Suc 0\n  Suc 0 \\<le> i\n  ps ! i = 3\n  i \\<noteq> i - Suc 0\n\ngoal (2 subgoals):\n 1. \\<And>x1 x2 xb.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown xb xb; xb < N; x2 ! xb = Suc 0;\n        Suc 0 \\<le> xb; x1 ! xb = 3; xb \\<noteq> xb - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xb := 0] ! Suc i = 1) =\n                             (x1[xb := 0] ! Suc i \\<noteq> 0)) \\<and>\n                         (x2[xb := 0] ! (N - 1) = 2) =\n                         (x1[xb := 0] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xb := 0] ! i = 2) =\n                             (x1[xb := 0] ! Suc i = 2)) \\<and>\n                         (x2[xb := 0] ! 0 = 1) =\n                         (x1[xb := 0] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xb := 0] ! i = 0 \\<or>\n                             x2[xb := 0] ! i = 1 \\<or>\n                             x2[xb := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[xb := 0] ! i = 0 \\<or>\n                             x1[xb := 0] ! i = 1 \\<or>\n                             x1[xb := 0] ! i = 2 \\<or>\n                             x1[xb := 0] ! i = 3) \\<and>\n                         length (x2[xb := 0]) = N \\<and>\n                         length (x1[xb := 0]) = N\n 2. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  e = putsdown i i\n  i < N\n  fs ! i = Suc 0\n  Suc 0 \\<le> i\n  ps ! i = 3\n  i \\<noteq> i - Suc 0", "show ?case"], ["proof (prove)\nusing this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  e = putsdown i i\n  i < N\n  fs ! i = Suc 0\n  Suc 0 \\<le> i\n  ps ! i = 3\n  i \\<noteq> i - Suc 0\n\ngoal (1 subgoal):\n 1. (\\<forall>ia.\n        Suc ia < N \\<longrightarrow>\n        (fs[i := 0] ! Suc ia = 1) = (ps[i := 0] ! Suc ia \\<noteq> 0)) \\<and>\n    (fs[i := 0] ! (N - 1) = 2) = (ps[i := 0] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>ia<N - 1.\n        (fs[i := 0] ! ia = 2) = (ps[i := 0] ! Suc ia = 2)) \\<and>\n    (fs[i := 0] ! 0 = 1) = (ps[i := 0] ! 0 = 2) \\<and>\n    (\\<forall>ia<N.\n        fs[i := 0] ! ia = 0 \\<or>\n        fs[i := 0] ! ia = 1 \\<or> fs[i := 0] ! ia = 2) \\<and>\n    (\\<forall>ia<N.\n        ps[i := 0] ! ia = 0 \\<or>\n        ps[i := 0] ! ia = 1 \\<or>\n        ps[i := 0] ! ia = 2 \\<or> ps[i := 0] ! ia = 3) \\<and>\n    length (fs[i := 0]) = N \\<and> length (ps[i := 0]) = N", "apply (simp add:nth_list_update, intro impI conjI allI, simp_all)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n                fs ! 0 \\<noteq> Suc 0 \\<and>\n                (\\<forall>i<N.\n                    fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    ps ! i = 0 \\<or>\n                    ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n        fs ! (N - Suc 0) = Suc 0; ps ! (N - Suc 0) = 3;\n        N - Suc 0 \\<noteq> N - Suc (Suc 0); ps ! 0 = 0; i = N - Suc 0;\n        N - Suc 0 \\<noteq> ia; ia < N;\n        (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n        length fs = N \\<and> length ps = N;\n        s = (ps, fs); e = putsdown (N - Suc 0) (N - Suc 0);\n        Suc 0 \\<le> N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> fs ! ia = 0 \\<or>\n                         fs ! ia = Suc 0 \\<or> ps ! Suc ia = 2\n 2. \\<And>ia.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n                (fs ! (N - Suc 0) = 2) = (0 < ps ! 0) \\<and>\n                (fs ! 0 = Suc 0) = (ps ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    ps ! i = 0 \\<or>\n                    ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n        fs ! ia = Suc 0; ps ! ia = 3; ia \\<noteq> ia - Suc 0; i = ia;\n        ia < N - Suc 0;\n        (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n        length fs = N \\<and> length ps = N;\n        s = (ps, fs); e = putsdown ia ia; ia < N; Suc 0 \\<le> ia\\<rbrakk>\n       \\<Longrightarrow> ps ! Suc ia \\<noteq> 2", "by (metis N_pos Suc_pred less_antisym) (metis n_not_Suc_n numeral_2_eq_2)"], ["proof (state)\nthis:\n  (\\<forall>ia.\n      Suc ia < N \\<longrightarrow>\n      (fs[i := 0] ! Suc ia = 1) = (ps[i := 0] ! Suc ia \\<noteq> 0)) \\<and>\n  (fs[i := 0] ! (N - 1) = 2) = (ps[i := 0] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>ia<N - 1.\n      (fs[i := 0] ! ia = 2) = (ps[i := 0] ! Suc ia = 2)) \\<and>\n  (fs[i := 0] ! 0 = 1) = (ps[i := 0] ! 0 = 2) \\<and>\n  (\\<forall>ia<N.\n      fs[i := 0] ! ia = 0 \\<or>\n      fs[i := 0] ! ia = 1 \\<or> fs[i := 0] ! ia = 2) \\<and>\n  (\\<forall>ia<N.\n      ps[i := 0] ! ia = 0 \\<or>\n      ps[i := 0] ! ia = 1 \\<or>\n      ps[i := 0] ! ia = 2 \\<or> ps[i := 0] ! ia = 3) \\<and>\n  length (fs[i := 0]) = N \\<and> length (ps[i := 0]) = N\n\ngoal (1 subgoal):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "case (10 ps fs i)"], ["proof (state)\nthis:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  e = putsdown (Suc i mod N) i\n  i < N\n  fs ! i = 2\n  Suc 0 \\<le> Suc i mod N\n  ps ! (Suc i mod N) = 2\n  i = Suc i mod N - Suc 0\n\ngoal (1 subgoal):\n 1. \\<And>x1 x2 xa.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (x2 ! Suc i = 1) = (x1 ! Suc i \\<noteq> 0)) \\<and>\n                (x2 ! (N - 1) = 2) = (x1 ! 0 \\<noteq> 0) \\<and>\n                (\\<forall>i<N - 1. (x2 ! i = 2) = (x1 ! Suc i = 2)) \\<and>\n                (x2 ! 0 = 1) = (x1 ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    x2 ! i = 0 \\<or> x2 ! i = 1 \\<or> x2 ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    x1 ! i = 0 \\<or>\n                    x1 ! i = 1 \\<or> x1 ! i = 2 \\<or> x1 ! i = 3) \\<and>\n                length x2 = N \\<and> length x1 = N;\n        s = (x1, x2); e = putsdown (Suc xa mod N) xa; xa < N; x2 ! xa = 2;\n        Suc 0 \\<le> Suc xa mod N; x1 ! (Suc xa mod N) = 2;\n        xa = Suc xa mod N - Suc 0\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i.\n                             Suc i < N \\<longrightarrow>\n                             (x2[xa := 0] ! Suc i = 1) =\n                             (x1[Suc xa mod N := 3] ! Suc i \\<noteq>\n                              0)) \\<and>\n                         (x2[xa := 0] ! (N - 1) = 2) =\n                         (x1[Suc xa mod N := 3] ! 0 \\<noteq> 0) \\<and>\n                         (\\<forall>i<N - 1.\n                             (x2[xa := 0] ! i = 2) =\n                             (x1[Suc xa mod N := 3] ! Suc i = 2)) \\<and>\n                         (x2[xa := 0] ! 0 = 1) =\n                         (x1[Suc xa mod N := 3] ! 0 = 2) \\<and>\n                         (\\<forall>i<N.\n                             x2[xa := 0] ! i = 0 \\<or>\n                             x2[xa := 0] ! i = 1 \\<or>\n                             x2[xa := 0] ! i = 2) \\<and>\n                         (\\<forall>i<N.\n                             x1[Suc xa mod N := 3] ! i = 0 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 1 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 2 \\<or>\n                             x1[Suc xa mod N := 3] ! i = 3) \\<and>\n                         length (x2[xa := 0]) = N \\<and>\n                         length (x1[Suc xa mod N := 3]) = N", "then"], ["proof (chain)\npicking this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  e = putsdown (Suc i mod N) i\n  i < N\n  fs ! i = 2\n  Suc 0 \\<le> Suc i mod N\n  ps ! (Suc i mod N) = 2\n  i = Suc i mod N - Suc 0", "show ?case"], ["proof (prove)\nusing this:\n  (\\<forall>i.\n      Suc i < N \\<longrightarrow>\n      (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n  (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n  (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n  (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n  (\\<forall>i<N.\n      ps ! i = 0 \\<or> ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n  length fs = N \\<and> length ps = N\n  s = (ps, fs)\n  e = putsdown (Suc i mod N) i\n  i < N\n  fs ! i = 2\n  Suc 0 \\<le> Suc i mod N\n  ps ! (Suc i mod N) = 2\n  i = Suc i mod N - Suc 0\n\ngoal (1 subgoal):\n 1. (\\<forall>ia.\n        Suc ia < N \\<longrightarrow>\n        (fs[i := 0] ! Suc ia = 1) =\n        (ps[Suc i mod N := 3] ! Suc ia \\<noteq> 0)) \\<and>\n    (fs[i := 0] ! (N - 1) = 2) =\n    (ps[Suc i mod N := 3] ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>ia<N - 1.\n        (fs[i := 0] ! ia = 2) = (ps[Suc i mod N := 3] ! Suc ia = 2)) \\<and>\n    (fs[i := 0] ! 0 = 1) = (ps[Suc i mod N := 3] ! 0 = 2) \\<and>\n    (\\<forall>ia<N.\n        fs[i := 0] ! ia = 0 \\<or>\n        fs[i := 0] ! ia = 1 \\<or> fs[i := 0] ! ia = 2) \\<and>\n    (\\<forall>ia<N.\n        ps[Suc i mod N := 3] ! ia = 0 \\<or>\n        ps[Suc i mod N := 3] ! ia = 1 \\<or>\n        ps[Suc i mod N := 3] ! ia = 2 \\<or>\n        ps[Suc i mod N := 3] ! ia = 3) \\<and>\n    length (fs[i := 0]) = N \\<and> length (ps[Suc i mod N := 3]) = N", "apply (simp add:nth_list_update, intro impI conjI allI, simp_all)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ia.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n                fs ! Suc ia = 2 \\<and>\n                (fs ! 0 = Suc 0) = (ps ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    ps ! i = 0 \\<or>\n                    ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n        0 < ps ! 0; Suc 0 \\<le> Suc (Suc ia) mod N;\n        ps ! (Suc (Suc ia) mod N) = 2; Suc ia = Suc (Suc ia) mod N - Suc 0;\n        i = Suc ia; N - Suc 0 = Suc ia;\n        (\\<forall>i<Suc ia. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n        length fs = N \\<and> length ps = N;\n        s = (ps, fs); e = putsdown (Suc (Suc ia) mod N) (Suc ia);\n        Suc ia < N\\<rbrakk>\n       \\<Longrightarrow> ps ! Suc ia = 0\n 2. \\<And>ia.\n       \\<lbrakk>(\\<forall>i.\n                    Suc i < N \\<longrightarrow>\n                    (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n                (fs ! (N - Suc 0) = 2) = (0 < ps ! 0) \\<and>\n                (fs ! 0 = Suc 0) = (ps ! 0 = 2) \\<and>\n                (\\<forall>i<N.\n                    fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n                (\\<forall>i<N.\n                    ps ! i = 0 \\<or>\n                    ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3);\n        ps ! Suc (Suc ia) = 2; Suc ia \\<noteq> N - Suc 0; i = Suc ia;\n        (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n        length fs = N \\<and> length ps = N;\n        s = (ps, fs); e = putsdown (Suc (Suc ia)) (Suc ia);\n        Suc ia < N\\<rbrakk>\n       \\<Longrightarrow> ps ! Suc ia = 0", "by (metis \"10\"(1) \"10\"(5) One_nat_def n_not_Suc_n numeral_2_eq_2)+"], ["proof (state)\nthis:\n  (\\<forall>ia.\n      Suc ia < N \\<longrightarrow>\n      (fs[i := 0] ! Suc ia = 1) =\n      (ps[Suc i mod N := 3] ! Suc ia \\<noteq> 0)) \\<and>\n  (fs[i := 0] ! (N - 1) = 2) = (ps[Suc i mod N := 3] ! 0 \\<noteq> 0) \\<and>\n  (\\<forall>ia<N - 1.\n      (fs[i := 0] ! ia = 2) = (ps[Suc i mod N := 3] ! Suc ia = 2)) \\<and>\n  (fs[i := 0] ! 0 = 1) = (ps[Suc i mod N := 3] ! 0 = 2) \\<and>\n  (\\<forall>ia<N.\n      fs[i := 0] ! ia = 0 \\<or>\n      fs[i := 0] ! ia = 1 \\<or> fs[i := 0] ! ia = 2) \\<and>\n  (\\<forall>ia<N.\n      ps[Suc i mod N := 3] ! ia = 0 \\<or>\n      ps[Suc i mod N := 3] ! ia = 1 \\<or>\n      ps[Suc i mod N := 3] ! ia = 2 \\<or>\n      ps[Suc i mod N := 3] ! ia = 3) \\<and>\n  length (fs[i := 0]) = N \\<and> length (ps[Suc i mod N := 3]) = N\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  inv_dining (fst (Up\\<^sub>D s e)) (snd (Up\\<^sub>D s e))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma inv_implies_DF:\"inv_dining ps fs \\<Longrightarrow> Tr\\<^sub>D N (ps, fs) \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. inv_dining ps fs \\<Longrightarrow> Tr\\<^sub>D N (ps, fs) \\<noteq> {}", "unfolding inv_dining_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs ! Suc i = 1) = (ps ! Suc i \\<noteq> 0)) \\<and>\n    (fs ! (N - 1) = 2) = (ps ! 0 \\<noteq> 0) \\<and>\n    (\\<forall>i<N - 1. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n    (fs ! 0 = 1) = (ps ! 0 = 2) \\<and>\n    (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = 1 \\<or> fs ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps ! i = 0 \\<or>\n        ps ! i = 1 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n    length fs = N \\<and> length ps = N \\<Longrightarrow>\n    Tr\\<^sub>D N (ps, fs) \\<noteq> {}", "apply(simp add:dining_transitions_def phils_transitions_def forks_transitions_def\n                 lphil0_transitions_def\n             split: if_splits prod.splits)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>i.\n        Suc i < N \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)) \\<and>\n    (fs ! (N - Suc 0) = 2) = (0 < ps ! 0) \\<and>\n    (\\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)) \\<and>\n    (fs ! 0 = Suc 0) = (ps ! 0 = 2) \\<and>\n    (\\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2) \\<and>\n    (\\<forall>i<N.\n        ps ! i = 0 \\<or>\n        ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3) \\<and>\n    length fs = N \\<and> length ps = N \\<Longrightarrow>\n    (ps ! 0 = 3 \\<longrightarrow>\n     ({putsdown 0 (N - Suc 0)} \\<union>\n      (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n     (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n     {}) \\<and>\n    (ps ! 0 \\<noteq> 3 \\<longrightarrow>\n     (ps ! 0 = 2 \\<longrightarrow>\n      ({putsdown 0 0} \\<union>\n       (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n      {}) \\<and>\n     (ps ! 0 \\<noteq> 2 \\<longrightarrow>\n      (ps ! 0 = Suc 0 \\<longrightarrow>\n       ({picks 0 0} \\<union>\n        (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n       (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n       {}) \\<and>\n      (ps ! 0 \\<noteq> Suc 0 \\<longrightarrow>\n       (ps ! 0 = 0 \\<longrightarrow>\n        ({picks 0 (N - Suc 0)} \\<union>\n         (\\<Union>x\\<in>{Suc 0..<N}.\n             Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n        (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n        {}) \\<and>\n       (0 < ps ! 0 \\<longrightarrow>\n        (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n        (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n        {}))))", "proof(elim conjE, intro conjI impI, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 = 3\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 4. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 5. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 1"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 = 3\n\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 = 3\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 4. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 5. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "hence \"putsdown 0 (N - Suc 0) \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 = 3\n\ngoal (1 subgoal):\n 1. putsdown 0 (N - Suc 0) \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "by (auto simp add:fork_transitions_def)"], ["proof (state)\nthis:\n  putsdown 0 (N - Suc 0) \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 = 3\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 4. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 5. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  putsdown 0 (N - Suc 0) \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "show ?case"], ["proof (prove)\nusing this:\n  putsdown 0 (N - Suc 0) \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (1 subgoal):\n 1. ({putsdown 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by blast"], ["proof (state)\nthis:\n  ({putsdown 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 4. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 4. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 2"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 = 2\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 4. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "hence \"putsdown 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 = 2\n\ngoal (1 subgoal):\n 1. putsdown 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "by (auto simp add:fork_transitions_def)"], ["proof (state)\nthis:\n  putsdown 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({putsdown 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 4. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  putsdown 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "show ?case"], ["proof (prove)\nusing this:\n  putsdown 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (1 subgoal):\n 1. ({putsdown 0 0} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by (simp add:fork_transitions_def) force"], ["proof (state)\nthis:\n  ({putsdown 0 0} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 3"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "hence a:\"fs!0 = 0 \\<Longrightarrow> picks 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n\ngoal (1 subgoal):\n 1. fs ! 0 = 0 \\<Longrightarrow>\n    picks 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "by (auto simp add:fork_transitions_def)"], ["proof (state)\nthis:\n  fs ! 0 = 0 \\<Longrightarrow>\n  picks 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 3"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0", "have b1:\"ps!1 = 2 \\<Longrightarrow> putsdown 1 0 \\<in> (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n\ngoal (1 subgoal):\n 1. ps ! 1 = 2 \\<Longrightarrow>\n    putsdown 1 0\n    \\<in> (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))", "using N_g1"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n  1 < N\n\ngoal (1 subgoal):\n 1. ps ! 1 = 2 \\<Longrightarrow>\n    putsdown 1 0\n    \\<in> (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))", "by (auto simp add:rphil_transitions_def)"], ["proof (state)\nthis:\n  ps ! 1 = 2 \\<Longrightarrow>\n  putsdown 1 0\n  \\<in> (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 3"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0", "have b2:\"fs!0 = 2 \\<Longrightarrow> putsdown 1 0 \\<in> Tr\\<^sub>f 0 (fs ! 0)\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n\ngoal (1 subgoal):\n 1. fs ! 0 = 2 \\<Longrightarrow> putsdown 1 0 \\<in> Tr\\<^sub>f 0 (fs ! 0)", "using N_g1"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n  1 < N\n\ngoal (1 subgoal):\n 1. fs ! 0 = 2 \\<Longrightarrow> putsdown 1 0 \\<in> Tr\\<^sub>f 0 (fs ! 0)", "by (auto simp add:fork_transitions_def) fastforce"], ["proof (state)\nthis:\n  fs ! 0 = 2 \\<Longrightarrow> putsdown 1 0 \\<in> Tr\\<^sub>f 0 (fs ! 0)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 3"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0", "have c:\"fs!0 \\<noteq> 0 \\<Longrightarrow> ps!1 = 2\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n\ngoal (1 subgoal):\n 1. fs ! 0 \\<noteq> 0 \\<Longrightarrow> ps ! 1 = 2", "by (metis N_pos N_pos_simps(3) One_nat_def diff_is_0_eq neq0_conv)"], ["proof (state)\nthis:\n  fs ! 0 \\<noteq> 0 \\<Longrightarrow> ps ! 1 = 2\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 3"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0", "have d:\"fs!0 \\<noteq> 0 \\<Longrightarrow> fs!0 = 2\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n\ngoal (1 subgoal):\n 1. fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2", "using N_pos"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 = Suc 0\n  0 < N\n\ngoal (1 subgoal):\n 1. fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2", "by meson"], ["proof (state)\nthis:\n  fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2", "show ?case"], ["proof (prove)\nusing this:\n  fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. ({picks 0 0} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "apply(cases \"fs!0 = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2;\n     fs ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2;\n     fs ! 0 \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "using a"], ["proof (prove)\nusing this:\n  fs ! 0 = 0 \\<Longrightarrow>\n  picks 0 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2;\n     fs ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2;\n     fs ! 0 \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "apply (simp add: fork_transitions_def Un_insert_left)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2;\n     fs ! 0 \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "using b1[OF c] b2[OF d] N_pos"], ["proof (prove)\nusing this:\n  fs ! 0 \\<noteq> 0 \\<Longrightarrow>\n  putsdown 1 0\n  \\<in> (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))\n  fs ! 0 \\<noteq> 0 \\<Longrightarrow>\n  putsdown 1 0 \\<in> Tr\\<^sub>f 0 (fs ! 0)\n  0 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>fs ! 0 \\<noteq> 0 \\<Longrightarrow> fs ! 0 = 2;\n     fs ! 0 \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 0} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "by blast"], ["proof (state)\nthis:\n  ({picks 0 0} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 4"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using 4(5)[rule_format, of 0, OF N_pos]"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0 \\<or> fs ! 0 = Suc 0 \\<or> fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "apply(elim disjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "proof(goal_cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 41:1"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* fs!0 = 0 *)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using 4(5)[rule_format, of 1, OF N_g1]"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0 \\<or> fs ! 1 = Suc 0 \\<or> fs ! 1 = 2\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "apply(elim disjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "proof(goal_cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 411:1"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* fs!1 = 0 *)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 411"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0", "have a0: \"ps!1 = 0\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0\n\ngoal (1 subgoal):\n 1. ps ! 1 = 0", "by (metis N_g1 One_nat_def neq0_conv)"], ["proof (state)\nthis:\n  ps ! 1 = 0\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 411"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0", "have a1: \"picks 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0\n\ngoal (1 subgoal):\n 1. picks 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "apply (auto simp add:fork_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 0;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>{..<length fs} \\<inter>\n                                     {x. fs ! x = 0}.\n                         Suc 0 = x \\<or>\n                         Suc 0 = Suc x mod length fs \\<and> Suc 0 = x", "by (metis (mono_tags, lifting) N_g1 Int_Collect One_nat_def lessThan_iff)"], ["proof (state)\nthis:\n  picks 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 411"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0", "have a2: \"ps!1 = 0 \\<Longrightarrow> picks 1 1 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0\n\ngoal (1 subgoal):\n 1. ps ! 1 = 0 \\<Longrightarrow>\n    picks 1 1\n    \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))", "apply (auto simp add:rphil_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ps ! Suc 0 = 0;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 0;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>ps ! Suc 0 = 0;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 0;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "by linarith"], ["proof (state)\nthis:\n  ps ! 1 = 0 \\<Longrightarrow>\n  picks 1 1 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 3. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 411"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using a0 a1 a2"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 0\n  ps ! 1 = 0\n  picks 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n  ps ! 1 = 0 \\<Longrightarrow>\n  picks 1 1 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by blast"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 412:2"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* fs!1 = 1 *)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "hence \"ps!1 = 1 \\<or> ps!1 = 3\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n\ngoal (1 subgoal):\n 1. ps ! 1 = 1 \\<or> ps ! 1 = 3", "by (metis N_g1 One_nat_def less_numeral_extra(3) zero_less_diff)"], ["proof (state)\nthis:\n  ps ! 1 = 1 \\<or> ps ! 1 = 3\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "with 412"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1 \\<or> ps ! 1 = 3", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1 \\<or> ps ! 1 = 3\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "proof(elim disjE, goal_cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 1\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 4121:1"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 1\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* ps!1 = 1 *)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 1\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 4121"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1", "have b1: \"picks 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1\n\ngoal (1 subgoal):\n 1. picks 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "apply (auto simp add:fork_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = Suc 0;\n     ps ! Suc 0 = Suc 0; N = length fs\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>{..<length fs} \\<inter>\n                                     {x. fs ! x = 0}.\n                         Suc 0 = x \\<and> x = 0 \\<or>\n                         Suc 0 = Suc x mod length fs \\<and> x = 0", "by (metis (full_types) Int_Collect N_g1 N_pos One_nat_def lessThan_iff mod_less)"], ["proof (state)\nthis:\n  picks 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 1\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 4121"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1", "have b2: \"picks 1 0 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1\n\ngoal (1 subgoal):\n 1. picks 1 0\n    \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))", "apply (auto simp add:rphil_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = Suc 0;\n     ps ! Suc 0 = Suc 0; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = Suc 0;\n     ps ! Suc 0 = Suc 0; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "by linarith"], ["proof (state)\nthis:\n  picks 1 0 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 1\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 4121"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using b1 b2"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 1\n  picks 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n  picks 1 0 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by blast"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 4122:2"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 3\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* ps!1 = 3 *)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 3\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 4122"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 3", "have b3: \"putsdown 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 3\n\ngoal (1 subgoal):\n 1. putsdown 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "apply (auto simp add:fork_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = Suc 0;\n     ps ! Suc 0 = 3; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = Suc 0;\n     ps ! Suc 0 = 3; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "by linarith"], ["proof (state)\nthis:\n  putsdown 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 4122"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 3", "have b4: \"putsdown 1 1 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = Suc 0\n  ps ! 1 = 3\n\ngoal (1 subgoal):\n 1. putsdown 1 1\n    \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))", "apply (auto simp add:rphil_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = Suc 0;\n     ps ! Suc 0 = 3; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < length fs \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = Suc 0;\n     ps ! Suc 0 = 3; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "by linarith"], ["proof (state)\nthis:\n  putsdown 1 1\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = Suc 0;\n     ps ! 1 = 3\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  putsdown 1 1\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))", "show ?case"], ["proof (prove)\nusing this:\n  putsdown 1 1\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using b3 b4"], ["proof (prove)\nusing this:\n  putsdown 1 1\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n  putsdown 1 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n  putsdown 1 1\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by blast"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 413:3"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* fs!1 = 2 *)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "proof(cases \"N = 2\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case True"], ["proof (state)\nthis:\n  N = 2\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "with 413"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n  N = 2", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n  N = 2\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by simp"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case False"], ["proof (state)\nthis:\n  N \\<noteq> 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from False 413"], ["proof (chain)\npicking this:\n  N \\<noteq> 2\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2", "have c0: \"ps!2 = 2\""], ["proof (prove)\nusing this:\n  N \\<noteq> 2\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n\ngoal (1 subgoal):\n 1. ps ! 2 = 2", "by (metis N_g1 Suc_1 Suc_diff_1 nat_neq_iff not_gr0 zero_less_diff)"], ["proof (state)\nthis:\n  ps ! 2 = 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from False 413"], ["proof (chain)\npicking this:\n  N \\<noteq> 2\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2", "have c1: \"putsdown 2 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  N \\<noteq> 2\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n\ngoal (1 subgoal):\n 1. putsdown 2 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "apply (auto simp add:fork_transitions_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs\n 2. \\<lbrakk>length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) mod length fs = 2", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (2 subgoals):\n 1. \\<lbrakk>length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs\n 2. \\<lbrakk>length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) mod length fs = 2", "apply linarith"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) mod length fs = 2", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) mod length fs = 2", "by auto"], ["proof (state)\nthis:\n  putsdown 2 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from False 413"], ["proof (chain)\npicking this:\n  N \\<noteq> 2\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2", "have c2: \"ps!2 = 2 \\<Longrightarrow> putsdown 2 1 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\""], ["proof (prove)\nusing this:\n  N \\<noteq> 2\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n\ngoal (1 subgoal):\n 1. ps ! 2 = 2 \\<Longrightarrow>\n    putsdown 2 1\n    \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))", "apply (auto simp add:rphil_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ps ! 2 = 2; length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> 2 < length fs", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>ps ! 2 = 2; length fs \\<noteq> 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 0; fs ! Suc 0 = 2;\n     N = length fs\\<rbrakk>\n    \\<Longrightarrow> 2 < length fs", "by linarith"], ["proof (state)\nthis:\n  ps ! 2 = 2 \\<Longrightarrow>\n  putsdown 2 1\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 0; fs ! 1 = 2;\n     N \\<noteq> 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 413 False"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n  N \\<noteq> 2", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n  N \\<noteq> 2\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using c0 c1 c2"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 0\n  fs ! 1 = 2\n  N \\<noteq> 2\n  ps ! 2 = 2\n  putsdown 2 1 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n  ps ! 2 = 2 \\<Longrightarrow>\n  putsdown 2 1\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by blast"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 42:2"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = Suc 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* fs!0 = 1 *)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = Suc 0\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = Suc 0\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}\n 2. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = Suc 0", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = Suc 0\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by blast"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 43:3"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "(* fs!0 = 2*)"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 43"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2", "have d0: \"ps!1 = 2\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. ps ! 1 = 2", "by (metis One_nat_def gr0I)"], ["proof (state)\nthis:\n  ps ! 1 = 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 43"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2", "have d1: \"putsdown 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. putsdown 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))", "by (auto simp add:fork_transitions_def)"], ["proof (state)\nthis:\n  putsdown 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 43"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2", "have d2: \"ps!1 = 2 \\<Longrightarrow> putsdown 1 0 \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\""], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. ps ! 1 = 2 \\<Longrightarrow>\n    putsdown 1 0\n    \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))", "apply (auto simp add:rphil_transitions_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ps ! Suc 0 = 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 2; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "using N_g1"], ["proof (prove)\nusing this:\n  1 < N\n\ngoal (1 subgoal):\n 1. \\<lbrakk>ps ! Suc 0 = 2;\n     \\<forall>i.\n        Suc i < length fs \\<longrightarrow>\n        (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     fs ! (length fs - Suc 0) \\<noteq> 2;\n     \\<forall>i<length fs - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     \\<forall>i<length fs. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<length fs.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length ps = length fs; ps ! 0 = 0; fs ! 0 = 2; N = length fs\\<rbrakk>\n    \\<Longrightarrow> Suc 0 < length fs", "by linarith"], ["proof (state)\nthis:\n  ps ! 1 = 2 \\<Longrightarrow>\n  putsdown 1 0\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; ps ! 0 = 0; fs ! 0 = 2\\<rbrakk>\n    \\<Longrightarrow> ({picks 0 (N - Suc 0)} \\<union>\n                       (\\<Union>x\\<in>{Suc 0..<N}.\n                           Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "from 43"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using d0 d1 d2"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  ps ! 0 = 0\n  fs ! 0 = 2\n  ps ! 1 = 2\n  putsdown 1 0 \\<in> (\\<Union>i<N. Tr\\<^sub>f i (fs ! i))\n  ps ! 1 = 2 \\<Longrightarrow>\n  putsdown 1 0\n  \\<in> (\\<Union>i\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p i (ps ! i))\n\ngoal (1 subgoal):\n 1. ({picks 0 (N - Suc 0)} \\<union>\n     (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by blast"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ({picks 0 (N - Suc 0)} \\<union>\n   (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x))) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "case 5"], ["proof (state)\nthis:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  0 < ps ! 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i.\n                Suc i < N \\<longrightarrow>\n                (fs ! Suc i = Suc 0) = (0 < ps ! Suc i);\n     (fs ! (N - Suc 0) = 2) = (0 < ps ! 0);\n     \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2);\n     (fs ! 0 = Suc 0) = (ps ! 0 = 2);\n     \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2;\n     \\<forall>i<N.\n        ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3;\n     length fs = N; length ps = N; ps ! 0 \\<noteq> 3; ps ! 0 \\<noteq> 2;\n     ps ! 0 \\<noteq> Suc 0; 0 < ps ! 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Union>x\\<in>{Suc 0..<N}.\n                          Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n                      (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n                      {}", "then"], ["proof (chain)\npicking this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  0 < ps ! 0", "show ?case"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  0 < ps ! 0\n\ngoal (1 subgoal):\n 1. (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "using 5(6)[rule_format, of 0]"], ["proof (prove)\nusing this:\n  \\<forall>i.\n     Suc i < N \\<longrightarrow> (fs ! Suc i = Suc 0) = (0 < ps ! Suc i)\n  (fs ! (N - Suc 0) = 2) = (0 < ps ! 0)\n  \\<forall>i<N - Suc 0. (fs ! i = 2) = (ps ! Suc i = 2)\n  (fs ! 0 = Suc 0) = (ps ! 0 = 2)\n  \\<forall>i<N. fs ! i = 0 \\<or> fs ! i = Suc 0 \\<or> fs ! i = 2\n  \\<forall>i<N.\n     ps ! i = 0 \\<or> ps ! i = Suc 0 \\<or> ps ! i = 2 \\<or> ps ! i = 3\n  length fs = N\n  length ps = N\n  ps ! 0 \\<noteq> 3\n  ps ! 0 \\<noteq> 2\n  ps ! 0 \\<noteq> Suc 0\n  0 < ps ! 0\n  0 < N \\<Longrightarrow>\n  ps ! 0 = 0 \\<or> ps ! 0 = Suc 0 \\<or> ps ! 0 = 2 \\<or> ps ! 0 = 3\n\ngoal (1 subgoal):\n 1. (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n    (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n    {}", "by simp"], ["proof (state)\nthis:\n  (\\<Union>x\\<in>{Suc 0..<N}. Tr\\<^sub>r\\<^sub>p x (ps ! x)) \\<inter>\n  (\\<Union>i<N. Tr\\<^sub>f i (fs ! i)) \\<noteq>\n  {}\n\ngoal:\nNo subgoals!", "qed"], ["", "corollary DF_DINING: \"deadlock_free_v2 DINING\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deadlock_free_v2 DINING", "unfolding DINING_is_DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m DINING\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. deadlock_free_v2\n     ((P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>D\n            N,Up\\<^sub>D\\<rbrakk>)\n       (replicate N 0, replicate N 0))", "using inv_DINING inv_implies_DF"], ["proof (prove)\nusing this:\n  ?s \\<in> \\<RR> (Tr\\<^sub>D N) Up\\<^sub>D\n            (replicate N 0, replicate N 0) \\<Longrightarrow>\n  inv_dining (fst ?s) (snd ?s)\n  inv_dining ?ps ?fs \\<Longrightarrow> Tr\\<^sub>D N (?ps, ?fs) \\<noteq> {}\n\ngoal (1 subgoal):\n 1. deadlock_free_v2\n     ((P\\<^sub>n\\<^sub>o\\<^sub>r\\<^sub>m\\<lbrakk>Tr\\<^sub>D\n            N,Up\\<^sub>D\\<rbrakk>)\n       (replicate N 0, replicate N 0))", "by (subst deadlock_free_dnorm) auto"], ["", "end"], ["", "end"]]}