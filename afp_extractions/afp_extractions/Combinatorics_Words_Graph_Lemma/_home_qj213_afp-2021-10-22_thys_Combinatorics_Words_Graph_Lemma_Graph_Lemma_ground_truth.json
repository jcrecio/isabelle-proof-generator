{"file_name": "/home/qj213/afp-2021-10-22/thys/Combinatorics_Words_Graph_Lemma/Graph_Lemma.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Combinatorics_Words_Graph_Lemma", "problem_names": ["lemma no_head_sub: \"no_head C b \\<subseteq> \\<langle>C\\<rangle>\"", "lemma no_head_closed:  \"\\<langle>no_head C b\\<rangle> = no_head C b\"", "lemma no_head_hd: assumes \"u \\<in> no_head \\<C> b\" and \"u \\<noteq> \\<epsilon>\" shows \"hd (Dec \\<C> u) \\<noteq> b\"", "lemma b_not_in_no_head: assumes \"b \\<in> \\<C>\" shows \"b \\<notin> no_head \\<C> b\"", "lemma hd_no_head: assumes \"u \\<in> \\<langle>\\<C>\\<rangle>\" and \"hd (Dec \\<C> u) \\<noteq> b\" shows \"u \\<in> no_head \\<C> b\"", "lemma no_head_gen_set: \"no_head_gen C b = {z \\<cdot> b\\<^sup>@k |z k. z \\<in> C \\<and> z \\<noteq> b}\"", "lemma no_head_genE: assumes \"u \\<in> no_head_gen C b\"\n  obtains z k where \"z \\<in> C\" and  \"z \\<noteq> b\" and \"u = z \\<cdot> b\\<^sup>@k\"", "lemma emp_not_in_Cb: \"\\<epsilon> \\<notin> no_head_gen \\<C> b\"", "lemma no_head_sub': \"b \\<in> \\<C> \\<Longrightarrow> no_head_gen \\<C> b \\<subseteq> no_head \\<C> b\"", "lemma no_head_generates0: assumes \"v \\<in> \\<langle>\\<C>\\<rangle>\" shows \n  \"u \\<noteq> \\<epsilon> \\<longrightarrow> u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow> u \\<cdot> v \\<in>  \\<langle>no_head_gen \\<C> b\\<rangle>\"", "theorem no_head_generates: assumes \"b \\<in> \\<C>\" shows \"\\<langle>no_head_gen \\<C> b\\<rangle> =  no_head \\<C> b\"", "lemma lists_no_head_sub: \"b \\<in> \\<C> \\<Longrightarrow> us \\<in> lists (no_head_gen \\<C> b) \\<Longrightarrow> us \\<in> lists \\<langle>\\<C>\\<rangle>\"", "lemma ref_hd: assumes \"z \\<in> \\<C>\" and  \"b \\<in> \\<C>\" and \"z \\<noteq> b\" and \"vs \\<in> lists (no_head_gen \\<C> b)\" \n  shows \"refine \\<C> ((z\\<cdot>b\\<^sup>@k) # vs) = [z]\\<cdot>[b]\\<^sup>@k \\<cdot> refine \\<C> vs\"", "lemma no_head_gen_code_ind_step:\n  assumes \"vs \\<in> lists (no_head_gen \\<C> b)\" \"us \\<in> lists (no_head_gen \\<C> b)\" \"b \\<in> \\<C>\"\n    and eq: \"[b]\\<^sup>@ku \\<cdot> (refine \\<C> us) = [b]\\<^sup>@kv \\<cdot> (refine \\<C> vs)\"\n  shows  \"ku = kv\"", "lemma no_head_gen_code':\n  \"b \\<in> \\<C> \\<Longrightarrow> xs \\<in> lists (no_head_gen \\<C> b) \n   \\<Longrightarrow> ys \\<in>  lists (no_head_gen \\<C> b) \\<Longrightarrow> concat xs = concat ys \\<Longrightarrow> xs = ys\"", "theorem no_head_gen_code:\n  assumes \"code C\" and \"b \\<in> C\"\n  shows \"code {z \\<cdot> b\\<^sup>@k | z k. z \\<in> C \\<and> z \\<noteq> b}\"", "theorem graph_lemma: \"\\<BB>\\<^sub>F X = {hd (Dec (\\<BB>\\<^sub>F X) x) | x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\"", "lemma non_comm_hds_neq: assumes \"u \\<cdot> v \\<noteq> v \\<cdot> u\" shows \"hd (Dec \\<BB>\\<^sub>F {u,v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u,v} v)\"", "theorem assumes \"u \\<cdot> v \\<noteq> v \\<cdot> u\" \n  shows \"xs \\<in> lists {u, v} \\<Longrightarrow> ys \\<in> lists {u, v} \\<Longrightarrow> concat xs = concat ys \\<Longrightarrow> xs = ys\""], "translations": [["", "lemma no_head_sub: \"no_head C b \\<subseteq> \\<langle>C\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. no_head C b \\<subseteq> \\<langle>C\\<rangle>", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> no_head C b \\<Longrightarrow> x \\<in> \\<langle>C\\<rangle>", "fix u"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> no_head C b \\<Longrightarrow> x \\<in> \\<langle>C\\<rangle>", "assume \"u \\<in> no_head C b\""], ["proof (state)\nthis:\n  u \\<in> no_head C b\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> no_head C b \\<Longrightarrow> x \\<in> \\<langle>C\\<rangle>", "show \"u \\<in> \\<langle>C\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> \\<langle>C\\<rangle>", "proof (induction rule: no_head.induct[OF \\<open>u \\<in> no_head C b\\<close>], auto)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head C b;\n        u \\<in> \\<langle>C\\<rangle>; v \\<in> \\<langle>C\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> u \\<cdot> v \\<in> \\<langle>C\\<rangle>", "case (3 u v)"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon>\n  u \\<in> no_head C b\n  v \\<in> \\<langle>C\\<rangle>\n  u \\<in> \\<langle>C\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head C b;\n        u \\<in> \\<langle>C\\<rangle>; v \\<in> \\<langle>C\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> u \\<cdot> v \\<in> \\<langle>C\\<rangle>", "then"], ["proof (chain)\npicking this:\n  u \\<noteq> \\<epsilon>\n  u \\<in> no_head C b\n  v \\<in> \\<langle>C\\<rangle>\n  u \\<in> \\<langle>C\\<rangle>", "show \"u \\<cdot> v \\<in> \\<langle>C\\<rangle>\""], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  u \\<in> no_head C b\n  v \\<in> \\<langle>C\\<rangle>\n  u \\<in> \\<langle>C\\<rangle>\n\ngoal (1 subgoal):\n 1. u \\<cdot> v \\<in> \\<langle>C\\<rangle>", "using hull_closed"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  u \\<in> no_head C b\n  v \\<in> \\<langle>C\\<rangle>\n  u \\<in> \\<langle>C\\<rangle>\n  \\<lbrakk>?w1.0 \\<in> \\<langle>?G\\<rangle>;\n   ?w2.0 \\<in> \\<langle>?G\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> ?w1.0 \\<cdot> ?w2.0 \\<in> \\<langle>?G\\<rangle>\n\ngoal (1 subgoal):\n 1. u \\<cdot> v \\<in> \\<langle>C\\<rangle>", "by blast"], ["proof (state)\nthis:\n  u \\<cdot> v \\<in> \\<langle>C\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u \\<in> \\<langle>C\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma no_head_closed:  \"\\<langle>no_head C b\\<rangle> = no_head C b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>no_head C b\\<rangle> = no_head C b", "proof(intro equalityI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<langle>no_head C b\\<rangle> \\<subseteq> no_head C b\n 2. no_head C b \\<subseteq> \\<langle>no_head C b\\<rangle>", "show \"no_head C b \\<subseteq> \\<langle>no_head C b\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. no_head C b \\<subseteq> \\<langle>no_head C b\\<rangle>", "by (simp add: genset_sub)"], ["proof (state)\nthis:\n  no_head C b \\<subseteq> \\<langle>no_head C b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<langle>no_head C b\\<rangle> \\<subseteq> no_head C b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<langle>no_head C b\\<rangle> \\<subseteq> no_head C b", "show \"\\<langle>no_head C b\\<rangle> \\<subseteq> no_head C b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>no_head C b\\<rangle> \\<subseteq> no_head C b", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> \\<langle>no_head C b\\<rangle> \\<Longrightarrow>\n       x \\<in> no_head C b", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> \\<langle>no_head C b\\<rangle> \\<Longrightarrow>\n       x \\<in> no_head C b", "assume \"x \\<in> \\<langle>no_head C b\\<rangle>\""], ["proof (state)\nthis:\n  x \\<in> \\<langle>no_head C b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> \\<langle>no_head C b\\<rangle> \\<Longrightarrow>\n       x \\<in> no_head C b", "thus \"x \\<in> no_head C b\""], ["proof (prove)\nusing this:\n  x \\<in> \\<langle>no_head C b\\<rangle>\n\ngoal (1 subgoal):\n 1. x \\<in> no_head C b", "proof (induction rule: hull.induct, simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       \\<lbrakk>w1 \\<in> no_head C b;\n        w2 \\<in> \\<langle>no_head C b\\<rangle>;\n        w2 \\<in> no_head C b\\<rbrakk>\n       \\<Longrightarrow> w1 \\<cdot> w2 \\<in> no_head C b", "case (prod_cl w1 w2)"], ["proof (state)\nthis:\n  w1 \\<in> no_head C b\n  w2 \\<in> \\<langle>no_head C b\\<rangle>\n  w2 \\<in> no_head C b\n\ngoal (1 subgoal):\n 1. \\<And>w1 w2.\n       \\<lbrakk>w1 \\<in> no_head C b;\n        w2 \\<in> \\<langle>no_head C b\\<rangle>;\n        w2 \\<in> no_head C b\\<rbrakk>\n       \\<Longrightarrow> w1 \\<cdot> w2 \\<in> no_head C b", "then"], ["proof (chain)\npicking this:\n  w1 \\<in> no_head C b\n  w2 \\<in> \\<langle>no_head C b\\<rangle>\n  w2 \\<in> no_head C b", "show \"w1 \\<cdot> w2 \\<in> no_head C b\""], ["proof (prove)\nusing this:\n  w1 \\<in> no_head C b\n  w2 \\<in> \\<langle>no_head C b\\<rangle>\n  w2 \\<in> no_head C b\n\ngoal (1 subgoal):\n 1. w1 \\<cdot> w2 \\<in> no_head C b", "using no_head.intros(3)[OF _ \\<open>w1 \\<in> no_head C b\\<close>]\n          in_mono[OF no_head_sub, of w2]"], ["proof (prove)\nusing this:\n  w1 \\<in> no_head C b\n  w2 \\<in> \\<langle>no_head C b\\<rangle>\n  w2 \\<in> no_head C b\n  \\<lbrakk>w1 \\<noteq> \\<epsilon>; ?v \\<in> \\<langle>C\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> w1 \\<cdot> ?v \\<in> no_head C b\n  w2 \\<in> no_head ?C1 ?b1 \\<longrightarrow> w2 \\<in> \\<langle>?C1\\<rangle>\n\ngoal (1 subgoal):\n 1. w1 \\<cdot> w2 \\<in> no_head C b", "by fastforce"], ["proof (state)\nthis:\n  w1 \\<cdot> w2 \\<in> no_head C b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<in> no_head C b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<langle>no_head C b\\<rangle> \\<subseteq> no_head C b\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>We are interested mainly in the situation when @{term C} is a code.\\<close>"], ["", "context code\nbegin"], ["", "text\\<open>We characterize the set @{term no_head} in terms of the decomposition of its (nonempty) elements: the first factor is not b\\<close>"], ["", "lemma no_head_hd: assumes \"u \\<in> no_head \\<C> b\" and \"u \\<noteq> \\<epsilon>\" shows \"hd (Dec \\<C> u) \\<noteq> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) \\<noteq> b", "using \\<open>u \\<noteq> \\<epsilon>\\<close>"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) \\<noteq> b", "proof(induct rule: no_head.induct[OF \\<open>u \\<in> no_head \\<C> b\\<close>], simp)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> \\<C>; u \\<noteq> b; u \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b\n 2. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head \\<C> b;\n        u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b;\n        v \\<in> \\<langle>\\<C>\\<rangle>;\n        u \\<cdot> v \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "case (2 u)"], ["proof (state)\nthis:\n  u \\<in> \\<C>\n  u \\<noteq> b\n  u \\<noteq> \\<epsilon>\n\ngoal (2 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> \\<C>; u \\<noteq> b; u \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b\n 2. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head \\<C> b;\n        u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b;\n        v \\<in> \\<langle>\\<C>\\<rangle>;\n        u \\<cdot> v \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "then"], ["proof (chain)\npicking this:\n  u \\<in> \\<C>\n  u \\<noteq> b\n  u \\<noteq> \\<epsilon>", "show ?case"], ["proof (prove)\nusing this:\n  u \\<in> \\<C>\n  u \\<noteq> b\n  u \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) \\<noteq> b", "using code_el_dec"], ["proof (prove)\nusing this:\n  u \\<in> \\<C>\n  u \\<noteq> b\n  u \\<noteq> \\<epsilon>\n  ?c \\<in> \\<C> \\<Longrightarrow> Dec \\<C> ?c = [?c]\n\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) \\<noteq> b", "by auto"], ["proof (state)\nthis:\n  hd (Dec \\<C> u) \\<noteq> b\n\ngoal (1 subgoal):\n 1. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head \\<C> b;\n        u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b;\n        v \\<in> \\<langle>\\<C>\\<rangle>;\n        u \\<cdot> v \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head \\<C> b;\n        u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b;\n        v \\<in> \\<langle>\\<C>\\<rangle>;\n        u \\<cdot> v \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "case (3 u v)"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon>\n  u \\<in> no_head \\<C> b\n  u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b\n  v \\<in> \\<langle>\\<C>\\<rangle>\n  u \\<cdot> v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head \\<C> b;\n        u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b;\n        v \\<in> \\<langle>\\<C>\\<rangle>;\n        u \\<cdot> v \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "have \"Dec \\<C> u \\<noteq> \\<epsilon>\" and \"u \\<in> \\<langle>\\<C>\\<rangle>\" and \"v \\<in> \\<langle>\\<C>\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Dec \\<C> u \\<noteq> \\<epsilon> &&&\n    u \\<in> \\<langle>\\<C>\\<rangle> &&& v \\<in> \\<langle>\\<C>\\<rangle>", "using dec_nemp no_head_sub \"3.hyps\""], ["proof (prove)\nusing this:\n  ?u \\<in> \\<langle>?G\\<rangle>\\<^sub>+ \\<Longrightarrow>\n  Dec ?G ?u \\<noteq> \\<epsilon>\n  no_head ?C ?b \\<subseteq> \\<langle>?C\\<rangle>\n  u \\<noteq> \\<epsilon>\n  u \\<in> no_head \\<C> b\n  u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b\n  v \\<in> \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. Dec \\<C> u \\<noteq> \\<epsilon> &&&\n    u \\<in> \\<langle>\\<C>\\<rangle> &&& v \\<in> \\<langle>\\<C>\\<rangle>", "by blast+"], ["proof (state)\nthis:\n  Dec \\<C> u \\<noteq> \\<epsilon>\n  u \\<in> \\<langle>\\<C>\\<rangle>\n  v \\<in> \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>u v.\n       \\<lbrakk>u \\<noteq> \\<epsilon>; u \\<in> no_head \\<C> b;\n        u \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec \\<C> u) \\<noteq> b;\n        v \\<in> \\<langle>\\<C>\\<rangle>;\n        u \\<cdot> v \\<noteq> \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "show \"hd (Dec \\<C> u \\<cdot> v) \\<noteq> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "using \"3.hyps\"(3)[OF \\<open>u \\<noteq> \\<epsilon>\\<close>] hd_append2[OF \\<open>Dec \\<C> u \\<noteq> \\<epsilon>\\<close>, of \"Dec \\<C> v\"]"], ["proof (prove)\nusing this:\n  hd (Dec \\<C> u) \\<noteq> b\n  hd ((Dec \\<C> u) \\<cdot> (Dec \\<C> v)) = hd (Dec \\<C> u)\n\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "unfolding code_dec_morph[OF \\<open> u \\<in> \\<langle>\\<C>\\<rangle>\\<close> \\<open>v \\<in> \\<langle>\\<C>\\<rangle>\\<close>]"], ["proof (prove)\nusing this:\n  hd (Dec \\<C> u) \\<noteq> b\n  hd (Dec \\<C> u \\<cdot> v) = hd (Dec \\<C> u)\n\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u \\<cdot> v) \\<noteq> b", "by simp"], ["proof (state)\nthis:\n  hd (Dec \\<C> u \\<cdot> v) \\<noteq> b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma b_not_in_no_head: assumes \"b \\<in> \\<C>\" shows \"b \\<notin> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b \\<notin> no_head \\<C> b", "using \\<open>b \\<in> \\<C>\\<close> code_el_dec emp_not_in_code no_head_hd"], ["proof (prove)\nusing this:\n  b \\<in> \\<C>\n  ?c \\<in> \\<C> \\<Longrightarrow> Dec \\<C> ?c = [?c]\n  \\<epsilon> \\<notin> \\<C>\n  \\<lbrakk>?u \\<in> no_head \\<C> ?b; ?u \\<noteq> \\<epsilon>\\<rbrakk>\n  \\<Longrightarrow> hd (Dec \\<C> ?u) \\<noteq> ?b\n\ngoal (1 subgoal):\n 1. b \\<notin> no_head \\<C> b", "by fastforce"], ["", "lemma hd_no_head: assumes \"u \\<in> \\<langle>\\<C>\\<rangle>\" and \"hd (Dec \\<C> u) \\<noteq> b\" shows \"u \\<in> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> no_head \\<C> b", "proof(cases \"u \\<noteq> \\<epsilon>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b\n 2. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "assume \"u \\<noteq> \\<epsilon>\""], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon>\n\ngoal (2 subgoals):\n 1. u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b\n 2. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "have \"Dec \\<C> u \\<noteq> \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Dec \\<C> u \\<noteq> \\<epsilon>", "using dec_nemp'[OF \\<open>u \\<noteq> \\<epsilon>\\<close> \\<open>u \\<in> \\<langle>\\<C>\\<rangle>\\<close>]"], ["proof (prove)\nusing this:\n  Dec \\<C> u \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. Dec \\<C> u \\<noteq> \\<epsilon>", "."], ["proof (state)\nthis:\n  Dec \\<C> u \\<noteq> \\<epsilon>\n\ngoal (2 subgoals):\n 1. u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b\n 2. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "have \"u = hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u = hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))", "using concat.simps(2)[of \"hd (Dec \\<C> u)\" \"tl(Dec \\<C> u)\"]"], ["proof (prove)\nusing this:\n  concat (hd (Dec \\<C> u) # tl (Dec \\<C> u)) =\n  hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))\n\ngoal (1 subgoal):\n 1. u = hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))", "unfolding hd_Cons_tl[OF \\<open>Dec \\<C> u \\<noteq> \\<epsilon>\\<close>] decI[OF \\<open>u \\<in> \\<langle>\\<C>\\<rangle>\\<close>]"], ["proof (prove)\nusing this:\n  u = hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))\n\ngoal (1 subgoal):\n 1. u = hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))", "."], ["proof (state)\nthis:\n  u = hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))\n\ngoal (2 subgoals):\n 1. u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b\n 2. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "have \"hd (Dec \\<C> u) # tl (Dec \\<C> u) \\<in> lists \\<C>\" and \"hd (Dec \\<C> u) \\<in> \\<C>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) # tl (Dec \\<C> u) \\<in> lists \\<C> &&&\n    hd (Dec \\<C> u) \\<in> \\<C>", "using \\<open>Dec \\<C> u \\<noteq> \\<epsilon>\\<close> \\<open>u \\<in> \\<langle>\\<C>\\<rangle>\\<close> dec_dom' lists_hd"], ["proof (prove)\nusing this:\n  Dec \\<C> u \\<noteq> \\<epsilon>\n  u \\<in> \\<langle>\\<C>\\<rangle>\n  ?u \\<in> \\<langle>?G\\<rangle> \\<Longrightarrow> Dec ?G ?u \\<in> lists ?G\n  \\<lbrakk>?us \\<noteq> \\<epsilon>; ?us \\<in> lists ?Q\\<rbrakk>\n  \\<Longrightarrow> hd ?us \\<in> ?Q\n\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) # tl (Dec \\<C> u) \\<in> lists \\<C> &&&\n    hd (Dec \\<C> u) \\<in> \\<C>", "by auto blast"], ["proof (state)\nthis:\n  hd (Dec \\<C> u) # tl (Dec \\<C> u) \\<in> lists \\<C>\n  hd (Dec \\<C> u) \\<in> \\<C>\n\ngoal (2 subgoals):\n 1. u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b\n 2. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "have \"concat (tl (decompose \\<C> u)) \\<in> \\<langle>\\<C>\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. concat (tl (Dec \\<C> u)) \\<in> \\<langle>\\<C>\\<rangle>", "using concat_tl[of \"hd (Dec \\<C> u)\" \"tl(Dec \\<C> u)\" \\<C>, OF \\<open>hd (Dec \\<C> u) # tl (Dec \\<C> u) \\<in> lists \\<C>\\<close>]"], ["proof (prove)\nusing this:\n  concat (tl (Dec \\<C> u)) \\<in> \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. concat (tl (Dec \\<C> u)) \\<in> \\<langle>\\<C>\\<rangle>", "."], ["proof (state)\nthis:\n  concat (tl (Dec \\<C> u)) \\<in> \\<langle>\\<C>\\<rangle>\n\ngoal (2 subgoals):\n 1. u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b\n 2. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "have \"hd (Dec \\<C> u) \\<noteq> \\<epsilon>\" and \"hd (Dec \\<C> u) \\<in> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) \\<noteq> \\<epsilon> &&&\n    hd (Dec \\<C> u) \\<in> no_head \\<C> b", "using no_head.intros(2)[OF \\<open>hd (Dec \\<C> u) \\<in> \\<C>\\<close> \\<open>hd (Dec \\<C> u) \\<noteq> b\\<close>] \\<open>hd (Dec \\<C> u) \\<in> \\<C>\\<close> emp_not_in_code"], ["proof (prove)\nusing this:\n  hd (Dec \\<C> u) \\<in> no_head \\<C> b\n  hd (Dec \\<C> u) \\<in> \\<C>\n  \\<epsilon> \\<notin> \\<C>\n\ngoal (1 subgoal):\n 1. hd (Dec \\<C> u) \\<noteq> \\<epsilon> &&&\n    hd (Dec \\<C> u) \\<in> no_head \\<C> b", "by auto"], ["proof (state)\nthis:\n  hd (Dec \\<C> u) \\<noteq> \\<epsilon>\n  hd (Dec \\<C> u) \\<in> no_head \\<C> b\n\ngoal (2 subgoals):\n 1. u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b\n 2. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "from no_head.intros(3)[OF this \\<open>concat (tl (decompose \\<C> u)) \\<in> \\<langle>\\<C>\\<rangle>\\<close> ]"], ["proof (chain)\npicking this:\n  hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u)) \\<in> no_head \\<C> b", "show \"u \\<in> no_head \\<C> b\""], ["proof (prove)\nusing this:\n  hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u)) \\<in> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. u \\<in> no_head \\<C> b", "unfolding sym[OF \\<open>u = hd (Dec \\<C> u) \\<cdot> concat (tl (Dec \\<C> u))\\<close>]"], ["proof (prove)\nusing this:\n  u \\<in> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. u \\<in> no_head \\<C> b", "."], ["proof (state)\nthis:\n  u \\<in> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. \\<not> u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<in> no_head \\<C> b", "qed simp"], ["", "corollary \"no_head \\<C> b = {u \\<in> \\<langle>\\<C>\\<rangle>. u = \\<epsilon> \\<or> hd (Dec \\<C> u) \\<noteq> b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. no_head \\<C> b =\n    {u \\<in> \\<langle>\\<C>\\<rangle>.\n     u = \\<epsilon> \\<or> hd (Dec \\<C> u) \\<noteq> b}", "proof(intro equalityI subsetI, standard)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> no_head \\<C> b \\<Longrightarrow>\n       x \\<in> \\<langle>\\<C>\\<rangle> \\<and>\n       (x = \\<epsilon> \\<or> hd (Dec \\<C> x) \\<noteq> b)\n 2. \\<And>x.\n       x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n                u = \\<epsilon> \\<or>\n                hd (Dec \\<C> u) \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head \\<C> b", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> no_head \\<C> b \\<Longrightarrow>\n       x \\<in> \\<langle>\\<C>\\<rangle> \\<and>\n       (x = \\<epsilon> \\<or> hd (Dec \\<C> x) \\<noteq> b)\n 2. \\<And>x.\n       x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n                u = \\<epsilon> \\<or>\n                hd (Dec \\<C> u) \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head \\<C> b", "assume  \"x \\<in> no_head \\<C> b\""], ["proof (state)\nthis:\n  x \\<in> no_head \\<C> b\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> no_head \\<C> b \\<Longrightarrow>\n       x \\<in> \\<langle>\\<C>\\<rangle> \\<and>\n       (x = \\<epsilon> \\<or> hd (Dec \\<C> x) \\<noteq> b)\n 2. \\<And>x.\n       x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n                u = \\<epsilon> \\<or>\n                hd (Dec \\<C> u) \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head \\<C> b", "thus \"x \\<in> \\<langle>\\<C>\\<rangle> \\<and> (x = \\<epsilon> \\<or> hd (Dec \\<C> x) \\<noteq> b)\""], ["proof (prove)\nusing this:\n  x \\<in> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>\\<C>\\<rangle> \\<and>\n    (x = \\<epsilon> \\<or> hd (Dec \\<C> x) \\<noteq> b)", "using no_head_hd no_head_sub"], ["proof (prove)\nusing this:\n  x \\<in> no_head \\<C> b\n  \\<lbrakk>?u \\<in> no_head \\<C> ?b; ?u \\<noteq> \\<epsilon>\\<rbrakk>\n  \\<Longrightarrow> hd (Dec \\<C> ?u) \\<noteq> ?b\n  no_head ?C ?b \\<subseteq> \\<langle>?C\\<rangle>\n\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>\\<C>\\<rangle> \\<and>\n    (x = \\<epsilon> \\<or> hd (Dec \\<C> x) \\<noteq> b)", "by blast"], ["proof (state)\nthis:\n  x \\<in> \\<langle>\\<C>\\<rangle> \\<and>\n  (x = \\<epsilon> \\<or> hd (Dec \\<C> x) \\<noteq> b)\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n                u = \\<epsilon> \\<or>\n                hd (Dec \\<C> u) \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head \\<C> b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n                u = \\<epsilon> \\<or>\n                hd (Dec \\<C> u) \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head \\<C> b", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n                u = \\<epsilon> \\<or>\n                hd (Dec \\<C> u) \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head \\<C> b", "assume \"x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>. u = \\<epsilon> \\<or> hd (Dec \\<C> u) \\<noteq> b}\""], ["proof (state)\nthis:\n  x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n           u = \\<epsilon> \\<or> hd (Dec \\<C> u) \\<noteq> b}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n                u = \\<epsilon> \\<or>\n                hd (Dec \\<C> u) \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head \\<C> b", "thus \"x \\<in> no_head \\<C> b\""], ["proof (prove)\nusing this:\n  x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n           u = \\<epsilon> \\<or> hd (Dec \\<C> u) \\<noteq> b}\n\ngoal (1 subgoal):\n 1. x \\<in> no_head \\<C> b", "using hd_no_head no_head.simps"], ["proof (prove)\nusing this:\n  x \\<in> {u \\<in> \\<langle>\\<C>\\<rangle>.\n           u = \\<epsilon> \\<or> hd (Dec \\<C> u) \\<noteq> b}\n  \\<lbrakk>?u \\<in> \\<langle>\\<C>\\<rangle>;\n   hd (Dec \\<C> ?u) \\<noteq> ?b\\<rbrakk>\n  \\<Longrightarrow> ?u \\<in> no_head \\<C> ?b\n  (?a \\<in> no_head ?C ?b) =\n  (?a = \\<epsilon> \\<or>\n   (\\<exists>u. ?a = u \\<and> u \\<in> ?C \\<and> u \\<noteq> ?b) \\<or>\n   (\\<exists>u v.\n       ?a = u \\<cdot> v \\<and>\n       u \\<noteq> \\<epsilon> \\<and>\n       u \\<in> no_head ?C ?b \\<and> v \\<in> \\<langle>?C\\<rangle>))\n\ngoal (1 subgoal):\n 1. x \\<in> no_head \\<C> b", "by blast"], ["proof (state)\nthis:\n  x \\<in> no_head \\<C> b\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "text\\<open>The set @{term no_head} is generated by the following set.\\<close>"], ["", "inductive_set no_head_gen :: \"'a list set \\<Rightarrow> 'a list \\<Rightarrow> 'a list set\"\n  for C b where\n    \"u \\<in> C \\<Longrightarrow> u \\<noteq> b \\<Longrightarrow> u \\<in> no_head_gen C b\" \n  | \"u \\<in> no_head_gen C b \\<Longrightarrow>  u \\<cdot> b \\<in> no_head_gen C b\""], ["", "lemma no_head_gen_set: \"no_head_gen C b = {z \\<cdot> b\\<^sup>@k |z k. z \\<in> C \\<and> z \\<noteq> b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. no_head_gen C b =\n    {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}", "proof(intro equalityI subsetI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> no_head_gen C b \\<Longrightarrow>\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\n 2. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> no_head_gen C b \\<Longrightarrow>\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\n 2. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "assume \"x \\<in> no_head_gen C b\""], ["proof (state)\nthis:\n  x \\<in> no_head_gen C b\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> no_head_gen C b \\<Longrightarrow>\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\n 2. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "hence \"\\<exists> z k. z \\<in> C \\<and> z \\<noteq> b \\<and> x = z \\<cdot> b\\<^sup>@k\""], ["proof (prove)\nusing this:\n  x \\<in> no_head_gen C b\n\ngoal (1 subgoal):\n 1. \\<exists>z k.\n       z \\<in> C \\<and> z \\<noteq> b \\<and> x = z \\<cdot> b \\<^sup>@ k", "proof (rule no_head_gen.induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> C; u \\<noteq> b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\n 2. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        \\<exists>z k.\n           z \\<in> C \\<and>\n           z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and>\n                            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "fix u"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> C; u \\<noteq> b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\n 2. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        \\<exists>z k.\n           z \\<in> C \\<and>\n           z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and>\n                            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "assume \"u \\<in> C\" and \"u \\<noteq> b\""], ["proof (state)\nthis:\n  u \\<in> C\n  u \\<noteq> b\n\ngoal (2 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> C; u \\<noteq> b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\n 2. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        \\<exists>z k.\n           z \\<in> C \\<and>\n           z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and>\n                            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "show \"\\<exists>z k. z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b\\<^sup>@k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>z k.\n       z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k", "using \\<open>u \\<in> C\\<close> \\<open>u \\<noteq> b\\<close> pow_zero"], ["proof (prove)\nusing this:\n  u \\<in> C\n  u \\<noteq> b\n  ?u \\<^sup>@ 0 = \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<exists>z k.\n       z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k", "by blast"], ["proof (state)\nthis:\n  \\<exists>z k.\n     z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        \\<exists>z k.\n           z \\<in> C \\<and>\n           z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and>\n                            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        \\<exists>z k.\n           z \\<in> C \\<and>\n           z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and>\n                            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "fix u"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        \\<exists>z k.\n           z \\<in> C \\<and>\n           z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and>\n                            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "assume \"u \\<in> no_head_gen C b\" and \"\\<exists>z k. z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b\\<^sup>@k\""], ["proof (state)\nthis:\n  u \\<in> no_head_gen C b\n  \\<exists>z k.\n     z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        \\<exists>z k.\n           z \\<in> C \\<and>\n           z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>z k.\n                            z \\<in> C \\<and>\n                            z \\<noteq> b \\<and>\n                            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "thus \"\\<exists>z k. z \\<in> C \\<and> z \\<noteq> b \\<and> u \\<cdot> b = z \\<cdot> b\\<^sup>@k\""], ["proof (prove)\nusing this:\n  u \\<in> no_head_gen C b\n  \\<exists>z k.\n     z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. \\<exists>z k.\n       z \\<in> C \\<and>\n       z \\<noteq> b \\<and> u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "using pow_Suc2_list append.assoc"], ["proof (prove)\nusing this:\n  u \\<in> no_head_gen C b\n  \\<exists>z k.\n     z \\<in> C \\<and> z \\<noteq> b \\<and> u = z \\<cdot> b \\<^sup>@ k\n  ?u \\<^sup>@ Suc ?n = ?u \\<^sup>@ ?n \\<cdot> ?u\n  (?a \\<cdot> ?b) \\<cdot> ?c = ?a \\<cdot> ?b \\<cdot> ?c\n\ngoal (1 subgoal):\n 1. \\<exists>z k.\n       z \\<in> C \\<and>\n       z \\<noteq> b \\<and> u \\<cdot> b = z \\<cdot> b \\<^sup>@ k", "by metis"], ["proof (state)\nthis:\n  \\<exists>z k.\n     z \\<in> C \\<and>\n     z \\<noteq> b \\<and> u \\<cdot> b = z \\<cdot> b \\<^sup>@ k\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<exists>z k.\n     z \\<in> C \\<and> z \\<noteq> b \\<and> x = z \\<cdot> b \\<^sup>@ k\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> no_head_gen C b \\<Longrightarrow>\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\n 2. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "thus \"x \\<in> {z \\<cdot> b\\<^sup>@k |z k. z \\<in> C \\<and> z \\<noteq> b}\""], ["proof (prove)\nusing this:\n  \\<exists>z k.\n     z \\<in> C \\<and> z \\<noteq> b \\<and> x = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}", "by auto"], ["proof (state)\nthis:\n  x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "assume \"x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\""], ["proof (state)\nthis:\n  x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "then"], ["proof (chain)\npicking this:\n  x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}", "obtain z k where \"z \\<in> C\" and \"z \\<noteq> b\" and \"x = z\\<cdot>b\\<^sup>@k\""], ["proof (prove)\nusing this:\n  x \\<in> {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}\n\ngoal (1 subgoal):\n 1. (\\<And>z k.\n        \\<lbrakk>z \\<in> C; z \\<noteq> b;\n         x = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  z \\<in> C\n  z \\<noteq> b\n  x = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {z \\<cdot> b \\<^sup>@ k |z k.\n                z \\<in> C \\<and> z \\<noteq> b} \\<Longrightarrow>\n       x \\<in> no_head_gen C b", "then"], ["proof (chain)\npicking this:\n  z \\<in> C\n  z \\<noteq> b\n  x = z \\<cdot> b \\<^sup>@ k", "show \"x \\<in> no_head_gen C b\""], ["proof (prove)\nusing this:\n  z \\<in> C\n  z \\<noteq> b\n  x = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. x \\<in> no_head_gen C b", "proof(induct k arbitrary: x)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>z \\<in> C; z \\<noteq> b; x = z \\<cdot> b \\<^sup>@ 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head_gen C b\n 2. \\<And>k x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>z \\<in> C; z \\<noteq> b;\n                    x = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n                   \\<Longrightarrow> x \\<in> no_head_gen C b;\n        z \\<in> C; z \\<noteq> b; x = z \\<cdot> b \\<^sup>@ Suc k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head_gen C b", "case 0"], ["proof (state)\nthis:\n  z \\<in> C\n  z \\<noteq> b\n  x = z \\<cdot> b \\<^sup>@ 0\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>z \\<in> C; z \\<noteq> b; x = z \\<cdot> b \\<^sup>@ 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head_gen C b\n 2. \\<And>k x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>z \\<in> C; z \\<noteq> b;\n                    x = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n                   \\<Longrightarrow> x \\<in> no_head_gen C b;\n        z \\<in> C; z \\<noteq> b; x = z \\<cdot> b \\<^sup>@ Suc k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head_gen C b", "then"], ["proof (chain)\npicking this:\n  z \\<in> C\n  z \\<noteq> b\n  x = z \\<cdot> b \\<^sup>@ 0", "show ?case"], ["proof (prove)\nusing this:\n  z \\<in> C\n  z \\<noteq> b\n  x = z \\<cdot> b \\<^sup>@ 0\n\ngoal (1 subgoal):\n 1. x \\<in> no_head_gen C b", "by (simp add: \\<open>z \\<in> C\\<close> \\<open>z \\<noteq> b\\<close> no_head_gen.intros(1))"], ["proof (state)\nthis:\n  x \\<in> no_head_gen C b\n\ngoal (1 subgoal):\n 1. \\<And>k x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>z \\<in> C; z \\<noteq> b;\n                    x = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n                   \\<Longrightarrow> x \\<in> no_head_gen C b;\n        z \\<in> C; z \\<noteq> b; x = z \\<cdot> b \\<^sup>@ Suc k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head_gen C b", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>z \\<in> C; z \\<noteq> b;\n                    x = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n                   \\<Longrightarrow> x \\<in> no_head_gen C b;\n        z \\<in> C; z \\<noteq> b; x = z \\<cdot> b \\<^sup>@ Suc k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head_gen C b", "case (Suc k)"], ["proof (state)\nthis:\n  \\<lbrakk>z \\<in> C; z \\<noteq> b; ?x = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n  \\<Longrightarrow> ?x \\<in> no_head_gen C b\n  z \\<in> C\n  z \\<noteq> b\n  x = z \\<cdot> b \\<^sup>@ Suc k\n\ngoal (1 subgoal):\n 1. \\<And>k x.\n       \\<lbrakk>\\<And>x.\n                   \\<lbrakk>z \\<in> C; z \\<noteq> b;\n                    x = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n                   \\<Longrightarrow> x \\<in> no_head_gen C b;\n        z \\<in> C; z \\<noteq> b; x = z \\<cdot> b \\<^sup>@ Suc k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head_gen C b", "from this(1)[OF this(2) this(3), of \"z \\<cdot> b \\<^sup>@ k\", \n        THEN no_head_gen.intros(2), unfolded rassoc, \n        folded pow_Suc2_list[of b k] \\<open>x = z\\<cdot>b\\<^sup>@Suc k\\<close>]"], ["proof (chain)\npicking this:\n  z \\<cdot> b \\<^sup>@ k = z \\<cdot> b \\<^sup>@ k \\<Longrightarrow>\n  x \\<in> no_head_gen C b", "show ?case"], ["proof (prove)\nusing this:\n  z \\<cdot> b \\<^sup>@ k = z \\<cdot> b \\<^sup>@ k \\<Longrightarrow>\n  x \\<in> no_head_gen C b\n\ngoal (1 subgoal):\n 1. x \\<in> no_head_gen C b", "by blast"], ["proof (state)\nthis:\n  x \\<in> no_head_gen C b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<in> no_head_gen C b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma no_head_genE: assumes \"u \\<in> no_head_gen C b\"\n  obtains z k where \"z \\<in> C\" and  \"z \\<noteq> b\" and \"u = z \\<cdot> b\\<^sup>@k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>z k.\n        \\<lbrakk>z \\<in> C; z \\<noteq> b;\n         u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof(induct rule: no_head_gen.induct[OF assms])"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> C; u \\<noteq> b;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis\n 2. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        (\\<And>z k.\n            \\<lbrakk>z \\<in> C; z \\<noteq> b;\n             u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n            \\<Longrightarrow> thesis) \\<Longrightarrow>\n        thesis;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis", "case (1 u)"], ["proof (state)\nthis:\n  u \\<in> C\n  u \\<noteq> b\n  \\<lbrakk>?z \\<in> C; ?z \\<noteq> b; u = ?z \\<cdot> b \\<^sup>@ ?k\\<rbrakk>\n  \\<Longrightarrow> thesis\n\ngoal (2 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> C; u \\<noteq> b;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis\n 2. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        (\\<And>z k.\n            \\<lbrakk>z \\<in> C; z \\<noteq> b;\n             u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n            \\<Longrightarrow> thesis) \\<Longrightarrow>\n        thesis;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. thesis", "using \"1.prems\"[OF \"1.hyps\", of 0]"], ["proof (prove)\nusing this:\n  u = u \\<cdot> b \\<^sup>@ 0 \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. thesis", "by simp"], ["proof (state)\nthis:\n  thesis\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        (\\<And>z k.\n            \\<lbrakk>z \\<in> C; z \\<noteq> b;\n             u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n            \\<Longrightarrow> thesis) \\<Longrightarrow>\n        thesis;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        (\\<And>z k.\n            \\<lbrakk>z \\<in> C; z \\<noteq> b;\n             u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n            \\<Longrightarrow> thesis) \\<Longrightarrow>\n        thesis;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis", "case (2 u)"], ["proof (state)\nthis:\n  u \\<in> no_head_gen C b\n  (\\<And>z k.\n      \\<lbrakk>z \\<in> C; z \\<noteq> b; u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n      \\<Longrightarrow> thesis) \\<Longrightarrow>\n  thesis\n  \\<lbrakk>?z \\<in> C; ?z \\<noteq> b;\n   u \\<cdot> b = ?z \\<cdot> b \\<^sup>@ ?k\\<rbrakk>\n  \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        (\\<And>z k.\n            \\<lbrakk>z \\<in> C; z \\<noteq> b;\n             u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n            \\<Longrightarrow> thesis) \\<Longrightarrow>\n        thesis;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis", "have \"(z \\<cdot> b\\<^sup>@k) \\<cdot> b = z \\<cdot> b\\<^sup>@(Suc k)\" for z k"], ["proof (prove)\ngoal (1 subgoal):\n 1. (z \\<cdot> b \\<^sup>@ k) \\<cdot> b = z \\<cdot> b \\<^sup>@ Suc k", "by (simp add: power_commutes)"], ["proof (state)\nthis:\n  (?z \\<cdot> b \\<^sup>@ ?k) \\<cdot> b = ?z \\<cdot> b \\<^sup>@ Suc ?k\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen C b;\n        (\\<And>z k.\n            \\<lbrakk>z \\<in> C; z \\<noteq> b;\n             u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n            \\<Longrightarrow> thesis) \\<Longrightarrow>\n        thesis;\n        \\<And>z k.\n           \\<lbrakk>z \\<in> C; z \\<noteq> b;\n            u \\<cdot> b = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n           \\<Longrightarrow> thesis\\<rbrakk>\n       \\<Longrightarrow> thesis", "then"], ["proof (chain)\npicking this:\n  (?z \\<cdot> b \\<^sup>@ ?k) \\<cdot> b = ?z \\<cdot> b \\<^sup>@ Suc ?k", "show ?case"], ["proof (prove)\nusing this:\n  (?z \\<cdot> b \\<^sup>@ ?k) \\<cdot> b = ?z \\<cdot> b \\<^sup>@ Suc ?k\n\ngoal (1 subgoal):\n 1. thesis", "using \"2.prems\" \"2.hyps\"(2)"], ["proof (prove)\nusing this:\n  (?z \\<cdot> b \\<^sup>@ ?k) \\<cdot> b = ?z \\<cdot> b \\<^sup>@ Suc ?k\n  \\<lbrakk>?z \\<in> C; ?z \\<noteq> b;\n   u \\<cdot> b = ?z \\<cdot> b \\<^sup>@ ?k\\<rbrakk>\n  \\<Longrightarrow> thesis\n  (\\<And>z k.\n      \\<lbrakk>z \\<in> C; z \\<noteq> b; u = z \\<cdot> b \\<^sup>@ k\\<rbrakk>\n      \\<Longrightarrow> thesis) \\<Longrightarrow>\n  thesis\n\ngoal (1 subgoal):\n 1. thesis", "by blast"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "context code\nbegin"], ["", "text\\<open>We show that this indeed is a set of generators\\<close>"], ["", "lemma emp_not_in_Cb: \"\\<epsilon> \\<notin> no_head_gen \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<epsilon> \\<notin> no_head_gen \\<C> b", "by (simp add: emp_not_in_code no_head_gen_set)"], ["", "lemma no_head_sub': \"b \\<in> \\<C> \\<Longrightarrow> no_head_gen \\<C> b \\<subseteq> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b \\<in> \\<C> \\<Longrightarrow>\n    no_head_gen \\<C> b \\<subseteq> no_head \\<C> b", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>b \\<in> \\<C>; x \\<in> no_head_gen \\<C> b\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head \\<C> b", "fix u"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>b \\<in> \\<C>; x \\<in> no_head_gen \\<C> b\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head \\<C> b", "assume \"b \\<in> \\<C>\" \"u \\<in> no_head_gen \\<C> b\""], ["proof (state)\nthis:\n  b \\<in> \\<C>\n  u \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>b \\<in> \\<C>; x \\<in> no_head_gen \\<C> b\\<rbrakk>\n       \\<Longrightarrow> x \\<in> no_head \\<C> b", "show \"u \\<in> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<in> no_head \\<C> b", "proof (induction rule: no_head_gen.induct[OF \\<open>u \\<in> no_head_gen \\<C> b\\<close>], simp add: no_head.intros(2))"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen \\<C> b; u \\<in> no_head \\<C> b\\<rbrakk>\n       \\<Longrightarrow> u \\<cdot> b \\<in> no_head \\<C> b", "case (2 u)"], ["proof (state)\nthis:\n  u \\<in> no_head_gen \\<C> b\n  u \\<in> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>u \\<in> no_head_gen \\<C> b; u \\<in> no_head \\<C> b\\<rbrakk>\n       \\<Longrightarrow> u \\<cdot> b \\<in> no_head \\<C> b", "show \"u \\<cdot> b \\<in> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<cdot> b \\<in> no_head \\<C> b", "using no_head.intros(3)[OF _ \\<open>u \\<in> no_head \\<C> b\\<close> gen_in[OF \\<open>b \\<in> \\<C>\\<close>]]\n       \"2.hyps\" emp_not_in_Cb"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon> \\<Longrightarrow> u \\<cdot> b \\<in> no_head \\<C> b\n  u \\<in> no_head_gen \\<C> b\n  \\<epsilon> \\<notin> no_head_gen \\<C> ?b\n\ngoal (1 subgoal):\n 1. u \\<cdot> b \\<in> no_head \\<C> b", "by blast"], ["proof (state)\nthis:\n  u \\<cdot> b \\<in> no_head \\<C> b\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u \\<in> no_head \\<C> b\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma no_head_generates0: assumes \"v \\<in> \\<langle>\\<C>\\<rangle>\" shows \n  \"u \\<noteq> \\<epsilon> \\<longrightarrow> u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow> u \\<cdot> v \\<in>  \\<langle>no_head_gen \\<C> b\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> \\<longrightarrow>\n    u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n    u \\<cdot> v \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "proof (induct arbitrary: u rule: hull.induct[OF \\<open>v \\<in> \\<langle>\\<C>\\<rangle>\\<close>], simp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>w1 w2 u.\n       \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n        \\<And>u.\n           u \\<noteq> \\<epsilon> \\<longrightarrow>\n           u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n           u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                         u \\<in> \\<langle>no_head_gen \\<C>\n     b\\<rangle> \\<longrightarrow>\n                         u \\<cdot> w1 \\<cdot> w2\n                         \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "case (2 w1 w2)"], ["proof (state)\nthis:\n  w1 \\<in> \\<C>\n  w2 \\<in> \\<langle>\\<C>\\<rangle>\n  ?u \\<noteq> \\<epsilon> \\<longrightarrow>\n  ?u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n  ?u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>w1 w2 u.\n       \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n        \\<And>u.\n           u \\<noteq> \\<epsilon> \\<longrightarrow>\n           u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n           u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                         u \\<in> \\<langle>no_head_gen \\<C>\n     b\\<rangle> \\<longrightarrow>\n                         u \\<cdot> w1 \\<cdot> w2\n                         \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "then"], ["proof (chain)\npicking this:\n  w1 \\<in> \\<C>\n  w2 \\<in> \\<langle>\\<C>\\<rangle>\n  ?u \\<noteq> \\<epsilon> \\<longrightarrow>\n  ?u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n  ?u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "show ?case"], ["proof (prove)\nusing this:\n  w1 \\<in> \\<C>\n  w2 \\<in> \\<langle>\\<C>\\<rangle>\n  ?u \\<noteq> \\<epsilon> \\<longrightarrow>\n  ?u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n  ?u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> \\<longrightarrow>\n    u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n    u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "proof(cases \"w1 = b\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n     \\<And>u.\n        u \\<noteq> \\<epsilon> \\<longrightarrow>\n        u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n        u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n     w1 = b\\<rbrakk>\n    \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                      u \\<in> \\<langle>no_head_gen \\<C>\n  b\\<rangle> \\<longrightarrow>\n                      u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n 2. \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n     \\<And>u.\n        u \\<noteq> \\<epsilon> \\<longrightarrow>\n        u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n        u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n     w1 \\<noteq> b\\<rbrakk>\n    \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                      u \\<in> \\<langle>no_head_gen \\<C>\n  b\\<rangle> \\<longrightarrow>\n                      u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "assume \"w1 \\<noteq> b\""], ["proof (state)\nthis:\n  w1 \\<noteq> b\n\ngoal (2 subgoals):\n 1. \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n     \\<And>u.\n        u \\<noteq> \\<epsilon> \\<longrightarrow>\n        u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n        u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n     w1 = b\\<rbrakk>\n    \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                      u \\<in> \\<langle>no_head_gen \\<C>\n  b\\<rangle> \\<longrightarrow>\n                      u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n 2. \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n     \\<And>u.\n        u \\<noteq> \\<epsilon> \\<longrightarrow>\n        u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n        u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n     w1 \\<noteq> b\\<rbrakk>\n    \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                      u \\<in> \\<langle>no_head_gen \\<C>\n  b\\<rangle> \\<longrightarrow>\n                      u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> \\<longrightarrow>\n    u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n    u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "using \"2.hyps\"(1) emp_not_in_code  no_head_gen.intros(1)[OF \\<open>w1 \\<in> \\<C>\\<close> \\<open>w1 \\<noteq> b\\<close>,THEN gen_in]\n            \"2.hyps\"(3)[of w1] hull_closed[of u \"no_head_gen \\<C> b\" \"w1\\<cdot> w2\"]"], ["proof (prove)\nusing this:\n  w1 \\<in> \\<C>\n  \\<epsilon> \\<notin> \\<C>\n  w1 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  w1 \\<noteq> \\<epsilon> \\<longrightarrow>\n  w1 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n  w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  \\<lbrakk>u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n   w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                    \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> \\<longrightarrow>\n    u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n    u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "by blast"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon> \\<longrightarrow>\n  u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n  u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n     \\<And>u.\n        u \\<noteq> \\<epsilon> \\<longrightarrow>\n        u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n        u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n     w1 = b\\<rbrakk>\n    \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                      u \\<in> \\<langle>no_head_gen \\<C>\n  b\\<rangle> \\<longrightarrow>\n                      u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n     \\<And>u.\n        u \\<noteq> \\<epsilon> \\<longrightarrow>\n        u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n        u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n     w1 = b\\<rbrakk>\n    \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                      u \\<in> \\<langle>no_head_gen \\<C>\n  b\\<rangle> \\<longrightarrow>\n                      u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "assume \"w1 = b\""], ["proof (state)\nthis:\n  w1 = b\n\ngoal (1 subgoal):\n 1. \\<lbrakk>w1 \\<in> \\<C>; w2 \\<in> \\<langle>\\<C>\\<rangle>;\n     \\<And>u.\n        u \\<noteq> \\<epsilon> \\<longrightarrow>\n        u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n        u \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>;\n     w1 = b\\<rbrakk>\n    \\<Longrightarrow> u \\<noteq> \\<epsilon> \\<longrightarrow>\n                      u \\<in> \\<langle>no_head_gen \\<C>\n  b\\<rangle> \\<longrightarrow>\n                      u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> \\<longrightarrow>\n    u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n    u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "proof (standard, standard)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> \\<epsilon>;\n     u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "assume \"u \\<noteq> \\<epsilon>\" and \"u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\""], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon>\n  u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> \\<epsilon>;\n     u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "hence dec_nemp: \"Dec (no_head_gen \\<C> b) u \\<noteq> \\<epsilon>\""], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. Dec no_head_gen \\<C> b u \\<noteq> \\<epsilon>", "using dec_nemp'"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  \\<lbrakk>?u \\<noteq> \\<epsilon>; ?u \\<in> \\<langle>?G\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> Dec ?G ?u \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. Dec no_head_gen \\<C> b u \\<noteq> \\<epsilon>", "by blast"], ["proof (state)\nthis:\n  Dec no_head_gen \\<C> b u \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> \\<epsilon>;\n     u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "from concat_butlast_last[OF this]"], ["proof (chain)\npicking this:\n  concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n  last (Dec no_head_gen \\<C> b u) =\n  concat (Dec no_head_gen \\<C> b u)", "have u_w1: \"u \\<cdot> w1 = concat (butlast (Dec (no_head_gen \\<C> b) u)) \\<cdot> (last (Dec (no_head_gen \\<C> b) u) \\<cdot> w1)\""], ["proof (prove)\nusing this:\n  concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n  last (Dec no_head_gen \\<C> b u) =\n  concat (Dec no_head_gen \\<C> b u)\n\ngoal (1 subgoal):\n 1. u \\<cdot> w1 =\n    concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n    last (Dec no_head_gen \\<C> b u) \\<cdot> w1", "unfolding decI[OF \\<open>u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<close>]"], ["proof (prove)\nusing this:\n  concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n  last (Dec no_head_gen \\<C> b u) =\n  u\n\ngoal (1 subgoal):\n 1. u \\<cdot> w1 =\n    concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n    last (Dec no_head_gen \\<C> b u) \\<cdot> w1", "by simp"], ["proof (state)\nthis:\n  u \\<cdot> w1 =\n  concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n  last (Dec no_head_gen \\<C> b u) \\<cdot> w1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> \\<epsilon>;\n     u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "from dec_dom'[OF \\<open>u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<close>] append_butlast_last_id[OF dec_nemp]"], ["proof (chain)\npicking this:\n  Dec no_head_gen \\<C> b u \\<in> lists (no_head_gen \\<C> b)\n  butlast (Dec no_head_gen \\<C> b u) \\<cdot>\n  [last (Dec no_head_gen \\<C> b u)] =\n  Dec no_head_gen \\<C> b u", "have con_but: \"concat (butlast (Dec (no_head_gen \\<C> b) u)) \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\" and last_in: \"last (Dec (no_head_gen \\<C> b) u) \\<in> no_head_gen \\<C> b\""], ["proof (prove)\nusing this:\n  Dec no_head_gen \\<C> b u \\<in> lists (no_head_gen \\<C> b)\n  butlast (Dec no_head_gen \\<C> b u) \\<cdot>\n  [last (Dec no_head_gen \\<C> b u)] =\n  Dec no_head_gen \\<C> b u\n\ngoal (1 subgoal):\n 1. concat (butlast (Dec no_head_gen \\<C> b u))\n    \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> &&&\n    last (Dec no_head_gen \\<C> b u) \\<in> no_head_gen \\<C> b", "using append_in_lists_conv[of \"butlast (Dec (no_head_gen \\<C> b) u)\" \"[last (Dec (no_head_gen \\<C> b) u)]\" \"no_head_gen \\<C> b\"] \n          concat_in_hull'[of \"butlast (Dec (no_head_gen \\<C> b) u)\" \"no_head_gen \\<C> b\"]"], ["proof (prove)\nusing this:\n  Dec no_head_gen \\<C> b u \\<in> lists (no_head_gen \\<C> b)\n  butlast (Dec no_head_gen \\<C> b u) \\<cdot>\n  [last (Dec no_head_gen \\<C> b u)] =\n  Dec no_head_gen \\<C> b u\n  (butlast (Dec no_head_gen \\<C> b u) \\<cdot>\n   [last (Dec no_head_gen \\<C> b u)]\n   \\<in> lists (no_head_gen \\<C> b)) =\n  (butlast (Dec no_head_gen \\<C> b u)\n   \\<in> lists (no_head_gen \\<C> b) \\<and>\n   [last (Dec no_head_gen \\<C> b u)] \\<in> lists (no_head_gen \\<C> b))\n  butlast (Dec no_head_gen \\<C> b u)\n  \\<in> lists (no_head_gen \\<C> b) \\<Longrightarrow>\n  concat (butlast (Dec no_head_gen \\<C> b u))\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. concat (butlast (Dec no_head_gen \\<C> b u))\n    \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> &&&\n    last (Dec no_head_gen \\<C> b u) \\<in> no_head_gen \\<C> b", "by auto"], ["proof (state)\nthis:\n  concat (butlast (Dec no_head_gen \\<C> b u))\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  last (Dec no_head_gen \\<C> b u) \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> \\<epsilon>;\n     u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "hence \"last (Dec (no_head_gen \\<C> b) u) \\<cdot> w1 \\<in> no_head_gen \\<C> b\""], ["proof (prove)\nusing this:\n  concat (butlast (Dec no_head_gen \\<C> b u))\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  last (Dec no_head_gen \\<C> b u) \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. last (Dec no_head_gen \\<C> b u) \\<cdot> w1 \\<in> no_head_gen \\<C> b", "unfolding \\<open>w1 = b\\<close>"], ["proof (prove)\nusing this:\n  concat (butlast (Dec no_head_gen \\<C> b u))\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  last (Dec no_head_gen \\<C> b u) \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. last (Dec no_head_gen \\<C> b u) \\<cdot> b \\<in> no_head_gen \\<C> b", "using  no_head_gen.intros(2)[of \"last (Dec (no_head_gen \\<C> b) u)\" \\<C> b]"], ["proof (prove)\nusing this:\n  concat (butlast (Dec no_head_gen \\<C> b u))\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  last (Dec no_head_gen \\<C> b u) \\<in> no_head_gen \\<C> b\n  last (Dec no_head_gen \\<C> b u) \\<in> no_head_gen \\<C> b \\<Longrightarrow>\n  last (Dec no_head_gen \\<C> b u) \\<cdot> b \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. last (Dec no_head_gen \\<C> b u) \\<cdot> b \\<in> no_head_gen \\<C> b", "by blast"], ["proof (state)\nthis:\n  last (Dec no_head_gen \\<C> b u) \\<cdot> w1 \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> \\<epsilon>;\n     u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "from this[THEN  gen_in,THEN[2] hull_closed, OF con_but]"], ["proof (chain)\npicking this:\n  concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n  last (Dec no_head_gen \\<C> b u) \\<cdot> w1\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "have \"u \\<cdot> w1 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\""], ["proof (prove)\nusing this:\n  concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n  last (Dec no_head_gen \\<C> b u) \\<cdot> w1\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. u \\<cdot> w1 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "unfolding u_w1"], ["proof (prove)\nusing this:\n  concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n  last (Dec no_head_gen \\<C> b u) \\<cdot> w1\n  \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. concat (butlast (Dec no_head_gen \\<C> b u)) \\<cdot>\n    last (Dec no_head_gen \\<C> b u) \\<cdot> w1\n    \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "."], ["proof (state)\nthis:\n  u \\<cdot> w1 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>u \\<noteq> \\<epsilon>;\n     u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot> w1 \\<cdot> w2\n                      \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "from \"2.hyps\"(3)[rule_format, OF _ this, unfolded rassoc]"], ["proof (chain)\npicking this:\n  u \\<cdot> w1 \\<noteq> \\<epsilon> \\<Longrightarrow>\n  u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "show \"u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\""], ["proof (prove)\nusing this:\n  u \\<cdot> w1 \\<noteq> \\<epsilon> \\<Longrightarrow>\n  u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "using  pref_nemp[OF \\<open>u\\<noteq>\\<epsilon>\\<close>]"], ["proof (prove)\nusing this:\n  u \\<cdot> w1 \\<noteq> \\<epsilon> \\<Longrightarrow>\n  u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n  u \\<cdot> ?v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "by blast"], ["proof (state)\nthis:\n  u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon> \\<longrightarrow>\n  u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n  u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon> \\<longrightarrow>\n  u \\<in> \\<langle>no_head_gen \\<C> b\\<rangle> \\<longrightarrow>\n  u \\<cdot> w1 \\<cdot> w2 \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem no_head_generates: assumes \"b \\<in> \\<C>\" shows \"\\<langle>no_head_gen \\<C> b\\<rangle> =  no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>no_head_gen \\<C> b\\<rangle> = no_head \\<C> b", "proof (intro equalityI)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<langle>no_head_gen \\<C> b\\<rangle> \\<subseteq> no_head \\<C> b\n 2. no_head \\<C> b \\<subseteq> \\<langle>no_head_gen \\<C> b\\<rangle>", "show \"\\<langle>no_head_gen \\<C> b\\<rangle> \\<subseteq> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>no_head_gen \\<C> b\\<rangle> \\<subseteq> no_head \\<C> b", "using hull_mon[OF no_head_sub'[OF \\<open>b \\<in> \\<C>\\<close>]]"], ["proof (prove)\nusing this:\n  \\<langle>no_head_gen \\<C> b\\<rangle>\n  \\<subseteq> \\<langle>no_head \\<C> b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<langle>no_head_gen \\<C> b\\<rangle> \\<subseteq> no_head \\<C> b", "unfolding no_head_closed"], ["proof (prove)\nusing this:\n  \\<langle>no_head_gen \\<C> b\\<rangle> \\<subseteq> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. \\<langle>no_head_gen \\<C> b\\<rangle> \\<subseteq> no_head \\<C> b", "."], ["proof (state)\nthis:\n  \\<langle>no_head_gen \\<C> b\\<rangle> \\<subseteq> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. no_head \\<C> b \\<subseteq> \\<langle>no_head_gen \\<C> b\\<rangle>", "show \"no_head \\<C> b \\<subseteq> \\<langle>no_head_gen \\<C> b\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. no_head \\<C> b \\<subseteq> \\<langle>no_head_gen \\<C> b\\<rangle>", "proof (intro subsetI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> no_head \\<C> b \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> no_head \\<C> b \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "assume \"x \\<in> no_head \\<C> b\""], ["proof (state)\nthis:\n  x \\<in> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> no_head \\<C> b \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "show \"x \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>", "by (induct rule: no_head.induct[OF \\<open>x \\<in> no_head \\<C> b\\<close>],auto, simp add: gen_in no_head_gen.intros(1),simp add: no_head_generates0)"], ["proof (state)\nthis:\n  x \\<in> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  no_head \\<C> b \\<subseteq> \\<langle>no_head_gen \\<C> b\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Moreover, the generating set @{term no_head_gen} is a code\\<close>"], ["", "lemma lists_no_head_sub: \"b \\<in> \\<C> \\<Longrightarrow> us \\<in> lists (no_head_gen \\<C> b) \\<Longrightarrow> us \\<in> lists \\<langle>\\<C>\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b \\<in> \\<C>; us \\<in> lists (no_head_gen \\<C> b)\\<rbrakk>\n    \\<Longrightarrow> us \\<in> lists \\<langle>\\<C>\\<rangle>", "using no_head_sub' no_head_sub"], ["proof (prove)\nusing this:\n  ?b \\<in> \\<C> \\<Longrightarrow>\n  no_head_gen \\<C> ?b \\<subseteq> no_head \\<C> ?b\n  no_head ?C ?b \\<subseteq> \\<langle>?C\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>b \\<in> \\<C>; us \\<in> lists (no_head_gen \\<C> b)\\<rbrakk>\n    \\<Longrightarrow> us \\<in> lists \\<langle>\\<C>\\<rangle>", "by blast"], ["", "lemma ref_hd: assumes \"z \\<in> \\<C>\" and  \"b \\<in> \\<C>\" and \"z \\<noteq> b\" and \"vs \\<in> lists (no_head_gen \\<C> b)\" \n  shows \"refine \\<C> ((z\\<cdot>b\\<^sup>@k) # vs) = [z]\\<cdot>[b]\\<^sup>@k \\<cdot> refine \\<C> vs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs", "have \"refine \\<C> ((z\\<cdot>b\\<^sup>@k) # vs) = (Dec \\<C> (z\\<cdot>b\\<^sup>@k)) \\<cdot> refine \\<C> vs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    (Dec \\<C> z \\<cdot> b \\<^sup>@ k) \\<cdot> Ref \\<C> vs", "using ref_pop_hd lists_no_head_sub[OF \\<open>b \\<in> \\<C>\\<close>]"], ["proof (prove)\nusing this:\n  \\<lbrakk>?us \\<noteq> \\<epsilon>;\n   ?us \\<in> lists \\<langle>?G\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> Ref ?G ?us = (Dec ?G hd ?us) \\<cdot> Ref ?G tl ?us\n  ?us \\<in> lists (no_head_gen \\<C> b) \\<Longrightarrow>\n  ?us \\<in> lists \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    (Dec \\<C> z \\<cdot> b \\<^sup>@ k) \\<cdot> Ref \\<C> vs", "by simp"], ["proof (state)\nthis:\n  Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n  (Dec \\<C> z \\<cdot> b \\<^sup>@ k) \\<cdot> Ref \\<C> vs\n\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs", "have \"[z]\\<cdot>[b]\\<^sup>@k \\<in> lists \\<C>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. [z] \\<cdot> [b] \\<^sup>@ k \\<in> lists \\<C>", "by (induct k, simp add: \\<open>z \\<in> \\<C>\\<close>, simp add: \\<open>b \\<in> \\<C>\\<close>)"], ["proof (state)\nthis:\n  [z] \\<cdot> [b] \\<^sup>@ k \\<in> lists \\<C>\n\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs", "have \"concat ([z]\\<cdot>[b]\\<^sup>@k) = z \\<cdot> b\\<^sup>@k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. concat ([z] \\<cdot> [b] \\<^sup>@ k) = z \\<cdot> b \\<^sup>@ k", "using concat_sing_pow"], ["proof (prove)\nusing this:\n  concat ([?a] \\<^sup>@ ?k) = ?a \\<^sup>@ ?k\n\ngoal (1 subgoal):\n 1. concat ([z] \\<cdot> [b] \\<^sup>@ k) = z \\<cdot> b \\<^sup>@ k", "by auto"], ["proof (state)\nthis:\n  concat ([z] \\<cdot> [b] \\<^sup>@ k) = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs", "hence \"Dec \\<C> (z\\<cdot>b\\<^sup>@k) = [z]\\<cdot>[b]\\<^sup>@k\""], ["proof (prove)\nusing this:\n  concat ([z] \\<cdot> [b] \\<^sup>@ k) = z \\<cdot> b \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. Dec \\<C> z \\<cdot> b \\<^sup>@ k = [z] \\<cdot> [b] \\<^sup>@ k", "using  code.code_unique_dec[OF code_axioms \\<open>[z]\\<cdot>[b]\\<^sup>@k \\<in> lists \\<C>\\<close>]"], ["proof (prove)\nusing this:\n  concat ([z] \\<cdot> [b] \\<^sup>@ k) = z \\<cdot> b \\<^sup>@ k\n  Dec \\<C> concat ([z] \\<cdot> [b] \\<^sup>@ k) = [z] \\<cdot> [b] \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. Dec \\<C> z \\<cdot> b \\<^sup>@ k = [z] \\<cdot> [b] \\<^sup>@ k", "by auto"], ["proof (state)\nthis:\n  Dec \\<C> z \\<cdot> b \\<^sup>@ k = [z] \\<cdot> [b] \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs", "thus ?thesis"], ["proof (prove)\nusing this:\n  Dec \\<C> z \\<cdot> b \\<^sup>@ k = [z] \\<cdot> [b] \\<^sup>@ k\n\ngoal (1 subgoal):\n 1. Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n    [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs", "by simp"], ["proof (state)\nthis:\n  Ref \\<C> (z \\<cdot> b \\<^sup>@ k) # vs =\n  [z] \\<cdot> [b] \\<^sup>@ k \\<cdot> Ref \\<C> vs\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma no_head_gen_code_ind_step:\n  assumes \"vs \\<in> lists (no_head_gen \\<C> b)\" \"us \\<in> lists (no_head_gen \\<C> b)\" \"b \\<in> \\<C>\"\n    and eq: \"[b]\\<^sup>@ku \\<cdot> (refine \\<C> us) = [b]\\<^sup>@kv \\<cdot> (refine \\<C> vs)\"\n  shows  \"ku = kv\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ku = kv", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. ku = kv", "{"], ["proof (state)\ngoal (1 subgoal):\n 1. ku = kv", "fix ku :: nat and kv and us and vs and b"], ["proof (state)\ngoal (1 subgoal):\n 1. ku = kv", "assume \"kv \\<le> ku\" \"[b]\\<^sup>@ku \\<cdot> (refine \\<C> us) = [b]\\<^sup>@kv \\<cdot> (refine \\<C> vs)\"\n      \"vs \\<in> lists (no_head_gen \\<C> b)\" \"us \\<in> lists (no_head_gen \\<C> b)\" \"b \\<in> \\<C>\""], ["proof (state)\nthis:\n  kv \\<le> ku\n  [b] \\<^sup>@ ku \\<cdot> Ref \\<C> us = [b] \\<^sup>@ kv \\<cdot> Ref \\<C> vs\n  vs \\<in> lists (no_head_gen \\<C> b)\n  us \\<in> lists (no_head_gen \\<C> b)\n  b \\<in> \\<C>\n\ngoal (1 subgoal):\n 1. ku = kv", "have  \"concat vs \\<in> no_head \\<C> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. concat vs \\<in> no_head \\<C> b", "using  \\<open>vs \\<in> lists (no_head_gen \\<C> b)\\<close> no_head_generates[OF \\<open>b \\<in> \\<C>\\<close>]"], ["proof (prove)\nusing this:\n  vs \\<in> lists (no_head_gen \\<C> b)\n  \\<langle>no_head_gen \\<C> b\\<rangle> = no_head \\<C> b\n\ngoal (1 subgoal):\n 1. concat vs \\<in> no_head \\<C> b", "by fastforce"], ["proof (state)\nthis:\n  concat vs \\<in> no_head \\<C> b\n\ngoal (1 subgoal):\n 1. ku = kv", "have  \"Ref \\<C> vs = Dec \\<C> (concat vs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ref \\<C> vs = Dec \\<C> concat vs", "using \\<open>vs \\<in> lists (no_head_gen \\<C> b)\\<close> \\<open>b \\<in> \\<C>\\<close> code_unique_ref lists_no_head_sub"], ["proof (prove)\nusing this:\n  vs \\<in> lists (no_head_gen \\<C> b)\n  b \\<in> \\<C>\n  ?us \\<in> lists \\<langle>\\<C>\\<rangle> \\<Longrightarrow>\n  Ref \\<C> ?us = Dec \\<C> concat ?us\n  \\<lbrakk>?b \\<in> \\<C>; ?us \\<in> lists (no_head_gen \\<C> ?b)\\<rbrakk>\n  \\<Longrightarrow> ?us \\<in> lists \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. Ref \\<C> vs = Dec \\<C> concat vs", "by auto"], ["proof (state)\nthis:\n  Ref \\<C> vs = Dec \\<C> concat vs\n\ngoal (1 subgoal):\n 1. ku = kv", "have \"vs \\<noteq> \\<epsilon> \\<Longrightarrow> concat vs \\<noteq> \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. vs \\<noteq> \\<epsilon> \\<Longrightarrow> concat vs \\<noteq> \\<epsilon>", "using  emp_not_in_Cb[of b] concat.simps(2) \\<open>vs \\<in> lists (no_head_gen \\<C> b)\\<close>[unfolded lists.simps[of vs]]\n        pref_nemp"], ["proof (prove)\nusing this:\n  \\<epsilon> \\<notin> no_head_gen \\<C> b\n  concat (?x # ?xs) = ?x \\<cdot> concat ?xs\n  vs = \\<epsilon> \\<or>\n  (\\<exists>a l.\n      vs = a # l \\<and>\n      a \\<in> no_head_gen \\<C> b \\<and> l \\<in> lists (no_head_gen \\<C> b))\n  ?u \\<noteq> \\<epsilon> \\<Longrightarrow> ?u \\<cdot> ?v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. vs \\<noteq> \\<epsilon> \\<Longrightarrow> concat vs \\<noteq> \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  vs \\<noteq> \\<epsilon> \\<Longrightarrow> concat vs \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. ku = kv", "have \"[b]\\<^sup>@(ku - kv) \\<cdot> (refine \\<C> us) = refine \\<C> vs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. [b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us = Ref \\<C> vs", "using \\<open>kv \\<le> ku\\<close> eq pop_pow_cancel \\<open>[b]\\<^sup>@ku \\<cdot> (refine \\<C> us) = [b]\\<^sup>@kv \\<cdot> (refine \\<C> vs) \\<close>"], ["proof (prove)\nusing this:\n  kv \\<le> ku\n  [b] \\<^sup>@ ku \\<cdot> Ref \\<C> us = [b] \\<^sup>@ kv \\<cdot> Ref \\<C> vs\n  \\<lbrakk>?u \\<^sup>@ ?k \\<cdot> ?v = ?u \\<^sup>@ ?m \\<cdot> ?w;\n   ?m \\<le> ?k\\<rbrakk>\n  \\<Longrightarrow> ?u \\<^sup>@ (?k - ?m) \\<cdot> ?v = ?w\n  [b] \\<^sup>@ ku \\<cdot> Ref \\<C> us = [b] \\<^sup>@ kv \\<cdot> Ref \\<C> vs\n\ngoal (1 subgoal):\n 1. [b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us = Ref \\<C> vs", "by blast"], ["proof (state)\nthis:\n  [b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us = Ref \\<C> vs\n\ngoal (1 subgoal):\n 1. ku = kv", "hence \"ku - kv \\<noteq> 0 \\<Longrightarrow> hd (refine \\<C> vs) = b \\<and> vs \\<noteq> \\<epsilon>\""], ["proof (prove)\nusing this:\n  [b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us = Ref \\<C> vs\n\ngoal (1 subgoal):\n 1. ku - kv \\<noteq> 0 \\<Longrightarrow>\n    hd (Ref \\<C> vs) = b \\<and> vs \\<noteq> \\<epsilon>", "using hd_append2[of \"[b]\\<^sup>@(ku - kv)\" \"refine \\<C> us\"]  \\<open>[b]\\<^sup>@(ku - kv) \\<cdot> (refine \\<C> us) = refine \\<C> vs\\<close>\n        hd_sing_power[of \"ku - kv\" b] \n        append_is_Nil_conv[of \"[b]\\<^sup>@(ku - kv)\" \"refine \\<C> us\"]  sing_pow_empty[of b \"ku - kv\"]\n        dec_emp[of \\<C>]"], ["proof (prove)\nusing this:\n  [b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us = Ref \\<C> vs\n  [b] \\<^sup>@ (ku - kv) \\<noteq> \\<epsilon> \\<Longrightarrow>\n  hd ([b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us) =\n  hd ([b] \\<^sup>@ (ku - kv))\n  [b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us = Ref \\<C> vs\n  ku - kv \\<noteq> 0 \\<Longrightarrow> hd ([b] \\<^sup>@ (ku - kv)) = b\n  ([b] \\<^sup>@ (ku - kv) \\<cdot> Ref \\<C> us = \\<epsilon>) =\n  ([b] \\<^sup>@ (ku - kv) = \\<epsilon> \\<and> Ref \\<C> us = \\<epsilon>)\n  ([b] \\<^sup>@ (ku - kv) = \\<epsilon>) = (ku - kv = 0)\n  Dec \\<C> \\<epsilon> = \\<epsilon>\n\ngoal (1 subgoal):\n 1. ku - kv \\<noteq> 0 \\<Longrightarrow>\n    hd (Ref \\<C> vs) = b \\<and> vs \\<noteq> \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  ku - kv \\<noteq> 0 \\<Longrightarrow>\n  hd (Ref \\<C> vs) = b \\<and> vs \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. ku = kv", "hence \"ku = kv\""], ["proof (prove)\nusing this:\n  ku - kv \\<noteq> 0 \\<Longrightarrow>\n  hd (Ref \\<C> vs) = b \\<and> vs \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. ku = kv", "using \\<open>kv \\<le> ku\\<close> no_head_hd[OF \\<open>concat vs \\<in> no_head \\<C> b\\<close>] \\<open>vs \\<noteq> \\<epsilon> \\<Longrightarrow> concat vs \\<noteq> \\<epsilon>\\<close>"], ["proof (prove)\nusing this:\n  ku - kv \\<noteq> 0 \\<Longrightarrow>\n  hd (Ref \\<C> vs) = b \\<and> vs \\<noteq> \\<epsilon>\n  kv \\<le> ku\n  concat vs \\<noteq> \\<epsilon> \\<Longrightarrow>\n  hd (Dec \\<C> concat vs) \\<noteq> b\n  vs \\<noteq> \\<epsilon> \\<Longrightarrow> concat vs \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. ku = kv", "unfolding \\<open>Ref \\<C> vs = Dec \\<C> (concat vs)\\<close>"], ["proof (prove)\nusing this:\n  ku - kv \\<noteq> 0 \\<Longrightarrow>\n  hd (Dec \\<C> concat vs) = b \\<and> vs \\<noteq> \\<epsilon>\n  kv \\<le> ku\n  concat vs \\<noteq> \\<epsilon> \\<Longrightarrow>\n  hd (Dec \\<C> concat vs) \\<noteq> b\n  vs \\<noteq> \\<epsilon> \\<Longrightarrow> concat vs \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. ku = kv", "by auto"], ["proof (state)\nthis:\n  ku = kv\n\ngoal (1 subgoal):\n 1. ku = kv", "}"], ["proof (state)\nthis:\n  \\<lbrakk>?kva2 \\<le> ?kua2;\n   [?ba2] \\<^sup>@ ?kua2 \\<cdot> Ref \\<C> ?usa2 =\n   [?ba2] \\<^sup>@ ?kva2 \\<cdot> Ref \\<C> ?vsa2;\n   ?vsa2 \\<in> lists (no_head_gen \\<C> ?ba2);\n   ?usa2 \\<in> lists (no_head_gen \\<C> ?ba2); ?ba2 \\<in> \\<C>\\<rbrakk>\n  \\<Longrightarrow> ?kua2 = ?kva2\n\ngoal (1 subgoal):\n 1. ku = kv", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?kva2 \\<le> ?kua2;\n   [?ba2] \\<^sup>@ ?kua2 \\<cdot> Ref \\<C> ?usa2 =\n   [?ba2] \\<^sup>@ ?kva2 \\<cdot> Ref \\<C> ?vsa2;\n   ?vsa2 \\<in> lists (no_head_gen \\<C> ?ba2);\n   ?usa2 \\<in> lists (no_head_gen \\<C> ?ba2); ?ba2 \\<in> \\<C>\\<rbrakk>\n  \\<Longrightarrow> ?kua2 = ?kva2\n\ngoal (1 subgoal):\n 1. ku = kv", "using assms nat_le_linear[of ku kv]"], ["proof (prove)\nusing this:\n  \\<lbrakk>?kva2 \\<le> ?kua2;\n   [?ba2] \\<^sup>@ ?kua2 \\<cdot> Ref \\<C> ?usa2 =\n   [?ba2] \\<^sup>@ ?kva2 \\<cdot> Ref \\<C> ?vsa2;\n   ?vsa2 \\<in> lists (no_head_gen \\<C> ?ba2);\n   ?usa2 \\<in> lists (no_head_gen \\<C> ?ba2); ?ba2 \\<in> \\<C>\\<rbrakk>\n  \\<Longrightarrow> ?kua2 = ?kva2\n  vs \\<in> lists (no_head_gen \\<C> b)\n  us \\<in> lists (no_head_gen \\<C> b)\n  b \\<in> \\<C>\n  [b] \\<^sup>@ ku \\<cdot> Ref \\<C> us = [b] \\<^sup>@ kv \\<cdot> Ref \\<C> vs\n  ku \\<le> kv \\<or> kv \\<le> ku\n\ngoal (1 subgoal):\n 1. ku = kv", "by metis"], ["proof (state)\nthis:\n  ku = kv\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma no_head_gen_code':\n  \"b \\<in> \\<C> \\<Longrightarrow> xs \\<in> lists (no_head_gen \\<C> b) \n   \\<Longrightarrow> ys \\<in>  lists (no_head_gen \\<C> b) \\<Longrightarrow> concat xs = concat ys \\<Longrightarrow> xs = ys\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n     ys \\<in> lists (no_head_gen \\<C> b); concat xs = concat ys\\<rbrakk>\n    \\<Longrightarrow> xs = ys", "proof (induct xs ys rule: list_induct2', simp, simp add: emp_not_in_Cb, simp add: emp_not_in_Cb)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n                 ys \\<in> lists (no_head_gen \\<C> b);\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        b \\<in> \\<C>; x # xs \\<in> lists (no_head_gen \\<C> b);\n        y # ys \\<in> lists (no_head_gen \\<C> b);\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "case (4 hx xs hy ys)"], ["proof (state)\nthis:\n  \\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n   ys \\<in> lists (no_head_gen \\<C> b); concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  b \\<in> \\<C>\n  hx # xs \\<in> lists (no_head_gen \\<C> b)\n  hy # ys \\<in> lists (no_head_gen \\<C> b)\n  concat (hx # xs) = concat (hy # ys)\n\ngoal (1 subgoal):\n 1. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n                 ys \\<in> lists (no_head_gen \\<C> b);\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        b \\<in> \\<C>; x # xs \\<in> lists (no_head_gen \\<C> b);\n        y # ys \\<in> lists (no_head_gen \\<C> b);\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n   ys \\<in> lists (no_head_gen \\<C> b); concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  b \\<in> \\<C>\n  hx # xs \\<in> lists (no_head_gen \\<C> b)\n  hy # ys \\<in> lists (no_head_gen \\<C> b)\n  concat (hx # xs) = concat (hy # ys)", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n   ys \\<in> lists (no_head_gen \\<C> b); concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  b \\<in> \\<C>\n  hx # xs \\<in> lists (no_head_gen \\<C> b)\n  hy # ys \\<in> lists (no_head_gen \\<C> b)\n  concat (hx # xs) = concat (hy # ys)\n\ngoal (1 subgoal):\n 1. hx # xs = hy # ys", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "have \"hx # xs \\<in> lists \\<langle>\\<C>\\<rangle>\" and \"hy # ys \\<in> lists \\<langle>\\<C>\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hx # xs \\<in> lists \\<langle>\\<C>\\<rangle> &&&\n    hy # ys \\<in> lists \\<langle>\\<C>\\<rangle>", "using \\<open>b \\<in> \\<C>\\<close>  \\<open>hx # xs \\<in> lists (no_head_gen \\<C> b)\\<close> \\<open>hy # ys \\<in> lists (no_head_gen \\<C> b)\\<close> lists_no_head_sub"], ["proof (prove)\nusing this:\n  b \\<in> \\<C>\n  hx # xs \\<in> lists (no_head_gen \\<C> b)\n  hy # ys \\<in> lists (no_head_gen \\<C> b)\n  \\<lbrakk>?b \\<in> \\<C>; ?us \\<in> lists (no_head_gen \\<C> ?b)\\<rbrakk>\n  \\<Longrightarrow> ?us \\<in> lists \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. hx # xs \\<in> lists \\<langle>\\<C>\\<rangle> &&&\n    hy # ys \\<in> lists \\<langle>\\<C>\\<rangle>", "by blast+"], ["proof (state)\nthis:\n  hx # xs \\<in> lists \\<langle>\\<C>\\<rangle>\n  hy # ys \\<in> lists \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "have eq: \"refine \\<C> (hx#xs) = refine \\<C>  (hy#ys)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ref \\<C> hx # xs = Ref \\<C> hy # ys", "using \\<open>concat (hx # xs) = concat (hy # ys)\\<close> \\<open>hx # xs \\<in> lists \\<langle>\\<C>\\<rangle>\\<close> \\<open>hy # ys \\<in> lists \\<langle>\\<C>\\<rangle>\\<close>"], ["proof (prove)\nusing this:\n  concat (hx # xs) = concat (hy # ys)\n  hx # xs \\<in> lists \\<langle>\\<C>\\<rangle>\n  hy # ys \\<in> lists \\<langle>\\<C>\\<rangle>\n\ngoal (1 subgoal):\n 1. Ref \\<C> hx # xs = Ref \\<C> hy # ys", "using code_unique_ref"], ["proof (prove)\nusing this:\n  concat (hx # xs) = concat (hy # ys)\n  hx # xs \\<in> lists \\<langle>\\<C>\\<rangle>\n  hy # ys \\<in> lists \\<langle>\\<C>\\<rangle>\n  ?us \\<in> lists \\<langle>\\<C>\\<rangle> \\<Longrightarrow>\n  Ref \\<C> ?us = Dec \\<C> concat ?us\n\ngoal (1 subgoal):\n 1. Ref \\<C> hx # xs = Ref \\<C> hy # ys", "by presburger"], ["proof (state)\nthis:\n  Ref \\<C> hx # xs = Ref \\<C> hy # ys\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "have \"hx \\<in> (no_head_gen \\<C> b)\" and \"hy \\<in> (no_head_gen \\<C> b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hx \\<in> no_head_gen \\<C> b &&& hy \\<in> no_head_gen \\<C> b", "using \\<open>hx # xs \\<in> lists (no_head_gen \\<C> b)\\<close> \\<open>hy # ys \\<in> lists (no_head_gen \\<C> b)\\<close>"], ["proof (prove)\nusing this:\n  hx # xs \\<in> lists (no_head_gen \\<C> b)\n  hy # ys \\<in> lists (no_head_gen \\<C> b)\n\ngoal (1 subgoal):\n 1. hx \\<in> no_head_gen \\<C> b &&& hy \\<in> no_head_gen \\<C> b", "by auto+"], ["proof (state)\nthis:\n  hx \\<in> no_head_gen \\<C> b\n  hy \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "then"], ["proof (chain)\npicking this:\n  hx \\<in> no_head_gen \\<C> b\n  hy \\<in> no_head_gen \\<C> b", "obtain zx zy kx ky where \"hx = zx \\<cdot> b\\<^sup>@kx\" and \"hy = zy \\<cdot> b\\<^sup>@ky\" \"zx \\<noteq> b\" \"zy \\<noteq> b\" \"zx \\<in> \\<C>\" \"zy \\<in> \\<C>\""], ["proof (prove)\nusing this:\n  hx \\<in> no_head_gen \\<C> b\n  hy \\<in> no_head_gen \\<C> b\n\ngoal (1 subgoal):\n 1. (\\<And>zx kx zy ky.\n        \\<lbrakk>hx = zx \\<cdot> b \\<^sup>@ kx;\n         hy = zy \\<cdot> b \\<^sup>@ ky; zx \\<noteq> b; zy \\<noteq> b;\n         zx \\<in> \\<C>; zy \\<in> \\<C>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using no_head_genE"], ["proof (prove)\nusing this:\n  hx \\<in> no_head_gen \\<C> b\n  hy \\<in> no_head_gen \\<C> b\n  \\<lbrakk>?u \\<in> no_head_gen ?C ?b;\n   \\<And>z k.\n      \\<lbrakk>z \\<in> ?C; z \\<noteq> ?b;\n       ?u = z \\<cdot> ?b \\<^sup>@ k\\<rbrakk>\n      \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (\\<And>zx kx zy ky.\n        \\<lbrakk>hx = zx \\<cdot> b \\<^sup>@ kx;\n         hy = zy \\<cdot> b \\<^sup>@ ky; zx \\<noteq> b; zy \\<noteq> b;\n         zx \\<in> \\<C>; zy \\<in> \\<C>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by metis"], ["proof (state)\nthis:\n  hx = zx \\<cdot> b \\<^sup>@ kx\n  hy = zy \\<cdot> b \\<^sup>@ ky\n  zx \\<noteq> b\n  zy \\<noteq> b\n  zx \\<in> \\<C>\n  zy \\<in> \\<C>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "have r1: \"refine \\<C> (hx#xs) = [zx] \\<cdot> [b]\\<^sup>@kx \\<cdot> refine \\<C> xs\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ref \\<C> hx # xs = [zx] \\<cdot> [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs", "using \\<open>hx = zx \\<cdot> b\\<^sup>@kx\\<close> \\<open>zx \\<in> \\<C>\\<close> \\<open>zx \\<noteq> b\\<close> ref_hd \\<open>b \\<in> \\<C>\\<close>"], ["proof (prove)\nusing this:\n  hx = zx \\<cdot> b \\<^sup>@ kx\n  zx \\<in> \\<C>\n  zx \\<noteq> b\n  \\<lbrakk>?z \\<in> \\<C>; ?b \\<in> \\<C>; ?z \\<noteq> ?b;\n   ?vs \\<in> lists (no_head_gen \\<C> ?b)\\<rbrakk>\n  \\<Longrightarrow> Ref \\<C> (?z \\<cdot> ?b \\<^sup>@ ?k) # ?vs =\n                    [?z] \\<cdot> [?b] \\<^sup>@ ?k \\<cdot> Ref \\<C> ?vs\n  b \\<in> \\<C>\n\ngoal (1 subgoal):\n 1. Ref \\<C> hx # xs = [zx] \\<cdot> [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs", "by auto"], ["proof (state)\nthis:\n  Ref \\<C> hx # xs = [zx] \\<cdot> [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "have r2: \"refine \\<C> (hy#ys) = [zy] \\<cdot> [b]\\<^sup>@ky \\<cdot> refine \\<C> ys\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ref \\<C> hy # ys = [zy] \\<cdot> [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys", "using \\<open>hy = zy \\<cdot> b\\<^sup>@ky\\<close> \\<open>zy \\<in> \\<C>\\<close> \\<open>zy \\<noteq> b\\<close> ref_hd \\<open>b \\<in> \\<C>\\<close>"], ["proof (prove)\nusing this:\n  hy = zy \\<cdot> b \\<^sup>@ ky\n  zy \\<in> \\<C>\n  zy \\<noteq> b\n  \\<lbrakk>?z \\<in> \\<C>; ?b \\<in> \\<C>; ?z \\<noteq> ?b;\n   ?vs \\<in> lists (no_head_gen \\<C> ?b)\\<rbrakk>\n  \\<Longrightarrow> Ref \\<C> (?z \\<cdot> ?b \\<^sup>@ ?k) # ?vs =\n                    [?z] \\<cdot> [?b] \\<^sup>@ ?k \\<cdot> Ref \\<C> ?vs\n  b \\<in> \\<C>\n\ngoal (1 subgoal):\n 1. Ref \\<C> hy # ys = [zy] \\<cdot> [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys", "by auto"], ["proof (state)\nthis:\n  Ref \\<C> hy # ys = [zy] \\<cdot> [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "hence \"zx = zy\""], ["proof (prove)\nusing this:\n  Ref \\<C> hy # ys = [zy] \\<cdot> [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n\ngoal (1 subgoal):\n 1. zx = zy", "using r1 r2 eq"], ["proof (prove)\nusing this:\n  Ref \\<C> hy # ys = [zy] \\<cdot> [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n  Ref \\<C> hx # xs = [zx] \\<cdot> [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs\n  Ref \\<C> hy # ys = [zy] \\<cdot> [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n  Ref \\<C> hx # xs = Ref \\<C> hy # ys\n\ngoal (1 subgoal):\n 1. zx = zy", "by auto"], ["proof (state)\nthis:\n  zx = zy\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "hence \"[b]\\<^sup>@kx \\<cdot> refine \\<C> xs = [b]\\<^sup>@ky \\<cdot> refine \\<C> ys\""], ["proof (prove)\nusing this:\n  zx = zy\n\ngoal (1 subgoal):\n 1. [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs =\n    [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys", "using eq r1 r2"], ["proof (prove)\nusing this:\n  zx = zy\n  Ref \\<C> hx # xs = Ref \\<C> hy # ys\n  Ref \\<C> hx # xs = [zx] \\<cdot> [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs\n  Ref \\<C> hy # ys = [zy] \\<cdot> [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n\ngoal (1 subgoal):\n 1. [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs =\n    [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys", "by auto"], ["proof (state)\nthis:\n  [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs = [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "hence \"kx = ky\""], ["proof (prove)\nusing this:\n  [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs = [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n\ngoal (1 subgoal):\n 1. kx = ky", "using no_head_gen_code_ind_step \\<open>b \\<in> \\<C>\\<close> \\<open>hx # xs \\<in> lists (no_head_gen \\<C> b)\\<close> \\<open>hy # ys \\<in> lists (no_head_gen \\<C> b)\\<close> \n        listsE"], ["proof (prove)\nusing this:\n  [b] \\<^sup>@ kx \\<cdot> Ref \\<C> xs = [b] \\<^sup>@ ky \\<cdot> Ref \\<C> ys\n  \\<lbrakk>?vs \\<in> lists (no_head_gen \\<C> ?b);\n   ?us \\<in> lists (no_head_gen \\<C> ?b); ?b \\<in> \\<C>;\n   [?b] \\<^sup>@ ?ku \\<cdot> Ref \\<C> ?us =\n   [?b] \\<^sup>@ ?kv \\<cdot> Ref \\<C> ?vs\\<rbrakk>\n  \\<Longrightarrow> ?ku = ?kv\n  b \\<in> \\<C>\n  hx # xs \\<in> lists (no_head_gen \\<C> b)\n  hy # ys \\<in> lists (no_head_gen \\<C> b)\n  \\<lbrakk>?x # ?l \\<in> lists ?A;\n   \\<lbrakk>?x \\<in> ?A; ?l \\<in> lists ?A\\<rbrakk>\n   \\<Longrightarrow> ?P\\<rbrakk>\n  \\<Longrightarrow> ?P\n\ngoal (1 subgoal):\n 1. kx = ky", "by metis"], ["proof (state)\nthis:\n  kx = ky\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "hence \"hx = hy\""], ["proof (prove)\nusing this:\n  kx = ky\n\ngoal (1 subgoal):\n 1. hx = hy", "by (simp add: \\<open>hx = zx \\<cdot> b\\<^sup>@kx\\<close> \\<open>hy = zy \\<cdot> b\\<^sup>@ky\\<close> \\<open>zx = zy\\<close>)"], ["proof (state)\nthis:\n  hx = hy\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "hence \"xs = ys\""], ["proof (prove)\nusing this:\n  hx = hy\n\ngoal (1 subgoal):\n 1. xs = ys", "using \"4.hyps\""], ["proof (prove)\nusing this:\n  hx = hy\n  \\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n   ys \\<in> lists (no_head_gen \\<C> b); concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n\ngoal (1 subgoal):\n 1. xs = ys", "using \\<open>hx # xs \\<in> lists (no_head_gen \\<C> b)\\<close> \\<open>hy # ys \\<in> lists (no_head_gen \\<C> b)\\<close> \n        \\<open>concat (hx # xs) = concat (hy # ys)\\<close> \\<open>b \\<in> \\<C>\\<close>"], ["proof (prove)\nusing this:\n  hx = hy\n  \\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n   ys \\<in> lists (no_head_gen \\<C> b); concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  hx # xs \\<in> lists (no_head_gen \\<C> b)\n  hy # ys \\<in> lists (no_head_gen \\<C> b)\n  concat (hx # xs) = concat (hy # ys)\n  b \\<in> \\<C>\n\ngoal (1 subgoal):\n 1. xs = ys", "by auto"], ["proof (state)\nthis:\n  xs = ys\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>b \\<in> \\<C>; xs \\<in> lists (no_head_gen \\<C> b);\n              ys \\<in> lists (no_head_gen \\<C> b);\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     b \\<in> \\<C>; hx # xs \\<in> lists (no_head_gen \\<C> b);\n     hy # ys \\<in> lists (no_head_gen \\<C> b);\n     concat (hx # xs) = concat (hy # ys)\\<rbrakk>\n    \\<Longrightarrow> hx # xs = hy # ys", "thus ?thesis"], ["proof (prove)\nusing this:\n  xs = ys\n\ngoal (1 subgoal):\n 1. hx # xs = hy # ys", "by (simp add: \\<open>hx = hy\\<close>)"], ["proof (state)\nthis:\n  hx # xs = hy # ys\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  hx # xs = hy # ys\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "theorem no_head_gen_code:\n  assumes \"code C\" and \"b \\<in> C\"\n  shows \"code {z \\<cdot> b\\<^sup>@k | z k. z \\<in> C \\<and> z \\<noteq> b}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. code {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}", "using code.no_head_gen_code'[OF \\<open>code C\\<close> \\<open>b \\<in> C\\<close>] code.intro"], ["proof (prove)\nusing this:\n  \\<lbrakk>?xs \\<in> lists (no_head_gen C b);\n   ?ys \\<in> lists (no_head_gen C b); concat ?xs = concat ?ys\\<rbrakk>\n  \\<Longrightarrow> ?xs = ?ys\n  (\\<And>xs ys.\n      \\<lbrakk>xs \\<in> lists ?\\<C>; ys \\<in> lists ?\\<C>;\n       concat xs = concat ys\\<rbrakk>\n      \\<Longrightarrow> xs = ys) \\<Longrightarrow>\n  code ?\\<C>\n\ngoal (1 subgoal):\n 1. code {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}", "unfolding no_head_gen_set"], ["proof (prove)\nusing this:\n  \\<lbrakk>?xs\n           \\<in> lists\n                  {z \\<cdot> b \\<^sup>@ k |z k.\n                   z \\<in> C \\<and> z \\<noteq> b};\n   ?ys\n   \\<in> lists {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b};\n   concat ?xs = concat ?ys\\<rbrakk>\n  \\<Longrightarrow> ?xs = ?ys\n  (\\<And>xs ys.\n      \\<lbrakk>xs \\<in> lists ?\\<C>; ys \\<in> lists ?\\<C>;\n       concat xs = concat ys\\<rbrakk>\n      \\<Longrightarrow> xs = ys) \\<Longrightarrow>\n  code ?\\<C>\n\ngoal (1 subgoal):\n 1. code {z \\<cdot> b \\<^sup>@ k |z k. z \\<in> C \\<and> z \\<noteq> b}", "by blast"], ["", "text\\<open>We are now ready to prove the Graph Lemma \\<close>"], ["", "theorem graph_lemma: \"\\<BB>\\<^sub>F X = {hd (Dec (\\<BB>\\<^sub>F X) x) | x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<BB>\\<^sub>F X =\n    {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}", "proof \n  \\<comment> \\<open>the core is to show that each element of the free basis must be a head\\<close>"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<BB>\\<^sub>F X\n    \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                 x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n 2. {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n    \\<subseteq> \\<BB>\\<^sub>F X", "show \"\\<BB>\\<^sub>F X \\<subseteq> {hd (Dec (\\<BB>\\<^sub>F X) x) | x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<BB>\\<^sub>F X\n    \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                 x \\<in> X \\<and> x \\<noteq> \\<epsilon>}", "proof (rule ccontr)\n    \\<comment> \\<open>Assume the contrary.\\<close>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "assume \"\\<not> \\<BB>\\<^sub>F X \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\"  \n    \\<comment> \\<open>And let b be the not-head\\<close>"], ["proof (state)\nthis:\n  \\<not> \\<BB>\\<^sub>F X\n         \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                      x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "then"], ["proof (chain)\npicking this:\n  \\<not> \\<BB>\\<^sub>F X\n         \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                      x \\<in> X \\<and> x \\<noteq> \\<epsilon>}", "obtain b where \"b \\<in> \\<BB>\\<^sub>F X\" and nohd: \"\\<And> x.   x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow> hd (Dec (\\<BB>\\<^sub>F X) x) \\<noteq> b\""], ["proof (prove)\nusing this:\n  \\<not> \\<BB>\\<^sub>F X\n         \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                      x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n\ngoal (1 subgoal):\n 1. (\\<And>b.\n        \\<lbrakk>b \\<in> \\<BB>\\<^sub>F X;\n         \\<And>x.\n            x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow>\n            hd (Dec \\<BB>\\<^sub>F X x) \\<noteq> b\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  b \\<in> \\<BB>\\<^sub>F X\n  ?x \\<in> X \\<and> ?x \\<noteq> \\<epsilon> \\<Longrightarrow>\n  hd (Dec \\<BB>\\<^sub>F X ?x) \\<noteq> b\n\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "interpret code \"\\<BB>\\<^sub>F X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. code (\\<BB>\\<^sub>F X)", "using free_basis_code"], ["proof (prove)\nusing this:\n  code (\\<BB>\\<^sub>F ?G)\n\ngoal (1 subgoal):\n 1. code (\\<BB>\\<^sub>F X)", "by auto\n          \\<comment> \\<open>For contradiction: We have a free hull which does not contain b but contains X.\\<close>"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "let ?Cb = \"no_head_gen (\\<BB>\\<^sub>F X) b\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "have \"code ?Cb\""], ["proof (prove)\ngoal (1 subgoal):\n 1. code (no_head_gen (\\<BB>\\<^sub>F X) b)", "using \\<open>b \\<in> \\<BB>\\<^sub>F X\\<close> code_def no_head_gen_code'"], ["proof (prove)\nusing this:\n  b \\<in> \\<BB>\\<^sub>F X\n  code ?\\<C> \\<equiv>\n  \\<forall>xs ys.\n     xs \\<in> lists ?\\<C> \\<longrightarrow>\n     ys \\<in> lists ?\\<C> \\<longrightarrow>\n     concat xs = concat ys \\<longrightarrow> xs = ys\n  \\<lbrakk>?b \\<in> \\<BB>\\<^sub>F X;\n   ?xs \\<in> lists (no_head_gen (\\<BB>\\<^sub>F X) ?b);\n   ?ys \\<in> lists (no_head_gen (\\<BB>\\<^sub>F X) ?b);\n   concat ?xs = concat ?ys\\<rbrakk>\n  \\<Longrightarrow> ?xs = ?ys\n\ngoal (1 subgoal):\n 1. code (no_head_gen (\\<BB>\\<^sub>F X) b)", "by blast"], ["proof (state)\nthis:\n  code (no_head_gen (\\<BB>\\<^sub>F X) b)\n\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "have \"b \\<notin> \\<langle>?Cb\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b \\<notin> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "using \\<open>b \\<in> \\<BB>\\<^sub>F X\\<close> b_not_in_no_head no_head_generates"], ["proof (prove)\nusing this:\n  b \\<in> \\<BB>\\<^sub>F X\n  ?b \\<in> \\<BB>\\<^sub>F X \\<Longrightarrow>\n  ?b \\<notin> no_head (\\<BB>\\<^sub>F X) ?b\n  ?b \\<in> \\<BB>\\<^sub>F X \\<Longrightarrow>\n  \\<langle>no_head_gen (\\<BB>\\<^sub>F X) ?b\\<rangle> =\n  no_head (\\<BB>\\<^sub>F X) ?b\n\ngoal (1 subgoal):\n 1. b \\<notin> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "by blast"], ["proof (state)\nthis:\n  b \\<notin> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "have \"X \\<subseteq> \\<langle>?Cb\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<subseteq> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> X \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> X \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "assume \"x \\<in> X\""], ["proof (state)\nthis:\n  x \\<in> X\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> X \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "hence \"x \\<in> \\<langle>\\<BB>\\<^sub>F X\\<rangle>\""], ["proof (prove)\nusing this:\n  x \\<in> X\n\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>\\<BB>\\<^sub>F X\\<rangle>", "using basis_gen_hull free_hull.free_gen_in"], ["proof (prove)\nusing this:\n  x \\<in> X\n  \\<langle>\\<BB> ?G\\<rangle> = \\<langle>?G\\<rangle>\n  ?w \\<in> ?G \\<Longrightarrow> ?w \\<in> \\<langle>?G\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>\\<BB>\\<^sub>F X\\<rangle>", "unfolding free_basis_def"], ["proof (prove)\nusing this:\n  x \\<in> X\n  \\<langle>\\<BB> ?G\\<rangle> = \\<langle>?G\\<rangle>\n  ?w \\<in> ?G \\<Longrightarrow> ?w \\<in> \\<langle>?G\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>\\<BB> \\<langle>X\\<rangle>\\<^sub>F\\<rangle>", "by blast"], ["proof (state)\nthis:\n  x \\<in> \\<langle>\\<BB>\\<^sub>F X\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> X \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "have \" x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<in> \\<langle>?Cb\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow>\n    x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "using hd_no_head[OF \\<open>x \\<in> \\<langle>\\<BB>\\<^sub>F X\\<rangle>\\<close> nohd]\n            \\<open>b \\<in> \\<BB>\\<^sub>F X\\<close> no_head_generates"], ["proof (prove)\nusing this:\n  x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow>\n  x \\<in> no_head (\\<BB>\\<^sub>F X) b\n  b \\<in> \\<BB>\\<^sub>F X\n  ?b \\<in> \\<BB>\\<^sub>F X \\<Longrightarrow>\n  \\<langle>no_head_gen (\\<BB>\\<^sub>F X) ?b\\<rangle> =\n  no_head (\\<BB>\\<^sub>F X) ?b\n\ngoal (1 subgoal):\n 1. x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow>\n    x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "by blast"], ["proof (state)\nthis:\n  x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow>\n  x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> X \\<Longrightarrow>\n       x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "thus \"x \\<in> \\<langle>?Cb\\<rangle>\""], ["proof (prove)\nusing this:\n  x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow>\n  x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "using \\<open>x \\<in> X\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> X \\<and> x \\<noteq> \\<epsilon> \\<Longrightarrow>\n  x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n  x \\<in> X\n\ngoal (1 subgoal):\n 1. x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "by blast"], ["proof (state)\nthis:\n  x \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  X \\<subseteq> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "have \"\\<langle>X\\<rangle>\\<^sub>F \\<subseteq> \\<langle>?Cb\\<rangle>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<langle>X\\<rangle>\\<^sub>F\n    \\<subseteq> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "using free_hull_min[OF \\<open>code ?Cb\\<close> \\<open>X \\<subseteq> \\<langle>?Cb\\<rangle>\\<close>]"], ["proof (prove)\nusing this:\n  \\<langle>X\\<rangle>\\<^sub>F\n  \\<subseteq> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<langle>X\\<rangle>\\<^sub>F\n    \\<subseteq> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "."], ["proof (state)\nthis:\n  \\<langle>X\\<rangle>\\<^sub>F\n  \\<subseteq> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal (1 subgoal):\n 1. \\<not> \\<BB>\\<^sub>F X\n           \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n                        x \\<in> X \\<and>\n                        x \\<noteq> \\<epsilon>} \\<Longrightarrow>\n    False", "from this[unfolded subset_eq, rule_format, of b]"], ["proof (chain)\npicking this:\n  b \\<in> \\<langle>X\\<rangle>\\<^sub>F \\<Longrightarrow>\n  b \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>", "show False"], ["proof (prove)\nusing this:\n  b \\<in> \\<langle>X\\<rangle>\\<^sub>F \\<Longrightarrow>\n  b \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n\ngoal (1 subgoal):\n 1. False", "using \\<open>b \\<in> \\<BB>\\<^sub>F X\\<close> \\<open>b \\<notin> \\<langle>?Cb\\<rangle>\\<close> basisD simp_el_el"], ["proof (prove)\nusing this:\n  b \\<in> \\<langle>X\\<rangle>\\<^sub>F \\<Longrightarrow>\n  b \\<in> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n  b \\<in> \\<BB>\\<^sub>F X\n  b \\<notin> \\<langle>no_head_gen (\\<BB>\\<^sub>F X) b\\<rangle>\n  ?x \\<in> \\<BB> ?G \\<Longrightarrow>  ?x \\<in>B ?G \n   ?b \\<in>B ?G  \\<Longrightarrow> ?b \\<in> ?G\n\ngoal (1 subgoal):\n 1. False", "unfolding free_basis_def"], ["proof (prove)\nusing this:\n  b \\<in> \\<langle>X\\<rangle>\\<^sub>F \\<Longrightarrow>\n  b \\<in> \\<langle>no_head_gen \\<BB> \\<langle>X\\<rangle>\\<^sub>F b\\<rangle>\n  b \\<in> \\<BB> \\<langle>X\\<rangle>\\<^sub>F\n  b \\<notin> \\<langle>no_head_gen \\<BB> \\<langle>X\\<rangle>\\<^sub>F\n                       b\\<rangle>\n  ?x \\<in> \\<BB> ?G \\<Longrightarrow>  ?x \\<in>B ?G \n   ?b \\<in>B ?G  \\<Longrightarrow> ?b \\<in> ?G\n\ngoal (1 subgoal):\n 1. False", "by blast"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<BB>\\<^sub>F X\n  \\<subseteq> {hd (Dec \\<BB>\\<^sub>F X x) |x.\n               x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n\ngoal (1 subgoal):\n 1. {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n    \\<subseteq> \\<BB>\\<^sub>F X", "next\n  \\<comment> \\<open>The opposite inclusion is easy\\<close>"], ["proof (state)\ngoal (1 subgoal):\n 1. {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n    \\<subseteq> \\<BB>\\<^sub>F X", "show \"{hd (Dec (\\<BB>\\<^sub>F X) x) | x.  x \\<in> X \\<and> x \\<noteq> \\<epsilon>} \\<subseteq> \\<BB>\\<^sub>F X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n    \\<subseteq> \\<BB>\\<^sub>F X", "using basis_gen_hull_free dec_hd genset_sub_free"], ["proof (prove)\nusing this:\n  \\<langle>\\<BB>\\<^sub>F ?G\\<rangle> = \\<langle>?G\\<rangle>\\<^sub>F\n  \\<lbrakk>?u \\<noteq> \\<epsilon>; ?u \\<in> \\<langle>?G\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> hd (Dec ?G ?u) \\<in> ?G\n  ?G \\<subseteq> \\<langle>?G\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n    \\<subseteq> \\<BB>\\<^sub>F X", "by blast"], ["proof (state)\nthis:\n  {hd (Dec \\<BB>\\<^sub>F X x) |x. x \\<in> X \\<and> x \\<noteq> \\<epsilon>}\n  \\<subseteq> \\<BB>\\<^sub>F X\n\ngoal:\nNo subgoals!", "qed"], ["", "section \\<open>Binary code\\<close>"], ["", "text\\<open>We illustrate the use of the Graph Lemma in an alternative proof of the fact that two non-commuting words form a code.\nSee also @{thm no_comm_bin_code [no_vars]} in @{theory Combinatorics_Words.CoWBasic}.\n\nFirst, we prove a lemma which is the core of the alternative proof.\n\\<close>"], ["", "lemma non_comm_hds_neq: assumes \"u \\<cdot> v \\<noteq> v \\<cdot> u\" shows \"hd (Dec \\<BB>\\<^sub>F {u,v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u,v} v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u, v} v)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} v) \\<Longrightarrow>\n    False", "have \"u \\<noteq> \\<epsilon>\" and \"v \\<noteq> \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> &&& v \\<noteq> \\<epsilon>", "using assms"], ["proof (prove)\nusing this:\n  u \\<cdot> v \\<noteq> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> &&& v \\<noteq> \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon>\n  v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} v) \\<Longrightarrow>\n    False", "hence basis: \"\\<BB>\\<^sub>F {u,v} = {hd (Dec \\<BB>\\<^sub>F {u,v} u),hd (Dec \\<BB>\\<^sub>F {u,v} v)}\""], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<BB>\\<^sub>F {u, v} =\n    {hd (Dec \\<BB>\\<^sub>F {u, v} u), hd (Dec \\<BB>\\<^sub>F {u, v} v)}", "using graph_lemma[of \"{u,v}\"]"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  v \\<noteq> \\<epsilon>\n  \\<BB>\\<^sub>F {u, v} =\n  {hd (Dec \\<BB>\\<^sub>F {u, v} x) |x.\n   x \\<in> {u, v} \\<and> x \\<noteq> \\<epsilon>}\n\ngoal (1 subgoal):\n 1. \\<BB>\\<^sub>F {u, v} =\n    {hd (Dec \\<BB>\\<^sub>F {u, v} u), hd (Dec \\<BB>\\<^sub>F {u, v} v)}", "by blast"], ["proof (state)\nthis:\n  \\<BB>\\<^sub>F {u, v} =\n  {hd (Dec \\<BB>\\<^sub>F {u, v} u), hd (Dec \\<BB>\\<^sub>F {u, v} v)}\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} v) \\<Longrightarrow>\n    False", "assume eq: \"hd (Dec \\<BB>\\<^sub>F {u,v} u) = hd (Dec \\<BB>\\<^sub>F {u,v} v)\""], ["proof (state)\nthis:\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) = hd (Dec \\<BB>\\<^sub>F {u, v} v)\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} v) \\<Longrightarrow>\n    False", "hence \"u \\<in> (hd (Dec \\<BB>\\<^sub>F {u,v} u))*\""], ["proof (prove)\nusing this:\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) = hd (Dec \\<BB>\\<^sub>F {u, v} v)\n\ngoal (1 subgoal):\n 1. u \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*", "using basis"], ["proof (prove)\nusing this:\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) = hd (Dec \\<BB>\\<^sub>F {u, v} v)\n  \\<BB>\\<^sub>F {u, v} =\n  {hd (Dec \\<BB>\\<^sub>F {u, v} u), hd (Dec \\<BB>\\<^sub>F {u, v} v)}\n\ngoal (1 subgoal):\n 1. u \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*", "unfolding free_basis_def"], ["proof (prove)\nusing this:\n  hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F u) =\n  hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F v)\n  \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F =\n  {hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F u),\n   hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F v)}\n\ngoal (1 subgoal):\n 1. u \\<in> hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F u)*", "by (metis basis_gen_hull free_hull.simps free_hull_hull insertI1 insert_absorb2 sing_gen)"], ["proof (state)\nthis:\n  u \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} v) \\<Longrightarrow>\n    False", "moreover"], ["proof (state)\nthis:\n  u \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} v) \\<Longrightarrow>\n    False", "have  \"v \\<in> (hd (Dec \\<BB>\\<^sub>F {u,v} u))*\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*", "using basis eq"], ["proof (prove)\nusing this:\n  \\<BB>\\<^sub>F {u, v} =\n  {hd (Dec \\<BB>\\<^sub>F {u, v} u), hd (Dec \\<BB>\\<^sub>F {u, v} v)}\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) = hd (Dec \\<BB>\\<^sub>F {u, v} v)\n\ngoal (1 subgoal):\n 1. v \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*", "unfolding free_basis_def"], ["proof (prove)\nusing this:\n  \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F =\n  {hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F u),\n   hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F v)}\n  hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F u) =\n  hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F v)\n\ngoal (1 subgoal):\n 1. v \\<in> hd (Dec \\<BB> \\<langle>{u, v}\\<rangle>\\<^sub>F u)*", "by (metis basis_gen_hull free_hull_hull genset_sub_free insert_absorb2 insert_subset sing_gen)"], ["proof (state)\nthis:\n  v \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} v) \\<Longrightarrow>\n    False", "ultimately"], ["proof (chain)\npicking this:\n  u \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n  v \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*", "show False"], ["proof (prove)\nusing this:\n  u \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n  v \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n\ngoal (1 subgoal):\n 1. False", "using comm_root assms"], ["proof (prove)\nusing this:\n  u \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n  v \\<in> hd (Dec \\<BB>\\<^sub>F {u, v} u)*\n  (?x \\<cdot> ?y = ?y \\<cdot> ?x) =\n  (\\<exists>t. ?x \\<in> t* \\<and> ?y \\<in> t*)\n  u \\<cdot> v \\<noteq> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. False", "by blast"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem assumes \"u \\<cdot> v \\<noteq> v \\<cdot> u\" \n  shows \"xs \\<in> lists {u, v} \\<Longrightarrow> ys \\<in> lists {u, v} \\<Longrightarrow> concat xs = concat ys \\<Longrightarrow> xs = ys\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n     concat xs = concat ys\\<rbrakk>\n    \\<Longrightarrow> xs = ys", "proof (induct xs ys rule: list_induct2', simp)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x xs.\n       \\<lbrakk>x # xs \\<in> lists {u, v}; \\<epsilon> \\<in> lists {u, v};\n        concat (x # xs) = concat \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> x # xs = \\<epsilon>\n 2. \\<And>y ys.\n       \\<lbrakk>\\<epsilon> \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat \\<epsilon> = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> \\<epsilon> = y # ys\n 3. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "case (2 x xs)"], ["proof (state)\nthis:\n  x # xs \\<in> lists {u, v}\n  \\<epsilon> \\<in> lists {u, v}\n  concat (x # xs) = concat \\<epsilon>\n\ngoal (3 subgoals):\n 1. \\<And>x xs.\n       \\<lbrakk>x # xs \\<in> lists {u, v}; \\<epsilon> \\<in> lists {u, v};\n        concat (x # xs) = concat \\<epsilon>\\<rbrakk>\n       \\<Longrightarrow> x # xs = \\<epsilon>\n 2. \\<And>y ys.\n       \\<lbrakk>\\<epsilon> \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat \\<epsilon> = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> \\<epsilon> = y # ys\n 3. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "then"], ["proof (chain)\npicking this:\n  x # xs \\<in> lists {u, v}\n  \\<epsilon> \\<in> lists {u, v}\n  concat (x # xs) = concat \\<epsilon>", "show ?case"], ["proof (prove)\nusing this:\n  x # xs \\<in> lists {u, v}\n  \\<epsilon> \\<in> lists {u, v}\n  concat (x # xs) = concat \\<epsilon>\n\ngoal (1 subgoal):\n 1. x # xs = \\<epsilon>", "using Nil_is_append_conv append_Nil assms"], ["proof (prove)\nusing this:\n  x # xs \\<in> lists {u, v}\n  \\<epsilon> \\<in> lists {u, v}\n  concat (x # xs) = concat \\<epsilon>\n  (\\<epsilon> = ?xs \\<cdot> ?ys) =\n  (?xs = \\<epsilon> \\<and> ?ys = \\<epsilon>)\n  \\<epsilon> \\<cdot> ?ys = ?ys\n  u \\<cdot> v \\<noteq> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. x # xs = \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  x # xs = \\<epsilon>\n\ngoal (2 subgoals):\n 1. \\<And>y ys.\n       \\<lbrakk>\\<epsilon> \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat \\<epsilon> = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> \\<epsilon> = y # ys\n 2. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>y ys.\n       \\<lbrakk>\\<epsilon> \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat \\<epsilon> = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> \\<epsilon> = y # ys\n 2. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "case (3 y ys)"], ["proof (state)\nthis:\n  \\<epsilon> \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat \\<epsilon> = concat (y # ys)\n\ngoal (2 subgoals):\n 1. \\<And>y ys.\n       \\<lbrakk>\\<epsilon> \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat \\<epsilon> = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> \\<epsilon> = y # ys\n 2. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "then"], ["proof (chain)\npicking this:\n  \\<epsilon> \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat \\<epsilon> = concat (y # ys)", "show ?case"], ["proof (prove)\nusing this:\n  \\<epsilon> \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat \\<epsilon> = concat (y # ys)\n\ngoal (1 subgoal):\n 1. \\<epsilon> = y # ys", "using Nil_is_append_conv append_Nil assms"], ["proof (prove)\nusing this:\n  \\<epsilon> \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat \\<epsilon> = concat (y # ys)\n  (\\<epsilon> = ?xs \\<cdot> ?ys) =\n  (?xs = \\<epsilon> \\<and> ?ys = \\<epsilon>)\n  \\<epsilon> \\<cdot> ?ys = ?ys\n  u \\<cdot> v \\<noteq> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. \\<epsilon> = y # ys", "by auto"], ["proof (state)\nthis:\n  \\<epsilon> = y # ys\n\ngoal (1 subgoal):\n 1. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "case (4 x xs y ys)"], ["proof (state)\nthis:\n  \\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n   concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  x # xs \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat (x # xs) = concat (y # ys)\n\ngoal (1 subgoal):\n 1. \\<And>x xs y ys.\n       \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n                 concat xs = concat ys\\<rbrakk>\n                \\<Longrightarrow> xs = ys;\n        x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n        concat (x # xs) = concat (y # ys)\\<rbrakk>\n       \\<Longrightarrow> x # xs = y # ys", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n   concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  x # xs \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat (x # xs) = concat (y # ys)", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n   concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  x # xs \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat (x # xs) = concat (y # ys)\n\ngoal (1 subgoal):\n 1. x # xs = y # ys", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n     concat (x # xs) = concat (y # ys)\\<rbrakk>\n    \\<Longrightarrow> x # xs = y # ys", "have \"u \\<noteq> \\<epsilon>\" and \"v \\<noteq> \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> &&& v \\<noteq> \\<epsilon>", "using assms"], ["proof (prove)\nusing this:\n  u \\<cdot> v \\<noteq> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon> &&& v \\<noteq> \\<epsilon>", "by force+"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon>\n  v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n     concat (x # xs) = concat (y # ys)\\<rbrakk>\n    \\<Longrightarrow> x # xs = y # ys", "hence \"x \\<noteq> \\<epsilon>\" and \"y \\<noteq> \\<epsilon>\""], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> &&& y \\<noteq> \\<epsilon>", "using \\<open>x # xs \\<in> lists {u, v}\\<close> \\<open>y # ys \\<in> lists {u, v}\\<close>"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  v \\<noteq> \\<epsilon>\n  x # xs \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> &&& y \\<noteq> \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  x \\<noteq> \\<epsilon>\n  y \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n     concat (x # xs) = concat (y # ys)\\<rbrakk>\n    \\<Longrightarrow> x # xs = y # ys", "have or_x: \"x = u \\<or> x = v\" and or_y: \"y = u \\<or> y = v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = u \\<or> x = v &&& y = u \\<or> y = v", "using \\<open>x # xs \\<in> lists {u, v}\\<close> \\<open>y # ys \\<in> lists {u, v}\\<close>"], ["proof (prove)\nusing this:\n  x # xs \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n\ngoal (1 subgoal):\n 1. x = u \\<or> x = v &&& y = u \\<or> y = v", "by auto"], ["proof (state)\nthis:\n  x = u \\<or> x = v\n  y = u \\<or> y = v\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n     concat (x # xs) = concat (y # ys)\\<rbrakk>\n    \\<Longrightarrow> x # xs = y # ys", "have hd_z: \"z \\<noteq> \\<epsilon> \\<Longrightarrow> z # zs \\<in> lists {u, v} \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u,v} (concat (z#zs))) = hd (Dec \\<BB>\\<^sub>F {u,v} z)\" for z zs"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "assume \"z \\<noteq> \\<epsilon>\" \"z # zs \\<in> lists {u, v}\""], ["proof (state)\nthis:\n  z \\<noteq> \\<epsilon>\n  z # zs \\<in> lists {u, v}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "have \"z \\<in> \\<langle>{u,v}\\<rangle>\\<^sub>F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F", "using \\<open>z # zs \\<in> lists {u, v}\\<close>"], ["proof (prove)\nusing this:\n  z # zs \\<in> lists {u, v}\n\ngoal (1 subgoal):\n 1. z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F", "by auto"], ["proof (state)\nthis:\n  z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "moreover"], ["proof (state)\nthis:\n  z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "have \"concat zs \\<in> \\<langle>{u,v}\\<rangle>\\<^sub>F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. concat zs \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F", "using concat_tl[OF \\<open>z # zs \\<in> lists {u, v}\\<close>] hull_in_free_hull[of \"{u,v}\"]"], ["proof (prove)\nusing this:\n  concat zs \\<in> \\<langle>{u, v}\\<rangle>\n  \\<langle>{u, v}\\<rangle> \\<subseteq> \\<langle>{u, v}\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. concat zs \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F", "by blast"], ["proof (state)\nthis:\n  concat zs \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "ultimately"], ["proof (chain)\npicking this:\n  z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n  concat zs \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F", "have \"Dec \\<BB>\\<^sub>F {u,v} (concat (z#zs)) = (Dec \\<BB>\\<^sub>F {u,v} z) \\<cdot> (Dec \\<BB>\\<^sub>F {u,v} (concat zs))\""], ["proof (prove)\nusing this:\n  z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n  concat zs \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n\ngoal (1 subgoal):\n 1. Dec \\<BB>\\<^sub>F {u, v} concat (z # zs) =\n    (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot>\n    (Dec \\<BB>\\<^sub>F {u, v} concat zs)", "using free_basis_dec_morph[of z \"{u,v}\" \"concat zs\"]"], ["proof (prove)\nusing this:\n  z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n  concat zs \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n  \\<lbrakk>z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F;\n   concat zs \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\\<rbrakk>\n  \\<Longrightarrow> Dec \\<BB>\\<^sub>F {u, v} z \\<cdot> concat zs =\n                    (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot>\n                    (Dec \\<BB>\\<^sub>F {u, v} concat zs)\n\ngoal (1 subgoal):\n 1. Dec \\<BB>\\<^sub>F {u, v} concat (z # zs) =\n    (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot>\n    (Dec \\<BB>\\<^sub>F {u, v} concat zs)", "by fastforce"], ["proof (state)\nthis:\n  Dec \\<BB>\\<^sub>F {u, v} concat (z # zs) =\n  (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot> (Dec \\<BB>\\<^sub>F {u, v} concat zs)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "moreover"], ["proof (state)\nthis:\n  Dec \\<BB>\\<^sub>F {u, v} concat (z # zs) =\n  (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot> (Dec \\<BB>\\<^sub>F {u, v} concat zs)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "have \"Dec \\<BB>\\<^sub>F {u,v} z \\<noteq> \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Dec \\<BB>\\<^sub>F {u, v} z \\<noteq> \\<epsilon>", "using \\<open>z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\\<close> basis_gen_hull_free dec_nemp'[OF  \\<open>z \\<noteq> \\<epsilon>\\<close>]"], ["proof (prove)\nusing this:\n  z \\<in> \\<langle>{u, v}\\<rangle>\\<^sub>F\n  \\<langle>\\<BB>\\<^sub>F ?G\\<rangle> = \\<langle>?G\\<rangle>\\<^sub>F\n  z \\<in> \\<langle>?G\\<rangle> \\<Longrightarrow>\n  Dec ?G z \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. Dec \\<BB>\\<^sub>F {u, v} z \\<noteq> \\<epsilon>", "by blast"], ["proof (state)\nthis:\n  Dec \\<BB>\\<^sub>F {u, v} z \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<lbrakk>z \\<noteq> \\<epsilon>; z # zs \\<in> lists {u, v}\\<rbrakk>\n    \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n                      hd (Dec \\<BB>\\<^sub>F {u, v} z)", "ultimately"], ["proof (chain)\npicking this:\n  Dec \\<BB>\\<^sub>F {u, v} concat (z # zs) =\n  (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot> (Dec \\<BB>\\<^sub>F {u, v} concat zs)\n  Dec \\<BB>\\<^sub>F {u, v} z \\<noteq> \\<epsilon>", "show \"hd (Dec \\<BB>\\<^sub>F {u,v} (concat (z#zs))) = hd (Dec \\<BB>\\<^sub>F {u,v} z)\""], ["proof (prove)\nusing this:\n  Dec \\<BB>\\<^sub>F {u, v} concat (z # zs) =\n  (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot> (Dec \\<BB>\\<^sub>F {u, v} concat zs)\n  Dec \\<BB>\\<^sub>F {u, v} z \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} z)", "using hd_append"], ["proof (prove)\nusing this:\n  Dec \\<BB>\\<^sub>F {u, v} concat (z # zs) =\n  (Dec \\<BB>\\<^sub>F {u, v} z) \\<cdot> (Dec \\<BB>\\<^sub>F {u, v} concat zs)\n  Dec \\<BB>\\<^sub>F {u, v} z \\<noteq> \\<epsilon>\n  hd (?xs \\<cdot> ?ys) = (if ?xs = \\<epsilon> then hd ?ys else hd ?xs)\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n    hd (Dec \\<BB>\\<^sub>F {u, v} z)", "by simp"], ["proof (state)\nthis:\n  hd (Dec \\<BB>\\<^sub>F {u, v} concat (z # zs)) =\n  hd (Dec \\<BB>\\<^sub>F {u, v} z)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?z \\<noteq> \\<epsilon>; ?z # ?zs \\<in> lists {u, v}\\<rbrakk>\n  \\<Longrightarrow> hd (Dec \\<BB>\\<^sub>F {u, v} concat (?z # ?zs)) =\n                    hd (Dec \\<BB>\\<^sub>F {u, v} ?z)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n     concat (x # xs) = concat (y # ys)\\<rbrakk>\n    \\<Longrightarrow> x # xs = y # ys", "have \"hd (Dec \\<BB>\\<^sub>F {u,v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u,v} v)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u, v} v)", "using non_comm_hds_neq[OF assms]"], ["proof (prove)\nusing this:\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u, v} v)\n\ngoal (1 subgoal):\n 1. hd (Dec \\<BB>\\<^sub>F {u, v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u, v} v)", "."], ["proof (state)\nthis:\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u, v} v)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n     concat (x # xs) = concat (y # ys)\\<rbrakk>\n    \\<Longrightarrow> x # xs = y # ys", "hence \"x  = y\""], ["proof (prove)\nusing this:\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u, v} v)\n\ngoal (1 subgoal):\n 1. x = y", "using hd_z[OF \\<open>x \\<noteq> \\<epsilon>\\<close> \\<open>x # xs \\<in> lists {u, v}\\<close> , unfolded \\<open>concat (x # xs) = concat (y # ys)\\<close> hd_z[OF \\<open>y \\<noteq> \\<epsilon>\\<close> \\<open>y # ys \\<in> lists {u, v}\\<close>]] or_x or_y"], ["proof (prove)\nusing this:\n  hd (Dec \\<BB>\\<^sub>F {u, v} u) \\<noteq> hd (Dec \\<BB>\\<^sub>F {u, v} v)\n  hd (Dec \\<BB>\\<^sub>F {u, v} y) = hd (Dec \\<BB>\\<^sub>F {u, v} x)\n  x = u \\<or> x = v\n  y = u \\<or> y = v\n\ngoal (1 subgoal):\n 1. x = y", "by fastforce"], ["proof (state)\nthis:\n  x = y\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n              concat xs = concat ys\\<rbrakk>\n             \\<Longrightarrow> xs = ys;\n     x # xs \\<in> lists {u, v}; y # ys \\<in> lists {u, v};\n     concat (x # xs) = concat (y # ys)\\<rbrakk>\n    \\<Longrightarrow> x # xs = y # ys", "thus ?thesis"], ["proof (prove)\nusing this:\n  x = y\n\ngoal (1 subgoal):\n 1. x # xs = y # ys", "using \"4.hyps\" \"4.prems\""], ["proof (prove)\nusing this:\n  x = y\n  \\<lbrakk>xs \\<in> lists {u, v}; ys \\<in> lists {u, v};\n   concat xs = concat ys\\<rbrakk>\n  \\<Longrightarrow> xs = ys\n  x # xs \\<in> lists {u, v}\n  y # ys \\<in> lists {u, v}\n  concat (x # xs) = concat (y # ys)\n\ngoal (1 subgoal):\n 1. x # xs = y # ys", "by auto"], ["proof (state)\nthis:\n  x # xs = y # ys\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x # xs = y # ys\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}