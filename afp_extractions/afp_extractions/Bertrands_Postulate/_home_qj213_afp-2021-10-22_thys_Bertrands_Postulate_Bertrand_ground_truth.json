{"file_name": "/home/qj213/afp-2021-10-22/thys/Bertrands_Postulate/Bertrand.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Bertrands_Postulate", "problem_names": ["lemma ln_2_le: \"ln 2 \\<le> 355 / (512 :: real)\"", "lemma ln_2_ge: \"ln 2 \\<ge> (5677 / 8192 :: real)\"", "lemma ln_2_ge': \"ln (2 :: real) \\<ge> 2/3\" and ln_2_le': \"ln (2 :: real) \\<le> 16/23\"", "lemma of_nat_ge_1_iff: \"(of_nat x :: 'a :: linordered_semidom) \\<ge> 1 \\<longleftrightarrow> x \\<ge> 1\"", "lemma floor_conv_div_nat:\n  \"of_int (floor (real m / real n)) = real (m div n)\"", "lemma frac_conv_mod_nat:\n  \"frac (real m / real n) = real (m mod n) / real n\"", "lemma of_nat_prod_mset: \"prod_mset (image_mset of_nat A) = of_nat (prod_mset A)\"", "lemma prod_mset_pos: \"(\\<And>x :: 'a :: linordered_semidom. x \\<in># A \\<Longrightarrow> x > 0) \\<Longrightarrow> prod_mset A > 0\"", "lemma ln_msetprod:\n  assumes \"\\<And>x. x \\<in>#I \\<Longrightarrow> x > 0\"\n  shows \"(\\<Sum>p::nat\\<in>#I. ln p) = ln (\\<Prod>p\\<in>#I. p)\"", "lemma ln_fact: \"ln (fact n) = (\\<Sum>d=1..n. ln d)\"", "lemma overpower_lemma:\n  fixes f g :: \"real \\<Rightarrow> real\"\n  assumes \"f a \\<le> g a\"\n  assumes \"\\<And>x. a \\<le> x \\<Longrightarrow> ((\\<lambda>x. g x - f x) has_real_derivative (d x)) (at x)\"\n  assumes \"\\<And>x. a \\<le> x \\<Longrightarrow> d x \\<ge> 0\"\n  assumes \"a \\<le> x\"\n  shows   \"f x \\<le> g x\"", "lemma primepow_even_imp_primepow:\n  assumes \"primepow_even n\"\n  shows   \"primepow n\"", "lemma primepow_odd_imp_primepow:\n  assumes \"primepow_odd n\"\n  shows   \"primepow n\"", "lemma primepow_odd_altdef:\n  \"primepow_odd n \\<longleftrightarrow>\n     primepow n \\<and> odd (multiplicity (aprimedivisor n) n) \\<and> multiplicity (aprimedivisor n) n > 1\"", "lemma primepow_even_altdef:\n  \"primepow_even n \\<longleftrightarrow> primepow n \\<and> even (multiplicity (aprimedivisor n) n)\"", "lemma primepow_odd_mult:\n  assumes \"d > Suc 0\"\n  shows   \"primepow_odd (aprimedivisor d * d) \\<longleftrightarrow> primepow_even d\"", "lemma pre_mangoldt_primepow:\n  assumes \"primepow n\" \"aprimedivisor n = p\"\n  shows   \"pre_mangoldt n = p\"", "lemma pre_mangoldt_notprimepow:\n  assumes \"\\<not>primepow n\"\n  shows   \"pre_mangoldt n = 1\"", "lemma primepow_cases:\n  \"primepow d \\<longleftrightarrow>\n     (  primepow_even d \\<and> \\<not> primepow_odd d \\<and> \\<not> prime d) \\<or>\n     (\\<not> primepow_even d \\<and>   primepow_odd d \\<and> \\<not> prime d) \\<or>\n     (\\<not> primepow_even d \\<and> \\<not> primepow_odd d \\<and>   prime d)\"", "lemma ln_fact_bounds:\n  assumes \"n > 0\"\n  shows \"abs(ln (fact n) - n * ln n + n) \\<le> 1 + ln n\"", "lemma ln_fact_diff_bounds:\n  \"abs(ln (fact n) - 2 * ln (fact (n div 2)) - n * ln 2) \\<le> 4 * ln (if n = 0 then 1 else n) + 3\"", "lemma ln_primefact:\n  assumes \"n \\<noteq> (0::nat)\"\n  shows   \"ln n = (\\<Sum>d=1..n. if primepow d \\<and> d dvd n then ln (aprimedivisor d) else 0)\" \n          (is \"?lhs = ?rhs\")", "lemma divisors:\n  fixes x d::nat\n  assumes \"x \\<in> {1..n}\"\n  assumes \"d dvd x\"\n  shows \"\\<exists>k\\<in>{1..n div d}. x = d * k\"", "lemma ln_fact_conv_mangoldt: \"ln (fact n) = (\\<Sum>d=1..n. mangoldt d * floor (n / d))\"", "lemma div_2_mult_2_bds:\n  fixes n d :: nat\n  assumes \"d > 0\"\n  shows \"0 \\<le> \\<lfloor>n / d\\<rfloor> - 2 * \\<lfloor>(n div 2) / d\\<rfloor>\" \"\\<lfloor>n / d\\<rfloor> - 2 * \\<lfloor>(n div 2) / d\\<rfloor> \\<le> 1\"", "lemma n_div_d_eq_1: \"d \\<in> {n div 2 + 1..n} \\<Longrightarrow> \\<lfloor>real n / real d\\<rfloor> = 1\"", "lemma psi_bounds_ln_fact:\n  shows \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\"\n        \"psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\"", "lemma psi_bounds_induct:\n  \"real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\"\n  \"psi n - psi (n div 2) \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\"", "lemma Ball_insertD:\n  assumes \"\\<forall>x\\<in>insert y A. P x\"\n  shows   \"P y\" \"\\<forall>x\\<in>A. P x\"", "lemma meta_eq_TrueE: \"PROP A \\<equiv> Trueprop True \\<Longrightarrow> PROP A\"", "lemma pre_mangoldt_pos: \"pre_mangoldt n > 0\"", "lemma psi_conv_pre_mangoldt: \"psi n = ln (real (prod pre_mangoldt {1..n}))\"", "lemma eval_psi_aux1: \"psi 0 = ln (real (numeral Num.One))\"", "lemma eval_psi_aux2:\n  assumes \"psi m = ln (real (numeral x))\" \"pre_mangoldt n = y\" \"m + 1 = n\" \"numeral x * y = z\"\n  shows   \"psi n = ln (real z)\"", "lemma Ball_atLeast0AtMost_doubleton:\n  assumes \"psi 0 \\<le> 3 / 2 * ln 2 * real 0\"\n  assumes \"psi 1 \\<le> 3 / 2 * ln 2 * real 1\"\n  shows   \"(\\<forall>x\\<in>{0..1}. psi x \\<le> 3 / 2 * ln 2 * real x)\"", "lemma Ball_atLeast0AtMost_insert:\n  assumes \"(\\<forall>x\\<in>{0..m}. psi x \\<le> 3 / 2 * ln 2 * real x)\"\n  assumes \"psi (numeral n) \\<le> 3 / 2 * ln 2 * real (numeral n)\" \"m = pred_numeral n\"\n  shows   \"(\\<forall>x\\<in>{0..numeral n}. psi x \\<le> 3 / 2 * ln 2 * real x)\"", "lemma eval_psi_ineq_aux:\n  assumes \"psi n = x\" \"x \\<le> 3 / 2 * ln 2 * n\"\n  shows   \"psi n \\<le> 3 / 2 * ln 2 * n\"", "lemma eval_psi_ineq_aux2:\n  assumes \"numeral m ^ 2 \\<le> (2::nat) ^ (3 * n)\"\n  shows   \"ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n\"", "lemma eval_psi_ineq_aux_mono:\n  assumes \"psi n = x\" \"psi m = x\" \"psi n \\<le> 3 / 2 * ln 2 * n\" \"n \\<le> m\"\n  shows   \"psi m \\<le> 3 / 2 * ln 2 * m\"", "lemma not_primepow_1_nat: \"\\<not>primepow (1 :: nat)\"", "lemma psi_ubound_aux:\n  defines \"f \\<equiv> \\<lambda>x::real. (4 * ln x + 3) / (ln 2 * x)\"\n  assumes \"x \\<ge> 2\" \"x \\<le> y\"\n  shows   \"f x \\<ge> f y\"", "lemma psi_ubound_log_double_cases':\n  assumes \"\\<And>n. n \\<le> m \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\" \"n \\<le> m'\" \"m' = 2*m\"\n          \"c \\<le> c'\" \"c \\<ge> 0\" \"m \\<ge> 1\" \"c' \\<ge> 1 + c/2 + (4 * ln (m+1) + 3) / (ln 2 * (m+1))\"\n  shows   \"psi n \\<le> c' * ln 2 * real n\"", "lemma psi_ubound_log_double_cases:\n  assumes \"\\<forall>n\\<le>m. psi n \\<le> c * ln 2 * real n\"\n          \"c' \\<ge> 1 + c/2 + (4 * ln (m+1) + 3) / (ln 2 * (m+1))\"\n          \"m' = 2*m\" \"c \\<le> c'\" \"c \\<ge> 0\" \"m \\<ge> 1\" \n  shows   \"\\<forall>n\\<le>m'. psi n \\<le> c' * ln 2 * real n\"", "lemma psi_ubound_log_1024:\n  \"\\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n\"", "lemma psi_bounds_sustained_induct:\n  assumes \"4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2^j)\"\n  assumes \"4 / (1 + 2^j) \\<le> d * ln 2\"\n  assumes \"0 \\<le> c\"\n  assumes \"c / 2 + d + 1 \\<le> c\"\n  assumes \"j \\<le> k\"\n  assumes \"\\<And>n. n \\<le> 2^k \\<Longrightarrow> psi n \\<le> c * ln 2 * n\"\n  assumes \"n \\<le> 2^(Suc k)\"\n  shows \"psi n \\<le> c * ln 2 * n\"", "lemma psi_bounds_sustained:\n  assumes \"\\<And>n. n \\<le> 2^k \\<Longrightarrow> psi n \\<le> c * ln 2 * n\"\n  assumes \"4 * ln (1 + 2^k) + 3 \\<le> (c/2 - 1) * ln 2 * (1 + 2^k)\"\n  assumes \"4 / (1 + 2^k) \\<le> (c/2 - 1) * ln 2\"\n  assumes \"c \\<ge> 0\"\n  shows \"psi n \\<le> c * ln 2 * n\"", "lemma psi_ubound_log: \"psi n \\<le> 551 / 256 * ln 2 * n\"", "lemma psi_ubound_3_2: \"psi n \\<le> 3/2 * n\"", "lemma psi_residues_compare_2:\n  \"psi_odd_2 n \\<le> psi_even_2 n\"", "lemma psi_residues_compare:\n  \"psi_odd n \\<le> psi_even n\"", "lemma primepow_iff_even_sqr:\n  \"primepow n \\<longleftrightarrow> primepow_even (n^2)\"", "lemma psi_sqrt: \"psi (Discrete.sqrt n) = psi_even n\"", "lemma mangoldt_split:\n  \"mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d\"", "lemma psi_split: \"psi n = theta n + psi_even n + psi_odd n\"", "lemma psi_mono: \"m \\<le> n \\<Longrightarrow> psi m \\<le> psi n\"", "lemma psi_pos: \"0 \\<le> psi n\"", "lemma mangoldt_odd_pos: \"0 \\<le> mangoldt_odd d\"", "lemma psi_odd_mono: \"m \\<le> n \\<Longrightarrow> psi_odd m \\<le> psi_odd n\"", "lemma psi_odd_pos: \"0 \\<le> psi_odd n\"", "lemma psi_theta:\n  \"theta n + psi (Discrete.sqrt n) \\<le> psi n\" \"psi n \\<le> theta n + 2 * psi (Discrete.sqrt n)\"", "lemma sum_minus_one: \n  \"(\\<Sum>x \\<in> {1..y}. (- 1 :: real) ^ (x + 1)) = (if odd y then 1 else 0)\"", "lemma div_invert:\n  fixes x y n :: nat\n  assumes \"x > 0\" \"y > 0\" \"y \\<le> n div x\"\n  shows \"x \\<le> n div y\"", "lemma sum_expand_lemma:\n  \"(\\<Sum>d=1..n. (-1) ^ (d + 1) * psi (n div d)) = \n     (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)\"", "lemma floor_half_interval:\n  fixes n d :: nat\n  assumes \"d \\<noteq> 0\"\n  shows \"real (n div d) - real (2 * ((n div 2) div d)) = (if odd (n div d) then 1 else 0)\"", "lemma fact_expand_psi:\n  \"ln (fact n) - 2 * ln (fact (n div 2)) = (\\<Sum>d=1..n. (-1)^(d+1) * psi (n div d))\"", "lemma psi_expansion_cutoff:\n  assumes \"m \\<le> p\"\n  shows   \"(\\<Sum>d=1..2*m. (-1)^(d+1) * psi (n div d)) \\<le> (\\<Sum>d=1..2*p. (-1)^(d+1) * psi (n div d))\"\n          \"(\\<Sum>d=1..2*p+1. (-1)^(d+1) * psi (n div d)) \\<le> (\\<Sum>d=1..2*m+1. (-1)^(d+1) * psi (n div d))\"", "lemma fact_psi_bound_even:\n  assumes \"even k\"\n  shows   \"(\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d)) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\"", "lemma fact_psi_bound_odd:\n  assumes \"odd k\"\n  shows \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> (\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d))\"", "lemma fact_psi_bound_2_3:\n  \"psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\"\n  \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n - psi (n div 2) + psi (n div 3)\"", "lemma ub_ln_1200: \"ln 1200 \\<le> 57 / (8 :: real)\"", "lemma psi_double_lemma:\n  assumes \"n \\<ge> 1200\"\n  shows \"real n / 6 \\<le> psi n - psi (n div 2)\"", "lemma theta_double_lemma:\n  assumes \"n \\<ge> 1200\"\n  shows \"theta (n div 2) < theta n\"", "lemma theta_mono: \"mono theta\"", "lemma theta_lessE:\n  assumes \"theta m < theta n\" \"m \\<ge> 1\"\n  obtains p where \"p \\<in> {m<..n}\" \"prime p\"", "theorem bertrand:\n  fixes   n :: nat\n  assumes \"n > 1\"\n  shows   \"\\<exists>p\\<in>{n<..<2*n}. prime p\"", "lemma sum_integral_ubound_decreasing':\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"m \\<le> n\"\n      and der: \"\\<And>x. x \\<in> {of_nat m - 1..of_nat n} \\<Longrightarrow> (g has_field_derivative f x) (at x)\"\n      and le:  \"\\<And>x y. \\<lbrakk>real m - 1 \\<le> x; x \\<le> y; y \\<le> real n\\<rbrakk> \\<Longrightarrow> f y \\<le> f x\"\n    shows \"(\\<Sum>k = m..n. f (of_nat k)) \\<le> g (of_nat n) - g (of_nat m - 1)\"", "lemma Mertens_lemma:\n  assumes \"n \\<noteq> 0\"\n    shows \"\\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln n\\<bar> \\<le> 4\"", "lemma Mertens_mangoldt_versus_ln:\n  assumes \"I \\<subseteq> {1..n}\"\n  shows \"\\<bar>(\\<Sum>i\\<in>I. mangoldt i / i) - (\\<Sum>p | prime p \\<and> p \\<in> I. ln p / p)\\<bar> \\<le> 3\"\n        (is \"\\<bar>?lhs\\<bar> \\<le> 3\")"], "translations": [["", "lemma ln_2_le: \"ln 2 \\<le> 355 / (512 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln 2 \\<le> 355 / 512", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln 2 \\<le> 355 / 512", "have \"ln 2 \\<le> real_of_float (ub_ln2 12)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln 2 \\<le> real_of_float (ub_ln2 12)", "by (rule ub_ln2)"], ["proof (state)\nthis:\n  ln 2 \\<le> real_of_float (ub_ln2 12)\n\ngoal (1 subgoal):\n 1. ln 2 \\<le> 355 / 512", "also"], ["proof (state)\nthis:\n  ln 2 \\<le> real_of_float (ub_ln2 12)\n\ngoal (1 subgoal):\n 1. ln 2 \\<le> 355 / 512", "have \"ub_ln2 12 = Float 5680 (- 13)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ub_ln2 12 = Float 5680 (- 13)", "by code_simp"], ["proof (state)\nthis:\n  ub_ln2 12 = Float 5680 (- 13)\n\ngoal (1 subgoal):\n 1. ln 2 \\<le> 355 / 512", "finally"], ["proof (chain)\npicking this:\n  ln 2 \\<le> real_of_float (Float 5680 (- 13))", "show ?thesis"], ["proof (prove)\nusing this:\n  ln 2 \\<le> real_of_float (Float 5680 (- 13))\n\ngoal (1 subgoal):\n 1. ln 2 \\<le> 355 / 512", "by simp"], ["proof (state)\nthis:\n  ln 2 \\<le> 355 / 512\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ln_2_ge: \"ln 2 \\<ge> (5677 / 8192 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 5677 / 8192 \\<le> ln 2", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. 5677 / 8192 \\<le> ln 2", "have \"ln 2 \\<ge> real_of_float (lb_ln2 12)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_float (lb_ln2 12) \\<le> ln 2", "by (rule lb_ln2)"], ["proof (state)\nthis:\n  real_of_float (lb_ln2 12) \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 5677 / 8192 \\<le> ln 2", "also"], ["proof (state)\nthis:\n  real_of_float (lb_ln2 12) \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 5677 / 8192 \\<le> ln 2", "have \"lb_ln2 12 = Float 5677 (-13)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lb_ln2 12 = Float 5677 (- 13)", "by code_simp"], ["proof (state)\nthis:\n  lb_ln2 12 = Float 5677 (- 13)\n\ngoal (1 subgoal):\n 1. 5677 / 8192 \\<le> ln 2", "finally"], ["proof (chain)\npicking this:\n  real_of_float (Float 5677 (- 13)) \\<le> ln 2", "show ?thesis"], ["proof (prove)\nusing this:\n  real_of_float (Float 5677 (- 13)) \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 5677 / 8192 \\<le> ln 2", "by simp"], ["proof (state)\nthis:\n  5677 / 8192 \\<le> ln 2\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ln_2_ge': \"ln (2 :: real) \\<ge> 2/3\" and ln_2_le': \"ln (2 :: real) \\<le> 16/23\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / 3 \\<le> ln 2 &&& ln 2 \\<le> 16 / 23", "using ln_2_le ln_2_ge"], ["proof (prove)\nusing this:\n  ln 2 \\<le> 355 / 512\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 2 / 3 \\<le> ln 2 &&& ln 2 \\<le> 16 / 23", "by simp_all"], ["", "lemma of_nat_ge_1_iff: \"(of_nat x :: 'a :: linordered_semidom) \\<ge> 1 \\<longleftrightarrow> x \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((1::'a) \\<le> of_nat x) = (1 \\<le> x)", "using of_nat_le_iff[of 1 x]"], ["proof (prove)\nusing this:\n  (of_nat 1 \\<le> of_nat x) = (1 \\<le> x)\n\ngoal (1 subgoal):\n 1. ((1::'a) \\<le> of_nat x) = (1 \\<le> x)", "by (subst (asm) of_nat_1)"], ["", "lemma floor_conv_div_nat:\n  \"of_int (floor (real m / real n)) = real (m div n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int \\<lfloor>real m / real n\\<rfloor> = real (m div n)", "by (subst floor_divide_of_nat_eq) simp"], ["", "lemma frac_conv_mod_nat:\n  \"frac (real m / real n) = real (m mod n) / real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. frac (real m / real n) = real (m mod n) / real n", "by (cases \"n = 0\")\n     (simp_all add: frac_def floor_conv_div_nat field_simps of_nat_mult \n        [symmetric] of_nat_add [symmetric] del: of_nat_mult of_nat_add)"], ["", "lemma of_nat_prod_mset: \"prod_mset (image_mset of_nat A) = of_nat (prod_mset A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<Prod>\\<^sub># (image_mset of_nat A) = of_nat (\\<Prod>\\<^sub># A)", "by (induction A) simp_all"], ["", "lemma prod_mset_pos: \"(\\<And>x :: 'a :: linordered_semidom. x \\<in># A \\<Longrightarrow> x > 0) \\<Longrightarrow> prod_mset A > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x. x \\<in># A \\<Longrightarrow> (0::'a) < x) \\<Longrightarrow>\n    (0::'a) < \\<Prod>\\<^sub># A", "by (induction A) simp_all"], ["", "lemma ln_msetprod:\n  assumes \"\\<And>x. x \\<in>#I \\<Longrightarrow> x > 0\"\n  shows \"(\\<Sum>p::nat\\<in>#I. ln p) = ln (\\<Prod>p\\<in>#I. p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p\\<in>#I. ln (real p)) = ln (\\<Prod>\\<^sub># (image_mset real I))", "using assms"], ["proof (prove)\nusing this:\n  ?x \\<in># I \\<Longrightarrow> 0 < ?x\n\ngoal (1 subgoal):\n 1. (\\<Sum>p\\<in>#I. ln (real p)) = ln (\\<Prod>\\<^sub># (image_mset real I))", "by (induction I) (simp_all add: of_nat_prod_mset ln_mult prod_mset_pos)"], ["", "lemma ln_fact: \"ln (fact n) = (\\<Sum>d=1..n. ln d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (fact n) = (\\<Sum>d = 1..n. ln (real d))", "by (induction n) (simp_all add: ln_mult)"], ["", "lemma overpower_lemma:\n  fixes f g :: \"real \\<Rightarrow> real\"\n  assumes \"f a \\<le> g a\"\n  assumes \"\\<And>x. a \\<le> x \\<Longrightarrow> ((\\<lambda>x. g x - f x) has_real_derivative (d x)) (at x)\"\n  assumes \"\\<And>x. a \\<le> x \\<Longrightarrow> d x \\<ge> 0\"\n  assumes \"a \\<le> x\"\n  shows   \"f x \\<le> g x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f x \\<le> g x", "proof (cases \"a < x\")"], ["proof (state)\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "case True"], ["proof (state)\nthis:\n  a < x\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "with assms"], ["proof (chain)\npicking this:\n  f a \\<le> g a\n  a \\<le> ?x \\<Longrightarrow>\n  ((\\<lambda>x. g x - f x) has_real_derivative d ?x) (at ?x)\n  a \\<le> ?x \\<Longrightarrow> 0 \\<le> d ?x\n  a \\<le> x\n  a < x", "have \"\\<exists>z. z > a \\<and> z < x \\<and> g x - f x - (g a - f a) = (x - a) * d z\""], ["proof (prove)\nusing this:\n  f a \\<le> g a\n  a \\<le> ?x \\<Longrightarrow>\n  ((\\<lambda>x. g x - f x) has_real_derivative d ?x) (at ?x)\n  a \\<le> ?x \\<Longrightarrow> 0 \\<le> d ?x\n  a \\<le> x\n  a < x\n\ngoal (1 subgoal):\n 1. \\<exists>z>a. z < x \\<and> g x - f x - (g a - f a) = (x - a) * d z", "by (intro MVT2) auto"], ["proof (state)\nthis:\n  \\<exists>z>a. z < x \\<and> g x - f x - (g a - f a) = (x - a) * d z\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "then"], ["proof (chain)\npicking this:\n  \\<exists>z>a. z < x \\<and> g x - f x - (g a - f a) = (x - a) * d z", "obtain z where z: \"z > a\" \"z < x\" \"g x - f x - (g a - f a) = (x - a) * d z\""], ["proof (prove)\nusing this:\n  \\<exists>z>a. z < x \\<and> g x - f x - (g a - f a) = (x - a) * d z\n\ngoal (1 subgoal):\n 1. (\\<And>z.\n        \\<lbrakk>a < z; z < x;\n         g x - f x - (g a - f a) = (x - a) * d z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  a < z\n  z < x\n  g x - f x - (g a - f a) = (x - a) * d z\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "hence \"f x = g x + (f a - g a) + (a - x) * d z\""], ["proof (prove)\nusing this:\n  a < z\n  z < x\n  g x - f x - (g a - f a) = (x - a) * d z\n\ngoal (1 subgoal):\n 1. f x = g x + (f a - g a) + (a - x) * d z", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  f x = g x + (f a - g a) + (a - x) * d z\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "also"], ["proof (state)\nthis:\n  f x = g x + (f a - g a) + (a - x) * d z\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "from assms"], ["proof (chain)\npicking this:\n  f a \\<le> g a\n  a \\<le> ?x \\<Longrightarrow>\n  ((\\<lambda>x. g x - f x) has_real_derivative d ?x) (at ?x)\n  a \\<le> ?x \\<Longrightarrow> 0 \\<le> d ?x\n  a \\<le> x", "have \"f a - g a \\<le> 0\""], ["proof (prove)\nusing this:\n  f a \\<le> g a\n  a \\<le> ?x \\<Longrightarrow>\n  ((\\<lambda>x. g x - f x) has_real_derivative d ?x) (at ?x)\n  a \\<le> ?x \\<Longrightarrow> 0 \\<le> d ?x\n  a \\<le> x\n\ngoal (1 subgoal):\n 1. f a - g a \\<le> 0", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  f a - g a \\<le> 0\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "also"], ["proof (state)\nthis:\n  f a - g a \\<le> 0\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "from assms z"], ["proof (chain)\npicking this:\n  f a \\<le> g a\n  a \\<le> ?x \\<Longrightarrow>\n  ((\\<lambda>x. g x - f x) has_real_derivative d ?x) (at ?x)\n  a \\<le> ?x \\<Longrightarrow> 0 \\<le> d ?x\n  a \\<le> x\n  a < z\n  z < x\n  g x - f x - (g a - f a) = (x - a) * d z", "have \"(a - x) * d z \\<le> 0 * d z\""], ["proof (prove)\nusing this:\n  f a \\<le> g a\n  a \\<le> ?x \\<Longrightarrow>\n  ((\\<lambda>x. g x - f x) has_real_derivative d ?x) (at ?x)\n  a \\<le> ?x \\<Longrightarrow> 0 \\<le> d ?x\n  a \\<le> x\n  a < z\n  z < x\n  g x - f x - (g a - f a) = (x - a) * d z\n\ngoal (1 subgoal):\n 1. (a - x) * d z \\<le> 0 * d z", "by (intro mult_right_mono) simp_all"], ["proof (state)\nthis:\n  (a - x) * d z \\<le> 0 * d z\n\ngoal (2 subgoals):\n 1. a < x \\<Longrightarrow> f x \\<le> g x\n 2. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>xa y.\n              xa \\<le> y \\<Longrightarrow>\n              g x + xa + (a - x) * d z \\<le> g x + y + (a - x) * d z;\n   \\<And>xa y.\n      xa \\<le> y \\<Longrightarrow> g x + 0 + xa \\<le> g x + 0 + y\\<rbrakk>\n  \\<Longrightarrow> f x \\<le> g x + 0 + 0 * d z", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>xa y.\n              xa \\<le> y \\<Longrightarrow>\n              g x + xa + (a - x) * d z \\<le> g x + y + (a - x) * d z;\n   \\<And>xa y.\n      xa \\<le> y \\<Longrightarrow> g x + 0 + xa \\<le> g x + 0 + y\\<rbrakk>\n  \\<Longrightarrow> f x \\<le> g x + 0 + 0 * d z\n\ngoal (1 subgoal):\n 1. f x \\<le> g x", "by simp"], ["proof (state)\nthis:\n  f x \\<le> g x\n\ngoal (1 subgoal):\n 1. \\<not> a < x \\<Longrightarrow> f x \\<le> g x", "qed (insert assms, auto)"], ["", "subsection \\<open>Preliminary definitions\\<close>"], ["", "definition primepow_even :: \"nat \\<Rightarrow> bool\" where\n  \"primepow_even q \\<longleftrightarrow> (\\<exists> p k. 1 \\<le> k \\<and> prime p \\<and> q = p^(2*k))\""], ["", "definition primepow_odd :: \"nat \\<Rightarrow> bool\" where\n  \"primepow_odd q \\<longleftrightarrow> (\\<exists> p k. 1 \\<le> k \\<and> prime p \\<and> q = p^(2*k+1))\""], ["", "abbreviation (input) isprimedivisor :: \"nat \\<Rightarrow> nat \\<Rightarrow> bool\" where\n  \"isprimedivisor q p \\<equiv> prime p \\<and> p dvd q\""], ["", "definition pre_mangoldt :: \"nat \\<Rightarrow> nat\" where\n  \"pre_mangoldt d = (if primepow d then aprimedivisor d else 1)\""], ["", "definition mangoldt_even :: \"nat \\<Rightarrow> real\" where\n  \"mangoldt_even d = (if primepow_even d then ln (real (aprimedivisor d)) else 0)\""], ["", "definition mangoldt_odd :: \"nat \\<Rightarrow> real\" where\n  \"mangoldt_odd d = (if primepow_odd d then ln (real (aprimedivisor d)) else 0)\""], ["", "definition mangoldt_1 :: \"nat \\<Rightarrow> real\" where\n  \"mangoldt_1 d = (if prime d then ln d else 0)\""], ["", "definition psi :: \"nat \\<Rightarrow> real\" where\n  \"psi n = (\\<Sum>d=1..n. mangoldt d)\""], ["", "definition psi_even :: \"nat \\<Rightarrow> real\" where\n  \"psi_even n = (\\<Sum>d=1..n. mangoldt_even d)\""], ["", "definition psi_odd :: \"nat \\<Rightarrow> real\" where\n  \"psi_odd n = (\\<Sum>d=1..n. mangoldt_odd d)\""], ["", "abbreviation (input) psi_even_2 :: \"nat \\<Rightarrow> real\" where\n  \"psi_even_2 n \\<equiv> (\\<Sum>d=2..n. mangoldt_even d)\""], ["", "abbreviation (input) psi_odd_2 :: \"nat \\<Rightarrow> real\" where\n  \"psi_odd_2 n \\<equiv> (\\<Sum>d=2..n. mangoldt_odd d)\""], ["", "definition theta :: \"nat \\<Rightarrow> real\" where\n  \"theta n = (\\<Sum>p=1..n. if prime p then ln (real p) else 0)\""], ["", "subsection \\<open>Properties of prime powers\\<close>"], ["", "lemma primepow_even_imp_primepow:\n  assumes \"primepow_even n\"\n  shows   \"primepow n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primepow n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. primepow n", "from assms"], ["proof (chain)\npicking this:\n  primepow_even n", "obtain p k where \"1 \\<le> k\" \"prime p\" \"n = p ^ (2 * k)\""], ["proof (prove)\nusing this:\n  primepow_even n\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ (2 * k)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding primepow_even_def"], ["proof (prove)\nusing this:\n  \\<exists>p k. 1 \\<le> k \\<and> prime p \\<and> n = p ^ (2 * k)\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ (2 * k)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k)\n\ngoal (1 subgoal):\n 1. primepow n", "moreover"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k)\n\ngoal (1 subgoal):\n 1. primepow n", "from \\<open>1 \\<le> k\\<close>"], ["proof (chain)\npicking this:\n  1 \\<le> k", "have \"2 * k > 0\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n\ngoal (1 subgoal):\n 1. 0 < 2 * k", "by simp"], ["proof (state)\nthis:\n  0 < 2 * k\n\ngoal (1 subgoal):\n 1. primepow n", "ultimately"], ["proof (chain)\npicking this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k)\n  0 < 2 * k", "show ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k)\n  0 < 2 * k\n\ngoal (1 subgoal):\n 1. primepow n", "unfolding primepow_def"], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k)\n  0 < 2 * k\n\ngoal (1 subgoal):\n 1. \\<exists>p k. prime p \\<and> 0 < k \\<and> n = p ^ k", "by blast"], ["proof (state)\nthis:\n  primepow n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma primepow_odd_imp_primepow:\n  assumes \"primepow_odd n\"\n  shows   \"primepow n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primepow n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. primepow n", "from assms"], ["proof (chain)\npicking this:\n  primepow_odd n", "obtain p k where \"1 \\<le> k\" \"prime p\" \"n = p ^ (2 * k + 1)\""], ["proof (prove)\nusing this:\n  primepow_odd n\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ (2 * k + 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "unfolding primepow_odd_def"], ["proof (prove)\nusing this:\n  \\<exists>p k. 1 \\<le> k \\<and> prime p \\<and> n = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ (2 * k + 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. primepow n", "moreover"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. primepow n", "from \\<open>1 \\<le> k\\<close>"], ["proof (chain)\npicking this:\n  1 \\<le> k", "have \"Suc (2 * k) > 0\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n\ngoal (1 subgoal):\n 1. 0 < Suc (2 * k)", "by simp"], ["proof (state)\nthis:\n  0 < Suc (2 * k)\n\ngoal (1 subgoal):\n 1. primepow n", "ultimately"], ["proof (chain)\npicking this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k + 1)\n  0 < Suc (2 * k)", "show ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k + 1)\n  0 < Suc (2 * k)\n\ngoal (1 subgoal):\n 1. primepow n", "unfolding primepow_def"], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k + 1)\n  0 < Suc (2 * k)\n\ngoal (1 subgoal):\n 1. \\<exists>p k. prime p \\<and> 0 < k \\<and> n = p ^ k", "by (auto simp del: power_Suc)"], ["proof (state)\nthis:\n  primepow n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma primepow_odd_altdef:\n  \"primepow_odd n \\<longleftrightarrow>\n     primepow n \\<and> odd (multiplicity (aprimedivisor n) n) \\<and> multiplicity (aprimedivisor n) n > 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primepow_odd n =\n    (primepow n \\<and>\n     odd (multiplicity (aprimedivisor n) n) \\<and>\n     1 < multiplicity (aprimedivisor n) n)", "proof (intro iffI conjI; (elim conjE)?)"], ["proof (state)\ngoal (4 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. primepow_odd n \\<Longrightarrow> odd (multiplicity (aprimedivisor n) n)\n 3. primepow_odd n \\<Longrightarrow> 1 < multiplicity (aprimedivisor n) n\n 4. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "assume \"primepow_odd n\""], ["proof (state)\nthis:\n  primepow_odd n\n\ngoal (4 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. primepow_odd n \\<Longrightarrow> odd (multiplicity (aprimedivisor n) n)\n 3. primepow_odd n \\<Longrightarrow> 1 < multiplicity (aprimedivisor n) n\n 4. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "then"], ["proof (chain)\npicking this:\n  primepow_odd n", "obtain p k where n: \"k \\<ge> 1\" \"prime p\" \"n = p ^ (2 * k + 1)\""], ["proof (prove)\nusing this:\n  primepow_odd n\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ (2 * k + 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: primepow_odd_def)"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k + 1)\n\ngoal (4 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. primepow_odd n \\<Longrightarrow> odd (multiplicity (aprimedivisor n) n)\n 3. primepow_odd n \\<Longrightarrow> 1 < multiplicity (aprimedivisor n) n\n 4. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "thus \"odd (multiplicity (aprimedivisor n) n)\" \"multiplicity (aprimedivisor n) n > 1\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. odd (multiplicity (aprimedivisor n) n) &&&\n    1 < multiplicity (aprimedivisor n) n", "by (simp_all add: aprimedivisor_primepow prime_elem_multiplicity_mult_distrib)"], ["proof (state)\nthis:\n  odd (multiplicity (aprimedivisor n) n)\n  1 < multiplicity (aprimedivisor n) n\n\ngoal (2 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "assume A: \"primepow n\" and B: \"odd (multiplicity (aprimedivisor n) n)\"\n     and C: \"multiplicity (aprimedivisor n) n > 1\""], ["proof (state)\nthis:\n  primepow n\n  odd (multiplicity (aprimedivisor n) n)\n  1 < multiplicity (aprimedivisor n) n\n\ngoal (2 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "from A"], ["proof (chain)\npicking this:\n  primepow n", "obtain p k where n: \"k \\<ge> 1\" \"prime p\" \"n = p ^ k\""], ["proof (prove)\nusing this:\n  primepow n\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ k\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: primepow_def Suc_le_eq)"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ k\n\ngoal (2 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "with B C"], ["proof (chain)\npicking this:\n  odd (multiplicity (aprimedivisor n) n)\n  1 < multiplicity (aprimedivisor n) n\n  1 \\<le> k\n  prime p\n  n = p ^ k", "have \"odd k\" \"k > 1\""], ["proof (prove)\nusing this:\n  odd (multiplicity (aprimedivisor n) n)\n  1 < multiplicity (aprimedivisor n) n\n  1 \\<le> k\n  prime p\n  n = p ^ k\n\ngoal (1 subgoal):\n 1. odd k &&& 1 < k", "by (simp_all add: aprimedivisor_primepow prime_elem_multiplicity_mult_distrib)"], ["proof (state)\nthis:\n  odd k\n  1 < k\n\ngoal (2 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "then"], ["proof (chain)\npicking this:\n  odd k\n  1 < k", "obtain j where j: \"k = 2 * j + 1\" \"j > 0\""], ["proof (prove)\nusing this:\n  odd k\n  1 < k\n\ngoal (1 subgoal):\n 1. (\\<And>j.\n        \\<lbrakk>k = 2 * j + 1; 0 < j\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto elim!: oddE)"], ["proof (state)\nthis:\n  k = 2 * j + 1\n  0 < j\n\ngoal (2 subgoals):\n 1. primepow_odd n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; odd (multiplicity (aprimedivisor n) n);\n     1 < multiplicity (aprimedivisor n) n\\<rbrakk>\n    \\<Longrightarrow> primepow_odd n", "with n"], ["proof (chain)\npicking this:\n  1 \\<le> k\n  prime p\n  n = p ^ k\n  k = 2 * j + 1\n  0 < j", "show \"primepow_odd n\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  n = p ^ k\n  k = 2 * j + 1\n  0 < j\n\ngoal (1 subgoal):\n 1. primepow_odd n", "by (auto simp: primepow_odd_def intro!: exI[of _ p, OF exI[of _ j]])"], ["proof (state)\nthis:\n  primepow_odd n\n\ngoal (1 subgoal):\n 1. primepow_odd n \\<Longrightarrow> primepow n", "qed (auto dest: primepow_odd_imp_primepow)"], ["", "lemma primepow_even_altdef:\n  \"primepow_even n \\<longleftrightarrow> primepow n \\<and> even (multiplicity (aprimedivisor n) n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primepow_even n =\n    (primepow n \\<and> even (multiplicity (aprimedivisor n) n))", "proof (intro iffI conjI; (elim conjE)?)"], ["proof (state)\ngoal (3 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. primepow_even n \\<Longrightarrow>\n    even (multiplicity (aprimedivisor n) n)\n 3. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "assume \"primepow_even n\""], ["proof (state)\nthis:\n  primepow_even n\n\ngoal (3 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. primepow_even n \\<Longrightarrow>\n    even (multiplicity (aprimedivisor n) n)\n 3. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "then"], ["proof (chain)\npicking this:\n  primepow_even n", "obtain p k where n: \"k \\<ge> 1\" \"prime p\" \"n = p ^ (2 * k)\""], ["proof (prove)\nusing this:\n  primepow_even n\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ (2 * k)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: primepow_even_def)"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k)\n\ngoal (3 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. primepow_even n \\<Longrightarrow>\n    even (multiplicity (aprimedivisor n) n)\n 3. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "thus \"even (multiplicity (aprimedivisor n) n)\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  n = p ^ (2 * k)\n\ngoal (1 subgoal):\n 1. even (multiplicity (aprimedivisor n) n)", "by (simp_all add: aprimedivisor_primepow prime_elem_multiplicity_mult_distrib)"], ["proof (state)\nthis:\n  even (multiplicity (aprimedivisor n) n)\n\ngoal (2 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "assume A: \"primepow n\" and B: \"even (multiplicity (aprimedivisor n) n)\""], ["proof (state)\nthis:\n  primepow n\n  even (multiplicity (aprimedivisor n) n)\n\ngoal (2 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "from A"], ["proof (chain)\npicking this:\n  primepow n", "obtain p k where n: \"k \\<ge> 1\" \"prime p\" \"n = p ^ k\""], ["proof (prove)\nusing this:\n  primepow n\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; n = p ^ k\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: primepow_def Suc_le_eq)"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  n = p ^ k\n\ngoal (2 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "with B"], ["proof (chain)\npicking this:\n  even (multiplicity (aprimedivisor n) n)\n  1 \\<le> k\n  prime p\n  n = p ^ k", "have \"even k\""], ["proof (prove)\nusing this:\n  even (multiplicity (aprimedivisor n) n)\n  1 \\<le> k\n  prime p\n  n = p ^ k\n\ngoal (1 subgoal):\n 1. even k", "by (simp_all add: aprimedivisor_primepow prime_elem_multiplicity_mult_distrib)"], ["proof (state)\nthis:\n  even k\n\ngoal (2 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "then"], ["proof (chain)\npicking this:\n  even k", "obtain j where j: \"k = 2 * j\""], ["proof (prove)\nusing this:\n  even k\n\ngoal (1 subgoal):\n 1. (\\<And>j. k = 2 * j \\<Longrightarrow> thesis) \\<Longrightarrow> thesis", "by (auto elim!: evenE)"], ["proof (state)\nthis:\n  k = 2 * j\n\ngoal (2 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "from j n"], ["proof (chain)\npicking this:\n  k = 2 * j\n  1 \\<le> k\n  prime p\n  n = p ^ k", "have \"j \\<noteq> 0\""], ["proof (prove)\nusing this:\n  k = 2 * j\n  1 \\<le> k\n  prime p\n  n = p ^ k\n\ngoal (1 subgoal):\n 1. j \\<noteq> 0", "by (intro notI) simp_all"], ["proof (state)\nthis:\n  j \\<noteq> 0\n\ngoal (2 subgoals):\n 1. primepow_even n \\<Longrightarrow> primepow n\n 2. \\<lbrakk>primepow n; even (multiplicity (aprimedivisor n) n)\\<rbrakk>\n    \\<Longrightarrow> primepow_even n", "with j n"], ["proof (chain)\npicking this:\n  k = 2 * j\n  1 \\<le> k\n  prime p\n  n = p ^ k\n  j \\<noteq> 0", "show \"primepow_even n\""], ["proof (prove)\nusing this:\n  k = 2 * j\n  1 \\<le> k\n  prime p\n  n = p ^ k\n  j \\<noteq> 0\n\ngoal (1 subgoal):\n 1. primepow_even n", "by (auto simp: primepow_even_def intro!: exI[of _ p, OF exI[of _ j]])"], ["proof (state)\nthis:\n  primepow_even n\n\ngoal (1 subgoal):\n 1. primepow_even n \\<Longrightarrow> primepow n", "qed (auto dest: primepow_even_imp_primepow)"], ["", "lemma primepow_odd_mult:\n  assumes \"d > Suc 0\"\n  shows   \"primepow_odd (aprimedivisor d * d) \\<longleftrightarrow> primepow_even d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primepow_odd (aprimedivisor d * d) = primepow_even d", "using assms"], ["proof (prove)\nusing this:\n  Suc 0 < d\n\ngoal (1 subgoal):\n 1. primepow_odd (aprimedivisor d * d) = primepow_even d", "by (auto simp: primepow_odd_altdef primepow_even_altdef primepow_mult_aprimedivisorI\n                   aprimedivisor_primepow prime_aprimedivisor' aprimedivisor_dvd'\n                   prime_elem_multiplicity_mult_distrib prime_elem_aprimedivisor_nat\n             dest!: primepow_multD)"], ["", "lemma pre_mangoldt_primepow:\n  assumes \"primepow n\" \"aprimedivisor n = p\"\n  shows   \"pre_mangoldt n = p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pre_mangoldt n = p", "using assms"], ["proof (prove)\nusing this:\n  primepow n\n  aprimedivisor n = p\n\ngoal (1 subgoal):\n 1. pre_mangoldt n = p", "by (simp add: pre_mangoldt_def)"], ["", "lemma pre_mangoldt_notprimepow:\n  assumes \"\\<not>primepow n\"\n  shows   \"pre_mangoldt n = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pre_mangoldt n = 1", "using assms"], ["proof (prove)\nusing this:\n  \\<not> primepow n\n\ngoal (1 subgoal):\n 1. pre_mangoldt n = 1", "by (simp add: pre_mangoldt_def)"], ["", "lemma primepow_cases:\n  \"primepow d \\<longleftrightarrow>\n     (  primepow_even d \\<and> \\<not> primepow_odd d \\<and> \\<not> prime d) \\<or>\n     (\\<not> primepow_even d \\<and>   primepow_odd d \\<and> \\<not> prime d) \\<or>\n     (\\<not> primepow_even d \\<and> \\<not> primepow_odd d \\<and>   prime d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primepow d =\n    (primepow_even d \\<and>\n     \\<not> primepow_odd d \\<and> \\<not> prime d \\<or>\n     \\<not> primepow_even d \\<and>\n     primepow_odd d \\<and> \\<not> prime d \\<or>\n     \\<not> primepow_even d \\<and> \\<not> primepow_odd d \\<and> prime d)", "by (auto simp: primepow_even_altdef primepow_odd_altdef multiplicity_aprimedivisor_Suc_0_iff\n           elim!: oddE intro!: Nat.gr0I)"], ["", "subsection \\<open>Deriving a recurrence for the psi function\\<close>"], ["", "lemma ln_fact_bounds:\n  assumes \"n > 0\"\n  shows \"abs(ln (fact n) - n * ln n + n) \\<le> 1 + ln n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "have \"\\<forall>n\\<in>{0<..}. \\<exists>z>real n. z < real (n + 1) \\<and> real (n + 1) * ln (real (n + 1)) - \n          real n * ln (real n) = (real (n + 1) - real n) * (ln z + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>n\\<in>{0<..}.\n       \\<exists>z>real n.\n          z < real (n + 1) \\<and>\n          real (n + 1) * ln (real (n + 1)) - real n * ln (real n) =\n          (real (n + 1) - real n) * (ln z + 1)", "by (intro ballI MVT2) (auto intro!: derivative_eq_intros)"], ["proof (state)\nthis:\n  \\<forall>n\\<in>{0<..}.\n     \\<exists>z>real n.\n        z < real (n + 1) \\<and>\n        real (n + 1) * ln (real (n + 1)) - real n * ln (real n) =\n        (real (n + 1) - real n) * (ln z + 1)\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "hence \"\\<forall>n\\<in>{0<..}. \\<exists>z>real n. z < real (n + 1) \\<and> real (n + 1) * ln (real (n + 1)) - \n          real n * ln (real n) = (ln z + 1)\""], ["proof (prove)\nusing this:\n  \\<forall>n\\<in>{0<..}.\n     \\<exists>z>real n.\n        z < real (n + 1) \\<and>\n        real (n + 1) * ln (real (n + 1)) - real n * ln (real n) =\n        (real (n + 1) - real n) * (ln z + 1)\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<in>{0<..}.\n       \\<exists>z>real n.\n          z < real (n + 1) \\<and>\n          real (n + 1) * ln (real (n + 1)) - real n * ln (real n) = ln z + 1", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  \\<forall>n\\<in>{0<..}.\n     \\<exists>z>real n.\n        z < real (n + 1) \\<and>\n        real (n + 1) * ln (real (n + 1)) - real n * ln (real n) = ln z + 1\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "from bchoice[OF this]"], ["proof (chain)\npicking this:\n  \\<exists>f.\n     \\<forall>x\\<in>{0<..}.\n        real x < f x \\<and>\n        f x < real (x + 1) \\<and>\n        real (x + 1) * ln (real (x + 1)) - real x * ln (real x) =\n        ln (f x) + 1", "obtain k :: \"nat \\<Rightarrow> real\"\n    where lb: \"real n < k n\" and ub: \"k n < real (n + 1)\" and \n          mvt: \"real (n+1) * ln (real (n+1)) - real n * ln (real n) = ln (k n) + 1\" \n          if \"n > 0\" for n::nat"], ["proof (prove)\nusing this:\n  \\<exists>f.\n     \\<forall>x\\<in>{0<..}.\n        real x < f x \\<and>\n        f x < real (x + 1) \\<and>\n        real (x + 1) * ln (real (x + 1)) - real x * ln (real x) =\n        ln (f x) + 1\n\ngoal (1 subgoal):\n 1. (\\<And>k.\n        \\<lbrakk>\\<And>n. 0 < n \\<Longrightarrow> real n < k n;\n         \\<And>n. 0 < n \\<Longrightarrow> k n < real (n + 1);\n         \\<And>n.\n            0 < n \\<Longrightarrow>\n            real (n + 1) * ln (real (n + 1)) - real n * ln (real n) =\n            ln (k n) + 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < ?n \\<Longrightarrow> real ?n < k ?n\n  0 < ?n \\<Longrightarrow> k ?n < real (?n + 1)\n  0 < ?n \\<Longrightarrow>\n  real (?n + 1) * ln (real (?n + 1)) - real ?n * ln (real ?n) =\n  ln (k ?n) + 1\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "have *: \"(n + 1) * ln (n + 1) = (\\<Sum>i=1..n. ln(k i) + 1)\" for n::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n + 1) * ln (real (n + 1)) = (\\<Sum>i = 1..n. ln (k i) + 1)", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)\n 2. \\<And>n.\n       real (n + 1) * ln (real (n + 1)) =\n       (\\<Sum>i = 1..n. ln (k i) + 1) \\<Longrightarrow>\n       real (Suc n + 1) * ln (real (Suc n + 1)) =\n       (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "case (Suc n)"], ["proof (state)\nthis:\n  real (n + 1) * ln (real (n + 1)) = (\\<Sum>i = 1..n. ln (k i) + 1)\n\ngoal (2 subgoals):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)\n 2. \\<And>n.\n       real (n + 1) * ln (real (n + 1)) =\n       (\\<Sum>i = 1..n. ln (k i) + 1) \\<Longrightarrow>\n       real (Suc n + 1) * ln (real (Suc n + 1)) =\n       (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "have \"(\\<Sum>i = 1..n+1. ln (k i) + 1) = (\\<Sum>i = 1..n. ln (k i) + 1) + ln (k (n+1)) + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n + 1. ln (k i) + 1) =\n    (\\<Sum>i = 1..n. ln (k i) + 1) + ln (k (n + 1)) + 1", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n + 1. ln (k i) + 1) =\n  (\\<Sum>i = 1..n. ln (k i) + 1) + ln (k (n + 1)) + 1\n\ngoal (2 subgoals):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)\n 2. \\<And>n.\n       real (n + 1) * ln (real (n + 1)) =\n       (\\<Sum>i = 1..n. ln (k i) + 1) \\<Longrightarrow>\n       real (Suc n + 1) * ln (real (Suc n + 1)) =\n       (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n + 1. ln (k i) + 1) =\n  (\\<Sum>i = 1..n. ln (k i) + 1) + ln (k (n + 1)) + 1\n\ngoal (2 subgoals):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)\n 2. \\<And>n.\n       real (n + 1) * ln (real (n + 1)) =\n       (\\<Sum>i = 1..n. ln (k i) + 1) \\<Longrightarrow>\n       real (Suc n + 1) * ln (real (Suc n + 1)) =\n       (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "from Suc.IH"], ["proof (chain)\npicking this:\n  real (n + 1) * ln (real (n + 1)) = (\\<Sum>i = 1..n. ln (k i) + 1)", "have \"(\\<Sum>i = 1..n. ln (k i) + 1) = real (n+1) * ln (real (n+1))\""], ["proof (prove)\nusing this:\n  real (n + 1) * ln (real (n + 1)) = (\\<Sum>i = 1..n. ln (k i) + 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. ln (k i) + 1) = real (n + 1) * ln (real (n + 1))", ".."], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i) + 1) = real (n + 1) * ln (real (n + 1))\n\ngoal (2 subgoals):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)\n 2. \\<And>n.\n       real (n + 1) * ln (real (n + 1)) =\n       (\\<Sum>i = 1..n. ln (k i) + 1) \\<Longrightarrow>\n       real (Suc n + 1) * ln (real (Suc n + 1)) =\n       (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i) + 1) = real (n + 1) * ln (real (n + 1))\n\ngoal (2 subgoals):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)\n 2. \\<And>n.\n       real (n + 1) * ln (real (n + 1)) =\n       (\\<Sum>i = 1..n. ln (k i) + 1) \\<Longrightarrow>\n       real (Suc n + 1) * ln (real (Suc n + 1)) =\n       (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "from mvt[of \"n+1\"]"], ["proof (chain)\npicking this:\n  0 < n + 1 \\<Longrightarrow>\n  real (n + 1 + 1) * ln (real (n + 1 + 1)) -\n  real (n + 1) * ln (real (n + 1)) =\n  ln (k (n + 1)) + 1", "have \"\\<dots> = real (n+2) * ln (real (n+2)) - ln (k (n+1)) - 1\""], ["proof (prove)\nusing this:\n  0 < n + 1 \\<Longrightarrow>\n  real (n + 1 + 1) * ln (real (n + 1 + 1)) -\n  real (n + 1) * ln (real (n + 1)) =\n  ln (k (n + 1)) + 1\n\ngoal (1 subgoal):\n 1. real (n + 1) * ln (real (n + 1)) =\n    real (n + 2) * ln (real (n + 2)) - ln (k (n + 1)) - 1", "by simp"], ["proof (state)\nthis:\n  real (n + 1) * ln (real (n + 1)) =\n  real (n + 2) * ln (real (n + 2)) - ln (k (n + 1)) - 1\n\ngoal (2 subgoals):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)\n 2. \\<And>n.\n       real (n + 1) * ln (real (n + 1)) =\n       (\\<Sum>i = 1..n. ln (k i) + 1) \\<Longrightarrow>\n       real (Suc n + 1) * ln (real (Suc n + 1)) =\n       (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i = 1..n + 1. ln (k i) + 1) =\n  real (n + 2) * ln (real (n + 2)) - ln (k (n + 1)) - 1 + ln (k (n + 1)) + 1", "show ?case"], ["proof (prove)\nusing this:\n  (\\<Sum>i = 1..n + 1. ln (k i) + 1) =\n  real (n + 2) * ln (real (n + 2)) - ln (k (n + 1)) - 1 + ln (k (n + 1)) + 1\n\ngoal (1 subgoal):\n 1. real (Suc n + 1) * ln (real (Suc n + 1)) =\n    (\\<Sum>i = 1..Suc n. ln (k i) + 1)", "by simp"], ["proof (state)\nthis:\n  real (Suc n + 1) * ln (real (Suc n + 1)) =\n  (\\<Sum>i = 1..Suc n. ln (k i) + 1)\n\ngoal (1 subgoal):\n 1. real (0 + 1) * ln (real (0 + 1)) = (\\<Sum>i = 1..0. ln (k i) + 1)", "qed simp"], ["proof (state)\nthis:\n  real (?n + 1) * ln (real (?n + 1)) = (\\<Sum>i = 1..?n. ln (k i) + 1)\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "have **: \"abs((\\<Sum>i=1..n+1. ln i) - ((n+1) * ln (n+1) - (n+1))) \\<le> 1 + ln(n+1)\" for n::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "have \"(\\<Sum>i=1..n+1. ln i) \\<le> (\\<Sum>i=1..n. ln i) + ln (n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n + 1. ln (real i))\n    \\<le> (\\<Sum>i = 1..n. ln (real i)) + ln (real (n + 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> (\\<Sum>i = 1..n. ln (real i)) + ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> (\\<Sum>i = 1..n. ln (real i)) + ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "have \"(\\<Sum>i=1..n. ln i) \\<le> (\\<Sum>i=1..n. ln (k i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. ln (real i)) \\<le> (\\<Sum>i = 1..n. ln (k i))", "by (intro sum_mono, subst ln_le_cancel_iff) (auto simp: Suc_le_eq dest: lb ub)"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (real i)) \\<le> (\\<Sum>i = 1..n. ln (k i))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (real i)) \\<le> (\\<Sum>i = 1..n. ln (k i))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "have \"\\<dots> = (\\<Sum>i=1..n. ln (k i) + 1) - n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. ln (k i)) = (\\<Sum>i = 1..n. ln (k i) + 1) - real n", "by (simp add: sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i)) = (\\<Sum>i = 1..n. ln (k i) + 1) - real n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i)) = (\\<Sum>i = 1..n. ln (k i) + 1) - real n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "from *"], ["proof (chain)\npicking this:\n  real (?n + 1) * ln (real (?n + 1)) = (\\<Sum>i = 1..?n. ln (k i) + 1)", "have \"\\<dots> = (n+1) * ln (n+1) - n\""], ["proof (prove)\nusing this:\n  real (?n + 1) * ln (real (?n + 1)) = (\\<Sum>i = 1..?n. ln (k i) + 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. ln (k i) + 1) - real n =\n    real (n + 1) * ln (real (n + 1)) - real n", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i) + 1) - real n =\n  real (n + 1) * ln (real (n + 1)) - real n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x + ln (real (n + 1)) \\<le> y + ln (real (n + 1))) \\<Longrightarrow>\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> real (n + 1) * ln (real (n + 1)) - real n + ln (real (n + 1))", "have a_minus_b: \"(\\<Sum>i=1..n+1. ln i) - ((n+1) * ln (n+1) - (n+1)) \\<le> 1 + ln (n+1)\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x + ln (real (n + 1)) \\<le> y + ln (real (n + 1))) \\<Longrightarrow>\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> real (n + 1) * ln (real (n + 1)) - real n + ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n + 1. ln (real i)) -\n    (real (n + 1) * ln (real (n + 1)) - real (n + 1))\n    \\<le> 1 + ln (real (n + 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n + 1. ln (real i)) -\n  (real (n + 1) * ln (real (n + 1)) - real (n + 1))\n  \\<le> 1 + ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "from *"], ["proof (chain)\npicking this:\n  real (?n + 1) * ln (real (?n + 1)) = (\\<Sum>i = 1..?n. ln (k i) + 1)", "have \"(n+1) * ln (n+1) - n = (\\<Sum>i=1..n. ln (k i) + 1) - n\""], ["proof (prove)\nusing this:\n  real (?n + 1) * ln (real (?n + 1)) = (\\<Sum>i = 1..?n. ln (k i) + 1)\n\ngoal (1 subgoal):\n 1. real (n + 1) * ln (real (n + 1)) - real n =\n    (\\<Sum>i = 1..n. ln (k i) + 1) - real n", "by simp"], ["proof (state)\nthis:\n  real (n + 1) * ln (real (n + 1)) - real n =\n  (\\<Sum>i = 1..n. ln (k i) + 1) - real n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "also"], ["proof (state)\nthis:\n  real (n + 1) * ln (real (n + 1)) - real n =\n  (\\<Sum>i = 1..n. ln (k i) + 1) - real n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "have \"\\<dots> = (\\<Sum>i=1..n. ln (k i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. ln (k i) + 1) - real n = (\\<Sum>i = 1..n. ln (k i))", "by (simp add: sum.distrib)"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i) + 1) - real n = (\\<Sum>i = 1..n. ln (k i))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i) + 1) - real n = (\\<Sum>i = 1..n. ln (k i))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "have \"\\<dots> \\<le> (\\<Sum>i=1..n. ln (i+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. ln (k i)) \\<le> (\\<Sum>i = 1..n. ln (real (i + 1)))", "by (intro sum_mono, subst ln_le_cancel_iff) (auto simp: Suc_le_eq dest: lb ub)"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i)) \\<le> (\\<Sum>i = 1..n. ln (real (i + 1)))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (k i)) \\<le> (\\<Sum>i = 1..n. ln (real (i + 1)))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "from sum.shift_bounds_cl_nat_ivl[of \"ln\" 1 1 n]"], ["proof (chain)\npicking this:\n  (\\<Sum>x = 1 + 1..n + 1. ln (real x)) =\n  (\\<Sum>i = 1..n. ln (real (i + 1)))", "have \"\\<dots> = (\\<Sum>i=1+1..n+1. ln i)\""], ["proof (prove)\nusing this:\n  (\\<Sum>x = 1 + 1..n + 1. ln (real x)) =\n  (\\<Sum>i = 1..n. ln (real (i + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. ln (real (i + 1))) =\n    (\\<Sum>i = 1 + 1..n + 1. ln (real i))", ".."], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (real (i + 1))) =\n  (\\<Sum>i = 1 + 1..n + 1. ln (real i))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. ln (real (i + 1))) =\n  (\\<Sum>i = 1 + 1..n + 1. ln (real i))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "have \"\\<dots> = (\\<Sum>i=1..n+1. ln i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1 + 1..n + 1. ln (real i)) =\n    (\\<Sum>i = 1..n + 1. ln (real i))", "by (rule sum.mono_neutral_left) auto"], ["proof (state)\nthis:\n  (\\<Sum>i = 1 + 1..n + 1. ln (real i)) = (\\<Sum>i = 1..n + 1. ln (real i))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "finally"], ["proof (chain)\npicking this:\n  real (n + 1) * ln (real (n + 1)) - real n\n  \\<le> (\\<Sum>i = 1..n + 1. ln (real i))", "have b_minus_a: \"((n+1) * ln (n+1) - (n+1)) - (\\<Sum>i=1..n+1. ln i) \\<le> 1\""], ["proof (prove)\nusing this:\n  real (n + 1) * ln (real (n + 1)) - real n\n  \\<le> (\\<Sum>i = 1..n + 1. ln (real i))\n\ngoal (1 subgoal):\n 1. real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n    (\\<Sum>i = 1..n + 1. ln (real i))\n    \\<le> 1", "by simp"], ["proof (state)\nthis:\n  real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "have \"0 \\<le> ln (n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> ln (real (n + 1))", "by simp"], ["proof (state)\nthis:\n  0 \\<le> ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "with b_minus_a"], ["proof (chain)\npicking this:\n  real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> 1\n  0 \\<le> ln (real (n + 1))", "have \"((n+1) * ln (n+1) - (n+1)) - (\\<Sum>i=1..n+1. ln i) \\<le> 1 + ln (n+1)\""], ["proof (prove)\nusing this:\n  real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> 1\n  0 \\<le> ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n    (\\<Sum>i = 1..n + 1. ln (real i))\n    \\<le> 1 + ln (real (n + 1))", "by linarith"], ["proof (state)\nthis:\n  real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> 1 + ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "with a_minus_b"], ["proof (chain)\npicking this:\n  (\\<Sum>i = 1..n + 1. ln (real i)) -\n  (real (n + 1) * ln (real (n + 1)) - real (n + 1))\n  \\<le> 1 + ln (real (n + 1))\n  real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> 1 + ln (real (n + 1))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>i = 1..n + 1. ln (real i)) -\n  (real (n + 1) * ln (real (n + 1)) - real (n + 1))\n  \\<le> 1 + ln (real (n + 1))\n  real (n + 1) * ln (real (n + 1)) - real (n + 1) -\n  (\\<Sum>i = 1..n + 1. ln (real i))\n  \\<le> 1 + ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n          (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n    \\<le> 1 + ln (real (n + 1))", "by linarith"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n        (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n  \\<le> 1 + ln (real (n + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>i = 1..?n + 1. ln (real i)) -\n        (real (?n + 1) * ln (real (?n + 1)) - real (?n + 1))\\<bar>\n  \\<le> 1 + ln (real (?n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "from \\<open>n > 0\\<close>"], ["proof (chain)\npicking this:\n  0 < n", "have \"n \\<ge> 1\""], ["proof (prove)\nusing this:\n  0 < n\n\ngoal (1 subgoal):\n 1. 1 \\<le> n", "by simp"], ["proof (state)\nthis:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "thus ?thesis"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n    \\<le> 1 + ln (real n)", "proof (induction n rule: dec_induct)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<bar>ln (fact 1) - real 1 * ln (real 1) + real 1\\<bar>\n    \\<le> 1 + ln (real 1)\n 2. \\<And>na.\n       \\<lbrakk>1 \\<le> na; na < n;\n        \\<bar>ln (fact na) - real na * ln (real na) + real na\\<bar>\n        \\<le> 1 + ln (real na)\\<rbrakk>\n       \\<Longrightarrow> \\<bar>ln (fact (Suc na)) -\n                               real (Suc na) * ln (real (Suc na)) +\n                               real (Suc na)\\<bar>\n                         \\<le> 1 + ln (real (Suc na))", "case base"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. \\<bar>ln (fact 1) - real 1 * ln (real 1) + real 1\\<bar>\n    \\<le> 1 + ln (real 1)\n 2. \\<And>na.\n       \\<lbrakk>1 \\<le> na; na < n;\n        \\<bar>ln (fact na) - real na * ln (real na) + real na\\<bar>\n        \\<le> 1 + ln (real na)\\<rbrakk>\n       \\<Longrightarrow> \\<bar>ln (fact (Suc na)) -\n                               real (Suc na) * ln (real (Suc na)) +\n                               real (Suc na)\\<bar>\n                         \\<le> 1 + ln (real (Suc na))", "then"], ["proof (chain)\npicking this:", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>ln (fact 1) - real 1 * ln (real 1) + real 1\\<bar>\n    \\<le> 1 + ln (real 1)", "by simp"], ["proof (state)\nthis:\n  \\<bar>ln (fact 1) - real 1 * ln (real 1) + real 1\\<bar>\n  \\<le> 1 + ln (real 1)\n\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>1 \\<le> na; na < n;\n        \\<bar>ln (fact na) - real na * ln (real na) + real na\\<bar>\n        \\<le> 1 + ln (real na)\\<rbrakk>\n       \\<Longrightarrow> \\<bar>ln (fact (Suc na)) -\n                               real (Suc na) * ln (real (Suc na)) +\n                               real (Suc na)\\<bar>\n                         \\<le> 1 + ln (real (Suc na))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>1 \\<le> na; na < n;\n        \\<bar>ln (fact na) - real na * ln (real na) + real na\\<bar>\n        \\<le> 1 + ln (real na)\\<rbrakk>\n       \\<Longrightarrow> \\<bar>ln (fact (Suc na)) -\n                               real (Suc na) * ln (real (Suc na)) +\n                               real (Suc na)\\<bar>\n                         \\<le> 1 + ln (real (Suc na))", "case (step n)"], ["proof (state)\nthis:\n  1 \\<le> n\n  n < n\n  \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n  \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>1 \\<le> na; na < n;\n        \\<bar>ln (fact na) - real na * ln (real na) + real na\\<bar>\n        \\<le> 1 + ln (real na)\\<rbrakk>\n       \\<Longrightarrow> \\<bar>ln (fact (Suc na)) -\n                               real (Suc na) * ln (real (Suc na)) +\n                               real (Suc na)\\<bar>\n                         \\<le> 1 + ln (real (Suc na))", "from ln_fact[of \"n+1\"] **[of n]"], ["proof (chain)\npicking this:\n  ln (fact (n + 1)) = (\\<Sum>d = 1..n + 1. ln (real d))\n  \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n        (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n  \\<le> 1 + ln (real (n + 1))", "show ?case"], ["proof (prove)\nusing this:\n  ln (fact (n + 1)) = (\\<Sum>d = 1..n + 1. ln (real d))\n  \\<bar>(\\<Sum>i = 1..n + 1. ln (real i)) -\n        (real (n + 1) * ln (real (n + 1)) - real (n + 1))\\<bar>\n  \\<le> 1 + ln (real (n + 1))\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact (Suc n)) - real (Suc n) * ln (real (Suc n)) +\n          real (Suc n)\\<bar>\n    \\<le> 1 + ln (real (Suc n))", "by simp"], ["proof (state)\nthis:\n  \\<bar>ln (fact (Suc n)) - real (Suc n) * ln (real (Suc n)) +\n        real (Suc n)\\<bar>\n  \\<le> 1 + ln (real (Suc n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n  \\<le> 1 + ln (real n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ln_fact_diff_bounds:\n  \"abs(ln (fact n) - 2 * ln (fact (n div 2)) - n * ln 2) \\<le> 4 * ln (if n = 0 then 1 else n) + 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "proof (cases \"n div 2 = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. n div 2 = 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n 2. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "case True"], ["proof (state)\nthis:\n  n div 2 = 0\n\ngoal (2 subgoals):\n 1. n div 2 = 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n 2. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "hence \"n \\<le> 1\""], ["proof (prove)\nusing this:\n  n div 2 = 0\n\ngoal (1 subgoal):\n 1. n \\<le> 1", "by simp"], ["proof (state)\nthis:\n  n \\<le> 1\n\ngoal (2 subgoals):\n 1. n div 2 = 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n 2. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "with ln_le_minus_one[of \"2::real\"]"], ["proof (chain)\npicking this:\n  0 < 2 \\<Longrightarrow> ln 2 \\<le> 2 - 1\n  n \\<le> 1", "show ?thesis"], ["proof (prove)\nusing this:\n  0 < 2 \\<Longrightarrow> ln 2 \\<le> 2 - 1\n  n \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "by (cases n) simp_all"], ["proof (state)\nthis:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "case False"], ["proof (state)\nthis:\n  n div 2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "then"], ["proof (chain)\npicking this:\n  n div 2 \\<noteq> 0", "have \"n > 1\""], ["proof (prove)\nusing this:\n  n div 2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 1 < n", "by simp"], ["proof (state)\nthis:\n  1 < n\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?a = \"real n * ln 2\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?b = \"4 * ln (real n) + 3\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?l1 = \"ln (fact (n div 2))\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?a1 = \"real (n div 2) * ln (real (n div 2)) - real (n div 2)\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?b1 = \"1 + ln (real (n div 2))\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?l2 = \"ln (fact n)\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?a2 = \"real n * ln (real n) - real n\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "let ?b2 = \"1 + ln (real n)\""], ["proof (state)\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "have abs_a: \"abs(?a - (?a2 - 2 * ?a1)) \\<le> ?b - 2 * ?b1 - ?b2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "proof (cases \"even n\")"], ["proof (state)\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "case True"], ["proof (state)\nthis:\n  even n\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "then"], ["proof (chain)\npicking this:\n  even n", "have \"real (2 * (n div 2)) = real n\""], ["proof (prove)\nusing this:\n  even n\n\ngoal (1 subgoal):\n 1. real (2 * (n div 2)) = real n", "by simp"], ["proof (state)\nthis:\n  real (2 * (n div 2)) = real n\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "then"], ["proof (chain)\npicking this:\n  real (2 * (n div 2)) = real n", "have n_div_2: \"real (n div 2) = real n / 2\""], ["proof (prove)\nusing this:\n  real (2 * (n div 2)) = real n\n\ngoal (1 subgoal):\n 1. real (n div 2) = real n / 2", "by simp"], ["proof (state)\nthis:\n  real (n div 2) = real n / 2\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  1 < n", "have *: \"abs(?a - (?a2 - 2 * ?a1)) = 0\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar> =\n    0", "by (simp add: n_div_2 ln_div algebra_simps)"], ["proof (state)\nthis:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 *\n         (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar> =\n  0\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>even n\\<close> and \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  even n\n  1 < n", "have \"0 \\<le> ln (real n) - ln (real (n div 2))\""], ["proof (prove)\nusing this:\n  even n\n  1 < n\n\ngoal (1 subgoal):\n 1. 0 \\<le> ln (real n) - ln (real (n div 2))", "by (auto elim: evenE)"], ["proof (state)\nthis:\n  0 \\<le> ln (real n) - ln (real (n div 2))\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  0 \\<le> ln (real n) - ln (real (n div 2))\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"2 * \\<dots> \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * (ln (real n) - ln (real (n div 2)))\n    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "using \\<open>n > 1\\<close>"], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. 2 * (ln (real n) - ln (real (n div 2)))\n    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "by (auto intro!: ln_ge_zero)"], ["proof (state)\nthis:\n  2 * (ln (real n) - ln (real (n div 2)))\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  2 * (ln (real n) - ln (real (n div 2)))\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"\\<dots> = ?b - 2 * ?b1 - ?b2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 3 * ln (real n) - 2 * ln (real (n div 2)) =\n    4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) - (1 + ln (real n))", "by simp"], ["proof (state)\nthis:\n  3 * ln (real n) - 2 * ln (real (n div 2)) =\n  4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) - (1 + ln (real n))\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))\n 2. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> 2 * x \\<le> 2 * y) \\<Longrightarrow>\n  2 * 0\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> 2 * x \\<le> 2 * y) \\<Longrightarrow>\n  2 * 0\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))\n\ngoal (1 subgoal):\n 1. \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "using *"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> 2 * x \\<le> 2 * y) \\<Longrightarrow>\n  2 * 0\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 *\n         (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar> =\n  0\n\ngoal (1 subgoal):\n 1. \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "by simp"], ["proof (state)\nthis:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "case False"], ["proof (state)\nthis:\n  odd n\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "then"], ["proof (chain)\npicking this:\n  odd n", "have \"real (2 * (n div 2)) = real (n - 1)\""], ["proof (prove)\nusing this:\n  odd n\n\ngoal (1 subgoal):\n 1. real (2 * (n div 2)) = real (n - 1)", "by simp"], ["proof (state)\nthis:\n  real (2 * (n div 2)) = real (n - 1)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "with \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  1 < n\n  real (2 * (n div 2)) = real (n - 1)", "have n_div_2: \"real (n div 2) = (real n - 1) / 2\""], ["proof (prove)\nusing this:\n  1 < n\n  real (2 * (n div 2)) = real (n - 1)\n\ngoal (1 subgoal):\n 1. real (n div 2) = (real n - 1) / 2", "by simp"], ["proof (state)\nthis:\n  real (n div 2) = (real n - 1) / 2\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>odd n\\<close> \\<open>n div 2 \\<noteq> 0\\<close>"], ["proof (chain)\npicking this:\n  odd n\n  n div 2 \\<noteq> 0", "have \"n \\<ge> 3\""], ["proof (prove)\nusing this:\n  odd n\n  n div 2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 3 \\<le> n", "by presburger"], ["proof (state)\nthis:\n  3 \\<le> n\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"?a - (?a2 - 2 * ?a1) = real n * ln 2 - real n * ln (real n) + real n + \n             2 * real (n div 2) * ln (real (n div 2)) - 2* real (n div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * ln 2 -\n    (real n * ln (real n) - real n -\n     2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))) =\n    real n * ln 2 - real n * ln (real n) + real n +\n    2 * real (n div 2) * ln (real (n div 2)) -\n    2 * real (n div 2)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  real n * ln 2 -\n  (real n * ln (real n) - real n -\n   2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))) =\n  real n * ln 2 - real n * ln (real n) + real n +\n  2 * real (n div 2) * ln (real (n div 2)) -\n  2 * real (n div 2)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  real n * ln 2 -\n  (real n * ln (real n) - real n -\n   2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))) =\n  real n * ln 2 - real n * ln (real n) + real n +\n  2 * real (n div 2) * ln (real (n div 2)) -\n  2 * real (n div 2)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from n_div_2"], ["proof (chain)\npicking this:\n  real (n div 2) = (real n - 1) / 2", "have \"2 * real (n div 2) = real n - 1\""], ["proof (prove)\nusing this:\n  real (n div 2) = (real n - 1) / 2\n\ngoal (1 subgoal):\n 1. 2 * real (n div 2) = real n - 1", "by simp"], ["proof (state)\nthis:\n  2 * real (n div 2) = real n - 1\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  2 * real (n div 2) = real n - 1\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"real n * ln 2 - real n * ln (real n) + real n + \n                   (real n - 1) * ln (real (n div 2)) - (real n - 1)\n                 = real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * ln 2 - real n * ln (real n) + real n +\n    (real n - 1) * ln (real (n div 2)) -\n    (real n - 1) =\n    real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1", "using \\<open>n > 1\\<close>"], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. real n * ln 2 - real n * ln (real n) + real n +\n    (real n - 1) * ln (real (n div 2)) -\n    (real n - 1) =\n    real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1", "by (simp add: algebra_simps n_div_2 ln_div)"], ["proof (state)\nthis:\n  real n * ln 2 - real n * ln (real n) + real n +\n  (real n - 1) * ln (real (n div 2)) -\n  (real n - 1) =\n  real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "finally"], ["proof (chain)\npicking this:\n  real n * ln 2 -\n  (real n * ln (real n) - real n -\n   2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))) =\n  real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1", "have lhs: \"abs(?a - (?a2 - 2 * ?a1)) = \n        abs(real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1)\""], ["proof (prove)\nusing this:\n  real n * ln 2 -\n  (real n * ln (real n) - real n -\n   2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))) =\n  real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1\n\ngoal (1 subgoal):\n 1. \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar> =\n    \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n          1\\<bar>", "by simp"], ["proof (state)\nthis:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 *\n         (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar> =\n  \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n        1\\<bar>\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  1 < n", "have \"real n * (ln (real n - 1) - ln (real n)) \\<le> 0\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. real n * (ln (real n - 1) - ln (real n)) \\<le> 0", "by (simp add: algebra_simps mult_left_mono)"], ["proof (state)\nthis:\n  real n * (ln (real n - 1) - ln (real n)) \\<le> 0\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "moreover"], ["proof (state)\nthis:\n  real n * (ln (real n - 1) - ln (real n)) \\<le> 0\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  1 < n", "have \"ln (real (n div 2)) \\<le> ln (real n)\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. ln (real (n div 2)) \\<le> ln (real n)", "by simp"], ["proof (state)\nthis:\n  ln (real (n div 2)) \\<le> ln (real n)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "moreover"], ["proof (state)\nthis:\n  ln (real (n div 2)) \\<le> ln (real n)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "{"], ["proof (state)\nthis:\n  ln (real (n div 2)) \\<le> ln (real n)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"exp 1 \\<le> (3::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. exp 1 \\<le> 3", "by (rule exp_le)"], ["proof (state)\nthis:\n  exp 1 \\<le> 3\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  exp 1 \\<le> 3\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>n \\<ge> 3\\<close>"], ["proof (chain)\npicking this:\n  3 \\<le> n", "have \"\\<dots> \\<le> exp (ln (real n))\""], ["proof (prove)\nusing this:\n  3 \\<le> n\n\ngoal (1 subgoal):\n 1. 3 \\<le> exp (ln (real n))", "by simp"], ["proof (state)\nthis:\n  3 \\<le> exp (ln (real n))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "finally"], ["proof (chain)\npicking this:\n  exp 1 \\<le> exp (ln (real n))", "have \"ln (real n) \\<ge> 1\""], ["proof (prove)\nusing this:\n  exp 1 \\<le> exp (ln (real n))\n\ngoal (1 subgoal):\n 1. 1 \\<le> ln (real n)", "by simp"], ["proof (state)\nthis:\n  1 \\<le> ln (real n)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "}"], ["proof (state)\nthis:\n  1 \\<le> ln (real n)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "ultimately"], ["proof (chain)\npicking this:\n  real n * (ln (real n - 1) - ln (real n)) \\<le> 0\n  ln (real (n div 2)) \\<le> ln (real n)\n  1 \\<le> ln (real n)", "have ub: \"real n * (ln (real n - 1) - ln (real n)) - ln(real (n div 2)) + 1 \\<le> \n                           3 * ln (real n) - 2 * ln(real (n div 2))\""], ["proof (prove)\nusing this:\n  real n * (ln (real n - 1) - ln (real n)) \\<le> 0\n  ln (real (n div 2)) \\<le> ln (real n)\n  1 \\<le> ln (real n)\n\ngoal (1 subgoal):\n 1. real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1\n    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "by simp"], ["proof (state)\nthis:\n  real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have mon: \"real n' * (ln (real n') - ln (real n' - 1)) \\<le> \n                 real n * (ln (real n) - ln (real n - 1))\" \n      if \"n \\<ge> 3\" \"n' \\<ge> n\" for n n'::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. real n' * (ln (real n') - ln (real n' - 1))\n    \\<le> real n * (ln (real n) - ln (real n - 1))", "proof (rule DERIV_nonpos_imp_nonincreasing[where f = \"\\<lambda>x. x * (ln x - ln (x - 1))\"])"], ["proof (state)\ngoal (2 subgoals):\n 1. real n \\<le> real n'\n 2. \\<And>x.\n       \\<lbrakk>real n \\<le> x; x \\<le> real n'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            ((\\<lambda>x.\n                                 x *\n                                 (ln x - ln (x - 1))) has_real_derivative\n                             y)\n                             (at x) \\<and>\n                            y \\<le> 0", "fix t"], ["proof (state)\ngoal (2 subgoals):\n 1. real n \\<le> real n'\n 2. \\<And>x.\n       \\<lbrakk>real n \\<le> x; x \\<le> real n'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            ((\\<lambda>x.\n                                 x *\n                                 (ln x - ln (x - 1))) has_real_derivative\n                             y)\n                             (at x) \\<and>\n                            y \\<le> 0", "assume t: \"real n \\<le> t\" \"t \\<le> real n'\""], ["proof (state)\nthis:\n  real n \\<le> t\n  t \\<le> real n'\n\ngoal (2 subgoals):\n 1. real n \\<le> real n'\n 2. \\<And>x.\n       \\<lbrakk>real n \\<le> x; x \\<le> real n'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            ((\\<lambda>x.\n                                 x *\n                                 (ln x - ln (x - 1))) has_real_derivative\n                             y)\n                             (at x) \\<and>\n                            y \\<le> 0", "with that"], ["proof (chain)\npicking this:\n  3 \\<le> n\n  n \\<le> n'\n  real n \\<le> t\n  t \\<le> real n'", "have \"1 / (t - 1) \\<ge> ln (1 + 1/(t - 1))\""], ["proof (prove)\nusing this:\n  3 \\<le> n\n  n \\<le> n'\n  real n \\<le> t\n  t \\<le> real n'\n\ngoal (1 subgoal):\n 1. ln (1 + 1 / (t - 1)) \\<le> 1 / (t - 1)", "by (intro ln_add_one_self_le_self) simp_all"], ["proof (state)\nthis:\n  ln (1 + 1 / (t - 1)) \\<le> 1 / (t - 1)\n\ngoal (2 subgoals):\n 1. real n \\<le> real n'\n 2. \\<And>x.\n       \\<lbrakk>real n \\<le> x; x \\<le> real n'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            ((\\<lambda>x.\n                                 x *\n                                 (ln x - ln (x - 1))) has_real_derivative\n                             y)\n                             (at x) \\<and>\n                            y \\<le> 0", "also"], ["proof (state)\nthis:\n  ln (1 + 1 / (t - 1)) \\<le> 1 / (t - 1)\n\ngoal (2 subgoals):\n 1. real n \\<le> real n'\n 2. \\<And>x.\n       \\<lbrakk>real n \\<le> x; x \\<le> real n'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            ((\\<lambda>x.\n                                 x *\n                                 (ln x - ln (x - 1))) has_real_derivative\n                             y)\n                             (at x) \\<and>\n                            y \\<le> 0", "from t that"], ["proof (chain)\npicking this:\n  real n \\<le> t\n  t \\<le> real n'\n  3 \\<le> n\n  n \\<le> n'", "have \"ln (1 + 1/(t - 1)) = ln t- ln (t - 1)\""], ["proof (prove)\nusing this:\n  real n \\<le> t\n  t \\<le> real n'\n  3 \\<le> n\n  n \\<le> n'\n\ngoal (1 subgoal):\n 1. ln (1 + 1 / (t - 1)) = ln t - ln (t - 1)", "by (simp add: ln_div [symmetric] field_simps)"], ["proof (state)\nthis:\n  ln (1 + 1 / (t - 1)) = ln t - ln (t - 1)\n\ngoal (2 subgoals):\n 1. real n \\<le> real n'\n 2. \\<And>x.\n       \\<lbrakk>real n \\<le> x; x \\<le> real n'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            ((\\<lambda>x.\n                                 x *\n                                 (ln x - ln (x - 1))) has_real_derivative\n                             y)\n                             (at x) \\<and>\n                            y \\<le> 0", "finally"], ["proof (chain)\npicking this:\n  ln t - ln (t - 1) \\<le> 1 / (t - 1)", "have \"ln t - ln (t - 1) \\<le> 1 / (t - 1)\""], ["proof (prove)\nusing this:\n  ln t - ln (t - 1) \\<le> 1 / (t - 1)\n\ngoal (1 subgoal):\n 1. ln t - ln (t - 1) \\<le> 1 / (t - 1)", "."], ["proof (state)\nthis:\n  ln t - ln (t - 1) \\<le> 1 / (t - 1)\n\ngoal (2 subgoals):\n 1. real n \\<le> real n'\n 2. \\<And>x.\n       \\<lbrakk>real n \\<le> x; x \\<le> real n'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            ((\\<lambda>x.\n                                 x *\n                                 (ln x - ln (x - 1))) has_real_derivative\n                             y)\n                             (at x) \\<and>\n                            y \\<le> 0", "with that t"], ["proof (chain)\npicking this:\n  3 \\<le> n\n  n \\<le> n'\n  real n \\<le> t\n  t \\<le> real n'\n  ln t - ln (t - 1) \\<le> 1 / (t - 1)", "show \"\\<exists>y. ((\\<lambda>x. x * (ln x - ln (x - 1))) has_field_derivative y) (at t) \\<and> y \\<le> 0\""], ["proof (prove)\nusing this:\n  3 \\<le> n\n  n \\<le> n'\n  real n \\<le> t\n  t \\<le> real n'\n  ln t - ln (t - 1) \\<le> 1 / (t - 1)\n\ngoal (1 subgoal):\n 1. \\<exists>y.\n       ((\\<lambda>x. x * (ln x - ln (x - 1))) has_real_derivative y)\n        (at t) \\<and>\n       y \\<le> 0", "by (intro exI[of _ \"1 / (1 - t) + ln t - ln (t - 1)\"])\n          (force intro!: derivative_eq_intros simp: field_simps)+"], ["proof (state)\nthis:\n  \\<exists>y.\n     ((\\<lambda>x. x * (ln x - ln (x - 1))) has_real_derivative y)\n      (at t) \\<and>\n     y \\<le> 0\n\ngoal (1 subgoal):\n 1. real n \\<le> real n'", "qed (use that in simp_all)"], ["proof (state)\nthis:\n  \\<lbrakk>3 \\<le> ?n2; ?n2 \\<le> ?n'2\\<rbrakk>\n  \\<Longrightarrow> real ?n'2 * (ln (real ?n'2) - ln (real ?n'2 - 1))\n                    \\<le> real ?n2 * (ln (real ?n2) - ln (real ?n2 - 1))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  1 < n", "have \"ln 2 = ln (real n) - ln (real n / 2)\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. ln 2 = ln (real n) - ln (real n / 2)", "by (simp add: ln_div)"], ["proof (state)\nthis:\n  ln 2 = ln (real n) - ln (real n / 2)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  ln 2 = ln (real n) - ln (real n / 2)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  1 < n", "have \"\\<dots> \\<le> ln (real n) - ln (real (n div 2))\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. ln (real n) - ln (real n / 2) \\<le> ln (real n) - ln (real (n div 2))", "by simp"], ["proof (state)\nthis:\n  ln (real n) - ln (real n / 2) \\<le> ln (real n) - ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "finally"], ["proof (chain)\npicking this:\n  ln 2 \\<le> ln (real n) - ln (real (n div 2))", "have *: \"3*ln 2 + ln(real (n div 2)) \\<le> 3* ln(real n) - 2* ln(real (n div 2))\""], ["proof (prove)\nusing this:\n  ln 2 \\<le> ln (real n) - ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. 3 * ln 2 + ln (real (n div 2))\n    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "by simp"], ["proof (state)\nthis:\n  3 * ln 2 + ln (real (n div 2))\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"- real n * (ln (real n - 1) - ln (real n)) + ln(real (n div 2)) - 1 = \n            real n * (ln (real n) - ln (real n - 1)) - 1 + ln(real (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - real n * (ln (real n - 1) - ln (real n)) + ln (real (n div 2)) - 1 =\n    real n * (ln (real n) - ln (real n - 1)) - 1 + ln (real (n div 2))", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  - real n * (ln (real n - 1) - ln (real n)) + ln (real (n div 2)) - 1 =\n  real n * (ln (real n) - ln (real n - 1)) - 1 + ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  - real n * (ln (real n - 1) - ln (real n)) + ln (real (n div 2)) - 1 =\n  real n * (ln (real n) - ln (real n - 1)) - 1 + ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"real n * (ln (real n) - ln (real n - 1)) \\<le> 3 * (ln 3 - ln (3 - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * (ln (real n) - ln (real n - 1)) \\<le> 3 * (ln 3 - ln (3 - 1))", "using mon[OF _ \\<open>n \\<ge> 3\\<close>]"], ["proof (prove)\nusing this:\n  3 \\<le> 3 \\<Longrightarrow>\n  real n * (ln (real n) - ln (real n - 1))\n  \\<le> real 3 * (ln (real 3) - ln (real 3 - 1))\n\ngoal (1 subgoal):\n 1. real n * (ln (real n) - ln (real n - 1)) \\<le> 3 * (ln 3 - ln (3 - 1))", "by simp"], ["proof (state)\nthis:\n  real n * (ln (real n) - ln (real n - 1)) \\<le> 3 * (ln 3 - ln (3 - 1))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  real n * (ln (real n) - ln (real n - 1)) \\<le> 3 * (ln 3 - ln (3 - 1))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "{"], ["proof (state)\nthis:\n  real n * (ln (real n) - ln (real n - 1)) \\<le> 3 * (ln 3 - ln (3 - 1))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"Some (Float 3 (-1)) = ub_ln 1 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Some (Float 3 (- 1)) = ub_ln 1 3", "by code_simp"], ["proof (state)\nthis:\n  Some (Float 3 (- 1)) = ub_ln 1 3\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from ub_ln(1)[OF this]"], ["proof (chain)\npicking this:\n  ln (real_of_float 3) \\<le> real_of_float (Float 3 (- 1))", "have \"ln 3 \\<le> (1.6 :: real)\""], ["proof (prove)\nusing this:\n  ln (real_of_float 3) \\<le> real_of_float (Float 3 (- 1))\n\ngoal (1 subgoal):\n 1. ln 3 \\<le> 16 / 10", "by simp"], ["proof (state)\nthis:\n  ln 3 \\<le> 16 / 10\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  ln 3 \\<le> 16 / 10\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"1.6 - 1 / 3 \\<le> 2 * (2/3 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 16 / 10 - 1 / 3 \\<le> 2 * (2 / 3)", "by simp"], ["proof (state)\nthis:\n  16 / 10 - 1 / 3 \\<le> 2 * (2 / 3)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  16 / 10 - 1 / 3 \\<le> 2 * (2 / 3)\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have \"2/3 \\<le> ln (2 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / 3 \\<le> ln 2", "by (rule ln_2_ge')"], ["proof (state)\nthis:\n  2 / 3 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y. x \\<le> y \\<Longrightarrow> x - 1 / 3 \\<le> y - 1 / 3;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 2 * x \\<le> 2 * y\\<rbrakk>\n  \\<Longrightarrow> ln 3 - 1 / 3 \\<le> 2 * ln 2", "have \"ln 3 - 1 / 3 \\<le> 2 * ln (2 :: real)\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y. x \\<le> y \\<Longrightarrow> x - 1 / 3 \\<le> y - 1 / 3;\n   \\<And>x y. x \\<le> y \\<Longrightarrow> 2 * x \\<le> 2 * y\\<rbrakk>\n  \\<Longrightarrow> ln 3 - 1 / 3 \\<le> 2 * ln 2\n\ngoal (1 subgoal):\n 1. ln 3 - 1 / 3 \\<le> 2 * ln 2", "by simp"], ["proof (state)\nthis:\n  ln 3 - 1 / 3 \\<le> 2 * ln 2\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "}"], ["proof (state)\nthis:\n  ln 3 - 1 / 3 \\<le> 2 * ln 2\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "hence \"3 * (ln 3 - ln (3 - 1)) - 1 \\<le> 3 * ln (2 :: real)\""], ["proof (prove)\nusing this:\n  ln 3 - 1 / 3 \\<le> 2 * ln 2\n\ngoal (1 subgoal):\n 1. 3 * (ln 3 - ln (3 - 1)) - 1 \\<le> 3 * ln 2", "by simp"], ["proof (state)\nthis:\n  3 * (ln 3 - ln (3 - 1)) - 1 \\<le> 3 * ln 2\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  3 * (ln 3 - ln (3 - 1)) - 1 \\<le> 3 * ln 2\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "note *"], ["proof (state)\nthis:\n  3 * ln 2 + ln (real (n div 2))\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              x - 1 + ln (real (n div 2)) \\<le> y - 1 + ln (real (n div 2));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x + ln (real (n div 2)) \\<le> y + ln (real (n div 2))\\<rbrakk>\n  \\<Longrightarrow> - real n * (ln (real n - 1) - ln (real n)) +\n                    ln (real (n div 2)) -\n                    1\n                    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "have \"- real n * (ln (real n - 1) - ln (real n)) + ln(real (n div 2)) - 1 \\<le> \n                    3 * ln (real n) - 2 * ln (real (n div 2))\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              x - 1 + ln (real (n div 2)) \\<le> y - 1 + ln (real (n div 2));\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x + ln (real (n div 2)) \\<le> y + ln (real (n div 2))\\<rbrakk>\n  \\<Longrightarrow> - real n * (ln (real n - 1) - ln (real n)) +\n                    ln (real (n div 2)) -\n                    1\n                    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. - real n * (ln (real n - 1) - ln (real n)) + ln (real (n div 2)) - 1\n    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "by simp"], ["proof (state)\nthis:\n  - real n * (ln (real n - 1) - ln (real n)) + ln (real (n div 2)) - 1\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "hence lhs': \"abs(real n * (ln (real n - 1) - ln (real n)) - ln(real (n div 2)) + 1) \\<le> \n                   3 * ln (real n) - 2 * ln (real (n div 2))\""], ["proof (prove)\nusing this:\n  - real n * (ln (real n - 1) - ln (real n)) + ln (real (n div 2)) - 1\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n          1\\<bar>\n    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "using ub"], ["proof (prove)\nusing this:\n  - real n * (ln (real n - 1) - ln (real n)) + ln (real (n div 2)) - 1\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n  real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) + 1\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n          1\\<bar>\n    \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "by simp"], ["proof (state)\nthis:\n  \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n        1\\<bar>\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "have rhs: \"?b - 2 * ?b1 - ?b2 = 3* ln (real n) - 2 * ln (real (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n    (1 + ln (real n)) =\n    3 * ln (real n) - 2 * ln (real (n div 2))", "by simp"], ["proof (state)\nthis:\n  4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) - (1 + ln (real n)) =\n  3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "from \\<open>n > 1\\<close>"], ["proof (chain)\npicking this:\n  1 < n", "have \"ln (real (n div 2)) \\<le> 3* ln (real n) - 2* ln (real (n div 2))\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. ln (real (n div 2)) \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "by simp"], ["proof (state)\nthis:\n  ln (real (n div 2)) \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "with rhs lhs lhs'"], ["proof (chain)\npicking this:\n  4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) - (1 + ln (real n)) =\n  3 * ln (real n) - 2 * ln (real (n div 2))\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 *\n         (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar> =\n  \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n        1\\<bar>\n  \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n        1\\<bar>\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n  ln (real (n div 2)) \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))", "show ?thesis"], ["proof (prove)\nusing this:\n  4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) - (1 + ln (real n)) =\n  3 * ln (real n) - 2 * ln (real (n div 2))\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 *\n         (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar> =\n  \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n        1\\<bar>\n  \\<bar>real n * (ln (real n - 1) - ln (real n)) - ln (real (n div 2)) +\n        1\\<bar>\n  \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n  ln (real (n div 2)) \\<le> 3 * ln (real n) - 2 * ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. \\<bar>real n * ln 2 -\n          (real n * ln (real n) - real n -\n           2 *\n           (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n))", "by simp"], ["proof (state)\nthis:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "then"], ["proof (chain)\npicking this:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))", "have minus_a: \"-?a \\<le> ?b - 2 * ?b1 - ?b2 - (?a2 - 2 * ?a1)\""], ["proof (prove)\nusing this:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))\n\ngoal (1 subgoal):\n 1. - (real n * ln 2)\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n)) -\n          (real n * ln (real n) - real n -\n           2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))", "by simp"], ["proof (state)\nthis:\n  - (real n * ln 2)\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n)) -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "from abs_a"], ["proof (chain)\npicking this:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))", "have a: \"?a \\<le> ?b - 2 * ?b1 - ?b2 + ?a2 - 2 * ?a1\""], ["proof (prove)\nusing this:\n  \\<bar>real n * ln 2 -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\\<bar>\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n))\n\ngoal (1 subgoal):\n 1. real n * ln 2\n    \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n          (1 + ln (real n)) +\n          (real n * ln (real n) - real n) -\n          2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))", "by (simp)"], ["proof (state)\nthis:\n  real n * ln 2\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n)) +\n        (real n * ln (real n) - real n) -\n        2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "from ln_fact_bounds[of \"n div 2\"] False"], ["proof (chain)\npicking this:\n  0 < n div 2 \\<Longrightarrow>\n  \\<bar>ln (fact (n div 2)) - real (n div 2) * ln (real (n div 2)) +\n        real (n div 2)\\<bar>\n  \\<le> 1 + ln (real (n div 2))\n  n div 2 \\<noteq> 0", "have abs_l1: \"abs(?l1 - ?a1) \\<le> ?b1\""], ["proof (prove)\nusing this:\n  0 < n div 2 \\<Longrightarrow>\n  \\<bar>ln (fact (n div 2)) - real (n div 2) * ln (real (n div 2)) +\n        real (n div 2)\\<bar>\n  \\<le> 1 + ln (real (n div 2))\n  n div 2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact (n div 2)) -\n          (real (n div 2) * ln (real (n div 2)) - real (n div 2))\\<bar>\n    \\<le> 1 + ln (real (n div 2))", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  \\<bar>ln (fact (n div 2)) -\n        (real (n div 2) * ln (real (n div 2)) - real (n div 2))\\<bar>\n  \\<le> 1 + ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "then"], ["proof (chain)\npicking this:\n  \\<bar>ln (fact (n div 2)) -\n        (real (n div 2) * ln (real (n div 2)) - real (n div 2))\\<bar>\n  \\<le> 1 + ln (real (n div 2))", "have minus_l1: \"?a1 - ?l1 \\<le> ?b1\""], ["proof (prove)\nusing this:\n  \\<bar>ln (fact (n div 2)) -\n        (real (n div 2) * ln (real (n div 2)) - real (n div 2))\\<bar>\n  \\<le> 1 + ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. real (n div 2) * ln (real (n div 2)) - real (n div 2) -\n    ln (fact (n div 2))\n    \\<le> 1 + ln (real (n div 2))", "by linarith"], ["proof (state)\nthis:\n  real (n div 2) * ln (real (n div 2)) - real (n div 2) -\n  ln (fact (n div 2))\n  \\<le> 1 + ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "from abs_l1"], ["proof (chain)\npicking this:\n  \\<bar>ln (fact (n div 2)) -\n        (real (n div 2) * ln (real (n div 2)) - real (n div 2))\\<bar>\n  \\<le> 1 + ln (real (n div 2))", "have l1: \"?l1 - ?a1 \\<le> ?b1\""], ["proof (prove)\nusing this:\n  \\<bar>ln (fact (n div 2)) -\n        (real (n div 2) * ln (real (n div 2)) - real (n div 2))\\<bar>\n  \\<le> 1 + ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. ln (fact (n div 2)) -\n    (real (n div 2) * ln (real (n div 2)) - real (n div 2))\n    \\<le> 1 + ln (real (n div 2))", "by linarith"], ["proof (state)\nthis:\n  ln (fact (n div 2)) -\n  (real (n div 2) * ln (real (n div 2)) - real (n div 2))\n  \\<le> 1 + ln (real (n div 2))\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "from ln_fact_bounds[of n] False"], ["proof (chain)\npicking this:\n  0 < n \\<Longrightarrow>\n  \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n  \\<le> 1 + ln (real n)\n  n div 2 \\<noteq> 0", "have abs_l2: \"abs(?l2 - ?a2) \\<le> ?b2\""], ["proof (prove)\nusing this:\n  0 < n \\<Longrightarrow>\n  \\<bar>ln (fact n) - real n * ln (real n) + real n\\<bar>\n  \\<le> 1 + ln (real n)\n  n div 2 \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - (real n * ln (real n) - real n)\\<bar>\n    \\<le> 1 + ln (real n)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  \\<bar>ln (fact n) - (real n * ln (real n) - real n)\\<bar>\n  \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "then"], ["proof (chain)\npicking this:\n  \\<bar>ln (fact n) - (real n * ln (real n) - real n)\\<bar>\n  \\<le> 1 + ln (real n)", "have l2: \"?l2 - ?a2 \\<le> ?b2\""], ["proof (prove)\nusing this:\n  \\<bar>ln (fact n) - (real n * ln (real n) - real n)\\<bar>\n  \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. ln (fact n) - (real n * ln (real n) - real n) \\<le> 1 + ln (real n)", "by simp"], ["proof (state)\nthis:\n  ln (fact n) - (real n * ln (real n) - real n) \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "from abs_l2"], ["proof (chain)\npicking this:\n  \\<bar>ln (fact n) - (real n * ln (real n) - real n)\\<bar>\n  \\<le> 1 + ln (real n)", "have minus_l2: \"?a2 - ?l2 \\<le> ?b2\""], ["proof (prove)\nusing this:\n  \\<bar>ln (fact n) - (real n * ln (real n) - real n)\\<bar>\n  \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. real n * ln (real n) - real n - ln (fact n) \\<le> 1 + ln (real n)", "by simp"], ["proof (state)\nthis:\n  real n * ln (real n) - real n - ln (fact n) \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "from minus_a minus_l1 l2"], ["proof (chain)\npicking this:\n  - (real n * ln 2)\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n)) -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\n  real (n div 2) * ln (real (n div 2)) - real (n div 2) -\n  ln (fact (n div 2))\n  \\<le> 1 + ln (real (n div 2))\n  ln (fact n) - (real n * ln (real n) - real n) \\<le> 1 + ln (real n)", "have \"?l2 - 2 * ?l1 - ?a \\<le> ?b\""], ["proof (prove)\nusing this:\n  - (real n * ln 2)\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n)) -\n        (real n * ln (real n) - real n -\n         2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2)))\n  real (n div 2) * ln (real (n div 2)) - real (n div 2) -\n  ln (fact (n div 2))\n  \\<le> 1 + ln (real (n div 2))\n  ln (fact n) - (real n * ln (real n) - real n) \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\n    \\<le> 4 * ln (real n) + 3", "by simp"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\n  \\<le> 4 * ln (real n) + 3\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "moreover"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\n  \\<le> 4 * ln (real n) + 3\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "from a l1 minus_l2"], ["proof (chain)\npicking this:\n  real n * ln 2\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n)) +\n        (real n * ln (real n) - real n) -\n        2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))\n  ln (fact (n div 2)) -\n  (real (n div 2) * ln (real (n div 2)) - real (n div 2))\n  \\<le> 1 + ln (real (n div 2))\n  real n * ln (real n) - real n - ln (fact n) \\<le> 1 + ln (real n)", "have \"- ?l2 + 2 * ?l1 + ?a \\<le> ?b\""], ["proof (prove)\nusing this:\n  real n * ln 2\n  \\<le> 4 * ln (real n) + 3 - 2 * (1 + ln (real (n div 2))) -\n        (1 + ln (real n)) +\n        (real n * ln (real n) - real n) -\n        2 * (real (n div 2) * ln (real (n div 2)) - real (n div 2))\n  ln (fact (n div 2)) -\n  (real (n div 2) * ln (real (n div 2)) - real (n div 2))\n  \\<le> 1 + ln (real (n div 2))\n  real n * ln (real n) - real n - ln (fact n) \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. - ln (fact n) + 2 * ln (fact (n div 2)) + real n * ln 2\n    \\<le> 4 * ln (real n) + 3", "by simp"], ["proof (state)\nthis:\n  - ln (fact n) + 2 * ln (fact (n div 2)) + real n * ln 2\n  \\<le> 4 * ln (real n) + 3\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "ultimately"], ["proof (chain)\npicking this:\n  ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\n  \\<le> 4 * ln (real n) + 3\n  - ln (fact n) + 2 * ln (fact (n div 2)) + real n * ln 2\n  \\<le> 4 * ln (real n) + 3", "have \"abs((?l2 - 2*?l1) - ?a) \\<le> ?b\""], ["proof (prove)\nusing this:\n  ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\n  \\<le> 4 * ln (real n) + 3\n  - ln (fact n) + 2 * ln (fact (n div 2)) + real n * ln 2\n  \\<le> 4 * ln (real n) + 3\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real n) + 3", "by simp"], ["proof (state)\nthis:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real n) + 3\n\ngoal (1 subgoal):\n 1. n div 2 \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "then"], ["proof (chain)\npicking this:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real n) + 3", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real n) + 3\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "by simp"], ["proof (state)\nthis:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ln_primefact:\n  assumes \"n \\<noteq> (0::nat)\"\n  shows   \"ln n = (\\<Sum>d=1..n. if primepow d \\<and> d dvd n then ln (aprimedivisor d) else 0)\" \n          (is \"?lhs = ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "have \"?rhs = (\\<Sum>d\\<in>{x \\<in> {1..n}. primepow x \\<and> x dvd n}. ln (real (aprimedivisor d)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0) =\n    (\\<Sum>d\\<in>{x \\<in> {1..n}. primepow x \\<and> x dvd n}.\n       ln (real (aprimedivisor d)))", "unfolding primepow_factors_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0) =\n    (\\<Sum>d\\<in>{x \\<in> {1..n}. primepow x \\<and> x dvd n}.\n       ln (real (aprimedivisor d)))", "by (subst sum.inter_filter [symmetric]) simp_all"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n      else 0) =\n  (\\<Sum>d\\<in>{x \\<in> {1..n}. primepow x \\<and> x dvd n}.\n     ln (real (aprimedivisor d)))\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n      else 0) =\n  (\\<Sum>d\\<in>{x \\<in> {1..n}. primepow x \\<and> x dvd n}.\n     ln (real (aprimedivisor d)))\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "have \"{x \\<in> {1..n}. primepow x \\<and> x dvd n} = primepow_factors n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> {1..n}. primepow x \\<and> x dvd n} = primepow_factors n", "using assms"], ["proof (prove)\nusing this:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. {x \\<in> {1..n}. primepow x \\<and> x dvd n} = primepow_factors n", "by (auto simp: primepow_factors_def dest: dvd_imp_le primepow_gt_Suc_0)"], ["proof (state)\nthis:\n  {x \\<in> {1..n}. primepow x \\<and> x dvd n} = primepow_factors n\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n      else 0) =\n  (\\<Sum>d\\<in>primepow_factors n. ln (real (aprimedivisor d)))", "have *: \"(\\<Sum>d\\<in>primepow_factors n. ln (real (aprimedivisor d))) = ?rhs\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n      else 0) =\n  (\\<Sum>d\\<in>primepow_factors n. ln (real (aprimedivisor d)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d\\<in>primepow_factors n. ln (real (aprimedivisor d))) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", ".."], ["proof (state)\nthis:\n  (\\<Sum>d\\<in>primepow_factors n. ln (real (aprimedivisor d))) =\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d)) else 0)\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "from in_prime_factors_imp_prime prime_gt_0_nat"], ["proof (chain)\npicking this:\n  ?p \\<in># prime_factorization ?x \\<Longrightarrow> prime ?p\n  prime ?p \\<Longrightarrow> 0 < ?p", "have pf_pos: \"\\<And>p. p\\<in>#prime_factorization n \\<Longrightarrow> p > 0\""], ["proof (prove)\nusing this:\n  ?p \\<in># prime_factorization ?x \\<Longrightarrow> prime ?p\n  prime ?p \\<Longrightarrow> 0 < ?p\n\ngoal (1 subgoal):\n 1. \\<And>p. p \\<in># prime_factorization n \\<Longrightarrow> 0 < p", "by blast"], ["proof (state)\nthis:\n  ?p \\<in># prime_factorization n \\<Longrightarrow> 0 < ?p\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "from ln_msetprod[of \"prime_factorization n\", OF pf_pos] assms"], ["proof (chain)\npicking this:\n  (\\<And>x.\n      x \\<in># prime_factorization n \\<Longrightarrow>\n      x \\<in># prime_factorization n) \\<Longrightarrow>\n  (\\<Sum>p\\<in>#prime_factorization n. ln (real p)) =\n  ln (\\<Prod>\\<^sub># (image_mset real (prime_factorization n)))\n  n \\<noteq> 0", "have \"ln n = (\\<Sum>p\\<in>#prime_factorization n. ln p)\""], ["proof (prove)\nusing this:\n  (\\<And>x.\n      x \\<in># prime_factorization n \\<Longrightarrow>\n      x \\<in># prime_factorization n) \\<Longrightarrow>\n  (\\<Sum>p\\<in>#prime_factorization n. ln (real p)) =\n  ln (\\<Prod>\\<^sub># (image_mset real (prime_factorization n)))\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. ln (real n) = (\\<Sum>p\\<in>#prime_factorization n. ln (real p))", "by (simp add: of_nat_prod_mset)"], ["proof (state)\nthis:\n  ln (real n) = (\\<Sum>p\\<in>#prime_factorization n. ln (real p))\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "also"], ["proof (state)\nthis:\n  ln (real n) = (\\<Sum>p\\<in>#prime_factorization n. ln (real p))\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "from * sum_prime_factorization_conv_sum_primepow_factors[of n ln, OF assms(1)]"], ["proof (chain)\npicking this:\n  (\\<Sum>d\\<in>primepow_factors n. ln (real (aprimedivisor d))) =\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d)) else 0)\n  (\\<Sum>q\\<in>primepow_factors n. ln (real (aprimedivisor q))) =\n  (\\<Sum>p\\<in>#prime_factorization n. ln (real p))", "have \"\\<dots> = ?rhs\""], ["proof (prove)\nusing this:\n  (\\<Sum>d\\<in>primepow_factors n. ln (real (aprimedivisor d))) =\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d)) else 0)\n  (\\<Sum>q\\<in>primepow_factors n. ln (real (aprimedivisor q))) =\n  (\\<Sum>p\\<in>#prime_factorization n. ln (real p))\n\ngoal (1 subgoal):\n 1. (\\<Sum>p\\<in>#prime_factorization n. ln (real p)) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>p\\<in>#prime_factorization n. ln (real p)) =\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d)) else 0)\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "finally"], ["proof (chain)\npicking this:\n  ln (real n) =\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d)) else 0)", "show ?thesis"], ["proof (prove)\nusing this:\n  ln (real n) =\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d)) else 0)\n\ngoal (1 subgoal):\n 1. ln (real n) =\n    (\\<Sum>d = 1..n.\n        if primepow d \\<and> d dvd n then ln (real (aprimedivisor d))\n        else 0)", "."], ["proof (state)\nthis:\n  ln (real n) =\n  (\\<Sum>d = 1..n.\n      if primepow d \\<and> d dvd n then ln (real (aprimedivisor d)) else 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "context\nbegin"], ["", "private"], ["", "lemma divisors:\n  fixes x d::nat\n  assumes \"x \\<in> {1..n}\"\n  assumes \"d dvd x\"\n  shows \"\\<exists>k\\<in>{1..n div d}. x = d * k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = d * k", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = d * k", "from assms"], ["proof (chain)\npicking this:\n  x \\<in> {1..n}\n  d dvd x", "have \"x \\<le> n\""], ["proof (prove)\nusing this:\n  x \\<in> {1..n}\n  d dvd x\n\ngoal (1 subgoal):\n 1. x \\<le> n", "by simp"], ["proof (state)\nthis:\n  x \\<le> n\n\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = d * k", "then"], ["proof (chain)\npicking this:\n  x \\<le> n", "have ub: \"x div d \\<le> n div d\""], ["proof (prove)\nusing this:\n  x \\<le> n\n\ngoal (1 subgoal):\n 1. x div d \\<le> n div d", "by (simp add: div_le_mono \\<open>x \\<le> n\\<close>)"], ["proof (state)\nthis:\n  x div d \\<le> n div d\n\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = d * k", "from assms"], ["proof (chain)\npicking this:\n  x \\<in> {1..n}\n  d dvd x", "have \"1 \\<le> x div d\""], ["proof (prove)\nusing this:\n  x \\<in> {1..n}\n  d dvd x\n\ngoal (1 subgoal):\n 1. 1 \\<le> x div d", "by (auto elim!: dvdE)"], ["proof (state)\nthis:\n  1 \\<le> x div d\n\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = d * k", "with ub"], ["proof (chain)\npicking this:\n  x div d \\<le> n div d\n  1 \\<le> x div d", "have \"x div d \\<in> {1..n div d}\""], ["proof (prove)\nusing this:\n  x div d \\<le> n div d\n  1 \\<le> x div d\n\ngoal (1 subgoal):\n 1. x div d \\<in> {1..n div d}", "by simp"], ["proof (state)\nthis:\n  x div d \\<in> {1..n div d}\n\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = d * k", "with \\<open>d dvd x\\<close>"], ["proof (chain)\npicking this:\n  d dvd x\n  x div d \\<in> {1..n div d}", "show ?thesis"], ["proof (prove)\nusing this:\n  d dvd x\n  x div d \\<in> {1..n div d}\n\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = d * k", "by (auto intro!: bexI[of _ \"x div d\"])"], ["proof (state)\nthis:\n  \\<exists>k\\<in>{1..n div d}. x = d * k\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ln_fact_conv_mangoldt: \"ln (fact n) = (\\<Sum>d=1..n. mangoldt d * floor (n / d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "have *: \"(\\<Sum>da=1..n. if primepow da \\<and> da dvd d then ln (aprimedivisor da) else 0) = \n             (\\<Sum>(da::nat)=1..d. if primepow da \\<and> da dvd d then ln (aprimedivisor da) else 0)\" \n    if d: \"d \\<in> {1..n}\" for d"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>da = 1..n.\n        if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n        else 0) =\n    (\\<Sum>da = 1..d.\n        if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n        else 0)", "by (rule sum.mono_neutral_right, insert d) (auto dest: dvd_imp_le)"], ["proof (state)\nthis:\n  ?d \\<in> {1..n} \\<Longrightarrow>\n  (\\<Sum>da = 1..n.\n      if primepow da \\<and> da dvd ?d then ln (real (aprimedivisor da))\n      else 0) =\n  (\\<Sum>da = 1..?d.\n      if primepow da \\<and> da dvd ?d then ln (real (aprimedivisor da))\n      else 0)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "have \"(\\<Sum>d=1..n. \\<Sum>da=1..d. if primepow da \\<and>\n      da dvd d then ln (aprimedivisor da) else 0) = \n      (\\<Sum>d=1..n. \\<Sum>da=1..n. if primepow da \\<and>\n      da dvd d then ln (aprimedivisor da) else 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        \\<Sum>da = 1..d.\n           if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n           else 0) =\n    (\\<Sum>d = 1..n.\n        \\<Sum>da = 1..n.\n           if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n           else 0)", "by (rule sum.cong) (insert *, simp_all)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..d.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..n.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..d.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..n.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "have \"\\<dots> = (\\<Sum>da=1..n. \\<Sum>d=1..n. if primepow da \\<and>\n                     da dvd d then ln (aprimedivisor da) else 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        \\<Sum>da = 1..n.\n           if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n           else 0) =\n    (\\<Sum>da = 1..n.\n        \\<Sum>d = 1..n.\n           if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n           else 0)", "by (rule sum.swap)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..n.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>da = 1..n.\n      \\<Sum>d = 1..n.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..n.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>da = 1..n.\n      \\<Sum>d = 1..n.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "have \"\\<dots> = sum (\\<lambda>d. mangoldt d * floor (n/d)) {1..n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>da = 1..n.\n        \\<Sum>d = 1..n.\n           if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n           else 0) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "proof (rule sum.cong)"], ["proof (state)\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "fix d"], ["proof (state)\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "assume d: \"d \\<in> {1..n}\""], ["proof (state)\nthis:\n  d \\<in> {1..n}\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "have \"(\\<Sum>da = 1..n. if primepow d \\<and> d dvd da then ln (real (aprimedivisor d)) else 0) =\n            (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>da = 1..n.\n        if primepow d \\<and> d dvd da then ln (real (aprimedivisor d))\n        else 0) =\n    (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0)", "by (intro sum.cong) (simp_all add: mangoldt_def)"], ["proof (state)\nthis:\n  (\\<Sum>da = 1..n.\n      if primepow d \\<and> d dvd da then ln (real (aprimedivisor d))\n      else 0) =\n  (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0)\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "also"], ["proof (state)\nthis:\n  (\\<Sum>da = 1..n.\n      if primepow d \\<and> d dvd da then ln (real (aprimedivisor d))\n      else 0) =\n  (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0)\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "have \"\\<dots> = mangoldt d * real (card {x. x \\<in> {1..n} \\<and> d dvd x})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0) =\n    mangoldt d * real (card {x \\<in> {1..n}. d dvd x})", "by (subst sum.inter_filter [symmetric]) (simp_all add: algebra_simps)"], ["proof (state)\nthis:\n  (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0) =\n  mangoldt d * real (card {x \\<in> {1..n}. d dvd x})\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "also"], ["proof (state)\nthis:\n  (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0) =\n  mangoldt d * real (card {x \\<in> {1..n}. d dvd x})\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "{"], ["proof (state)\nthis:\n  (\\<Sum>da = 1..n. if d dvd da then mangoldt d else 0) =\n  mangoldt d * real (card {x \\<in> {1..n}. d dvd x})\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "have \"{x. x \\<in> {1..n} \\<and> d dvd x} = {x. \\<exists>k \\<in>{1..n div d}. x=k*d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x \\<in> {1..n}. d dvd x} = {x. \\<exists>k\\<in>{1..n div d}. x = k * d}", "proof safe"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> {1..n}; d dvd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k\\<in>{1..n div d}. x = k * d\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 3. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "fix x"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> {1..n}; d dvd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k\\<in>{1..n div d}. x = k * d\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 3. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "assume \"x \\<in> {1..n}\" \"d dvd x\""], ["proof (state)\nthis:\n  x \\<in> {1..n}\n  d dvd x\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> {1..n}; d dvd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>k\\<in>{1..n div d}. x = k * d\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 3. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "thus \"\\<exists>k\\<in>{1..n div d}. x = k * d\""], ["proof (prove)\nusing this:\n  x \\<in> {1..n}\n  d dvd x\n\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = k * d", "using divisors[of x n d]"], ["proof (prove)\nusing this:\n  x \\<in> {1..n}\n  d dvd x\n  \\<lbrakk>x \\<in> {1..n}; d dvd x\\<rbrakk>\n  \\<Longrightarrow> \\<exists>k\\<in>{1..n div d}. x = d * k\n\ngoal (1 subgoal):\n 1. \\<exists>k\\<in>{1..n div d}. x = k * d", "by auto"], ["proof (state)\nthis:\n  \\<exists>k\\<in>{1..n div d}. x = k * d\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "fix x k"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "assume k: \"k \\<in> {1..n div d}\""], ["proof (state)\nthis:\n  k \\<in> {1..n div d}\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "from k"], ["proof (chain)\npicking this:\n  k \\<in> {1..n div d}", "have \"k * d \\<le> n div d * d\""], ["proof (prove)\nusing this:\n  k \\<in> {1..n div d}\n\ngoal (1 subgoal):\n 1. k * d \\<le> n div d * d", "by (intro mult_right_mono) simp_all"], ["proof (state)\nthis:\n  k * d \\<le> n div d * d\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "also"], ["proof (state)\nthis:\n  k * d \\<le> n div d * d\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "have \"n div d * d \\<le> n div d * d + n mod d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n div d * d \\<le> n div d * d + n mod d", "by (rule le_add1)"], ["proof (state)\nthis:\n  n div d * d \\<le> n div d * d + n mod d\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "also"], ["proof (state)\nthis:\n  n div d * d \\<le> n div d * d + n mod d\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "have \"\\<dots> = n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n div d * d + n mod d = n", "by simp"], ["proof (state)\nthis:\n  n div d * d + n mod d = n\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "finally"], ["proof (chain)\npicking this:\n  k * d \\<le> n", "have \"k * d \\<le> n\""], ["proof (prove)\nusing this:\n  k * d \\<le> n\n\ngoal (1 subgoal):\n 1. k * d \\<le> n", "."], ["proof (state)\nthis:\n  k * d \\<le> n\n\ngoal (2 subgoals):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> k * d \\<in> {1..n}\n 2. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "thus \"k * d \\<in> {1..n}\""], ["proof (prove)\nusing this:\n  k * d \\<le> n\n\ngoal (1 subgoal):\n 1. k * d \\<in> {1..n}", "using d k"], ["proof (prove)\nusing this:\n  k * d \\<le> n\n  d \\<in> {1..n}\n  k \\<in> {1..n div d}\n\ngoal (1 subgoal):\n 1. k * d \\<in> {1..n}", "by auto"], ["proof (state)\nthis:\n  k * d \\<in> {1..n}\n\ngoal (1 subgoal):\n 1. \\<And>x k. k \\<in> {1..n div d} \\<Longrightarrow> d dvd k * d", "qed auto"], ["proof (state)\nthis:\n  {x \\<in> {1..n}. d dvd x} = {x. \\<exists>k\\<in>{1..n div d}. x = k * d}\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "also"], ["proof (state)\nthis:\n  {x \\<in> {1..n}. d dvd x} = {x. \\<exists>k\\<in>{1..n div d}. x = k * d}\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "have \"\\<dots> = (\\<lambda>k. k*d) ` {1..n div d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<exists>k\\<in>{1..n div d}. x = k * d} =\n    (\\<lambda>k. k * d) ` {1..n div d}", "by fast"], ["proof (state)\nthis:\n  {x. \\<exists>k\\<in>{1..n div d}. x = k * d} =\n  (\\<lambda>k. k * d) ` {1..n div d}\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "also"], ["proof (state)\nthis:\n  {x. \\<exists>k\\<in>{1..n div d}. x = k * d} =\n  (\\<lambda>k. k * d) ` {1..n div d}\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "have \"card \\<dots> = card {1..n div d}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card ((\\<lambda>k. k * d) ` {1..n div d}) = card {1..n div d}", "by (rule card_image) (simp add: inj_on_def)"], ["proof (state)\nthis:\n  card ((\\<lambda>k. k * d) ` {1..n div d}) = card {1..n div d}\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "also"], ["proof (state)\nthis:\n  card ((\\<lambda>k. k * d) ` {1..n div d}) = card {1..n div d}\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "have \"\\<dots> = n div d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. card {1..n div d} = n div d", "by simp"], ["proof (state)\nthis:\n  card {1..n div d} = n div d\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "also"], ["proof (state)\nthis:\n  card {1..n div d} = n div d\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "have \"... = \\<lfloor>n / d\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. int (n div d) = \\<lfloor>real n / real d\\<rfloor>", "by (simp add: floor_divide_of_nat_eq)"], ["proof (state)\nthis:\n  int (n div d) = \\<lfloor>real n / real d\\<rfloor>\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "finally"], ["proof (chain)\npicking this:\n  int (card {x \\<in> {1..n}. d dvd x}) = \\<lfloor>real n / real d\\<rfloor>", "have \"real (card {x. x \\<in> {1..n} \\<and> d dvd x}) = real_of_int \\<lfloor>n / d\\<rfloor>\""], ["proof (prove)\nusing this:\n  int (card {x \\<in> {1..n}. d dvd x}) = \\<lfloor>real n / real d\\<rfloor>\n\ngoal (1 subgoal):\n 1. real (card {x \\<in> {1..n}. d dvd x}) =\n    real_of_int \\<lfloor>real n / real d\\<rfloor>", "by force"], ["proof (state)\nthis:\n  real (card {x \\<in> {1..n}. d dvd x}) =\n  real_of_int \\<lfloor>real n / real d\\<rfloor>\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "}"], ["proof (state)\nthis:\n  real (card {x \\<in> {1..n}. d dvd x}) =\n  real_of_int \\<lfloor>real n / real d\\<rfloor>\n\ngoal (2 subgoals):\n 1. {1..n} = {1..n}\n 2. \\<And>x.\n       x \\<in> {1..n} \\<Longrightarrow>\n       (\\<Sum>d = 1..n.\n           if primepow x \\<and> x dvd d then ln (real (aprimedivisor x))\n           else 0) =\n       mangoldt x * real_of_int \\<lfloor>real n / real x\\<rfloor>", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>da = 1..n.\n      if primepow d \\<and> d dvd da then ln (real (aprimedivisor d))\n      else 0) =\n  mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>", "show \"(\\<Sum>da = 1..n. if primepow d \\<and> d dvd da then ln (real (aprimedivisor d)) else 0) =\n            mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>\""], ["proof (prove)\nusing this:\n  (\\<Sum>da = 1..n.\n      if primepow d \\<and> d dvd da then ln (real (aprimedivisor d))\n      else 0) =\n  mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>\n\ngoal (1 subgoal):\n 1. (\\<Sum>da = 1..n.\n        if primepow d \\<and> d dvd da then ln (real (aprimedivisor d))\n        else 0) =\n    mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>", "."], ["proof (state)\nthis:\n  (\\<Sum>da = 1..n.\n      if primepow d \\<and> d dvd da then ln (real (aprimedivisor d))\n      else 0) =\n  mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>\n\ngoal (1 subgoal):\n 1. {1..n} = {1..n}", "qed simp_all"], ["proof (state)\nthis:\n  (\\<Sum>da = 1..n.\n      \\<Sum>d = 1..n.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..d.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "have \"(\\<Sum>d=1..n. \\<Sum>da=1..d. if primepow da \\<and>\n      da dvd d then ln (aprimedivisor da) else 0) = \n    sum (\\<lambda>d. mangoldt d * floor (n/d)) {1..n}\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..d.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        \\<Sum>da = 1..d.\n           if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n           else 0) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..d.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "with ln_primefact"], ["proof (chain)\npicking this:\n  ?n \\<noteq> 0 \\<Longrightarrow>\n  ln (real ?n) =\n  (\\<Sum>d = 1..?n.\n      if primepow d \\<and> d dvd ?n then ln (real (aprimedivisor d)) else 0)\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..d.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "have \"(\\<Sum>d=1..n. ln d) =\n    (\\<Sum>d=1..n. mangoldt d * floor (n/d))\""], ["proof (prove)\nusing this:\n  ?n \\<noteq> 0 \\<Longrightarrow>\n  ln (real ?n) =\n  (\\<Sum>d = 1..?n.\n      if primepow d \\<and> d dvd ?n then ln (real (aprimedivisor d)) else 0)\n  (\\<Sum>d = 1..n.\n      \\<Sum>da = 1..d.\n         if primepow da \\<and> da dvd d then ln (real (aprimedivisor da))\n         else 0) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. ln (real d)) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. ln (real d)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "with ln_fact"], ["proof (chain)\npicking this:\n  ln (fact ?n) = (\\<Sum>d = 1..?n. ln (real d))\n  (\\<Sum>d = 1..n. ln (real d)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "show ?thesis"], ["proof (prove)\nusing this:\n  ln (fact ?n) = (\\<Sum>d = 1..?n. ln (real d))\n  (\\<Sum>d = 1..n. ln (real d)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "by simp"], ["proof (state)\nthis:\n  ln (fact n) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "context\nbegin"], ["", "private"], ["", "lemma div_2_mult_2_bds:\n  fixes n d :: nat\n  assumes \"d > 0\"\n  shows \"0 \\<le> \\<lfloor>n / d\\<rfloor> - 2 * \\<lfloor>(n div 2) / d\\<rfloor>\" \"\\<lfloor>n / d\\<rfloor> - 2 * \\<lfloor>(n div 2) / d\\<rfloor> \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> \\<lfloor>real n / real d\\<rfloor> -\n            2 * \\<lfloor>real (n div 2) / real d\\<rfloor> &&&\n    \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. 0 \\<le> \\<lfloor>real n / real d\\<rfloor> -\n            2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n 2. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "have \"\\<lfloor>2::real\\<rfloor> * \\<lfloor>(n div 2) / d\\<rfloor> \\<le> \\<lfloor>2 * ((n div 2) / d)\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lfloor>2\\<rfloor> * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> \\<lfloor>2 * (real (n div 2) / real d)\\<rfloor>", "by (rule le_mult_floor) simp_all"], ["proof (state)\nthis:\n  \\<lfloor>2\\<rfloor> * \\<lfloor>real (n div 2) / real d\\<rfloor>\n  \\<le> \\<lfloor>2 * (real (n div 2) / real d)\\<rfloor>\n\ngoal (2 subgoals):\n 1. 0 \\<le> \\<lfloor>real n / real d\\<rfloor> -\n            2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n 2. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "also"], ["proof (state)\nthis:\n  \\<lfloor>2\\<rfloor> * \\<lfloor>real (n div 2) / real d\\<rfloor>\n  \\<le> \\<lfloor>2 * (real (n div 2) / real d)\\<rfloor>\n\ngoal (2 subgoals):\n 1. 0 \\<le> \\<lfloor>real n / real d\\<rfloor> -\n            2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n 2. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "from assms"], ["proof (chain)\npicking this:\n  0 < d", "have \"\\<dots> \\<le> \\<lfloor>n / d\\<rfloor>\""], ["proof (prove)\nusing this:\n  0 < d\n\ngoal (1 subgoal):\n 1. \\<lfloor>2 * (real (n div 2) / real d)\\<rfloor>\n    \\<le> \\<lfloor>real n / real d\\<rfloor>", "by (intro floor_mono) (simp_all add: field_simps)"], ["proof (state)\nthis:\n  \\<lfloor>2 * (real (n div 2) / real d)\\<rfloor>\n  \\<le> \\<lfloor>real n / real d\\<rfloor>\n\ngoal (2 subgoals):\n 1. 0 \\<le> \\<lfloor>real n / real d\\<rfloor> -\n            2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n 2. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "finally"], ["proof (chain)\npicking this:\n  \\<lfloor>2\\<rfloor> * \\<lfloor>real (n div 2) / real d\\<rfloor>\n  \\<le> \\<lfloor>real n / real d\\<rfloor>", "show \"0 \\<le> \\<lfloor>n / d\\<rfloor> - 2 * \\<lfloor>(n div 2) / d\\<rfloor>\""], ["proof (prove)\nusing this:\n  \\<lfloor>2\\<rfloor> * \\<lfloor>real (n div 2) / real d\\<rfloor>\n  \\<le> \\<lfloor>real n / real d\\<rfloor>\n\ngoal (1 subgoal):\n 1. 0 \\<le> \\<lfloor>real n / real d\\<rfloor> -\n            2 * \\<lfloor>real (n div 2) / real d\\<rfloor>", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  0 \\<le> \\<lfloor>real n / real d\\<rfloor> -\n          2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "have \"real (n div d) \\<le> real (2 * ((n div 2) div d) + 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n div d) \\<le> real (2 * (n div 2 div d) + 1)", "by (subst div_mult2_eq [symmetric], simp only: mult.commute, subst div_mult2_eq) simp"], ["proof (state)\nthis:\n  real (n div d) \\<le> real (2 * (n div 2 div d) + 1)\n\ngoal (1 subgoal):\n 1. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "thus \"\\<lfloor>n / d\\<rfloor> - 2 * \\<lfloor>(n div 2) / d\\<rfloor> \\<le> 1\""], ["proof (prove)\nusing this:\n  real (n div d) \\<le> real (2 * (n div 2 div d) + 1)\n\ngoal (1 subgoal):\n 1. \\<lfloor>real n / real d\\<rfloor> -\n    2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n    \\<le> 1", "unfolding of_nat_add of_nat_mult floor_conv_div_nat [symmetric]"], ["proof (prove)\nusing this:\n  real_of_int \\<lfloor>real n / real d\\<rfloor>\n  \\<le> real 2 *\n        real_of_int\n         \\<lfloor>real_of_int \\<lfloor>real n / real 2\\<rfloor> /\n                  real d\\<rfloor> +\n        real 1\n\ngoal (1 subgoal):\n 1. \\<lfloor>real n / real d\\<rfloor> -\n    2 *\n    \\<lfloor>real_of_int \\<lfloor>real n / real 2\\<rfloor> / real d\\<rfloor>\n    \\<le> 1", "by simp_all"], ["proof (state)\nthis:\n  \\<lfloor>real n / real d\\<rfloor> -\n  2 * \\<lfloor>real (n div 2) / real d\\<rfloor>\n  \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma n_div_d_eq_1: \"d \\<in> {n div 2 + 1..n} \\<Longrightarrow> \\<lfloor>real n / real d\\<rfloor> = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d \\<in> {n div 2 + 1..n} \\<Longrightarrow>\n    \\<lfloor>real n / real d\\<rfloor> = 1", "by (cases \"n = d\") (auto simp: field_simps intro: floor_eq)"], ["", "lemma psi_bounds_ln_fact:\n  shows \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\"\n        \"psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n &&&\n    psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "fix n::nat"], ["proof (state)\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "let ?k = \"n div 2\" and ?d = \"n mod 2\""], ["proof (state)\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have *: \"\\<lfloor>?k / d\\<rfloor> = 0\" if \"d > ?k\" for d"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lfloor>real (n div 2) / real d\\<rfloor> = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lfloor>real (n div 2) / real d\\<rfloor> = 0", "from that div_less"], ["proof (chain)\npicking this:\n  n div 2 < d\n  ?m < ?n \\<Longrightarrow> ?m div ?n = 0", "have \"0 = ?k div d\""], ["proof (prove)\nusing this:\n  n div 2 < d\n  ?m < ?n \\<Longrightarrow> ?m div ?n = 0\n\ngoal (1 subgoal):\n 1. 0 = n div 2 div d", "by simp"], ["proof (state)\nthis:\n  0 = n div 2 div d\n\ngoal (1 subgoal):\n 1. \\<lfloor>real (n div 2) / real d\\<rfloor> = 0", "also"], ["proof (state)\nthis:\n  0 = n div 2 div d\n\ngoal (1 subgoal):\n 1. \\<lfloor>real (n div 2) / real d\\<rfloor> = 0", "have \"\\<dots> = \\<lfloor>?k / d\\<rfloor>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. int (n div 2 div d) = \\<lfloor>real (n div 2) / real d\\<rfloor>", "by (rule floor_divide_of_nat_eq [symmetric])"], ["proof (state)\nthis:\n  int (n div 2 div d) = \\<lfloor>real (n div 2) / real d\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<lfloor>real (n div 2) / real d\\<rfloor> = 0", "finally"], ["proof (chain)\npicking this:\n  int 0 = \\<lfloor>real (n div 2) / real d\\<rfloor>", "show \"\\<lfloor>?k / d\\<rfloor> = 0\""], ["proof (prove)\nusing this:\n  int 0 = \\<lfloor>real (n div 2) / real d\\<rfloor>\n\ngoal (1 subgoal):\n 1. \\<lfloor>real (n div 2) / real d\\<rfloor> = 0", "by simp"], ["proof (state)\nthis:\n  \\<lfloor>real (n div 2) / real d\\<rfloor> = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  n div 2 < ?d \\<Longrightarrow>\n  \\<lfloor>real (n div 2) / real ?d\\<rfloor> = 0\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have sum_eq: \"(\\<Sum>d=1..2*?k+?d. mangoldt d * \\<lfloor>?k / d\\<rfloor>) = (\\<Sum>d=1..?k. mangoldt d * \\<lfloor>?k / d\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n    (\\<Sum>d = 1..n div 2.\n        mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "by (intro sum.mono_neutral_right) (auto simp: *)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "from ln_fact_conv_mangoldt"], ["proof (chain)\npicking this:\n  ln (fact ?n) =\n  (\\<Sum>d = 1..?n.\n      mangoldt d * real_of_int \\<lfloor>real ?n / real d\\<rfloor>)", "have \"ln (fact n) = (\\<Sum>d=1..n. mangoldt d * \\<lfloor>n / d\\<rfloor>)\""], ["proof (prove)\nusing this:\n  ln (fact ?n) =\n  (\\<Sum>d = 1..?n.\n      mangoldt d * real_of_int \\<lfloor>real ?n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "."], ["proof (state)\nthis:\n  ln (fact n) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  ln (fact n) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d=1..n. mangoldt d * \\<lfloor>(2 * (n div 2) + n mod 2) / d\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) =\n    (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int\n         \\<lfloor>real (2 * (n div 2) + n mod 2) / real d\\<rfloor>)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int \\<lfloor>real (2 * (n div 2) + n mod 2) / real d\\<rfloor>)\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int \\<lfloor>real (2 * (n div 2) + n mod 2) / real d\\<rfloor>)\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> \\<le> (\\<Sum>d=1..n. mangoldt d * (2 * \\<lfloor>?k / d\\<rfloor> + 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int\n         \\<lfloor>real (2 * (n div 2) + n mod 2) / real d\\<rfloor>)\n    \\<le> (\\<Sum>d = 1..n.\n              mangoldt d *\n              real_of_int\n               (2 * \\<lfloor>real (n div 2) / real d\\<rfloor> + 1))", "using div_2_mult_2_bds(2)[of _ n]"], ["proof (prove)\nusing this:\n  0 < ?d \\<Longrightarrow>\n  \\<lfloor>real n / real ?d\\<rfloor> -\n  2 * \\<lfloor>real (n div 2) / real ?d\\<rfloor>\n  \\<le> 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int\n         \\<lfloor>real (2 * (n div 2) + n mod 2) / real d\\<rfloor>)\n    \\<le> (\\<Sum>d = 1..n.\n              mangoldt d *\n              real_of_int\n               (2 * \\<lfloor>real (n div 2) / real d\\<rfloor> + 1))", "by (intro sum_mono mult_left_mono, subst of_int_le_iff)\n       (auto simp: algebra_simps mangoldt_nonneg)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int \\<lfloor>real (2 * (n div 2) + n mod 2) / real d\\<rfloor>)\n  \\<le> (\\<Sum>d = 1..n.\n            mangoldt d *\n            real_of_int (2 * \\<lfloor>real (n div 2) / real d\\<rfloor> + 1))\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int \\<lfloor>real (2 * (n div 2) + n mod 2) / real d\\<rfloor>)\n  \\<le> (\\<Sum>d = 1..n.\n            mangoldt d *\n            real_of_int (2 * \\<lfloor>real (n div 2) / real d\\<rfloor> + 1))\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = 2 * (\\<Sum>d=1..n. mangoldt d * \\<lfloor>(n div 2) / d\\<rfloor>) + (\\<Sum>d=1..n. mangoldt d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int (2 * \\<lfloor>real (n div 2) / real d\\<rfloor> + 1)) =\n    2 *\n    (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n    sum mangoldt {1..n}", "by (simp add: algebra_simps sum.distrib sum_distrib_left)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int (2 * \\<lfloor>real (n div 2) / real d\\<rfloor> + 1)) =\n  2 *\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n}\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int (2 * \\<lfloor>real (n div 2) / real d\\<rfloor> + 1)) =\n  2 *\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n}\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = 2 * (\\<Sum>d=1..2*?k+?d. mangoldt d * \\<lfloor>(n div 2) / d\\<rfloor>) + (\\<Sum>d=1..n. mangoldt d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 *\n    (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n    sum mangoldt {1..n} =\n    2 *\n    (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n    sum mangoldt {1..n}", "by presburger"], ["proof (state)\nthis:\n  2 *\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n} =\n  2 *\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n}\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  2 *\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n} =\n  2 *\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n}\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "from sum_eq"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "have \"\\<dots> = 2 * (\\<Sum>d=1..?k. mangoldt d * \\<lfloor>(n div 2) / d\\<rfloor>) + (\\<Sum>d=1..n. mangoldt d)\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. 2 *\n    (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n    sum mangoldt {1..n} =\n    2 *\n    (\\<Sum>d = 1..n div 2.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n    sum mangoldt {1..n}", "by presburger"], ["proof (state)\nthis:\n  2 *\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n} =\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n}\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  2 *\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n} =\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n}\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "from ln_fact_conv_mangoldt psi_def"], ["proof (chain)\npicking this:\n  ln (fact ?n) =\n  (\\<Sum>d = 1..?n.\n      mangoldt d * real_of_int \\<lfloor>real ?n / real d\\<rfloor>)\n  psi ?n = sum mangoldt {1..?n}", "have \"\\<dots> = 2 * ln (fact ?k) + psi n\""], ["proof (prove)\nusing this:\n  ln (fact ?n) =\n  (\\<Sum>d = 1..?n.\n      mangoldt d * real_of_int \\<lfloor>real ?n / real d\\<rfloor>)\n  psi ?n = sum mangoldt {1..?n}\n\ngoal (1 subgoal):\n 1. 2 *\n    (\\<Sum>d = 1..n div 2.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n    sum mangoldt {1..n} =\n    2 * ln (fact (n div 2)) + psi n", "by presburger"], ["proof (state)\nthis:\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) +\n  sum mangoldt {1..n} =\n  2 * ln (fact (n div 2)) + psi n\n\ngoal (2 subgoals):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n 2. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "finally"], ["proof (chain)\npicking this:\n  ln (fact n) \\<le> 2 * ln (fact (n div 2)) + psi n", "show \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\""], ["proof (prove)\nusing this:\n  ln (fact n) \\<le> 2 * ln (fact (n div 2)) + psi n\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n", "by simp"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "fix n::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "let ?k = \"n div 2\" and  ?d = \"n mod 2\""], ["proof (state)\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "from psi_def"], ["proof (chain)\npicking this:\n  psi ?n = sum mangoldt {1..?n}", "have \"psi n - psi ?k = (\\<Sum>d=1..2*?k+?d. mangoldt d) - (\\<Sum>d=1..?k. mangoldt d)\""], ["proof (prove)\nusing this:\n  psi ?n = sum mangoldt {1..?n}\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) =\n    sum mangoldt {1..2 * (n div 2) + n mod 2} - sum mangoldt {1..n div 2}", "by presburger"], ["proof (state)\nthis:\n  psi n - psi (n div 2) =\n  sum mangoldt {1..2 * (n div 2) + n mod 2} - sum mangoldt {1..n div 2}\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  psi n - psi (n div 2) =\n  sum mangoldt {1..2 * (n div 2) + n mod 2} - sum mangoldt {1..n div 2}\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = sum mangoldt ({1..2 * (n div 2) + n mod 2} - {1..n div 2})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum mangoldt {1..2 * (n div 2) + n mod 2} - sum mangoldt {1..n div 2} =\n    sum mangoldt ({1..2 * (n div 2) + n mod 2} - {1..n div 2})", "by (subst sum_diff) simp_all"], ["proof (state)\nthis:\n  sum mangoldt {1..2 * (n div 2) + n mod 2} - sum mangoldt {1..n div 2} =\n  sum mangoldt ({1..2 * (n div 2) + n mod 2} - {1..n div 2})\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  sum mangoldt {1..2 * (n div 2) + n mod 2} - sum mangoldt {1..n div 2} =\n  sum mangoldt ({1..2 * (n div 2) + n mod 2} - {1..n div 2})\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d\\<in>({1..2 * (n div 2) + n mod 2} - {1..n div 2}). \n                    (if d \\<le> ?k then 0 else mangoldt d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum mangoldt ({1..2 * (n div 2) + n mod 2} - {1..n div 2}) =\n    (\\<Sum>d\\<in>{1..2 * (n div 2) + n mod 2} - {1..n div 2}.\n       if d \\<le> n div 2 then 0 else mangoldt d)", "by (intro sum.cong) simp_all"], ["proof (state)\nthis:\n  sum mangoldt ({1..2 * (n div 2) + n mod 2} - {1..n div 2}) =\n  (\\<Sum>d\\<in>{1..2 * (n div 2) + n mod 2} - {1..n div 2}.\n     if d \\<le> n div 2 then 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  sum mangoldt ({1..2 * (n div 2) + n mod 2} - {1..n div 2}) =\n  (\\<Sum>d\\<in>{1..2 * (n div 2) + n mod 2} - {1..n div 2}.\n     if d \\<le> n div 2 then 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d=1..2*?k+?d. (if d \\<le> ?k then 0 else mangoldt d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d\\<in>{1..2 * (n div 2) + n mod 2} - {1..n div 2}.\n       if d \\<le> n div 2 then 0 else mangoldt d) =\n    (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n        if d \\<le> n div 2 then 0 else mangoldt d)", "by (intro sum.mono_neutral_left) auto"], ["proof (state)\nthis:\n  (\\<Sum>d\\<in>{1..2 * (n div 2) + n mod 2} - {1..n div 2}.\n     if d \\<le> n div 2 then 0 else mangoldt d) =\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      if d \\<le> n div 2 then 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d\\<in>{1..2 * (n div 2) + n mod 2} - {1..n div 2}.\n     if d \\<le> n div 2 then 0 else mangoldt d) =\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      if d \\<le> n div 2 then 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d=1..n. (if d \\<le> ?k then 0 else mangoldt d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n        if d \\<le> n div 2 then 0 else mangoldt d) =\n    (\\<Sum>d = 1..n. if d \\<le> n div 2 then 0 else mangoldt d)", "by presburger"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      if d \\<le> n div 2 then 0 else mangoldt d) =\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2) + n mod 2.\n      if d \\<le> n div 2 then 0 else mangoldt d) =\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d=1..n. (if d \\<le> ?k then mangoldt d * 0 else mangoldt d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. if d \\<le> n div 2 then 0 else mangoldt d) =\n    (\\<Sum>d = 1..n. if d \\<le> n div 2 then mangoldt d * 0 else mangoldt d)", "by (intro sum.cong) simp_all"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then 0 else mangoldt d) =\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then mangoldt d * 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then 0 else mangoldt d) =\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then mangoldt d * 0 else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "from div_2_mult_2_bds(1)"], ["proof (chain)\npicking this:\n  0 < ?d \\<Longrightarrow>\n  0 \\<le> \\<lfloor>real ?n / real ?d\\<rfloor> -\n          2 * \\<lfloor>real (?n div 2) / real ?d\\<rfloor>", "have \"\\<dots> \\<le> (\\<Sum>d=1..n. (if d \\<le> ?k then mangoldt d * (\\<lfloor>n/d\\<rfloor> - 2 * \\<lfloor>?k/d\\<rfloor>) else mangoldt d))\""], ["proof (prove)\nusing this:\n  0 < ?d \\<Longrightarrow>\n  0 \\<le> \\<lfloor>real ?n / real ?d\\<rfloor> -\n          2 * \\<lfloor>real (?n div 2) / real ?d\\<rfloor>\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. if d \\<le> n div 2 then mangoldt d * 0 else mangoldt d)\n    \\<le> (\\<Sum>d = 1..n.\n              if d \\<le> n div 2\n              then mangoldt d *\n                   real_of_int\n                    (\\<lfloor>real n / real d\\<rfloor> -\n                     2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n              else mangoldt d)", "by (intro sum_mono) \n       (auto simp: algebra_simps mangoldt_nonneg intro!: mult_left_mono simp del: of_int_mult)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then mangoldt d * 0 else mangoldt d)\n  \\<le> (\\<Sum>d = 1..n.\n            if d \\<le> n div 2\n            then mangoldt d *\n                 real_of_int\n                  (\\<lfloor>real n / real d\\<rfloor> -\n                   2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n            else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. if d \\<le> n div 2 then mangoldt d * 0 else mangoldt d)\n  \\<le> (\\<Sum>d = 1..n.\n            if d \\<le> n div 2\n            then mangoldt d *\n                 real_of_int\n                  (\\<lfloor>real n / real d\\<rfloor> -\n                   2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n            else mangoldt d)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "from n_div_d_eq_1"], ["proof (chain)\npicking this:\n  ?d \\<in> {?n div 2 + 1..?n} \\<Longrightarrow>\n  \\<lfloor>real ?n / real ?d\\<rfloor> = 1", "have \"\\<dots> = (\\<Sum>d=1..n. (if d \\<le> ?k then mangoldt d * (\\<lfloor>n/d\\<rfloor> - 2 * \\<lfloor>?k/d\\<rfloor>) else mangoldt d * \\<lfloor>n/d\\<rfloor>))\""], ["proof (prove)\nusing this:\n  ?d \\<in> {?n div 2 + 1..?n} \\<Longrightarrow>\n  \\<lfloor>real ?n / real ?d\\<rfloor> = 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        if d \\<le> n div 2\n        then mangoldt d *\n             real_of_int\n              (\\<lfloor>real n / real d\\<rfloor> -\n               2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n        else mangoldt d) =\n    (\\<Sum>d = 1..n.\n        if d \\<le> n div 2\n        then mangoldt d *\n             real_of_int\n              (\\<lfloor>real n / real d\\<rfloor> -\n               2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n        else mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)", "by (intro sum.cong refl) auto"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then mangoldt d *\n           real_of_int\n            (\\<lfloor>real n / real d\\<rfloor> -\n             2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n      else mangoldt d) =\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then mangoldt d *\n           real_of_int\n            (\\<lfloor>real n / real d\\<rfloor> -\n             2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n      else mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then mangoldt d *\n           real_of_int\n            (\\<lfloor>real n / real d\\<rfloor> -\n             2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n      else mangoldt d) =\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then mangoldt d *\n           real_of_int\n            (\\<lfloor>real n / real d\\<rfloor> -\n             2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n      else mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d=1..n. mangoldt d * real_of_int (\\<lfloor>real n / real d\\<rfloor>) -\n                     (if d \\<le> ?k then 2 * mangoldt d * real_of_int \\<lfloor>real ?k / real d\\<rfloor> else 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        if d \\<le> n div 2\n        then mangoldt d *\n             real_of_int\n              (\\<lfloor>real n / real d\\<rfloor> -\n               2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n        else mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n        (if d \\<le> n div 2\n         then 2 * mangoldt d *\n              real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n         else 0))", "by (intro sum.cong refl) (auto simp: algebra_simps)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then mangoldt d *\n           real_of_int\n            (\\<lfloor>real n / real d\\<rfloor> -\n             2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n      else mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      (if d \\<le> n div 2\n       then 2 * mangoldt d *\n            real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n       else 0))\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then mangoldt d *\n           real_of_int\n            (\\<lfloor>real n / real d\\<rfloor> -\n             2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)\n      else mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      (if d \\<le> n div 2\n       then 2 * mangoldt d *\n            real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n       else 0))\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d=1..n. mangoldt d * real_of_int (\\<lfloor>real n / real d\\<rfloor>)) - \n                  (\\<Sum>d=1..n. (if d \\<le> ?k then 2 * mangoldt d * real_of_int \\<lfloor>real ?k / real d\\<rfloor> else 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n        (if d \\<le> n div 2\n         then 2 * mangoldt d *\n              real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n         else 0)) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n    (\\<Sum>d = 1..n.\n        if d \\<le> n div 2\n        then 2 * mangoldt d *\n             real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n        else 0)", "by (rule sum_subtractf)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      (if d \\<le> n div 2\n       then 2 * mangoldt d *\n            real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n       else 0)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      (if d \\<le> n div 2\n       then 2 * mangoldt d *\n            real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n       else 0)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"(\\<Sum>d=1..n. (if d \\<le> ?k then 2 * mangoldt d * real_of_int \\<lfloor>real ?k / real d\\<rfloor> else 0)) =\n               (\\<Sum>d=1..?k. (if d \\<le> ?k then 2 * mangoldt d * real_of_int \\<lfloor>real ?k / real d\\<rfloor> else 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        if d \\<le> n div 2\n        then 2 * mangoldt d *\n             real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n        else 0) =\n    (\\<Sum>d = 1..n div 2.\n        if d \\<le> n div 2\n        then 2 * mangoldt d *\n             real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n        else 0)", "by (intro sum.mono_neutral_right) auto"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0) =\n  (\\<Sum>d = 1..n div 2.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0) =\n  (\\<Sum>d = 1..n div 2.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = (\\<Sum>d=1..?k. 2 * mangoldt d * real_of_int \\<lfloor>real ?k / real d\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n div 2.\n        if d \\<le> n div 2\n        then 2 * mangoldt d *\n             real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n        else 0) =\n    (\\<Sum>d = 1..n div 2.\n        2 * mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "by (intro sum.cong) simp_all"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n div 2.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0) =\n  (\\<Sum>d = 1..n div 2.\n      2 * mangoldt d *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n div 2.\n      if d \\<le> n div 2\n      then 2 * mangoldt d *\n           real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>\n      else 0) =\n  (\\<Sum>d = 1..n div 2.\n      2 * mangoldt d *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"\\<dots> = 2 * (\\<Sum>d=1..?k. mangoldt d * real_of_int \\<lfloor>real ?k / real d\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n div 2.\n        2 * mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n    2 *\n    (\\<Sum>d = 1..n div 2.\n        mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "by (simp add: sum_distrib_left mult_ac)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n div 2.\n      2 * mangoldt d *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n div 2.\n      2 * mangoldt d *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"(\\<Sum>d = 1..n. mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) - \\<dots> = \n               ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n    2 *\n    (\\<Sum>d = 1..n div 2.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n    ln (fact n) - 2 * ln (fact (n div 2))", "by (simp add: ln_fact_conv_mangoldt)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "finally"], ["proof (chain)\npicking this:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "show \"psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\nusing this:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "."], ["proof (state)\nthis:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "lemma psi_bounds_induct:\n  \"real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\"\n  \"psi n - psi (n div 2) \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3)\n    \\<le> psi n &&&\n    psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n 2. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "from le_imp_neg_le[OF ln_fact_diff_bounds]"], ["proof (chain)\npicking this:\n  - (4 * ln (real (if ?n1 = 0 then 1 else ?n1)) + 3)\n  \\<le> - \\<bar>ln (fact ?n1) - 2 * ln (fact (?n1 div 2)) -\n                real ?n1 * ln 2\\<bar>", "have \"n * ln 2 - (4 * ln (if n = 0 then 1 else n) + 3)\n         \\<le> n * ln 2 - abs(ln (fact n) - 2 * ln (fact (n div 2)) - n * ln 2)\""], ["proof (prove)\nusing this:\n  - (4 * ln (real (if ?n1 = 0 then 1 else ?n1)) + 3)\n  \\<le> - \\<bar>ln (fact ?n1) - 2 * ln (fact (?n1 div 2)) -\n                real ?n1 * ln 2\\<bar>\n\ngoal (1 subgoal):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3)\n    \\<le> real n * ln 2 -\n          \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>", "by simp"], ["proof (state)\nthis:\n  real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3)\n  \\<le> real n * ln 2 -\n        \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n\ngoal (2 subgoals):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n 2. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "also"], ["proof (state)\nthis:\n  real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3)\n  \\<le> real n * ln 2 -\n        \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n\ngoal (2 subgoals):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n 2. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "have \"\\<dots> \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * ln 2 -\n    \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "by simp"], ["proof (state)\nthis:\n  real n * ln 2 -\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (2 subgoals):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n 2. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "also"], ["proof (state)\nthis:\n  real n * ln 2 -\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (2 subgoals):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n 2. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "from psi_bounds_ln_fact (1)"], ["proof (chain)\npicking this:\n  ln (fact ?n) - 2 * ln (fact (?n div 2)) \\<le> psi ?n", "have \"\\<dots> \\<le> psi n\""], ["proof (prove)\nusing this:\n  ln (fact ?n) - 2 * ln (fact (?n div 2)) \\<le> psi ?n\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n", "by simp"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n\n\ngoal (2 subgoals):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n 2. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "finally"], ["proof (chain)\npicking this:\n  real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n", "show \"real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\""], ["proof (prove)\nusing this:\n  real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n\ngoal (1 subgoal):\n 1. real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n", "."], ["proof (state)\nthis:\n  real n * ln 2 - (4 * ln (real (if n = 0 then 1 else n)) + 3) \\<le> psi n\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "from psi_bounds_ln_fact (2)"], ["proof (chain)\npicking this:\n  psi ?n - psi (?n div 2) \\<le> ln (fact ?n) - 2 * ln (fact (?n div 2))", "have \"psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\nusing this:\n  psi ?n - psi (?n div 2) \\<le> ln (fact ?n) - 2 * ln (fact (?n div 2))\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "."], ["proof (state)\nthis:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "also"], ["proof (state)\nthis:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "have \"\\<dots> \\<le> n * ln 2 + abs(ln (fact n) - 2 * ln (fact (n div 2)) - n * ln 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> real n * ln 2 +\n          \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>", "by simp"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> real n * ln 2 +\n        \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "also"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> real n * ln 2 +\n        \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "from ln_fact_diff_bounds [of n]"], ["proof (chain)\npicking this:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "have \"abs(ln (fact n) - 2 * ln (fact (n div 2)) - n * ln 2)\n            \\<le> (4 * ln (real (if n = 0 then 1 else n)) + 3)\""], ["proof (prove)\nusing this:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "by simp"], ["proof (state)\nthis:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + x \\<le> real n * ln 2 + y) \\<Longrightarrow>\n  psi n - psi (n div 2)\n  \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "show \"psi n - psi (n div 2) \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + x \\<le> real n * ln 2 + y) \\<Longrightarrow>\n  psi n - psi (n div 2)\n  \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "by simp"], ["proof (state)\nthis:\n  psi n - psi (n div 2)\n  \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Bounding the psi function\\<close>"], ["", "text \\<open>\n  In this section, we will first prove the relatively tight estimate\n  @{prop \"psi n \\<le> 3 / 2 + ln 2 * n\"} for @{term \"n \\<le> 128\"} and then use the \n  recurrence we have just derived to extend it to @{prop \"psi n \\<le> 551 / 256\"} for \n  @{term \"n \\<le> 1024\"}, at which point applying the recurrence can be used to prove \n  the same bound for arbitrarily big numbers.\n\n  First of all, we will prove the bound for @{term \"n <= 128\"} using reflection and\n  approximation.\n\\<close>"], ["", "context\nbegin"], ["", "private"], ["", "lemma Ball_insertD:\n  assumes \"\\<forall>x\\<in>insert y A. P x\"\n  shows   \"P y\" \"\\<forall>x\\<in>A. P x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P y &&& \\<forall>x\\<in>A. P x", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>insert y A. P x\n\ngoal (1 subgoal):\n 1. P y &&& \\<forall>x\\<in>A. P x", "by auto"], ["", "private"], ["", "lemma meta_eq_TrueE: \"PROP A \\<equiv> Trueprop True \\<Longrightarrow> PROP A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. PROP A \\<equiv> True \\<Longrightarrow> PROP A", "by simp"], ["", "private"], ["", "lemma pre_mangoldt_pos: \"pre_mangoldt n > 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < pre_mangoldt n", "unfolding pre_mangoldt_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < (if primepow n then aprimedivisor n else 1)", "by (auto simp: primepow_gt_Suc_0)"], ["", "private"], ["", "lemma psi_conv_pre_mangoldt: \"psi n = ln (real (prod pre_mangoldt {1..n}))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n = ln (real (prod pre_mangoldt {1..n}))", "by (auto simp: psi_def mangoldt_def pre_mangoldt_def ln_prod primepow_gt_Suc_0 intro!: sum.cong)"], ["", "private"], ["", "lemma eval_psi_aux1: \"psi 0 = ln (real (numeral Num.One))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi 0 = ln (real Numeral1)", "by (simp add: psi_def)"], ["", "private"], ["", "lemma eval_psi_aux2:\n  assumes \"psi m = ln (real (numeral x))\" \"pre_mangoldt n = y\" \"m + 1 = n\" \"numeral x * y = z\"\n  shows   \"psi n = ln (real z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "from assms(2) [symmetric]"], ["proof (chain)\npicking this:\n  y = pre_mangoldt n", "have [simp]: \"y > 0\""], ["proof (prove)\nusing this:\n  y = pre_mangoldt n\n\ngoal (1 subgoal):\n 1. 0 < y", "by (simp add: pre_mangoldt_pos)"], ["proof (state)\nthis:\n  0 < y\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "have \"psi n = psi (Suc m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n = psi (Suc m)", "by (simp add: assms(3) [symmetric])"], ["proof (state)\nthis:\n  psi n = psi (Suc m)\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "also"], ["proof (state)\nthis:\n  psi n = psi (Suc m)\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "have \"\\<dots> = ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi (Suc m) = ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x)))", "using assms(2,3) [symmetric]"], ["proof (prove)\nusing this:\n  y = pre_mangoldt n\n  n = m + 1\n\ngoal (1 subgoal):\n 1. psi (Suc m) = ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x)))", "by (simp add: psi_conv_pre_mangoldt prod.nat_ivl_Suc' mult_ac)"], ["proof (state)\nthis:\n  psi (Suc m) = ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x)))\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "also"], ["proof (state)\nthis:\n  psi (Suc m) = ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x)))\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "have \"\\<dots> = ln (real y) + psi m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x))) =\n    ln (real y) + psi m", "by (subst ln_mult) (simp_all add: pre_mangoldt_pos prod_pos psi_conv_pre_mangoldt)"], ["proof (state)\nthis:\n  ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x))) =\n  ln (real y) + psi m\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "also"], ["proof (state)\nthis:\n  ln (real y * (\\<Prod>x = Suc 0..m. real (pre_mangoldt x))) =\n  ln (real y) + psi m\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "have \"psi m = ln (real (numeral x))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi m = ln (real (numeral x))", "by fact"], ["proof (state)\nthis:\n  psi m = ln (real (numeral x))\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "also"], ["proof (state)\nthis:\n  psi m = ln (real (numeral x))\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "have \"ln (real y) + \\<dots> = ln (real (numeral x * y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (real y) + ln (real (numeral x)) = ln (real (numeral x * y))", "by (simp add: ln_mult)"], ["proof (state)\nthis:\n  ln (real y) + ln (real (numeral x)) = ln (real (numeral x * y))\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "finally"], ["proof (chain)\npicking this:\n  psi n = ln (real (numeral x * y))", "show ?thesis"], ["proof (prove)\nusing this:\n  psi n = ln (real (numeral x * y))\n\ngoal (1 subgoal):\n 1. psi n = ln (real z)", "by (simp add: assms(4) [symmetric])"], ["proof (state)\nthis:\n  psi n = ln (real z)\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma Ball_atLeast0AtMost_doubleton:\n  assumes \"psi 0 \\<le> 3 / 2 * ln 2 * real 0\"\n  assumes \"psi 1 \\<le> 3 / 2 * ln 2 * real 1\"\n  shows   \"(\\<forall>x\\<in>{0..1}. psi x \\<le> 3 / 2 * ln 2 * real x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{0..1}. psi x \\<le> 3 / 2 * ln 2 * real x", "using assms"], ["proof (prove)\nusing this:\n  psi 0 \\<le> 3 / 2 * ln 2 * real 0\n  psi 1 \\<le> 3 / 2 * ln 2 * real 1\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{0..1}. psi x \\<le> 3 / 2 * ln 2 * real x", "unfolding One_nat_def atLeast0_atMost_Suc ball_simps"], ["proof (prove)\nusing this:\n  psi 0 \\<le> 3 / 2 * ln 2 * real 0\n  psi (Suc 0) \\<le> 3 / 2 * ln 2 * real (Suc 0)\n\ngoal (1 subgoal):\n 1. psi (Suc 0) \\<le> 3 / 2 * ln 2 * real (Suc 0) \\<and>\n    (\\<forall>x\\<in>{0..0}. psi x \\<le> 3 / 2 * ln 2 * real x)", "by auto"], ["", "private"], ["", "lemma Ball_atLeast0AtMost_insert:\n  assumes \"(\\<forall>x\\<in>{0..m}. psi x \\<le> 3 / 2 * ln 2 * real x)\"\n  assumes \"psi (numeral n) \\<le> 3 / 2 * ln 2 * real (numeral n)\" \"m = pred_numeral n\"\n  shows   \"(\\<forall>x\\<in>{0..numeral n}. psi x \\<le> 3 / 2 * ln 2 * real x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{0..numeral n}. psi x \\<le> 3 / 2 * ln 2 * real x", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{0..m}. psi x \\<le> 3 / 2 * ln 2 * real x\n  psi (numeral n) \\<le> 3 / 2 * ln 2 * real (numeral n)\n  m = pred_numeral n\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{0..numeral n}. psi x \\<le> 3 / 2 * ln 2 * real x", "by (subst numeral_eq_Suc[of n], subst atLeast0_atMost_Suc,\n      subst ball_simps, simp only: numeral_eq_Suc [symmetric])"], ["", "private"], ["", "lemma eval_psi_ineq_aux:\n  assumes \"psi n = x\" \"x \\<le> 3 / 2 * ln 2 * n\"\n  shows   \"psi n \\<le> 3 / 2 * ln 2 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * ln 2 * real n", "using assms"], ["proof (prove)\nusing this:\n  psi n = x\n  x \\<le> 3 / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * ln 2 * real n", "by simp_all"], ["", "private"], ["", "lemma eval_psi_ineq_aux2:\n  assumes \"numeral m ^ 2 \\<le> (2::nat) ^ (3 * n)\"\n  shows   \"ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "have \"ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n \\<longleftrightarrow> \n          2 * log 2 (real (numeral m)) \\<le> 3 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n) =\n    (2 * log 2 (real (numeral m)) \\<le> 3 * real n)", "by (simp add: field_simps log_def)"], ["proof (state)\nthis:\n  (ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n) =\n  (2 * log 2 (real (numeral m)) \\<le> 3 * real n)\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "also"], ["proof (state)\nthis:\n  (ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n) =\n  (2 * log 2 (real (numeral m)) \\<le> 3 * real n)\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "have \"2 * log 2 (real (numeral m)) = log 2 (real (numeral m ^ 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 * log 2 (real (numeral m)) = log 2 (real ((numeral m)\\<^sup>2))", "by (subst of_nat_power, subst log_nat_power) simp_all"], ["proof (state)\nthis:\n  2 * log 2 (real (numeral m)) = log 2 (real ((numeral m)\\<^sup>2))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "also"], ["proof (state)\nthis:\n  2 * log 2 (real (numeral m)) = log 2 (real ((numeral m)\\<^sup>2))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "have \"\\<dots> \\<le> 3 * real n \\<longleftrightarrow> real ((numeral m) ^ 2) \\<le> 2 powr real (3 * n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (log 2 (real ((numeral m)\\<^sup>2)) \\<le> 3 * real n) =\n    (real ((numeral m)\\<^sup>2) \\<le> 2 powr real (3 * n))", "by (subst Transcendental.log_le_iff) simp_all"], ["proof (state)\nthis:\n  (log 2 (real ((numeral m)\\<^sup>2)) \\<le> 3 * real n) =\n  (real ((numeral m)\\<^sup>2) \\<le> 2 powr real (3 * n))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "also"], ["proof (state)\nthis:\n  (log 2 (real ((numeral m)\\<^sup>2)) \\<le> 3 * real n) =\n  (real ((numeral m)\\<^sup>2) \\<le> 2 powr real (3 * n))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "have \"2 powr (3 * n) = real (2 ^ (3 * n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 powr real (3 * n) = real (2 ^ (3 * n))", "by (simp add: powr_realpow [symmetric])"], ["proof (state)\nthis:\n  2 powr real (3 * n) = real (2 ^ (3 * n))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "also"], ["proof (state)\nthis:\n  2 powr real (3 * n) = real (2 ^ (3 * n))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "have \"real ((numeral m) ^ 2) \\<le> \\<dots> \\<longleftrightarrow> numeral m ^ 2 \\<le> (2::nat) ^ (3 * n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (real ((numeral m)\\<^sup>2) \\<le> real (2 ^ (3 * n))) =\n    ((numeral m)\\<^sup>2 \\<le> 2 ^ (3 * n))", "by (rule of_nat_le_iff)"], ["proof (state)\nthis:\n  (real ((numeral m)\\<^sup>2) \\<le> real (2 ^ (3 * n))) =\n  ((numeral m)\\<^sup>2 \\<le> 2 ^ (3 * n))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "finally"], ["proof (chain)\npicking this:\n  (ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n) =\n  ((numeral m)\\<^sup>2 \\<le> 2 ^ (3 * n))", "show ?thesis"], ["proof (prove)\nusing this:\n  (ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n) =\n  ((numeral m)\\<^sup>2 \\<le> 2 ^ (3 * n))\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "using assms"], ["proof (prove)\nusing this:\n  (ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n) =\n  ((numeral m)\\<^sup>2 \\<le> 2 ^ (3 * n))\n  (numeral m)\\<^sup>2 \\<le> 2 ^ (3 * n)\n\ngoal (1 subgoal):\n 1. ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n", "by blast"], ["proof (state)\nthis:\n  ln (real (numeral m)) \\<le> 3 / 2 * ln 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma eval_psi_ineq_aux_mono:\n  assumes \"psi n = x\" \"psi m = x\" \"psi n \\<le> 3 / 2 * ln 2 * n\" \"n \\<le> m\"\n  shows   \"psi m \\<le> 3 / 2 * ln 2 * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "from assms"], ["proof (chain)\npicking this:\n  psi n = x\n  psi m = x\n  psi n \\<le> 3 / 2 * ln 2 * real n\n  n \\<le> m", "have \"psi m = psi n\""], ["proof (prove)\nusing this:\n  psi n = x\n  psi m = x\n  psi n \\<le> 3 / 2 * ln 2 * real n\n  n \\<le> m\n\ngoal (1 subgoal):\n 1. psi m = psi n", "by simp"], ["proof (state)\nthis:\n  psi m = psi n\n\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "also"], ["proof (state)\nthis:\n  psi m = psi n\n\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "have \"\\<dots> \\<le> 3 / 2 * ln 2 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * ln 2 * real n", "by fact"], ["proof (state)\nthis:\n  psi n \\<le> 3 / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "also"], ["proof (state)\nthis:\n  psi n \\<le> 3 / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "from \\<open>n \\<le> m\\<close>"], ["proof (chain)\npicking this:\n  n \\<le> m", "have \"\\<dots> \\<le> 3 / 2 * ln 2 * m\""], ["proof (prove)\nusing this:\n  n \\<le> m\n\ngoal (1 subgoal):\n 1. 3 / 2 * ln 2 * real n \\<le> 3 / 2 * ln 2 * real m", "by simp"], ["proof (state)\nthis:\n  3 / 2 * ln 2 * real n \\<le> 3 / 2 * ln 2 * real m\n\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "finally"], ["proof (chain)\npicking this:\n  psi m \\<le> 3 / 2 * ln 2 * real m", "show ?thesis"], ["proof (prove)\nusing this:\n  psi m \\<le> 3 / 2 * ln 2 * real m\n\ngoal (1 subgoal):\n 1. psi m \\<le> 3 / 2 * ln 2 * real m", "."], ["proof (state)\nthis:\n  psi m \\<le> 3 / 2 * ln 2 * real m\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma not_primepow_1_nat: \"\\<not>primepow (1 :: nat)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> primepow 1", "by auto"], ["", "ML_file \\<open>bertrand.ML\\<close>"], ["", "(* This should not take more than 1 minute *)"], ["", "local_setup \\<open>fn ctxt =>\nlet\n  fun tac {context = ctxt, ...} =\n    let\n      val psi_cache = Bertrand.prove_psi ctxt 129\n      fun prove_psi_ineqs ctxt =\n        let\n          fun tac {context = ctxt, ...} = \n            HEADGOAL (resolve_tac ctxt @{thms eval_psi_ineq_aux2} THEN' Simplifier.simp_tac ctxt)\n          fun prove_by_approx n thm =\n            let\n              val thm = thm RS @{thm eval_psi_ineq_aux}\n              val [prem] = Thm.prems_of thm\n              val prem = Goal.prove ctxt [] [] prem tac\n            in\n              prem RS thm\n            end\n          fun prove_by_mono last_thm last_thm' thm =\n            let\n              val thm = @{thm eval_psi_ineq_aux_mono} OF [last_thm, thm, last_thm']\n              val [prem] = Thm.prems_of thm\n              val prem = Goal.prove ctxt [] [] prem (K (HEADGOAL (Simplifier.simp_tac ctxt)))\n            in\n              prem RS thm\n            end\n          fun go _ acc [] = acc\n            | go last acc ((n, x, thm) :: xs) =\n                let\n                  val thm' =\n                    case last of\n                      NONE => prove_by_approx n thm\n                    | SOME (last_x, last_thm, last_thm') => \n                        if last_x = x then \n                          prove_by_mono last_thm last_thm' thm \n                        else\n                          prove_by_approx n thm\n                in\n                  go (SOME (x, thm, thm')) (thm' :: acc) xs\n                end\n        in\n          rev o go NONE []\n        end\n            \n      val psi_ineqs = prove_psi_ineqs ctxt psi_cache\n      fun prove_ball ctxt (thm1 :: thm2 :: thms) =\n            let\n              val thm = @{thm Ball_atLeast0AtMost_doubleton} OF [thm1, thm2]\n              fun solve_prem thm =\n                let\n                  fun tac {context = ctxt, ...} = HEADGOAL (Simplifier.simp_tac ctxt)\n                  val thm' = Goal.prove ctxt [] [] (Thm.cprem_of thm 1 |> Thm.term_of) tac\n                in\n                  thm' RS thm\n                end\n              fun go thm thm' = (@{thm Ball_atLeast0AtMost_insert} OF [thm', thm]) |> solve_prem\n            in\n              fold go thms thm\n            end\n        | prove_ball _ _ = raise Match\n    in\n      HEADGOAL (resolve_tac ctxt [prove_ball ctxt psi_ineqs])\n    end\n  val thm = Goal.prove @{context} [] [] @{prop \"\\<forall>n\\<in>{0..128}. psi n \\<le> 3 / 2 * ln 2 * n\"} tac\nin\n  Local_Theory.note ((@{binding psi_ubound_log_128}, []), [thm]) ctxt |> snd\nend\n\\<close>"], ["", "end"], ["", "context\nbegin"], ["", "private"], ["", "lemma psi_ubound_aux:\n  defines \"f \\<equiv> \\<lambda>x::real. (4 * ln x + 3) / (ln 2 * x)\"\n  assumes \"x \\<ge> 2\" \"x \\<le> y\"\n  shows   \"f x \\<ge> f y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f y \\<le> f x", "using assms(3)"], ["proof (prove)\nusing this:\n  x \\<le> y\n\ngoal (1 subgoal):\n 1. f y \\<le> f x", "proof (rule DERIV_nonpos_imp_nonincreasing, goal_cases)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "case (1 t)"], ["proof (state)\nthis:\n  x \\<le> t\n  t \\<le> y\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "define f' where \"f' = (\\<lambda>x. (1 - 4 * ln x) / x^2 / ln 2 :: real)\""], ["proof (state)\nthis:\n  f' = (\\<lambda>x. (1 - 4 * ln x) / x\\<^sup>2 / ln 2)\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "from 1 assms(2)"], ["proof (chain)\npicking this:\n  x \\<le> t\n  t \\<le> y\n  2 \\<le> x", "have \"(f has_real_derivative f' t) (at t)\""], ["proof (prove)\nusing this:\n  x \\<le> t\n  t \\<le> y\n  2 \\<le> x\n\ngoal (1 subgoal):\n 1. (f has_real_derivative f' t) (at t)", "unfolding f_def f'_def"], ["proof (prove)\nusing this:\n  x \\<le> t\n  t \\<le> y\n  2 \\<le> x\n\ngoal (1 subgoal):\n 1. ((\\<lambda>x. (4 * ln x + 3) / (ln 2 * x)) has_real_derivative\n     (1 - 4 * ln t) / t\\<^sup>2 / ln 2)\n     (at t)", "by (auto intro!: derivative_eq_intros simp: field_simps power2_eq_square)"], ["proof (state)\nthis:\n  (f has_real_derivative f' t) (at t)\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "moreover"], ["proof (state)\nthis:\n  (f has_real_derivative f' t) (at t)\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "{"], ["proof (state)\nthis:\n  (f has_real_derivative f' t) (at t)\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "from ln_2_ge"], ["proof (chain)\npicking this:\n  5677 / 8192 \\<le> ln 2", "have \"1/4 \\<le> ln (2::real)\""], ["proof (prove)\nusing this:\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 1 / 4 \\<le> ln 2", "by simp"], ["proof (state)\nthis:\n  1 / 4 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "also"], ["proof (state)\nthis:\n  1 / 4 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "from assms(2) 1"], ["proof (chain)\npicking this:\n  2 \\<le> x\n  x \\<le> t\n  t \\<le> y", "have \"\\<dots> \\<le> ln t\""], ["proof (prove)\nusing this:\n  2 \\<le> x\n  x \\<le> t\n  t \\<le> y\n\ngoal (1 subgoal):\n 1. ln 2 \\<le> ln t", "by simp"], ["proof (state)\nthis:\n  ln 2 \\<le> ln t\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "finally"], ["proof (chain)\npicking this:\n  1 / 4 \\<le> ln t", "have \"ln t \\<ge> 1/4\""], ["proof (prove)\nusing this:\n  1 / 4 \\<le> ln t\n\ngoal (1 subgoal):\n 1. 1 / 4 \\<le> ln t", "."], ["proof (state)\nthis:\n  1 / 4 \\<le> ln t\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "}"], ["proof (state)\nthis:\n  1 / 4 \\<le> ln t\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "with 1 assms(2)"], ["proof (chain)\npicking this:\n  x \\<le> t\n  t \\<le> y\n  2 \\<le> x\n  1 / 4 \\<le> ln t", "have \"f' t \\<le> 0\""], ["proof (prove)\nusing this:\n  x \\<le> t\n  t \\<le> y\n  2 \\<le> x\n  1 / 4 \\<le> ln t\n\ngoal (1 subgoal):\n 1. f' t \\<le> 0", "by (simp add: f'_def field_simps)"], ["proof (state)\nthis:\n  f' t \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<le> xa; xa \\<le> y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (f has_real_derivative y) (at xa) \\<and>\n                            y \\<le> 0", "ultimately"], ["proof (chain)\npicking this:\n  (f has_real_derivative f' t) (at t)\n  f' t \\<le> 0", "show ?case"], ["proof (prove)\nusing this:\n  (f has_real_derivative f' t) (at t)\n  f' t \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<exists>y. (f has_real_derivative y) (at t) \\<and> y \\<le> 0", "by (intro exI[of _ \"f' t\"]) simp_all"], ["proof (state)\nthis:\n  \\<exists>y. (f has_real_derivative y) (at t) \\<and> y \\<le> 0\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\n  These next rules are used in combination with @{thm psi_bounds_induct} and \n  @{thm psi_ubound_log_128} to extend the upper bound for @{term \"psi\"} from values no greater \n  than 128 to values no greater than 1024. The constant factor of the upper bound changes every \n  time, but once we have reached 1024, the recurrence is self-sustaining in the sense that we do \n  not have to adjust the constant factor anymore in order to double the range.\n\\<close>"], ["", "lemma psi_ubound_log_double_cases':\n  assumes \"\\<And>n. n \\<le> m \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\" \"n \\<le> m'\" \"m' = 2*m\"\n          \"c \\<le> c'\" \"c \\<ge> 0\" \"m \\<ge> 1\" \"c' \\<ge> 1 + c/2 + (4 * ln (m+1) + 3) / (ln 2 * (m+1))\"\n  shows   \"psi n \\<le> c' * ln 2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> c' * ln 2 * real n", "proof (cases \"n > m\")"], ["proof (state)\ngoal (2 subgoals):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n\n 2. \\<not> m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "case False"], ["proof (state)\nthis:\n  \\<not> m < n\n\ngoal (2 subgoals):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n\n 2. \\<not> m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "hence \"psi n \\<le> c * ln 2 * real n\""], ["proof (prove)\nusing this:\n  \\<not> m < n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "by (intro assms) simp_all"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal (2 subgoals):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n\n 2. \\<not> m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal (2 subgoals):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n\n 2. \\<not> m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "have \"c \\<le> c'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c \\<le> c'", "by fact"], ["proof (state)\nthis:\n  c \\<le> c'\n\ngoal (2 subgoals):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n\n 2. \\<not> m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x * ln 2 * real n \\<le> y * ln 2 * real n) \\<Longrightarrow>\n  psi n \\<le> c' * ln 2 * real n", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x * ln 2 * real n \\<le> y * ln 2 * real n) \\<Longrightarrow>\n  psi n \\<le> c' * ln 2 * real n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c' * ln 2 * real n", "by - (simp_all add: mult_right_mono)"], ["proof (state)\nthis:\n  psi n \\<le> c' * ln 2 * real n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "case True"], ["proof (state)\nthis:\n  m < n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "hence n: \"n \\<ge> m+1\""], ["proof (prove)\nusing this:\n  m < n\n\ngoal (1 subgoal):\n 1. m + 1 \\<le> n", "by simp"], ["proof (state)\nthis:\n  m + 1 \\<le> n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "from psi_bounds_induct(2)[of n] True"], ["proof (chain)\npicking this:\n  psi n - psi (n div 2)\n  \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\n  m < n", "have \"psi n \\<le> real n * ln 2 + 4 * ln (real n) + 3 + psi (n div 2)\""], ["proof (prove)\nusing this:\n  psi n - psi (n div 2)\n  \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\n  m < n\n\ngoal (1 subgoal):\n 1. psi n \\<le> real n * ln 2 + 4 * ln (real n) + 3 + psi (n div 2)", "by simp"], ["proof (state)\nthis:\n  psi n \\<le> real n * ln 2 + 4 * ln (real n) + 3 + psi (n div 2)\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  psi n \\<le> real n * ln 2 + 4 * ln (real n) + 3 + psi (n div 2)\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "from assms"], ["proof (chain)\npicking this:\n  ?n \\<le> m \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> m'\n  m' = 2 * m\n  c \\<le> c'\n  0 \\<le> c\n  1 \\<le> m\n  1 + c / 2 + (4 * ln (real m + 1) + 3) / (ln 2 * (real m + 1)) \\<le> c'", "have \"psi (n div 2) \\<le> c * ln 2 * real (n div 2)\""], ["proof (prove)\nusing this:\n  ?n \\<le> m \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> m'\n  m' = 2 * m\n  c \\<le> c'\n  0 \\<le> c\n  1 \\<le> m\n  1 + c / 2 + (4 * ln (real m + 1) + 3) / (ln 2 * (real m + 1)) \\<le> c'\n\ngoal (1 subgoal):\n 1. psi (n div 2) \\<le> c * ln 2 * real (n div 2)", "by (intro assms) simp_all"], ["proof (state)\nthis:\n  psi (n div 2) \\<le> c * ln 2 * real (n div 2)\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  psi (n div 2) \\<le> c * ln 2 * real (n div 2)\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "have \"real (n div 2) \\<le> real n / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n div 2) \\<le> real n / 2", "by simp"], ["proof (state)\nthis:\n  real (n div 2) \\<le> real n / 2\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  real (n div 2) \\<le> real n / 2\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "have \"c * ln 2 * \\<dots> = c / 2 * ln 2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c * ln 2 * (real n / 2) = c / 2 * ln 2 * real n", "by simp"], ["proof (state)\nthis:\n  c * ln 2 * (real n / 2) = c / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  c * ln 2 * (real n / 2) = c / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "have \"real n * ln 2 + 4 * ln (real n) + 3 + \\<dots> = \n               (1 + c/2) * ln 2 * real n + (4 * ln (real n) + 3)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * ln 2 + 4 * ln (real n) + 3 + c / 2 * ln 2 * real n =\n    (1 + c / 2) * ln 2 * real n + (4 * ln (real n) + 3)", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  real n * ln 2 + 4 * ln (real n) + 3 + c / 2 * ln 2 * real n =\n  (1 + c / 2) * ln 2 * real n + (4 * ln (real n) + 3)\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  real n * ln 2 + 4 * ln (real n) + 3 + c / 2 * ln 2 * real n =\n  (1 + c / 2) * ln 2 * real n + (4 * ln (real n) + 3)\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "{"], ["proof (state)\nthis:\n  real n * ln 2 + 4 * ln (real n) + 3 + c / 2 * ln 2 * real n =\n  (1 + c / 2) * ln 2 * real n + (4 * ln (real n) + 3)\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "have \"(4 * ln (real n) + 3) / (ln 2 * (real n)) \\<le> (4 * ln (m+1) + 3) / (ln 2 * (m+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (4 * ln (real n) + 3) / (ln 2 * real n)\n    \\<le> (4 * ln (real (m + 1)) + 3) / (ln 2 * real (m + 1))", "using n assms"], ["proof (prove)\nusing this:\n  m + 1 \\<le> n\n  ?n \\<le> m \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> m'\n  m' = 2 * m\n  c \\<le> c'\n  0 \\<le> c\n  1 \\<le> m\n  1 + c / 2 + (4 * ln (real m + 1) + 3) / (ln 2 * (real m + 1)) \\<le> c'\n\ngoal (1 subgoal):\n 1. (4 * ln (real n) + 3) / (ln 2 * real n)\n    \\<le> (4 * ln (real (m + 1)) + 3) / (ln 2 * real (m + 1))", "by (intro psi_ubound_aux) simp_all"], ["proof (state)\nthis:\n  (4 * ln (real n) + 3) / (ln 2 * real n)\n  \\<le> (4 * ln (real (m + 1)) + 3) / (ln 2 * real (m + 1))\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  (4 * ln (real n) + 3) / (ln 2 * real n)\n  \\<le> (4 * ln (real (m + 1)) + 3) / (ln 2 * real (m + 1))\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "from assms"], ["proof (chain)\npicking this:\n  ?n \\<le> m \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> m'\n  m' = 2 * m\n  c \\<le> c'\n  0 \\<le> c\n  1 \\<le> m\n  1 + c / 2 + (4 * ln (real m + 1) + 3) / (ln 2 * (real m + 1)) \\<le> c'", "have \"(4 * ln (m+1) + 3) / (ln 2 * (m+1)) \\<le> c' - 1 - c/2\""], ["proof (prove)\nusing this:\n  ?n \\<le> m \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> m'\n  m' = 2 * m\n  c \\<le> c'\n  0 \\<le> c\n  1 \\<le> m\n  1 + c / 2 + (4 * ln (real m + 1) + 3) / (ln 2 * (real m + 1)) \\<le> c'\n\ngoal (1 subgoal):\n 1. (4 * ln (real (m + 1)) + 3) / (ln 2 * real (m + 1)) \\<le> c' - 1 - c / 2", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  (4 * ln (real (m + 1)) + 3) / (ln 2 * real (m + 1)) \\<le> c' - 1 - c / 2\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "finally"], ["proof (chain)\npicking this:\n  (4 * ln (real n) + 3) / (ln 2 * real n) \\<le> c' - 1 - c / 2", "have \"4 * ln (real n) + 3 \\<le> (c' - 1 - c/2) * ln 2 * real n\""], ["proof (prove)\nusing this:\n  (4 * ln (real n) + 3) / (ln 2 * real n) \\<le> c' - 1 - c / 2\n\ngoal (1 subgoal):\n 1. 4 * ln (real n) + 3 \\<le> (c' - 1 - c / 2) * ln 2 * real n", "using n"], ["proof (prove)\nusing this:\n  (4 * ln (real n) + 3) / (ln 2 * real n) \\<le> c' - 1 - c / 2\n  m + 1 \\<le> n\n\ngoal (1 subgoal):\n 1. 4 * ln (real n) + 3 \\<le> (c' - 1 - c / 2) * ln 2 * real n", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  4 * ln (real n) + 3 \\<le> (c' - 1 - c / 2) * ln 2 * real n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "}"], ["proof (state)\nthis:\n  4 * ln (real n) + 3 \\<le> (c' - 1 - c / 2) * ln 2 * real n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "also"], ["proof (state)\nthis:\n  4 * ln (real n) + 3 \\<le> (c' - 1 - c / 2) * ln 2 * real n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "have \"(1 + c / 2) * ln 2 * real n + (c' - 1 - c / 2) * ln 2 * real n = c' * ln 2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (1 + c / 2) * ln 2 * real n + (c' - 1 - c / 2) * ln 2 * real n =\n    c' * ln 2 * real n", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  (1 + c / 2) * ln 2 * real n + (c' - 1 - c / 2) * ln 2 * real n =\n  c' * ln 2 * real n\n\ngoal (1 subgoal):\n 1. m < n \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n * ln 2 + 4 * ln (real n) + 3 + x\n              \\<le> real n * ln 2 + 4 * ln (real n) + 3 + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + 4 * ln (real n) + 3 + c * ln 2 * x\n      \\<le> real n * ln 2 + 4 * ln (real n) + 3 + c * ln 2 * y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (1 + c / 2) * ln 2 * real n + x\n      \\<le> (1 + c / 2) * ln 2 * real n + y\\<rbrakk>\n  \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n * ln 2 + 4 * ln (real n) + 3 + x\n              \\<le> real n * ln 2 + 4 * ln (real n) + 3 + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + 4 * ln (real n) + 3 + c * ln 2 * x\n      \\<le> real n * ln 2 + 4 * ln (real n) + 3 + c * ln 2 * y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (1 + c / 2) * ln 2 * real n + x\n      \\<le> (1 + c / 2) * ln 2 * real n + y\\<rbrakk>\n  \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c' * ln 2 * real n", "using \\<open>c \\<ge> 0\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n * ln 2 + 4 * ln (real n) + 3 + x\n              \\<le> real n * ln 2 + 4 * ln (real n) + 3 + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + 4 * ln (real n) + 3 + c * ln 2 * x\n      \\<le> real n * ln 2 + 4 * ln (real n) + 3 + c * ln 2 * y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (1 + c / 2) * ln 2 * real n + x\n      \\<le> (1 + c / 2) * ln 2 * real n + y\\<rbrakk>\n  \\<Longrightarrow> psi n \\<le> c' * ln 2 * real n\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. psi n \\<le> c' * ln 2 * real n", "by (simp_all add: mult_left_mono)"], ["proof (state)\nthis:\n  psi n \\<le> c' * ln 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "lemma psi_ubound_log_double_cases:\n  assumes \"\\<forall>n\\<le>m. psi n \\<le> c * ln 2 * real n\"\n          \"c' \\<ge> 1 + c/2 + (4 * ln (m+1) + 3) / (ln 2 * (m+1))\"\n          \"m' = 2*m\" \"c \\<le> c'\" \"c \\<ge> 0\" \"m \\<ge> 1\" \n  shows   \"\\<forall>n\\<le>m'. psi n \\<le> c' * ln 2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>m'. psi n \\<le> c' * ln 2 * real n", "using assms(1)"], ["proof (prove)\nusing this:\n  \\<forall>n\\<le>m. psi n \\<le> c * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>m'. psi n \\<le> c' * ln 2 * real n", "by (intro allI impI assms psi_ubound_log_double_cases'[of m c _ m' c']) auto"], ["", "lemma psi_ubound_log_1024:\n  \"\\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n", "from psi_ubound_log_128"], ["proof (chain)\npicking this:\n  \\<forall>n\\<in>{0..128}. psi n \\<le> 3 / 2 * ln 2 * real n", "have \"\\<forall>n\\<le>128. psi n \\<le> 3 / 2 * ln 2 * real n\""], ["proof (prove)\nusing this:\n  \\<forall>n\\<in>{0..128}. psi n \\<le> 3 / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>128. psi n \\<le> 3 / 2 * ln 2 * real n", "by simp"], ["proof (state)\nthis:\n  \\<forall>n\\<le>128. psi n \\<le> 3 / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n", "hence \"\\<forall>n\\<le>256. psi n \\<le> 1025 / 512 * ln 2 * real n\""], ["proof (prove)\nusing this:\n  \\<forall>n\\<le>128. psi n \\<le> 3 / 2 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>256. psi n \\<le> 1025 / 512 * ln 2 * real n", "proof (rule psi_ubound_log_double_cases, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. 1 + 3 / 2 / 2 + (4 * ln (real 128 + 1) + 3) / (ln 2 * (real 128 + 1))\n    \\<le> 1025 / 512\n 2. 256 = 2 * 128\n 3. 3 / 2 \\<le> 1025 / 512\n 4. 0 \\<le> 3 / 2\n 5. 1 \\<le> 128", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. 1 + 3 / 2 / 2 + (4 * ln (real 128 + 1) + 3) / (ln 2 * (real 128 + 1))\n    \\<le> 1025 / 512\n 2. 256 = 2 * 128\n 3. 3 / 2 \\<le> 1025 / 512\n 4. 0 \\<le> 3 / 2\n 5. 1 \\<le> 128", "have \"Some (Float 624 (- 7)) = ub_ln 9 129\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Some (Float 624 (- 7)) = ub_ln 9 129", "by code_simp"], ["proof (state)\nthis:\n  Some (Float 624 (- 7)) = ub_ln 9 129\n\ngoal (5 subgoals):\n 1. 1 + 3 / 2 / 2 + (4 * ln (real 128 + 1) + 3) / (ln 2 * (real 128 + 1))\n    \\<le> 1025 / 512\n 2. 256 = 2 * 128\n 3. 3 / 2 \\<le> 1025 / 512\n 4. 0 \\<le> 3 / 2\n 5. 1 \\<le> 128", "from ub_ln(1)[OF this] and ln_2_ge"], ["proof (chain)\npicking this:\n  ln (real_of_float 129) \\<le> real_of_float (Float 624 (- 7))\n  5677 / 8192 \\<le> ln 2", "show ?case"], ["proof (prove)\nusing this:\n  ln (real_of_float 129) \\<le> real_of_float (Float 624 (- 7))\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 1 + 3 / 2 / 2 + (4 * ln (real 128 + 1) + 3) / (ln 2 * (real 128 + 1))\n    \\<le> 1025 / 512", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  1 + 3 / 2 / 2 + (4 * ln (real 128 + 1) + 3) / (ln 2 * (real 128 + 1))\n  \\<le> 1025 / 512\n\ngoal (4 subgoals):\n 1. 256 = 2 * 128\n 2. 3 / 2 \\<le> 1025 / 512\n 3. 0 \\<le> 3 / 2\n 4. 1 \\<le> 128", "qed simp_all"], ["proof (state)\nthis:\n  \\<forall>n\\<le>256. psi n \\<le> 1025 / 512 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n", "hence \"\\<forall>n\\<le>512. psi n \\<le> 549 / 256 * ln 2 * real n\""], ["proof (prove)\nusing this:\n  \\<forall>n\\<le>256. psi n \\<le> 1025 / 512 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>512. psi n \\<le> 549 / 256 * ln 2 * real n", "proof (rule psi_ubound_log_double_cases, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. 1 + 1025 / 512 / 2 +\n    (4 * ln (real 256 + 1) + 3) / (ln 2 * (real 256 + 1))\n    \\<le> 549 / 256\n 2. 512 = 2 * 256\n 3. 1025 / 512 \\<le> 549 / 256\n 4. 0 \\<le> 1025 / 512\n 5. 1 \\<le> 256", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. 1 + 1025 / 512 / 2 +\n    (4 * ln (real 256 + 1) + 3) / (ln 2 * (real 256 + 1))\n    \\<le> 549 / 256\n 2. 512 = 2 * 256\n 3. 1025 / 512 \\<le> 549 / 256\n 4. 0 \\<le> 1025 / 512\n 5. 1 \\<le> 256", "have \"Some (Float 180 (- 5)) = ub_ln 7 257\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Some (Float 180 (- 5)) = ub_ln 7 257", "by code_simp"], ["proof (state)\nthis:\n  Some (Float 180 (- 5)) = ub_ln 7 257\n\ngoal (5 subgoals):\n 1. 1 + 1025 / 512 / 2 +\n    (4 * ln (real 256 + 1) + 3) / (ln 2 * (real 256 + 1))\n    \\<le> 549 / 256\n 2. 512 = 2 * 256\n 3. 1025 / 512 \\<le> 549 / 256\n 4. 0 \\<le> 1025 / 512\n 5. 1 \\<le> 256", "from ub_ln(1)[OF this] and ln_2_ge"], ["proof (chain)\npicking this:\n  ln (real_of_float 257) \\<le> real_of_float (Float 180 (- 5))\n  5677 / 8192 \\<le> ln 2", "show ?case"], ["proof (prove)\nusing this:\n  ln (real_of_float 257) \\<le> real_of_float (Float 180 (- 5))\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 1 + 1025 / 512 / 2 +\n    (4 * ln (real 256 + 1) + 3) / (ln 2 * (real 256 + 1))\n    \\<le> 549 / 256", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  1 + 1025 / 512 / 2 + (4 * ln (real 256 + 1) + 3) / (ln 2 * (real 256 + 1))\n  \\<le> 549 / 256\n\ngoal (4 subgoals):\n 1. 512 = 2 * 256\n 2. 1025 / 512 \\<le> 549 / 256\n 3. 0 \\<le> 1025 / 512\n 4. 1 \\<le> 256", "qed simp_all"], ["proof (state)\nthis:\n  \\<forall>n\\<le>512. psi n \\<le> 549 / 256 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n", "thus \"\\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n\""], ["proof (prove)\nusing this:\n  \\<forall>n\\<le>512. psi n \\<le> 549 / 256 * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n", "proof (rule psi_ubound_log_double_cases, goal_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. 1 + 549 / 256 / 2 +\n    (4 * ln (real 512 + 1) + 3) / (ln 2 * (real 512 + 1))\n    \\<le> 551 / 256\n 2. 1024 = 2 * 512\n 3. 549 / 256 \\<le> 551 / 256\n 4. 0 \\<le> 549 / 256\n 5. 1 \\<le> 512", "case 1"], ["proof (state)\nthis:\n  \n\ngoal (5 subgoals):\n 1. 1 + 549 / 256 / 2 +\n    (4 * ln (real 512 + 1) + 3) / (ln 2 * (real 512 + 1))\n    \\<le> 551 / 256\n 2. 1024 = 2 * 512\n 3. 549 / 256 \\<le> 551 / 256\n 4. 0 \\<le> 549 / 256\n 5. 1 \\<le> 512", "have \"Some (Float 203 (- 5)) = ub_ln 7 513\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Some (Float 203 (- 5)) = ub_ln 7 513", "by code_simp"], ["proof (state)\nthis:\n  Some (Float 203 (- 5)) = ub_ln 7 513\n\ngoal (5 subgoals):\n 1. 1 + 549 / 256 / 2 +\n    (4 * ln (real 512 + 1) + 3) / (ln 2 * (real 512 + 1))\n    \\<le> 551 / 256\n 2. 1024 = 2 * 512\n 3. 549 / 256 \\<le> 551 / 256\n 4. 0 \\<le> 549 / 256\n 5. 1 \\<le> 512", "from ub_ln(1)[OF this] and ln_2_ge"], ["proof (chain)\npicking this:\n  ln (real_of_float 513) \\<le> real_of_float (Float 203 (- 5))\n  5677 / 8192 \\<le> ln 2", "show ?case"], ["proof (prove)\nusing this:\n  ln (real_of_float 513) \\<le> real_of_float (Float 203 (- 5))\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 1 + 549 / 256 / 2 +\n    (4 * ln (real 512 + 1) + 3) / (ln 2 * (real 512 + 1))\n    \\<le> 551 / 256", "by (simp add: field_simps)"], ["proof (state)\nthis:\n  1 + 549 / 256 / 2 + (4 * ln (real 512 + 1) + 3) / (ln 2 * (real 512 + 1))\n  \\<le> 551 / 256\n\ngoal (4 subgoals):\n 1. 1024 = 2 * 512\n 2. 549 / 256 \\<le> 551 / 256\n 3. 0 \\<le> 549 / 256\n 4. 1 \\<le> 512", "qed simp_all"], ["proof (state)\nthis:\n  \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma psi_bounds_sustained_induct:\n  assumes \"4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2^j)\"\n  assumes \"4 / (1 + 2^j) \\<le> d * ln 2\"\n  assumes \"0 \\<le> c\"\n  assumes \"c / 2 + d + 1 \\<le> c\"\n  assumes \"j \\<le> k\"\n  assumes \"\\<And>n. n \\<le> 2^k \\<Longrightarrow> psi n \\<le> c * ln 2 * n\"\n  assumes \"n \\<le> 2^(Suc k)\"\n  shows \"psi n \\<le> c * ln 2 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "proof (cases \"n \\<le> 2^k\")"], ["proof (state)\ngoal (2 subgoals):\n 1. n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n 2. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "case True"], ["proof (state)\nthis:\n  n \\<le> 2 ^ k\n\ngoal (2 subgoals):\n 1. n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n 2. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "with assms(6)"], ["proof (chain)\npicking this:\n  ?n \\<le> 2 ^ k \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> 2 ^ k", "show ?thesis"], ["proof (prove)\nusing this:\n  ?n \\<le> 2 ^ k \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "."], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "case False"], ["proof (state)\nthis:\n  \\<not> n \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "from psi_bounds_induct(2)"], ["proof (chain)\npicking this:\n  psi ?n - psi (?n div 2)\n  \\<le> real ?n * ln 2 + (4 * ln (real (if ?n = 0 then 1 else ?n)) + 3)", "have \"psi n - psi (n div 2) \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\""], ["proof (prove)\nusing this:\n  psi ?n - psi (?n div 2)\n  \\<le> real ?n * ln 2 + (4 * ln (real (if ?n = 0 then 1 else ?n)) + 3)\n\ngoal (1 subgoal):\n 1. psi n - psi (n div 2)\n    \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)", "."], ["proof (state)\nthis:\n  psi n - psi (n div 2)\n  \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "also"], ["proof (state)\nthis:\n  psi n - psi (n div 2)\n  \\<le> real n * ln 2 + (4 * ln (real (if n = 0 then 1 else n)) + 3)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "from False"], ["proof (chain)\npicking this:\n  \\<not> n \\<le> 2 ^ k", "have \"(if n = 0 then 1 else n) = n\""], ["proof (prove)\nusing this:\n  \\<not> n \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. (if n = 0 then 1 else n) = n", "by simp"], ["proof (state)\nthis:\n  (if n = 0 then 1 else n) = n\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "finally"], ["proof (chain)\npicking this:\n  psi n - psi (n div 2) \\<le> real n * ln 2 + (4 * ln (real n) + 3)", "have \"psi n \\<le> real n * ln 2 + (4 * ln (real n) + 3) + psi (n div 2)\""], ["proof (prove)\nusing this:\n  psi n - psi (n div 2) \\<le> real n * ln 2 + (4 * ln (real n) + 3)\n\ngoal (1 subgoal):\n 1. psi n \\<le> real n * ln 2 + (4 * ln (real n) + 3) + psi (n div 2)", "by simp"], ["proof (state)\nthis:\n  psi n \\<le> real n * ln 2 + (4 * ln (real n) + 3) + psi (n div 2)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "also"], ["proof (state)\nthis:\n  psi n \\<le> real n * ln 2 + (4 * ln (real n) + 3) + psi (n div 2)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "from assms(6,7)"], ["proof (chain)\npicking this:\n  ?n \\<le> 2 ^ k \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> 2 ^ Suc k", "have \"psi (n div 2) \\<le> c * ln 2 * (n div 2)\""], ["proof (prove)\nusing this:\n  ?n \\<le> 2 ^ k \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> 2 ^ Suc k\n\ngoal (1 subgoal):\n 1. psi (n div 2) \\<le> c * ln 2 * real (n div 2)", "by simp"], ["proof (state)\nthis:\n  psi (n div 2) \\<le> c * ln 2 * real (n div 2)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "also"], ["proof (state)\nthis:\n  psi (n div 2) \\<le> c * ln 2 * real (n div 2)\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "have \"real (n div 2) \\<le> real n / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n div 2) \\<le> real n / 2", "by simp"], ["proof (state)\nthis:\n  real (n div 2) \\<le> real n / 2\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "also"], ["proof (state)\nthis:\n  real (n div 2) \\<le> real n / 2\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "have \"real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * (n / 2) \\<le> c * ln 2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * (real n / 2)\n    \\<le> c * ln 2 * real n", "proof (rule overpower_lemma[of\n            \"\\<lambda>x. x * ln 2 + (4 * ln x + 3) + c * ln 2 * (x / 2)\" \"1+2^j\"\n            \"\\<lambda>x. c * ln 2 * x\" \"\\<lambda>x. c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\"\n            \"real n\"])"], ["proof (state)\ngoal (4 subgoals):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 3. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 4. 1 + 2 ^ j \\<le> real n", "from assms(1)"], ["proof (chain)\npicking this:\n  4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2 ^ j)", "have \"4 * ln (1 + 2^j) + 3 \\<le> d * ln 2 * (1 + 2^j)\""], ["proof (prove)\nusing this:\n  4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2 ^ j)\n\ngoal (1 subgoal):\n 1. 4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2 ^ j)", "."], ["proof (state)\nthis:\n  4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2 ^ j)\n\ngoal (4 subgoals):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 3. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 4. 1 + 2 ^ j \\<le> real n", "also"], ["proof (state)\nthis:\n  4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2 ^ j)\n\ngoal (4 subgoals):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 3. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 4. 1 + 2 ^ j \\<le> real n", "from assms(4)"], ["proof (chain)\npicking this:\n  c / 2 + d + 1 \\<le> c", "have \"d \\<le> c - c/2 - 1\""], ["proof (prove)\nusing this:\n  c / 2 + d + 1 \\<le> c\n\ngoal (1 subgoal):\n 1. d \\<le> c - c / 2 - 1", "by simp"], ["proof (state)\nthis:\n  d \\<le> c - c / 2 - 1\n\ngoal (4 subgoals):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 3. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 4. 1 + 2 ^ j \\<le> real n", "also"], ["proof (state)\nthis:\n  d \\<le> c - c / 2 - 1\n\ngoal (4 subgoals):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 3. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 4. 1 + 2 ^ j \\<le> real n", "have \"(\\<dots>) * ln 2 * (1 + 2 ^ j) = c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j)\n          - (1 + 2 ^ j) * ln 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (c - c / 2 - 1) * ln 2 * (1 + 2 ^ j) =\n    c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) - (1 + 2 ^ j) * ln 2", "by (simp add: left_diff_distrib)"], ["proof (state)\nthis:\n  (c - c / 2 - 1) * ln 2 * (1 + 2 ^ j) =\n  c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) - (1 + 2 ^ j) * ln 2\n\ngoal (4 subgoals):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 3. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 4. 1 + 2 ^ j \\<le> real n", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x * ln 2 * (1 + 2 ^ j) \\<le> y * ln 2 * (1 + 2 ^ j)) \\<Longrightarrow>\n  4 * ln (1 + 2 ^ j) + 3\n  \\<le> c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) -\n        (1 + 2 ^ j) * ln 2", "have \"4 * ln (1 + 2^j) + 3 \\<le> c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j)\n          - (1 + 2 ^ j) * ln 2\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      x * ln 2 * (1 + 2 ^ j) \\<le> y * ln 2 * (1 + 2 ^ j)) \\<Longrightarrow>\n  4 * ln (1 + 2 ^ j) + 3\n  \\<le> c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) -\n        (1 + 2 ^ j) * ln 2\n\ngoal (1 subgoal):\n 1. 4 * ln (1 + 2 ^ j) + 3\n    \\<le> c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) -\n          (1 + 2 ^ j) * ln 2", "by (simp add: add_pos_pos)"], ["proof (state)\nthis:\n  4 * ln (1 + 2 ^ j) + 3\n  \\<le> c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) -\n        (1 + 2 ^ j) * ln 2\n\ngoal (4 subgoals):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 3. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 4. 1 + 2 ^ j \\<le> real n", "then"], ["proof (chain)\npicking this:\n  4 * ln (1 + 2 ^ j) + 3\n  \\<le> c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) -\n        (1 + 2 ^ j) * ln 2", "show \"(1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3)\n                    + c * ln 2 * ((1 + 2 ^ j) / 2) \\<le> c * ln 2 * (1 + 2 ^ j)\""], ["proof (prove)\nusing this:\n  4 * ln (1 + 2 ^ j) + 3\n  \\<le> c * ln 2 * (1 + 2 ^ j) - c / 2 * ln 2 * (1 + 2 ^ j) -\n        (1 + 2 ^ j) * ln 2\n\ngoal (1 subgoal):\n 1. (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n    c * ln 2 * ((1 + 2 ^ j) / 2)\n    \\<le> c * ln 2 * (1 + 2 ^ j)", "by simp"], ["proof (state)\nthis:\n  (1 + 2 ^ j) * ln 2 + (4 * ln (1 + 2 ^ j) + 3) +\n  c * ln 2 * ((1 + 2 ^ j) / 2)\n  \\<le> c * ln 2 * (1 + 2 ^ j)\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 3. 1 + 2 ^ j \\<le> real n", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 3. 1 + 2 ^ j \\<le> real n", "fix x::real"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 3. 1 + 2 ^ j \\<le> real n", "assume x: \"1 + 2^j \\<le> x\""], ["proof (state)\nthis:\n  1 + 2 ^ j \\<le> x\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 3. 1 + 2 ^ j \\<le> real n", "moreover"], ["proof (state)\nthis:\n  1 + 2 ^ j \\<le> x\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 3. 1 + 2 ^ j \\<le> real n", "have \"1 + 2 ^ j > (0::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < 1 + 2 ^ j", "by (simp add: add_pos_pos)"], ["proof (state)\nthis:\n  0 < 1 + 2 ^ j\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 3. 1 + 2 ^ j \\<le> real n", "ultimately"], ["proof (chain)\npicking this:\n  1 + 2 ^ j \\<le> x\n  0 < 1 + 2 ^ j", "have x_pos: \"x > 0\""], ["proof (prove)\nusing this:\n  1 + 2 ^ j \\<le> x\n  0 < 1 + 2 ^ j\n\ngoal (1 subgoal):\n 1. 0 < x", "by linarith"], ["proof (state)\nthis:\n  0 < x\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            c * ln 2 * x -\n            (x * ln 2 + (4 * ln x + 3) +\n             c * ln 2 * (x / 2))) has_real_derivative\n        c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n        (at x)\n 2. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 3. 1 + 2 ^ j \\<le> real n", "show \"((\\<lambda>x. c * ln 2 * x - (x * ln 2 + (4 * ln x + 3) + c * ln 2 * (x / 2)))\n              has_real_derivative c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x.\n         c * ln 2 * x -\n         (x * ln 2 + (4 * ln x + 3) +\n          c * ln 2 * (x / 2))) has_real_derivative\n     c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n     (at x)", "by (rule derivative_eq_intros refl | simp add: \\<open>0 < x\\<close>)+"], ["proof (state)\nthis:\n  ((\\<lambda>x.\n       c * ln 2 * x -\n       (x * ln 2 + (4 * ln x + 3) + c * ln 2 * (x / 2))) has_real_derivative\n   c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2)\n   (at x)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "from \\<open>0 < x\\<close> \\<open>0 < 1 + 2^j\\<close>"], ["proof (chain)\npicking this:\n  0 < x\n  0 < 1 + 2 ^ j", "have \"0 < x * (1 + 2^j)\""], ["proof (prove)\nusing this:\n  0 < x\n  0 < 1 + 2 ^ j\n\ngoal (1 subgoal):\n 1. 0 < x * (1 + 2 ^ j)", "by (rule mult_pos_pos)"], ["proof (state)\nthis:\n  0 < x * (1 + 2 ^ j)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "have \"4 / x \\<le> 4 / (1 + 2^j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 4 / x \\<le> 4 / (1 + 2 ^ j)", "by (intro divide_left_mono mult_pos_pos add_pos_pos x x_pos) simp_all"], ["proof (state)\nthis:\n  4 / x \\<le> 4 / (1 + 2 ^ j)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "also"], ["proof (state)\nthis:\n  4 / x \\<le> 4 / (1 + 2 ^ j)\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "from assms(2)"], ["proof (chain)\npicking this:\n  4 / (1 + 2 ^ j) \\<le> d * ln 2", "have \"4 / (1 + 2^j) \\<le> d * ln 2\""], ["proof (prove)\nusing this:\n  4 / (1 + 2 ^ j) \\<le> d * ln 2\n\ngoal (1 subgoal):\n 1. 4 / (1 + 2 ^ j) \\<le> d * ln 2", "."], ["proof (state)\nthis:\n  4 / (1 + 2 ^ j) \\<le> d * ln 2\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "also"], ["proof (state)\nthis:\n  4 / (1 + 2 ^ j) \\<le> d * ln 2\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "from assms(4)"], ["proof (chain)\npicking this:\n  c / 2 + d + 1 \\<le> c", "have \"d \\<le> c - c/2 - 1\""], ["proof (prove)\nusing this:\n  c / 2 + d + 1 \\<le> c\n\ngoal (1 subgoal):\n 1. d \\<le> c - c / 2 - 1", "by simp"], ["proof (state)\nthis:\n  d \\<le> c - c / 2 - 1\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "also"], ["proof (state)\nthis:\n  d \\<le> c - c / 2 - 1\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "have \"\\<dots> * ln 2 = c * ln 2 - c/2 * ln 2 - ln 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (c - c / 2 - 1) * ln 2 = c * ln 2 - c / 2 * ln 2 - ln 2", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  (c - c / 2 - 1) * ln 2 = c * ln 2 - c / 2 * ln 2 - ln 2\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       1 + 2 ^ j \\<le> x \\<Longrightarrow>\n       0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n 2. 1 + 2 ^ j \\<le> real n", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> x * ln 2 \\<le> y * ln 2) \\<Longrightarrow>\n  4 / x \\<le> c * ln 2 - c / 2 * ln 2 - ln 2", "show \"0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow> x * ln 2 \\<le> y * ln 2) \\<Longrightarrow>\n  4 / x \\<le> c * ln 2 - c / 2 * ln 2 - ln 2\n\ngoal (1 subgoal):\n 1. 0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2", "by simp"], ["proof (state)\nthis:\n  0 \\<le> c * ln 2 - ln 2 - 4 / x - c / 2 * ln 2\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "have \"1 + 2^j = real (1 + 2^j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 + 2 ^ j = real (1 + 2 ^ j)", "by simp"], ["proof (state)\nthis:\n  1 + 2 ^ j = real (1 + 2 ^ j)\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "also"], ["proof (state)\nthis:\n  1 + 2 ^ j = real (1 + 2 ^ j)\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "from assms(5)"], ["proof (chain)\npicking this:\n  j \\<le> k", "have \"\\<dots> \\<le> real (1 + 2^k)\""], ["proof (prove)\nusing this:\n  j \\<le> k\n\ngoal (1 subgoal):\n 1. real (1 + 2 ^ j) \\<le> real (1 + 2 ^ k)", "by simp"], ["proof (state)\nthis:\n  real (1 + 2 ^ j) \\<le> real (1 + 2 ^ k)\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "also"], ["proof (state)\nthis:\n  real (1 + 2 ^ j) \\<le> real (1 + 2 ^ k)\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "from False"], ["proof (chain)\npicking this:\n  \\<not> n \\<le> 2 ^ k", "have \"2^k \\<le> n - 1\""], ["proof (prove)\nusing this:\n  \\<not> n \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. 2 ^ k \\<le> n - 1", "by simp"], ["proof (state)\nthis:\n  2 ^ k \\<le> n - 1\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real (1 + x) \\<le> real (1 + y)) \\<Longrightarrow>\n  1 + 2 ^ j \\<le> real (1 + (n - 1))", "show \"1 + 2^j \\<le> real n\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real (1 + x) \\<le> real (1 + y)) \\<Longrightarrow>\n  1 + 2 ^ j \\<le> real (1 + (n - 1))\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "using False"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real (1 + x) \\<le> real (1 + y)) \\<Longrightarrow>\n  1 + 2 ^ j \\<le> real (1 + (n - 1))\n  \\<not> n \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. 1 + 2 ^ j \\<le> real n", "by simp"], ["proof (state)\nthis:\n  1 + 2 ^ j \\<le> real n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * (real n / 2)\n  \\<le> c * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<not> n \\<le> 2 ^ k \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "finally"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n * ln 2 + (4 * ln (real n) + 3) + x\n              \\<le> real n * ln 2 + (4 * ln (real n) + 3) + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * x\n      \\<le> real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * y\\<rbrakk>\n  \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n * ln 2 + (4 * ln (real n) + 3) + x\n              \\<le> real n * ln 2 + (4 * ln (real n) + 3) + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * x\n      \\<le> real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * y\\<rbrakk>\n  \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "using assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x y.\n              x \\<le> y \\<Longrightarrow>\n              real n * ln 2 + (4 * ln (real n) + 3) + x\n              \\<le> real n * ln 2 + (4 * ln (real n) + 3) + y;\n   \\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * x\n      \\<le> real n * ln 2 + (4 * ln (real n) + 3) + c * ln 2 * y\\<rbrakk>\n  \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n  4 * ln (1 + 2 ^ j) + 3 \\<le> d * ln 2 * (1 + 2 ^ j)\n  4 / (1 + 2 ^ j) \\<le> d * ln 2\n  0 \\<le> c\n  c / 2 + d + 1 \\<le> c\n  j \\<le> k\n  ?n \\<le> 2 ^ k \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> 2 ^ Suc k\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "by - (simp_all add: mult_left_mono)"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma psi_bounds_sustained:\n  assumes \"\\<And>n. n \\<le> 2^k \\<Longrightarrow> psi n \\<le> c * ln 2 * n\"\n  assumes \"4 * ln (1 + 2^k) + 3 \\<le> (c/2 - 1) * ln 2 * (1 + 2^k)\"\n  assumes \"4 / (1 + 2^k) \\<le> (c/2 - 1) * ln 2\"\n  assumes \"c \\<ge> 0\"\n  shows \"psi n \\<le> c * ln 2 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "have *: \"psi n \\<le> c * ln 2 * n\" if \"n \\<le> 2^j\" for j n"], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "using that"], ["proof (prove)\nusing this:\n  n \\<le> 2 ^ j\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "proof (induction j arbitrary: n)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>n. n \\<le> 2 ^ 0 \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n 2. \\<And>j n.\n       \\<lbrakk>\\<And>n.\n                   n \\<le> 2 ^ j \\<Longrightarrow>\n                   psi n \\<le> c * ln 2 * real n;\n        n \\<le> 2 ^ Suc j\\<rbrakk>\n       \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "case 0"], ["proof (state)\nthis:\n  n \\<le> 2 ^ 0\n\ngoal (2 subgoals):\n 1. \\<And>n. n \\<le> 2 ^ 0 \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n 2. \\<And>j n.\n       \\<lbrakk>\\<And>n.\n                   n \\<le> 2 ^ j \\<Longrightarrow>\n                   psi n \\<le> c * ln 2 * real n;\n        n \\<le> 2 ^ Suc j\\<rbrakk>\n       \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "with assms(4) 0"], ["proof (chain)\npicking this:\n  0 \\<le> c\n  n \\<le> 2 ^ 0\n  n \\<le> 2 ^ 0", "show ?case"], ["proof (prove)\nusing this:\n  0 \\<le> c\n  n \\<le> 2 ^ 0\n  n \\<le> 2 ^ 0\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "unfolding psi_def mangoldt_def"], ["proof (prove)\nusing this:\n  0 \\<le> c\n  n \\<le> 2 ^ 0\n  n \\<le> 2 ^ 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>n = 1..n.\n        if primepow n then of_real (ln (real (aprimedivisor n))) else 0)\n    \\<le> c * ln 2 * real n", "by (cases n) auto"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<And>j n.\n       \\<lbrakk>\\<And>n.\n                   n \\<le> 2 ^ j \\<Longrightarrow>\n                   psi n \\<le> c * ln 2 * real n;\n        n \\<le> 2 ^ Suc j\\<rbrakk>\n       \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>j n.\n       \\<lbrakk>\\<And>n.\n                   n \\<le> 2 ^ j \\<Longrightarrow>\n                   psi n \\<le> c * ln 2 * real n;\n        n \\<le> 2 ^ Suc j\\<rbrakk>\n       \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "case (Suc j)"], ["proof (state)\nthis:\n  ?n \\<le> 2 ^ j \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n  n \\<le> 2 ^ Suc j\n\ngoal (1 subgoal):\n 1. \\<And>j n.\n       \\<lbrakk>\\<And>n.\n                   n \\<le> 2 ^ j \\<Longrightarrow>\n                   psi n \\<le> c * ln 2 * real n;\n        n \\<le> 2 ^ Suc j\\<rbrakk>\n       \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "proof (cases \"k \\<le> j\")"], ["proof (state)\ngoal (2 subgoals):\n 1. k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n 2. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "case True"], ["proof (state)\nthis:\n  k \\<le> j\n\ngoal (2 subgoals):\n 1. k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n 2. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "from assms(4)"], ["proof (chain)\npicking this:\n  0 \\<le> c", "have c_div_2: \"c/2 + (c/2 - 1) + 1 \\<le> c\""], ["proof (prove)\nusing this:\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. c / 2 + (c / 2 - 1) + 1 \\<le> c", "by simp"], ["proof (state)\nthis:\n  c / 2 + (c / 2 - 1) + 1 \\<le> c\n\ngoal (2 subgoals):\n 1. k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n 2. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "from psi_bounds_sustained_induct[of k \"c/2 -1\" c j,\n             OF assms(2) assms(3) assms(4) c_div_2 True Suc.IH Suc.prems]"], ["proof (chain)\npicking this:\n  (\\<And>n. n \\<le> 2 ^ j \\<Longrightarrow> n \\<le> 2 ^ j) \\<Longrightarrow>\n  psi n \\<le> c * ln 2 * real n", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>n. n \\<le> 2 ^ j \\<Longrightarrow> n \\<le> 2 ^ j) \\<Longrightarrow>\n  psi n \\<le> c * ln 2 * real n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "by simp"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "case False"], ["proof (state)\nthis:\n  \\<not> k \\<le> j\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "then"], ["proof (chain)\npicking this:\n  \\<not> k \\<le> j", "have j_lt_k: \"Suc j \\<le> k\""], ["proof (prove)\nusing this:\n  \\<not> k \\<le> j\n\ngoal (1 subgoal):\n 1. Suc j \\<le> k", "by simp"], ["proof (state)\nthis:\n  Suc j \\<le> k\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "from Suc.prems"], ["proof (chain)\npicking this:\n  n \\<le> 2 ^ Suc j", "have \"n \\<le> 2 ^ Suc j\""], ["proof (prove)\nusing this:\n  n \\<le> 2 ^ Suc j\n\ngoal (1 subgoal):\n 1. n \\<le> 2 ^ Suc j", "."], ["proof (state)\nthis:\n  n \\<le> 2 ^ Suc j\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "also"], ["proof (state)\nthis:\n  n \\<le> 2 ^ Suc j\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "have \"(2::nat) ^ Suc j \\<le> 2 ^ k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 ^ Suc j \\<le> 2 ^ k", "using power_increasing[of \"Suc j\" k \"2::nat\", OF j_lt_k]"], ["proof (prove)\nusing this:\n  1 \\<le> 2 \\<Longrightarrow> 2 ^ Suc j \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. 2 ^ Suc j \\<le> 2 ^ k", "by simp"], ["proof (state)\nthis:\n  2 ^ Suc j \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> j \\<Longrightarrow> psi n \\<le> c * ln 2 * real n", "finally"], ["proof (chain)\npicking this:\n  n \\<le> 2 ^ k", "show ?thesis"], ["proof (prove)\nusing this:\n  n \\<le> 2 ^ k\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "using assms(1)"], ["proof (prove)\nusing this:\n  n \\<le> 2 ^ k\n  ?n \\<le> 2 ^ k \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "by simp"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?n \\<le> 2 ^ ?j \\<Longrightarrow> psi ?n \\<le> c * ln 2 * real ?n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "have \"n < 2 ^ n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n < 2 ^ n", "by (induction n) simp_all"], ["proof (state)\nthis:\n  n < 2 ^ n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "with *[of n n]"], ["proof (chain)\npicking this:\n  n \\<le> 2 ^ n \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n  n < 2 ^ n", "show ?thesis"], ["proof (prove)\nusing this:\n  n \\<le> 2 ^ n \\<Longrightarrow> psi n \\<le> c * ln 2 * real n\n  n < 2 ^ n\n\ngoal (1 subgoal):\n 1. psi n \\<le> c * ln 2 * real n", "by simp"], ["proof (state)\nthis:\n  psi n \\<le> c * ln 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma psi_ubound_log: \"psi n \\<le> 551 / 256 * ln 2 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> 551 / 256 * ln 2 * real n", "proof (rule psi_bounds_sustained)"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<And>n.\n       n \\<le> 2 ^ ?k \\<Longrightarrow>\n       psi n \\<le> 551 / 256 * ln 2 * real n\n 2. 4 * ln (1 + 2 ^ ?k) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ ?k)\n 3. 4 / (1 + 2 ^ ?k) \\<le> (551 / 256 / 2 - 1) * ln 2\n 4. 0 \\<le> 551 / 256", "show \"0 \\<le> 551 / (256 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> 551 / 256", "by simp"], ["proof (state)\nthis:\n  0 \\<le> 551 / 256\n\ngoal (3 subgoals):\n 1. \\<And>n.\n       n \\<le> 2 ^ ?k \\<Longrightarrow>\n       psi n \\<le> 551 / 256 * ln 2 * real n\n 2. 4 * ln (1 + 2 ^ ?k) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ ?k)\n 3. 4 / (1 + 2 ^ ?k) \\<le> (551 / 256 / 2 - 1) * ln 2", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n.\n       n \\<le> 2 ^ ?k \\<Longrightarrow>\n       psi n \\<le> 551 / 256 * ln 2 * real n\n 2. 4 * ln (1 + 2 ^ ?k) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ ?k)\n 3. 4 / (1 + 2 ^ ?k) \\<le> (551 / 256 / 2 - 1) * ln 2", "fix n :: nat"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>n.\n       n \\<le> 2 ^ ?k \\<Longrightarrow>\n       psi n \\<le> 551 / 256 * ln 2 * real n\n 2. 4 * ln (1 + 2 ^ ?k) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ ?k)\n 3. 4 / (1 + 2 ^ ?k) \\<le> (551 / 256 / 2 - 1) * ln 2", "assume \"n \\<le> 2 ^ 10\""], ["proof (state)\nthis:\n  n \\<le> 2 ^ 10\n\ngoal (3 subgoals):\n 1. \\<And>n.\n       n \\<le> 2 ^ ?k \\<Longrightarrow>\n       psi n \\<le> 551 / 256 * ln 2 * real n\n 2. 4 * ln (1 + 2 ^ ?k) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ ?k)\n 3. 4 / (1 + 2 ^ ?k) \\<le> (551 / 256 / 2 - 1) * ln 2", "with psi_ubound_log_1024"], ["proof (chain)\npicking this:\n  \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n\n  n \\<le> 2 ^ 10", "show \"psi n \\<le> 551 / 256 * ln 2 * real n\""], ["proof (prove)\nusing this:\n  \\<forall>n\\<le>1024. psi n \\<le> 551 / 256 * ln 2 * real n\n  n \\<le> 2 ^ 10\n\ngoal (1 subgoal):\n 1. psi n \\<le> 551 / 256 * ln 2 * real n", "by auto"], ["proof (state)\nthis:\n  psi n \\<le> 551 / 256 * ln 2 * real n\n\ngoal (2 subgoals):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)\n 2. 4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)\n 2. 4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2", "have \"4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * (2/3 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * (2 / 3)", "by simp"], ["proof (state)\nthis:\n  4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * (2 / 3)\n\ngoal (2 subgoals):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)\n 2. 4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2", "also"], ["proof (state)\nthis:\n  4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * (2 / 3)\n\ngoal (2 subgoals):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)\n 2. 4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2", "have \"\\<dots> \\<le> (551 / 256 / 2 - 1) * ln 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (551 / 256 / 2 - 1) * (2 / 3) \\<le> (551 / 256 / 2 - 1) * ln 2", "by (intro mult_left_mono ln_2_ge') simp_all"], ["proof (state)\nthis:\n  (551 / 256 / 2 - 1) * (2 / 3) \\<le> (551 / 256 / 2 - 1) * ln 2\n\ngoal (2 subgoals):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)\n 2. 4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2", "finally"], ["proof (chain)\npicking this:\n  4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2", "show \"4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln (2 :: real)\""], ["proof (prove)\nusing this:\n  4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2\n\ngoal (1 subgoal):\n 1. 4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2", "."], ["proof (state)\nthis:\n  4 / (1 + 2 ^ 10) \\<le> (551 / 256 / 2 - 1) * ln 2\n\ngoal (1 subgoal):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)", "have \"Some (Float 16 (-1)) = ub_ln 3 1025\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Some (Float 16 (- 1)) = ub_ln 3 1025", "by code_simp"], ["proof (state)\nthis:\n  Some (Float 16 (- 1)) = ub_ln 3 1025\n\ngoal (1 subgoal):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)", "from ub_ln(1)[OF this] and ln_2_ge"], ["proof (chain)\npicking this:\n  ln (real_of_float 1025) \\<le> real_of_float (Float 16 (- 1))\n  5677 / 8192 \\<le> ln 2", "have \"2048 * ln 1025 + 1536 \\<le> 39975 * (ln 2::real)\""], ["proof (prove)\nusing this:\n  ln (real_of_float 1025) \\<le> real_of_float (Float 16 (- 1))\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 2048 * ln 1025 + 1536 \\<le> 39975 * ln 2", "by simp"], ["proof (state)\nthis:\n  2048 * ln 1025 + 1536 \\<le> 39975 * ln 2\n\ngoal (1 subgoal):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)", "thus \"4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10 :: real)\""], ["proof (prove)\nusing this:\n  2048 * ln 1025 + 1536 \\<le> 39975 * ln 2\n\ngoal (1 subgoal):\n 1. 4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)", "by simp"], ["proof (state)\nthis:\n  4 * ln (1 + 2 ^ 10) + 3 \\<le> (551 / 256 / 2 - 1) * ln 2 * (1 + 2 ^ 10)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma psi_ubound_3_2: \"psi n \\<le> 3/2 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "have \"(551 / 256) * ln 2 \\<le> (551 / 256) * (16/23 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 551 / 256 * ln 2 \\<le> 551 / 256 * (16 / 23)", "by (intro mult_left_mono ln_2_le') auto"], ["proof (state)\nthis:\n  551 / 256 * ln 2 \\<le> 551 / 256 * (16 / 23)\n\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "also"], ["proof (state)\nthis:\n  551 / 256 * ln 2 \\<le> 551 / 256 * (16 / 23)\n\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "have \"\\<dots> \\<le> 3 / 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 551 / 256 * (16 / 23) \\<le> 3 / 2", "by simp"], ["proof (state)\nthis:\n  551 / 256 * (16 / 23) \\<le> 3 / 2\n\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "finally"], ["proof (chain)\npicking this:\n  551 / 256 * ln 2 \\<le> 3 / 2", "have \"551 / 256 * ln 2 \\<le> 3/(2::real)\""], ["proof (prove)\nusing this:\n  551 / 256 * ln 2 \\<le> 3 / 2\n\ngoal (1 subgoal):\n 1. 551 / 256 * ln 2 \\<le> 3 / 2", "."], ["proof (state)\nthis:\n  551 / 256 * ln 2 \\<le> 3 / 2\n\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "with of_nat_0_le_iff mult_right_mono"], ["proof (chain)\npicking this:\n  (0::?'a) \\<le> of_nat ?n\n  \\<lbrakk>?a \\<le> ?b; (0::?'a) \\<le> ?c\\<rbrakk>\n  \\<Longrightarrow> ?a * ?c \\<le> ?b * ?c\n  551 / 256 * ln 2 \\<le> 3 / 2", "have \"551 / 256 * ln 2 * n \\<le> 3/2 * n\""], ["proof (prove)\nusing this:\n  (0::?'a) \\<le> of_nat ?n\n  \\<lbrakk>?a \\<le> ?b; (0::?'a) \\<le> ?c\\<rbrakk>\n  \\<Longrightarrow> ?a * ?c \\<le> ?b * ?c\n  551 / 256 * ln 2 \\<le> 3 / 2\n\ngoal (1 subgoal):\n 1. 551 / 256 * ln 2 * real n \\<le> 3 / 2 * real n", "by blast"], ["proof (state)\nthis:\n  551 / 256 * ln 2 * real n \\<le> 3 / 2 * real n\n\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "with psi_ubound_log[of \"n\"]"], ["proof (chain)\npicking this:\n  psi n \\<le> 551 / 256 * ln 2 * real n\n  551 / 256 * ln 2 * real n \\<le> 3 / 2 * real n", "show ?thesis"], ["proof (prove)\nusing this:\n  psi n \\<le> 551 / 256 * ln 2 * real n\n  551 / 256 * ln 2 * real n \\<le> 3 / 2 * real n\n\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "by linarith"], ["proof (state)\nthis:\n  psi n \\<le> 3 / 2 * real n\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Doubling psi and theta\\<close>"], ["", "lemma psi_residues_compare_2:\n  \"psi_odd_2 n \\<le> psi_even_2 n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "have \"psi_odd_2 n = (\\<Sum>d\\<in>{d. d \\<in> {2..n} \\<and> primepow_odd d}. mangoldt_odd d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} =\n    (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d. mangoldt_odd d)", "unfolding mangoldt_odd_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 2..n.\n        if primepow_odd d then ln (real (aprimedivisor d)) else 0) =\n    (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d.\n       if primepow_odd d then ln (real (aprimedivisor d)) else 0)", "by (rule sum.mono_neutral_right) auto"], ["proof (state)\nthis:\n  sum mangoldt_odd {2..n} =\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d. mangoldt_odd d)\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "also"], ["proof (state)\nthis:\n  sum mangoldt_odd {2..n} =\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d. mangoldt_odd d)\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "have \"\\<dots> = (\\<Sum>d\\<in>{d. d \\<in> {2..n} \\<and> primepow_odd d}. ln (real (aprimedivisor d)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d. mangoldt_odd d) =\n    (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d.\n       ln (real (aprimedivisor d)))", "by (intro sum.cong refl) (simp add: mangoldt_odd_def)"], ["proof (state)\nthis:\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d. mangoldt_odd d) =\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d.\n     ln (real (aprimedivisor d)))\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "also"], ["proof (state)\nthis:\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d. mangoldt_odd d) =\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d.\n     ln (real (aprimedivisor d)))\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "have \"\\<dots> \\<le> (\\<Sum>d\\<in>{d. d \\<in> {2..n} \\<and> primepow_even d}. ln (real (aprimedivisor d)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d.\n       ln (real (aprimedivisor d)))\n    \\<le> (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d.\n             ln (real (aprimedivisor d)))", "proof (rule sum_le_included [where i = \"\\<lambda>y. y * aprimedivisor y\"]; clarify?)"], ["proof (state)\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "fix d :: nat"], ["proof (state)\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "assume \"d \\<in> {2..n}\" \"primepow_odd d\""], ["proof (state)\nthis:\n  d \\<in> {2..n}\n  primepow_odd d\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "note d = this"], ["proof (state)\nthis:\n  d \\<in> {2..n}\n  primepow_odd d\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "then"], ["proof (chain)\npicking this:\n  d \\<in> {2..n}\n  primepow_odd d", "obtain p k where d': \"k \\<ge> 1\" \"prime p\" \"d = p ^ (2*k+1)\""], ["proof (prove)\nusing this:\n  d \\<in> {2..n}\n  primepow_odd d\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        \\<lbrakk>1 \\<le> k; prime p; d = p ^ (2 * k + 1)\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto simp: primepow_odd_def)"], ["proof (state)\nthis:\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "from d'"], ["proof (chain)\npicking this:\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)", "have \"p ^ (2 * k) \\<le> p ^ (2 * k + 1)\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. p ^ (2 * k) \\<le> p ^ (2 * k + 1)", "by (subst power_increasing_iff) (auto simp: prime_gt_Suc_0_nat)"], ["proof (state)\nthis:\n  p ^ (2 * k) \\<le> p ^ (2 * k + 1)\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "also"], ["proof (state)\nthis:\n  p ^ (2 * k) \\<le> p ^ (2 * k + 1)\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "from d d'"], ["proof (chain)\npicking this:\n  d \\<in> {2..n}\n  primepow_odd d\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)", "have \"\\<dots> \\<le> n\""], ["proof (prove)\nusing this:\n  d \\<in> {2..n}\n  primepow_odd d\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. p ^ (2 * k + 1) \\<le> n", "by simp"], ["proof (state)\nthis:\n  p ^ (2 * k + 1) \\<le> n\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "finally"], ["proof (chain)\npicking this:\n  p ^ (2 * k) \\<le> n", "have \"p ^ (2 * k) \\<le> n\""], ["proof (prove)\nusing this:\n  p ^ (2 * k) \\<le> n\n\ngoal (1 subgoal):\n 1. p ^ (2 * k) \\<le> n", "."], ["proof (state)\nthis:\n  p ^ (2 * k) \\<le> n\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "moreover"], ["proof (state)\nthis:\n  p ^ (2 * k) \\<le> n\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "from d'"], ["proof (chain)\npicking this:\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)", "have \"p ^ (2 * k) > 1\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. 1 < p ^ (2 * k)", "by (intro one_less_power) (simp_all add: prime_gt_Suc_0_nat)"], ["proof (state)\nthis:\n  1 < p ^ (2 * k)\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "ultimately"], ["proof (chain)\npicking this:\n  p ^ (2 * k) \\<le> n\n  1 < p ^ (2 * k)", "have \"p ^ (2 * k) \\<in> {2..n}\""], ["proof (prove)\nusing this:\n  p ^ (2 * k) \\<le> n\n  1 < p ^ (2 * k)\n\ngoal (1 subgoal):\n 1. p ^ (2 * k) \\<in> {2..n}", "by simp"], ["proof (state)\nthis:\n  p ^ (2 * k) \\<in> {2..n}\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "moreover"], ["proof (state)\nthis:\n  p ^ (2 * k) \\<in> {2..n}\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "from d'"], ["proof (chain)\npicking this:\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)", "have \"primepow_even (p ^ (2 * k))\""], ["proof (prove)\nusing this:\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. primepow_even (p ^ (2 * k))", "by (auto simp: primepow_even_def)"], ["proof (state)\nthis:\n  primepow_even (p ^ (2 * k))\n\ngoal (4 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))\n 4. \\<And>x.\n       \\<lbrakk>x \\<in> {2..n}; primepow_odd x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n                            y * aprimedivisor y = x \\<and>\n                            ln (real (aprimedivisor x))\n                            \\<le> ln (real (aprimedivisor y))", "ultimately"], ["proof (chain)\npicking this:\n  p ^ (2 * k) \\<in> {2..n}\n  primepow_even (p ^ (2 * k))", "show \"\\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}. y * aprimedivisor y = d \\<and>\n                       ln (real (aprimedivisor d)) \\<le> ln (real (aprimedivisor y))\""], ["proof (prove)\nusing this:\n  p ^ (2 * k) \\<in> {2..n}\n  primepow_even (p ^ (2 * k))\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n       y * aprimedivisor y = d \\<and>\n       ln (real (aprimedivisor d)) \\<le> ln (real (aprimedivisor y))", "using d'"], ["proof (prove)\nusing this:\n  p ^ (2 * k) \\<in> {2..n}\n  primepow_even (p ^ (2 * k))\n  1 \\<le> k\n  prime p\n  d = p ^ (2 * k + 1)\n\ngoal (1 subgoal):\n 1. \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n       y * aprimedivisor y = d \\<and>\n       ln (real (aprimedivisor d)) \\<le> ln (real (aprimedivisor y))", "by (intro bexI[of _ \"p ^ (2 * k)\"])\n         (auto simp: aprimedivisor_prime_power aprimedivisor_primepow)"], ["proof (state)\nthis:\n  \\<exists>y\\<in>{d \\<in> {2..n}. primepow_even d}.\n     y * aprimedivisor y = d \\<and>\n     ln (real (aprimedivisor d)) \\<le> ln (real (aprimedivisor y))\n\ngoal (3 subgoals):\n 1. finite {d \\<in> {2..n}. primepow_odd d}\n 2. finite {d \\<in> {2..n}. primepow_even d}\n 3. \\<And>y.\n       \\<lbrakk>y \\<in> {2..n}; primepow_even y\\<rbrakk>\n       \\<Longrightarrow> 0 \\<le> ln (real (aprimedivisor y))", "qed (simp_all add: of_nat_ge_1_iff Suc_le_eq)"], ["proof (state)\nthis:\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d.\n     ln (real (aprimedivisor d)))\n  \\<le> (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d.\n           ln (real (aprimedivisor d)))\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "also"], ["proof (state)\nthis:\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_odd d.\n     ln (real (aprimedivisor d)))\n  \\<le> (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d.\n           ln (real (aprimedivisor d)))\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "have \"\\<dots> = (\\<Sum>d\\<in>{d. d \\<in> {2..n} \\<and> primepow_even d}. mangoldt_even d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d.\n       ln (real (aprimedivisor d))) =\n    (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d. mangoldt_even d)", "by (intro sum.cong refl) (simp add: mangoldt_even_def)"], ["proof (state)\nthis:\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d.\n     ln (real (aprimedivisor d))) =\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d. mangoldt_even d)\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "also"], ["proof (state)\nthis:\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d.\n     ln (real (aprimedivisor d))) =\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d. mangoldt_even d)\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "have \"\\<dots> = psi_even_2 n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d. mangoldt_even d) =\n    sum mangoldt_even {2..n}", "unfolding mangoldt_even_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d.\n       if primepow_even d then ln (real (aprimedivisor d)) else 0) =\n    (\\<Sum>d = 2..n.\n        if primepow_even d then ln (real (aprimedivisor d)) else 0)", "by (rule sum.mono_neutral_left) auto"], ["proof (state)\nthis:\n  (\\<Sum>d | d \\<in> {2..n} \\<and> primepow_even d. mangoldt_even d) =\n  sum mangoldt_even {2..n}\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "finally"], ["proof (chain)\npicking this:\n  sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "show ?thesis"], ["proof (prove)\nusing this:\n  sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "."], ["proof (state)\nthis:\n  sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma psi_residues_compare:\n  \"psi_odd n \\<le> psi_even n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "have \"\\<not> primepow_odd 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> primepow_odd 1", "by (simp add: primepow_odd_def)"], ["proof (state)\nthis:\n  \\<not> primepow_odd 1\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "hence *: \"mangoldt_odd 1 = 0\""], ["proof (prove)\nusing this:\n  \\<not> primepow_odd 1\n\ngoal (1 subgoal):\n 1. mangoldt_odd 1 = 0", "by (simp add: mangoldt_odd_def)"], ["proof (state)\nthis:\n  mangoldt_odd 1 = 0\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "have \"\\<not> primepow_even 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> primepow_even 1", "using primepow_gt_Suc_0[OF primepow_even_imp_primepow, of 1]"], ["proof (prove)\nusing this:\n  primepow_even 1 \\<Longrightarrow> Suc 0 < 1\n\ngoal (1 subgoal):\n 1. \\<not> primepow_even 1", "by auto"], ["proof (state)\nthis:\n  \\<not> primepow_even 1\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "with mangoldt_even_def"], ["proof (chain)\npicking this:\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  \\<not> primepow_even 1", "have **: \"mangoldt_even 1 = 0\""], ["proof (prove)\nusing this:\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  \\<not> primepow_even 1\n\ngoal (1 subgoal):\n 1. mangoldt_even 1 = 0", "by simp"], ["proof (state)\nthis:\n  mangoldt_even 1 = 0\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "from psi_odd_def"], ["proof (chain)\npicking this:\n  psi_odd ?n = sum mangoldt_odd {1..?n}", "have \"psi_odd n = (\\<Sum>d=1..n. mangoldt_odd d)\""], ["proof (prove)\nusing this:\n  psi_odd ?n = sum mangoldt_odd {1..?n}\n\ngoal (1 subgoal):\n 1. psi_odd n = sum mangoldt_odd {1..n}", "by simp"], ["proof (state)\nthis:\n  psi_odd n = sum mangoldt_odd {1..n}\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "also"], ["proof (state)\nthis:\n  psi_odd n = sum mangoldt_odd {1..n}\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "from *"], ["proof (chain)\npicking this:\n  mangoldt_odd 1 = 0", "have \"\\<dots> = psi_odd_2 n\""], ["proof (prove)\nusing this:\n  mangoldt_odd 1 = 0\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {1..n} = sum mangoldt_odd {2..n}", "by (cases \"n \\<ge> 1\") (simp_all add: eval_nat_numeral sum.atLeast_Suc_atMost)"], ["proof (state)\nthis:\n  sum mangoldt_odd {1..n} = sum mangoldt_odd {2..n}\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "also"], ["proof (state)\nthis:\n  sum mangoldt_odd {1..n} = sum mangoldt_odd {2..n}\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "from psi_residues_compare_2"], ["proof (chain)\npicking this:\n  sum mangoldt_odd {2..?n} \\<le> sum mangoldt_even {2..?n}", "have \"\\<dots> \\<le> psi_even_2 n\""], ["proof (prove)\nusing this:\n  sum mangoldt_odd {2..?n} \\<le> sum mangoldt_even {2..?n}\n\ngoal (1 subgoal):\n 1. sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}", "."], ["proof (state)\nthis:\n  sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "also"], ["proof (state)\nthis:\n  sum mangoldt_odd {2..n} \\<le> sum mangoldt_even {2..n}\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "from **"], ["proof (chain)\npicking this:\n  mangoldt_even 1 = 0", "have \"\\<dots> = psi_even n\""], ["proof (prove)\nusing this:\n  mangoldt_even 1 = 0\n\ngoal (1 subgoal):\n 1. sum mangoldt_even {2..n} = psi_even n", "by (cases \"n \\<ge> 1\") (simp_all add: eval_nat_numeral sum.atLeast_Suc_atMost psi_even_def)"], ["proof (state)\nthis:\n  sum mangoldt_even {2..n} = psi_even n\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "finally"], ["proof (chain)\npicking this:\n  psi_odd n \\<le> psi_even n", "show ?thesis"], ["proof (prove)\nusing this:\n  psi_odd n \\<le> psi_even n\n\ngoal (1 subgoal):\n 1. psi_odd n \\<le> psi_even n", "."], ["proof (state)\nthis:\n  psi_odd n \\<le> psi_even n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma primepow_iff_even_sqr:\n  \"primepow n \\<longleftrightarrow> primepow_even (n^2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primepow n = primepow_even (n\\<^sup>2)", "by (cases \"n = 0\")\n     (auto simp: primepow_even_altdef aprimedivisor_primepow_power primepow_power_iff_nat\n                 prime_elem_multiplicity_power_distrib prime_aprimedivisor' prime_imp_prime_elem\n                 unit_factor_nat_def primepow_gt_0_nat dest: primepow_gt_Suc_0)"], ["", "lemma psi_sqrt: \"psi (Discrete.sqrt n) = psi_even n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt n) = psi_even n", "proof (induction n)"], ["proof (state)\ngoal (2 subgoals):\n 1. psi (Discrete.sqrt 0) = psi_even 0\n 2. \\<And>n.\n       psi (Discrete.sqrt n) = psi_even n \\<Longrightarrow>\n       psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. psi (Discrete.sqrt 0) = psi_even 0\n 2. \\<And>n.\n       psi (Discrete.sqrt n) = psi_even n \\<Longrightarrow>\n       psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "with psi_def psi_even_def"], ["proof (chain)\npicking this:\n  psi ?n = sum mangoldt {1..?n}\n  psi_even ?n = sum mangoldt_even {1..?n}", "show ?case"], ["proof (prove)\nusing this:\n  psi ?n = sum mangoldt {1..?n}\n  psi_even ?n = sum mangoldt_even {1..?n}\n\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt 0) = psi_even 0", "by simp"], ["proof (state)\nthis:\n  psi (Discrete.sqrt 0) = psi_even 0\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       psi (Discrete.sqrt n) = psi_even n \\<Longrightarrow>\n       psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       psi (Discrete.sqrt n) = psi_even n \\<Longrightarrow>\n       psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "case (Suc n)"], ["proof (state)\nthis:\n  psi (Discrete.sqrt n) = psi_even n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       psi (Discrete.sqrt n) = psi_even n \\<Longrightarrow>\n       psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "then"], ["proof (chain)\npicking this:\n  psi (Discrete.sqrt n) = psi_even n", "show ?case"], ["proof (prove)\nusing this:\n  psi (Discrete.sqrt n) = psi_even n\n\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "assume asm: \"\\<exists> m. Suc n = m^2\""], ["proof (state)\nthis:\n  \\<exists>m. Suc n = m\\<^sup>2\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "with sqrt_Suc"], ["proof (chain)\npicking this:\n  Discrete.sqrt (Suc ?n) =\n  (if \\<exists>m. Suc ?n = m\\<^sup>2 then Suc (Discrete.sqrt ?n)\n   else Discrete.sqrt ?n)\n  \\<exists>m. Suc n = m\\<^sup>2", "have sqrt_seq: \"Discrete.sqrt(Suc n) = Suc(Discrete.sqrt n)\""], ["proof (prove)\nusing this:\n  Discrete.sqrt (Suc ?n) =\n  (if \\<exists>m. Suc ?n = m\\<^sup>2 then Suc (Discrete.sqrt ?n)\n   else Discrete.sqrt ?n)\n  \\<exists>m. Suc n = m\\<^sup>2\n\ngoal (1 subgoal):\n 1. Discrete.sqrt (Suc n) = Suc (Discrete.sqrt n)", "by simp"], ["proof (state)\nthis:\n  Discrete.sqrt (Suc n) = Suc (Discrete.sqrt n)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "from asm"], ["proof (chain)\npicking this:\n  \\<exists>m. Suc n = m\\<^sup>2", "obtain \"m\" where \"   Suc n = m^2\""], ["proof (prove)\nusing this:\n  \\<exists>m. Suc n = m\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<And>m. Suc n = m\\<^sup>2 \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  Suc n = m\\<^sup>2\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "with sqrt_seq"], ["proof (chain)\npicking this:\n  Discrete.sqrt (Suc n) = Suc (Discrete.sqrt n)\n  Suc n = m\\<^sup>2", "have \"Suc(Discrete.sqrt n) = m\""], ["proof (prove)\nusing this:\n  Discrete.sqrt (Suc n) = Suc (Discrete.sqrt n)\n  Suc n = m\\<^sup>2\n\ngoal (1 subgoal):\n 1. Suc (Discrete.sqrt n) = m", "by simp"], ["proof (state)\nthis:\n  Suc (Discrete.sqrt n) = m\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "with \\<open>Suc n = m^2\\<close>"], ["proof (chain)\npicking this:\n  Suc n = m\\<^sup>2\n  Suc (Discrete.sqrt n) = m", "have suc_sqrt_n_sqrt: \"(Suc(Discrete.sqrt n))^2 = Suc n\""], ["proof (prove)\nusing this:\n  Suc n = m\\<^sup>2\n  Suc (Discrete.sqrt n) = m\n\ngoal (1 subgoal):\n 1. (Suc (Discrete.sqrt n))\\<^sup>2 = Suc n", "by simp"], ["proof (state)\nthis:\n  (Suc (Discrete.sqrt n))\\<^sup>2 = Suc n\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "from sqrt_seq"], ["proof (chain)\npicking this:\n  Discrete.sqrt (Suc n) = Suc (Discrete.sqrt n)", "have \"psi (Discrete.sqrt (Suc n)) = psi (Suc (Discrete.sqrt n))\""], ["proof (prove)\nusing this:\n  Discrete.sqrt (Suc n) = Suc (Discrete.sqrt n)\n\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt (Suc n)) = psi (Suc (Discrete.sqrt n))", "by simp"], ["proof (state)\nthis:\n  psi (Discrete.sqrt (Suc n)) = psi (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "also"], ["proof (state)\nthis:\n  psi (Discrete.sqrt (Suc n)) = psi (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "from psi_def"], ["proof (chain)\npicking this:\n  psi ?n = sum mangoldt {1..?n}", "have \"\\<dots> = psi (Discrete.sqrt n) + mangoldt (Suc (Discrete.sqrt n))\""], ["proof (prove)\nusing this:\n  psi ?n = sum mangoldt {1..?n}\n\ngoal (1 subgoal):\n 1. psi (Suc (Discrete.sqrt n)) =\n    psi (Discrete.sqrt n) + mangoldt (Suc (Discrete.sqrt n))", "by simp"], ["proof (state)\nthis:\n  psi (Suc (Discrete.sqrt n)) =\n  psi (Discrete.sqrt n) + mangoldt (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "also"], ["proof (state)\nthis:\n  psi (Suc (Discrete.sqrt n)) =\n  psi (Discrete.sqrt n) + mangoldt (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "from Suc.IH"], ["proof (chain)\npicking this:\n  psi (Discrete.sqrt n) = psi_even n", "have \"psi (Discrete.sqrt n) = psi_even n\""], ["proof (prove)\nusing this:\n  psi (Discrete.sqrt n) = psi_even n\n\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt n) = psi_even n", "."], ["proof (state)\nthis:\n  psi (Discrete.sqrt n) = psi_even n\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "also"], ["proof (state)\nthis:\n  psi (Discrete.sqrt n) = psi_even n\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "have \"mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "proof (cases \"primepow (Suc(Discrete.sqrt n))\")"], ["proof (state)\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "case True"], ["proof (state)\nthis:\n  primepow (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "with primepow_iff_even_sqr"], ["proof (chain)\npicking this:\n  primepow ?n = primepow_even (?n\\<^sup>2)\n  primepow (Suc (Discrete.sqrt n))", "have True2: \"primepow_even ((Suc(Discrete.sqrt n))^2)\""], ["proof (prove)\nusing this:\n  primepow ?n = primepow_even (?n\\<^sup>2)\n  primepow (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)", "by simp"], ["proof (state)\nthis:\n  primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "from suc_sqrt_n_sqrt"], ["proof (chain)\npicking this:\n  (Suc (Discrete.sqrt n))\\<^sup>2 = Suc n", "have \"mangoldt_even (Suc n) = mangoldt_even ((Suc(Discrete.sqrt n))^2)\""], ["proof (prove)\nusing this:\n  (Suc (Discrete.sqrt n))\\<^sup>2 = Suc n\n\ngoal (1 subgoal):\n 1. mangoldt_even (Suc n) = mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2)", "by simp"], ["proof (state)\nthis:\n  mangoldt_even (Suc n) = mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "also"], ["proof (state)\nthis:\n  mangoldt_even (Suc n) = mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "from mangoldt_even_def True2"], ["proof (chain)\npicking this:\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)", "have \"\\<dots> = ln (aprimedivisor ((Suc (Discrete.sqrt n))^2))\""], ["proof (prove)\nusing this:\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2) =\n    ln (real (aprimedivisor ((Suc (Discrete.sqrt n))\\<^sup>2)))", "by simp"], ["proof (state)\nthis:\n  mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2) =\n  ln (real (aprimedivisor ((Suc (Discrete.sqrt n))\\<^sup>2)))\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "also"], ["proof (state)\nthis:\n  mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2) =\n  ln (real (aprimedivisor ((Suc (Discrete.sqrt n))\\<^sup>2)))\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "from True"], ["proof (chain)\npicking this:\n  primepow (Suc (Discrete.sqrt n))", "have \"aprimedivisor ((Suc (Discrete.sqrt n))^2) = aprimedivisor (Suc (Discrete.sqrt n))\""], ["proof (prove)\nusing this:\n  primepow (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. aprimedivisor ((Suc (Discrete.sqrt n))\\<^sup>2) =\n    aprimedivisor (Suc (Discrete.sqrt n))", "by (simp add: aprimedivisor_primepow_power)"], ["proof (state)\nthis:\n  aprimedivisor ((Suc (Discrete.sqrt n))\\<^sup>2) =\n  aprimedivisor (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "also"], ["proof (state)\nthis:\n  aprimedivisor ((Suc (Discrete.sqrt n))\\<^sup>2) =\n  aprimedivisor (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "from True"], ["proof (chain)\npicking this:\n  primepow (Suc (Discrete.sqrt n))", "have \"ln (\\<dots>) = mangoldt (Suc (Discrete.sqrt n))\""], ["proof (prove)\nusing this:\n  primepow (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. ln (real (aprimedivisor (Suc (Discrete.sqrt n)))) =\n    mangoldt (Suc (Discrete.sqrt n))", "by (simp add: mangoldt_def)"], ["proof (state)\nthis:\n  ln (real (aprimedivisor (Suc (Discrete.sqrt n)))) =\n  mangoldt (Suc (Discrete.sqrt n))\n\ngoal (2 subgoals):\n 1. primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n 2. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "finally"], ["proof (chain)\npicking this:\n  mangoldt_even (Suc n) = mangoldt (Suc (Discrete.sqrt n))", "show ?thesis"], ["proof (prove)\nusing this:\n  mangoldt_even (Suc n) = mangoldt (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", ".."], ["proof (state)\nthis:\n  mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "case False"], ["proof (state)\nthis:\n  \\<not> primepow (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "with primepow_iff_even_sqr"], ["proof (chain)\npicking this:\n  primepow ?n = primepow_even (?n\\<^sup>2)\n  \\<not> primepow (Suc (Discrete.sqrt n))", "have False2: \"\\<not> primepow_even ((Suc(Discrete.sqrt n))^2)\""], ["proof (prove)\nusing this:\n  primepow ?n = primepow_even (?n\\<^sup>2)\n  \\<not> primepow (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. \\<not> primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)", "by simp"], ["proof (state)\nthis:\n  \\<not> primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "from suc_sqrt_n_sqrt"], ["proof (chain)\npicking this:\n  (Suc (Discrete.sqrt n))\\<^sup>2 = Suc n", "have \"mangoldt_even (Suc n) = mangoldt_even ((Suc(Discrete.sqrt n))^2)\""], ["proof (prove)\nusing this:\n  (Suc (Discrete.sqrt n))\\<^sup>2 = Suc n\n\ngoal (1 subgoal):\n 1. mangoldt_even (Suc n) = mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2)", "by simp"], ["proof (state)\nthis:\n  mangoldt_even (Suc n) = mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "also"], ["proof (state)\nthis:\n  mangoldt_even (Suc n) = mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "from mangoldt_even_def False2"], ["proof (chain)\npicking this:\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  \\<not> primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)", "have \"\\<dots> = 0\""], ["proof (prove)\nusing this:\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  \\<not> primepow_even ((Suc (Discrete.sqrt n))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2) = 0", "by simp"], ["proof (state)\nthis:\n  mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2) = 0\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "also"], ["proof (state)\nthis:\n  mangoldt_even ((Suc (Discrete.sqrt n))\\<^sup>2) = 0\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "from False"], ["proof (chain)\npicking this:\n  \\<not> primepow (Suc (Discrete.sqrt n))", "have \"\\<dots> = mangoldt (Suc (Discrete.sqrt n))\""], ["proof (prove)\nusing this:\n  \\<not> primepow (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. 0 = mangoldt (Suc (Discrete.sqrt n))", "by (simp add: mangoldt_def)"], ["proof (state)\nthis:\n  0 = mangoldt (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. \\<not> primepow (Suc (Discrete.sqrt n)) \\<Longrightarrow>\n    mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", "finally"], ["proof (chain)\npicking this:\n  mangoldt_even (Suc n) = mangoldt (Suc (Discrete.sqrt n))", "show ?thesis"], ["proof (prove)\nusing this:\n  mangoldt_even (Suc n) = mangoldt (Suc (Discrete.sqrt n))\n\ngoal (1 subgoal):\n 1. mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)", ".."], ["proof (state)\nthis:\n  mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "also"], ["proof (state)\nthis:\n  mangoldt (Suc (Discrete.sqrt n)) = mangoldt_even (Suc n)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "from psi_even_def"], ["proof (chain)\npicking this:\n  psi_even ?n = sum mangoldt_even {1..?n}", "have \"psi_even n + mangoldt_even (Suc n) = psi_even (Suc n)\""], ["proof (prove)\nusing this:\n  psi_even ?n = sum mangoldt_even {1..?n}\n\ngoal (1 subgoal):\n 1. psi_even n + mangoldt_even (Suc n) = psi_even (Suc n)", "by simp"], ["proof (state)\nthis:\n  psi_even n + mangoldt_even (Suc n) = psi_even (Suc n)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n 2. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n; \\<not> ?P1\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "finally"], ["proof (chain)\npicking this:\n  psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "show ?case"], ["proof (prove)\nusing this:\n  psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "."], ["proof (state)\nthis:\n  psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n;\n     \\<nexists>m. Suc n = m\\<^sup>2\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n;\n     \\<nexists>m. Suc n = m\\<^sup>2\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "assume asm: \"\\<not>(\\<exists>m. Suc n = m^2)\""], ["proof (state)\nthis:\n  \\<nexists>m. Suc n = m\\<^sup>2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n;\n     \\<nexists>m. Suc n = m\\<^sup>2\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "with sqrt_Suc"], ["proof (chain)\npicking this:\n  Discrete.sqrt (Suc ?n) =\n  (if \\<exists>m. Suc ?n = m\\<^sup>2 then Suc (Discrete.sqrt ?n)\n   else Discrete.sqrt ?n)\n  \\<nexists>m. Suc n = m\\<^sup>2", "have sqrt_eq: \"Discrete.sqrt (Suc n) = Discrete.sqrt n\""], ["proof (prove)\nusing this:\n  Discrete.sqrt (Suc ?n) =\n  (if \\<exists>m. Suc ?n = m\\<^sup>2 then Suc (Discrete.sqrt ?n)\n   else Discrete.sqrt ?n)\n  \\<nexists>m. Suc n = m\\<^sup>2\n\ngoal (1 subgoal):\n 1. Discrete.sqrt (Suc n) = Discrete.sqrt n", "by simp"], ["proof (state)\nthis:\n  Discrete.sqrt (Suc n) = Discrete.sqrt n\n\ngoal (1 subgoal):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n;\n     \\<nexists>m. Suc n = m\\<^sup>2\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "then"], ["proof (chain)\npicking this:\n  Discrete.sqrt (Suc n) = Discrete.sqrt n", "have lhs: \"psi (Discrete.sqrt (Suc n)) = psi (Discrete.sqrt n)\""], ["proof (prove)\nusing this:\n  Discrete.sqrt (Suc n) = Discrete.sqrt n\n\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt (Suc n)) = psi (Discrete.sqrt n)", "by simp"], ["proof (state)\nthis:\n  psi (Discrete.sqrt (Suc n)) = psi (Discrete.sqrt n)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n;\n     \\<nexists>m. Suc n = m\\<^sup>2\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "have \"\\<not> primepow_even (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> primepow_even (Suc n)", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. primepow_even (Suc n) \\<Longrightarrow> False", "assume \"primepow_even (Suc n)\""], ["proof (state)\nthis:\n  primepow_even (Suc n)\n\ngoal (1 subgoal):\n 1. primepow_even (Suc n) \\<Longrightarrow> False", "with primepow_even_def"], ["proof (chain)\npicking this:\n  primepow_even ?q =\n  (\\<exists>p k. 1 \\<le> k \\<and> prime p \\<and> ?q = p ^ (2 * k))\n  primepow_even (Suc n)", "obtain \"p\" \"k\"\n            where \"1 \\<le> k \\<and> prime p \\<and> Suc n = p ^ (2 * k)\""], ["proof (prove)\nusing this:\n  primepow_even ?q =\n  (\\<exists>p k. 1 \\<le> k \\<and> prime p \\<and> ?q = p ^ (2 * k))\n  primepow_even (Suc n)\n\ngoal (1 subgoal):\n 1. (\\<And>k p.\n        1 \\<le> k \\<and>\n        prime p \\<and> Suc n = p ^ (2 * k) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  1 \\<le> k \\<and> prime p \\<and> Suc n = p ^ (2 * k)\n\ngoal (1 subgoal):\n 1. primepow_even (Suc n) \\<Longrightarrow> False", "with power_even_eq"], ["proof (chain)\npicking this:\n  ?a ^ (2 * ?n) = (?a ^ ?n)\\<^sup>2\n  1 \\<le> k \\<and> prime p \\<and> Suc n = p ^ (2 * k)", "have \"Suc n = (p ^ k)^2\""], ["proof (prove)\nusing this:\n  ?a ^ (2 * ?n) = (?a ^ ?n)\\<^sup>2\n  1 \\<le> k \\<and> prime p \\<and> Suc n = p ^ (2 * k)\n\ngoal (1 subgoal):\n 1. Suc n = (p ^ k)\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  Suc n = (p ^ k)\\<^sup>2\n\ngoal (1 subgoal):\n 1. primepow_even (Suc n) \\<Longrightarrow> False", "with asm"], ["proof (chain)\npicking this:\n  \\<nexists>m. Suc n = m\\<^sup>2\n  Suc n = (p ^ k)\\<^sup>2", "show False"], ["proof (prove)\nusing this:\n  \\<nexists>m. Suc n = m\\<^sup>2\n  Suc n = (p ^ k)\\<^sup>2\n\ngoal (1 subgoal):\n 1. False", "by blast"], ["proof (state)\nthis:\n  False\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<not> primepow_even (Suc n)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n;\n     \\<nexists>m. Suc n = m\\<^sup>2\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "with psi_even_def mangoldt_even_def"], ["proof (chain)\npicking this:\n  psi_even ?n = sum mangoldt_even {1..?n}\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  \\<not> primepow_even (Suc n)", "have rhs: \"psi_even (Suc n) = psi_even n\""], ["proof (prove)\nusing this:\n  psi_even ?n = sum mangoldt_even {1..?n}\n  mangoldt_even ?d =\n  (if primepow_even ?d then ln (real (aprimedivisor ?d)) else 0)\n  \\<not> primepow_even (Suc n)\n\ngoal (1 subgoal):\n 1. psi_even (Suc n) = psi_even n", "by simp"], ["proof (state)\nthis:\n  psi_even (Suc n) = psi_even n\n\ngoal (1 subgoal):\n 1. \\<lbrakk>psi (Discrete.sqrt n) = psi_even n;\n     \\<nexists>m. Suc n = m\\<^sup>2\\<rbrakk>\n    \\<Longrightarrow> psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "from Suc.IH lhs rhs"], ["proof (chain)\npicking this:\n  psi (Discrete.sqrt n) = psi_even n\n  psi (Discrete.sqrt (Suc n)) = psi (Discrete.sqrt n)\n  psi_even (Suc n) = psi_even n", "show ?case"], ["proof (prove)\nusing this:\n  psi (Discrete.sqrt n) = psi_even n\n  psi (Discrete.sqrt (Suc n)) = psi (Discrete.sqrt n)\n  psi_even (Suc n) = psi_even n\n\ngoal (1 subgoal):\n 1. psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)", "by simp"], ["proof (state)\nthis:\n  psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  psi (Discrete.sqrt (Suc n)) = psi_even (Suc n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma mangoldt_split:\n  \"mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "proof (cases \"primepow d\")"], ["proof (state)\ngoal (2 subgoals):\n 1. primepow d \\<Longrightarrow>\n    mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d\n 2. \\<not> primepow d \\<Longrightarrow>\n    mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "case False"], ["proof (state)\nthis:\n  \\<not> primepow d\n\ngoal (2 subgoals):\n 1. primepow d \\<Longrightarrow>\n    mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d\n 2. \\<not> primepow d \\<Longrightarrow>\n    mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<not> primepow d\n\ngoal (1 subgoal):\n 1. mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "by (auto simp: mangoldt_def mangoldt_1_def mangoldt_even_def mangoldt_odd_def\n             dest: primepow_even_imp_primepow primepow_odd_imp_primepow)"], ["proof (state)\nthis:\n  mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d\n\ngoal (1 subgoal):\n 1. primepow d \\<Longrightarrow>\n    mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. primepow d \\<Longrightarrow>\n    mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "case True"], ["proof (state)\nthis:\n  primepow d\n\ngoal (1 subgoal):\n 1. primepow d \\<Longrightarrow>\n    mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "thus ?thesis"], ["proof (prove)\nusing this:\n  primepow d\n\ngoal (1 subgoal):\n 1. mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d", "by (auto simp: mangoldt_def mangoldt_1_def mangoldt_even_def mangoldt_odd_def primepow_cases)"], ["proof (state)\nthis:\n  mangoldt d = mangoldt_1 d + mangoldt_even d + mangoldt_odd d\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma psi_split: \"psi n = theta n + psi_even n + psi_odd n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n = theta n + psi_even n + psi_odd n", "by (induction n) \n     (simp_all add: psi_def theta_def psi_even_def psi_odd_def mangoldt_1_def mangoldt_split)"], ["", "lemma psi_mono: \"m \\<le> n \\<Longrightarrow> psi m \\<le> psi n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<le> n \\<Longrightarrow> psi m \\<le> psi n", "unfolding psi_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<le> n \\<Longrightarrow>\n    sum mangoldt {1..m} \\<le> sum mangoldt {1..n}", "by (intro sum_mono2 mangoldt_nonneg) auto"], ["", "lemma psi_pos: \"0 \\<le> psi n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> psi n", "by (auto simp: psi_def intro!: sum_nonneg mangoldt_nonneg)"], ["", "lemma mangoldt_odd_pos: \"0 \\<le> mangoldt_odd d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> mangoldt_odd d", "using aprimedivisor_gt_Suc_0[of d]"], ["proof (prove)\nusing this:\n  d \\<noteq> Suc 0 \\<Longrightarrow> Suc 0 < aprimedivisor d\n\ngoal (1 subgoal):\n 1. 0 \\<le> mangoldt_odd d", "by (auto simp: mangoldt_odd_def of_nat_le_iff[of 1, unfolded of_nat_1] Suc_le_eq\n           intro!: ln_ge_zero dest!: primepow_odd_imp_primepow primepow_gt_Suc_0)"], ["", "lemma psi_odd_mono: \"m \\<le> n \\<Longrightarrow> psi_odd m \\<le> psi_odd n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<le> n \\<Longrightarrow> psi_odd m \\<le> psi_odd n", "using mangoldt_odd_pos sum_mono2[of \"{1..n}\" \"{1..m}\" \"mangoldt_odd\"]"], ["proof (prove)\nusing this:\n  0 \\<le> mangoldt_odd ?d\n  \\<lbrakk>finite {1..n}; {1..m} \\<subseteq> {1..n};\n   \\<And>b.\n      b \\<in> {1..n} - {1..m} \\<Longrightarrow>\n      0 \\<le> mangoldt_odd b\\<rbrakk>\n  \\<Longrightarrow> sum mangoldt_odd {1..m} \\<le> sum mangoldt_odd {1..n}\n\ngoal (1 subgoal):\n 1. m \\<le> n \\<Longrightarrow> psi_odd m \\<le> psi_odd n", "by (simp add: psi_odd_def)"], ["", "lemma psi_odd_pos: \"0 \\<le> psi_odd n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> psi_odd n", "by (auto simp: psi_odd_def intro!: sum_nonneg mangoldt_odd_pos)"], ["", "lemma psi_theta:\n  \"theta n + psi (Discrete.sqrt n) \\<le> psi n\" \"psi n \\<le> theta n + 2 * psi (Discrete.sqrt n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. theta n + psi (Discrete.sqrt n) \\<le> psi n &&&\n    psi n \\<le> theta n + 2 * psi (Discrete.sqrt n)", "using psi_odd_pos[of n] psi_residues_compare[of n] psi_sqrt[of n] psi_split[of n]"], ["proof (prove)\nusing this:\n  0 \\<le> psi_odd n\n  psi_odd n \\<le> psi_even n\n  psi (Discrete.sqrt n) = psi_even n\n  psi n = theta n + psi_even n + psi_odd n\n\ngoal (1 subgoal):\n 1. theta n + psi (Discrete.sqrt n) \\<le> psi n &&&\n    psi n \\<le> theta n + 2 * psi (Discrete.sqrt n)", "by simp_all"], ["", "context\nbegin"], ["", "private"], ["", "lemma sum_minus_one: \n  \"(\\<Sum>x \\<in> {1..y}. (- 1 :: real) ^ (x + 1)) = (if odd y then 1 else 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x = 1..y. (- 1) ^ (x + 1)) = (if odd y then 1 else 0)", "by (induction y) simp_all"], ["", "private"], ["", "lemma div_invert:\n  fixes x y n :: nat\n  assumes \"x > 0\" \"y > 0\" \"y \\<le> n div x\"\n  shows \"x \\<le> n div y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> n div y", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<le> n div y", "from assms(1,3)"], ["proof (chain)\npicking this:\n  0 < x\n  y \\<le> n div x", "have \"y * x \\<le> (n div x) * x\""], ["proof (prove)\nusing this:\n  0 < x\n  y \\<le> n div x\n\ngoal (1 subgoal):\n 1. y * x \\<le> n div x * x", "by simp"], ["proof (state)\nthis:\n  y * x \\<le> n div x * x\n\ngoal (1 subgoal):\n 1. x \\<le> n div y", "also"], ["proof (state)\nthis:\n  y * x \\<le> n div x * x\n\ngoal (1 subgoal):\n 1. x \\<le> n div y", "have \"\\<dots> \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n div x * x \\<le> n", "by (simp add: minus_mod_eq_div_mult[symmetric])"], ["proof (state)\nthis:\n  n div x * x \\<le> n\n\ngoal (1 subgoal):\n 1. x \\<le> n div y", "finally"], ["proof (chain)\npicking this:\n  y * x \\<le> n", "have \"y * x \\<le> n\""], ["proof (prove)\nusing this:\n  y * x \\<le> n\n\ngoal (1 subgoal):\n 1. y * x \\<le> n", "."], ["proof (state)\nthis:\n  y * x \\<le> n\n\ngoal (1 subgoal):\n 1. x \\<le> n div y", "with assms(2)"], ["proof (chain)\npicking this:\n  0 < y\n  y * x \\<le> n", "show ?thesis"], ["proof (prove)\nusing this:\n  0 < y\n  y * x \\<le> n\n\ngoal (1 subgoal):\n 1. x \\<le> n div y", "using div_le_mono[of \"y*x\" n y]"], ["proof (prove)\nusing this:\n  0 < y\n  y * x \\<le> n\n  y * x \\<le> n \\<Longrightarrow> y * x div y \\<le> n div y\n\ngoal (1 subgoal):\n 1. x \\<le> n div y", "by simp"], ["proof (state)\nthis:\n  x \\<le> n div y\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma sum_expand_lemma:\n  \"(\\<Sum>d=1..n. (-1) ^ (d + 1) * psi (n div d)) = \n     (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "have **: \"x \\<le> n\" if \"x \\<le> n div y\" for x y"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le> n", "using div_le_dividend order_trans that"], ["proof (prove)\nusing this:\n  ?m div ?n \\<le> ?m\n  \\<lbrakk>?x \\<le> ?y; ?y \\<le> ?z\\<rbrakk> \\<Longrightarrow> ?x \\<le> ?z\n  x \\<le> n div y\n\ngoal (1 subgoal):\n 1. x \\<le> n", "by blast"], ["proof (state)\nthis:\n  ?x \\<le> n div ?y \\<Longrightarrow> ?x \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "have \"(\\<Sum>d=1..n. (-1)^(d+1) * psi (n div d)) = \n          (\\<Sum>d=1..n. (-1)^(d+1) * (\\<Sum>e=1..n div d. mangoldt e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * sum mangoldt {1..n div d})", "by (simp add: psi_def)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * sum mangoldt {1..n div d})\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * sum mangoldt {1..n div d})\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "have \"\\<dots> = (\\<Sum>d = 1..n. \\<Sum>e = 1..n div d. (-1)^(d+1) * mangoldt e)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * sum mangoldt {1..n div d}) =\n    (\\<Sum>d = 1..n. \\<Sum>e = 1..n div d. (- 1) ^ (d + 1) * mangoldt e)", "by (simp add: sum_distrib_left)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * sum mangoldt {1..n div d}) =\n  (\\<Sum>d = 1..n. \\<Sum>e = 1..n div d. (- 1) ^ (d + 1) * mangoldt e)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * sum mangoldt {1..n div d}) =\n  (\\<Sum>d = 1..n. \\<Sum>e = 1..n div d. (- 1) ^ (d + 1) * mangoldt e)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "from **"], ["proof (chain)\npicking this:\n  ?x \\<le> n div ?y \\<Longrightarrow> ?x \\<le> n", "have \"\\<dots> = (\\<Sum>d = 1..n. \\<Sum>e\\<in>{y\\<in>{1..n}. y \\<le> n div d}. (-1)^(d+1) * mangoldt e)\""], ["proof (prove)\nusing this:\n  ?x \\<le> n div ?y \\<Longrightarrow> ?x \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. \\<Sum>e = 1..n div d. (- 1) ^ (d + 1) * mangoldt e) =\n    (\\<Sum>d = 1..n.\n        \\<Sum>e\\<in>{y \\<in> {1..n}. y \\<le> n div d}.\n          (- 1) ^ (d + 1) * mangoldt e)", "by (intro sum.cong) auto"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. \\<Sum>e = 1..n div d. (- 1) ^ (d + 1) * mangoldt e) =\n  (\\<Sum>d = 1..n.\n      \\<Sum>e\\<in>{y \\<in> {1..n}. y \\<le> n div d}.\n        (- 1) ^ (d + 1) * mangoldt e)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. \\<Sum>e = 1..n div d. (- 1) ^ (d + 1) * mangoldt e) =\n  (\\<Sum>d = 1..n.\n      \\<Sum>e\\<in>{y \\<in> {1..n}. y \\<le> n div d}.\n        (- 1) ^ (d + 1) * mangoldt e)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "have \"\\<dots> = (\\<Sum>y = 1..n. \\<Sum>x | x \\<in> {1..n} \\<and> y \\<le> n div x. (- 1) ^ (x + 1) * mangoldt y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        \\<Sum>e\\<in>{y \\<in> {1..n}. y \\<le> n div d}.\n          (- 1) ^ (d + 1) * mangoldt e) =\n    (\\<Sum>y = 1..n.\n        \\<Sum>x | x \\<in> {1..n} \\<and> y \\<le> n div x.\n          (- 1) ^ (x + 1) * mangoldt y)", "by (rule sum.swap_restrict) simp_all"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      \\<Sum>e\\<in>{y \\<in> {1..n}. y \\<le> n div d}.\n        (- 1) ^ (d + 1) * mangoldt e) =\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> y \\<le> n div x.\n        (- 1) ^ (x + 1) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      \\<Sum>e\\<in>{y \\<in> {1..n}. y \\<le> n div d}.\n        (- 1) ^ (d + 1) * mangoldt e) =\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> y \\<le> n div x.\n        (- 1) ^ (x + 1) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "have \"\\<dots> = (\\<Sum>y = 1..n. \\<Sum>x | x \\<in> {1..n} \\<and> x \\<le> n div y. (- 1) ^ (x + 1) * mangoldt y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>y = 1..n.\n        \\<Sum>x | x \\<in> {1..n} \\<and> y \\<le> n div x.\n          (- 1) ^ (x + 1) * mangoldt y) =\n    (\\<Sum>y = 1..n.\n        \\<Sum>x | x \\<in> {1..n} \\<and> x \\<le> n div y.\n          (- 1) ^ (x + 1) * mangoldt y)", "by (intro sum.cong) (auto intro: div_invert)"], ["proof (state)\nthis:\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> y \\<le> n div x.\n        (- 1) ^ (x + 1) * mangoldt y) =\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> x \\<le> n div y.\n        (- 1) ^ (x + 1) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "also"], ["proof (state)\nthis:\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> y \\<le> n div x.\n        (- 1) ^ (x + 1) * mangoldt y) =\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> x \\<le> n div y.\n        (- 1) ^ (x + 1) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "from **"], ["proof (chain)\npicking this:\n  ?x \\<le> n div ?y \\<Longrightarrow> ?x \\<le> n", "have \"\\<dots> = (\\<Sum>y = 1..n. \\<Sum>x \\<in> {1..n div y}. (- 1) ^ (x + 1) * mangoldt y)\""], ["proof (prove)\nusing this:\n  ?x \\<le> n div ?y \\<Longrightarrow> ?x \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>y = 1..n.\n        \\<Sum>x | x \\<in> {1..n} \\<and> x \\<le> n div y.\n          (- 1) ^ (x + 1) * mangoldt y) =\n    (\\<Sum>y = 1..n. \\<Sum>x = 1..n div y. (- 1) ^ (x + 1) * mangoldt y)", "by (intro sum.cong) auto"], ["proof (state)\nthis:\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> x \\<le> n div y.\n        (- 1) ^ (x + 1) * mangoldt y) =\n  (\\<Sum>y = 1..n. \\<Sum>x = 1..n div y. (- 1) ^ (x + 1) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "also"], ["proof (state)\nthis:\n  (\\<Sum>y = 1..n.\n      \\<Sum>x | x \\<in> {1..n} \\<and> x \\<le> n div y.\n        (- 1) ^ (x + 1) * mangoldt y) =\n  (\\<Sum>y = 1..n. \\<Sum>x = 1..n div y. (- 1) ^ (x + 1) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "have \"\\<dots> = (\\<Sum>y = 1..n. (\\<Sum>x \\<in> {1..n div y}. (- 1) ^ (x + 1)) * mangoldt y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>y = 1..n. \\<Sum>x = 1..n div y. (- 1) ^ (x + 1) * mangoldt y) =\n    (\\<Sum>y = 1..n. (\\<Sum>x = 1..n div y. (- 1) ^ (x + 1)) * mangoldt y)", "by (intro sum.cong) (simp_all add: sum_distrib_right)"], ["proof (state)\nthis:\n  (\\<Sum>y = 1..n. \\<Sum>x = 1..n div y. (- 1) ^ (x + 1) * mangoldt y) =\n  (\\<Sum>y = 1..n. (\\<Sum>x = 1..n div y. (- 1) ^ (x + 1)) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "also"], ["proof (state)\nthis:\n  (\\<Sum>y = 1..n. \\<Sum>x = 1..n div y. (- 1) ^ (x + 1) * mangoldt y) =\n  (\\<Sum>y = 1..n. (\\<Sum>x = 1..n div y. (- 1) ^ (x + 1)) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "have \"\\<dots> = (\\<Sum>y = 1..n. (if odd (n div y) then 1 else 0) * mangoldt y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>y = 1..n. (\\<Sum>x = 1..n div y. (- 1) ^ (x + 1)) * mangoldt y) =\n    (\\<Sum>y = 1..n. (if odd (n div y) then 1 else 0) * mangoldt y)", "by (intro sum.cong refl) (simp_all only: sum_minus_one)"], ["proof (state)\nthis:\n  (\\<Sum>y = 1..n. (\\<Sum>x = 1..n div y. (- 1) ^ (x + 1)) * mangoldt y) =\n  (\\<Sum>y = 1..n. (if odd (n div y) then 1 else 0) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n  (\\<Sum>y = 1..n. (if odd (n div y) then 1 else 0) * mangoldt y)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n  (\\<Sum>y = 1..n. (if odd (n div y) then 1 else 0) * mangoldt y)\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n  (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)\n\ngoal:\nNo subgoals!", "qed"], ["", "private"], ["", "lemma floor_half_interval:\n  fixes n d :: nat\n  assumes \"d \\<noteq> 0\"\n  shows \"real (n div d) - real (2 * ((n div 2) div d)) = (if odd (n div d) then 1 else 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "have \"((n div 2) div d) = (n div (2 * d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n div 2 div d = n div (2 * d)", "by (rule div_mult2_eq[symmetric])"], ["proof (state)\nthis:\n  n div 2 div d = n div (2 * d)\n\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "also"], ["proof (state)\nthis:\n  n div 2 div d = n div (2 * d)\n\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "have \"\\<dots> = ((n div d) div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n div (2 * d) = n div d div 2", "by (simp add: mult_ac div_mult2_eq)"], ["proof (state)\nthis:\n  n div (2 * d) = n div d div 2\n\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "also"], ["proof (state)\nthis:\n  n div (2 * d) = n div d div 2\n\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "have \"real (n div d) - real (2 * \\<dots>) = (if odd (n div d) then 1 else 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div d div 2)) =\n    (if odd (n div d) then 1 else 0)", "by (cases \"odd (n div d)\", cases \"n div d = 0 \", simp_all)"], ["proof (state)\nthis:\n  real (n div d) - real (2 * (n div d div 2)) =\n  (if odd (n div d) then 1 else 0)\n\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "finally"], ["proof (chain)\npicking this:\n  real (n div d) - real (2 * (n div 2 div d)) =\n  (if odd (n div d) then 1 else 0)", "show ?thesis"], ["proof (prove)\nusing this:\n  real (n div d) - real (2 * (n div 2 div d)) =\n  (if odd (n div d) then 1 else 0)\n\ngoal (1 subgoal):\n 1. real (n div d) - real (2 * (n div 2 div d)) =\n    (if odd (n div d) then 1 else 0)", "by simp"], ["proof (state)\nthis:\n  real (n div d) - real (2 * (n div 2 div d)) =\n  (if odd (n div d) then 1 else 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma fact_expand_psi:\n  \"ln (fact n) - 2 * ln (fact (n div 2)) = (\\<Sum>d=1..n. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d=1..n. mangoldt d * \\<lfloor>n / d\\<rfloor>) - 2 * (\\<Sum>d=1..n div 2. mangoldt d * \\<lfloor>(n div 2) / d\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n    2 *\n    (\\<Sum>d = 1..n div 2.\n        mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "by (simp add:  ln_fact_conv_mangoldt)"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n  2 *\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d=1..n div 2. mangoldt d * \\<lfloor>real (n div 2) / d\\<rfloor>) =\n               (\\<Sum>d=1..n. mangoldt d * \\<lfloor>real (n div 2) / d\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n div 2.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "by (rule sum.mono_neutral_left) (auto simp: floor_unique[of 0])"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n div 2.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"2 * \\<dots> = (\\<Sum>d=1..n. mangoldt d * 2 * \\<lfloor>real (n div 2) / d\\<rfloor>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 *\n    (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * 2 *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "by (simp add: sum_distrib_left mult_ac)"], ["proof (state)\nthis:\n  2 *\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  2 *\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d=1..n. mangoldt d * \\<lfloor>n / d\\<rfloor>) - \\<dots> = \n               (\\<Sum>d=1..n. (mangoldt d * \\<lfloor>n / d\\<rfloor> - mangoldt d * 2 * \\<lfloor>real (n div 2) / d\\<rfloor>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n    (\\<Sum>d = 1..n.\n        mangoldt d * 2 *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n    (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n        mangoldt d * 2 *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)", "by (simp add: sum_subtractf)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n  (\\<Sum>d = 1..n.\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n  (\\<Sum>d = 1..n.\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> = (\\<Sum>d=1..n. mangoldt d * (\\<lfloor>n / d\\<rfloor> - 2 * \\<lfloor>real (n div 2) / d\\<rfloor>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n        mangoldt d * 2 *\n        real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n    (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int\n         (\\<lfloor>real n / real d\\<rfloor> -\n          2 * \\<lfloor>real (n div 2) / real d\\<rfloor>))", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int\n       (\\<lfloor>real n / real d\\<rfloor> -\n        2 * \\<lfloor>real (n div 2) / real d\\<rfloor>))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor> -\n      mangoldt d * 2 *\n      real_of_int \\<lfloor>real (n div 2) / real d\\<rfloor>) =\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int\n       (\\<lfloor>real n / real d\\<rfloor> -\n        2 * \\<lfloor>real (n div 2) / real d\\<rfloor>))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> = (\\<Sum>d=1..n. mangoldt d * (if odd(n div d) then 1 else 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d *\n        real_of_int\n         (\\<lfloor>real n / real d\\<rfloor> -\n          2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)) =\n    (\\<Sum>d = 1..n. mangoldt d * (if odd (n div d) then 1 else 0))", "by (intro sum.cong refl)\n       (simp_all add: floor_conv_div_nat [symmetric] floor_half_interval [symmetric])"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int\n       (\\<lfloor>real n / real d\\<rfloor> -\n        2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)) =\n  (\\<Sum>d = 1..n. mangoldt d * (if odd (n div d) then 1 else 0))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      real_of_int\n       (\\<lfloor>real n / real d\\<rfloor> -\n        2 * \\<lfloor>real (n div 2) / real d\\<rfloor>)) =\n  (\\<Sum>d = 1..n. mangoldt d * (if odd (n div d) then 1 else 0))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> = (\\<Sum>d=1..n. (if odd(n div d) then 1 else 0) * mangoldt d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. mangoldt d * (if odd (n div d) then 1 else 0)) =\n    (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)", "by (simp add: mult_ac)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. mangoldt d * (if odd (n div d) then 1 else 0)) =\n  (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. mangoldt d * (if odd (n div d) then 1 else 0)) =\n  (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "from sum_expand_lemma[symmetric]"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..?n. (if odd (?n div d) then 1 else 0) * mangoldt d) =\n  (\\<Sum>d = 1..?n. (- 1) ^ (d + 1) * psi (?n div d))", "have \"\\<dots> = (\\<Sum>d=1..n. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..?n. (if odd (?n div d) then 1 else 0) * mangoldt d) =\n  (\\<Sum>d = 1..?n. (- 1) ^ (d + 1) * psi (?n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (if odd (n div d) then 1 else 0) * mangoldt d) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  ln (fact n) - 2 * ln (fact (n div 2)) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "show ?thesis"], ["proof (prove)\nusing this:\n  ln (fact n) - 2 * ln (fact (n div 2)) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal:\nNo subgoals!", "qed"], ["", "end"], ["", "lemma psi_expansion_cutoff:\n  assumes \"m \\<le> p\"\n  shows   \"(\\<Sum>d=1..2*m. (-1)^(d+1) * psi (n div d)) \\<le> (\\<Sum>d=1..2*p. (-1)^(d+1) * psi (n div d))\"\n          \"(\\<Sum>d=1..2*p+1. (-1)^(d+1) * psi (n div d)) \\<le> (\\<Sum>d=1..2*m+1. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * m. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d)) &&&\n    (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * m + 1. (- 1) ^ (d + 1) * psi (n div d))", "using assms"], ["proof (prove)\nusing this:\n  m \\<le> p\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * m. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d)) &&&\n    (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * m + 1. (- 1) ^ (d + 1) * psi (n div d))", "proof (induction m rule: inc_induct)"], ["proof (state)\ngoal (4 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n 3. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * na.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * p.\n                                   (- 1) ^ (d + 1) * psi (n div d))\n 4. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * p + 1.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * na + 1.\n                                   (- 1) ^ (d + 1) * psi (n div d))", "case (step k)"], ["proof (state)\nthis:\n  m \\<le> k\n  k < p\n  (\\<Sum>d = 1..2 * Suc k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (4 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n 3. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * na.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * p.\n                                   (- 1) ^ (d + 1) * psi (n div d))\n 4. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * p + 1.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * na + 1.\n                                   (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d = 1..2 * k. (-1)^(d + 1) * psi (n div d)) \\<le> \n          (\\<Sum>d = 1..2 * Suc k. (-1)^(d + 1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * Suc k. (- 1) ^ (d + 1) * psi (n div d))", "by (simp add: psi_mono div_le_mono2)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (4 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n 3. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * na.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * p.\n                                   (- 1) ^ (d + 1) * psi (n div d))\n 4. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * p + 1.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * na + 1.\n                                   (- 1) ^ (d + 1) * psi (n div d))", "with step.IH(1)"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..2 * Suc k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n  (\\<Sum>d = 1..2 * k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k. (- 1) ^ (d + 1) * psi (n div d))", "show \"(\\<Sum>d = 1..2 * k. (-1)^(d + 1) * psi (n div d))\n      \\<le> (\\<Sum>d = 1..2 * p. (-1)^(d + 1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..2 * Suc k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n  (\\<Sum>d = 1..2 * k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (3 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n 3. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * p + 1.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * na + 1.\n                                   (- 1) ^ (d + 1) * psi (n div d))", "from step.IH(2)"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d = 1..2 * p + 1. (-1)^(d + 1) * psi (n div d))\n      \\<le> (\\<Sum>d = 1..2 * Suc k + 1. (-1)^(d + 1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (3 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n 3. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * p + 1.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * na + 1.\n                                   (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (3 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n 3. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * p + 1.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * na + 1.\n                                   (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> \\<le> (\\<Sum>d = 1..2 * k + 1. (-1)^(d + 1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * k + 1. (- 1) ^ (d + 1) * psi (n div d))", "by (simp add: psi_mono div_le_mono2)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * Suc k + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * k + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (3 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n 3. \\<And>na.\n       \\<lbrakk>m \\<le> na; na < p;\n        (\\<Sum>d = 1..2 * Suc na. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d));\n        (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2 * Suc na + 1.\n                  (- 1) ^ (d + 1) * psi (n div d))\\<rbrakk>\n       \\<Longrightarrow> (\\<Sum>d = 1..2 * p + 1.\n                             (- 1) ^ (d + 1) * psi (n div d))\n                         \\<le> (\\<Sum>d = 1..2 * na + 1.\n                                   (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * k + 1. (- 1) ^ (d + 1) * psi (n div d))", "show \"(\\<Sum>d = 1..2 * p + 1. (-1)^(d + 1) * psi (n div d))\n       \\<le> (\\<Sum>d = 1..2 * k + 1. (-1)^(d + 1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * k + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * k + 1. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * k + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (2 subgoals):\n 1. (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p. (- 1) ^ (d + 1) * psi (n div d))\n 2. (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * p + 1. (- 1) ^ (d + 1) * psi (n div d))", "qed simp_all"], ["", "lemma fact_psi_bound_even:\n  assumes \"even k\"\n  shows   \"(\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d)) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"(\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d)) \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "proof (cases \"k \\<le> n\")"], ["proof (state)\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "case True"], ["proof (state)\nthis:\n  k \\<le> n\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "with psi_expansion_cutoff(1)[of \"k div 2\" \"n div 2\" n]"], ["proof (chain)\npicking this:\n  k div 2 \\<le> n div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  k \\<le> n", "have \"(\\<Sum>d=1..2*(k div 2). (-1)^(d+1) * psi (n div d))\n        \\<le> (\\<Sum>d = 1..2*(n div 2). (- 1) ^ (d + 1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  k div 2 \\<le> n div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  k \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "from assms"], ["proof (chain)\npicking this:\n  even k", "have \"2*(k div 2) = k\""], ["proof (prove)\nusing this:\n  even k\n\ngoal (1 subgoal):\n 1. 2 * (k div 2) = k", "by simp"], ["proof (state)\nthis:\n  2 * (k div 2) = k\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  2 * (k div 2) = k\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d = 1..2*(n div 2). (- 1) ^ (d + 1) * psi (n div d))\n      \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "proof (cases \"even n\")"], ["proof (state)\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. odd n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "case True"], ["proof (state)\nthis:\n  even n\n\ngoal (2 subgoals):\n 1. even n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. odd n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "then"], ["proof (chain)\npicking this:\n  even n", "show ?thesis"], ["proof (prove)\nusing this:\n  even n\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "case False"], ["proof (state)\nthis:\n  odd n\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "from psi_pos"], ["proof (chain)\npicking this:\n  0 \\<le> psi ?n", "have \"(\\<Sum>d = 1..2*(n div 2). (- 1) ^ (d + 1) * psi (n div d))\n          \\<le> (\\<Sum>d = 1..2*(n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  0 \\<le> psi ?n\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. odd n \\<Longrightarrow>\n    (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "with False"], ["proof (chain)\npicking this:\n  odd n\n  (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))", "show ?thesis"], ["proof (prove)\nusing this:\n  odd n\n  (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "case False"], ["proof (state)\nthis:\n  \\<not> k \\<le> n\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "hence *: \"n div 2 \\<le> (k-1) div 2\""], ["proof (prove)\nusing this:\n  \\<not> k \\<le> n\n\ngoal (1 subgoal):\n 1. n div 2 \\<le> (k - 1) div 2", "by simp"], ["proof (state)\nthis:\n  n div 2 \\<le> (k - 1) div 2\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d)) \\<le>\n            (\\<Sum>d=1..2*((k-1) div 2) + 1. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "proof (cases \"k = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. k = 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))\n 2. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "case True"], ["proof (state)\nthis:\n  k = 0\n\ngoal (2 subgoals):\n 1. k = 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))\n 2. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "with psi_pos"], ["proof (chain)\npicking this:\n  0 \\<le> psi ?n\n  k = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> psi ?n\n  k = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n            (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "case False"], ["proof (state)\nthis:\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "with sum.cl_ivl_Suc[of \"\\<lambda>d. (-1)^(d+1) * psi (n div d)\" 1 \"k-1\"]"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..Suc (k - 1). (- 1) ^ (d + 1) * psi (n div d)) =\n  (if Suc (k - 1) < 1 then 0\n   else (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) +\n        (- 1) ^ (Suc (k - 1) + 1) * psi (n div Suc (k - 1)))\n  k \\<noteq> 0", "have \"(\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d)) = (\\<Sum>d=1..k-1. (-1)^(d+1) * psi (n div d))\n          + (-1)^(k+1) * psi (n div k)\""], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..Suc (k - 1). (- 1) ^ (d + 1) * psi (n div d)) =\n  (if Suc (k - 1) < 1 then 0\n   else (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) +\n        (- 1) ^ (Suc (k - 1) + 1) * psi (n div Suc (k - 1)))\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d)) =\n    (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) +\n    (- 1) ^ (k + 1) * psi (n div k)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d)) =\n  (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) +\n  (- 1) ^ (k + 1) * psi (n div k)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d)) =\n  (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) +\n  (- 1) ^ (k + 1) * psi (n div k)\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "from assms psi_pos"], ["proof (chain)\npicking this:\n  even k\n  0 \\<le> psi ?n", "have \"(-1)^(k+1) * psi (n div k) \\<le> 0\""], ["proof (prove)\nusing this:\n  even k\n  0 \\<le> psi ?n\n\ngoal (1 subgoal):\n 1. (- 1) ^ (k + 1) * psi (n div k) \\<le> 0", "by simp"], ["proof (state)\nthis:\n  (- 1) ^ (k + 1) * psi (n div k) \\<le> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (- 1) ^ (k + 1) * psi (n div k) \\<le> 0\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "from assms False"], ["proof (chain)\npicking this:\n  even k\n  k \\<noteq> 0", "have \"k-1 = 2*((k-1) div 2) + 1\""], ["proof (prove)\nusing this:\n  even k\n  k \\<noteq> 0\n\ngoal (1 subgoal):\n 1. k - 1 = 2 * ((k - 1) div 2) + 1", "by presburger"], ["proof (state)\nthis:\n  k - 1 = 2 * ((k - 1) div 2) + 1\n\ngoal (1 subgoal):\n 1. k \\<noteq> 0 \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) + x\n      \\<le> (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) +\n            y) \\<Longrightarrow>\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n            (- 1) ^ (d + 1) * psi (n div d)) +\n        0", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x \\<le> y \\<Longrightarrow>\n      (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) + x\n      \\<le> (\\<Sum>d = 1..k - 1. (- 1) ^ (d + 1) * psi (n div d)) +\n            y) \\<Longrightarrow>\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n            (- 1) ^ (d + 1) * psi (n div d)) +\n        0\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n              (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n            (- 1) ^ (d + 1) * psi (n div d))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n            (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1.\n            (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "from * psi_expansion_cutoff(2)[of \"n div 2\" \"(k-1) div 2\" n]"], ["proof (chain)\npicking this:\n  n div 2 \\<le> (k - 1) div 2\n  n div 2 \\<le> (k - 1) div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> \\<le> (\\<Sum>d=1..2*(n div 2) + 1. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  n div 2 \\<le> (k - 1) div 2\n  n div 2 \\<le> (k - 1) div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))", "by blast"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * ((k - 1) div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "by (cases \"even n\") (simp_all add: psi_def)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "from fact_expand_psi"], ["proof (chain)\npicking this:\n  ln (fact ?n) - 2 * ln (fact (?n div 2)) =\n  (\\<Sum>d = 1..?n. (- 1) ^ (d + 1) * psi (?n div d))", "have \"\\<dots> = ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\nusing this:\n  ln (fact ?n) - 2 * ln (fact (?n div 2)) =\n  (\\<Sum>d = 1..?n. (- 1) ^ (d + 1) * psi (?n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n    ln (fact n) - 2 * ln (fact (n div 2))", ".."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d)) =\n  ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma fact_psi_bound_odd:\n  assumes \"odd k\"\n  shows \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> (\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "from fact_expand_psi"], ["proof (chain)\npicking this:\n  ln (fact ?n) - 2 * ln (fact (?n div 2)) =\n  (\\<Sum>d = 1..?n. (- 1) ^ (d + 1) * psi (?n div d))", "have \"ln (fact n) - 2 * ln (fact (n div 2)) = (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  ln (fact ?n) - 2 * ln (fact (?n div 2)) =\n  (\\<Sum>d = 1..?n. (- 1) ^ (d + 1) * psi (?n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2)) =\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2)) =\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> \\<le> (\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "proof (cases \"k \\<le> n\")"], ["proof (state)\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "case True"], ["proof (state)\nthis:\n  k \\<le> n\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d=1..n. (-1)^(d+1) * psi (n div d)) \\<le> (\n             \\<Sum>d=1..2*(n div 2)+1. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))", "by (cases \"even n\") (simp_all add: psi_pos)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "from True assms psi_expansion_cutoff(2)[of \"k div 2\" \"n div 2\" n]"], ["proof (chain)\npicking this:\n  k \\<le> n\n  odd k\n  k div 2 \\<le> n div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (k div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))", "have \"\\<dots> \\<le> (\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  k \\<le> n\n  odd k\n  k div 2 \\<le> n div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (k div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (n div 2) + 1. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (2 subgoals):\n 1. k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n 2. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "case False"], ["proof (state)\nthis:\n  \\<not> k \\<le> n\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d=1..n. (-1)^(d+1) * psi (n div d)) \\<le> (\\<Sum>d=1..2*((n+1) div 2). (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * ((n + 1) div 2).\n              (- 1) ^ (d + 1) * psi (n div d))", "by (cases \"even n\") (simp_all add: psi_def)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((n + 1) div 2). (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * ((n + 1) div 2). (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "from False assms psi_expansion_cutoff(1)[of \"(n+1) div 2\" \"k div 2\" n]"], ["proof (chain)\npicking this:\n  \\<not> k \\<le> n\n  odd k\n  (n + 1) div 2 \\<le> k div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * ((n + 1) div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))", "have \"(\\<Sum>d=1..2*((n+1) div 2). (-1)^(d+1) * psi (n div d)) \\<le> (\\<Sum>d=1..2*(k div 2). (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  \\<not> k \\<le> n\n  odd k\n  (n + 1) div 2 \\<le> k div 2 \\<Longrightarrow>\n  (\\<Sum>d = 1..2 * ((n + 1) div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * ((n + 1) div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * ((n + 1) div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "also"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * ((n + 1) div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "from assms"], ["proof (chain)\npicking this:\n  odd k", "have \"\\<dots> \\<le> (\\<Sum>d=1..k. (-1)^(d+1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  odd k\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "by (auto elim: oddE simp: psi_pos)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..2 * (k div 2). (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. \\<not> k \\<le> n \\<Longrightarrow>\n    (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n. (- 1) ^ (d + 1) * psi (n div d))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "finally"], ["proof (chain)\npicking this:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "show ?thesis"], ["proof (prove)\nusing this:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))", "."], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..k. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma fact_psi_bound_2_3:\n  \"psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\"\n  \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n - psi (n div 2) + psi (n div 3)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2)) &&&\n    ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "proof -"], ["proof (state)\ngoal (2 subgoals):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n 2. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "show \"psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "by (rule psi_bounds_ln_fact (2))"], ["proof (state)\nthis:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "from fact_psi_bound_odd[of 3 n]"], ["proof (chain)\npicking this:\n  odd 3 \\<Longrightarrow>\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d))", "have \"ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d))\""], ["proof (prove)\nusing this:\n  odd 3 \\<Longrightarrow>\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d))", "by simp"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "also"], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d))\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "have \"\\<dots> = psi n - psi (n div 2) + psi (n div 3)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d)) =\n    psi n - psi (n div 2) + psi (n div 3)", "by (simp add: sum.atLeast_Suc_atMost numeral_2_eq_2)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..3. (- 1) ^ (d + 1) * psi (n div d)) =\n  psi n - psi (n div 2) + psi (n div 3)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "finally"], ["proof (chain)\npicking this:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> psi n - psi (n div 2) + psi (n div 3)", "show \"ln (fact n) - 2 * ln (fact (n div 2)) \\<le> psi n - psi (n div 2) + psi (n div 3)\""], ["proof (prove)\nusing this:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> psi n - psi (n div 2) + psi (n div 3)\n\ngoal (1 subgoal):\n 1. ln (fact n) - 2 * ln (fact (n div 2))\n    \\<le> psi n - psi (n div 2) + psi (n div 3)", "."], ["proof (state)\nthis:\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> psi n - psi (n div 2) + psi (n div 3)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma ub_ln_1200: \"ln 1200 \\<le> 57 / (8 :: real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln 1200 \\<le> 57 / 8", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln 1200 \\<le> 57 / 8", "have \"Some (Float 57 (-3)) = ub_ln 8 1200\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Some (Float 57 (- 3)) = ub_ln 8 1200", "by code_simp"], ["proof (state)\nthis:\n  Some (Float 57 (- 3)) = ub_ln 8 1200\n\ngoal (1 subgoal):\n 1. ln 1200 \\<le> 57 / 8", "from ub_ln(1)[OF this]"], ["proof (chain)\npicking this:\n  ln (real_of_float 1200) \\<le> real_of_float (Float 57 (- 3))", "show ?thesis"], ["proof (prove)\nusing this:\n  ln (real_of_float 1200) \\<le> real_of_float (Float 57 (- 3))\n\ngoal (1 subgoal):\n 1. ln 1200 \\<le> 57 / 8", "by simp"], ["proof (state)\nthis:\n  ln 1200 \\<le> 57 / 8\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma psi_double_lemma:\n  assumes \"n \\<ge> 1200\"\n  shows \"real n / 6 \\<le> psi n - psi (n div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "from ln_fact_diff_bounds"], ["proof (chain)\npicking this:\n  \\<bar>ln (fact ?n) - 2 * ln (fact (?n div 2)) - real ?n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if ?n = 0 then 1 else ?n)) + 3", "have \"\\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n        \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\""], ["proof (prove)\nusing this:\n  \\<bar>ln (fact ?n) - 2 * ln (fact (?n div 2)) - real ?n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if ?n = 0 then 1 else ?n)) + 3\n\ngoal (1 subgoal):\n 1. \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n    \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "."], ["proof (state)\nthis:\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "with assms"], ["proof (chain)\npicking this:\n  1200 \\<le> n\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3", "have \"ln (fact n) - 2 * ln (fact (n div 2))\n        \\<ge> real n * ln 2 - 4 * ln (real n) - 3\""], ["proof (prove)\nusing this:\n  1200 \\<le> n\n  \\<bar>ln (fact n) - 2 * ln (fact (n div 2)) - real n * ln 2\\<bar>\n  \\<le> 4 * ln (real (if n = 0 then 1 else n)) + 3\n\ngoal (1 subgoal):\n 1. real n * ln 2 - 4 * ln (real n) - 3\n    \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "by simp"], ["proof (state)\nthis:\n  real n * ln 2 - 4 * ln (real n) - 3\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "moreover"], ["proof (state)\nthis:\n  real n * ln 2 - 4 * ln (real n) - 3\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "have \"real n * ln 2 - 4 * ln (real n) - 3 \\<ge> 2 / 3 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / 3 * real n \\<le> real n * ln 2 - 4 * ln (real n) - 3", "proof (rule overpower_lemma[of \"\\<lambda>n. 2/3 * n\" 1200])"], ["proof (state)\ngoal (4 subgoals):\n 1. 2 / 3 * 1200 \\<le> 1200 * ln 2 - 4 * ln 1200 - 3\n 2. \\<And>x.\n       1200 \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n        ?d x)\n        (at x)\n 3. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ?d x\n 4. 1200 \\<le> real n", "show \"2 / 3 * 1200 \\<le> 1200 * ln 2 - 4 * ln 1200 - (3::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / 3 * 1200 \\<le> 1200 * ln 2 - 4 * ln 1200 - 3", "using ub_ln_1200 ln_2_ge"], ["proof (prove)\nusing this:\n  ln 1200 \\<le> 57 / 8\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 2 / 3 * 1200 \\<le> 1200 * ln 2 - 4 * ln 1200 - 3", "by linarith"], ["proof (state)\nthis:\n  2 / 3 * 1200 \\<le> 1200 * ln 2 - 4 * ln 1200 - 3\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1200 \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n        ?d x)\n        (at x)\n 2. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ?d x\n 3. 1200 \\<le> real n", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       1200 \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n        ?d x)\n        (at x)\n 2. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ?d x\n 3. 1200 \\<le> real n", "fix x::real"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       1200 \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n        ?d x)\n        (at x)\n 2. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ?d x\n 3. 1200 \\<le> real n", "assume \"1200 \\<le> x\""], ["proof (state)\nthis:\n  1200 \\<le> x\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1200 \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n        ?d x)\n        (at x)\n 2. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ?d x\n 3. 1200 \\<le> real n", "then"], ["proof (chain)\npicking this:\n  1200 \\<le> x", "have \"0 < x\""], ["proof (prove)\nusing this:\n  1200 \\<le> x\n\ngoal (1 subgoal):\n 1. 0 < x", "by simp"], ["proof (state)\nthis:\n  0 < x\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       1200 \\<le> x \\<Longrightarrow>\n       ((\\<lambda>x.\n            x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n        ?d x)\n        (at x)\n 2. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ?d x\n 3. 1200 \\<le> real n", "show \"((\\<lambda>x. x * ln 2 - 4 * ln x - 3 - 2 / 3 * x)\n        has_real_derivative ln 2 - 4 / x - 2 / 3) (at x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>x. x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n     ln 2 - 4 / x - 2 / 3)\n     (at x)", "by (rule derivative_eq_intros refl | simp add: \\<open>0 < x\\<close>)+"], ["proof (state)\nthis:\n  ((\\<lambda>x. x * ln 2 - 4 * ln x - 3 - 2 / 3 * x) has_real_derivative\n   ln 2 - 4 / x - 2 / 3)\n   (at x)\n\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "fix x::real"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "assume \"1200 \\<le> x\""], ["proof (state)\nthis:\n  1200 \\<le> x\n\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "then"], ["proof (chain)\npicking this:\n  1200 \\<le> x", "have \"12 / x \\<le> 12 / 1200\""], ["proof (prove)\nusing this:\n  1200 \\<le> x\n\ngoal (1 subgoal):\n 1. 12 / x \\<le> 12 / 1200", "by simp"], ["proof (state)\nthis:\n  12 / x \\<le> 12 / 1200\n\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "then"], ["proof (chain)\npicking this:\n  12 / x \\<le> 12 / 1200", "have \"0 \\<le> 0.67 - 4 / x - 2 / 3\""], ["proof (prove)\nusing this:\n  12 / x \\<le> 12 / 1200\n\ngoal (1 subgoal):\n 1. 0 \\<le> 67 / 10\\<^sup>2 - 4 / x - 2 / 3", "by simp"], ["proof (state)\nthis:\n  0 \\<le> 67 / 10\\<^sup>2 - 4 / x - 2 / 3\n\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "also"], ["proof (state)\nthis:\n  0 \\<le> 67 / 10\\<^sup>2 - 4 / x - 2 / 3\n\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "have \"0.67 \\<le> ln (2::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 67 / 10\\<^sup>2 \\<le> ln 2", "using ln_2_ge"], ["proof (prove)\nusing this:\n  5677 / 8192 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. 67 / 10\\<^sup>2 \\<le> ln 2", "by simp"], ["proof (state)\nthis:\n  67 / 10\\<^sup>2 \\<le> ln 2\n\ngoal (2 subgoals):\n 1. \\<And>x. 1200 \\<le> x \\<Longrightarrow> 0 \\<le> ln 2 - 4 / x - 2 / 3\n 2. 1200 \\<le> real n", "finally"], ["proof (chain)\npicking this:\n  (\\<And>xa y.\n      xa \\<le> y \\<Longrightarrow>\n      xa - 4 / x - 2 / 3 \\<le> y - 4 / x - 2 / 3) \\<Longrightarrow>\n  0 \\<le> ln 2 - 4 / x - 2 / 3", "show \"0 \\<le> ln 2 - 4 / x - 2 / 3\""], ["proof (prove)\nusing this:\n  (\\<And>xa y.\n      xa \\<le> y \\<Longrightarrow>\n      xa - 4 / x - 2 / 3 \\<le> y - 4 / x - 2 / 3) \\<Longrightarrow>\n  0 \\<le> ln 2 - 4 / x - 2 / 3\n\ngoal (1 subgoal):\n 1. 0 \\<le> ln 2 - 4 / x - 2 / 3", "by simp"], ["proof (state)\nthis:\n  0 \\<le> ln 2 - 4 / x - 2 / 3\n\ngoal (1 subgoal):\n 1. 1200 \\<le> real n", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 1200 \\<le> real n", "from assms"], ["proof (chain)\npicking this:\n  1200 \\<le> n", "show \"1200 \\<le> real n\""], ["proof (prove)\nusing this:\n  1200 \\<le> n\n\ngoal (1 subgoal):\n 1. 1200 \\<le> real n", "by simp"], ["proof (state)\nthis:\n  1200 \\<le> real n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  2 / 3 * real n \\<le> real n * ln 2 - 4 * ln (real n) - 3\n\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "ultimately"], ["proof (chain)\npicking this:\n  real n * ln 2 - 4 * ln (real n) - 3\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n  2 / 3 * real n \\<le> real n * ln 2 - 4 * ln (real n) - 3", "have \"2 / 3 * real n \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\nusing this:\n  real n * ln 2 - 4 * ln (real n) - 3\n  \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n  2 / 3 * real n \\<le> real n * ln 2 - 4 * ln (real n) - 3\n\ngoal (1 subgoal):\n 1. 2 / 3 * real n \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "by simp"], ["proof (state)\nthis:\n  2 / 3 * real n \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "with psi_ubound_3_2[of \"n div 3\"]"], ["proof (chain)\npicking this:\n  psi (n div 3) \\<le> 3 / 2 * real (n div 3)\n  2 / 3 * real n \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "have \"n/6 + psi (n div 3) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\""], ["proof (prove)\nusing this:\n  psi (n div 3) \\<le> 3 / 2 * real (n div 3)\n  2 / 3 * real n \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. real n / 6 + psi (n div 3) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "by simp"], ["proof (state)\nthis:\n  real n / 6 + psi (n div 3) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "with fact_psi_bound_2_3[of \"n\"]"], ["proof (chain)\npicking this:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> psi n - psi (n div 2) + psi (n div 3)\n  real n / 6 + psi (n div 3) \\<le> ln (fact n) - 2 * ln (fact (n div 2))", "show ?thesis"], ["proof (prove)\nusing this:\n  psi n - psi (n div 2) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n  ln (fact n) - 2 * ln (fact (n div 2))\n  \\<le> psi n - psi (n div 2) + psi (n div 3)\n  real n / 6 + psi (n div 3) \\<le> ln (fact n) - 2 * ln (fact (n div 2))\n\ngoal (1 subgoal):\n 1. real n / 6 \\<le> psi n - psi (n div 2)", "by simp"], ["proof (state)\nthis:\n  real n / 6 \\<le> psi n - psi (n div 2)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma theta_double_lemma:\n  assumes \"n \\<ge> 1200\"\n  shows \"theta (n div 2) < theta n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "from psi_theta[of \"n div 2\"] psi_pos[of \"Discrete.sqrt (n div 2)\"]"], ["proof (chain)\npicking this:\n  theta (n div 2) + psi (Discrete.sqrt (n div 2)) \\<le> psi (n div 2)\n  psi (n div 2) \\<le> theta (n div 2) + 2 * psi (Discrete.sqrt (n div 2))\n  0 \\<le> psi (Discrete.sqrt (n div 2))", "have theta_le_psi_n_2: \"theta (n div 2) \\<le> psi (n div 2)\""], ["proof (prove)\nusing this:\n  theta (n div 2) + psi (Discrete.sqrt (n div 2)) \\<le> psi (n div 2)\n  psi (n div 2) \\<le> theta (n div 2) + 2 * psi (Discrete.sqrt (n div 2))\n  0 \\<le> psi (Discrete.sqrt (n div 2))\n\ngoal (1 subgoal):\n 1. theta (n div 2) \\<le> psi (n div 2)", "by simp"], ["proof (state)\nthis:\n  theta (n div 2) \\<le> psi (n div 2)\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "have \"(Discrete.sqrt n * 18)^2 \\<le> 324 * n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Discrete.sqrt n * 18)\\<^sup>2 \\<le> 324 * n", "by simp"], ["proof (state)\nthis:\n  (Discrete.sqrt n * 18)\\<^sup>2 \\<le> 324 * n\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "from mult_less_cancel2[of \"324\" \"n\" \"n\"] assms"], ["proof (chain)\npicking this:\n  (324 * n < n * n) = (0 < n \\<and> 324 < n)\n  1200 \\<le> n", "have \"324 * n < n^2\""], ["proof (prove)\nusing this:\n  (324 * n < n * n) = (0 < n \\<and> 324 < n)\n  1200 \\<le> n\n\ngoal (1 subgoal):\n 1. 324 * n < n\\<^sup>2", "by (simp add: power2_eq_square)"], ["proof (state)\nthis:\n  324 * n < n\\<^sup>2\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "with \\<open>(Discrete.sqrt n * 18)^2 \\<le> 324 * n\\<close>"], ["proof (chain)\npicking this:\n  (Discrete.sqrt n * 18)\\<^sup>2 \\<le> 324 * n\n  324 * n < n\\<^sup>2", "have \"(Discrete.sqrt n*18)^2 < n^2\""], ["proof (prove)\nusing this:\n  (Discrete.sqrt n * 18)\\<^sup>2 \\<le> 324 * n\n  324 * n < n\\<^sup>2\n\ngoal (1 subgoal):\n 1. (Discrete.sqrt n * 18)\\<^sup>2 < n\\<^sup>2", "by presburger"], ["proof (state)\nthis:\n  (Discrete.sqrt n * 18)\\<^sup>2 < n\\<^sup>2\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "with power2_less_imp_less assms"], ["proof (chain)\npicking this:\n  \\<lbrakk>?x\\<^sup>2 < ?y\\<^sup>2; (0::?'a) \\<le> ?y\\<rbrakk>\n  \\<Longrightarrow> ?x < ?y\n  1200 \\<le> n\n  (Discrete.sqrt n * 18)\\<^sup>2 < n\\<^sup>2", "have \"Discrete.sqrt n * 18 < n\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?x\\<^sup>2 < ?y\\<^sup>2; (0::?'a) \\<le> ?y\\<rbrakk>\n  \\<Longrightarrow> ?x < ?y\n  1200 \\<le> n\n  (Discrete.sqrt n * 18)\\<^sup>2 < n\\<^sup>2\n\ngoal (1 subgoal):\n 1. Discrete.sqrt n * 18 < n", "by blast"], ["proof (state)\nthis:\n  Discrete.sqrt n * 18 < n\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "with psi_ubound_3_2[of \"Discrete.sqrt n\"]"], ["proof (chain)\npicking this:\n  psi (Discrete.sqrt n) \\<le> 3 / 2 * real (Discrete.sqrt n)\n  Discrete.sqrt n * 18 < n", "have \"2 * psi (Discrete.sqrt n) < n / 6\""], ["proof (prove)\nusing this:\n  psi (Discrete.sqrt n) \\<le> 3 / 2 * real (Discrete.sqrt n)\n  Discrete.sqrt n * 18 < n\n\ngoal (1 subgoal):\n 1. 2 * psi (Discrete.sqrt n) < real n / 6", "by simp"], ["proof (state)\nthis:\n  2 * psi (Discrete.sqrt n) < real n / 6\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "with psi_theta[of \"n\"]"], ["proof (chain)\npicking this:\n  theta n + psi (Discrete.sqrt n) \\<le> psi n\n  psi n \\<le> theta n + 2 * psi (Discrete.sqrt n)\n  2 * psi (Discrete.sqrt n) < real n / 6", "have psi_lt_theta_n: \"psi n - n / 6 < theta n\""], ["proof (prove)\nusing this:\n  theta n + psi (Discrete.sqrt n) \\<le> psi n\n  psi n \\<le> theta n + 2 * psi (Discrete.sqrt n)\n  2 * psi (Discrete.sqrt n) < real n / 6\n\ngoal (1 subgoal):\n 1. psi n - real n / 6 < theta n", "by simp"], ["proof (state)\nthis:\n  psi n - real n / 6 < theta n\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "from psi_double_lemma[OF assms(1)]"], ["proof (chain)\npicking this:\n  real n / 6 \\<le> psi n - psi (n div 2)", "have \"psi (n div 2) \\<le> psi n - n / 6\""], ["proof (prove)\nusing this:\n  real n / 6 \\<le> psi n - psi (n div 2)\n\ngoal (1 subgoal):\n 1. psi (n div 2) \\<le> psi n - real n / 6", "by simp"], ["proof (state)\nthis:\n  psi (n div 2) \\<le> psi n - real n / 6\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "with theta_le_psi_n_2 psi_lt_theta_n"], ["proof (chain)\npicking this:\n  theta (n div 2) \\<le> psi (n div 2)\n  psi n - real n / 6 < theta n\n  psi (n div 2) \\<le> psi n - real n / 6", "show ?thesis"], ["proof (prove)\nusing this:\n  theta (n div 2) \\<le> psi (n div 2)\n  psi n - real n / 6 < theta n\n  psi (n div 2) \\<le> psi n - real n / 6\n\ngoal (1 subgoal):\n 1. theta (n div 2) < theta n", "by simp"], ["proof (state)\nthis:\n  theta (n div 2) < theta n\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Proof of the main result\\<close>"], ["", "lemma theta_mono: \"mono theta\""], ["proof (prove)\ngoal (1 subgoal):\n 1. incseq theta", "by (auto simp: theta_def [abs_def] intro!: monoI sum_mono2)"], ["", "lemma theta_lessE:\n  assumes \"theta m < theta n\" \"m \\<ge> 1\"\n  obtains p where \"p \\<in> {m<..n}\" \"prime p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from mono_invE[OF theta_mono assms(1)]"], ["proof (chain)\npicking this:\n  (m \\<le> n \\<Longrightarrow> ?thesis) \\<Longrightarrow> ?thesis", "have \"m \\<le> n\""], ["proof (prove)\nusing this:\n  (m \\<le> n \\<Longrightarrow> ?thesis) \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. m \\<le> n", "by blast"], ["proof (state)\nthis:\n  m \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "hence \"theta n = theta m + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)\""], ["proof (prove)\nusing this:\n  m \\<le> n\n\ngoal (1 subgoal):\n 1. theta n =\n    theta m + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)", "unfolding theta_def"], ["proof (prove)\nusing this:\n  m \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>p = 1..n. if prime p then ln (real p) else 0) =\n    (\\<Sum>p = 1..m. if prime p then ln (real p) else 0) +\n    (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)", "using assms(2)"], ["proof (prove)\nusing this:\n  m \\<le> n\n  1 \\<le> m\n\ngoal (1 subgoal):\n 1. (\\<Sum>p = 1..n. if prime p then ln (real p) else 0) =\n    (\\<Sum>p = 1..m. if prime p then ln (real p) else 0) +\n    (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)", "by (subst sum.union_disjoint [symmetric]) (auto simp: ivl_disj_un)"], ["proof (state)\nthis:\n  theta n =\n  theta m + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "also"], ["proof (state)\nthis:\n  theta n =\n  theta m + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "note assms(1)"], ["proof (state)\nthis:\n  theta m < theta n\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "finally"], ["proof (chain)\npicking this:\n  (\\<And>x y.\n      x < y \\<Longrightarrow>\n      x + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)\n      < y +\n        (\\<Sum>p\\<in>{m<..n}.\n           if prime p then ln (real p) else 0)) \\<Longrightarrow>\n  theta n\n  < theta n + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)", "have \"(\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0) \\<noteq> 0\""], ["proof (prove)\nusing this:\n  (\\<And>x y.\n      x < y \\<Longrightarrow>\n      x + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)\n      < y +\n        (\\<Sum>p\\<in>{m<..n}.\n           if prime p then ln (real p) else 0)) \\<Longrightarrow>\n  theta n\n  < theta n + (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0)\n\ngoal (1 subgoal):\n 1. (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0) \\<noteq> 0", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>p\\<in>{m<..n}. if prime p then ln (real p) else 0) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "from sum.not_neutral_contains_not_neutral [OF this]"], ["proof (chain)\npicking this:\n  (\\<And>a.\n      \\<lbrakk>a \\<in> {m<..n};\n       (if prime a then ln (real a) else 0) \\<noteq> 0\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis", "guess p"], ["proof (prove)\nusing this:\n  (\\<And>a.\n      \\<lbrakk>a \\<in> {m<..n};\n       (if prime a then ln (real a) else 0) \\<noteq> 0\\<rbrakk>\n      \\<Longrightarrow> ?thesis) \\<Longrightarrow>\n  ?thesis\n\ngoal (1 subgoal):\n 1. thesis", "."], ["proof (state)\nthis:\n  p \\<in> {m<..n}\n  (if prime p then ln (real p) else 0) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "thus ?thesis"], ["proof (prove)\nusing this:\n  p \\<in> {m<..n}\n  (if prime p then ln (real p) else 0) \\<noteq> 0\n\ngoal (1 subgoal):\n 1. thesis", "using that[of p]"], ["proof (prove)\nusing this:\n  p \\<in> {m<..n}\n  (if prime p then ln (real p) else 0) \\<noteq> 0\n  \\<lbrakk>p \\<in> {m<..n}; prime p\\<rbrakk> \\<Longrightarrow> thesis\n\ngoal (1 subgoal):\n 1. thesis", "by (auto intro!: exI[of _ p] split: if_splits)"], ["proof (state)\nthis:\n  thesis\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem bertrand:\n  fixes   n :: nat\n  assumes \"n > 1\"\n  shows   \"\\<exists>p\\<in>{n<..<2*n}. prime p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>{n<..<2 * n}. prime p", "proof cases"], ["proof (state)\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "assume n_less: \"n < 600\""], ["proof (state)\nthis:\n  n < 600\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "define prime_constants\n    where \"prime_constants = {2, 3, 5, 7, 13, 23, 43, 83, 163, 317, 631::nat}\""], ["proof (state)\nthis:\n  prime_constants = {2, 3, 5, 7, 13, 23, 43, 83, 163, 317, 631}\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "from \\<open>n > 1\\<close> n_less"], ["proof (chain)\npicking this:\n  1 < n\n  n < 600", "have \"\\<exists>p \\<in> prime_constants. n < p \\<and> p < 2 * n\""], ["proof (prove)\nusing this:\n  1 < n\n  n < 600\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>prime_constants. n < p \\<and> p < 2 * n", "unfolding bex_simps greaterThanLessThan_iff prime_constants_def"], ["proof (prove)\nusing this:\n  1 < n\n  n < 600\n\ngoal (1 subgoal):\n 1. n < 2 \\<and> 2 < 2 * n \\<or>\n    n < 3 \\<and> 3 < 2 * n \\<or>\n    n < 5 \\<and> 5 < 2 * n \\<or>\n    n < 7 \\<and> 7 < 2 * n \\<or>\n    n < 13 \\<and> 13 < 2 * n \\<or>\n    n < 23 \\<and> 23 < 2 * n \\<or>\n    n < 43 \\<and> 43 < 2 * n \\<or>\n    n < 83 \\<and> 83 < 2 * n \\<or>\n    n < 163 \\<and> 163 < 2 * n \\<or>\n    n < 317 \\<and> 317 < 2 * n \\<or> n < 631 \\<and> 631 < 2 * n \\<or> False", "by presburger"], ["proof (state)\nthis:\n  \\<exists>p\\<in>prime_constants. n < p \\<and> p < 2 * n\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "moreover"], ["proof (state)\nthis:\n  \\<exists>p\\<in>prime_constants. n < p \\<and> p < 2 * n\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "have \"\\<forall>p\\<in>prime_constants. prime p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>prime_constants. prime p", "unfolding prime_constants_def ball_simps HOL.simp_thms"], ["proof (prove)\ngoal (1 subgoal):\n 1. prime 2 \\<and>\n    prime 3 \\<and>\n    prime 5 \\<and>\n    prime 7 \\<and>\n    prime 13 \\<and>\n    prime 23 \\<and>\n    prime 43 \\<and>\n    prime 83 \\<and> prime 163 \\<and> prime 317 \\<and> prime 631", "by (intro conjI; pratt (silent))"], ["proof (state)\nthis:\n  \\<forall>p\\<in>prime_constants. prime p\n\ngoal (2 subgoals):\n 1. ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p\n 2. \\<not> ?P \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "ultimately"], ["proof (chain)\npicking this:\n  \\<exists>p\\<in>prime_constants. n < p \\<and> p < 2 * n\n  \\<forall>p\\<in>prime_constants. prime p", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<exists>p\\<in>prime_constants. n < p \\<and> p < 2 * n\n  \\<forall>p\\<in>prime_constants. prime p\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>{n<..<2 * n}. prime p", "unfolding greaterThanLessThan_def greaterThan_def lessThan_def"], ["proof (prove)\nusing this:\n  \\<exists>p\\<in>prime_constants. n < p \\<and> p < 2 * n\n  \\<forall>p\\<in>prime_constants. prime p\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>{x. n < x} \\<inter> {x. x < 2 * n}. prime p", "by blast"], ["proof (state)\nthis:\n  \\<exists>p\\<in>{n<..<2 * n}. prime p\n\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "assume n: \"\\<not>(n < 600)\""], ["proof (state)\nthis:\n  \\<not> n < 600\n\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "from n"], ["proof (chain)\npicking this:\n  \\<not> n < 600", "have \"theta n < theta (2 * n)\""], ["proof (prove)\nusing this:\n  \\<not> n < 600\n\ngoal (1 subgoal):\n 1. theta n < theta (2 * n)", "using theta_double_lemma[of \"2 * n\"]"], ["proof (prove)\nusing this:\n  \\<not> n < 600\n  1200 \\<le> 2 * n \\<Longrightarrow> theta (2 * n div 2) < theta (2 * n)\n\ngoal (1 subgoal):\n 1. theta n < theta (2 * n)", "by simp"], ["proof (state)\nthis:\n  theta n < theta (2 * n)\n\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "with assms"], ["proof (chain)\npicking this:\n  1 < n\n  theta n < theta (2 * n)", "obtain p where \"p \\<in> {n<..2*n}\" \"prime p\""], ["proof (prove)\nusing this:\n  1 < n\n  theta n < theta (2 * n)\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>p \\<in> {n<..2 * n}; prime p\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by (auto elim!: theta_lessE)"], ["proof (state)\nthis:\n  p \\<in> {n<..2 * n}\n  prime p\n\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "moreover"], ["proof (state)\nthis:\n  p \\<in> {n<..2 * n}\n  prime p\n\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "from assms"], ["proof (chain)\npicking this:\n  1 < n", "have \"\\<not>prime (2*n)\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. \\<not> prime (2 * n)", "by (auto dest!: prime_product)"], ["proof (state)\nthis:\n  \\<not> prime (2 * n)\n\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "with \\<open>prime p\\<close>"], ["proof (chain)\npicking this:\n  prime p\n  \\<not> prime (2 * n)", "have \"p \\<noteq> 2 * n\""], ["proof (prove)\nusing this:\n  prime p\n  \\<not> prime (2 * n)\n\ngoal (1 subgoal):\n 1. p \\<noteq> 2 * n", "by auto"], ["proof (state)\nthis:\n  p \\<noteq> 2 * n\n\ngoal (1 subgoal):\n 1. \\<not> n < 600 \\<Longrightarrow> \\<exists>p\\<in>{n<..<2 * n}. prime p", "ultimately"], ["proof (chain)\npicking this:\n  p \\<in> {n<..2 * n}\n  prime p\n  p \\<noteq> 2 * n", "show ?thesis"], ["proof (prove)\nusing this:\n  p \\<in> {n<..2 * n}\n  prime p\n  p \\<noteq> 2 * n\n\ngoal (1 subgoal):\n 1. \\<exists>p\\<in>{n<..<2 * n}. prime p", "by auto"], ["proof (state)\nthis:\n  \\<exists>p\\<in>{n<..<2 * n}. prime p\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Proof of Mertens' first theorem\\<close>"], ["", "text \\<open>\n  The following proof of Mertens' first theorem was ported from John Harrison's HOL Light\n  proof by Larry Paulson:\n\\<close>"], ["", "lemma sum_integral_ubound_decreasing':\n  fixes f :: \"real \\<Rightarrow> real\"\n  assumes \"m \\<le> n\"\n      and der: \"\\<And>x. x \\<in> {of_nat m - 1..of_nat n} \\<Longrightarrow> (g has_field_derivative f x) (at x)\"\n      and le:  \"\\<And>x y. \\<lbrakk>real m - 1 \\<le> x; x \\<le> y; y \\<le> real n\\<rbrakk> \\<Longrightarrow> f y \\<le> f x\"\n    shows \"(\\<Sum>k = m..n. f (of_nat k)) \\<le> g (of_nat n) - g (of_nat m - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)", "have \"(\\<Sum>k = m..n. f (of_nat k)) \\<le> (\\<Sum>k = m..n. g (of_nat(Suc k) - 1) - g (of_nat k - 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. f (real k))\n    \\<le> (\\<Sum>k = m..n. g (real (Suc k) - 1) - g (real k - 1))", "proof (rule sum_mono, clarsimp)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "fix r"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "assume r: \"m \\<le> r\" \"r \\<le> n\""], ["proof (state)\nthis:\n  m \\<le> r\n  r \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "hence \"\\<exists>z>real r - 1. z < real r \\<and> g (real r) - g (real r - 1) = (real r - (real r - 1)) * f z\""], ["proof (prove)\nusing this:\n  m \\<le> r\n  r \\<le> n\n\ngoal (1 subgoal):\n 1. \\<exists>z>real r - 1.\n       z < real r \\<and>\n       g (real r) - g (real r - 1) = (real r - (real r - 1)) * f z", "using assms"], ["proof (prove)\nusing this:\n  m \\<le> r\n  r \\<le> n\n  m \\<le> n\n  ?x \\<in> {real m - 1..real n} \\<Longrightarrow>\n  (g has_real_derivative f ?x) (at ?x)\n  \\<lbrakk>real m - 1 \\<le> ?x; ?x \\<le> ?y; ?y \\<le> real n\\<rbrakk>\n  \\<Longrightarrow> f ?y \\<le> f ?x\n\ngoal (1 subgoal):\n 1. \\<exists>z>real r - 1.\n       z < real r \\<and>\n       g (real r) - g (real r - 1) = (real r - (real r - 1)) * f z", "by (intro MVT2) auto"], ["proof (state)\nthis:\n  \\<exists>z>real r - 1.\n     z < real r \\<and>\n     g (real r) - g (real r - 1) = (real r - (real r - 1)) * f z\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "hence \"\\<exists>z\\<in>{of_nat r - 1..of_nat r}. g (real r) - g (real r - 1) = f z\""], ["proof (prove)\nusing this:\n  \\<exists>z>real r - 1.\n     z < real r \\<and>\n     g (real r) - g (real r - 1) = (real r - (real r - 1)) * f z\n\ngoal (1 subgoal):\n 1. \\<exists>z\\<in>{real r - 1..real r}. g (real r) - g (real r - 1) = f z", "by auto"], ["proof (state)\nthis:\n  \\<exists>z\\<in>{real r - 1..real r}. g (real r) - g (real r - 1) = f z\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "then"], ["proof (chain)\npicking this:\n  \\<exists>z\\<in>{real r - 1..real r}. g (real r) - g (real r - 1) = f z", "obtain u::real where u: \"u \\<in> {of_nat r - 1..of_nat r}\"\n                        and eq: \"g r - g (of_nat r - 1) = f u\""], ["proof (prove)\nusing this:\n  \\<exists>z\\<in>{real r - 1..real r}. g (real r) - g (real r - 1) = f z\n\ngoal (1 subgoal):\n 1. (\\<And>u.\n        \\<lbrakk>u \\<in> {real r - 1..real r};\n         g (real r) - g (real r - 1) = f u\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  u \\<in> {real r - 1..real r}\n  g (real r) - g (real r - 1) = f u\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "have \"real m \\<le> u + 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real m \\<le> u + 1", "using r u"], ["proof (prove)\nusing this:\n  m \\<le> r\n  r \\<le> n\n  u \\<in> {real r - 1..real r}\n\ngoal (1 subgoal):\n 1. real m \\<le> u + 1", "by auto"], ["proof (state)\nthis:\n  real m \\<le> u + 1\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "then"], ["proof (chain)\npicking this:\n  real m \\<le> u + 1", "have \"f (of_nat r) \\<le> f u\""], ["proof (prove)\nusing this:\n  real m \\<le> u + 1\n\ngoal (1 subgoal):\n 1. f (real r) \\<le> f u", "using r(2) and u"], ["proof (prove)\nusing this:\n  real m \\<le> u + 1\n  r \\<le> n\n  u \\<in> {real r - 1..real r}\n\ngoal (1 subgoal):\n 1. f (real r) \\<le> f u", "by (intro le) auto"], ["proof (state)\nthis:\n  f (real r) \\<le> f u\n\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>m \\<le> k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (real k) \\<le> g (real k) - g (real k - 1)", "then"], ["proof (chain)\npicking this:\n  f (real r) \\<le> f u", "show \"f (of_nat r) \\<le> g r - g (of_nat r - 1)\""], ["proof (prove)\nusing this:\n  f (real r) \\<le> f u\n\ngoal (1 subgoal):\n 1. f (real r) \\<le> g (real r) - g (real r - 1)", "by (simp add: eq)"], ["proof (state)\nthis:\n  f (real r) \\<le> g (real r) - g (real r - 1)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k = m..n. f (real k))\n  \\<le> (\\<Sum>k = m..n. g (real (Suc k) - 1) - g (real k - 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)", "also"], ["proof (state)\nthis:\n  (\\<Sum>k = m..n. f (real k))\n  \\<le> (\\<Sum>k = m..n. g (real (Suc k) - 1) - g (real k - 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)", "have \"\\<dots> \\<le> g (of_nat n) - g (of_nat m - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. g (real (Suc k) - 1) - g (real k - 1))\n    \\<le> g (real n) - g (real m - 1)", "using \\<open>m \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  m \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. g (real (Suc k) - 1) - g (real k - 1))\n    \\<le> g (real n) - g (real m - 1)", "by (subst sum_Suc_diff) auto"], ["proof (state)\nthis:\n  (\\<Sum>k = m..n. g (real (Suc k) - 1) - g (real k - 1))\n  \\<le> g (real n) - g (real m - 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)", "."], ["proof (state)\nthis:\n  (\\<Sum>k = m..n. f (real k)) \\<le> g (real n) - g (real m - 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Mertens_lemma:\n  assumes \"n \\<noteq> 0\"\n    shows \"\\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln n\\<bar> \\<le> 4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "have *: \"\\<lbrakk>abs(s' - nl + n) \\<le> a; abs(s' - s) \\<le> (k - 1) * n - a\\<rbrakk>\n        \\<Longrightarrow> abs(s - nl) \\<le> n * k\" for s' s k nl a::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<bar>s' - nl + real n\\<bar> \\<le> a;\n     \\<bar>s' - s\\<bar> \\<le> (k - 1) * real n - a\\<rbrakk>\n    \\<Longrightarrow> \\<bar>s - nl\\<bar> \\<le> real n * k", "by (auto simp: algebra_simps abs_if split: if_split_asm)"], ["proof (state)\nthis:\n  \\<lbrakk>\\<bar>?s' - ?nl + real n\\<bar> \\<le> ?a;\n   \\<bar>?s' - ?s\\<bar> \\<le> (?k - 1) * real n - ?a\\<rbrakk>\n  \\<Longrightarrow> \\<bar>?s - ?nl\\<bar> \\<le> real n * ?k\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "have le: \"\\<bar>(\\<Sum>d=1..n. mangoldt d * floor (n / d)) - n * ln n + n\\<bar> \\<le> 1 + ln n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          real n * ln (real n) +\n          real n\\<bar>\n    \\<le> 1 + ln (real n)", "using ln_fact_bounds ln_fact_conv_mangoldt assms"], ["proof (prove)\nusing this:\n  0 < ?n \\<Longrightarrow>\n  \\<bar>ln (fact ?n) - real ?n * ln (real ?n) + real ?n\\<bar>\n  \\<le> 1 + ln (real ?n)\n  ln (fact ?n) =\n  (\\<Sum>d = 1..?n.\n      mangoldt d * real_of_int \\<lfloor>real ?n / real d\\<rfloor>)\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          real n * ln (real n) +\n          real n\\<bar>\n    \\<le> 1 + ln (real n)", "by simp"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n.\n            mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n        real n * ln (real n) +\n        real n\\<bar>\n  \\<le> 1 + ln (real n)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "have \"\\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln n)\\<bar> =\n        \\<bar>((\\<Sum>d = 1..n. real n * mangoldt d / real d) - n * ln n)\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>real n *\n          ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar> =\n    \\<bar>(\\<Sum>d = 1..n. real n * mangoldt d / real d) -\n          real n * ln (real n)\\<bar>", "by (simp add: algebra_simps sum_distrib_left)"], ["proof (state)\nthis:\n  \\<bar>real n *\n        ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar> =\n  \\<bar>(\\<Sum>d = 1..n. real n * mangoldt d / real d) -\n        real n * ln (real n)\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "also"], ["proof (state)\nthis:\n  \\<bar>real n *\n        ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar> =\n  \\<bar>(\\<Sum>d = 1..n. real n * mangoldt d / real d) -\n        real n * ln (real n)\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "have \"\\<dots> \\<le> real n * 4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. real n * mangoldt d / real d) -\n          real n * ln (real n)\\<bar>\n    \\<le> real n * 4", "proof (rule * [OF le])"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "have \"\\<bar>(\\<Sum>d = 1..n. mangoldt d * \\<lfloor>n / d\\<rfloor>) - (\\<Sum>d = 1..n. n * mangoldt d / d)\\<bar>\n        = \\<bar>\\<Sum>d = 1..n. mangoldt d * (\\<lfloor>n / d\\<rfloor> - n / d)\\<bar>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar> =\n    \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>", "by (simp add: sum_subtractf algebra_simps)"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n.\n            mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n        (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar> =\n  \\<bar>\\<Sum>d = 1..n.\n           mangoldt d *\n           (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n            real n / real d)\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n.\n            mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n        (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar> =\n  \\<bar>\\<Sum>d = 1..n.\n           mangoldt d *\n           (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n            real n / real d)\\<bar>\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "have \"\\<dots> \\<le> psi n\" (is \"\\<bar>?sm\\<bar> \\<le> ?rhs\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "have \"-?sm = (\\<Sum>d = 1..n. mangoldt d * (n/d - \\<lfloor>n/d\\<rfloor>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - (\\<Sum>d = 1..n.\n          mangoldt d *\n          (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n           real n / real d)) =\n    (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real n / real d - real_of_int \\<lfloor>real n / real d\\<rfloor>))", "by (simp add: sum_subtractf algebra_simps)"], ["proof (state)\nthis:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      (real n / real d - real_of_int \\<lfloor>real n / real d\\<rfloor>))\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "also"], ["proof (state)\nthis:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d)) =\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      (real n / real d - real_of_int \\<lfloor>real n / real d\\<rfloor>))\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "have \"\\<dots> \\<le> (\\<Sum>d = 1..n. mangoldt d * 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real n / real d - real_of_int \\<lfloor>real n / real d\\<rfloor>))\n    \\<le> (\\<Sum>d = 1..n. mangoldt d * 1)", "by (intro sum_mono mult_left_mono mangoldt_nonneg) linarith+"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      (real n / real d - real_of_int \\<lfloor>real n / real d\\<rfloor>))\n  \\<le> (\\<Sum>d = 1..n. mangoldt d * 1)\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "finally"], ["proof (chain)\npicking this:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> (\\<Sum>d = 1..n. mangoldt d * 1)", "have \"-?sm \\<le> ?rhs\""], ["proof (prove)\nusing this:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> (\\<Sum>d = 1..n. mangoldt d * 1)\n\ngoal (1 subgoal):\n 1. - (\\<Sum>d = 1..n.\n          mangoldt d *\n          (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n    \\<le> psi n", "by (simp add: psi_def)"], ["proof (state)\nthis:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> psi n\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "moreover"], ["proof (state)\nthis:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> psi n\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "have \"?sm \\<le> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n    \\<le> 0", "using mangoldt_nonneg"], ["proof (prove)\nusing this:\n  0 \\<le> mangoldt ?d\n\ngoal (1 subgoal):\n 1. (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n    \\<le> 0", "by (simp add: mult_le_0_iff sum_nonpos)"], ["proof (state)\nthis:\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "ultimately"], ["proof (chain)\npicking this:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> psi n\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  - (\\<Sum>d = 1..n.\n        mangoldt d *\n        (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> psi n\n  (\\<Sum>d = 1..n.\n      mangoldt d *\n      (real_of_int \\<lfloor>real n / real d\\<rfloor> - real n / real d))\n  \\<le> 0\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>d = 1..n.\n             mangoldt d *\n             (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n              real n / real d)\\<bar>\n    \\<le> psi n", "by (simp add: abs_if)"], ["proof (state)\nthis:\n  \\<bar>\\<Sum>d = 1..n.\n           mangoldt d *\n           (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n            real n / real d)\\<bar>\n  \\<le> psi n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>\\<Sum>d = 1..n.\n           mangoldt d *\n           (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n            real n / real d)\\<bar>\n  \\<le> psi n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  \\<bar>\\<Sum>d = 1..n.\n           mangoldt d *\n           (real_of_int \\<lfloor>real n / real d\\<rfloor> -\n            real n / real d)\\<bar>\n  \\<le> psi n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "have \"\\<dots> \\<le> 3/2 * real n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. psi n \\<le> 3 / 2 * real n", "by (rule psi_ubound_3_2)"], ["proof (state)\nthis:\n  psi n \\<le> 3 / 2 * real n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "also"], ["proof (state)\nthis:\n  psi n \\<le> 3 / 2 * real n\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "have \"\\<dots>\\<le> (4 - 1) * real n - (1 + ln n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 3 / 2 * real n \\<le> (4 - 1) * real n - (1 + ln (real n))", "using ln_le_minus_one [of n] assms"], ["proof (prove)\nusing this:\n  0 < real n \\<Longrightarrow> ln (real n) \\<le> real n - 1\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 3 / 2 * real n \\<le> (4 - 1) * real n - (1 + ln (real n))", "by (simp add: divide_simps)"], ["proof (state)\nthis:\n  3 / 2 * real n \\<le> (4 - 1) * real n - (1 + ln (real n))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "finally"], ["proof (chain)\npicking this:\n  \\<bar>(\\<Sum>d = 1..n.\n            mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n        (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n  \\<le> (4 - 1) * real n - (1 + ln (real n))", "show \"\\<bar>(\\<Sum>d = 1..n. mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n           (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n          \\<le> (4 - 1) * real n - (1 + ln n)\""], ["proof (prove)\nusing this:\n  \\<bar>(\\<Sum>d = 1..n.\n            mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n        (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n  \\<le> (4 - 1) * real n - (1 + ln (real n))\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n.\n              mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n          (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n    \\<le> (4 - 1) * real n - (1 + ln (real n))", "."], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n.\n            mangoldt d * real_of_int \\<lfloor>real n / real d\\<rfloor>) -\n        (\\<Sum>d = 1..n. real n * mangoldt d / real d)\\<bar>\n  \\<le> (4 - 1) * real n - (1 + ln (real n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. real n * mangoldt d / real d) -\n        real n * ln (real n)\\<bar>\n  \\<le> real n * 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "finally"], ["proof (chain)\npicking this:\n  \\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar>\n  \\<le> real n * 4", "have \"\\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln n)\\<bar> \\<le> real n * 4\""], ["proof (prove)\nusing this:\n  \\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar>\n  \\<le> real n * 4\n\ngoal (1 subgoal):\n 1. \\<bar>real n *\n          ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar>\n    \\<le> real n * 4", "."], ["proof (state)\nthis:\n  \\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar>\n  \\<le> real n * 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "then"], ["proof (chain)\npicking this:\n  \\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar>\n  \\<le> real n * 4", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar>\n  \\<le> real n * 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "using assms mult_le_cancel_left_pos"], ["proof (prove)\nusing this:\n  \\<bar>real n * ((\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n))\\<bar>\n  \\<le> real n * 4\n  n \\<noteq> 0\n  (0::?'a) < ?c \\<Longrightarrow> (?c * ?a \\<le> ?c * ?b) = (?a \\<le> ?b)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "by (simp add: abs_mult)"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Mertens_mangoldt_versus_ln:\n  assumes \"I \\<subseteq> {1..n}\"\n  shows \"\\<bar>(\\<Sum>i\\<in>I. mangoldt i / i) - (\\<Sum>p | prime p \\<and> p \\<in> I. ln p / p)\\<bar> \\<le> 3\"\n        (is \"\\<bar>?lhs\\<bar> \\<le> 3\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "proof (cases \"n = 0\")"], ["proof (state)\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "case True"], ["proof (state)\nthis:\n  n = 0\n\ngoal (2 subgoals):\n 1. n = 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3\n 2. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "with assms"], ["proof (chain)\npicking this:\n  I \\<subseteq> {1..n}\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  I \\<subseteq> {1..n}\n  n = 0\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "by simp"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n        (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "case False"], ["proof (state)\nthis:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "have \"finite I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite I", "using assms finite_subset"], ["proof (prove)\nusing this:\n  I \\<subseteq> {1..n}\n  \\<lbrakk>?A \\<subseteq> ?B; finite ?B\\<rbrakk> \\<Longrightarrow> finite ?A\n\ngoal (1 subgoal):\n 1. finite I", "by blast"], ["proof (state)\nthis:\n  finite I\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "have \"0 \\<le> (\\<Sum>i\\<in>I. mangoldt i / i - (if prime i then ln i / i else 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i\\<in>I.\n               mangoldt i / real i -\n               (if prime i then ln (real i) / real i else 0))", "using mangoldt_nonneg"], ["proof (prove)\nusing this:\n  0 \\<le> mangoldt ?d\n\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i\\<in>I.\n               mangoldt i / real i -\n               (if prime i then ln (real i) / real i else 0))", "by (intro sum_nonneg) simp_all"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i\\<in>I.\n             mangoldt i / real i -\n             (if prime i then ln (real i) / real i else 0))\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "moreover"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i\\<in>I.\n             mangoldt i / real i -\n             (if prime i then ln (real i) / real i else 0))\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "have \"\\<dots> \\<le> (\\<Sum>i = 1..n. mangoldt i / i - (if prime i then ln i / i else 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n    \\<le> (\\<Sum>i = 1..n.\n              mangoldt i / real i -\n              (if prime i then ln (real i) / real i else 0))", "using assms"], ["proof (prove)\nusing this:\n  I \\<subseteq> {1..n}\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I.\n       mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n    \\<le> (\\<Sum>i = 1..n.\n              mangoldt i / real i -\n              (if prime i then ln (real i) / real i else 0))", "by (intro sum_mono2) (auto simp: mangoldt_nonneg)"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I.\n     mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n  \\<le> (\\<Sum>i = 1..n.\n            mangoldt i / real i -\n            (if prime i then ln (real i) / real i else 0))\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "ultimately"], ["proof (chain)\npicking this:\n  0 \\<le> (\\<Sum>i\\<in>I.\n             mangoldt i / real i -\n             (if prime i then ln (real i) / real i else 0))\n  (\\<Sum>i\\<in>I.\n     mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n  \\<le> (\\<Sum>i = 1..n.\n            mangoldt i / real i -\n            (if prime i then ln (real i) / real i else 0))", "have *: \"\\<bar>\\<Sum>i\\<in>I. mangoldt i / i - (if prime i then ln i / i else 0)\\<bar>\n                      \\<le> \\<bar>\\<Sum>i = 1..n. mangoldt i / i - (if prime i then ln i / i else 0)\\<bar>\""], ["proof (prove)\nusing this:\n  0 \\<le> (\\<Sum>i\\<in>I.\n             mangoldt i / real i -\n             (if prime i then ln (real i) / real i else 0))\n  (\\<Sum>i\\<in>I.\n     mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n  \\<le> (\\<Sum>i = 1..n.\n            mangoldt i / real i -\n            (if prime i then ln (real i) / real i else 0))\n\ngoal (1 subgoal):\n 1. \\<bar>\\<Sum>i\\<in>I.\n            mangoldt i / real i -\n            (if prime i then ln (real i) / real i else 0)\\<bar>\n    \\<le> \\<bar>\\<Sum>i = 1..n.\n                   mangoldt i / real i -\n                   (if prime i then ln (real i) / real i else 0)\\<bar>", "by linarith"], ["proof (state)\nthis:\n  \\<bar>\\<Sum>i\\<in>I.\n          mangoldt i / real i -\n          (if prime i then ln (real i) / real i else 0)\\<bar>\n  \\<le> \\<bar>\\<Sum>i = 1..n.\n                 mangoldt i / real i -\n                 (if prime i then ln (real i) / real i else 0)\\<bar>\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "moreover"], ["proof (state)\nthis:\n  \\<bar>\\<Sum>i\\<in>I.\n          mangoldt i / real i -\n          (if prime i then ln (real i) / real i else 0)\\<bar>\n  \\<le> \\<bar>\\<Sum>i = 1..n.\n                 mangoldt i / real i -\n                 (if prime i then ln (real i) / real i else 0)\\<bar>\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "have \"?lhs = (\\<Sum>i\\<in>I. mangoldt i / i - (if prime i then ln i / i else 0))\"\n                  \"(\\<Sum>i = 1..n. mangoldt i / i - (if prime i then ln i / i else 0))\n                        = (\\<Sum>d = 1..n. mangoldt d / d) - (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. mangoldt i / real i) -\n    (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p) =\n    (\\<Sum>i\\<in>I.\n       mangoldt i / real i -\n       (if prime i then ln (real i) / real i else 0)) &&&\n    (\\<Sum>i = 1..n.\n        mangoldt i / real i -\n        (if prime i then ln (real i) / real i else 0)) =\n    (\\<Sum>d = 1..n. mangoldt d / real d) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)", "using sum.inter_restrict [of _ \"\\<lambda>i. ln (real i) / i\" \"Collect prime\", symmetric]"], ["proof (prove)\nusing this:\n  finite ?A \\<Longrightarrow>\n  (\\<Sum>x\\<in>?A.\n     if x \\<in> Collect prime then ln (real x) / real x else 0) =\n  (\\<Sum>i\\<in>?A \\<inter> Collect prime. ln (real i) / real i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>I. mangoldt i / real i) -\n    (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p) =\n    (\\<Sum>i\\<in>I.\n       mangoldt i / real i -\n       (if prime i then ln (real i) / real i else 0)) &&&\n    (\\<Sum>i = 1..n.\n        mangoldt i / real i -\n        (if prime i then ln (real i) / real i else 0)) =\n    (\\<Sum>d = 1..n. mangoldt d / real d) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)", "by (force simp: sum_subtractf \\<open>finite I\\<close> intro: sum.cong)+"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>I. mangoldt i / real i) -\n  (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p) =\n  (\\<Sum>i\\<in>I.\n     mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n  (\\<Sum>i = 1..n.\n      mangoldt i / real i - (if prime i then ln (real i) / real i else 0)) =\n  (\\<Sum>d = 1..n. mangoldt d / real d) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "ultimately"], ["proof (chain)\npicking this:\n  \\<bar>\\<Sum>i\\<in>I.\n          mangoldt i / real i -\n          (if prime i then ln (real i) / real i else 0)\\<bar>\n  \\<le> \\<bar>\\<Sum>i = 1..n.\n                 mangoldt i / real i -\n                 (if prime i then ln (real i) / real i else 0)\\<bar>\n  (\\<Sum>i\\<in>I. mangoldt i / real i) -\n  (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p) =\n  (\\<Sum>i\\<in>I.\n     mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n  (\\<Sum>i = 1..n.\n      mangoldt i / real i - (if prime i then ln (real i) / real i else 0)) =\n  (\\<Sum>d = 1..n. mangoldt d / real d) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)", "have \"\\<bar>?lhs\\<bar> \\<le> \\<bar>(\\<Sum>d = 1..n. mangoldt d / d) - \n                          (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p)\\<bar>\""], ["proof (prove)\nusing this:\n  \\<bar>\\<Sum>i\\<in>I.\n          mangoldt i / real i -\n          (if prime i then ln (real i) / real i else 0)\\<bar>\n  \\<le> \\<bar>\\<Sum>i = 1..n.\n                 mangoldt i / real i -\n                 (if prime i then ln (real i) / real i else 0)\\<bar>\n  (\\<Sum>i\\<in>I. mangoldt i / real i) -\n  (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p) =\n  (\\<Sum>i\\<in>I.\n     mangoldt i / real i - (if prime i then ln (real i) / real i else 0))\n  (\\<Sum>i = 1..n.\n      mangoldt i / real i - (if prime i then ln (real i) / real i else 0)) =\n  (\\<Sum>d = 1..n. mangoldt d / real d) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n                (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n                   ln (real x) / real x)\\<bar>", "by linarith"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n        (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n  \\<le> \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n              (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n                 ln (real x) / real x)\\<bar>\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n        (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n  \\<le> \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n              (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n                 ln (real x) / real x)\\<bar>\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "have \"\\<dots> \\<le> 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "have eq_sm: \"(\\<Sum>i = 1..n. mangoldt i / i) = \n                     (\\<Sum>i \\<in> {p^k |p k. prime p \\<and> p^k \\<le> n \\<and> k \\<ge> 1}. mangoldt i / i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n       mangoldt i / real i)", "proof (intro sum.mono_neutral_right ballI, goal_cases)"], ["proof (state)\ngoal (3 subgoals):\n 1. finite {1..n}\n 2. {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n    \\<subseteq> {1..n}\n 3. \\<And>i.\n       i \\<in> {1..n} -\n               {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 1 \\<le> k} \\<Longrightarrow>\n       mangoldt i / real i = 0", "case (3 i)"], ["proof (state)\nthis:\n  i \\<in> {1..n} -\n          {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n\ngoal (3 subgoals):\n 1. finite {1..n}\n 2. {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n    \\<subseteq> {1..n}\n 3. \\<And>i.\n       i \\<in> {1..n} -\n               {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 1 \\<le> k} \\<Longrightarrow>\n       mangoldt i / real i = 0", "hence \"\\<not>primepow i\""], ["proof (prove)\nusing this:\n  i \\<in> {1..n} -\n          {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n\ngoal (1 subgoal):\n 1. \\<not> primepow i", "by (auto simp: primepow_def Suc_le_eq)"], ["proof (state)\nthis:\n  \\<not> primepow i\n\ngoal (3 subgoals):\n 1. finite {1..n}\n 2. {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n    \\<subseteq> {1..n}\n 3. \\<And>i.\n       i \\<in> {1..n} -\n               {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 1 \\<le> k} \\<Longrightarrow>\n       mangoldt i / real i = 0", "thus ?case"], ["proof (prove)\nusing this:\n  \\<not> primepow i\n\ngoal (1 subgoal):\n 1. mangoldt i / real i = 0", "by (simp add: mangoldt_def)"], ["proof (state)\nthis:\n  mangoldt i / real i = 0\n\ngoal (2 subgoals):\n 1. finite {1..n}\n 2. {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n    \\<subseteq> {1..n}", "qed (auto simp: Suc_le_eq prime_gt_0_nat)"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n     mangoldt i / real i)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "have \"(\\<Sum>i = 1..n. mangoldt i / i) - (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p) =\n            (\\<Sum>i \\<in> {p^k |p k. prime p \\<and> p^k \\<le> n \\<and> k \\<ge> 2}. mangoldt i / i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "have eq: \"{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k} =\n                  {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union> {p. prime p \\<and> p \\<in> {1..n}}\"\n          (is \"?A = ?B \\<union> ?C\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k} =\n    {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n    {p. prime p \\<and> p \\<in> {1..n}}", "proof (intro equalityI subsetI; (elim UnE)?)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 1 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}\n 2. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 3. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "fix x"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 1 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}\n 2. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 3. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "assume \"x \\<in> ?A\""], ["proof (state)\nthis:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 1 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}\n 2. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 3. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "then"], ["proof (chain)\npicking this:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "obtain p k where \"x = p ^ k\" \"prime p\" \"p ^ k \\<le> n\" \"k \\<ge> 1\""], ["proof (prove)\nusing this:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n\ngoal (1 subgoal):\n 1. (\\<And>p k.\n        \\<lbrakk>x = p ^ k; prime p; p ^ k \\<le> n; 1 \\<le> k\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x = p ^ k\n  prime p\n  p ^ k \\<le> n\n  1 \\<le> k\n\ngoal (3 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 1 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}\n 2. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 3. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "thus \"x \\<in> ?B \\<union> ?C\""], ["proof (prove)\nusing this:\n  x = p ^ k\n  prime p\n  p ^ k \\<le> n\n  1 \\<le> k\n\ngoal (1 subgoal):\n 1. x \\<in> {p ^ k |p k.\n             prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n            {p. prime p \\<and> p \\<in> {1..n}}", "by (cases \"k \\<ge> 2\") (auto simp: prime_power_iff Suc_le_eq)"], ["proof (state)\nthis:\n  x \\<in> {p ^ k |p k.\n           prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n          {p. prime p \\<and> p \\<in> {1..n}}\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 2. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 2. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "fix x"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 2. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "assume \"x \\<in> ?B\""], ["proof (state)\nthis:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 2. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "then"], ["proof (chain)\npicking this:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}", "obtain p k where \"x = p ^ k\" \"prime p\" \"p ^ k \\<le> n\" \"k \\<ge> 1\""], ["proof (prove)\nusing this:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}\n\ngoal (1 subgoal):\n 1. (\\<And>p k.\n        \\<lbrakk>x = p ^ k; prime p; p ^ k \\<le> n; 1 \\<le> k\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x = p ^ k\n  prime p\n  p ^ k \\<le> n\n  1 \\<le> k\n\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> {p ^ k |p k.\n                prime p \\<and>\n                p ^ k \\<le> n \\<and> 2 \\<le> k} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n 2. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "thus \"x \\<in> ?A\""], ["proof (prove)\nusing this:\n  x = p ^ k\n  prime p\n  p ^ k \\<le> n\n  1 \\<le> k\n\ngoal (1 subgoal):\n 1. x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "by (auto simp: prime_power_iff Suc_le_eq)"], ["proof (state)\nthis:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "fix x"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "assume \"x \\<in> ?C\""], ["proof (state)\nthis:\n  x \\<in> {p. prime p \\<and> p \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "then"], ["proof (chain)\npicking this:\n  x \\<in> {p. prime p \\<and> p \\<in> {1..n}}", "obtain p where \"x = p ^ 1\" \"1 \\<ge> (1::nat)\" \"prime p\" \"p ^ 1 \\<le> n\""], ["proof (prove)\nusing this:\n  x \\<in> {p. prime p \\<and> p \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. (\\<And>p.\n        \\<lbrakk>x = p ^ 1; 1 \\<le> 1; prime p; p ^ 1 \\<le> n\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x = p ^ 1\n  1 \\<le> 1\n  prime p\n  p ^ 1 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {p. prime p \\<and> p \\<in> {1..n}} \\<Longrightarrow>\n       x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "thus \"x \\<in> ?A\""], ["proof (prove)\nusing this:\n  x = p ^ 1\n  1 \\<le> 1\n  prime p\n  p ^ 1 \\<le> n\n\ngoal (1 subgoal):\n 1. x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "by blast"], ["proof (state)\nthis:\n  x \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k} =\n  {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n  {p. prime p \\<and> p \\<in> {1..n}}\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "have eqln: \"(\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p) = \n                      (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p) =\n    (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)", "by (rule sum.cong) auto"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p) =\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "have \"(\\<Sum>i \\<in> {p^k |p k. prime p \\<and> p^k \\<le> n \\<and> k \\<ge> 1}. mangoldt i / i) = \n                (\\<Sum>i \\<in> {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union> \n                {p. prime p \\<and> p \\<in> {1..n}}. mangoldt i / i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n       mangoldt i / real i) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n                 {p. prime p \\<and> p \\<in> {1..n}}.\n       mangoldt i / real i)", "by (subst eq) simp_all"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n     mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}.\n     mangoldt i / real i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n     mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}.\n     mangoldt i / real i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "have \"\\<dots> = (\\<Sum>i \\<in> {p^k |p k. prime p \\<and> p^k \\<le> n \\<and> k \\<ge> 2}. mangoldt i / i)\n                       + (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n                 {p. prime p \\<and> p \\<in> {1..n}}.\n       mangoldt i / real i) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i) +\n    (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)", "by (intro sum.union_disjoint) (auto simp: prime_power_iff finite_nat_set_iff_bounded_le)"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>{p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}.\n     mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i) +\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "also"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>{p ^ k |p k.\n                prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k} \\<union>\n               {p. prime p \\<and> p \\<in> {1..n}}.\n     mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i) +\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "have \"\\<dots> = (\\<Sum>i \\<in> {p^k |p k. prime p \\<and> p^k \\<le> n \\<and> k \\<ge> 2}. mangoldt i / i)\n                       + (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i) +\n    (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i) +\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)", "by (simp only: eqln)"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i) +\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i) +\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n     mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i) +\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n     mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i) +\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "using eq_sm"], ["proof (prove)\nusing this:\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n     mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i) +\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  (\\<Sum>i = 1..n. mangoldt i / real i) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}.\n     mangoldt i / real i)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n    (\\<Sum>i\\<in>{p ^ k |p k.\n                  prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n       mangoldt i / real i)", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) =\n  (\\<Sum>i\\<in>{p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 2 \\<le> k}.\n     mangoldt i / real i)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "have \"(\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p) \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p)\n    \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)", "using mangoldt_nonneg"], ["proof (prove)\nusing this:\n  0 \\<le> mangoldt ?d\n\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p)\n    \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)", "by (auto intro: sum_mono)"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p)\n  \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p)\n  \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "have \"\\<dots> \\<le> (\\<Sum>i = Suc 0..n. mangoldt i / i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)\n    \\<le> (\\<Sum>i = Suc 0..n. mangoldt i / real i)", "by (intro sum_mono2) (auto simp: mangoldt_nonneg)"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. mangoldt p / real p)\n  \\<le> (\\<Sum>i = Suc 0..n. mangoldt i / real i)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p)\n  \\<le> (\\<Sum>i = Suc 0..n. mangoldt i / real i)", "have \"0 \\<le> (\\<Sum>i = 1..n. mangoldt i / i) - (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p)\""], ["proof (prove)\nusing this:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p)\n  \\<le> (\\<Sum>i = Suc 0..n. mangoldt i / real i)\n\ngoal (1 subgoal):\n 1. 0 \\<le> (\\<Sum>i = 1..n. mangoldt i / real i) -\n            (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n               ln (real x) / real x)", "by simp"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i = 1..n. mangoldt i / real i) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "moreover"], ["proof (state)\nthis:\n  0 \\<le> (\\<Sum>i = 1..n. mangoldt i / real i) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "have \"(\\<Sum>i = 1..n. mangoldt i / i) - (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p / p) \\<le> 3\"\n                     (is \"?M - ?L \\<le> 3\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have *: \"\\<exists>q. \\<exists>j\\<in>{1..n}. prime q \\<and> 1 \\<le> q \\<and> q \\<le> n \\<and>\n                  (q ^ j = p ^ k \\<and> mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j)\"\n          if \"prime p\" \"p ^ k \\<le> n\" \"1 \\<le> k\" for p k"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "have \"mangoldt (p ^ k) / real p ^ k \\<le> ln p / p ^ k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mangoldt (p ^ k) / real p ^ k \\<le> ln (real p) / real (p ^ k)", "using that"], ["proof (prove)\nusing this:\n  prime p\n  p ^ k \\<le> n\n  1 \\<le> k\n\ngoal (1 subgoal):\n 1. mangoldt (p ^ k) / real p ^ k \\<le> ln (real p) / real (p ^ k)", "by (simp add: divide_simps)"], ["proof (state)\nthis:\n  mangoldt (p ^ k) / real p ^ k \\<le> ln (real p) / real (p ^ k)\n\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "moreover"], ["proof (state)\nthis:\n  mangoldt (p ^ k) / real p ^ k \\<le> ln (real p) / real (p ^ k)\n\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "have \"p \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<le> n", "using that self_le_power[of p k]"], ["proof (prove)\nusing this:\n  prime p\n  p ^ k \\<le> n\n  1 \\<le> k\n  \\<lbrakk>1 \\<le> p; 0 < k\\<rbrakk> \\<Longrightarrow> p \\<le> p ^ k\n\ngoal (1 subgoal):\n 1. p \\<le> n", "by (simp add: prime_ge_Suc_0_nat)"], ["proof (state)\nthis:\n  p \\<le> n\n\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "moreover"], ["proof (state)\nthis:\n  p \\<le> n\n\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "have \"k \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k \\<le> n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. k \\<le> n", "have \"k < 2^k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ k", "using of_nat_less_two_power of_nat_less_numeral_power_cancel_iff"], ["proof (prove)\nusing this:\n  of_nat ?n < (2::?'a) ^ ?n\n  (of_nat ?x < numeral ?i ^ ?n) = (?x < numeral ?i ^ ?n)\n\ngoal (1 subgoal):\n 1. k < 2 ^ k", "by blast"], ["proof (state)\nthis:\n  k < 2 ^ k\n\ngoal (1 subgoal):\n 1. k \\<le> n", "also"], ["proof (state)\nthis:\n  k < 2 ^ k\n\ngoal (1 subgoal):\n 1. k \\<le> n", "have \"\\<dots> \\<le> p^k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 ^ k \\<le> p ^ k", "by (simp add: power_mono prime_ge_2_nat that)"], ["proof (state)\nthis:\n  2 ^ k \\<le> p ^ k\n\ngoal (1 subgoal):\n 1. k \\<le> n", "also"], ["proof (state)\nthis:\n  2 ^ k \\<le> p ^ k\n\ngoal (1 subgoal):\n 1. k \\<le> n", "have \"\\<dots> \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p ^ k \\<le> n", "by (simp add: that)"], ["proof (state)\nthis:\n  p ^ k \\<le> n\n\ngoal (1 subgoal):\n 1. k \\<le> n", "finally"], ["proof (chain)\npicking this:\n  k < n", "show ?thesis"], ["proof (prove)\nusing this:\n  k < n\n\ngoal (1 subgoal):\n 1. k \\<le> n", "by (simp add: that)"], ["proof (state)\nthis:\n  k \\<le> n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  k \\<le> n\n\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "ultimately"], ["proof (chain)\npicking this:\n  mangoldt (p ^ k) / real p ^ k \\<le> ln (real p) / real (p ^ k)\n  p \\<le> n\n  k \\<le> n", "show ?thesis"], ["proof (prove)\nusing this:\n  mangoldt (p ^ k) / real p ^ k \\<le> ln (real p) / real (p ^ k)\n  p \\<le> n\n  k \\<le> n\n\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "using prime_ge_1_nat that"], ["proof (prove)\nusing this:\n  mangoldt (p ^ k) / real p ^ k \\<le> ln (real p) / real (p ^ k)\n  p \\<le> n\n  k \\<le> n\n  prime ?p \\<Longrightarrow> 1 \\<le> ?p\n  prime p\n  p ^ k \\<le> n\n  1 \\<le> k\n\ngoal (1 subgoal):\n 1. \\<exists>q.\n       \\<exists>j\\<in>{1..n}.\n          prime q \\<and>\n          1 \\<le> q \\<and>\n          q \\<le> n \\<and>\n          q ^ j = p ^ k \\<and>\n          mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j", "by auto (use atLeastAtMost_iff in blast)"], ["proof (state)\nthis:\n  \\<exists>q.\n     \\<exists>j\\<in>{1..n}.\n        prime q \\<and>\n        1 \\<le> q \\<and>\n        q \\<le> n \\<and>\n        q ^ j = p ^ k \\<and>\n        mangoldt (p ^ k) / real p ^ k \\<le> ln (real q) / real q ^ j\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>prime ?p; ?p ^ ?k \\<le> n; 1 \\<le> ?k\\<rbrakk>\n  \\<Longrightarrow> \\<exists>q.\n                       \\<exists>j\\<in>{1..n}.\n                          prime q \\<and>\n                          1 \\<le> q \\<and>\n                          q \\<le> n \\<and>\n                          q ^ j = ?p ^ ?k \\<and>\n                          mangoldt (?p ^ ?k) / real ?p ^ ?k\n                          \\<le> ln (real q) / real q ^ j\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have finite: \"finite {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}", "by (rule finite_subset[of _ \"{..n}\"]) auto"], ["proof (state)\nthis:\n  finite {p ^ k |p k. prime p \\<and> p ^ k \\<le> n \\<and> 1 \\<le> k}\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"?M \\<le> (\\<Sum>(x, k)\\<in>{p. prime p \\<and> p \\<in> {1..n}} \\<times> {1..n}. ln (real x) / real x ^ k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i)\n    \\<le> (\\<Sum>(x, k)\n                 \\<in>{p. prime p \\<and> p \\<in> {1..n}} \\<times> {1..n}.\n             ln (real x) / real x ^ k)", "by (subst eq_sm, intro sum_le_included [where i = \"\\<lambda>(p,k). p^k\"])\n             (insert * finite, auto)"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i)\n  \\<le> (\\<Sum>(x, k)\n               \\<in>{p. prime p \\<and> p \\<in> {1..n}} \\<times> {1..n}.\n           ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i)\n  \\<le> (\\<Sum>(x, k)\n               \\<in>{p. prime p \\<and> p \\<in> {1..n}} \\<times> {1..n}.\n           ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> = (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. (\\<Sum>k = 1..n. ln p / p^k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>(x, k)\\<in>{p. prime p \\<and> p \\<in> {1..n}} \\<times> {1..n}.\n       ln (real x) / real x ^ k) =\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       \\<Sum>k = 1..n. ln (real x) / real x ^ k)", "by (subst sum.Sigma) auto"], ["proof (state)\nthis:\n  (\\<Sum>(x, k)\\<in>{p. prime p \\<and> p \\<in> {1..n}} \\<times> {1..n}.\n     ln (real x) / real x ^ k) =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     \\<Sum>k = 1..n. ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>(x, k)\\<in>{p. prime p \\<and> p \\<in> {1..n}} \\<times> {1..n}.\n     ln (real x) / real x ^ k) =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     \\<Sum>k = 1..n. ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> = ?L + (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. (\\<Sum>k = 2..n. ln p / p^k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       \\<Sum>k = 1..n. ln (real x) / real x ^ k) =\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) +\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       \\<Sum>k = 2..n. ln (real x) / real x ^ k)", "by (simp add: comm_monoid_add_class.sum.distrib sum.atLeast_Suc_atMost numeral_2_eq_2)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     \\<Sum>k = 1..n. ln (real x) / real x ^ k) =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x) +\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     \\<Sum>k = 2..n. ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i = 1..n. mangoldt i / real i)\n  \\<le> (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           ln (real x) / real x) +\n        (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           \\<Sum>k = 2..n. ln (real x) / real x ^ k)", "have \"?M - ?L \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. (\\<Sum>k = 2..n. ln p / p^k))\""], ["proof (prove)\nusing this:\n  (\\<Sum>i = 1..n. mangoldt i / real i)\n  \\<le> (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           ln (real x) / real x) +\n        (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           \\<Sum>k = 2..n. ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             \\<Sum>k = 2..n. ln (real x) / real x ^ k)", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           \\<Sum>k = 2..n. ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           \\<Sum>k = 2..n. ln (real x) / real x ^ k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> = (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p * (\\<Sum>k = 2..n. inverse p ^ k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       \\<Sum>k = 2..n. ln (real x) / real x ^ k) =\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       ln (real x) * sum ((^) (inverse (real x))) {2..n})", "by (simp add: field_simps sum_distrib_left)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     \\<Sum>k = 2..n. ln (real x) / real x ^ k) =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) * sum ((^) (inverse (real x))) {2..n})\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     \\<Sum>k = 2..n. ln (real x) / real x ^ k) =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) * sum ((^) (inverse (real x))) {2..n})\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> = (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. \n                          ln p * (((inverse p)\\<^sup>2 - inverse p ^ Suc n) / (1 - inverse p)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       ln (real x) * sum ((^) (inverse (real x))) {2..n}) =\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       ln (real x) *\n       (((inverse (real x))\\<^sup>2 - inverse (real x) ^ Suc n) /\n        (1 - inverse (real x))))", "by (intro sum.cong refl) (simp add: sum_gp)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) * sum ((^) (inverse (real x))) {2..n}) =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) *\n     (((inverse (real x))\\<^sup>2 - inverse (real x) ^ Suc n) /\n      (1 - inverse (real x))))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) * sum ((^) (inverse (real x))) {2..n}) =\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) *\n     (((inverse (real x))\\<^sup>2 - inverse (real x) ^ Suc n) /\n      (1 - inverse (real x))))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln p * inverse (real (p * (p - 1))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n       ln (real x) *\n       (((inverse (real x))\\<^sup>2 - inverse (real x) ^ Suc n) /\n        (1 - inverse (real x))))\n    \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n             ln (real p) * inverse (real (p * (p - 1))))", "by (intro sum_mono mult_left_mono)\n             (auto simp: divide_simps power2_eq_square of_nat_diff mult_less_0_iff)"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) *\n     (((inverse (real x))\\<^sup>2 - inverse (real x) ^ Suc n) /\n      (1 - inverse (real x))))\n  \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n           ln (real p) * inverse (real (p * (p - 1))))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n     ln (real x) *\n     (((inverse (real x))\\<^sup>2 - inverse (real x) ^ Suc n) /\n      (1 - inverse (real x))))\n  \\<le> (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n           ln (real p) * inverse (real (p * (p - 1))))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> \\<le> (\\<Sum>p = 2..n. ln p * inverse (real (p * (p - 1))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n       ln (real p) * inverse (real (p * (p - 1))))\n    \\<le> (\\<Sum>p = 2..n. ln (real p) * inverse (real (p * (p - 1))))", "by (rule sum_mono2) (use prime_ge_2_nat in auto)"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n     ln (real p) * inverse (real (p * (p - 1))))\n  \\<le> (\\<Sum>p = 2..n. ln (real p) * inverse (real (p * (p - 1))))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n     ln (real p) * inverse (real (p * (p - 1))))\n  \\<le> (\\<Sum>p = 2..n. ln (real p) * inverse (real (p * (p - 1))))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> \\<le> (\\<Sum>i = 2..n. ln i / (i - 1)\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p = 2..n. ln (real p) * inverse (real (p * (p - 1))))\n    \\<le> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))", "unfolding divide_inverse power2_eq_square mult.assoc"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>p = 2..n. ln (real p) * inverse (real (p * (p - 1))))\n    \\<le> (\\<Sum>i = 2..n. ln (real i) * inverse (real ((i - 1) * (i - 1))))", "by (auto intro: sum_mono mult_left_mono mult_right_mono)"], ["proof (state)\nthis:\n  (\\<Sum>p = 2..n. ln (real p) * inverse (real (p * (p - 1))))\n  \\<le> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>p = 2..n. ln (real p) * inverse (real (p * (p - 1))))\n  \\<le> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "have \"\\<dots> \\<le> 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "proof (cases \"n \\<ge> 3\")"], ["proof (state)\ngoal (2 subgoals):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3\n 2. \\<not> 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "case False"], ["proof (state)\nthis:\n  \\<not> 3 \\<le> n\n\ngoal (2 subgoals):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3\n 2. \\<not> 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "then"], ["proof (chain)\npicking this:\n  \\<not> 3 \\<le> n", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<not> 3 \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "proof (cases \"n \\<ge> 2\")"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> 3 \\<le> n; 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3\n 2. \\<lbrakk>\\<not> 3 \\<le> n; \\<not> 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3", "case False"], ["proof (state)\nthis:\n  \\<not> 2 \\<le> n\n\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> 3 \\<le> n; 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3\n 2. \\<lbrakk>\\<not> 3 \\<le> n; \\<not> 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3", "then"], ["proof (chain)\npicking this:\n  \\<not> 2 \\<le> n", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<not> 2 \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 3 \\<le> n; 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 3 \\<le> n; 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3", "case True"], ["proof (state)\nthis:\n  2 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 3 \\<le> n; 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3", "then"], ["proof (chain)\npicking this:\n  2 \\<le> n", "have \"n = 2\""], ["proof (prove)\nusing this:\n  2 \\<le> n\n\ngoal (1 subgoal):\n 1. n = 2", "using False"], ["proof (prove)\nusing this:\n  2 \\<le> n\n  \\<not> 3 \\<le> n\n\ngoal (1 subgoal):\n 1. n = 2", "by linarith"], ["proof (state)\nthis:\n  n = 2\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> 3 \\<le> n; 2 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2))\n                      \\<le> 3", "with ln_le_minus_one [of 2]"], ["proof (chain)\npicking this:\n  0 < 2 \\<Longrightarrow> ln 2 \\<le> 2 - 1\n  n = 2", "show ?thesis"], ["proof (prove)\nusing this:\n  0 < 2 \\<Longrightarrow> ln 2 \\<le> 2 - 1\n  n = 2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3\n\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "case True"], ["proof (state)\nthis:\n  3 \\<le> n\n\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "have \"(\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n                \\<le> (ln (of_nat n - 1)) - (ln (of_nat n)) - (ln (of_nat n) / (of_nat n - 1)) + 2 * ln 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n    \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n          2 * ln 2", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n    \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n          2 * ln 2", "have 1: \"((\\<lambda>z. ln (z - 1) - ln z - ln z / (z - 1)) has_field_derivative ln x / (x - 1)\\<^sup>2) (at x)\"\n              if x: \"x \\<in> {2..real n}\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>z. ln (z - 1) - ln z - ln z / (z - 1)) has_real_derivative\n     ln x / (x - 1)\\<^sup>2)\n     (at x)", "by (rule derivative_eq_intros | rule refl | \n                   (use x in \\<open>force simp: power2_eq_square divide_simps\\<close>))+"], ["proof (state)\nthis:\n  ?x \\<in> {2..real n} \\<Longrightarrow>\n  ((\\<lambda>z. ln (z - 1) - ln z - ln z / (z - 1)) has_real_derivative\n   ln ?x / (?x - 1)\\<^sup>2)\n   (at ?x)\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n    \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n          2 * ln 2", "have 2: \"ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\" if xy: \"2 \\<le> x\" \"x \\<le> y\" \"y \\<le> real n\" for x y"], ["proof (prove)\ngoal (1 subgoal):\n 1. ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "proof (cases \"x = y\")"], ["proof (state)\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "case False"], ["proof (state)\nthis:\n  x \\<noteq> y\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "define f' :: \"real \\<Rightarrow> real\"\n                where \"f' = (\\<lambda>u. ((u - 1)\\<^sup>2 / u - ln u * (2 * u - 2)) / (u - 1) ^ 4)\""], ["proof (state)\nthis:\n  f' =\n  (\\<lambda>u. ((u - 1)\\<^sup>2 / u - ln u * (2 * u - 2)) / (u - 1) ^ 4)\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "have f'_altdef: \"f' u = inverse u * inverse ((u - 1)\\<^sup>2) - 2 * ln u / (u - 1) ^ 3\" \n                if u: \"u \\<in> {x..y}\" for u::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. f' u = inverse u * inverse ((u - 1)\\<^sup>2) - 2 * ln u / (u - 1) ^ 3", "unfolding f'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((u - 1)\\<^sup>2 / u - ln u * (2 * u - 2)) / (u - 1) ^ 4 =\n    inverse u * inverse ((u - 1)\\<^sup>2) - 2 * ln u / (u - 1) ^ 3", "using u"], ["proof (prove)\nusing this:\n  u \\<in> {x..y}\n\ngoal (1 subgoal):\n 1. ((u - 1)\\<^sup>2 / u - ln u * (2 * u - 2)) / (u - 1) ^ 4 =\n    inverse u * inverse ((u - 1)\\<^sup>2) - 2 * ln u / (u - 1) ^ 3", "(* TODO ugly *)"], ["proof (prove)\nusing this:\n  u \\<in> {x..y}\n\ngoal (1 subgoal):\n 1. ((u - 1)\\<^sup>2 / u - ln u * (2 * u - 2)) / (u - 1) ^ 4 =\n    inverse u * inverse ((u - 1)\\<^sup>2) - 2 * ln u / (u - 1) ^ 3", "by (simp add: eval_nat_numeral divide_simps) (simp add: algebra_simps)?"], ["proof (state)\nthis:\n  ?u \\<in> {x..y} \\<Longrightarrow>\n  f' ?u = inverse ?u * inverse ((?u - 1)\\<^sup>2) - 2 * ln ?u / (?u - 1) ^ 3\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "have deriv: \"((\\<lambda>z. ln z / (z - 1)\\<^sup>2) has_field_derivative f' u) (at u)\"\n                if u: \"u \\<in> {x..y}\" for u::real"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>z. ln z / (z - 1)\\<^sup>2) has_real_derivative f' u) (at u)", "unfolding f'_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<lambda>z. ln z / (z - 1)\\<^sup>2) has_real_derivative\n     ((u - 1)\\<^sup>2 / u - ln u * (2 * u - 2)) / (u - 1) ^ 4)\n     (at u)", "by (rule derivative_eq_intros refl | (use u xy in \\<open>force simp: divide_simps\\<close>))+"], ["proof (state)\nthis:\n  ?u \\<in> {x..y} \\<Longrightarrow>\n  ((\\<lambda>z. ln z / (z - 1)\\<^sup>2) has_real_derivative f' ?u) (at ?u)\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "hence \"\\<exists>z>x. z < y \\<and> ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' z\""], ["proof (prove)\nusing this:\n  ?u \\<in> {x..y} \\<Longrightarrow>\n  ((\\<lambda>z. ln z / (z - 1)\\<^sup>2) has_real_derivative f' ?u) (at ?u)\n\ngoal (1 subgoal):\n 1. \\<exists>z>x.\n       z < y \\<and>\n       ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' z", "using xy and \\<open>x \\<noteq> y\\<close>"], ["proof (prove)\nusing this:\n  ?u \\<in> {x..y} \\<Longrightarrow>\n  ((\\<lambda>z. ln z / (z - 1)\\<^sup>2) has_real_derivative f' ?u) (at ?u)\n  2 \\<le> x\n  x \\<le> y\n  y \\<le> real n\n  x \\<noteq> y\n\ngoal (1 subgoal):\n 1. \\<exists>z>x.\n       z < y \\<and>\n       ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' z", "by (intro MVT2) auto"], ["proof (state)\nthis:\n  \\<exists>z>x.\n     z < y \\<and>\n     ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' z\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "then"], ["proof (chain)\npicking this:\n  \\<exists>z>x.\n     z < y \\<and>\n     ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' z", "obtain \\<xi>::real where \"x < \\<xi>\" \"\\<xi> < y\"\n                and \\<xi>: \"ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' \\<xi>\""], ["proof (prove)\nusing this:\n  \\<exists>z>x.\n     z < y \\<and>\n     ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' z\n\ngoal (1 subgoal):\n 1. (\\<And>\\<xi>.\n        \\<lbrakk>x < \\<xi>; \\<xi> < y;\n         ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 =\n         (y - x) * f' \\<xi>\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  x < \\<xi>\n  \\<xi> < y\n  ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 = (y - x) * f' \\<xi>\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "have \"f' \\<xi> \\<le> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "have \"2/3 \\<le> ln (2::real)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 / 3 \\<le> ln 2", "by (fact ln_2_ge')"], ["proof (state)\nthis:\n  2 / 3 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "also"], ["proof (state)\nthis:\n  2 / 3 \\<le> ln 2\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "have \"\\<dots> \\<le> ln \\<xi>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln 2 \\<le> ln \\<xi>", "using \\<open>x < \\<xi>\\<close> xy"], ["proof (prove)\nusing this:\n  x < \\<xi>\n  2 \\<le> x\n  x \\<le> y\n  y \\<le> real n\n\ngoal (1 subgoal):\n 1. ln 2 \\<le> ln \\<xi>", "by auto"], ["proof (state)\nthis:\n  ln 2 \\<le> ln \\<xi>\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "finally"], ["proof (chain)\npicking this:\n  2 / 3 \\<le> ln \\<xi>", "have \"1 \\<le> 2 * ln \\<xi>\""], ["proof (prove)\nusing this:\n  2 / 3 \\<le> ln \\<xi>\n\ngoal (1 subgoal):\n 1. 1 \\<le> 2 * ln \\<xi>", "by simp"], ["proof (state)\nthis:\n  1 \\<le> 2 * ln \\<xi>\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "then"], ["proof (chain)\npicking this:\n  1 \\<le> 2 * ln \\<xi>", "have *: \"\\<xi> \\<le> \\<xi> * (2 * ln \\<xi>)\""], ["proof (prove)\nusing this:\n  1 \\<le> 2 * ln \\<xi>\n\ngoal (1 subgoal):\n 1. \\<xi> \\<le> \\<xi> * (2 * ln \\<xi>)", "using \\<open>x < \\<xi>\\<close> xy"], ["proof (prove)\nusing this:\n  1 \\<le> 2 * ln \\<xi>\n  x < \\<xi>\n  2 \\<le> x\n  x \\<le> y\n  y \\<le> real n\n\ngoal (1 subgoal):\n 1. \\<xi> \\<le> \\<xi> * (2 * ln \\<xi>)", "by auto"], ["proof (state)\nthis:\n  \\<xi> \\<le> \\<xi> * (2 * ln \\<xi>)\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "hence \"\\<xi> - 1 \\<le> ln \\<xi> * 2 * \\<xi>\""], ["proof (prove)\nusing this:\n  \\<xi> \\<le> \\<xi> * (2 * ln \\<xi>)\n\ngoal (1 subgoal):\n 1. \\<xi> - 1 \\<le> ln \\<xi> * 2 * \\<xi>", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  \\<xi> - 1 \\<le> ln \\<xi> * 2 * \\<xi>\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "hence \"1 / (\\<xi> * (\\<xi> - 1)\\<^sup>2) \\<le> ln \\<xi> * 2 / (\\<xi> - 1) ^ 3\""], ["proof (prove)\nusing this:\n  \\<xi> - 1 \\<le> ln \\<xi> * 2 * \\<xi>\n\ngoal (1 subgoal):\n 1. 1 / (\\<xi> * (\\<xi> - 1)\\<^sup>2) \\<le> ln \\<xi> * 2 / (\\<xi> - 1) ^ 3", "using xy \\<open>x < \\<xi>\\<close>"], ["proof (prove)\nusing this:\n  \\<xi> - 1 \\<le> ln \\<xi> * 2 * \\<xi>\n  2 \\<le> x\n  x \\<le> y\n  y \\<le> real n\n  x < \\<xi>\n\ngoal (1 subgoal):\n 1. 1 / (\\<xi> * (\\<xi> - 1)\\<^sup>2) \\<le> ln \\<xi> * 2 / (\\<xi> - 1) ^ 3", "by (simp add: divide_simps power_eq_if)"], ["proof (state)\nthis:\n  1 / (\\<xi> * (\\<xi> - 1)\\<^sup>2) \\<le> ln \\<xi> * 2 / (\\<xi> - 1) ^ 3\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "thus ?thesis"], ["proof (prove)\nusing this:\n  1 / (\\<xi> * (\\<xi> - 1)\\<^sup>2) \\<le> ln \\<xi> * 2 / (\\<xi> - 1) ^ 3\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "using xy \\<open>x < \\<xi>\\<close> \\<open>\\<xi> < y\\<close>"], ["proof (prove)\nusing this:\n  1 / (\\<xi> * (\\<xi> - 1)\\<^sup>2) \\<le> ln \\<xi> * 2 / (\\<xi> - 1) ^ 3\n  2 \\<le> x\n  x \\<le> y\n  y \\<le> real n\n  x < \\<xi>\n  \\<xi> < y\n\ngoal (1 subgoal):\n 1. f' \\<xi> \\<le> 0", "by (subst f'_altdef) (auto simp: divide_simps)"], ["proof (state)\nthis:\n  f' \\<xi> \\<le> 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  f' \\<xi> \\<le> 0\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "then"], ["proof (chain)\npicking this:\n  f' \\<xi> \\<le> 0", "have \"(ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2) \\<le> 0\""], ["proof (prove)\nusing this:\n  f' \\<xi> \\<le> 0\n\ngoal (1 subgoal):\n 1. ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 \\<le> 0", "using \\<open>x \\<le> y\\<close>"], ["proof (prove)\nusing this:\n  f' \\<xi> \\<le> 0\n  x \\<le> y\n\ngoal (1 subgoal):\n 1. ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 \\<le> 0", "by (simp add: mult_le_0_iff \\<xi>)"], ["proof (state)\nthis:\n  ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 \\<le> 0\n\ngoal (2 subgoals):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n 2. x \\<noteq> y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "then"], ["proof (chain)\npicking this:\n  ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 \\<le> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  ln y / (y - 1)\\<^sup>2 - ln x / (x - 1)\\<^sup>2 \\<le> 0\n\ngoal (1 subgoal):\n 1. ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2\n\ngoal (1 subgoal):\n 1. x = y \\<Longrightarrow>\n    ln y / (y - 1)\\<^sup>2 \\<le> ln x / (x - 1)\\<^sup>2", "qed simp_all"], ["proof (state)\nthis:\n  \\<lbrakk>2 \\<le> ?x; ?x \\<le> ?y; ?y \\<le> real n\\<rbrakk>\n  \\<Longrightarrow> ln ?y / (?y - 1)\\<^sup>2 \\<le> ln ?x / (?x - 1)\\<^sup>2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n    \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n          2 * ln 2", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n    \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n          2 * ln 2", "using sum_integral_ubound_decreasing'\n                [OF \\<open>3 \\<le> n\\<close>, of \"\\<lambda>z. ln(z-1) - ln z - ln z / (z - 1)\" \"\\<lambda>z. ln z / (z-1)\\<^sup>2\"]\n                1 2 \\<open>3 \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<And>x.\n              x \\<in> {real 3 - 1..real n} \\<Longrightarrow>\n              ((\\<lambda>z.\n                   ln (z - 1) - ln z - ln z / (z - 1)) has_real_derivative\n               ln x / (x - 1)\\<^sup>2)\n               (at x);\n   \\<And>x y.\n      \\<lbrakk>real 3 - 1 \\<le> x; x \\<le> y; y \\<le> real n\\<rbrakk>\n      \\<Longrightarrow> ln y / (y - 1)\\<^sup>2\n                        \\<le> ln x / (x - 1)\\<^sup>2\\<rbrakk>\n  \\<Longrightarrow> (\\<Sum>k = 3..n. ln (real k) / (real k - 1)\\<^sup>2)\n                    \\<le> ln (real n - 1) - ln (real n) -\n                          ln (real n) / (real n - 1) -\n                          (ln (real 3 - 1 - 1) - ln (real 3 - 1) -\n                           ln (real 3 - 1) / (real 3 - 1 - 1))\n  ?x \\<in> {2..real n} \\<Longrightarrow>\n  ((\\<lambda>z. ln (z - 1) - ln z - ln z / (z - 1)) has_real_derivative\n   ln ?x / (?x - 1)\\<^sup>2)\n   (at ?x)\n  \\<lbrakk>2 \\<le> ?x; ?x \\<le> ?y; ?y \\<le> real n\\<rbrakk>\n  \\<Longrightarrow> ln ?y / (?y - 1)\\<^sup>2 \\<le> ln ?x / (?x - 1)\\<^sup>2\n  3 \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n    \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n          2 * ln 2", "by (auto simp: in_Reals_norm of_nat_diff)"], ["proof (state)\nthis:\n  (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n  \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n        2 * ln 2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n  \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n        2 * ln 2\n\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2)\n  \\<le> ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) +\n        2 * ln 2\n\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "have \"\\<dots> \\<le> 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n    \\<le> 2", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n    \\<le> 2", "have \"ln (real n - 1) - ln n \\<le> 0\"  \"0 \\<le> ln n / (real n - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) \\<le> 0 &&&\n    0 \\<le> ln (real n) / (real n - 1)", "using \\<open>3 \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  3 \\<le> n\n\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) \\<le> 0 &&&\n    0 \\<le> ln (real n) / (real n - 1)", "by auto"], ["proof (state)\nthis:\n  ln (real n - 1) - ln (real n) \\<le> 0\n  0 \\<le> ln (real n) / (real n - 1)\n\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n    \\<le> 2", "then"], ["proof (chain)\npicking this:\n  ln (real n - 1) - ln (real n) \\<le> 0\n  0 \\<le> ln (real n) / (real n - 1)", "have \"ln (real n - 1) - ln n - ln n / (real n - 1) \\<le> 0\""], ["proof (prove)\nusing this:\n  ln (real n - 1) - ln (real n) \\<le> 0\n  0 \\<le> ln (real n) / (real n - 1)\n\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) \\<le> 0", "by linarith"], ["proof (state)\nthis:\n  ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) \\<le> 0\n\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n    \\<le> 2", "with ln_2_less_1"], ["proof (chain)\npicking this:\n  ln 2 < 1\n  ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) \\<le> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  ln 2 < 1\n  ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) \\<le> 0\n\ngoal (1 subgoal):\n 1. ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n    \\<le> 2", "by linarith"], ["proof (state)\nthis:\n  ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n  \\<le> 2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n  \\<le> 2\n\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "also"], ["proof (state)\nthis:\n  ln (real n - 1) - ln (real n) - ln (real n) / (real n - 1) + 2 * ln 2\n  \\<le> 2\n\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "have \"\\<dots> \\<le> 3 - ln 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 \\<le> 3 - ln 2", "using ln_2_less_1"], ["proof (prove)\nusing this:\n  ln 2 < 1\n\ngoal (1 subgoal):\n 1. 2 \\<le> 3 - ln 2", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  2 \\<le> 3 - ln 2\n\ngoal (1 subgoal):\n 1. 3 \\<le> n \\<Longrightarrow>\n    (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2) \\<le> 3 - ln 2", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2) \\<le> 3 - ln 2\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "using True"], ["proof (prove)\nusing this:\n  (\\<Sum>i = 3..n. ln (real i) / (real (i - Suc 0))\\<^sup>2) \\<le> 3 - ln 2\n  3 \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3", "by (simp add: algebra_simps sum.atLeast_Suc_atMost [of 2 n])"], ["proof (state)\nthis:\n  (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i = 2..n. ln (real i) / real ((i - 1)\\<^sup>2)) \\<le> 3\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "finally"], ["proof (chain)\npicking this:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> 3", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 1..n. mangoldt i / real i) -\n    (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n    \\<le> 3", "."], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> 3\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "ultimately"], ["proof (chain)\npicking this:\n  0 \\<le> (\\<Sum>i = 1..n. mangoldt i / real i) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> 3", "show ?thesis"], ["proof (prove)\nusing this:\n  0 \\<le> (\\<Sum>i = 1..n. mangoldt i / real i) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\n  (\\<Sum>i = 1..n. mangoldt i / real i) -\n  (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}. ln (real x) / real x)\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n             ln (real x) / real x)\\<bar>\n    \\<le> 3", "by linarith"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           ln (real x) / real x)\\<bar>\n  \\<le> 3\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>x\\<in>{p. prime p \\<and> p \\<in> {1..n}}.\n           ln (real x) / real x)\\<bar>\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. n \\<noteq> 0 \\<Longrightarrow>\n    \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "finally"], ["proof (chain)\npicking this:\n  \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n        (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n  \\<le> 3", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n        (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n          (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n    \\<le> 3", "."], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>i\\<in>I. mangoldt i / real i) -\n        (\\<Sum>p | prime p \\<and> p \\<in> I. ln (real p) / real p)\\<bar>\n  \\<le> 3\n\ngoal:\nNo subgoals!", "qed"], ["", "proposition Mertens:\n  assumes \"n \\<noteq> 0\"\n  shows \"\\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln p / of_nat p) - ln n\\<bar> \\<le> 7\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "have \"\\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - (\\<Sum>p | prime p \\<and> p \\<in> {1..n}. ln (real p) / real p)\\<bar>\n             \\<le> 7 - 4\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n             ln (real p) / real p)\\<bar>\n    \\<le> 7 - 4", "using Mertens_mangoldt_versus_ln [of \"{1..n}\" n]"], ["proof (prove)\nusing this:\n  {1..n} \\<subseteq> {1..n} \\<Longrightarrow>\n  \\<bar>(\\<Sum>i = 1..n. mangoldt i / real i) -\n        (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n           ln (real p) / real p)\\<bar>\n  \\<le> 3\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n             ln (real p) / real p)\\<bar>\n    \\<le> 7 - 4", "by simp_all"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n           ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "also"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<in> {1..n}.\n           ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "have \"{p. prime p \\<and> p \\<in> {1..n}} = {p. prime p \\<and> p \\<le> n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {p. prime p \\<and> p \\<in> {1..n}} = {p. prime p \\<and> p \\<le> n}", "using atLeastAtMost_iff prime_ge_1_nat"], ["proof (prove)\nusing this:\n  (?i \\<in> {?l..?u}) = (?l \\<le> ?i \\<and> ?i \\<le> ?u)\n  prime ?p \\<Longrightarrow> 1 \\<le> ?p\n\ngoal (1 subgoal):\n 1. {p. prime p \\<and> p \\<in> {1..n}} = {p. prime p \\<and> p \\<le> n}", "by blast"], ["proof (state)\nthis:\n  {p. prime p \\<and> p \\<in> {1..n}} = {p. prime p \\<and> p \\<le> n}\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "finally"], ["proof (chain)\npicking this:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4", "have \"\\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - (\\<Sum>p\\<in>\\<dots>. ln (real p) / real p)\\<bar> \\<le> 7 - 4\""], ["proof (prove)\nusing this:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n          (\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p)\\<bar>\n    \\<le> 7 - 4", "."], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "moreover"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "from assms"], ["proof (chain)\npicking this:\n  n \\<noteq> 0", "have \"\\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln n\\<bar> \\<le> 4\""], ["proof (prove)\nusing this:\n  n \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "by (rule Mertens_lemma)"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "ultimately"], ["proof (chain)\npicking this:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) -\n        (\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p)\\<bar>\n  \\<le> 7 - 4\n  \\<bar>(\\<Sum>d = 1..n. mangoldt d / real d) - ln (real n)\\<bar> \\<le> 4\n\ngoal (1 subgoal):\n 1. \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n          ln (real n)\\<bar>\n    \\<le> 7", "by linarith"], ["proof (state)\nthis:\n  \\<bar>(\\<Sum>p | prime p \\<and> p \\<le> n. ln (real p) / real p) -\n        ln (real n)\\<bar>\n  \\<le> 7\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}