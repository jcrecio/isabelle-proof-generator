{"file_name": "/home/qj213/afp-2021-10-22/thys/KD_Tree/Range_Search.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/KD_Tree", "problem_names": ["lemma cbox_point_def:\n  fixes p\\<^sub>0 :: \"('k::finite) point\"\n  shows \"cbox p\\<^sub>0 p\\<^sub>1 = { p. \\<forall>k. p\\<^sub>0$k \\<le> p$k \\<and> p$k \\<le> p\\<^sub>1$k }\"", "lemma l_empty:\n  assumes \"invar (Node k v l r)\" \"v < p\\<^sub>0$k\"\n  shows \"set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}\"", "lemma r_empty:\n  assumes \"invar (Node k v l r)\" \"p\\<^sub>1$k < v\"\n  shows \"set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}\"", "theorem search_cbox:\n  assumes \"invar kdt\"\n  shows \"search p\\<^sub>0 p\\<^sub>1 kdt = set_kdt kdt \\<inter> cbox p\\<^sub>0 p\\<^sub>1\""], "translations": [["", "lemma cbox_point_def:\n  fixes p\\<^sub>0 :: \"('k::finite) point\"\n  shows \"cbox p\\<^sub>0 p\\<^sub>1 = { p. \\<forall>k. p\\<^sub>0$k \\<le> p$k \\<and> p$k \\<le> p\\<^sub>1$k }\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "have \"cbox p\\<^sub>0 p\\<^sub>1 = { p. \\<forall>k. p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and> p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1 }\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n           p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1}", "unfolding cbox_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. {x. \\<forall>i\\<in>Basis.\n           p\\<^sub>0 \\<bullet> i \\<le> x \\<bullet> i \\<and>\n           x \\<bullet> i \\<le> p\\<^sub>1 \\<bullet> i} =\n    {p. \\<forall>k.\n           p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n           p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1}", "using axis_inverse"], ["proof (prove)\nusing this:\n  ?v \\<in> Basis \\<Longrightarrow> \\<exists>i. ?v = axis i 1\n\ngoal (1 subgoal):\n 1. {x. \\<forall>i\\<in>Basis.\n           p\\<^sub>0 \\<bullet> i \\<le> x \\<bullet> i \\<and>\n           x \\<bullet> i \\<le> p\\<^sub>1 \\<bullet> i} =\n    {p. \\<forall>k.\n           p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n           p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1}", "by auto"], ["proof (state)\nthis:\n  cbox p\\<^sub>0 p\\<^sub>1 =\n  {p. \\<forall>k.\n         p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n         p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1}\n\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "also"], ["proof (state)\nthis:\n  cbox p\\<^sub>0 p\\<^sub>1 =\n  {p. \\<forall>k.\n         p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n         p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1}\n\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "have \"... = { p. \\<forall>k. p\\<^sub>0$k \\<bullet> 1 \\<le> p$k \\<bullet> 1 \\<and> p$k \\<bullet> 1 \\<le> p\\<^sub>1$k \\<bullet> 1 }\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {p. \\<forall>k.\n           p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n           p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1} =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<bullet> 1 \\<le> p $ k \\<bullet> 1 \\<and>\n           p $ k \\<bullet> 1 \\<le> p\\<^sub>1 $ k \\<bullet> 1}", "using inner_axis[of _ _ 1]"], ["proof (prove)\nusing this:\n  ?x \\<bullet> axis ?i (1::?'a1) = ?x $ ?i \\<bullet> (1::?'a1)\n\ngoal (1 subgoal):\n 1. {p. \\<forall>k.\n           p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n           p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1} =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<bullet> 1 \\<le> p $ k \\<bullet> 1 \\<and>\n           p $ k \\<bullet> 1 \\<le> p\\<^sub>1 $ k \\<bullet> 1}", "by (smt Collect_cong)"], ["proof (state)\nthis:\n  {p. \\<forall>k.\n         p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n         p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1} =\n  {p. \\<forall>k.\n         p\\<^sub>0 $ k \\<bullet> 1 \\<le> p $ k \\<bullet> 1 \\<and>\n         p $ k \\<bullet> 1 \\<le> p\\<^sub>1 $ k \\<bullet> 1}\n\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "also"], ["proof (state)\nthis:\n  {p. \\<forall>k.\n         p\\<^sub>0 \\<bullet> axis k 1 \\<le> p \\<bullet> axis k 1 \\<and>\n         p \\<bullet> axis k 1 \\<le> p\\<^sub>1 \\<bullet> axis k 1} =\n  {p. \\<forall>k.\n         p\\<^sub>0 $ k \\<bullet> 1 \\<le> p $ k \\<bullet> 1 \\<and>\n         p $ k \\<bullet> 1 \\<le> p\\<^sub>1 $ k \\<bullet> 1}\n\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "have \"... = { p. \\<forall>k. p\\<^sub>0$k \\<le> p$k \\<and> p$k \\<le> p\\<^sub>1$k }\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<bullet> 1 \\<le> p $ k \\<bullet> 1 \\<and>\n           p $ k \\<bullet> 1 \\<le> p\\<^sub>1 $ k \\<bullet> 1} =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "by simp"], ["proof (state)\nthis:\n  {p. \\<forall>k.\n         p\\<^sub>0 $ k \\<bullet> 1 \\<le> p $ k \\<bullet> 1 \\<and>\n         p $ k \\<bullet> 1 \\<le> p\\<^sub>1 $ k \\<bullet> 1} =\n  {p. \\<forall>k.\n         p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}\n\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "finally"], ["proof (chain)\npicking this:\n  cbox p\\<^sub>0 p\\<^sub>1 =\n  {p. \\<forall>k.\n         p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "show ?thesis"], ["proof (prove)\nusing this:\n  cbox p\\<^sub>0 p\\<^sub>1 =\n  {p. \\<forall>k.\n         p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}\n\ngoal (1 subgoal):\n 1. cbox p\\<^sub>0 p\\<^sub>1 =\n    {p. \\<forall>k.\n           p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}", "."], ["proof (state)\nthis:\n  cbox p\\<^sub>0 p\\<^sub>1 =\n  {p. \\<forall>k.\n         p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> p\\<^sub>1 $ k}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Search Function\\<close>"], ["", "fun search :: \"('k::finite) point \\<Rightarrow> 'k point \\<Rightarrow> 'k kdt \\<Rightarrow> 'k point set\" where\n  \"search p\\<^sub>0 p\\<^sub>1 (Leaf p) = (if p \\<in> cbox p\\<^sub>0 p\\<^sub>1 then { p } else {})\"\n| \"search p\\<^sub>0 p\\<^sub>1 (Node k v l r) = (\n    if v < p\\<^sub>0$k then\n      search p\\<^sub>0 p\\<^sub>1 r\n    else if p\\<^sub>1$k < v then\n      search p\\<^sub>0 p\\<^sub>1 l\n    else\n      search p\\<^sub>0 p\\<^sub>1 l \\<union> search p\\<^sub>0 p\\<^sub>1 r\n  )\""], ["", "subsection \\<open>Auxiliary Lemmas\\<close>"], ["", "lemma l_empty:\n  assumes \"invar (Node k v l r)\" \"v < p\\<^sub>0$k\"\n  shows \"set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "have \"\\<forall>p \\<in> set_kdt l. p$k < p\\<^sub>0$k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt l. p $ k < p\\<^sub>0 $ k", "using assms"], ["proof (prove)\nusing this:\n  invar (Node k v l r)\n  v < p\\<^sub>0 $ k\n\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt l. p $ k < p\\<^sub>0 $ k", "by auto"], ["proof (state)\nthis:\n  \\<forall>p\\<in>set_kdt l. p $ k < p\\<^sub>0 $ k\n\ngoal (1 subgoal):\n 1. set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "hence \"\\<forall>p \\<in> set_kdt l. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1\""], ["proof (prove)\nusing this:\n  \\<forall>p\\<in>set_kdt l. p $ k < p\\<^sub>0 $ k\n\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt l. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1", "using cbox_point_def leD"], ["proof (prove)\nusing this:\n  \\<forall>p\\<in>set_kdt l. p $ k < p\\<^sub>0 $ k\n  cbox ?p\\<^sub>0 ?p\\<^sub>1 =\n  {p. \\<forall>k.\n         ?p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> ?p\\<^sub>1 $ k}\n  ?y \\<le> ?x \\<Longrightarrow> \\<not> ?x < ?y\n\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt l. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1", "by blast"], ["proof (state)\nthis:\n  \\<forall>p\\<in>set_kdt l. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1\n\ngoal (1 subgoal):\n 1. set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>p\\<in>set_kdt l. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1\n\ngoal (1 subgoal):\n 1. set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "by blast"], ["proof (state)\nthis:\n  set_kdt l \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma r_empty:\n  assumes \"invar (Node k v l r)\" \"p\\<^sub>1$k < v\"\n  shows \"set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "have \"\\<forall>p \\<in> set_kdt r. p\\<^sub>1$k < p$k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt r. p\\<^sub>1 $ k < p $ k", "using assms"], ["proof (prove)\nusing this:\n  invar (Node k v l r)\n  p\\<^sub>1 $ k < v\n\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt r. p\\<^sub>1 $ k < p $ k", "by auto"], ["proof (state)\nthis:\n  \\<forall>p\\<in>set_kdt r. p\\<^sub>1 $ k < p $ k\n\ngoal (1 subgoal):\n 1. set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "hence \"\\<forall>p \\<in> set_kdt r. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1\""], ["proof (prove)\nusing this:\n  \\<forall>p\\<in>set_kdt r. p\\<^sub>1 $ k < p $ k\n\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt r. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1", "using cbox_point_def leD"], ["proof (prove)\nusing this:\n  \\<forall>p\\<in>set_kdt r. p\\<^sub>1 $ k < p $ k\n  cbox ?p\\<^sub>0 ?p\\<^sub>1 =\n  {p. \\<forall>k.\n         ?p\\<^sub>0 $ k \\<le> p $ k \\<and> p $ k \\<le> ?p\\<^sub>1 $ k}\n  ?y \\<le> ?x \\<Longrightarrow> \\<not> ?x < ?y\n\ngoal (1 subgoal):\n 1. \\<forall>p\\<in>set_kdt r. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1", "by blast"], ["proof (state)\nthis:\n  \\<forall>p\\<in>set_kdt r. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1\n\ngoal (1 subgoal):\n 1. set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "thus ?thesis"], ["proof (prove)\nusing this:\n  \\<forall>p\\<in>set_kdt r. p \\<notin> cbox p\\<^sub>0 p\\<^sub>1\n\ngoal (1 subgoal):\n 1. set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}", "by blast"], ["proof (state)\nthis:\n  set_kdt r \\<inter> cbox p\\<^sub>0 p\\<^sub>1 = {}\n\ngoal:\nNo subgoals!", "qed"], ["", "subsection \\<open>Main Theorem\\<close>"], ["", "theorem search_cbox:\n  assumes \"invar kdt\"\n  shows \"search p\\<^sub>0 p\\<^sub>1 kdt = set_kdt kdt \\<inter> cbox p\\<^sub>0 p\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. search p\\<^sub>0 p\\<^sub>1 kdt =\n    set_kdt kdt \\<inter> cbox p\\<^sub>0 p\\<^sub>1", "using assms l_empty r_empty"], ["proof (prove)\nusing this:\n  invar kdt\n  \\<lbrakk>invar (Node ?k ?v ?l ?r); ?v < ?p\\<^sub>0 $ ?k\\<rbrakk>\n  \\<Longrightarrow> set_kdt ?l \\<inter> cbox ?p\\<^sub>0 ?p\\<^sub>1 = {}\n  \\<lbrakk>invar (Node ?k ?v ?l ?r); ?p\\<^sub>1 $ ?k < ?v\\<rbrakk>\n  \\<Longrightarrow> set_kdt ?r \\<inter> cbox ?p\\<^sub>0 ?p\\<^sub>1 = {}\n\ngoal (1 subgoal):\n 1. search p\\<^sub>0 p\\<^sub>1 kdt =\n    set_kdt kdt \\<inter> cbox p\\<^sub>0 p\\<^sub>1", "by (induction kdt) (auto, blast+)"], ["", "end"]]}