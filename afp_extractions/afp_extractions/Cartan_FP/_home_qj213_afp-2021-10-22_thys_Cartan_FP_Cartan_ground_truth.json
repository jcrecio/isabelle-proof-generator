{"file_name": "/home/qj213/afp-2021-10-22/thys/Cartan_FP/Cartan.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Cartan_FP", "problem_names": ["lemma deriv_left_inverse:\n  assumes \"f holomorphic_on S\" and \"g holomorphic_on T\"\n      and \"open S\" and \"open T\"\n      and \"f ` S \\<subseteq> T\"\n      and [simp]: \"\\<And>z. z \\<in> S \\<Longrightarrow> g (f z) = z\"\n      and \"w \\<in> S\"\n    shows \"deriv f w * deriv g (f w) = 1\"", "lemma Cauchy_higher_deriv_bound:\n    assumes holf: \"f holomorphic_on (ball z r)\"\n        and contf: \"continuous_on (cball z r) f\"\n        and \"0 < r\" and \"0 < n\"\n        and fin : \"\\<And>w. w \\<in> ball z r \\<Longrightarrow> f w \\<in> ball y B0\"\n      shows \"norm ((deriv ^^ n) f z) \\<le> (fact n) * B0 / r^n\"", "lemma higher_deriv_comp_lemma:\n    assumes s: \"open s\" and holf: \"f holomorphic_on s\"\n        and \"z \\<in> s\"\n        and t: \"open t\" and holg: \"g holomorphic_on t\"\n        and fst: \"f ` s \\<subseteq> t\"\n        and n: \"i \\<le> n\"\n        and dfz: \"deriv f z = 1\" and zero: \"\\<And>i. \\<lbrakk>1 < i; i \\<le> n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\"\n      shows \"(deriv ^^ i) (g o f) z = (deriv ^^ i) g (f z)\"", "lemma higher_deriv_comp_iter_lemma:\n    assumes s: \"open s\" and holf: \"f holomorphic_on s\"\n        and fss: \"f ` s \\<subseteq> s\"\n        and \"z \\<in> s\" and [simp]: \"f z = z\"\n        and n: \"i \\<le> n\"\n        and dfz: \"deriv f z = 1\" and zero: \"\\<And>i. \\<lbrakk>1 < i; i \\<le> n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\"\n      shows \"(deriv ^^ i) (f^^m) z = (deriv ^^ i) f z\"", "lemma higher_deriv_iter_top_lemma:\n    assumes s: \"open s\" and holf: \"f holomorphic_on s\"\n        and fss: \"f ` s \\<subseteq> s\"\n        and \"z \\<in> s\" and [simp]: \"f z = z\"\n        and dfz [simp]: \"deriv f z = 1\"\n        and n: \"1 < n\" \"\\<And>i. \\<lbrakk>1 < i; i < n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\"\n      shows \"(deriv ^^ n) (f ^^ m) z = m * (deriv ^^ n) f z\"", "theorem first_Cartan_dim_1:\n    assumes holf: \"f holomorphic_on s\"\n        and \"open s\" \"connected s\" \"bounded s\"\n        and fss: \"f ` s \\<subseteq> s\"\n        and \"z \\<in> s\" and [simp]: \"f z = z\"\n        and dfz [simp]: \"deriv f z = 1\"\n        and \"w \\<in> s\"\n      shows \"f w = w\"", "lemma Cartan_is_linear:\n  assumes holf: \"f holomorphic_on s\"\n      and \"open s\" and \"connected s\"\n      and \"0 \\<in> s\"\n      and ins: \"\\<And>u z. \\<lbrakk>norm u = 1; z \\<in> s\\<rbrakk> \\<Longrightarrow> u * z \\<in> s\"\n      and feq: \"\\<And>u z. \\<lbrakk>norm u = 1; z \\<in> s\\<rbrakk> \\<Longrightarrow> f (u * z) = u * f z\"\n    shows \"\\<exists>c. \\<forall>z \\<in> s. f z = c * z\"", "theorem second_Cartan_dim_1:\n  assumes holf: \"f holomorphic_on ball 0 r\"\n      and holg: \"g holomorphic_on ball 0 r\"\n      and [simp]: \"f 0 = 0\" and [simp]: \"g 0 = 0\"\n      and ballf: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> f z \\<in> ball 0 r\"\n      and ballg: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> g z \\<in> ball 0 r\"\n      and fg: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> f (g z) = z\"\n      and gf: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> g (f z) = z\"\n      and \"0 < r\"\n    shows \"\\<exists>t. \\<forall>z \\<in> ball 0 r. g z = exp(\\<i> * of_real t) * z\""], "translations": [["", "lemma deriv_left_inverse:\n  assumes \"f holomorphic_on S\" and \"g holomorphic_on T\"\n      and \"open S\" and \"open T\"\n      and \"f ` S \\<subseteq> T\"\n      and [simp]: \"\\<And>z. z \\<in> S \\<Longrightarrow> g (f z) = z\"\n      and \"w \\<in> S\"\n    shows \"deriv f w * deriv g (f w) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "have \"deriv f w * deriv g (f w) = deriv g (f w) * deriv f w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = deriv g (f w) * deriv f w", "by (simp add: algebra_simps)"], ["proof (state)\nthis:\n  deriv f w * deriv g (f w) = deriv g (f w) * deriv f w\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "also"], ["proof (state)\nthis:\n  deriv f w * deriv g (f w) = deriv g (f w) * deriv f w\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "have \"... = deriv (g o f) w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv g (f w) * deriv f w = deriv (g \\<circ> f) w", "using assms"], ["proof (prove)\nusing this:\n  f holomorphic_on S\n  g holomorphic_on T\n  open S\n  open T\n  f ` S \\<subseteq> T\n  ?z \\<in> S \\<Longrightarrow> g (f ?z) = ?z\n  w \\<in> S\n\ngoal (1 subgoal):\n 1. deriv g (f w) * deriv f w = deriv (g \\<circ> f) w", "by (metis analytic_on_imp_differentiable_at analytic_on_open deriv_chain image_subset_iff)"], ["proof (state)\nthis:\n  deriv g (f w) * deriv f w = deriv (g \\<circ> f) w\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "also"], ["proof (state)\nthis:\n  deriv g (f w) * deriv f w = deriv (g \\<circ> f) w\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "have \"... = deriv id w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv (g \\<circ> f) w = deriv id w", "apply (rule complex_derivative_transform_within_open [where s=S])"], ["proof (prove)\ngoal (5 subgoals):\n 1. g \\<circ> f holomorphic_on S\n 2. id holomorphic_on S\n 3. open S\n 4. w \\<in> S\n 5. \\<And>w. w \\<in> S \\<Longrightarrow> (g \\<circ> f) w = id w", "apply (rule assms holomorphic_on_compose_gen holomorphic_intros)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w. w \\<in> S \\<Longrightarrow> (g \\<circ> f) w = id w", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  deriv (g \\<circ> f) w = deriv id w\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "also"], ["proof (state)\nthis:\n  deriv (g \\<circ> f) w = deriv id w\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "have \"... = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv id w = 1", "using higher_deriv_id [of 1]"], ["proof (prove)\nusing this:\n  (deriv ^^ 1) id ?z =\n  (if 1 = 0 then ?z else if 1 = 1 then 1::?'a else (0::?'a))\n\ngoal (1 subgoal):\n 1. deriv id w = 1", "by simp"], ["proof (state)\nthis:\n  deriv id w = 1\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "finally"], ["proof (chain)\npicking this:\n  deriv f w * deriv g (f w) = 1", "show ?thesis"], ["proof (prove)\nusing this:\n  deriv f w * deriv g (f w) = 1\n\ngoal (1 subgoal):\n 1. deriv f w * deriv g (f w) = 1", "."], ["proof (state)\nthis:\n  deriv f w * deriv g (f w) = 1\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma Cauchy_higher_deriv_bound:\n    assumes holf: \"f holomorphic_on (ball z r)\"\n        and contf: \"continuous_on (cball z r) f\"\n        and \"0 < r\" and \"0 < n\"\n        and fin : \"\\<And>w. w \\<in> ball z r \\<Longrightarrow> f w \\<in> ball y B0\"\n      shows \"norm ((deriv ^^ n) f z) \\<le> (fact n) * B0 / r^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have \"0 < B0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < B0", "using \\<open>0 < r\\<close> fin [of z]"], ["proof (prove)\nusing this:\n  0 < r\n  z \\<in> ball z r \\<Longrightarrow> f z \\<in> ball y B0\n\ngoal (1 subgoal):\n 1. 0 < B0", "by (metis ball_eq_empty ex_in_conv fin not_less)"], ["proof (state)\nthis:\n  0 < B0\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have le_B0: \"\\<And>w. cmod (w - z) \\<le> r \\<Longrightarrow> cmod (f w - y) \\<le> B0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w. cmod (w - z) \\<le> r \\<Longrightarrow> cmod (f w - y) \\<le> B0", "apply (rule continuous_on_closure_norm_le [of \"ball z r\" \"\\<lambda>w. f w - y\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>w.\n       cmod (w - z) \\<le> r \\<Longrightarrow>\n       continuous_on (closure (ball z r)) (\\<lambda>w. f w - y)\n 2. \\<And>w.\n       cmod (w - z) \\<le> r \\<Longrightarrow>\n       \\<forall>ya\\<in>ball z r. cmod (f ya - y) \\<le> B0\n 3. \\<And>w.\n       cmod (w - z) \\<le> r \\<Longrightarrow> w \\<in> closure (ball z r)", "apply (auto simp: \\<open>0 < r\\<close>  dist_norm norm_minus_commute)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>w.\n       cmod (w - z) \\<le> r \\<Longrightarrow>\n       continuous_on (cball z r) (\\<lambda>x. f x - y)\n 2. \\<And>w ya.\n       \\<lbrakk>cmod (w - z) \\<le> r; cmod (ya - z) < r\\<rbrakk>\n       \\<Longrightarrow> cmod (y - f ya) \\<le> B0", "apply (rule continuous_intros contf)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w ya.\n       \\<lbrakk>cmod (w - z) \\<le> r; cmod (ya - z) < r\\<rbrakk>\n       \\<Longrightarrow> cmod (y - f ya) \\<le> B0", "using fin"], ["proof (prove)\nusing this:\n  ?w \\<in> ball z r \\<Longrightarrow> f ?w \\<in> ball y B0\n\ngoal (1 subgoal):\n 1. \\<And>w ya.\n       \\<lbrakk>cmod (w - z) \\<le> r; cmod (ya - z) < r\\<rbrakk>\n       \\<Longrightarrow> cmod (y - f ya) \\<le> B0", "apply (simp add: dist_commute dist_norm less_eq_real_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  cmod (?w - z) \\<le> r \\<Longrightarrow> cmod (f ?w - y) \\<le> B0\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have \"(deriv ^^ n) f z = (deriv ^^ n) (\\<lambda>w. f w) z - (deriv ^^ n) (\\<lambda>w. y) z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) f z - (deriv ^^ n) (\\<lambda>w. y) z", "using \\<open>0 < n\\<close>"], ["proof (prove)\nusing this:\n  0 < n\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) f z - (deriv ^^ n) (\\<lambda>w. y) z", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = (deriv ^^ n) f z - (deriv ^^ n) (\\<lambda>w. y) z\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "also"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = (deriv ^^ n) f z - (deriv ^^ n) (\\<lambda>w. y) z\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have \"... = (deriv ^^ n) (\\<lambda>w. f w - y) z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z - (deriv ^^ n) (\\<lambda>w. y) z =\n    (deriv ^^ n) (\\<lambda>w. f w - y) z", "by (rule higher_deriv_diff [OF holf, symmetric]) (auto simp: \\<open>0 < r\\<close> holomorphic_on_const)"], ["proof (state)\nthis:\n  (deriv ^^ n) f z - (deriv ^^ n) (\\<lambda>w. y) z =\n  (deriv ^^ n) (\\<lambda>w. f w - y) z\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "finally"], ["proof (chain)\npicking this:\n  (deriv ^^ n) f z = (deriv ^^ n) (\\<lambda>w. f w - y) z", "have \"(deriv ^^ n) f z = (deriv ^^ n) (\\<lambda>w. f w - y) z\""], ["proof (prove)\nusing this:\n  (deriv ^^ n) f z = (deriv ^^ n) (\\<lambda>w. f w - y) z\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) (\\<lambda>w. f w - y) z", "."], ["proof (state)\nthis:\n  (deriv ^^ n) f z = (deriv ^^ n) (\\<lambda>w. f w - y) z\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have contf': \"continuous_on (cball z r) (\\<lambda>u. f u - y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. continuous_on (cball z r) (\\<lambda>u. f u - y)", "by (rule contf continuous_intros)+"], ["proof (state)\nthis:\n  continuous_on (cball z r) (\\<lambda>u. f u - y)\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have holf': \"(\\<lambda>u. (f u - y)) holomorphic_on (ball z r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>u. f u - y) holomorphic_on ball z r", "by (simp add: holf holomorphic_on_diff holomorphic_on_const)"], ["proof (state)\nthis:\n  (\\<lambda>u. f u - y) holomorphic_on ball z r\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "define a where \"a = (2 * pi)/(fact n)\""], ["proof (state)\nthis:\n  a = 2 * pi / fact n\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have \"0 < a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < a", "by (simp add: a_def)"], ["proof (state)\nthis:\n  0 < a\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have \"B0/r^(Suc n)*2 * pi * r = a*((fact n)*B0/r^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. B0 / r ^ Suc n * 2 * pi * r = a * (fact n * B0 / r ^ n)", "using \\<open>0 < r\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n\ngoal (1 subgoal):\n 1. B0 / r ^ Suc n * 2 * pi * r = a * (fact n * B0 / r ^ n)", "by (simp add: a_def divide_simps)"], ["proof (state)\nthis:\n  B0 / r ^ Suc n * 2 * pi * r = a * (fact n * B0 / r ^ n)\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have der_dif: \"(deriv ^^ n) (\\<lambda>w. f w - y) z = (deriv ^^ n) f z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. f w - y) z = (deriv ^^ n) f z", "using \\<open>0 < r\\<close> \\<open>0 < n\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n  0 < n\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. f w - y) z = (deriv ^^ n) f z", "by (auto simp: higher_deriv_diff [OF holf holomorphic_on_const])"], ["proof (state)\nthis:\n  (deriv ^^ n) (\\<lambda>w. f w - y) z = (deriv ^^ n) f z\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "have \"norm ((2 * of_real pi * \\<i>)/(fact n) * (deriv ^^ n) (\\<lambda>w. f w - y) z)\n        \\<le> (B0/r^(Suc n)) * (2 * pi * r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod\n     (2 * complex_of_real pi * \\<i> / fact n *\n      (deriv ^^ n) (\\<lambda>w. f w - y) z)\n    \\<le> B0 / r ^ Suc n * (2 * pi * r)", "apply (rule has_contour_integral_bound_circlepath [of \"(\\<lambda>u. (f u - y)/(u - z)^(Suc n))\" _ z])"], ["proof (prove)\ngoal (4 subgoals):\n 1. ((\\<lambda>u. (f u - y) / (u - z) ^ Suc n) has_contour_integral\n     2 * complex_of_real pi * \\<i> / fact n *\n     (deriv ^^ n) (\\<lambda>w. f w - y) z)\n     (circlepath z r)\n 2. 0 \\<le> B0 / r ^ Suc n\n 3. 0 < r\n 4. \\<And>x.\n       cmod (x - z) = r \\<Longrightarrow>\n       cmod ((f x - y) / (x - z) ^ Suc n) \\<le> B0 / r ^ Suc n", "using Cauchy_has_contour_integral_higher_derivative_circlepath [OF contf' holf']"], ["proof (prove)\nusing this:\n  ?w \\<in> ball z r \\<Longrightarrow>\n  ((\\<lambda>u. (f u - y) / (u - ?w) ^ Suc ?k) has_contour_integral\n   complex_of_real (2 * pi) * \\<i> / fact ?k *\n   (deriv ^^ ?k) (\\<lambda>u. f u - y) ?w)\n   (circlepath z r)\n\ngoal (4 subgoals):\n 1. ((\\<lambda>u. (f u - y) / (u - z) ^ Suc n) has_contour_integral\n     2 * complex_of_real pi * \\<i> / fact n *\n     (deriv ^^ n) (\\<lambda>w. f w - y) z)\n     (circlepath z r)\n 2. 0 \\<le> B0 / r ^ Suc n\n 3. 0 < r\n 4. \\<And>x.\n       cmod (x - z) = r \\<Longrightarrow>\n       cmod ((f x - y) / (x - z) ^ Suc n) \\<le> B0 / r ^ Suc n", "using \\<open>0 < B0\\<close> \\<open>0 < r\\<close>"], ["proof (prove)\nusing this:\n  ?w \\<in> ball z r \\<Longrightarrow>\n  ((\\<lambda>u. (f u - y) / (u - ?w) ^ Suc ?k) has_contour_integral\n   complex_of_real (2 * pi) * \\<i> / fact ?k *\n   (deriv ^^ ?k) (\\<lambda>u. f u - y) ?w)\n   (circlepath z r)\n  0 < B0\n  0 < r\n\ngoal (4 subgoals):\n 1. ((\\<lambda>u. (f u - y) / (u - z) ^ Suc n) has_contour_integral\n     2 * complex_of_real pi * \\<i> / fact n *\n     (deriv ^^ n) (\\<lambda>w. f w - y) z)\n     (circlepath z r)\n 2. 0 \\<le> B0 / r ^ Suc n\n 3. 0 < r\n 4. \\<And>x.\n       cmod (x - z) = r \\<Longrightarrow>\n       cmod ((f x - y) / (x - z) ^ Suc n) \\<le> B0 / r ^ Suc n", "apply (auto simp: norm_divide norm_mult norm_power divide_simps le_B0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  cmod\n   (2 * complex_of_real pi * \\<i> / fact n *\n    (deriv ^^ n) (\\<lambda>w. f w - y) z)\n  \\<le> B0 / r ^ Suc n * (2 * pi * r)\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "then"], ["proof (chain)\npicking this:\n  cmod\n   (2 * complex_of_real pi * \\<i> / fact n *\n    (deriv ^^ n) (\\<lambda>w. f w - y) z)\n  \\<le> B0 / r ^ Suc n * (2 * pi * r)", "show ?thesis"], ["proof (prove)\nusing this:\n  cmod\n   (2 * complex_of_real pi * \\<i> / fact n *\n    (deriv ^^ n) (\\<lambda>w. f w - y) z)\n  \\<le> B0 / r ^ Suc n * (2 * pi * r)\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "using \\<open>0 < r\\<close>"], ["proof (prove)\nusing this:\n  cmod\n   (2 * complex_of_real pi * \\<i> / fact n *\n    (deriv ^^ n) (\\<lambda>w. f w - y) z)\n  \\<le> B0 / r ^ Suc n * (2 * pi * r)\n  0 < r\n\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n", "by (auto simp: norm_divide norm_mult norm_power field_simps der_dif le_B0)"], ["proof (state)\nthis:\n  cmod ((deriv ^^ n) f z) \\<le> fact n * B0 / r ^ n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_deriv_comp_lemma:\n    assumes s: \"open s\" and holf: \"f holomorphic_on s\"\n        and \"z \\<in> s\"\n        and t: \"open t\" and holg: \"g holomorphic_on t\"\n        and fst: \"f ` s \\<subseteq> t\"\n        and n: \"i \\<le> n\"\n        and dfz: \"deriv f z = 1\" and zero: \"\\<And>i. \\<lbrakk>1 < i; i \\<le> n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\"\n      shows \"(deriv ^^ i) (g o f) z = (deriv ^^ i) g (f z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (g \\<circ> f) z = (deriv ^^ i) g (f z)", "using n holg"], ["proof (prove)\nusing this:\n  i \\<le> n\n  g holomorphic_on t\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (g \\<circ> f) z = (deriv ^^ i) g (f z)", "proof (induction i arbitrary: g)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>0 \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ 0) (g \\<circ> f) z = (deriv ^^ 0) g (f z)\n 2. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "case 0"], ["proof (state)\nthis:\n  0 \\<le> n\n  g holomorphic_on t\n\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>0 \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ 0) (g \\<circ> f) z = (deriv ^^ 0) g (f z)\n 2. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "then"], ["proof (chain)\npicking this:\n  0 \\<le> n\n  g holomorphic_on t", "show ?case"], ["proof (prove)\nusing this:\n  0 \\<le> n\n  g holomorphic_on t\n\ngoal (1 subgoal):\n 1. (deriv ^^ 0) (g \\<circ> f) z = (deriv ^^ 0) g (f z)", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ 0) (g \\<circ> f) z = (deriv ^^ 0) g (f z)\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "case (Suc i)"], ["proof (state)\nthis:\n  \\<lbrakk>i \\<le> n; ?g holomorphic_on t\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ i) (?g \\<circ> f) z = (deriv ^^ i) ?g (f z)\n  Suc i \\<le> n\n  g holomorphic_on t\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "have \"g \\<circ> f holomorphic_on s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g \\<circ> f holomorphic_on s", "using \"Suc.prems\" holf"], ["proof (prove)\nusing this:\n  Suc i \\<le> n\n  g holomorphic_on t\n  f holomorphic_on s\n\ngoal (1 subgoal):\n 1. g \\<circ> f holomorphic_on s", "using fst"], ["proof (prove)\nusing this:\n  Suc i \\<le> n\n  g holomorphic_on t\n  f holomorphic_on s\n  f ` s \\<subseteq> t\n\ngoal (1 subgoal):\n 1. g \\<circ> f holomorphic_on s", "by (simp add: holomorphic_on_compose_gen image_subset_iff)"], ["proof (state)\nthis:\n  g \\<circ> f holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "then"], ["proof (chain)\npicking this:\n  g \\<circ> f holomorphic_on s", "have 1: \"deriv (g \\<circ> f) holomorphic_on s\""], ["proof (prove)\nusing this:\n  g \\<circ> f holomorphic_on s\n\ngoal (1 subgoal):\n 1. deriv (g \\<circ> f) holomorphic_on s", "by (simp add: holomorphic_deriv s)"], ["proof (state)\nthis:\n  deriv (g \\<circ> f) holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "have dg: \"deriv g holomorphic_on t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv g holomorphic_on t", "using Suc.prems"], ["proof (prove)\nusing this:\n  Suc i \\<le> n\n  g holomorphic_on t\n\ngoal (1 subgoal):\n 1. deriv g holomorphic_on t", "by (simp add: Suc.prems(2) holomorphic_deriv t)"], ["proof (state)\nthis:\n  deriv g holomorphic_on t\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "then"], ["proof (chain)\npicking this:\n  deriv g holomorphic_on t", "have \"deriv g holomorphic_on f ` s\""], ["proof (prove)\nusing this:\n  deriv g holomorphic_on t\n\ngoal (1 subgoal):\n 1. deriv g holomorphic_on f ` s", "using fst"], ["proof (prove)\nusing this:\n  deriv g holomorphic_on t\n  f ` s \\<subseteq> t\n\ngoal (1 subgoal):\n 1. deriv g holomorphic_on f ` s", "by (simp add: holomorphic_on_subset image_subset_iff)"], ["proof (state)\nthis:\n  deriv g holomorphic_on f ` s\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "then"], ["proof (chain)\npicking this:\n  deriv g holomorphic_on f ` s", "have dgf: \"(deriv g o f) holomorphic_on s\""], ["proof (prove)\nusing this:\n  deriv g holomorphic_on f ` s\n\ngoal (1 subgoal):\n 1. deriv g \\<circ> f holomorphic_on s", "by (simp add: holf holomorphic_on_compose)"], ["proof (state)\nthis:\n  deriv g \\<circ> f holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "then"], ["proof (chain)\npicking this:\n  deriv g \\<circ> f holomorphic_on s", "have 2: \"(\\<lambda>w. (deriv g o f) w * deriv f w) holomorphic_on s\""], ["proof (prove)\nusing this:\n  deriv g \\<circ> f holomorphic_on s\n\ngoal (1 subgoal):\n 1. (\\<lambda>w. (deriv g \\<circ> f) w * deriv f w) holomorphic_on s", "by (blast intro: holomorphic_intros holomorphic_on_compose holf s)"], ["proof (state)\nthis:\n  (\\<lambda>w. (deriv g \\<circ> f) w * deriv f w) holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "have \"(deriv ^^ i) (deriv (g o f)) z = (deriv ^^ i) (\\<lambda>w. deriv g (f w) * deriv f w) z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (deriv (g \\<circ> f)) z =\n    (deriv ^^ i) (\\<lambda>w. deriv g (f w) * deriv f w) z", "apply (rule higher_deriv_transform_within_open [OF 1 2 [unfolded o_def] s \\<open>z \\<in> s\\<close>])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w.\n       w \\<in> s \\<Longrightarrow>\n       deriv (g \\<circ> f) w = deriv g (f w) * deriv f w", "apply (rule deriv_chain)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>w. w \\<in> s \\<Longrightarrow> f field_differentiable at w\n 2. \\<And>w. w \\<in> s \\<Longrightarrow> g field_differentiable at (f w)", "using holf Suc.prems fst"], ["proof (prove)\nusing this:\n  f holomorphic_on s\n  Suc i \\<le> n\n  g holomorphic_on t\n  f ` s \\<subseteq> t\n\ngoal (2 subgoals):\n 1. \\<And>w. w \\<in> s \\<Longrightarrow> f field_differentiable at w\n 2. \\<And>w. w \\<in> s \\<Longrightarrow> g field_differentiable at (f w)", "apply (auto simp: holomorphic_on_imp_differentiable_at s t)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (deriv ^^ i) (deriv (g \\<circ> f)) z =\n  (deriv ^^ i) (\\<lambda>w. deriv g (f w) * deriv f w) z\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "also"], ["proof (state)\nthis:\n  (deriv ^^ i) (deriv (g \\<circ> f)) z =\n  (deriv ^^ i) (\\<lambda>w. deriv g (f w) * deriv f w) z\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "have \"... = (\\<Sum>j=0..i. of_nat(i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z * (deriv ^^ (i - j)) (deriv f) z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv g (f w) * deriv f w) z =\n    (\\<Sum>j = 0..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ (i - j)) (deriv f) z)", "apply (rule higher_deriv_mult [OF dgf [unfolded o_def] _ s \\<open>z \\<in> s\\<close>])"], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv f holomorphic_on s", "by (simp add: holf holomorphic_deriv s)"], ["proof (state)\nthis:\n  (deriv ^^ i) (\\<lambda>w. deriv g (f w) * deriv f w) z =\n  (\\<Sum>j = 0..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ (i - j)) (deriv f) z)\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "also"], ["proof (state)\nthis:\n  (deriv ^^ i) (\\<lambda>w. deriv g (f w) * deriv f w) z =\n  (\\<Sum>j = 0..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ (i - j)) (deriv f) z)\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "have \"... = (\\<Sum>j=i..i. of_nat(i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z * (deriv ^^ Suc (i - j)) f z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = 0..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ (i - j)) (deriv f) z) =\n    (\\<Sum>j = i..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ Suc (i - j)) f z)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>j = 0..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ (i - j)) (deriv f) z) =\n    (\\<Sum>j = i..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ Suc (i - j)) f z)", "have *: \"(deriv ^^ j) (\\<lambda>w. deriv g (f w)) z = 0\"  if \"j < i\" and nz: \"(deriv ^^ (i - j)) (deriv f) z \\<noteq> 0\" for j"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z = 0", "have \"1 < Suc (i - j)\" \"Suc (i - j) \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < Suc (i - j) &&& Suc (i - j) \\<le> n", "using \\<open>j < i\\<close> \\<open>Suc i \\<le> n\\<close>"], ["proof (prove)\nusing this:\n  j < i\n  Suc i \\<le> n\n\ngoal (1 subgoal):\n 1. 1 < Suc (i - j) &&& Suc (i - j) \\<le> n", "by auto"], ["proof (state)\nthis:\n  1 < Suc (i - j)\n  Suc (i - j) \\<le> n\n\ngoal (1 subgoal):\n 1. (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z = 0", "then"], ["proof (chain)\npicking this:\n  1 < Suc (i - j)\n  Suc (i - j) \\<le> n", "show ?thesis"], ["proof (prove)\nusing this:\n  1 < Suc (i - j)\n  Suc (i - j) \\<le> n\n\ngoal (1 subgoal):\n 1. (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z = 0", "by (metis comp_def funpow.simps(2) funpow_swap1 zero nz)"], ["proof (state)\nthis:\n  (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?j < i; (deriv ^^ (i - ?j)) (deriv f) z \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?j) (\\<lambda>w. deriv g (f w)) z = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>j = 0..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ (i - j)) (deriv f) z) =\n    (\\<Sum>j = i..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ Suc (i - j)) f z)", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>?j < i; (deriv ^^ (i - ?j)) (deriv f) z \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?j) (\\<lambda>w. deriv g (f w)) z = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>?j < i; (deriv ^^ (i - ?j)) (deriv f) z \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?j) (\\<lambda>w. deriv g (f w)) z = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>j = 0..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ (i - j)) (deriv f) z) =\n    (\\<Sum>j = i..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ Suc (i - j)) f z)", "apply (simp only: funpow_Suc_right o_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>j.\n        \\<lbrakk>j < i; (deriv ^^ (i - j)) (deriv f) z \\<noteq> 0\\<rbrakk>\n        \\<Longrightarrow> (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z =\n                          0) \\<Longrightarrow>\n    (\\<Sum>j = 0..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ (i - j)) (deriv f) z) =\n    (\\<Sum>j = i..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ (i - j)) (deriv f) z)", "apply (rule comm_monoid_add_class.sum.mono_neutral_right, auto)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<Sum>j = 0..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ (i - j)) (deriv f) z) =\n  (\\<Sum>j = i..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ Suc (i - j)) f z)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>j = 0..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ (i - j)) (deriv f) z) =\n  (\\<Sum>j = i..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ Suc (i - j)) f z)\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "also"], ["proof (state)\nthis:\n  (\\<Sum>j = 0..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ (i - j)) (deriv f) z) =\n  (\\<Sum>j = i..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ Suc (i - j)) f z)\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "have \"... = (deriv ^^ i) (deriv g) (f z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j = i..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ Suc (i - j)) f z) =\n    (deriv ^^ i) (deriv g) (f z)", "using Suc.IH [OF _ dg] Suc.prems"], ["proof (prove)\nusing this:\n  i \\<le> n \\<Longrightarrow>\n  (deriv ^^ i) (deriv g \\<circ> f) z = (deriv ^^ i) (deriv g) (f z)\n  Suc i \\<le> n\n  g holomorphic_on t\n\ngoal (1 subgoal):\n 1. (\\<Sum>j = i..i.\n        of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n        (deriv ^^ Suc (i - j)) f z) =\n    (deriv ^^ i) (deriv g) (f z)", "by (simp add: dfz)"], ["proof (state)\nthis:\n  (\\<Sum>j = i..i.\n      of_nat (i choose j) * (deriv ^^ j) (\\<lambda>w. deriv g (f w)) z *\n      (deriv ^^ Suc (i - j)) f z) =\n  (deriv ^^ i) (deriv g) (f z)\n\ngoal (1 subgoal):\n 1. \\<And>i g.\n       \\<lbrakk>\\<And>g.\n                   \\<lbrakk>i \\<le> n; g holomorphic_on t\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ i) (g \\<circ> f) z =\n                                     (deriv ^^ i) g (f z);\n        Suc i \\<le> n; g holomorphic_on t\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc i) (g \\<circ> f) z =\n                         (deriv ^^ Suc i) g (f z)", "finally"], ["proof (chain)\npicking this:\n  (deriv ^^ i) (deriv (g \\<circ> f)) z = (deriv ^^ i) (deriv g) (f z)", "show ?case"], ["proof (prove)\nusing this:\n  (deriv ^^ i) (deriv (g \\<circ> f)) z = (deriv ^^ i) (deriv g) (f z)\n\ngoal (1 subgoal):\n 1. (deriv ^^ Suc i) (g \\<circ> f) z = (deriv ^^ Suc i) g (f z)", "by (simp only: funpow_Suc_right o_def)"], ["proof (state)\nthis:\n  (deriv ^^ Suc i) (g \\<circ> f) z = (deriv ^^ Suc i) g (f z)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_deriv_comp_iter_lemma:\n    assumes s: \"open s\" and holf: \"f holomorphic_on s\"\n        and fss: \"f ` s \\<subseteq> s\"\n        and \"z \\<in> s\" and [simp]: \"f z = z\"\n        and n: \"i \\<le> n\"\n        and dfz: \"deriv f z = 1\" and zero: \"\\<And>i. \\<lbrakk>1 < i; i \\<le> n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\"\n      shows \"(deriv ^^ i) (f^^m) z = (deriv ^^ i) f z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z", "have holfm: \"(f^^m) holomorphic_on s\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. f ^^ m holomorphic_on s", "apply (induction m, simp add: holomorphic_on_ident)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       f ^^ m holomorphic_on s \\<Longrightarrow> f ^^ Suc m holomorphic_on s", "apply (simp only: funpow_Suc_right holomorphic_on_compose_gen [OF holf _ fss])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  f ^^ ?m holomorphic_on s\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z", "using n"], ["proof (prove)\nusing this:\n  i \\<le> n\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z", "proof (induction m)"], ["proof (state)\ngoal (2 subgoals):\n 1. i \\<le> n \\<Longrightarrow> (deriv ^^ i) (f ^^ 0) z = (deriv ^^ i) f z\n 2. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "case 0"], ["proof (state)\nthis:\n  i \\<le> n\n\ngoal (2 subgoals):\n 1. i \\<le> n \\<Longrightarrow> (deriv ^^ i) (f ^^ 0) z = (deriv ^^ i) f z\n 2. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "with dfz"], ["proof (chain)\npicking this:\n  deriv f z = 1\n  i \\<le> n", "show ?case"], ["proof (prove)\nusing this:\n  deriv f z = 1\n  i \\<le> n\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ 0) z = (deriv ^^ i) f z", "by (auto simp: zero)"], ["proof (state)\nthis:\n  (deriv ^^ i) (f ^^ 0) z = (deriv ^^ i) f z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "case (Suc m)"], ["proof (state)\nthis:\n  i \\<le> n \\<Longrightarrow> (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z\n  i \\<le> n\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "have \"(deriv ^^ i) (f ^^ m \\<circ> f) z = (deriv ^^ i) (f ^^ m) (f z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m \\<circ> f) z = (deriv ^^ i) (f ^^ m) (f z)", "using Suc.prems holfm \\<open>z \\<in> s\\<close> dfz fss higher_deriv_comp_lemma holf s zero"], ["proof (prove)\nusing this:\n  i \\<le> n\n  f ^^ ?m holomorphic_on s\n  z \\<in> s\n  deriv f z = 1\n  f ` s \\<subseteq> s\n  \\<lbrakk>open ?s; ?f holomorphic_on ?s; ?z \\<in> ?s; open ?t;\n   ?g holomorphic_on ?t; ?f ` ?s \\<subseteq> ?t; ?i \\<le> ?n;\n   deriv ?f ?z = 1;\n   \\<And>i.\n      \\<lbrakk>1 < i; i \\<le> ?n\\<rbrakk>\n      \\<Longrightarrow> (deriv ^^ i) ?f ?z = 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) (?g \\<circ> ?f) ?z =\n                    (deriv ^^ ?i) ?g (?f ?z)\n  f holomorphic_on s\n  open s\n  \\<lbrakk>1 < ?i; ?i \\<le> n\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m \\<circ> f) z = (deriv ^^ i) (f ^^ m) (f z)", "by blast"], ["proof (state)\nthis:\n  (deriv ^^ i) (f ^^ m \\<circ> f) z = (deriv ^^ i) (f ^^ m) (f z)\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "also"], ["proof (state)\nthis:\n  (deriv ^^ i) (f ^^ m \\<circ> f) z = (deriv ^^ i) (f ^^ m) (f z)\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "have \"... = (deriv ^^ i) f z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ m) (f z) = (deriv ^^ i) f z", "by (simp add: Suc)"], ["proof (state)\nthis:\n  (deriv ^^ i) (f ^^ m) (f z) = (deriv ^^ i) f z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>i \\<le> n \\<Longrightarrow>\n                (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z;\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "finally"], ["proof (chain)\npicking this:\n  (deriv ^^ i) (f ^^ m \\<circ> f) z = (deriv ^^ i) f z", "show ?case"], ["proof (prove)\nusing this:\n  (deriv ^^ i) (f ^^ m \\<circ> f) z = (deriv ^^ i) f z\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z", "by (simp only: funpow_Suc_right)"], ["proof (state)\nthis:\n  (deriv ^^ i) (f ^^ Suc m) z = (deriv ^^ i) f z\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (deriv ^^ i) (f ^^ m) z = (deriv ^^ i) f z\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma higher_deriv_iter_top_lemma:\n    assumes s: \"open s\" and holf: \"f holomorphic_on s\"\n        and fss: \"f ` s \\<subseteq> s\"\n        and \"z \\<in> s\" and [simp]: \"f z = z\"\n        and dfz [simp]: \"deriv f z = 1\"\n        and n: \"1 < n\" \"\\<And>i. \\<lbrakk>1 < i; i < n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\"\n      shows \"(deriv ^^ n) (f ^^ m) z = m * (deriv ^^ n) f z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (f ^^ m) z = of_nat m * (deriv ^^ n) f z", "using n"], ["proof (prove)\nusing this:\n  1 < n\n  \\<lbrakk>1 < ?i; ?i < n\\<rbrakk> \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) (f ^^ m) z = of_nat m * (deriv ^^ n) f z", "proof (induction n arbitrary: m)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>m.\n       \\<lbrakk>1 < 0;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < 0\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ 0) (f ^^ m) z =\n                         of_nat m * (deriv ^^ 0) f z\n 2. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "case 0"], ["proof (state)\nthis:\n  1 < 0\n  \\<lbrakk>1 < ?i; ?i < 0\\<rbrakk> \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (2 subgoals):\n 1. \\<And>m.\n       \\<lbrakk>1 < 0;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < 0\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ 0) (f ^^ m) z =\n                         of_nat m * (deriv ^^ 0) f z\n 2. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "then"], ["proof (chain)\npicking this:\n  1 < 0\n  \\<lbrakk>1 < ?i; ?i < 0\\<rbrakk> \\<Longrightarrow> (deriv ^^ ?i) f z = 0", "show ?case"], ["proof (prove)\nusing this:\n  1 < 0\n  \\<lbrakk>1 < ?i; ?i < 0\\<rbrakk> \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ 0) (f ^^ m) z = of_nat m * (deriv ^^ 0) f z", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ 0) (f ^^ m) z = of_nat m * (deriv ^^ 0) f z\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "case (Suc n)"], ["proof (state)\nthis:\n  \\<lbrakk>1 < n;\n   \\<And>i.\n      \\<lbrakk>1 < i; i < n\\<rbrakk>\n      \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ n) (f ^^ ?m) z = of_nat ?m * (deriv ^^ n) f z\n  1 < Suc n\n  \\<lbrakk>1 < ?i; ?i < Suc n\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "have [simp]: \"(f^^m) z = z\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. (f ^^ m) z = z", "by (induction m) auto"], ["proof (state)\nthis:\n  (f ^^ ?m) z = z\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "have fms_sb: \"(f^^m) ` s \\<subseteq> s\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. (f ^^ m) ` s \\<subseteq> s", "apply (induction m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (f ^^ 0) ` s \\<subseteq> s\n 2. \\<And>m.\n       (f ^^ m) ` s \\<subseteq> s \\<Longrightarrow>\n       (f ^^ Suc m) ` s \\<subseteq> s", "using fss"], ["proof (prove)\nusing this:\n  f ` s \\<subseteq> s\n\ngoal (2 subgoals):\n 1. (f ^^ 0) ` s \\<subseteq> s\n 2. \\<And>m.\n       (f ^^ m) ` s \\<subseteq> s \\<Longrightarrow>\n       (f ^^ Suc m) ` s \\<subseteq> s", "apply force+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (f ^^ ?m) ` s \\<subseteq> s\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "have holfm: \"(f^^m) holomorphic_on s\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. f ^^ m holomorphic_on s", "apply (induction m, simp add: holomorphic_on_ident)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       f ^^ m holomorphic_on s \\<Longrightarrow> f ^^ Suc m holomorphic_on s", "apply (simp only: funpow_Suc_right holomorphic_on_compose_gen [OF holf _ fss])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  f ^^ ?m holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "then"], ["proof (chain)\npicking this:\n  f ^^ ?m holomorphic_on s", "have holdfm: \"deriv (f ^^ m) holomorphic_on s\" for m"], ["proof (prove)\nusing this:\n  f ^^ ?m holomorphic_on s\n\ngoal (1 subgoal):\n 1. deriv (f ^^ m) holomorphic_on s", "by (simp add: holomorphic_deriv s)"], ["proof (state)\nthis:\n  deriv (f ^^ ?m) holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "have holdffm: \"(\\<lambda>z. deriv f ((f ^^ m) z)) holomorphic_on s\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>z. deriv f ((f ^^ m) z)) holomorphic_on s", "apply (rule holomorphic_on_compose_gen [where g=\"deriv f\" and t=s, unfolded o_def])"], ["proof (prove)\ngoal (3 subgoals):\n 1. f ^^ m holomorphic_on s\n 2. deriv f holomorphic_on s\n 3. (f ^^ m) ` s \\<subseteq> s", "using s \\<open>z \\<in> s\\<close> holfm holf fms_sb"], ["proof (prove)\nusing this:\n  open s\n  z \\<in> s\n  f ^^ ?m holomorphic_on s\n  f holomorphic_on s\n  (f ^^ ?m) ` s \\<subseteq> s\n\ngoal (3 subgoals):\n 1. f ^^ m holomorphic_on s\n 2. deriv f holomorphic_on s\n 3. (f ^^ m) ` s \\<subseteq> s", "by (auto intro: holomorphic_intros)"], ["proof (state)\nthis:\n  (\\<lambda>z. deriv f ((f ^^ ?m) z)) holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "have f_cd_w: \"\\<And>w. w \\<in> s \\<Longrightarrow> f field_differentiable at w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w. w \\<in> s \\<Longrightarrow> f field_differentiable at w", "using holf holomorphic_on_imp_differentiable_at s"], ["proof (prove)\nusing this:\n  f holomorphic_on s\n  \\<lbrakk>?f holomorphic_on ?s; open ?s; ?x \\<in> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f field_differentiable at ?x\n  open s\n\ngoal (1 subgoal):\n 1. \\<And>w. w \\<in> s \\<Longrightarrow> f field_differentiable at w", "by blast"], ["proof (state)\nthis:\n  ?w \\<in> s \\<Longrightarrow> f field_differentiable at ?w\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "have f_cd_mw: \"\\<And>m w. w \\<in> s \\<Longrightarrow> (f^^m) field_differentiable at w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m w. w \\<in> s \\<Longrightarrow> f ^^ m field_differentiable at w", "using holfm holomorphic_on_imp_differentiable_at s"], ["proof (prove)\nusing this:\n  f ^^ ?m holomorphic_on s\n  \\<lbrakk>?f holomorphic_on ?s; open ?s; ?x \\<in> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f field_differentiable at ?x\n  open s\n\ngoal (1 subgoal):\n 1. \\<And>m w. w \\<in> s \\<Longrightarrow> f ^^ m field_differentiable at w", "by auto"], ["proof (state)\nthis:\n  ?w \\<in> s \\<Longrightarrow> f ^^ ?m field_differentiable at ?w\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "have der_fm [simp]: \"deriv (f ^^ m) z = 1\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv (f ^^ m) z = 1", "apply (induction m, simp add: deriv_ident)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m. deriv (f ^^ m) z = 1 \\<Longrightarrow> deriv (f ^^ Suc m) z = 1", "apply (subst funpow_Suc_right)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       deriv (f ^^ m) z = 1 \\<Longrightarrow> deriv (f ^^ m \\<circ> f) z = 1", "apply (subst deriv_chain)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m.\n       deriv (f ^^ m) z = 1 \\<Longrightarrow> f field_differentiable at z\n 2. \\<And>m.\n       deriv (f ^^ m) z = 1 \\<Longrightarrow>\n       f ^^ m field_differentiable at (f z)\n 3. \\<And>m.\n       deriv (f ^^ m) z = 1 \\<Longrightarrow>\n       deriv (f ^^ m) (f z) * deriv f z = 1", "using \\<open>z \\<in> s\\<close> holfm holomorphic_on_imp_differentiable_at s f_cd_w"], ["proof (prove)\nusing this:\n  z \\<in> s\n  f ^^ ?m holomorphic_on s\n  \\<lbrakk>?f holomorphic_on ?s; open ?s; ?x \\<in> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f field_differentiable at ?x\n  open s\n  ?w \\<in> s \\<Longrightarrow> f field_differentiable at ?w\n\ngoal (3 subgoals):\n 1. \\<And>m.\n       deriv (f ^^ m) z = 1 \\<Longrightarrow> f field_differentiable at z\n 2. \\<And>m.\n       deriv (f ^^ m) z = 1 \\<Longrightarrow>\n       f ^^ m field_differentiable at (f z)\n 3. \\<And>m.\n       deriv (f ^^ m) z = 1 \\<Longrightarrow>\n       deriv (f ^^ m) (f z) * deriv f z = 1", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  deriv (f ^^ ?m) z = 1\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "note Suc(3) [simp]"], ["proof (state)\nthis:\n  \\<lbrakk>1 < ?i; ?i < Suc n\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "note n_Suc = Suc"], ["proof (state)\nthis:\n  \\<lbrakk>1 < n;\n   \\<And>i.\n      \\<lbrakk>1 < i; i < n\\<rbrakk>\n      \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ n) (f ^^ ?m) z = of_nat ?m * (deriv ^^ n) f z\n  1 < Suc n\n  \\<lbrakk>1 < ?i; ?i < Suc n\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (1 subgoal):\n 1. \\<And>n m.\n       \\<lbrakk>\\<And>m.\n                   \\<lbrakk>1 < n;\n                    \\<And>i.\n                       \\<lbrakk>1 < i; i < n\\<rbrakk>\n                       \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ n) (f ^^ m) z =\n                                     of_nat m * (deriv ^^ n) f z;\n        1 < Suc n;\n        \\<And>i.\n           \\<lbrakk>1 < i; i < Suc n\\<rbrakk>\n           \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (f ^^ m) z =\n                         of_nat m * (deriv ^^ Suc n) f z", "show ?case"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ Suc n) (f ^^ m) z = of_nat m * (deriv ^^ Suc n) f z", "proof (induction m)"], ["proof (state)\ngoal (2 subgoals):\n 1. (deriv ^^ Suc n) (f ^^ 0) z = of_nat 0 * (deriv ^^ Suc n) f z\n 2. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "case 0"], ["proof (state)\nthis:\n  \n\ngoal (2 subgoals):\n 1. (deriv ^^ Suc n) (f ^^ 0) z = of_nat 0 * (deriv ^^ Suc n) f z\n 2. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "with n_Suc"], ["proof (chain)\npicking this:\n  \\<lbrakk>1 < n;\n   \\<And>i.\n      \\<lbrakk>1 < i; i < n\\<rbrakk>\n      \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ n) (f ^^ ?m) z = of_nat ?m * (deriv ^^ n) f z\n  1 < Suc n\n  \\<lbrakk>1 < ?i; ?i < Suc n\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) f z = 0", "show ?case"], ["proof (prove)\nusing this:\n  \\<lbrakk>1 < n;\n   \\<And>i.\n      \\<lbrakk>1 < i; i < n\\<rbrakk>\n      \\<Longrightarrow> (deriv ^^ i) f z = 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ n) (f ^^ ?m) z = of_nat ?m * (deriv ^^ n) f z\n  1 < Suc n\n  \\<lbrakk>1 < ?i; ?i < Suc n\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ Suc n) (f ^^ 0) z = of_nat 0 * (deriv ^^ Suc n) f z", "by (metis Zero_not_Suc funpow_simps_right(1) higher_deriv_id lambda_zero nat_neq_iff of_nat_0)"], ["proof (state)\nthis:\n  (deriv ^^ Suc n) (f ^^ 0) z = of_nat 0 * (deriv ^^ Suc n) f z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "case (Suc m)"], ["proof (state)\nthis:\n  (deriv ^^ Suc n) (f ^^ m) z = of_nat m * (deriv ^^ Suc n) f z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "have deriv_nffm: \"(deriv ^^ n) (deriv f o (f ^^ m)) z = (deriv ^^ n) (deriv f) ((f ^^ m) z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (deriv f \\<circ> f ^^ m) z =\n    (deriv ^^ n) (deriv f) ((f ^^ m) z)", "apply (rule higher_deriv_comp_lemma [OF s holfm \\<open>z \\<in> s\\<close> s _ fms_sb order_refl])"], ["proof (prove)\ngoal (3 subgoals):\n 1. deriv f holomorphic_on s\n 2. deriv (f ^^ m) z = 1\n 3. \\<And>i.\n       \\<lbrakk>1 < i; i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ m) z = 0", "using \\<open>z \\<in> s\\<close> fss higher_deriv_comp_iter_lemma holf holf holomorphic_deriv s"], ["proof (prove)\nusing this:\n  z \\<in> s\n  f ` s \\<subseteq> s\n  \\<lbrakk>open ?s; ?f holomorphic_on ?s; ?f ` ?s \\<subseteq> ?s;\n   ?z \\<in> ?s; ?f ?z = ?z; ?i \\<le> ?n; deriv ?f ?z = 1;\n   \\<And>i.\n      \\<lbrakk>1 < i; i \\<le> ?n\\<rbrakk>\n      \\<Longrightarrow> (deriv ^^ i) ?f ?z = 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) (?f ^^ ?m) ?z = (deriv ^^ ?i) ?f ?z\n  f holomorphic_on s\n  f holomorphic_on s\n  \\<lbrakk>?f holomorphic_on ?S; open ?S\\<rbrakk>\n  \\<Longrightarrow> deriv ?f holomorphic_on ?S\n  open s\n\ngoal (3 subgoals):\n 1. deriv f holomorphic_on s\n 2. deriv (f ^^ m) z = 1\n 3. \\<And>i.\n       \\<lbrakk>1 < i; i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) (f ^^ m) z = 0", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (deriv ^^ n) (deriv f \\<circ> f ^^ m) z =\n  (deriv ^^ n) (deriv f) ((f ^^ m) z)\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "have \"deriv (f ^^ m \\<circ> f) holomorphic_on s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv (f ^^ m \\<circ> f) holomorphic_on s", "by (metis funpow_Suc_right holdfm)"], ["proof (state)\nthis:\n  deriv (f ^^ m \\<circ> f) holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "moreover"], ["proof (state)\nthis:\n  deriv (f ^^ m \\<circ> f) holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "have \"(\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) holomorphic_on s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) holomorphic_on s", "by (rule holomorphic_on_mult [OF holdffm holdfm])"], ["proof (state)\nthis:\n  (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) holomorphic_on s\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "ultimately"], ["proof (chain)\npicking this:\n  deriv (f ^^ m \\<circ> f) holomorphic_on s\n  (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) holomorphic_on s", "have \"(deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z = (deriv ^^ n) (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) z\""], ["proof (prove)\nusing this:\n  deriv (f ^^ m \\<circ> f) holomorphic_on s\n  (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) holomorphic_on s\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n    (deriv ^^ n) (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) z", "apply (rule higher_deriv_transform_within_open [OF _ _ s \\<open>z \\<in> s\\<close>])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w.\n       w \\<in> s \\<Longrightarrow>\n       deriv (f ^^ m \\<circ> f) w = deriv f ((f ^^ m) w) * deriv (f ^^ m) w", "by (metis comp_funpow deriv_chain f_cd_mw f_cd_w fms_sb funpow_swap1 image_subset_iff o_id)"], ["proof (state)\nthis:\n  (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n  (deriv ^^ n) (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "also"], ["proof (state)\nthis:\n  (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n  (deriv ^^ n) (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "have \"... =\n          (\\<Sum>i=0..n. of_nat(n choose i) * (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n                     (deriv ^^ (n - i)) (deriv (f ^^ m)) z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) z =\n    (\\<Sum>i = 0..n.\n        of_nat (n choose i) *\n        (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n        (deriv ^^ (n - i)) (deriv (f ^^ m)) z)", "by (rule higher_deriv_mult [OF holdffm holdfm s \\<open>z \\<in> s\\<close>])"], ["proof (state)\nthis:\n  (deriv ^^ n) (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) z =\n  (\\<Sum>i = 0..n.\n      of_nat (n choose i) *\n      (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n      (deriv ^^ (n - i)) (deriv (f ^^ m)) z)\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "also"], ["proof (state)\nthis:\n  (deriv ^^ n) (\\<lambda>w. deriv f ((f ^^ m) w) * deriv (f ^^ m) w) z =\n  (\\<Sum>i = 0..n.\n      of_nat (n choose i) *\n      (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n      (deriv ^^ (n - i)) (deriv (f ^^ m)) z)\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "have \"... = (\\<Sum>i \\<in> {0,n}. of_nat(n choose i) * (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n                     (deriv ^^ (n - i)) (deriv (f ^^ m)) z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 0..n.\n        of_nat (n choose i) *\n        (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n        (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n    (\\<Sum>i\\<in>{0, n}.\n       of_nat (n choose i) *\n       (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n       (deriv ^^ (n - i)) (deriv (f ^^ m)) z)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 0..n.\n        of_nat (n choose i) *\n        (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n        (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n    (\\<Sum>i\\<in>{0, n}.\n       of_nat (n choose i) *\n       (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n       (deriv ^^ (n - i)) (deriv (f ^^ m)) z)", "have *: \"(deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0\"  if \"i \\<le> n\" \"0 < i\" \"i \\<noteq> n\" and nz: \"(deriv ^^ (n - i)) (deriv (f ^^ m)) z \\<noteq> 0\" for i"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "have less: \"1 < Suc (n-i)\" and le: \"Suc (n-i) \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < Suc (n - i) &&& Suc (n - i) \\<le> n", "using that"], ["proof (prove)\nusing this:\n  i \\<le> n\n  0 < i\n  i \\<noteq> n\n  (deriv ^^ (n - i)) (deriv (f ^^ m)) z \\<noteq> 0\n\ngoal (1 subgoal):\n 1. 1 < Suc (n - i) &&& Suc (n - i) \\<le> n", "by auto"], ["proof (state)\nthis:\n  1 < Suc (n - i)\n  Suc (n - i) \\<le> n\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "have \"(deriv ^^ (Suc (n - i))) (f ^^ m) z = (deriv ^^(Suc (n - i))) f z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ Suc (n - i)) (f ^^ m) z = (deriv ^^ Suc (n - i)) f z", "apply (rule higher_deriv_comp_iter_lemma [OF s holf fss \\<open>z \\<in> s\\<close> \\<open>f z = z\\<close> le dfz])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>1 < i; i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ i) f z = 0", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ Suc (n - i)) (f ^^ m) z = (deriv ^^ Suc (n - i)) f z\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "also"], ["proof (state)\nthis:\n  (deriv ^^ Suc (n - i)) (f ^^ m) z = (deriv ^^ Suc (n - i)) f z\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "have \"... = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ Suc (n - i)) f z = 0", "using n_Suc(3) less le le_imp_less_Suc"], ["proof (prove)\nusing this:\n  \\<lbrakk>1 < ?i; ?i < Suc n\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) f z = 0\n  1 < Suc (n - i)\n  Suc (n - i) \\<le> n\n  ?m \\<le> ?n \\<Longrightarrow> ?m < Suc ?n\n\ngoal (1 subgoal):\n 1. (deriv ^^ Suc (n - i)) f z = 0", "by blast"], ["proof (state)\nthis:\n  (deriv ^^ Suc (n - i)) f z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "finally"], ["proof (chain)\npicking this:\n  (deriv ^^ Suc (n - i)) (f ^^ m) z = 0", "have \"(deriv ^^ (Suc (n - i))) (f ^^ m) z = 0\""], ["proof (prove)\nusing this:\n  (deriv ^^ Suc (n - i)) (f ^^ m) z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ Suc (n - i)) (f ^^ m) z = 0", "."], ["proof (state)\nthis:\n  (deriv ^^ Suc (n - i)) (f ^^ m) z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "then"], ["proof (chain)\npicking this:\n  (deriv ^^ Suc (n - i)) (f ^^ m) z = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  (deriv ^^ Suc (n - i)) (f ^^ m) z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0", "by (simp add: funpow_swap1 nz)"], ["proof (state)\nthis:\n  (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>?i \\<le> n; 0 < ?i; ?i \\<noteq> n;\n   (deriv ^^ (n - ?i)) (deriv (f ^^ m)) z \\<noteq> 0\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?i) (\\<lambda>w. deriv f ((f ^^ m) w)) z = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>i = 0..n.\n        of_nat (n choose i) *\n        (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n        (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n    (\\<Sum>i\\<in>{0, n}.\n       of_nat (n choose i) *\n       (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n       (deriv ^^ (n - i)) (deriv (f ^^ m)) z)", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i = 0..n.\n        of_nat (n choose i) *\n        (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n        (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n    (\\<Sum>i\\<in>{0, n}.\n       of_nat (n choose i) *\n       (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n       (deriv ^^ (n - i)) (deriv (f ^^ m)) z)", "by (rule comm_monoid_add_class.sum.mono_neutral_right) (auto simp: *)"], ["proof (state)\nthis:\n  (\\<Sum>i = 0..n.\n      of_nat (n choose i) *\n      (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n      (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n  (\\<Sum>i\\<in>{0, n}.\n     of_nat (n choose i) *\n     (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n     (deriv ^^ (n - i)) (deriv (f ^^ m)) z)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>i = 0..n.\n      of_nat (n choose i) *\n      (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n      (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n  (\\<Sum>i\\<in>{0, n}.\n     of_nat (n choose i) *\n     (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n     (deriv ^^ (n - i)) (deriv (f ^^ m)) z)\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "also"], ["proof (state)\nthis:\n  (\\<Sum>i = 0..n.\n      of_nat (n choose i) *\n      (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n      (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n  (\\<Sum>i\\<in>{0, n}.\n     of_nat (n choose i) *\n     (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n     (deriv ^^ (n - i)) (deriv (f ^^ m)) z)\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "have \"... = of_nat (Suc m) * (deriv ^^ n) (deriv f) z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>i\\<in>{0, n}.\n       of_nat (n choose i) *\n       (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n       (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n    of_nat (Suc m) * (deriv ^^ n) (deriv f) z", "apply (subst Groups_Big.comm_monoid_add_class.sum.insert)"], ["proof (prove)\ngoal (3 subgoals):\n 1. finite {n}\n 2. 0 \\<notin> {n}\n 3. of_nat (n choose 0) *\n    (deriv ^^ 0) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n    (deriv ^^ (n - 0)) (deriv (f ^^ m)) z +\n    (\\<Sum>i\\<in>{n}.\n       of_nat (n choose i) *\n       (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n       (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n    of_nat (Suc m) * (deriv ^^ n) (deriv f) z", "apply (simp_all add: deriv_nffm [unfolded o_def] of_nat_Suc [of 0] del: of_nat_Suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 0 < n\n 2. (deriv ^^ n) (deriv (f ^^ m)) z + (deriv ^^ n) (deriv f) z =\n    of_nat (Suc m) * (deriv ^^ n) (deriv f) z", "using n_Suc(2) Suc"], ["proof (prove)\nusing this:\n  1 < Suc n\n  (deriv ^^ Suc n) (f ^^ m) z = of_nat m * (deriv ^^ Suc n) f z\n\ngoal (2 subgoals):\n 1. 0 < n\n 2. (deriv ^^ n) (deriv (f ^^ m)) z + (deriv ^^ n) (deriv f) z =\n    of_nat (Suc m) * (deriv ^^ n) (deriv f) z", "apply (auto simp del: funpow.simps simp: algebra_simps funpow_simps_right)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<Sum>i\\<in>{0, n}.\n     of_nat (n choose i) *\n     (deriv ^^ i) (\\<lambda>w. deriv f ((f ^^ m) w)) z *\n     (deriv ^^ (n - i)) (deriv (f ^^ m)) z) =\n  of_nat (Suc m) * (deriv ^^ n) (deriv f) z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "finally"], ["proof (chain)\npicking this:\n  (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n  of_nat (Suc m) * (deriv ^^ n) (deriv f) z", "have \"(deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z = of_nat (Suc m) * (deriv ^^ n) (deriv f) z\""], ["proof (prove)\nusing this:\n  (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n  of_nat (Suc m) * (deriv ^^ n) (deriv f) z\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n    of_nat (Suc m) * (deriv ^^ n) (deriv f) z", "."], ["proof (state)\nthis:\n  (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n  of_nat (Suc m) * (deriv ^^ n) (deriv f) z\n\ngoal (1 subgoal):\n 1. \\<And>m.\n       (deriv ^^ Suc n) (f ^^ m) z =\n       of_nat m * (deriv ^^ Suc n) f z \\<Longrightarrow>\n       (deriv ^^ Suc n) (f ^^ Suc m) z =\n       of_nat (Suc m) * (deriv ^^ Suc n) f z", "then"], ["proof (chain)\npicking this:\n  (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n  of_nat (Suc m) * (deriv ^^ n) (deriv f) z", "show ?case"], ["proof (prove)\nusing this:\n  (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n  of_nat (Suc m) * (deriv ^^ n) (deriv f) z\n\ngoal (1 subgoal):\n 1. (deriv ^^ Suc n) (f ^^ Suc m) z = of_nat (Suc m) * (deriv ^^ Suc n) f z", "apply (simp only: funpow_Suc_right)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (deriv (f ^^ m \\<circ> f)) z =\n    of_nat (Suc m) * (deriv ^^ n) (deriv f) z \\<Longrightarrow>\n    (deriv ^^ n \\<circ> deriv) (f ^^ m \\<circ> f) z =\n    of_nat (Suc m) * (deriv ^^ n \\<circ> deriv) f z", "apply (simp add: o_def del: of_nat_Suc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (deriv ^^ Suc n) (f ^^ Suc m) z = of_nat (Suc m) * (deriv ^^ Suc n) f z\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (deriv ^^ Suc n) (f ^^ m) z = of_nat m * (deriv ^^ Suc n) f z\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Should be proved for n-dimensional vectors of complex numbers\\<close>"], ["", "theorem first_Cartan_dim_1:\n    assumes holf: \"f holomorphic_on s\"\n        and \"open s\" \"connected s\" \"bounded s\"\n        and fss: \"f ` s \\<subseteq> s\"\n        and \"z \\<in> s\" and [simp]: \"f z = z\"\n        and dfz [simp]: \"deriv f z = 1\"\n        and \"w \\<in> s\"\n      shows \"f w = w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f w = w", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. f w = w", "obtain c where \"0 < c\" and c: \"s \\<subseteq> ball z c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c.\n        \\<lbrakk>0 < c; s \\<subseteq> ball z c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using \\<open>bounded s\\<close> bounded_subset_ballD"], ["proof (prove)\nusing this:\n  bounded s\n  bounded ?S \\<Longrightarrow> \\<exists>r>0. ?S \\<subseteq> ball ?x r\n\ngoal (1 subgoal):\n 1. (\\<And>c.\n        \\<lbrakk>0 < c; s \\<subseteq> ball z c\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < c\n  s \\<subseteq> ball z c\n\ngoal (1 subgoal):\n 1. f w = w", "obtain r where \"0 < r\" and r: \"cball z r \\<subseteq> s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; cball z r \\<subseteq> s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using \\<open>z \\<in> s\\<close> open_contains_cball \\<open>open s\\<close>"], ["proof (prove)\nusing this:\n  z \\<in> s\n  open ?S = (\\<forall>x\\<in>?S. \\<exists>e>0. cball x e \\<subseteq> ?S)\n  open s\n\ngoal (1 subgoal):\n 1. (\\<And>r.\n        \\<lbrakk>0 < r; cball z r \\<subseteq> s\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  0 < r\n  cball z r \\<subseteq> s\n\ngoal (1 subgoal):\n 1. f w = w", "then"], ["proof (chain)\npicking this:\n  0 < r\n  cball z r \\<subseteq> s", "have bzr: \"ball z r \\<subseteq> s\""], ["proof (prove)\nusing this:\n  0 < r\n  cball z r \\<subseteq> s\n\ngoal (1 subgoal):\n 1. ball z r \\<subseteq> s", "using ball_subset_cball"], ["proof (prove)\nusing this:\n  0 < r\n  cball z r \\<subseteq> s\n  ball ?x ?e \\<subseteq> cball ?x ?e\n\ngoal (1 subgoal):\n 1. ball z r \\<subseteq> s", "by blast"], ["proof (state)\nthis:\n  ball z r \\<subseteq> s\n\ngoal (1 subgoal):\n 1. f w = w", "have fms_sb: \"(f^^m) ` s \\<subseteq> s\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. (f ^^ m) ` s \\<subseteq> s", "apply (induction m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (f ^^ 0) ` s \\<subseteq> s\n 2. \\<And>m.\n       (f ^^ m) ` s \\<subseteq> s \\<Longrightarrow>\n       (f ^^ Suc m) ` s \\<subseteq> s", "using fss"], ["proof (prove)\nusing this:\n  f ` s \\<subseteq> s\n\ngoal (2 subgoals):\n 1. (f ^^ 0) ` s \\<subseteq> s\n 2. \\<And>m.\n       (f ^^ m) ` s \\<subseteq> s \\<Longrightarrow>\n       (f ^^ Suc m) ` s \\<subseteq> s", "apply force+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (f ^^ ?m) ` s \\<subseteq> s\n\ngoal (1 subgoal):\n 1. f w = w", "have holfm: \"(f^^m) holomorphic_on s\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. f ^^ m holomorphic_on s", "apply (induction m, simp add: holomorphic_on_ident)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       f ^^ m holomorphic_on s \\<Longrightarrow> f ^^ Suc m holomorphic_on s", "apply (simp only: funpow_Suc_right holomorphic_on_compose_gen [OF holf _ fss])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  f ^^ ?m holomorphic_on s\n\ngoal (1 subgoal):\n 1. f w = w", "have *: \"(deriv ^^ n) f z = (deriv ^^ n) id z\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) id z", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) id z", "consider \"n = 0\" | \"n = 1\" | \"1 < n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>n = 0 \\<Longrightarrow> thesis; n = 1 \\<Longrightarrow> thesis;\n     1 < n \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by arith"], ["proof (state)\nthis:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis; n = 1 \\<Longrightarrow> ?thesis;\n   1 < n \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) id z", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis; n = 1 \\<Longrightarrow> ?thesis;\n   1 < n \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<lbrakk>n = 0 \\<Longrightarrow> ?thesis; n = 1 \\<Longrightarrow> ?thesis;\n   1 < n \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) id z", "proof cases"], ["proof (state)\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z\n 2. n = 1 \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z\n 3. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "assume \"n = 0\""], ["proof (state)\nthis:\n  n = 0\n\ngoal (3 subgoals):\n 1. n = 0 \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z\n 2. n = 1 \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z\n 3. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "then"], ["proof (chain)\npicking this:\n  n = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  n = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) id z", "by force"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = (deriv ^^ n) id z\n\ngoal (2 subgoals):\n 1. n = 1 \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z\n 2. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. n = 1 \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z\n 2. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "assume \"n = 1\""], ["proof (state)\nthis:\n  n = 1\n\ngoal (2 subgoals):\n 1. n = 1 \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z\n 2. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "then"], ["proof (chain)\npicking this:\n  n = 1", "show ?thesis"], ["proof (prove)\nusing this:\n  n = 1\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) id z", "by force"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = (deriv ^^ n) id z\n\ngoal (1 subgoal):\n 1. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "assume n1: \"n > 1\""], ["proof (state)\nthis:\n  1 < n\n\ngoal (1 subgoal):\n 1. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "then"], ["proof (chain)\npicking this:\n  1 < n", "have \"(deriv ^^ n) f z = 0\""], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = 0", "proof (induction n rule: less_induct)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>y.\n                   \\<lbrakk>y < x; 1 < y\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ y) f z = 0;\n        1 < x\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ x) f z = 0", "case (less n)"], ["proof (state)\nthis:\n  \\<lbrakk>?y < n; 1 < ?y\\<rbrakk> \\<Longrightarrow> (deriv ^^ ?y) f z = 0\n  1 < n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>y.\n                   \\<lbrakk>y < x; 1 < y\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ y) f z = 0;\n        1 < x\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ x) f z = 0", "have le: \"real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n\" if \"m\\<noteq>0\" for m"], ["proof (prove)\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "have holfm': \"(f ^^ m) holomorphic_on ball z r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f ^^ m holomorphic_on ball z r", "using holfm bzr holomorphic_on_subset"], ["proof (prove)\nusing this:\n  f ^^ ?m holomorphic_on s\n  ball z r \\<subseteq> s\n  \\<lbrakk>?f holomorphic_on ?s; ?t \\<subseteq> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f holomorphic_on ?t\n\ngoal (1 subgoal):\n 1. f ^^ m holomorphic_on ball z r", "by blast"], ["proof (state)\nthis:\n  f ^^ m holomorphic_on ball z r\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "then"], ["proof (chain)\npicking this:\n  f ^^ m holomorphic_on ball z r", "have contfm': \"continuous_on (cball z r) (f ^^ m)\""], ["proof (prove)\nusing this:\n  f ^^ m holomorphic_on ball z r\n\ngoal (1 subgoal):\n 1. continuous_on (cball z r) (f ^^ m)", "using \\<open>cball z r \\<subseteq> s\\<close> holfm holomorphic_on_imp_continuous_on holomorphic_on_subset"], ["proof (prove)\nusing this:\n  f ^^ m holomorphic_on ball z r\n  cball z r \\<subseteq> s\n  f ^^ ?m holomorphic_on s\n  ?f holomorphic_on ?s \\<Longrightarrow> continuous_on ?s ?f\n  \\<lbrakk>?f holomorphic_on ?s; ?t \\<subseteq> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f holomorphic_on ?t\n\ngoal (1 subgoal):\n 1. continuous_on (cball z r) (f ^^ m)", "by blast"], ["proof (state)\nthis:\n  continuous_on (cball z r) (f ^^ m)\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "have \"real m * cmod ((deriv ^^ n) f z) = cmod (real m * (deriv ^^ n) f z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) =\n    cmod (complex_of_real (real m) * (deriv ^^ n) f z)", "by (simp add: norm_mult)"], ["proof (state)\nthis:\n  real m * cmod ((deriv ^^ n) f z) =\n  cmod (complex_of_real (real m) * (deriv ^^ n) f z)\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "also"], ["proof (state)\nthis:\n  real m * cmod ((deriv ^^ n) f z) =\n  cmod (complex_of_real (real m) * (deriv ^^ n) f z)\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "have \"... = cmod ((deriv ^^ n) (f ^^ m) z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (complex_of_real (real m) * (deriv ^^ n) f z) =\n    cmod ((deriv ^^ n) (f ^^ m) z)", "apply (subst higher_deriv_iter_top_lemma [OF \\<open>open s\\<close> holf fss \\<open>z \\<in> s\\<close> \\<open>f z = z\\<close> dfz])"], ["proof (prove)\ngoal (3 subgoals):\n 1. 1 < n\n 2. \\<And>i.\n       \\<lbrakk>1 < i; i < n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\n 3. cmod (complex_of_real (real m) * (deriv ^^ n) f z) =\n    cmod (of_nat m * (deriv ^^ n) f z)", "using less"], ["proof (prove)\nusing this:\n  \\<lbrakk>?y < n; 1 < ?y\\<rbrakk> \\<Longrightarrow> (deriv ^^ ?y) f z = 0\n  1 < n\n\ngoal (3 subgoals):\n 1. 1 < n\n 2. \\<And>i.\n       \\<lbrakk>1 < i; i < n\\<rbrakk> \\<Longrightarrow> (deriv ^^ i) f z = 0\n 3. cmod (complex_of_real (real m) * (deriv ^^ n) f z) =\n    cmod (of_nat m * (deriv ^^ n) f z)", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  cmod (complex_of_real (real m) * (deriv ^^ n) f z) =\n  cmod ((deriv ^^ n) (f ^^ m) z)\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "also"], ["proof (state)\nthis:\n  cmod (complex_of_real (real m) * (deriv ^^ n) f z) =\n  cmod ((deriv ^^ n) (f ^^ m) z)\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "have \"... \\<le> fact n * c / r ^ n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) (f ^^ m) z) \\<le> fact n * c / r ^ n", "apply (rule Cauchy_higher_deriv_bound [OF holfm' contfm' \\<open>0 < r\\<close>, where y=z])"], ["proof (prove)\ngoal (2 subgoals):\n 1. 0 < n\n 2. \\<And>w. w \\<in> ball z r \\<Longrightarrow> (f ^^ m) w \\<in> ball z c", "using less.prems"], ["proof (prove)\nusing this:\n  1 < n\n\ngoal (2 subgoals):\n 1. 0 < n\n 2. \\<And>w. w \\<in> ball z r \\<Longrightarrow> (f ^^ m) w \\<in> ball z c", "apply linarith"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w. w \\<in> ball z r \\<Longrightarrow> (f ^^ m) w \\<in> ball z c", "using fms_sb c r ball_subset_cball"], ["proof (prove)\nusing this:\n  (f ^^ ?m) ` s \\<subseteq> s\n  s \\<subseteq> ball z c\n  cball z r \\<subseteq> s\n  ball ?x ?e \\<subseteq> cball ?x ?e\n\ngoal (1 subgoal):\n 1. \\<And>w. w \\<in> ball z r \\<Longrightarrow> (f ^^ m) w \\<in> ball z c", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  cmod ((deriv ^^ n) (f ^^ m) z) \\<le> fact n * c / r ^ n\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "finally"], ["proof (chain)\npicking this:\n  real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "show ?thesis"], ["proof (prove)\nusing this:\n  real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n\n\ngoal (1 subgoal):\n 1. real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "."], ["proof (state)\nthis:\n  real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?m \\<noteq> 0 \\<Longrightarrow>\n  real ?m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>y.\n                   \\<lbrakk>y < x; 1 < y\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ y) f z = 0;\n        1 < x\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ x) f z = 0", "have \"cmod ((deriv ^^ n) f z) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod ((deriv ^^ n) f z) = 0", "apply (rule real_archimedian_rdiv_eq_0 [where c = \"(fact n) * c / r ^ n\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. 0 \\<le> cmod ((deriv ^^ n) f z)\n 2. 0 \\<le> fact n * c / r ^ n\n 3. \\<And>m.\n       0 < m \\<Longrightarrow>\n       real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. 0 \\<le> fact n * c / r ^ n\n 2. \\<And>m.\n       0 < m \\<Longrightarrow>\n       real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "using \\<open>0 < r\\<close> \\<open>0 < c\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n  0 < c\n\ngoal (2 subgoals):\n 1. 0 \\<le> fact n * c / r ^ n\n 2. \\<And>m.\n       0 < m \\<Longrightarrow>\n       real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "apply (simp add: divide_simps)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       0 < m \\<Longrightarrow>\n       real m * cmod ((deriv ^^ n) f z) \\<le> fact n * c / r ^ n", "apply (blast intro: le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  cmod ((deriv ^^ n) f z) = 0\n\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<And>y.\n                   \\<lbrakk>y < x; 1 < y\\<rbrakk>\n                   \\<Longrightarrow> (deriv ^^ y) f z = 0;\n        1 < x\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ x) f z = 0", "then"], ["proof (chain)\npicking this:\n  cmod ((deriv ^^ n) f z) = 0", "show ?case"], ["proof (prove)\nusing this:\n  cmod ((deriv ^^ n) f z) = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = 0", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = 0\n\ngoal (1 subgoal):\n 1. 1 < n \\<Longrightarrow> (deriv ^^ n) f z = (deriv ^^ n) id z", "with n1"], ["proof (chain)\npicking this:\n  1 < n\n  (deriv ^^ n) f z = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  1 < n\n  (deriv ^^ n) f z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f z = (deriv ^^ n) id z", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = (deriv ^^ n) id z\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (deriv ^^ n) f z = (deriv ^^ n) id z\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (deriv ^^ ?n) f z = (deriv ^^ ?n) id z\n\ngoal (1 subgoal):\n 1. f w = w", "have \"f w = id w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f w = id w", "by (rule holomorphic_fun_eq_on_connected\n                 [OF holf holomorphic_on_id \\<open>open s\\<close> \\<open>connected s\\<close> * \\<open>z \\<in> s\\<close> \\<open>w \\<in> s\\<close>])"], ["proof (state)\nthis:\n  f w = id w\n\ngoal (1 subgoal):\n 1. f w = w", "also"], ["proof (state)\nthis:\n  f w = id w\n\ngoal (1 subgoal):\n 1. f w = w", "have \"... = w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. id w = w", "by simp"], ["proof (state)\nthis:\n  id w = w\n\ngoal (1 subgoal):\n 1. f w = w", "finally"], ["proof (chain)\npicking this:\n  f w = w", "show ?thesis"], ["proof (prove)\nusing this:\n  f w = w\n\ngoal (1 subgoal):\n 1. f w = w", "."], ["proof (state)\nthis:\n  f w = w\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Second Cartan Theorem.\\<close>"], ["", "lemma Cartan_is_linear:\n  assumes holf: \"f holomorphic_on s\"\n      and \"open s\" and \"connected s\"\n      and \"0 \\<in> s\"\n      and ins: \"\\<And>u z. \\<lbrakk>norm u = 1; z \\<in> s\\<rbrakk> \\<Longrightarrow> u * z \\<in> s\"\n      and feq: \"\\<And>u z. \\<lbrakk>norm u = 1; z \\<in> s\\<rbrakk> \\<Longrightarrow> f (u * z) = u * f z\"\n    shows \"\\<exists>c. \\<forall>z \\<in> s. f z = c * z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c. \\<forall>z\\<in>s. f z = c * z", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>c. \\<forall>z\\<in>s. f z = c * z", "have [simp]: \"f 0 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f 0 = 0", "using feq [of \"-1\" 0] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>cmod (- 1) = 1; 0 \\<in> s\\<rbrakk>\n  \\<Longrightarrow> f (- 1 * 0) = - 1 * f 0\n  f holomorphic_on s\n  open s\n  connected s\n  0 \\<in> s\n  \\<lbrakk>cmod ?u = 1; ?z \\<in> s\\<rbrakk>\n  \\<Longrightarrow> ?u * ?z \\<in> s\n  \\<lbrakk>cmod ?u = 1; ?z \\<in> s\\<rbrakk>\n  \\<Longrightarrow> f (?u * ?z) = ?u * f ?z\n\ngoal (1 subgoal):\n 1. f 0 = 0", "by simp"], ["proof (state)\nthis:\n  f 0 = 0\n\ngoal (1 subgoal):\n 1. \\<exists>c. \\<forall>z\\<in>s. f z = c * z", "have uneq: \"u^n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z\"\n       if \"norm u = 1\" \"z \\<in> s\" for n u z"], ["proof (prove)\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "have holfuw: \"(\\<lambda>w. f (u * w)) holomorphic_on s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>w. f (u * w)) holomorphic_on s", "apply (rule holomorphic_on_compose_gen [OF _ holf, unfolded o_def])"], ["proof (prove)\ngoal (2 subgoals):\n 1. (*) u holomorphic_on s\n 2. (*) u ` s \\<subseteq> s", "using that ins"], ["proof (prove)\nusing this:\n  cmod u = 1\n  z \\<in> s\n  \\<lbrakk>cmod ?u = 1; ?z \\<in> s\\<rbrakk>\n  \\<Longrightarrow> ?u * ?z \\<in> s\n\ngoal (2 subgoals):\n 1. (*) u holomorphic_on s\n 2. (*) u ` s \\<subseteq> s", "by (auto simp: holomorphic_on_linear)"], ["proof (state)\nthis:\n  (\\<lambda>w. f (u * w)) holomorphic_on s\n\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "have hol_d_fuw: \"(deriv ^^ n) (\\<lambda>w. u * f w) holomorphic_on s\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. u * f w) holomorphic_on s", "by (rule holomorphic_higher_deriv holomorphic_intros holf assms)+"], ["proof (state)\nthis:\n  (deriv ^^ ?n) (\\<lambda>w. u * f w) holomorphic_on s\n\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "have *: \"(deriv ^^ n) (\\<lambda>w. u * f w) z = u * (deriv ^^ n) f z\" if \"z \\<in> s\" for z"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. u * f w) z = u * (deriv ^^ n) f z", "using that"], ["proof (prove)\nusing this:\n  z \\<in> s\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. u * f w) z = u * (deriv ^^ n) f z", "proof (induction n arbitrary: z)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>z.\n       z \\<in> s \\<Longrightarrow>\n       (deriv ^^ 0) (\\<lambda>w. u * f w) z = u * (deriv ^^ 0) f z\n 2. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "case 0"], ["proof (state)\nthis:\n  z \\<in> s\n\ngoal (2 subgoals):\n 1. \\<And>z.\n       z \\<in> s \\<Longrightarrow>\n       (deriv ^^ 0) (\\<lambda>w. u * f w) z = u * (deriv ^^ 0) f z\n 2. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "then"], ["proof (chain)\npicking this:\n  z \\<in> s", "show ?case"], ["proof (prove)\nusing this:\n  z \\<in> s\n\ngoal (1 subgoal):\n 1. (deriv ^^ 0) (\\<lambda>w. u * f w) z = u * (deriv ^^ 0) f z", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ 0) (\\<lambda>w. u * f w) z = u * (deriv ^^ 0) f z\n\ngoal (1 subgoal):\n 1. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "case (Suc n)"], ["proof (state)\nthis:\n  ?z \\<in> s \\<Longrightarrow>\n  (deriv ^^ n) (\\<lambda>w. u * f w) ?z = u * (deriv ^^ n) f ?z\n  z \\<in> s\n\ngoal (1 subgoal):\n 1. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "have \"deriv ((deriv ^^ n) (\\<lambda>w. u * f w)) z = deriv (\\<lambda>w. u * (deriv ^^ n) f w) z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv ((deriv ^^ n) (\\<lambda>w. u * f w)) z =\n    deriv (\\<lambda>w. u * (deriv ^^ n) f w) z", "apply (rule complex_derivative_transform_within_open [OF hol_d_fuw])"], ["proof (prove)\ngoal (4 subgoals):\n 1. (\\<lambda>w. u * (deriv ^^ n) f w) holomorphic_on s\n 2. open s\n 3. z \\<in> s\n 4. \\<And>w.\n       w \\<in> s \\<Longrightarrow>\n       (deriv ^^ n) (\\<lambda>w. u * f w) w = u * (deriv ^^ n) f w", "apply (auto intro!: holomorphic_higher_deriv holomorphic_intros assms Suc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  deriv ((deriv ^^ n) (\\<lambda>w. u * f w)) z =\n  deriv (\\<lambda>w. u * (deriv ^^ n) f w) z\n\ngoal (1 subgoal):\n 1. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "also"], ["proof (state)\nthis:\n  deriv ((deriv ^^ n) (\\<lambda>w. u * f w)) z =\n  deriv (\\<lambda>w. u * (deriv ^^ n) f w) z\n\ngoal (1 subgoal):\n 1. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "have \"... = u * deriv ((deriv ^^ n) f) z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv (\\<lambda>w. u * (deriv ^^ n) f w) z =\n    u * deriv ((deriv ^^ n) f) z", "apply (rule deriv_cmult)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f field_differentiable at z", "using Suc \\<open>open s\\<close> holf holomorphic_higher_deriv holomorphic_on_imp_differentiable_at"], ["proof (prove)\nusing this:\n  ?z \\<in> s \\<Longrightarrow>\n  (deriv ^^ n) (\\<lambda>w. u * f w) ?z = u * (deriv ^^ n) f ?z\n  z \\<in> s\n  open s\n  f holomorphic_on s\n  \\<lbrakk>?f holomorphic_on ?S; open ?S\\<rbrakk>\n  \\<Longrightarrow> (deriv ^^ ?n) ?f holomorphic_on ?S\n  \\<lbrakk>?f holomorphic_on ?s; open ?s; ?x \\<in> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f field_differentiable at ?x\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f field_differentiable at z", "by blast"], ["proof (state)\nthis:\n  deriv (\\<lambda>w. u * (deriv ^^ n) f w) z = u * deriv ((deriv ^^ n) f) z\n\ngoal (1 subgoal):\n 1. \\<And>n z.\n       \\<lbrakk>\\<And>z.\n                   z \\<in> s \\<Longrightarrow>\n                   (deriv ^^ n) (\\<lambda>w. u * f w) z =\n                   u * (deriv ^^ n) f z;\n        z \\<in> s\\<rbrakk>\n       \\<Longrightarrow> (deriv ^^ Suc n) (\\<lambda>w. u * f w) z =\n                         u * (deriv ^^ Suc n) f z", "finally"], ["proof (chain)\npicking this:\n  deriv ((deriv ^^ n) (\\<lambda>w. u * f w)) z =\n  u * deriv ((deriv ^^ n) f) z", "show ?case"], ["proof (prove)\nusing this:\n  deriv ((deriv ^^ n) (\\<lambda>w. u * f w)) z =\n  u * deriv ((deriv ^^ n) f) z\n\ngoal (1 subgoal):\n 1. (deriv ^^ Suc n) (\\<lambda>w. u * f w) z = u * (deriv ^^ Suc n) f z", "by simp"], ["proof (state)\nthis:\n  (deriv ^^ Suc n) (\\<lambda>w. u * f w) z = u * (deriv ^^ Suc n) f z\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?z \\<in> s \\<Longrightarrow>\n  (deriv ^^ n) (\\<lambda>w. u * f w) ?z = u * (deriv ^^ n) f ?z\n\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "have \"(deriv ^^ n) (\\<lambda>w. f (u * w)) z = u ^ n * (deriv ^^ n) f (u * z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u ^ n * (deriv ^^ n) f (u * z)", "apply (rule higher_deriv_compose_linear [OF holf \\<open>open s\\<close> \\<open>open s\\<close>])"], ["proof (prove)\ngoal (2 subgoals):\n 1. z \\<in> s\n 2. \\<And>w. w \\<in> s \\<Longrightarrow> u * w \\<in> s", "apply (simp add: that)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w. w \\<in> s \\<Longrightarrow> u * w \\<in> s", "apply (simp add: ins that)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u ^ n * (deriv ^^ n) f (u * z)\n\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "moreover"], ["proof (state)\nthis:\n  (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u ^ n * (deriv ^^ n) f (u * z)\n\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "have \"(deriv ^^ n) (\\<lambda>w. f (u * w)) z = u * (deriv ^^ n) f z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u * (deriv ^^ n) f z", "apply (subst higher_deriv_transform_within_open [OF holfuw, of \"\\<lambda>w. u * f w\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. (\\<lambda>w. u * f w) holomorphic_on s\n 2. open s\n 3. z \\<in> s\n 4. \\<And>w. w \\<in> s \\<Longrightarrow> f (u * w) = u * f w\n 5. (deriv ^^ n) (\\<lambda>w. u * f w) z = u * (deriv ^^ n) f z", "apply (rule holomorphic_intros holf assms that)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>w. w \\<in> s \\<Longrightarrow> w \\<in> s\n 2. (deriv ^^ n) (\\<lambda>w. u * f w) z = u * (deriv ^^ n) f z", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. u * f w) z = u * (deriv ^^ n) f z", "using * \\<open>z \\<in> s\\<close>"], ["proof (prove)\nusing this:\n  ?z \\<in> s \\<Longrightarrow>\n  (deriv ^^ n) (\\<lambda>w. u * f w) ?z = u * (deriv ^^ n) f ?z\n  z \\<in> s\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) (\\<lambda>w. u * f w) z = u * (deriv ^^ n) f z", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u * (deriv ^^ n) f z\n\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "ultimately"], ["proof (chain)\npicking this:\n  (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u ^ n * (deriv ^^ n) f (u * z)\n  (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u * (deriv ^^ n) f z", "show ?thesis"], ["proof (prove)\nusing this:\n  (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u ^ n * (deriv ^^ n) f (u * z)\n  (deriv ^^ n) (\\<lambda>w. f (u * w)) z = u * (deriv ^^ n) f z\n\ngoal (1 subgoal):\n 1. u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z", "by metis"], ["proof (state)\nthis:\n  u ^ n * (deriv ^^ n) f (u * z) = u * (deriv ^^ n) f z\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>cmod ?u = 1; ?z \\<in> s\\<rbrakk>\n  \\<Longrightarrow> ?u ^ ?n * (deriv ^^ ?n) f (?u * ?z) =\n                    ?u * (deriv ^^ ?n) f ?z\n\ngoal (1 subgoal):\n 1. \\<exists>c. \\<forall>z\\<in>s. f z = c * z", "have dnf0: \"(deriv ^^ n) f 0 = 0\" if len: \"2 \\<le> n\" for n"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f 0 = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f 0 = 0", "have **: \"z = 0\" if \"\\<And>u::complex. norm u = 1 \\<Longrightarrow> u ^ n * z = u * z\" for z"], ["proof (prove)\ngoal (1 subgoal):\n 1. z = 0", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. z = 0", "have \"\\<exists>u::complex. norm u = 1 \\<and> u ^ n \\<noteq> u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>u. cmod u = 1 \\<and> u ^ n \\<noteq> u", "using complex_not_root_unity [of \"n-1\"] len"], ["proof (prove)\nusing this:\n  1 \\<le> n - 1 \\<Longrightarrow>\n  \\<exists>u. cmod u = 1 \\<and> u ^ (n - 1) \\<noteq> 1\n  2 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<exists>u. cmod u = 1 \\<and> u ^ n \\<noteq> u", "apply (simp add: algebra_simps le_diff_conv2, clarify)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>2 \\<le> n;\n        1 \\<le> n - 1 \\<Longrightarrow>\n        \\<exists>u. cmod u = 1 \\<and> u ^ (n - 1) \\<noteq> 1;\n        2 \\<le> n; cmod u = 1; u ^ (n - Suc 0) \\<noteq> 1\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u. cmod u = 1 \\<and> u ^ n \\<noteq> u", "apply (rule_tac x=u in exI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>u.\n       \\<lbrakk>2 \\<le> n;\n        1 \\<le> n - 1 \\<Longrightarrow>\n        \\<exists>u. cmod u = 1 \\<and> u ^ (n - 1) \\<noteq> 1;\n        2 \\<le> n; cmod u = 1; u ^ (n - Suc 0) \\<noteq> 1\\<rbrakk>\n       \\<Longrightarrow> cmod u = 1 \\<and> u ^ n \\<noteq> u", "apply (subst (asm) power_diff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>u.\n       \\<lbrakk>2 \\<le> n;\n        1 \\<le> n - 1 \\<Longrightarrow>\n        \\<exists>u. cmod u = 1 \\<and> u ^ (n - 1) \\<noteq> 1;\n        2 \\<le> n; cmod u = 1\\<rbrakk>\n       \\<Longrightarrow> u \\<noteq> 0\n 2. \\<And>u.\n       \\<lbrakk>2 \\<le> n;\n        1 \\<le> n - 1 \\<Longrightarrow>\n        \\<exists>u. cmod u = 1 \\<and> u ^ (n - 1) \\<noteq> 1;\n        2 \\<le> n; cmod u = 1\\<rbrakk>\n       \\<Longrightarrow> Suc 0 \\<le> n\n 3. \\<And>u.\n       \\<lbrakk>2 \\<le> n;\n        1 \\<le> n - 1 \\<Longrightarrow>\n        \\<exists>u. cmod u = 1 \\<and> u ^ (n - 1) \\<noteq> 1;\n        2 \\<le> n; cmod u = 1; u ^ n / u ^ Suc 0 \\<noteq> 1\\<rbrakk>\n       \\<Longrightarrow> cmod u = 1 \\<and> u ^ n \\<noteq> u", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>u. cmod u = 1 \\<and> u ^ n \\<noteq> u\n\ngoal (1 subgoal):\n 1. z = 0", "with that"], ["proof (chain)\npicking this:\n  cmod ?u = 1 \\<Longrightarrow> ?u ^ n * z = ?u * z\n  \\<exists>u. cmod u = 1 \\<and> u ^ n \\<noteq> u", "show ?thesis"], ["proof (prove)\nusing this:\n  cmod ?u = 1 \\<Longrightarrow> ?u ^ n * z = ?u * z\n  \\<exists>u. cmod u = 1 \\<and> u ^ n \\<noteq> u\n\ngoal (1 subgoal):\n 1. z = 0", "by auto"], ["proof (state)\nthis:\n  z = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<And>u.\n      cmod u = 1 \\<Longrightarrow> u ^ n * ?z = u * ?z) \\<Longrightarrow>\n  ?z = 0\n\ngoal (1 subgoal):\n 1. (deriv ^^ n) f 0 = 0", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. (deriv ^^ n) f 0 = 0", "apply (rule **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>u.\n       cmod u = 1 \\<Longrightarrow>\n       u ^ n * (deriv ^^ n) f 0 = u * (deriv ^^ n) f 0", "using uneq [OF _ \\<open>0 \\<in> s\\<close>]"], ["proof (prove)\nusing this:\n  cmod ?u = 1 \\<Longrightarrow>\n  ?u ^ ?n * (deriv ^^ ?n) f (?u * 0) = ?u * (deriv ^^ ?n) f 0\n\ngoal (1 subgoal):\n 1. \\<And>u.\n       cmod u = 1 \\<Longrightarrow>\n       u ^ n * (deriv ^^ n) f 0 = u * (deriv ^^ n) f 0", "by force"], ["proof (state)\nthis:\n  (deriv ^^ n) f 0 = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  2 \\<le> ?n \\<Longrightarrow> (deriv ^^ ?n) f 0 = 0\n\ngoal (1 subgoal):\n 1. \\<exists>c. \\<forall>z\\<in>s. f z = c * z", "show ?thesis"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>c. \\<forall>z\\<in>s. f z = c * z", "apply (rule_tac x = \"deriv f 0\" in exI, clarify)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>z. z \\<in> s \\<Longrightarrow> f z = deriv f 0 * z", "apply (rule holomorphic_fun_eq_on_connected [OF holf _ \\<open>open s\\<close> \\<open>connected s\\<close> _ \\<open>0 \\<in> s\\<close>])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>z. z \\<in> s \\<Longrightarrow> (*) (deriv f 0) holomorphic_on s\n 2. \\<And>z n.\n       z \\<in> s \\<Longrightarrow>\n       (deriv ^^ n) f 0 = (deriv ^^ n) ((*) (deriv f 0)) 0\n 3. \\<And>z. z \\<in> s \\<Longrightarrow> z \\<in> s", "using dnf0"], ["proof (prove)\nusing this:\n  2 \\<le> ?n \\<Longrightarrow> (deriv ^^ ?n) f 0 = 0\n\ngoal (3 subgoals):\n 1. \\<And>z. z \\<in> s \\<Longrightarrow> (*) (deriv f 0) holomorphic_on s\n 2. \\<And>z n.\n       z \\<in> s \\<Longrightarrow>\n       (deriv ^^ n) f 0 = (deriv ^^ n) ((*) (deriv f 0)) 0\n 3. \\<And>z. z \\<in> s \\<Longrightarrow> z \\<in> s", "apply (auto simp: holomorphic_on_linear)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  \\<exists>c. \\<forall>z\\<in>s. f z = c * z\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>Should be proved for n-dimensional vectors of complex numbers\\<close>"], ["", "theorem second_Cartan_dim_1:\n  assumes holf: \"f holomorphic_on ball 0 r\"\n      and holg: \"g holomorphic_on ball 0 r\"\n      and [simp]: \"f 0 = 0\" and [simp]: \"g 0 = 0\"\n      and ballf: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> f z \\<in> ball 0 r\"\n      and ballg: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> g z \\<in> ball 0 r\"\n      and fg: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> f (g z) = z\"\n      and gf: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> g (f z) = z\"\n      and \"0 < r\"\n    shows \"\\<exists>t. \\<forall>z \\<in> ball 0 r. g z = exp(\\<i> * of_real t) * z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "have c_le_1: \"c \\<le> 1\"\n    if \"0 \\<le> c\" \"\\<And>x. 0 \\<le> x \\<Longrightarrow> x < r \\<Longrightarrow> c * x < r\" for c"], ["proof (prove)\ngoal (1 subgoal):\n 1. c \\<le> 1", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. c \\<le> 1", "have rst: \"\\<And>r s t::real. 0 = r \\<or> s/r < t \\<or> r < 0 \\<or> \\<not> s < r * t\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r s t. 0 = r \\<or> s / r < t \\<or> r < 0 \\<or> \\<not> s < r * t", "by (metis (no_types) mult_less_cancel_left_disj nonzero_mult_div_cancel_left times_divide_eq_right)"], ["proof (state)\nthis:\n  0 = ?r \\<or> ?s / ?r < ?t \\<or> ?r < 0 \\<or> \\<not> ?s < ?r * ?t\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "{"], ["proof (state)\nthis:\n  0 = ?r \\<or> ?s / ?r < ?t \\<or> ?r < 0 \\<or> \\<not> ?s < ?r * ?t\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "assume \"\\<not> r < c \\<and> c * (c * (c * (c * r))) < 1\""], ["proof (state)\nthis:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "then"], ["proof (chain)\npicking this:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1", "have \"1 \\<le> c \\<Longrightarrow> (\\<exists>r. \\<not> 1 < r \\<and> \\<not> r < c)\""], ["proof (prove)\nusing this:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1\n\ngoal (1 subgoal):\n 1. 1 \\<le> c \\<Longrightarrow> \\<exists>r. \\<not> 1 < r \\<and> \\<not> r < c", "using \\<open>0 \\<le> c\\<close>"], ["proof (prove)\nusing this:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1\n  0 \\<le> c\n\ngoal (1 subgoal):\n 1. 1 \\<le> c \\<Longrightarrow> \\<exists>r. \\<not> 1 < r \\<and> \\<not> r < c", "by (metis (full_types) less_eq_real_def mult.right_neutral mult_left_mono not_less)"], ["proof (state)\nthis:\n  1 \\<le> c \\<Longrightarrow> \\<exists>r. \\<not> 1 < r \\<and> \\<not> r < c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "then"], ["proof (chain)\npicking this:\n  1 \\<le> c \\<Longrightarrow> \\<exists>r. \\<not> 1 < r \\<and> \\<not> r < c", "have \"\\<not> 1 < c \\<or> \\<not> 1 \\<le> c\""], ["proof (prove)\nusing this:\n  1 \\<le> c \\<Longrightarrow> \\<exists>r. \\<not> 1 < r \\<and> \\<not> r < c\n\ngoal (1 subgoal):\n 1. \\<not> 1 < c \\<or> \\<not> 1 \\<le> c", "by linarith"], ["proof (state)\nthis:\n  \\<not> 1 < c \\<or> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "}"], ["proof (state)\nthis:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1 \\<Longrightarrow>\n  \\<not> 1 < c \\<or> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "moreover"], ["proof (state)\nthis:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1 \\<Longrightarrow>\n  \\<not> 1 < c \\<or> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "{"], ["proof (state)\nthis:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1 \\<Longrightarrow>\n  \\<not> 1 < c \\<or> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "have \"\\<not> 0 \\<le> r / c \\<Longrightarrow> \\<not> 1 \\<le> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> 0 \\<le> r / c \\<Longrightarrow> \\<not> 1 \\<le> c", "using \\<open>0 < r\\<close>"], ["proof (prove)\nusing this:\n  0 < r\n\ngoal (1 subgoal):\n 1. \\<not> 0 \\<le> r / c \\<Longrightarrow> \\<not> 1 \\<le> c", "by force"], ["proof (state)\nthis:\n  \\<not> 0 \\<le> r / c \\<Longrightarrow> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "then"], ["proof (chain)\npicking this:\n  \\<not> 0 \\<le> r / c \\<Longrightarrow> \\<not> 1 \\<le> c", "have \"1 < c \\<Longrightarrow> \\<not> 1 \\<le> c\""], ["proof (prove)\nusing this:\n  \\<not> 0 \\<le> r / c \\<Longrightarrow> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. 1 < c \\<Longrightarrow> \\<not> 1 \\<le> c", "using rst \\<open>0 < r\\<close> that"], ["proof (prove)\nusing this:\n  \\<not> 0 \\<le> r / c \\<Longrightarrow> \\<not> 1 \\<le> c\n  0 = ?r \\<or> ?s / ?r < ?t \\<or> ?r < 0 \\<or> \\<not> ?s < ?r * ?t\n  0 < r\n  0 \\<le> c\n  \\<lbrakk>0 \\<le> ?x; ?x < r\\<rbrakk> \\<Longrightarrow> c * ?x < r\n\ngoal (1 subgoal):\n 1. 1 < c \\<Longrightarrow> \\<not> 1 \\<le> c", "by (metis div_by_1 frac_less2 less_le_trans mult.commute not_le order_refl pos_divide_le_eq zero_less_one)"], ["proof (state)\nthis:\n  1 < c \\<Longrightarrow> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "}"], ["proof (state)\nthis:\n  1 < c \\<Longrightarrow> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "ultimately"], ["proof (chain)\npicking this:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1 \\<Longrightarrow>\n  \\<not> 1 < c \\<or> \\<not> 1 \\<le> c\n  1 < c \\<Longrightarrow> \\<not> 1 \\<le> c", "show ?thesis"], ["proof (prove)\nusing this:\n  \\<not> r < c \\<and> c * (c * (c * (c * r))) < 1 \\<Longrightarrow>\n  \\<not> 1 < c \\<or> \\<not> 1 \\<le> c\n  1 < c \\<Longrightarrow> \\<not> 1 \\<le> c\n\ngoal (1 subgoal):\n 1. c \\<le> 1", "by (metis (no_types) linear not_less)"], ["proof (state)\nthis:\n  c \\<le> 1\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?c;\n   \\<And>x.\n      \\<lbrakk>0 \\<le> x; x < r\\<rbrakk>\n      \\<Longrightarrow> ?c * x < r\\<rbrakk>\n  \\<Longrightarrow> ?c \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "have ugeq: \"u * g z = g (u * z)\" if nou: \"norm u = 1\" and z: \"z \\<in> ball 0 r\" for u z"], ["proof (prove)\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have [simp]: \"u \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> 0", "using that"], ["proof (prove)\nusing this:\n  cmod u = 1\n  z \\<in> ball 0 r\n\ngoal (1 subgoal):\n 1. u \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  u \\<noteq> 0\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have hol1: \"(\\<lambda>a. f (u * g a) / u) holomorphic_on ball 0 r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>a. f (u * g a) / u) holomorphic_on ball 0 r", "apply (rule holomorphic_intros)"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<lambda>z. f (u * g z)) holomorphic_on ball 0 r\n 2. (\\<lambda>z. u) holomorphic_on ball 0 r\n 3. \\<And>a. a \\<in> ball 0 r \\<Longrightarrow> u \\<noteq> 0", "apply (rule holomorphic_on_compose_gen [OF _ holf, unfolded o_def])"], ["proof (prove)\ngoal (4 subgoals):\n 1. (\\<lambda>x. u * g x) holomorphic_on ball 0 r\n 2. (\\<lambda>x. u * g x) ` ball 0 r \\<subseteq> ball 0 r\n 3. (\\<lambda>z. u) holomorphic_on ball 0 r\n 4. \\<And>a. a \\<in> ball 0 r \\<Longrightarrow> u \\<noteq> 0", "apply (rule holomorphic_intros holg)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<lambda>x. u * g x) ` ball 0 r \\<subseteq> ball 0 r\n 2. (\\<lambda>z. u) holomorphic_on ball 0 r\n 3. \\<And>a. a \\<in> ball 0 r \\<Longrightarrow> u \\<noteq> 0", "using nou ballg"], ["proof (prove)\nusing this:\n  cmod u = 1\n  ?z \\<in> ball 0 r \\<Longrightarrow> g ?z \\<in> ball 0 r\n\ngoal (3 subgoals):\n 1. (\\<lambda>x. u * g x) ` ball 0 r \\<subseteq> ball 0 r\n 2. (\\<lambda>z. u) holomorphic_on ball 0 r\n 3. \\<And>a. a \\<in> ball 0 r \\<Longrightarrow> u \\<noteq> 0", "apply (auto simp: dist_norm norm_mult holomorphic_on_const)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<lambda>a. f (u * g a) / u) holomorphic_on ball 0 r\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have cdf: \"f field_differentiable at 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f field_differentiable at 0", "using \\<open>0 < r\\<close> holf holomorphic_on_imp_differentiable_at"], ["proof (prove)\nusing this:\n  0 < r\n  f holomorphic_on ball 0 r\n  \\<lbrakk>?f holomorphic_on ?s; open ?s; ?x \\<in> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f field_differentiable at ?x\n\ngoal (1 subgoal):\n 1. f field_differentiable at 0", "by auto"], ["proof (state)\nthis:\n  f field_differentiable at 0\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have cdg: \"g field_differentiable at 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g field_differentiable at 0", "using \\<open>0 < r\\<close> holg holomorphic_on_imp_differentiable_at"], ["proof (prove)\nusing this:\n  0 < r\n  g holomorphic_on ball 0 r\n  \\<lbrakk>?f holomorphic_on ?s; open ?s; ?x \\<in> ?s\\<rbrakk>\n  \\<Longrightarrow> ?f field_differentiable at ?x\n\ngoal (1 subgoal):\n 1. g field_differentiable at 0", "by auto"], ["proof (state)\nthis:\n  g field_differentiable at 0\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have cd_fug: \"(\\<lambda>a. f (u * g a)) field_differentiable at 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<lambda>a. f (u * g a)) field_differentiable at 0", "apply (rule field_differentiable_compose [where g=f and f = \"\\<lambda>a. (u * g a)\", unfolded o_def])"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<lambda>a. u * g a) field_differentiable at 0\n 2. f field_differentiable at (u * g 0)", "apply (rule derivative_intros)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. g field_differentiable at 0\n 2. f field_differentiable at (u * g 0)", "using cdf cdg"], ["proof (prove)\nusing this:\n  f field_differentiable at 0\n  g field_differentiable at 0\n\ngoal (2 subgoals):\n 1. g field_differentiable at 0\n 2. f field_differentiable at (u * g 0)", "apply auto"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  (\\<lambda>a. f (u * g a)) field_differentiable at 0\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have \"deriv g 0 = deriv g (f 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv g 0 = deriv g (f 0)", "by simp"], ["proof (state)\nthis:\n  deriv g 0 = deriv g (f 0)\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "then"], ["proof (chain)\npicking this:\n  deriv g 0 = deriv g (f 0)", "have \"deriv f 0 * deriv g 0 = 1\""], ["proof (prove)\nusing this:\n  deriv g 0 = deriv g (f 0)\n\ngoal (1 subgoal):\n 1. deriv f 0 * deriv g 0 = 1", "by (metis open_ball \\<open>0 < r\\<close> ballf centre_in_ball deriv_left_inverse gf holf holg image_subsetI)"], ["proof (state)\nthis:\n  deriv f 0 * deriv g 0 = 1\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "then"], ["proof (chain)\npicking this:\n  deriv f 0 * deriv g 0 = 1", "have equ: \"deriv f 0 * deriv (\\<lambda>a. u * g a) 0 = u\""], ["proof (prove)\nusing this:\n  deriv f 0 * deriv g 0 = 1\n\ngoal (1 subgoal):\n 1. deriv f 0 * deriv (\\<lambda>a. u * g a) 0 = u", "by (simp add: cdg deriv_cmult)"], ["proof (state)\nthis:\n  deriv f 0 * deriv (\\<lambda>a. u * g a) 0 = u\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have der1: \"deriv (\\<lambda>a. f (u * g a) / u) 0 = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv (\\<lambda>a. f (u * g a) / u) 0 = 1", "apply (simp add: field_class.field_divide_inverse deriv_cmult_right [OF cd_fug])"], ["proof (prove)\ngoal (1 subgoal):\n 1. deriv (\\<lambda>a. f (u * g a)) 0 * inverse u = 1", "apply (subst deriv_chain [where g=f and f = \"\\<lambda>a. (u * g a)\", unfolded o_def])"], ["proof (prove)\ngoal (3 subgoals):\n 1. (\\<lambda>a. u * g a) field_differentiable at 0\n 2. f field_differentiable at (u * g 0)\n 3. deriv f (u * g 0) * deriv (\\<lambda>a. u * g a) 0 * inverse u = 1", "apply (rule derivative_intros cdf cdg | simp add: equ)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  deriv (\\<lambda>a. f (u * g a) / u) 0 = 1\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have fugeq: \"\\<And>w. w \\<in> ball 0 r \\<Longrightarrow> f (u * g w) / u = w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w. w \\<in> ball 0 r \\<Longrightarrow> f (u * g w) / u = w", "apply (rule first_Cartan_dim_1 [OF hol1, where z=0])"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>w. w \\<in> ball 0 r \\<Longrightarrow> open (ball 0 r)\n 2. \\<And>w. w \\<in> ball 0 r \\<Longrightarrow> connected (ball 0 r)\n 3. \\<And>w. w \\<in> ball 0 r \\<Longrightarrow> bounded (ball 0 r)\n 4. \\<And>w.\n       w \\<in> ball 0 r \\<Longrightarrow>\n       (\\<lambda>a. f (u * g a) / u) ` ball 0 r \\<subseteq> ball 0 r\n 5. \\<And>w. w \\<in> ball 0 r \\<Longrightarrow> 0 \\<in> ball 0 r\n 6. \\<And>w. w \\<in> ball 0 r \\<Longrightarrow> f (u * g 0) / u = 0\n 7. \\<And>w.\n       w \\<in> ball 0 r \\<Longrightarrow>\n       deriv (\\<lambda>a. f (u * g a) / u) 0 = 1\n 8. \\<And>w. w \\<in> ball 0 r \\<Longrightarrow> w \\<in> ball 0 r", "apply (simp_all add: \\<open>0 < r\\<close>)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>w.\n       cmod w < r \\<Longrightarrow>\n       (\\<lambda>a. f (u * g a) / u) ` ball 0 r \\<subseteq> ball 0 r\n 2. \\<And>w.\n       cmod w < r \\<Longrightarrow>\n       deriv (\\<lambda>a. f (u * g a) / u) 0 = 1", "apply (auto simp: der1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>w a.\n       \\<lbrakk>cmod w < r; cmod a < r\\<rbrakk>\n       \\<Longrightarrow> cmod (f (u * g a) / u) < r", "using nou ballf ballg"], ["proof (prove)\nusing this:\n  cmod u = 1\n  ?z \\<in> ball 0 r \\<Longrightarrow> f ?z \\<in> ball 0 r\n  ?z \\<in> ball 0 r \\<Longrightarrow> g ?z \\<in> ball 0 r\n\ngoal (1 subgoal):\n 1. \\<And>w a.\n       \\<lbrakk>cmod w < r; cmod a < r\\<rbrakk>\n       \\<Longrightarrow> cmod (f (u * g a) / u) < r", "apply (simp add: dist_norm norm_mult norm_divide)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ?w \\<in> ball 0 r \\<Longrightarrow> f (u * g ?w) / u = ?w\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have \"f(u * g z) = u * z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (u * g z) = u * z", "by (metis \\<open>u \\<noteq> 0\\<close> fugeq nonzero_mult_div_cancel_left z times_divide_eq_right)"], ["proof (state)\nthis:\n  f (u * g z) = u * z\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "also"], ["proof (state)\nthis:\n  f (u * g z) = u * z\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "have \"... = f (g (u * z))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u * z = f (g (u * z))", "by (metis (no_types, lifting) fg mem_ball_0 mult_cancel_right2 norm_mult nou z)"], ["proof (state)\nthis:\n  u * z = f (g (u * z))\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "finally"], ["proof (chain)\npicking this:\n  f (u * g z) = f (g (u * z))", "have \"f(u * g z) = f (g (u * z))\""], ["proof (prove)\nusing this:\n  f (u * g z) = f (g (u * z))\n\ngoal (1 subgoal):\n 1. f (u * g z) = f (g (u * z))", "."], ["proof (state)\nthis:\n  f (u * g z) = f (g (u * z))\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "then"], ["proof (chain)\npicking this:\n  f (u * g z) = f (g (u * z))", "have \"g (f (u * g z)) = g (f (g (u * z)))\""], ["proof (prove)\nusing this:\n  f (u * g z) = f (g (u * z))\n\ngoal (1 subgoal):\n 1. g (f (u * g z)) = g (f (g (u * z)))", "by simp"], ["proof (state)\nthis:\n  g (f (u * g z)) = g (f (g (u * z)))\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "then"], ["proof (chain)\npicking this:\n  g (f (u * g z)) = g (f (g (u * z)))", "show ?thesis"], ["proof (prove)\nusing this:\n  g (f (u * g z)) = g (f (g (u * z)))\n\ngoal (1 subgoal):\n 1. u * g z = g (u * z)", "apply (subst (asm) gf)"], ["proof (prove)\ngoal (2 subgoals):\n 1. u * g z \\<in> ball 0 r\n 2. u * g z = g (f (g (u * z))) \\<Longrightarrow> u * g z = g (u * z)", "apply (simp add: dist_norm norm_mult nou)"], ["proof (prove)\ngoal (2 subgoals):\n 1. cmod (g z) < r\n 2. u * g z = g (f (g (u * z))) \\<Longrightarrow> u * g z = g (u * z)", "using ballg mem_ball_0 z"], ["proof (prove)\nusing this:\n  ?z \\<in> ball 0 r \\<Longrightarrow> g ?z \\<in> ball 0 r\n  (?x \\<in> ball (0::?'a) ?e) = (norm ?x < ?e)\n  z \\<in> ball 0 r\n\ngoal (2 subgoals):\n 1. cmod (g z) < r\n 2. u * g z = g (f (g (u * z))) \\<Longrightarrow> u * g z = g (u * z)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. u * g z = g (f (g (u * z))) \\<Longrightarrow> u * g z = g (u * z)", "apply (subst (asm) gf)"], ["proof (prove)\ngoal (2 subgoals):\n 1. g (u * z) \\<in> ball 0 r\n 2. u * g z = g (u * z) \\<Longrightarrow> u * g z = g (u * z)", "apply (simp add: dist_norm norm_mult nou)"], ["proof (prove)\ngoal (2 subgoals):\n 1. cmod (g (u * z)) < r\n 2. u * g z = g (u * z) \\<Longrightarrow> u * g z = g (u * z)", "apply (metis ballg mem_ball_0 mult.left_neutral norm_mult nou z, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  u * g z = g (u * z)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>cmod ?u = 1; ?z \\<in> ball 0 r\\<rbrakk>\n  \\<Longrightarrow> ?u * g ?z = g (?u * ?z)\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "obtain c where c: \"\\<And>z. z \\<in> ball 0 r \\<Longrightarrow> g z = c * z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>c.\n        (\\<And>z.\n            z \\<in> ball 0 r \\<Longrightarrow>\n            g z = c * z) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "apply (rule exE [OF Cartan_is_linear [OF holg]])"], ["proof (prove)\ngoal (6 subgoals):\n 1. (\\<And>c.\n        (\\<And>z.\n            z \\<in> ball 0 r \\<Longrightarrow>\n            g z = c * z) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    open (ball 0 r)\n 2. (\\<And>c.\n        (\\<And>z.\n            z \\<in> ball 0 r \\<Longrightarrow>\n            g z = c * z) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    connected (ball 0 r)\n 3. (\\<And>c.\n        (\\<And>z.\n            z \\<in> ball 0 r \\<Longrightarrow>\n            g z = c * z) \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    0 \\<in> ball 0 r\n 4. \\<And>u z.\n       \\<lbrakk>\\<And>c.\n                   (\\<And>z.\n                       z \\<in> ball 0 r \\<Longrightarrow>\n                       g z = c * z) \\<Longrightarrow>\n                   thesis;\n        cmod u = 1; z \\<in> ball 0 r\\<rbrakk>\n       \\<Longrightarrow> u * z \\<in> ball 0 r\n 5. \\<And>u z.\n       \\<lbrakk>\\<And>c.\n                   (\\<And>z.\n                       z \\<in> ball 0 r \\<Longrightarrow>\n                       g z = c * z) \\<Longrightarrow>\n                   thesis;\n        cmod u = 1; z \\<in> ball 0 r\\<rbrakk>\n       \\<Longrightarrow> g (u * z) = u * g z\n 6. \\<And>x.\n       \\<lbrakk>\\<And>c.\n                   (\\<And>z.\n                       z \\<in> ball 0 r \\<Longrightarrow>\n                       g z = c * z) \\<Longrightarrow>\n                   thesis;\n        \\<forall>z\\<in>ball 0 r. g z = x * z\\<rbrakk>\n       \\<Longrightarrow> thesis", "apply (simp_all add: \\<open>0 < r\\<close> ugeq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>u z.\n       \\<lbrakk>\\<And>c.\n                   (\\<And>z.\n                       cmod z < r \\<Longrightarrow>\n                       g z = c * z) \\<Longrightarrow>\n                   thesis;\n        cmod u = 1; cmod z < r\\<rbrakk>\n       \\<Longrightarrow> cmod (u * z) < r\n 2. \\<And>x.\n       \\<lbrakk>\\<And>c.\n                   (\\<And>z.\n                       cmod z < r \\<Longrightarrow>\n                       z = 0 \\<or> x = c) \\<Longrightarrow>\n                   thesis;\n        \\<forall>z\\<in>ball 0 r. g z = x * z\\<rbrakk>\n       \\<Longrightarrow> thesis", "apply (auto simp: dist_norm norm_mult)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  ?z \\<in> ball 0 r \\<Longrightarrow> g ?z = c * ?z\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "have gr2: \"g (f (r/2)) = c * f(r/2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. g (f (complex_of_real (r / 2))) = c * f (complex_of_real (r / 2))", "apply (rule c)"], ["proof (prove)\ngoal (1 subgoal):\n 1. f (complex_of_real (r / 2)) \\<in> ball 0 r", "using \\<open>0 < r\\<close> ballf mem_ball_0"], ["proof (prove)\nusing this:\n  0 < r\n  ?z \\<in> ball 0 r \\<Longrightarrow> f ?z \\<in> ball 0 r\n  (?x \\<in> ball (0::?'a) ?e) = (norm ?x < ?e)\n\ngoal (1 subgoal):\n 1. f (complex_of_real (r / 2)) \\<in> ball 0 r", "by force"], ["proof (state)\nthis:\n  g (f (complex_of_real (r / 2))) = c * f (complex_of_real (r / 2))\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "then"], ["proof (chain)\npicking this:\n  g (f (complex_of_real (r / 2))) = c * f (complex_of_real (r / 2))", "have \"norm c > 0\""], ["proof (prove)\nusing this:\n  g (f (complex_of_real (r / 2))) = c * f (complex_of_real (r / 2))\n\ngoal (1 subgoal):\n 1. 0 < cmod c", "using \\<open>0 < r\\<close>"], ["proof (prove)\nusing this:\n  g (f (complex_of_real (r / 2))) = c * f (complex_of_real (r / 2))\n  0 < r\n\ngoal (1 subgoal):\n 1. 0 < cmod c", "by simp (metis \\<open>f 0 = 0\\<close> c dist_commute fg mem_ball mult_zero_left perfect_choose_dist)"], ["proof (state)\nthis:\n  0 < cmod c\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "then"], ["proof (chain)\npicking this:\n  0 < cmod c", "have [simp]: \"c \\<noteq> 0\""], ["proof (prove)\nusing this:\n  0 < cmod c\n\ngoal (1 subgoal):\n 1. c \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  c \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "have xless: \"x < r * cmod c\" if \"0 \\<le> x\" \"x < r\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. x < r * cmod c", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. x < r * cmod c", "have \"x = norm (g (f (of_real x)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = cmod (g (f (complex_of_real x)))", "proof -"], ["proof (state)\ngoal (1 subgoal):\n 1. x = cmod (g (f (complex_of_real x)))", "have \"r > cmod (of_real x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (complex_of_real x) < r", "by (simp add: that)"], ["proof (state)\nthis:\n  cmod (complex_of_real x) < r\n\ngoal (1 subgoal):\n 1. x = cmod (g (f (complex_of_real x)))", "then"], ["proof (chain)\npicking this:\n  cmod (complex_of_real x) < r", "have \"complex_of_real x \\<in> ball 0 r\""], ["proof (prove)\nusing this:\n  cmod (complex_of_real x) < r\n\ngoal (1 subgoal):\n 1. complex_of_real x \\<in> ball 0 r", "using mem_ball_0"], ["proof (prove)\nusing this:\n  cmod (complex_of_real x) < r\n  (?x \\<in> ball (0::?'a) ?e) = (norm ?x < ?e)\n\ngoal (1 subgoal):\n 1. complex_of_real x \\<in> ball 0 r", "by blast"], ["proof (state)\nthis:\n  complex_of_real x \\<in> ball 0 r\n\ngoal (1 subgoal):\n 1. x = cmod (g (f (complex_of_real x)))", "then"], ["proof (chain)\npicking this:\n  complex_of_real x \\<in> ball 0 r", "show ?thesis"], ["proof (prove)\nusing this:\n  complex_of_real x \\<in> ball 0 r\n\ngoal (1 subgoal):\n 1. x = cmod (g (f (complex_of_real x)))", "using gf \\<open>0 \\<le> x\\<close>"], ["proof (prove)\nusing this:\n  complex_of_real x \\<in> ball 0 r\n  ?z \\<in> ball 0 r \\<Longrightarrow> g (f ?z) = ?z\n  0 \\<le> x\n\ngoal (1 subgoal):\n 1. x = cmod (g (f (complex_of_real x)))", "by force"], ["proof (state)\nthis:\n  x = cmod (g (f (complex_of_real x)))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x = cmod (g (f (complex_of_real x)))\n\ngoal (1 subgoal):\n 1. x < r * cmod c", "then"], ["proof (chain)\npicking this:\n  x = cmod (g (f (complex_of_real x)))", "show ?thesis"], ["proof (prove)\nusing this:\n  x = cmod (g (f (complex_of_real x)))\n\ngoal (1 subgoal):\n 1. x < r * cmod c", "apply (rule ssubst)"], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (g (f (complex_of_real x))) < r * cmod c", "apply (subst c)"], ["proof (prove)\ngoal (2 subgoals):\n 1. f (complex_of_real x) \\<in> ball 0 r\n 2. cmod (c * f (complex_of_real x)) < r * cmod c", "apply (rule ballf)"], ["proof (prove)\ngoal (2 subgoals):\n 1. complex_of_real x \\<in> ball 0 r\n 2. cmod (c * f (complex_of_real x)) < r * cmod c", "using ballf [of x] that"], ["proof (prove)\nusing this:\n  complex_of_real x \\<in> ball 0 r \\<Longrightarrow>\n  f (complex_of_real x) \\<in> ball 0 r\n  0 \\<le> x\n  x < r\n\ngoal (2 subgoals):\n 1. complex_of_real x \\<in> ball 0 r\n 2. cmod (c * f (complex_of_real x)) < r * cmod c", "apply (auto simp: norm_mult dist_0_norm)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  x < r * cmod c\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?x; ?x < r\\<rbrakk> \\<Longrightarrow> ?x < r * cmod c\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "have 11: \"1 / norm c \\<le> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 / cmod c \\<le> 1", "apply (rule c_le_1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 0 \\<le> 1 / cmod c\n 2. \\<And>x.\n       \\<lbrakk>0 \\<le> x; x < r\\<rbrakk>\n       \\<Longrightarrow> 1 / cmod c * x < r", "using xless"], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?x; ?x < r\\<rbrakk> \\<Longrightarrow> ?x < r * cmod c\n\ngoal (2 subgoals):\n 1. 0 \\<le> 1 / cmod c\n 2. \\<And>x.\n       \\<lbrakk>0 \\<le> x; x < r\\<rbrakk>\n       \\<Longrightarrow> 1 / cmod c * x < r", "apply (auto simp: divide_simps)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["proof (state)\nthis:\n  1 / cmod c \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "have \"\\<lbrakk>0 \\<le> x; x < r\\<rbrakk> \\<Longrightarrow> cmod c * x < r\" for x"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> x; x < r\\<rbrakk> \\<Longrightarrow> cmod c * x < r", "using c [of x] ballg [of x]"], ["proof (prove)\nusing this:\n  complex_of_real x \\<in> ball 0 r \\<Longrightarrow>\n  g (complex_of_real x) = c * complex_of_real x\n  complex_of_real x \\<in> ball 0 r \\<Longrightarrow>\n  g (complex_of_real x) \\<in> ball 0 r\n\ngoal (1 subgoal):\n 1. \\<lbrakk>0 \\<le> x; x < r\\<rbrakk> \\<Longrightarrow> cmod c * x < r", "by (auto simp: norm_mult dist_0_norm)"], ["proof (state)\nthis:\n  \\<lbrakk>0 \\<le> ?x; ?x < r\\<rbrakk> \\<Longrightarrow> cmod c * ?x < r\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>0 \\<le> ?x; ?x < r\\<rbrakk> \\<Longrightarrow> cmod c * ?x < r", "have \"norm c \\<le> 1\""], ["proof (prove)\nusing this:\n  \\<lbrakk>0 \\<le> ?x; ?x < r\\<rbrakk> \\<Longrightarrow> cmod c * ?x < r\n\ngoal (1 subgoal):\n 1. cmod c \\<le> 1", "by (force intro: c_le_1)"], ["proof (state)\nthis:\n  cmod c \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "moreover"], ["proof (state)\nthis:\n  cmod c \\<le> 1\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "have \"1 \\<le> norm c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> cmod c", "using 11"], ["proof (prove)\nusing this:\n  1 / cmod c \\<le> 1\n\ngoal (1 subgoal):\n 1. 1 \\<le> cmod c", "by simp"], ["proof (state)\nthis:\n  1 \\<le> cmod c\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "ultimately"], ["proof (chain)\npicking this:\n  cmod c \\<le> 1\n  1 \\<le> cmod c", "have \"norm c = 1\""], ["proof (prove)\nusing this:\n  cmod c \\<le> 1\n  1 \\<le> cmod c\n\ngoal (1 subgoal):\n 1. cmod c = 1", "by (rule antisym)"], ["proof (state)\nthis:\n  cmod c = 1\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "with complex_norm_eq_1_exp c"], ["proof (chain)\npicking this:\n  (cmod ?z = 1) = (exp (\\<i> * complex_of_real (Arg2pi ?z)) = ?z)\n  ?z \\<in> ball 0 r \\<Longrightarrow> g ?z = c * ?z\n  cmod c = 1", "show ?thesis"], ["proof (prove)\nusing this:\n  (cmod ?z = 1) = (exp (\\<i> * complex_of_real (Arg2pi ?z)) = ?z)\n  ?z \\<in> ball 0 r \\<Longrightarrow> g ?z = c * ?z\n  cmod c = 1\n\ngoal (1 subgoal):\n 1. \\<exists>t.\n       \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z", "by metis"], ["proof (state)\nthis:\n  \\<exists>t.\n     \\<forall>z\\<in>ball 0 r. g z = exp (\\<i> * complex_of_real t) * z\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}