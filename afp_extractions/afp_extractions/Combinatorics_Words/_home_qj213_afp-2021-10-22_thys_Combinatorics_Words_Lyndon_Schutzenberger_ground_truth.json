{"file_name": "/home/qj213/afp-2021-10-22/thys/Combinatorics_Words/Lyndon_Schutzenberger.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Combinatorics_Words", "problem_names": ["lemma a0: \"a \\<noteq> 0\" and b0: \"b \\<noteq> 0\"", "lemma per_lemma_case:\n  assumes \"\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\"\n  shows \"x\\<cdot>y=y\\<cdot>x\"", "lemma core_case:\n  assumes \n    \"c = 3\" and \n    \"b*\\<^bold>|y\\<^bold>| \\<le> a*\\<^bold>|x\\<^bold>|\" and \"x \\<noteq> \\<epsilon>\" and \"y \\<noteq> \\<epsilon>\" and \n    lenx: \"a*\\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\" and\n    leny: \"b*\\<^bold>|y\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\"\n  shows \"x\\<cdot>y = y\\<cdot>x\"", "lemma Lyndon_Schutzenberger':\n  \"\\<lbrakk> x\\<^sup>@a\\<cdot>y\\<^sup>@b = z\\<^sup>@c;  2 \\<le> a;  2 \\<le> b; 2 \\<le> c \\<rbrakk>\n  \\<Longrightarrow> x\\<cdot>y = y\\<cdot>x\"", "theorem Lyndon_Schutzenberger:\n  assumes \"x\\<^sup>@a\\<cdot>y\\<^sup>@b = z\\<^sup>@c\" and  \"2 \\<le> a\"  and \"2 \\<le> b\" and \"2 \\<le> c\"\n  shows  \"x\\<cdot>y = y\\<cdot>x\" and \"x\\<cdot>z = z\\<cdot>x\" and \"y\\<cdot>z = z\\<cdot>y\""], "translations": [["", "lemma a0: \"a \\<noteq> 0\" and b0: \"b \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 &&& b \\<noteq> 0", "using a b"], ["proof (prove)\nusing this:\n  2 \\<le> a\n  2 \\<le> b\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 &&& b \\<noteq> 0", "by auto"], ["", "text\\<open>If $x^a$ or $y^b$ is sufficiently long, then the calim follows from the Periodicity Lemma.\\<close>"], ["", "lemma per_lemma_case:\n  assumes \"\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\"\n  shows \"x\\<cdot>y=y\\<cdot>x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "proof (cases \"x = \\<epsilon>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. x = \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x\n 2. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "assume \"x = \\<epsilon>\""], ["proof (state)\nthis:\n  x = \\<epsilon>\n\ngoal (2 subgoals):\n 1. x = \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x\n 2. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "thus \"x\\<cdot>y=y\\<cdot>x\""], ["proof (prove)\nusing this:\n  x = \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "by simp"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "assume \"x \\<noteq> \\<epsilon>\""], ["proof (state)\nthis:\n  x \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"z\\<^sup>@c \\<noteq> \\<epsilon>\""], ["proof (prove)\nusing this:\n  x \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. z \\<^sup>@ c \\<noteq> \\<epsilon>", "using eq assms emp_pow[of c]"], ["proof (prove)\nusing this:\n  x \\<noteq> \\<epsilon>\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n  \\<epsilon> \\<^sup>@ c = \\<epsilon>\n\ngoal (1 subgoal):\n 1. z \\<^sup>@ c \\<noteq> \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  z \\<^sup>@ c \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"x\\<^sup>@a \\<le>p (z\\<^sup>@c)\\<^sup>\\<omega>\""], ["proof (prove)\nusing this:\n  z \\<^sup>@ c \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<le>p z \\<^sup>@ c\\<^sup>\\<omega>", "unfolding period_root_def"], ["proof (prove)\nusing this:\n  z \\<^sup>@ c \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<le>p z \\<^sup>@ c \\<cdot> x \\<^sup>@ a \\<and>\n    z \\<^sup>@ c \\<noteq> \\<epsilon>", "using \n    pref_ext[OF triv_pref[of \"x\\<^sup>@a\" \"y\\<^sup>@b\", unfolded eq], of \"x\\<^sup>@a\"]"], ["proof (prove)\nusing this:\n  z \\<^sup>@ c \\<noteq> \\<epsilon>\n  x \\<^sup>@ a \\<le>p z \\<^sup>@ c \\<cdot> x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<le>p z \\<^sup>@ c \\<cdot> x \\<^sup>@ a \\<and>\n    z \\<^sup>@ c \\<noteq> \\<epsilon>", "by blast"], ["proof (state)\nthis:\n  x \\<^sup>@ a \\<le>p z \\<^sup>@ c\\<^sup>\\<omega>\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have \"x \\<^sup>@ a \\<le>p x\\<^sup>\\<omega>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<le>p x\\<^sup>\\<omega>", "using \\<open>x \\<noteq> \\<epsilon>\\<close> a0 root_self[THEN per_drop_exp]"], ["proof (prove)\nusing this:\n  x \\<noteq> \\<epsilon>\n  a \\<noteq> 0\n  ?r \\<^sup>@ ?m \\<noteq> \\<epsilon> \\<Longrightarrow>\n  ?r \\<^sup>@ ?m \\<le>p ?r\\<^sup>\\<omega>\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<le>p x\\<^sup>\\<omega>", "by blast"], ["proof (state)\nthis:\n  x \\<^sup>@ a \\<le>p x\\<^sup>\\<omega>\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from two_pers[OF per_drop_exp[OF \\<open>x\\<^sup>@a \\<le>p (z\\<^sup>@c)\\<^sup>\\<omega>\\<close>] this assms]"], ["proof (chain)\npicking this:\n  z \\<cdot> x = x \\<cdot> z", "have \"z \\<cdot> x = x \\<cdot> z\""], ["proof (prove)\nusing this:\n  z \\<cdot> x = x \\<cdot> z\n\ngoal (1 subgoal):\n 1. z \\<cdot> x = x \\<cdot> z", "."], ["proof (state)\nthis:\n  z \\<cdot> x = x \\<cdot> z\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"z\\<^sup>@c\\<cdot>x\\<^sup>@a = x\\<^sup>@a\\<cdot>z\\<^sup>@c\""], ["proof (prove)\nusing this:\n  z \\<cdot> x = x \\<cdot> z\n\ngoal (1 subgoal):\n 1. z \\<^sup>@ c \\<cdot> x \\<^sup>@ a = x \\<^sup>@ a \\<cdot> z \\<^sup>@ c", "by (simp add: comm_add_exps)"], ["proof (state)\nthis:\n  z \\<^sup>@ c \\<cdot> x \\<^sup>@ a = x \\<^sup>@ a \\<cdot> z \\<^sup>@ c\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from this[folded eq, unfolded rassoc cancel, symmetric]"], ["proof (chain)\npicking this:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a", "have \"x\\<^sup>@a \\<cdot> y\\<^sup>@b = y\\<^sup>@b \\<cdot> x\\<^sup>@a\""], ["proof (prove)\nusing this:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a", "."], ["proof (state)\nthis:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from this[unfolded comm_pow_roots[OF a0 b0]]"], ["proof (chain)\npicking this:\n  x \\<cdot> y = y \\<cdot> x", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\nusing this:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "."], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal:\nNo subgoals!", "qed"], ["", "text\\<open>The most challenging case is when $c = 3$.\\<close>"], ["", "lemma core_case:\n  assumes \n    \"c = 3\" and \n    \"b*\\<^bold>|y\\<^bold>| \\<le> a*\\<^bold>|x\\<^bold>|\" and \"x \\<noteq> \\<epsilon>\" and \"y \\<noteq> \\<epsilon>\" and \n    lenx: \"a*\\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\" and\n    leny: \"b*\\<^bold>|y\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\"\n  shows \"x\\<cdot>y = y\\<cdot>x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"a \\<noteq> 0\" and \"b \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 &&& b \\<noteq> 0", "using a b"], ["proof (prove)\nusing this:\n  2 \\<le> a\n  2 \\<le> b\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 &&& b \\<noteq> 0", "by auto\n\n  \\<comment>\\<open>We first show that a = 2\\<close>"], ["proof (state)\nthis:\n  a \\<noteq> 0\n  b \\<noteq> 0\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"a*\\<^bold>|x\\<^bold>|+b*\\<^bold>|y\\<^bold>| = 3*\\<^bold>|z\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n    3 * \\<^bold>|z\\<^bold>|", "using \\<open>c = 3\\<close> eq length_append[of \"x\\<^sup>@a\" \"y\\<^sup>@b\"]"], ["proof (prove)\nusing this:\n  c = 3\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c\n  \\<^bold>|x \\<^sup>@ a \\<cdot> y \\<^sup>@ b\\<^bold>| =\n  \\<^bold>|x \\<^sup>@ a\\<^bold>| + \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (1 subgoal):\n 1. a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n    3 * \\<^bold>|z\\<^bold>|", "by (simp add: pow_len)"], ["proof (state)\nthis:\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n  3 * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"3*\\<^bold>|z\\<^bold>| \\<le> a*\\<^bold>|x\\<^bold>| + a*\\<^bold>|x\\<^bold>|\""], ["proof (prove)\nusing this:\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n  3 * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. 3 * \\<^bold>|z\\<^bold>|\n    \\<le> a * \\<^bold>|x\\<^bold>| + a * \\<^bold>|x\\<^bold>|", "using \\<open>b*\\<^bold>|y\\<^bold>| \\<le> a*\\<^bold>|x\\<^bold>|\\<close>"], ["proof (prove)\nusing this:\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n  3 * \\<^bold>|z\\<^bold>|\n  b * \\<^bold>|y\\<^bold>| \\<le> a * \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. 3 * \\<^bold>|z\\<^bold>|\n    \\<le> a * \\<^bold>|x\\<^bold>| + a * \\<^bold>|x\\<^bold>|", "by simp"], ["proof (state)\nthis:\n  3 * \\<^bold>|z\\<^bold>|\n  \\<le> a * \\<^bold>|x\\<^bold>| + a * \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"3*\\<^bold>|z\\<^bold>| < 2*\\<^bold>|z\\<^bold>| + 2*\\<^bold>|x\\<^bold>|\""], ["proof (prove)\nusing this:\n  3 * \\<^bold>|z\\<^bold>|\n  \\<le> a * \\<^bold>|x\\<^bold>| + a * \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. 3 * \\<^bold>|z\\<^bold>|\n    < 2 * \\<^bold>|z\\<^bold>| + 2 * \\<^bold>|x\\<^bold>|", "using lenx"], ["proof (prove)\nusing this:\n  3 * \\<^bold>|z\\<^bold>|\n  \\<le> a * \\<^bold>|x\\<^bold>| + a * \\<^bold>|x\\<^bold>|\n  a * \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. 3 * \\<^bold>|z\\<^bold>|\n    < 2 * \\<^bold>|z\\<^bold>| + 2 * \\<^bold>|x\\<^bold>|", "by linarith"], ["proof (state)\nthis:\n  3 * \\<^bold>|z\\<^bold>|\n  < 2 * \\<^bold>|z\\<^bold>| + 2 * \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| < 3 * \\<^bold>|x\\<^bold>|\""], ["proof (prove)\nusing this:\n  3 * \\<^bold>|z\\<^bold>|\n  < 2 * \\<^bold>|z\\<^bold>| + 2 * \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| < 3 * \\<^bold>|x\\<^bold>|", "by simp"], ["proof (state)\nthis:\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| < 3 * \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from less_trans[OF lenx this, unfolded mult_less_cancel2]"], ["proof (chain)\npicking this:\n  0 < \\<^bold>|x\\<^bold>| \\<and> a < 3", "have \"a = 2\""], ["proof (prove)\nusing this:\n  0 < \\<^bold>|x\\<^bold>| \\<and> a < 3\n\ngoal (1 subgoal):\n 1. a = 2", "using a"], ["proof (prove)\nusing this:\n  0 < \\<^bold>|x\\<^bold>| \\<and> a < 3\n  2 \\<le> a\n\ngoal (1 subgoal):\n 1. a = 2", "by force"], ["proof (state)\nthis:\n  a = 2\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"\\<^bold>|y\\<^bold>| \\<le> \\<^bold>|x\\<^bold>|\""], ["proof (prove)\nusing this:\n  a = 2\n\ngoal (1 subgoal):\n 1. \\<^bold>|y\\<^bold>| \\<le> \\<^bold>|x\\<^bold>|", "using \\<open>b*\\<^bold>|y\\<^bold>| \\<le> a*\\<^bold>|x\\<^bold>|\\<close> b \n      pow_len[of x 2]  pow_len[of y b] mult_le_less_imp_less[of a b \"\\<^bold>|x\\<^bold>|\" \"\\<^bold>|y\\<^bold>|\"] not_le"], ["proof (prove)\nusing this:\n  a = 2\n  b * \\<^bold>|y\\<^bold>| \\<le> a * \\<^bold>|x\\<^bold>|\n  2 \\<le> b\n  \\<^bold>|CoWBasic.power2 x\\<^bold>| = 2 * \\<^bold>|x\\<^bold>|\n  \\<^bold>|y \\<^sup>@ b\\<^bold>| = b * \\<^bold>|y\\<^bold>|\n  \\<lbrakk>a \\<le> b; \\<^bold>|x\\<^bold>| < \\<^bold>|y\\<^bold>|; 0 < a;\n   0 \\<le> \\<^bold>|x\\<^bold>|\\<rbrakk>\n  \\<Longrightarrow> a * \\<^bold>|x\\<^bold>| < b * \\<^bold>|y\\<^bold>|\n  (\\<not> ?x \\<le> ?y) = (?y < ?x)\n\ngoal (1 subgoal):\n 1. \\<^bold>|y\\<^bold>| \\<le> \\<^bold>|x\\<^bold>|", "by auto"], ["proof (state)\nthis:\n  \\<^bold>|y\\<^bold>| \\<le> \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"x\\<cdot>x\\<cdot>y\\<^sup>@b = z\\<cdot>z\\<cdot>z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z \\<cdot> z", "using a eq \\<open>c=3\\<close> \\<open>a=2\\<close>"], ["proof (prove)\nusing this:\n  2 \\<le> a\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c\n  c = 3\n  a = 2\n\ngoal (1 subgoal):\n 1. x \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z \\<cdot> z", "by (simp add: numeral_2_eq_2 numeral_3_eq_3) \n\n\\<comment> \\<open>Find words u, v, w\\<close>"], ["proof (state)\nthis:\n  x \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z \\<cdot> z\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"\\<^bold>|z\\<^bold>| < \\<^bold>|x\\<cdot>x\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>|z\\<^bold>| < \\<^bold>|x \\<cdot> x\\<^bold>|", "using \\<open>\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| < 3 * \\<^bold>|x\\<^bold>|\\<close> add.commute"], ["proof (prove)\nusing this:\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| < 3 * \\<^bold>|x\\<^bold>|\n  ?a + ?b = ?b + ?a\n\ngoal (1 subgoal):\n 1. \\<^bold>|z\\<^bold>| < \\<^bold>|x \\<cdot> x\\<^bold>|", "by auto"], ["proof (state)\nthis:\n  \\<^bold>|z\\<^bold>| < \\<^bold>|x \\<cdot> x\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from ruler_le[THEN prefD, OF triv_pref[of z \"z\\<cdot>z\"] _ less_imp_le[OF this]]"], ["proof (chain)\npicking this:\n  x \\<cdot> x \\<le>p z \\<cdot> z \\<cdot> z \\<Longrightarrow>\n  \\<exists>za. x \\<cdot> x = z \\<cdot> za", "obtain w  where \"z\\<cdot>w = x\\<cdot>x\""], ["proof (prove)\nusing this:\n  x \\<cdot> x \\<le>p z \\<cdot> z \\<cdot> z \\<Longrightarrow>\n  \\<exists>za. x \\<cdot> x = z \\<cdot> za\n\ngoal (1 subgoal):\n 1. (\\<And>w.\n        z \\<cdot> w = x \\<cdot> x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "using prefI[of \"x\\<cdot>x\" \"y\\<^sup>@b\" \"z\\<cdot>z\\<cdot>z\", unfolded rassoc, OF \\<open>x\\<cdot>x\\<cdot>y\\<^sup>@b = z\\<cdot>z\\<cdot>z\\<close>]"], ["proof (prove)\nusing this:\n  x \\<cdot> x \\<le>p z \\<cdot> z \\<cdot> z \\<Longrightarrow>\n  \\<exists>za. x \\<cdot> x = z \\<cdot> za\n  x \\<cdot> x \\<le>p z \\<cdot> z \\<cdot> z\n\ngoal (1 subgoal):\n 1. (\\<And>w.\n        z \\<cdot> w = x \\<cdot> x \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by fastforce"], ["proof (state)\nthis:\n  z \\<cdot> w = x \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"\\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|", "using \\<open>a = 2\\<close> lenx"], ["proof (prove)\nusing this:\n  a = 2\n  a * \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|", "by auto"], ["proof (state)\nthis:\n  \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from ruler_le[THEN prefD, OF _ _ less_imp_le[OF this], of \"x\\<cdot>x\\<cdot>y\\<^sup>@b\", OF triv_pref, unfolded \\<open>x\\<cdot>x\\<cdot>y\\<^sup>@b = z\\<cdot>z\\<cdot>z\\<close>, OF triv_pref]"], ["proof (chain)\npicking this:\n  \\<exists>za. z = x \\<cdot> za", "obtain u :: \"'a list\" where \"x\\<cdot>u=z\""], ["proof (prove)\nusing this:\n  \\<exists>za. z = x \\<cdot> za\n\ngoal (1 subgoal):\n 1. (\\<And>u. x \\<cdot> u = z \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  x \\<cdot> u = z\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"u \\<noteq> \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon>", "using \\<open>\\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\\<close> \\<open>x\\<cdot>u = z\\<close>"], ["proof (prove)\nusing this:\n  \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\n  x \\<cdot> u = z\n\ngoal (1 subgoal):\n 1. u \\<noteq> \\<epsilon>", "by auto"], ["proof (state)\nthis:\n  u \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"x = u\\<cdot>w\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = u \\<cdot> w", "using  \\<open>z\\<cdot>w = x\\<cdot>x\\<close> \\<open>x\\<cdot>u = z\\<close>"], ["proof (prove)\nusing this:\n  z \\<cdot> w = x \\<cdot> x\n  x \\<cdot> u = z\n\ngoal (1 subgoal):\n 1. x = u \\<cdot> w", "by auto"], ["proof (state)\nthis:\n  x = u \\<cdot> w\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"\\<^bold>|x\\<cdot>x\\<^bold>| < \\<^bold>|z\\<cdot>z\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>|x \\<cdot> x\\<^bold>| < \\<^bold>|z \\<cdot> z\\<^bold>|", "by (simp add: \\<open>\\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\\<close> add_less_mono)"], ["proof (state)\nthis:\n  \\<^bold>|x \\<cdot> x\\<^bold>| < \\<^bold>|z \\<cdot> z\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from ruler_le[OF triv_pref[of \"x\\<cdot>x\" \"y\\<^sup>@b\", unfolded  rassoc \\<open>x\\<cdot>x\\<cdot>y\\<^sup>@b = z\\<cdot>z\\<cdot>z\\<close>, unfolded lassoc] triv_pref, OF less_imp_le[OF this]]"], ["proof (chain)\npicking this:\n  x \\<cdot> x \\<le>p z \\<cdot> z", "have \"z\\<cdot>w \\<le>p z\\<cdot>z\""], ["proof (prove)\nusing this:\n  x \\<cdot> x \\<le>p z \\<cdot> z\n\ngoal (1 subgoal):\n 1. z \\<cdot> w \\<le>p z \\<cdot> z", "unfolding \\<open>z\\<cdot>w = x\\<cdot>x\\<close>"], ["proof (prove)\nusing this:\n  x \\<cdot> x \\<le>p z \\<cdot> z\n\ngoal (1 subgoal):\n 1. x \\<cdot> x \\<le>p z \\<cdot> z", "."], ["proof (state)\nthis:\n  z \\<cdot> w \\<le>p z \\<cdot> z\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "obtain v :: \"'a list\" where \"w \\<cdot> v = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>v. w \\<cdot> v = x \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using lq_pref[of w x] \n   pref_prod_pref'[OF pref_cancel[OF \\<open>z\\<cdot>w \\<le>p z\\<cdot>z\\<close>, folded \\<open>x \\<cdot> u = z\\<close>, unfolded \\<open>x = u \\<cdot> w\\<close> rassoc], folded  \\<open>x = u \\<cdot> w\\<close>]"], ["proof (prove)\nusing this:\n  w \\<le>p x \\<Longrightarrow> w \\<cdot> w\\<inverse>\\<^sup>>x = x\n  w \\<le>p x\n\ngoal (1 subgoal):\n 1. (\\<And>v. w \\<cdot> v = x \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by blast"], ["proof (state)\nthis:\n  w \\<cdot> v = x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"u\\<cdot>w\\<cdot>v \\<noteq> \\<epsilon>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<cdot> w \\<cdot> v \\<noteq> \\<epsilon>", "by (simp add: \\<open>u \\<noteq> \\<epsilon>\\<close>)\n\n\\<comment> \\<open>Express x, y and z in terms of  u, v and w\\<close>"], ["proof (state)\nthis:\n  u \\<cdot> w \\<cdot> v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"z = w\\<cdot>v\\<cdot>u\""], ["proof (prove)\nusing this:\n  u \\<cdot> w \\<cdot> v \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. z = w \\<cdot> v \\<cdot> u", "using \\<open>w \\<cdot> v = x\\<close> \\<open>x \\<cdot> u = z\\<close>"], ["proof (prove)\nusing this:\n  u \\<cdot> w \\<cdot> v \\<noteq> \\<epsilon>\n  w \\<cdot> v = x\n  x \\<cdot> u = z\n\ngoal (1 subgoal):\n 1. z = w \\<cdot> v \\<cdot> u", "by auto"], ["proof (state)\nthis:\n  z = w \\<cdot> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from \\<open>x \\<cdot> x \\<cdot> y\\<^sup>@b = z \\<cdot> z \\<cdot> z\\<close>[unfolded this lassoc, folded \\<open>z \\<cdot> w = x \\<cdot> x\\<close>, unfolded this rassoc]"], ["proof (chain)\npicking this:\n  w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b =\n  w \\<cdot>\n  v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u", "have \"w\\<cdot>v \\<cdot> u\\<cdot>w \\<cdot> y\\<^sup>@b = w\\<cdot>v\\<cdot>u\\<cdot>w\\<cdot>v\\<cdot>u\\<cdot>w\\<cdot>v\\<cdot>u\""], ["proof (prove)\nusing this:\n  w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b =\n  w \\<cdot>\n  v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b =\n    w \\<cdot>\n    v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u", "."], ["proof (state)\nthis:\n  w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b =\n  w \\<cdot>\n  v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"y\\<^sup>@b = v\\<cdot>u\\<cdot>w\\<cdot>v\\<cdot>u\""], ["proof (prove)\nusing this:\n  w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b =\n  w \\<cdot>\n  v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. y \\<^sup>@ b = v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u", "using pref_cancel"], ["proof (prove)\nusing this:\n  w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b =\n  w \\<cdot>\n  v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u\n  ?z \\<cdot> ?u \\<le>p ?z \\<cdot> ?v \\<Longrightarrow> ?u \\<le>p ?v\n\ngoal (1 subgoal):\n 1. y \\<^sup>@ b = v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u", "by auto\n\n\\<comment> \\<open>Double period of uwv\\<close>"], ["proof (state)\nthis:\n  y \\<^sup>@ b = v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from periodN_fac[OF _ \\<open>u\\<cdot>w\\<cdot>v \\<noteq> \\<epsilon>\\<close>, of v u \"\\<^bold>|y\\<^bold>|\", unfolded rassoc, folded this]"], ["proof (chain)\npicking this:\n  periodN (y \\<^sup>@ b) \\<^bold>|y\\<^bold>| \\<Longrightarrow>\n  periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|", "have \"periodN (u\\<cdot>w\\<cdot>v) \\<^bold>|y\\<^bold>|\""], ["proof (prove)\nusing this:\n  periodN (y \\<^sup>@ b) \\<^bold>|y\\<^bold>| \\<Longrightarrow>\n  periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|", "using pow_per[OF \\<open>y \\<noteq> \\<epsilon>\\<close> b0]"], ["proof (prove)\nusing this:\n  periodN (y \\<^sup>@ b) \\<^bold>|y\\<^bold>| \\<Longrightarrow>\n  periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|\n  periodN (y \\<^sup>@ b) \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|", "by blast"], ["proof (state)\nthis:\n  periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"u\\<cdot>w\\<cdot>v = x \\<cdot>v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<cdot> w \\<cdot> v = x \\<cdot> v", "by (simp add: \\<open>x = u \\<cdot> w\\<close>)"], ["proof (state)\nthis:\n  u \\<cdot> w \\<cdot> v = x \\<cdot> v\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"u\\<cdot>w\\<cdot>v = u\\<cdot> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<cdot> w \\<cdot> v = u \\<cdot> x", "by (simp add: \\<open>w \\<cdot> v = x\\<close>)"], ["proof (state)\nthis:\n  u \\<cdot> w \\<cdot> v = u \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"u\\<cdot>w\\<cdot>v \\<le>p u\\<^sup>\\<omega>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<cdot> w \\<cdot> v \\<le>p u\\<^sup>\\<omega>", "unfolding period_root_def"], ["proof (prove)\ngoal (1 subgoal):\n 1. u \\<cdot> w \\<cdot> v \\<le>p u \\<cdot> u \\<cdot> w \\<cdot> v \\<and>\n    u \\<noteq> \\<epsilon>", "using \\<open>u \\<cdot> w \\<cdot> v = u \\<cdot> x\\<close>[unfolded \\<open>x = u \\<cdot> w\\<close>] \\<open>u \\<noteq> \\<epsilon>\\<close> triv_pref[of \"u \\<cdot> u \\<cdot> w\" v]"], ["proof (prove)\nusing this:\n  u \\<cdot> w \\<cdot> v = u \\<cdot> u \\<cdot> w\n  u \\<noteq> \\<epsilon>\n  u \\<cdot> u \\<cdot> w \\<le>p (u \\<cdot> u \\<cdot> w) \\<cdot> v\n\ngoal (1 subgoal):\n 1. u \\<cdot> w \\<cdot> v \\<le>p u \\<cdot> u \\<cdot> w \\<cdot> v \\<and>\n    u \\<noteq> \\<epsilon>", "by force"], ["proof (state)\nthis:\n  u \\<cdot> w \\<cdot> v \\<le>p u\\<^sup>\\<omega>\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"periodN (u\\<cdot>w\\<cdot>v) \\<^bold>|u\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|u\\<^bold>|", "using \\<open>u \\<cdot> w \\<cdot> v \\<le>p u \\<^sup>\\<omega>\\<close>"], ["proof (prove)\nusing this:\n  u \\<cdot> w \\<cdot> v \\<le>p u\\<^sup>\\<omega>\n\ngoal (1 subgoal):\n 1. periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|u\\<^bold>|", "by auto\n\n\\<comment> \\<open>Common period d\\<close>"], ["proof (state)\nthis:\n  periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|u\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "obtain d::nat where \"d=gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>d.\n        d = gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>| \\<Longrightarrow>\n        thesis) \\<Longrightarrow>\n    thesis", "by simp"], ["proof (state)\nthis:\n  d = gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"\\<^bold>|y\\<^bold>| + \\<^bold>|u\\<^bold>| \\<le> \\<^bold>|u\\<cdot>w\\<cdot>v\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>|y\\<^bold>| + \\<^bold>|u\\<^bold>|\n    \\<le> \\<^bold>|u \\<cdot> w \\<cdot> v\\<^bold>|", "using \\<open>\\<^bold>|y\\<^bold>| \\<le> \\<^bold>|x\\<^bold>|\\<close> length_append \\<open>u\\<cdot>w\\<cdot>v = u\\<cdot> x\\<close>"], ["proof (prove)\nusing this:\n  \\<^bold>|y\\<^bold>| \\<le> \\<^bold>|x\\<^bold>|\n  \\<^bold>|?xs \\<cdot> ?ys\\<^bold>| =\n  \\<^bold>|?xs\\<^bold>| + \\<^bold>|?ys\\<^bold>|\n  u \\<cdot> w \\<cdot> v = u \\<cdot> x\n\ngoal (1 subgoal):\n 1. \\<^bold>|y\\<^bold>| + \\<^bold>|u\\<^bold>|\n    \\<le> \\<^bold>|u \\<cdot> w \\<cdot> v\\<^bold>|", "by simp"], ["proof (state)\nthis:\n  \\<^bold>|y\\<^bold>| + \\<^bold>|u\\<^bold>|\n  \\<le> \\<^bold>|u \\<cdot> w \\<cdot> v\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"periodN (u\\<cdot>w\\<cdot>v) d\""], ["proof (prove)\nusing this:\n  \\<^bold>|y\\<^bold>| + \\<^bold>|u\\<^bold>|\n  \\<le> \\<^bold>|u \\<cdot> w \\<cdot> v\\<^bold>|\n\ngoal (1 subgoal):\n 1. periodN (u \\<cdot> w \\<cdot> v) d", "using \\<open>periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|u\\<^bold>|\\<close> \\<open>periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|\\<close> \\<open>d = gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\\<close> two_periodsN"], ["proof (prove)\nusing this:\n  \\<^bold>|y\\<^bold>| + \\<^bold>|u\\<^bold>|\n  \\<le> \\<^bold>|u \\<cdot> w \\<cdot> v\\<^bold>|\n  periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|u\\<^bold>|\n  periodN (u \\<cdot> w \\<cdot> v) \\<^bold>|y\\<^bold>|\n  d = gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\n  \\<lbrakk>periodN ?w ?p; periodN ?w ?q;\n   ?p + ?q \\<le> \\<^bold>|?w\\<^bold>|\\<rbrakk>\n  \\<Longrightarrow> periodN ?w (gcd ?p ?q)\n\ngoal (1 subgoal):\n 1. periodN (u \\<cdot> w \\<cdot> v) d", "by blast\n\n\\<comment> \\<open>Divisibility\\<close>"], ["proof (state)\nthis:\n  periodN (u \\<cdot> w \\<cdot> v) d\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"v\\<cdot>u\\<cdot>z=y\\<^sup>@b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. v \\<cdot> u \\<cdot> z = y \\<^sup>@ b", "by (simp add: \\<open>y\\<^sup>@b = v \\<cdot> u \\<cdot> w \\<cdot> v \\<cdot> u\\<close> \\<open>z = w \\<cdot> v \\<cdot> u\\<close>)"], ["proof (state)\nthis:\n  v \\<cdot> u \\<cdot> z = y \\<^sup>@ b\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"\\<^bold>|u\\<^bold>| = \\<^bold>|v\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>|u\\<^bold>| = \\<^bold>|v\\<^bold>|", "using \\<open>x = u \\<cdot> w\\<close> \\<open>w \\<cdot> v = x\\<close> length_append[of u w] length_append[of w v] add.commute[of \"\\<^bold>|u\\<^bold>|\" \"\\<^bold>|w\\<^bold>|\"] add_left_cancel"], ["proof (prove)\nusing this:\n  x = u \\<cdot> w\n  w \\<cdot> v = x\n  \\<^bold>|u \\<cdot> w\\<^bold>| = \\<^bold>|u\\<^bold>| + \\<^bold>|w\\<^bold>|\n  \\<^bold>|w \\<cdot> v\\<^bold>| = \\<^bold>|w\\<^bold>| + \\<^bold>|v\\<^bold>|\n  \\<^bold>|u\\<^bold>| + \\<^bold>|w\\<^bold>| =\n  \\<^bold>|w\\<^bold>| + \\<^bold>|u\\<^bold>|\n  (?a + ?b = ?a + ?c) = (?b = ?c)\n\ngoal (1 subgoal):\n 1. \\<^bold>|u\\<^bold>| = \\<^bold>|v\\<^bold>|", "by simp"], ["proof (state)\nthis:\n  \\<^bold>|u\\<^bold>| = \\<^bold>|v\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"d dvd \\<^bold>|v\\<^bold>|\""], ["proof (prove)\nusing this:\n  \\<^bold>|u\\<^bold>| = \\<^bold>|v\\<^bold>|\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|v\\<^bold>|", "using gcd_nat.cobounded1[of \"\\<^bold>|v\\<^bold>|\" \"\\<^bold>|y\\<^bold>|\"] gcd.commute[of \"\\<^bold>|y\\<^bold>|\" \"\\<^bold>|u\\<^bold>|\"]"], ["proof (prove)\nusing this:\n  \\<^bold>|u\\<^bold>| = \\<^bold>|v\\<^bold>|\n  gcd \\<^bold>|v\\<^bold>| \\<^bold>|y\\<^bold>| dvd \\<^bold>|v\\<^bold>|\n  gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>| =\n  gcd \\<^bold>|u\\<^bold>| \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|v\\<^bold>|", "by (simp add: \\<open>d = gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\\<close>)"], ["proof (state)\nthis:\n  d dvd \\<^bold>|v\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"d dvd \\<^bold>|u\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|u\\<^bold>|", "by (simp add: \\<open>d = gcd  \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\\<close>)"], ["proof (state)\nthis:\n  d dvd \\<^bold>|u\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"\\<^bold>|z\\<^bold>| + \\<^bold>|u\\<^bold>| + \\<^bold>|v\\<^bold>| = b*\\<^bold>|y\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>|z\\<^bold>| + \\<^bold>|u\\<^bold>| + \\<^bold>|v\\<^bold>| =\n    b * \\<^bold>|y\\<^bold>|", "using  lenarg[OF \\<open>v\\<cdot>u\\<cdot>z=y\\<^sup>@b\\<close>, unfolded length_append pow_len]"], ["proof (prove)\nusing this:\n  \\<^bold>|v\\<^bold>| + (\\<^bold>|u\\<^bold>| + \\<^bold>|z\\<^bold>|) =\n  b * \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|z\\<^bold>| + \\<^bold>|u\\<^bold>| + \\<^bold>|v\\<^bold>| =\n    b * \\<^bold>|y\\<^bold>|", "by auto"], ["proof (state)\nthis:\n  \\<^bold>|z\\<^bold>| + \\<^bold>|u\\<^bold>| + \\<^bold>|v\\<^bold>| =\n  b * \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from dvd_add_left_iff[OF \\<open>d dvd \\<^bold>|v\\<^bold>|\\<close>, of \"\\<^bold>|z\\<^bold>|+\\<^bold>|u\\<^bold>|\", unfolded this dvd_add_left_iff[OF \\<open>d dvd \\<^bold>|u\\<^bold>|\\<close>, of \"\\<^bold>|z\\<^bold>|\"]]"], ["proof (chain)\npicking this:\n  (d dvd b * \\<^bold>|y\\<^bold>|) = (d dvd \\<^bold>|z\\<^bold>|)", "have \"d dvd \\<^bold>|z\\<^bold>|\""], ["proof (prove)\nusing this:\n  (d dvd b * \\<^bold>|y\\<^bold>|) = (d dvd \\<^bold>|z\\<^bold>|)\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|z\\<^bold>|", "using \\<open>d = gcd  \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\\<close> dvd_mult"], ["proof (prove)\nusing this:\n  (d dvd b * \\<^bold>|y\\<^bold>|) = (d dvd \\<^bold>|z\\<^bold>|)\n  d = gcd \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\n  ?a dvd ?c \\<Longrightarrow> ?a dvd ?b * ?c\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|z\\<^bold>|", "by blast"], ["proof (state)\nthis:\n  d dvd \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from lenarg[OF \\<open>z = w \\<cdot> v \\<cdot> u\\<close>, unfolded length_append pow_len]"], ["proof (chain)\npicking this:\n  \\<^bold>|z\\<^bold>| =\n  \\<^bold>|w\\<^bold>| + (\\<^bold>|v\\<^bold>| + \\<^bold>|u\\<^bold>|)", "have \"d dvd \\<^bold>|w\\<^bold>|\""], ["proof (prove)\nusing this:\n  \\<^bold>|z\\<^bold>| =\n  \\<^bold>|w\\<^bold>| + (\\<^bold>|v\\<^bold>| + \\<^bold>|u\\<^bold>|)\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|w\\<^bold>|", "using \\<open>d dvd \\<^bold>|z\\<^bold>|\\<close>  \\<open>d dvd \\<^bold>|u\\<^bold>|\\<close> \\<open>d dvd \\<^bold>|v\\<^bold>|\\<close>"], ["proof (prove)\nusing this:\n  \\<^bold>|z\\<^bold>| =\n  \\<^bold>|w\\<^bold>| + (\\<^bold>|v\\<^bold>| + \\<^bold>|u\\<^bold>|)\n  d dvd \\<^bold>|z\\<^bold>|\n  d dvd \\<^bold>|u\\<^bold>|\n  d dvd \\<^bold>|v\\<^bold>|\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|w\\<^bold>|", "by (simp add: dvd_add_left_iff)"], ["proof (state)\nthis:\n  d dvd \\<^bold>|w\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"d dvd \\<^bold>|x\\<^bold>|\""], ["proof (prove)\nusing this:\n  d dvd \\<^bold>|w\\<^bold>|\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|x\\<^bold>|", "using \\<open>d dvd \\<^bold>|v\\<^bold>|\\<close> \\<open>w \\<cdot> v = x\\<close>"], ["proof (prove)\nusing this:\n  d dvd \\<^bold>|w\\<^bold>|\n  d dvd \\<^bold>|v\\<^bold>|\n  w \\<cdot> v = x\n\ngoal (1 subgoal):\n 1. d dvd \\<^bold>|x\\<^bold>|", "by force\n\n\\<comment> \\<open>x and y commute\\<close>"], ["proof (state)\nthis:\n  d dvd \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"x \\<le>p u\\<cdot>w\\<cdot>v\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<le>p u \\<cdot> w \\<cdot> v", "by (simp add: \\<open>x = u \\<cdot> w\\<close>)"], ["proof (state)\nthis:\n  x \\<le>p u \\<cdot> w \\<cdot> v\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \"periodN x d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. periodN x d", "using per_pref'[OF \\<open>x\\<noteq>\\<epsilon>\\<close>  \\<open>periodN (u\\<cdot>w\\<cdot>v) d \\<close> \\<open>x \\<le>p u \\<cdot>w\\<cdot>v\\<close>]"], ["proof (prove)\nusing this:\n  periodN x d\n\ngoal (1 subgoal):\n 1. periodN x d", "."], ["proof (state)\nthis:\n  periodN x d\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"x \\<in> (take d x)*\""], ["proof (prove)\nusing this:\n  periodN x d\n\ngoal (1 subgoal):\n 1. x \\<in> take d x*", "using \\<open>d dvd \\<^bold>|x\\<^bold>|\\<close>"], ["proof (prove)\nusing this:\n  periodN x d\n  d dvd \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<in> take d x*", "using root_divisor"], ["proof (prove)\nusing this:\n  periodN x d\n  d dvd \\<^bold>|x\\<^bold>|\n  \\<lbrakk>periodN ?w ?k; ?k dvd \\<^bold>|?w\\<^bold>|\\<rbrakk>\n  \\<Longrightarrow> ?w \\<in> take ?k ?w*\n\ngoal (1 subgoal):\n 1. x \\<in> take d x*", "by blast"], ["proof (state)\nthis:\n  x \\<in> take d x*\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"periodN u d \""], ["proof (prove)\nusing this:\n  x \\<in> take d x*\n\ngoal (1 subgoal):\n 1. periodN u d", "using \\<open>x = u \\<cdot> w\\<close> per_pref'"], ["proof (prove)\nusing this:\n  x \\<in> take d x*\n  x = u \\<cdot> w\n  \\<lbrakk>?u \\<noteq> \\<epsilon>; periodN ?v ?k; ?u \\<le>p ?v\\<rbrakk>\n  \\<Longrightarrow> periodN ?u ?k\n\ngoal (1 subgoal):\n 1. periodN u d", "using \\<open>periodN x d\\<close> \\<open>u \\<noteq> \\<epsilon>\\<close>"], ["proof (prove)\nusing this:\n  x \\<in> take d x*\n  x = u \\<cdot> w\n  \\<lbrakk>?u \\<noteq> \\<epsilon>; periodN ?v ?k; ?u \\<le>p ?v\\<rbrakk>\n  \\<Longrightarrow> periodN ?u ?k\n  periodN x d\n  u \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. periodN u d", "by blast"], ["proof (state)\nthis:\n  periodN u d\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "have \" take d x = take d u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. take d x = take d u", "using \\<open>u\\<noteq>\\<epsilon>\\<close>  \\<open>x = u \\<cdot> w\\<close> pref_share_take"], ["proof (prove)\nusing this:\n  u \\<noteq> \\<epsilon>\n  x = u \\<cdot> w\n  \\<lbrakk>?u \\<le>p ?v; ?q \\<le> \\<^bold>|?u\\<^bold>|\\<rbrakk>\n  \\<Longrightarrow> take ?q ?u = take ?q ?v\n\ngoal (1 subgoal):\n 1. take d x = take d u", "by (simp add: \\<open>d = gcd  \\<^bold>|y\\<^bold>| \\<^bold>|u\\<^bold>|\\<close>)"], ["proof (state)\nthis:\n  take d x = take d u\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from root_divisor[OF \\<open>periodN u d\\<close> \\<open>d dvd \\<^bold>|u\\<^bold>|\\<close>, folded this]"], ["proof (chain)\npicking this:\n  u \\<in> take d x*", "have \"u \\<in> (take d x)*\""], ["proof (prove)\nusing this:\n  u \\<in> take d x*\n\ngoal (1 subgoal):\n 1. u \\<in> take d x*", "."], ["proof (state)\nthis:\n  u \\<in> take d x*\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "hence \"z \\<in> (take d x)*\""], ["proof (prove)\nusing this:\n  u \\<in> take d x*\n\ngoal (1 subgoal):\n 1. z \\<in> take d x*", "using \\<open>x\\<cdot>u=z\\<close> \\<open>x \\<in> (take d x)*\\<close> add_roots"], ["proof (prove)\nusing this:\n  u \\<in> take d x*\n  x \\<cdot> u = z\n  x \\<in> take d x*\n  \\<lbrakk>?w \\<in> ?z*; ?w' \\<in> ?z*\\<rbrakk>\n  \\<Longrightarrow> ?w \\<cdot> ?w' \\<in> ?z*\n\ngoal (1 subgoal):\n 1. z \\<in> take d x*", "by blast"], ["proof (state)\nthis:\n  z \\<in> take d x*\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from root_pref_cancel'[OF _ root_pow_root[OF  \\<open>x \\<in> take d x*\\<close>, of a],of \"y\\<^sup>@b\", unfolded eq, OF root_pow_root[OF  this, of c]]"], ["proof (chain)\npicking this:\n  y \\<^sup>@ b \\<in> take d x*", "have \"y\\<^sup>@b \\<in> (take d x)*\""], ["proof (prove)\nusing this:\n  y \\<^sup>@ b \\<in> take d x*\n\ngoal (1 subgoal):\n 1. y \\<^sup>@ b \\<in> take d x*", "."], ["proof (state)\nthis:\n  y \\<^sup>@ b \\<in> take d x*\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "from  commD[OF root_pow_root[OF  \\<open>x \\<in> take d x*\\<close>, of a] this]"], ["proof (chain)\npicking this:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\nusing this:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "unfolding comm_pow_roots[OF \\<open>a \\<noteq> 0\\<close> \\<open>b \\<noteq> 0\\<close>, of x y]"], ["proof (prove)\nusing this:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "."], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal:\nNo subgoals!", "qed"], ["", "end \\<comment> \\<open>locale LS\\<close>"], ["", "text\\<open>The main proof is by induction on the length of $z$. It also uses the reverse symmetry of the equation which is \nexploited by two interpretations of the locale @{term LS}. Note also that the case $|x^a| < |y^b|$ is solved by \nusing induction on $|z| + |y^b|$ instead of just on $|z|$.\n\\<close>"], ["", "lemma Lyndon_Schutzenberger':\n  \"\\<lbrakk> x\\<^sup>@a\\<cdot>y\\<^sup>@b = z\\<^sup>@c;  2 \\<le> a;  2 \\<le> b; 2 \\<le> c \\<rbrakk>\n  \\<Longrightarrow> x\\<cdot>y = y\\<cdot>x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c; 2 \\<le> a;\n     2 \\<le> b; 2 \\<le> c\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "proof (induction \"\\<^bold>|z\\<^bold>| + b* \\<^bold>|y\\<^bold>|\" arbitrary: x y z a b c  rule: less_induct)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z b x a c.\n       \\<lbrakk>\\<And>ya za ba x a c.\n                   \\<lbrakk>\\<^bold>|za\\<^bold>| + ba * \\<^bold>|ya\\<^bold>|\n                            < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n                    x \\<^sup>@ a \\<cdot> ya \\<^sup>@ ba = za \\<^sup>@ c;\n                    2 \\<le> a; 2 \\<le> ba; 2 \\<le> c\\<rbrakk>\n                   \\<Longrightarrow> x \\<cdot> ya = ya \\<cdot> x;\n        x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c; 2 \\<le> a;\n        2 \\<le> b; 2 \\<le> c\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "case less"], ["proof (state)\nthis:\n  \\<lbrakk>\\<^bold>|?z\\<^bold>| + ?b * \\<^bold>|?y\\<^bold>|\n           < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n   ?x \\<^sup>@ ?a \\<cdot> ?y \\<^sup>@ ?b = ?z \\<^sup>@ ?c; 2 \\<le> ?a;\n   2 \\<le> ?b; 2 \\<le> ?c\\<rbrakk>\n  \\<Longrightarrow> ?x \\<cdot> ?y = ?y \\<cdot> ?x\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c\n  2 \\<le> a\n  2 \\<le> b\n  2 \\<le> c\n\ngoal (1 subgoal):\n 1. \\<And>y z b x a c.\n       \\<lbrakk>\\<And>ya za ba x a c.\n                   \\<lbrakk>\\<^bold>|za\\<^bold>| + ba * \\<^bold>|ya\\<^bold>|\n                            < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n                    x \\<^sup>@ a \\<cdot> ya \\<^sup>@ ba = za \\<^sup>@ c;\n                    2 \\<le> a; 2 \\<le> ba; 2 \\<le> c\\<rbrakk>\n                   \\<Longrightarrow> x \\<cdot> ya = ya \\<cdot> x;\n        x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c; 2 \\<le> a;\n        2 \\<le> b; 2 \\<le> c\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "interpret LS x a y b z c"], ["proof (prove)\ngoal (1 subgoal):\n 1. LS x a y b z c", "using \\<open> x\\<^sup>@a\\<cdot>y\\<^sup>@b = z\\<^sup>@c\\<close> \\<open> 2 \\<le>a \\<close> \\<open> 2 \\<le> b\\<close> \\<open> 2 \\<le> c\\<close>"], ["proof (prove)\nusing this:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c\n  2 \\<le> a\n  2 \\<le> b\n  2 \\<le> c\n\ngoal (1 subgoal):\n 1. LS x a y b z c", "by (simp add: LS.intro)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z b x a c.\n       \\<lbrakk>\\<And>ya za ba x a c.\n                   \\<lbrakk>\\<^bold>|za\\<^bold>| + ba * \\<^bold>|ya\\<^bold>|\n                            < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n                    x \\<^sup>@ a \\<cdot> ya \\<^sup>@ ba = za \\<^sup>@ c;\n                    2 \\<le> a; 2 \\<le> ba; 2 \\<le> c\\<rbrakk>\n                   \\<Longrightarrow> x \\<cdot> ya = ya \\<cdot> x;\n        x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c; 2 \\<le> a;\n        2 \\<le> b; 2 \\<le> c\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "interpret LSrev: LS \"rev y\" b \"rev x\" a \"rev z\" c"], ["proof (prove)\ngoal (1 subgoal):\n 1. LS (rev y) b (rev x) a (rev z) c", "using  LS.intro[OF b a c, of \"rev y\" \"rev x\" \"rev z\", folded rev_append rev_pow, unfolded rev_is_rev_conv, OF \\<open>x\\<^sup>@a \\<cdot> y\\<^sup>@b = z\\<^sup>@c\\<close>]"], ["proof (prove)\nusing this:\n  LS (rev y) b (rev x) a (rev z) c\n\ngoal (1 subgoal):\n 1. LS (rev y) b (rev x) a (rev z) c", "."], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>y z b x a c.\n       \\<lbrakk>\\<And>ya za ba x a c.\n                   \\<lbrakk>\\<^bold>|za\\<^bold>| + ba * \\<^bold>|ya\\<^bold>|\n                            < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n                    x \\<^sup>@ a \\<cdot> ya \\<^sup>@ ba = za \\<^sup>@ c;\n                    2 \\<le> a; 2 \\<le> ba; 2 \\<le> c\\<rbrakk>\n                   \\<Longrightarrow> x \\<cdot> ya = ya \\<cdot> x;\n        x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c; 2 \\<le> a;\n        2 \\<le> b; 2 \\<le> c\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have leneq: \"a * \\<^bold>|x\\<^bold>| + b*\\<^bold>|y\\<^bold>| = c * \\<^bold>|z\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n    c * \\<^bold>|z\\<^bold>|", "using  eq"], ["proof (prove)\nusing this:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c\n\ngoal (1 subgoal):\n 1. a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n    c * \\<^bold>|z\\<^bold>|", "unfolding pow_len[symmetric] length_append[symmetric]"], ["proof (prove)\nusing this:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c\n\ngoal (1 subgoal):\n 1. \\<^bold>|x \\<^sup>@ a \\<cdot> y \\<^sup>@ b\\<^bold>| =\n    \\<^bold>|z \\<^sup>@ c\\<^bold>|", "by simp"], ["proof (state)\nthis:\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n  c * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<And>y z b x a c.\n       \\<lbrakk>\\<And>ya za ba x a c.\n                   \\<lbrakk>\\<^bold>|za\\<^bold>| + ba * \\<^bold>|ya\\<^bold>|\n                            < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n                    x \\<^sup>@ a \\<cdot> ya \\<^sup>@ ba = za \\<^sup>@ c;\n                    2 \\<le> a; 2 \\<le> ba; 2 \\<le> c\\<rbrakk>\n                   \\<Longrightarrow> x \\<cdot> ya = ya \\<cdot> x;\n        x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c; 2 \\<le> a;\n        2 \\<le> b; 2 \\<le> c\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have \"a \\<noteq> 0\" and \"b \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<noteq> 0 &&& b \\<noteq> 0", "using a b"], ["proof (prove)\nusing this:\n  2 \\<le> a\n  2 \\<le> b\n\ngoal (1 subgoal):\n 1. a \\<noteq> 0 &&& b \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  a \\<noteq> 0\n  b \\<noteq> 0\n\ngoal (1 subgoal):\n 1. \\<And>y z b x a c.\n       \\<lbrakk>\\<And>ya za ba x a c.\n                   \\<lbrakk>\\<^bold>|za\\<^bold>| + ba * \\<^bold>|ya\\<^bold>|\n                            < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n                    x \\<^sup>@ a \\<cdot> ya \\<^sup>@ ba = za \\<^sup>@ c;\n                    2 \\<le> a; 2 \\<le> ba; 2 \\<le> c\\<rbrakk>\n                   \\<Longrightarrow> x \\<cdot> ya = ya \\<cdot> x;\n        x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<^sup>@ c; 2 \\<le> a;\n        2 \\<le> b; 2 \\<le> c\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "proof (cases \"x = \\<epsilon> \\<or> y = \\<epsilon>\")"], ["proof (state)\ngoal (2 subgoals):\n 1. x = \\<epsilon> \\<or> y = \\<epsilon> \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>) \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "show \"x = \\<epsilon> \\<or> y = \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = \\<epsilon> \\<or> y = \\<epsilon> \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "by auto"], ["proof (state)\nthis:\n  x = \\<epsilon> \\<or> y = \\<epsilon> \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. \\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>) \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>) \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "assume \"\\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>)\""], ["proof (state)\nthis:\n  \\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>)\n\ngoal (1 subgoal):\n 1. \\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>) \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "hence \"x \\<noteq> \\<epsilon>\" and \"y \\<noteq> \\<epsilon>\""], ["proof (prove)\nusing this:\n  \\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>)\n\ngoal (1 subgoal):\n 1. x \\<noteq> \\<epsilon> &&& y \\<noteq> \\<epsilon>", "by blast+"], ["proof (state)\nthis:\n  x \\<noteq> \\<epsilon>\n  y \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. \\<not> (x = \\<epsilon> \\<or> y = \\<epsilon>) \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "proof (cases \"\\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|y \\<^sup>@ b\\<^bold>|\")\n\n\\<comment> \\<open>WLOG assumption\\<close>"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<^bold>|x \\<^sup>@ a\\<^bold>|\n    < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "assume \"\\<^bold>|x\\<^sup>@a\\<^bold>| < \\<^bold>|y\\<^sup>@b\\<^bold>|\""], ["proof (state)\nthis:\n  \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (2 subgoals):\n 1. \\<^bold>|x \\<^sup>@ a\\<^bold>|\n    < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "have \"\\<^bold>|rev z\\<^bold>| + a* \\<^bold>|rev x\\<^bold>| < \\<^bold>|z\\<^bold>| + b* \\<^bold>|y\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<^bold>|rev z\\<^bold>| + a * \\<^bold>|rev x\\<^bold>|\n    < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|", "using \\<open>\\<^bold>|x\\<^sup>@a\\<^bold>| < \\<^bold>|y\\<^sup>@b\\<^bold>|\\<close>"], ["proof (prove)\nusing this:\n  \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|rev z\\<^bold>| + a * \\<^bold>|rev x\\<^bold>|\n    < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|", "by (simp add: pow_len)"], ["proof (state)\nthis:\n  \\<^bold>|rev z\\<^bold>| + a * \\<^bold>|rev x\\<^bold>|\n  < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n\ngoal (2 subgoals):\n 1. \\<^bold>|x \\<^sup>@ a\\<^bold>|\n    < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "from \"less.hyps\"[OF this LSrev.eq b a c, symmetric]"], ["proof (chain)\npicking this:\n  rev x \\<cdot> rev y = rev y \\<cdot> rev x", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\nusing this:\n  rev x \\<cdot> rev y = rev y \\<cdot> rev x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "unfolding  rev_append[symmetric] rev_is_rev_conv"], ["proof (prove)\nusing this:\n  y \\<cdot> x = x \\<cdot> y\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "by simp"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "assume \" \\<not> \\<^bold>|x\\<^sup>@a\\<^bold>| < \\<^bold>|y\\<^sup>@b\\<^bold>|\""], ["proof (state)\nthis:\n  \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "hence \"\\<^bold>|y\\<^sup>@b\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\""], ["proof (prove)\nusing this:\n  \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|", "by force\n          \\<comment> \\<open>case solved by the Periodicity lemma\\<close>"], ["proof (state)\nthis:\n  \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "consider (with_Periodicity_lemma)\n        \"\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or> \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>| \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>|\" |\n        (without_Periodicity_lemma)    \n        \"\\<^bold>|x\\<^sup>@a\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\" and \"\\<^bold>|y\\<^sup>@b\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n             \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n             \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n             \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n             thesis;\n     \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n              < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n      \\<^bold>|y \\<^sup>@ b\\<^bold>|\n      < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n     \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "using not_le_imp_less"], ["proof (prove)\nusing this:\n  \\<not> ?y \\<le> ?x \\<Longrightarrow> ?x < ?y\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n             \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n             \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n             \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n             thesis;\n     \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n              < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n      \\<^bold>|y \\<^sup>@ b\\<^bold>|\n      < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n     \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by blast"], ["proof (state)\nthis:\n  \\<lbrakk>\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n           \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n           \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n           \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n           ?thesis;\n   \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n            < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n    \\<^bold>|y \\<^sup>@ b\\<^bold>|\n    < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n   \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. \\<not> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n           < \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "thus \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n           \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n           \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n           \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n           ?thesis;\n   \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n            < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n    \\<^bold>|y \\<^sup>@ b\\<^bold>|\n    < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n   \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "proof (cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n    \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n    \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n    \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "case with_Periodicity_lemma"], ["proof (state)\nthis:\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n  \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n  \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (2 subgoals):\n 1. \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n    \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n    \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n    \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "assume short: \"\\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>| \\<or> \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>| \\<le> \\<^bold>|y\\<^sup>@b\\<^bold>|\""], ["proof (state)\nthis:\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n  \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n  \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (2 subgoals):\n 1. \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n    \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n    \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n    \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have \"x = \\<epsilon> \\<or> rev y = \\<epsilon> \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x = \\<epsilon> \\<or> rev y = \\<epsilon> \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x", "by auto"], ["proof (state)\nthis:\n  x = \\<epsilon> \\<or> rev y = \\<epsilon> \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (2 subgoals):\n 1. \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n    \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n    \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n    \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n    x \\<cdot> y = y \\<cdot> x\n 2. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "thus \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\nusing this:\n  x = \\<epsilon> \\<or> rev y = \\<epsilon> \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "using per_lemma_case LSrev.per_lemma_case short"], ["proof (prove)\nusing this:\n  x = \\<epsilon> \\<or> rev y = \\<epsilon> \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n  \\<^bold>|rev z\\<^bold>| + \\<^bold>|rev y\\<^bold>|\n  \\<le> \\<^bold>|rev y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n  rev y \\<cdot> rev x = rev x \\<cdot> rev y\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n  \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n  \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "unfolding length_rev rev_append[symmetric] rev_is_rev_conv rev_pow[symmetric]"], ["proof (prove)\nusing this:\n  x = \\<epsilon> \\<or> rev y = \\<epsilon> \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n  \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n  \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n  x \\<cdot> y = y \\<cdot> x\n  \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<or>\n  \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n  \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>|\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "by blast"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "case without_Periodicity_lemma"], ["proof (state)\nthis:\n  \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<^bold>|y \\<^sup>@ b\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "assume lenx: \"\\<^bold>|x\\<^sup>@a\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\" and leny: \"\\<^bold>|y\\<^sup>@b\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\""], ["proof (state)\nthis:\n  \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<^bold>|y \\<^sup>@ b\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have ex: \"\\<exists> k. d = Suc (Suc k)\" if \"2 \\<le> d\" for d"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>k. d = Suc (Suc k)", "using nat_le_iff_add that"], ["proof (prove)\nusing this:\n  (?m \\<le> ?n) = (\\<exists>k. ?n = ?m + k)\n  2 \\<le> d\n\ngoal (1 subgoal):\n 1. \\<exists>k. d = Suc (Suc k)", "by auto"], ["proof (state)\nthis:\n  2 \\<le> ?d \\<Longrightarrow> \\<exists>k. ?d = Suc (Suc k)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have \"a * \\<^bold>|x\\<^bold>| + b*\\<^bold>|y\\<^bold>| < 4 * \\<^bold>|z\\<^bold>|\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n    < 4 * \\<^bold>|z\\<^bold>|", "using ex[OF \\<open>2 \\<le> a\\<close>] ex[OF \\<open>2 \\<le> b\\<close>] lenx leny"], ["proof (prove)\nusing this:\n  \\<exists>k. a = Suc (Suc k)\n  \\<exists>k. b = Suc (Suc k)\n  \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<^bold>|y \\<^sup>@ b\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n    < 4 * \\<^bold>|z\\<^bold>|", "unfolding pow_len"], ["proof (prove)\nusing this:\n  \\<exists>k. a = Suc (Suc k)\n  \\<exists>k. b = Suc (Suc k)\n  a * \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  b * \\<^bold>|y\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\n\ngoal (1 subgoal):\n 1. a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n    < 4 * \\<^bold>|z\\<^bold>|", "by auto"], ["proof (state)\nthis:\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n  < 4 * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"c < 4\""], ["proof (prove)\nusing this:\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n  < 4 * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. c < 4", "using leneq"], ["proof (prove)\nusing this:\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n  < 4 * \\<^bold>|z\\<^bold>|\n  a * \\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>| =\n  c * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. c < 4", "by auto"], ["proof (state)\nthis:\n  c < 4\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "consider (c_is_3) \"c = 3\" | (c_is_2) \"c = 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>c = 3 \\<Longrightarrow> thesis;\n     c = 2 \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "using \\<open>c < 4\\<close> c"], ["proof (prove)\nusing this:\n  c < 4\n  2 \\<le> c\n\ngoal (1 subgoal):\n 1. \\<lbrakk>c = 3 \\<Longrightarrow> thesis;\n     c = 2 \\<Longrightarrow> thesis\\<rbrakk>\n    \\<Longrightarrow> thesis", "by linarith"], ["proof (state)\nthis:\n  \\<lbrakk>c = 3 \\<Longrightarrow> ?thesis;\n   c = 2 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<^bold>|x \\<^sup>@ a\\<^bold>|\n             < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|;\n     \\<^bold>|y \\<^sup>@ b\\<^bold>|\n     < \\<^bold>|z\\<^bold>| + \\<^bold>|y\\<^bold>|\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "then"], ["proof (chain)\npicking this:\n  \\<lbrakk>c = 3 \\<Longrightarrow> ?thesis;\n   c = 2 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\nusing this:\n  \\<lbrakk>c = 3 \\<Longrightarrow> ?thesis;\n   c = 2 \\<Longrightarrow> ?thesis\\<rbrakk>\n  \\<Longrightarrow> ?thesis\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "proof(cases)"], ["proof (state)\ngoal (2 subgoals):\n 1. c = 3 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x\n 2. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "case c_is_3"], ["proof (state)\nthis:\n  c = 3\n\ngoal (2 subgoals):\n 1. c = 3 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x\n 2. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "using  \n              core_case[OF \\<open>c = 3\\<close> \\<open>\\<^bold>|y\\<^sup>@b\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\\<close>[unfolded pow_len] _ _ lenx[unfolded pow_len] leny[unfolded pow_len]] \n              \\<open>x \\<noteq> \\<epsilon>\\<close> \\<open>y \\<noteq> \\<epsilon>\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>x \\<noteq> \\<epsilon>; y \\<noteq> \\<epsilon>\\<rbrakk>\n  \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x\n  x \\<noteq> \\<epsilon>\n  y \\<noteq> \\<epsilon>\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "by blast"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "assume \"c = 2\""], ["proof (state)\nthis:\n  c = 2\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence eq2: \"x\\<^sup>@a \\<cdot> y\\<^sup>@b = z \\<cdot> z\""], ["proof (prove)\nusing this:\n  c = 2\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<cdot> z", "by (simp add: eq pow2_list)"], ["proof (state)\nthis:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = z \\<cdot> z\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from   dual_order.trans  le_cases[of \"\\<^bold>|x\\<^sup>@a\\<^bold>|\" \"\\<^bold>|z\\<^bold>|\" \"\\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\", unfolded eq_len_iff[OF this]]"], ["proof (chain)\npicking this:\n  \\<lbrakk>?b \\<le> ?a; ?c \\<le> ?b\\<rbrakk> \\<Longrightarrow> ?c \\<le> ?a\n  \\<lbrakk>\\<^bold>|z\\<^bold>|\n           \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n           \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|;\n   \\<^bold>|z\\<^bold>|\n   \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<Longrightarrow>\n   \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\\<rbrakk>\n  \\<Longrightarrow> \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|", "have \"\\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\""], ["proof (prove)\nusing this:\n  \\<lbrakk>?b \\<le> ?a; ?c \\<le> ?b\\<rbrakk> \\<Longrightarrow> ?c \\<le> ?a\n  \\<lbrakk>\\<^bold>|z\\<^bold>|\n           \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n           \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|;\n   \\<^bold>|z\\<^bold>|\n   \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<Longrightarrow>\n   \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\\<rbrakk>\n  \\<Longrightarrow> \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|", "using \\<open>\\<^bold>|y\\<^sup>@b\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>?b \\<le> ?a; ?c \\<le> ?b\\<rbrakk> \\<Longrightarrow> ?c \\<le> ?a\n  \\<lbrakk>\\<^bold>|z\\<^bold>|\n           \\<le> \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<Longrightarrow>\n           \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|;\n   \\<^bold>|z\\<^bold>|\n   \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>| \\<Longrightarrow>\n   \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\\<rbrakk>\n  \\<Longrightarrow> \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n  \\<^bold>|y \\<^sup>@ b\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|", "by blast"], ["proof (state)\nthis:\n  \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x \\<^sup>@ a\\<^bold>|\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "obtain a' where \"Suc a' = a\" and \"1 \\<le> a'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>a'.\n        \\<lbrakk>Suc a' = a; 1 \\<le> a'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using \\<open>2 \\<le> a\\<close> ex"], ["proof (prove)\nusing this:\n  2 \\<le> a\n  2 \\<le> ?d \\<Longrightarrow> \\<exists>k. ?d = Suc (Suc k)\n\ngoal (1 subgoal):\n 1. (\\<And>a'.\n        \\<lbrakk>Suc a' = a; 1 \\<le> a'\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  Suc a' = a\n  1 \\<le> a'\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from eq2[folded \\<open>Suc a' = a\\<close>, unfolded pow_Suc2_list rassoc]  pow_Suc2_list[of x a', unfolded this, symmetric]"], ["proof (chain)\npicking this:\n  x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z\n  x \\<^sup>@ a' \\<cdot> x = x \\<^sup>@ a", "have eq3: \"x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z\" and aa':\"x \\<^sup>@ a' \\<cdot> x = x \\<^sup>@ a \""], ["proof (prove)\nusing this:\n  x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z\n  x \\<^sup>@ a' \\<cdot> x = x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z &&&\n    x \\<^sup>@ a' \\<cdot> x = x \\<^sup>@ a", "."], ["proof (state)\nthis:\n  x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z\n  x \\<^sup>@ a' \\<cdot> x = x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"\\<^bold>|x\\<^sup>@a'\\<^bold>| < \\<^bold>|z\\<^bold>|\""], ["proof (prove)\nusing this:\n  x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z\n  x \\<^sup>@ a' \\<cdot> x = x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. \\<^bold>|x \\<^sup>@ a'\\<^bold>| < \\<^bold>|z\\<^bold>|", "using \\<open>Suc a' = a\\<close> lenx pow_len"], ["proof (prove)\nusing this:\n  x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b = z \\<cdot> z\n  x \\<^sup>@ a' \\<cdot> x = x \\<^sup>@ a\n  Suc a' = a\n  \\<^bold>|x \\<^sup>@ a\\<^bold>| < \\<^bold>|z\\<^bold>| + \\<^bold>|x\\<^bold>|\n  \\<^bold>|?u \\<^sup>@ ?k\\<^bold>| = ?k * \\<^bold>|?u\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|x \\<^sup>@ a'\\<^bold>| < \\<^bold>|z\\<^bold>|", "by auto"], ["proof (state)\nthis:\n  \\<^bold>|x \\<^sup>@ a'\\<^bold>| < \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"\\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\""], ["proof (prove)\nusing this:\n  \\<^bold>|x \\<^sup>@ a'\\<^bold>| < \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|", "using  mult_le_mono[of 1 a' \"\\<^bold>|z\\<^bold>|\" \"\\<^bold>|x\\<^bold>|\", OF \\<open>1 \\<le> a'\\<close>, THEN leD]"], ["proof (prove)\nusing this:\n  \\<^bold>|x \\<^sup>@ a'\\<^bold>| < \\<^bold>|z\\<^bold>|\n  \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x\\<^bold>| \\<Longrightarrow>\n  \\<not> a' * \\<^bold>|x\\<^bold>| < 1 * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|", "unfolding pow_len"], ["proof (prove)\nusing this:\n  a' * \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\n  \\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x\\<^bold>| \\<Longrightarrow>\n  \\<not> a' * \\<^bold>|x\\<^bold>| < 1 * \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|", "by linarith"], ["proof (state)\nthis:\n  \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "obtain u w where \"x\\<^sup>@a'\\<cdot>u = z\" and \"w \\<cdot> y\\<^sup>@b = z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>u w.\n        \\<lbrakk>x \\<^sup>@ a' \\<cdot> u = z;\n         w \\<cdot> y \\<^sup>@ b = z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using eqd_prefE[OF eq3[unfolded rassoc] less_imp_le[OF \\<open>\\<^bold>|x\\<^sup>@a'\\<^bold>| < \\<^bold>|z\\<^bold>|\\<close>], of thesis]\n              eqd_prefE[OF eq2[symmetric]  \\<open>\\<^bold>|z\\<^bold>| \\<le> \\<^bold>|x\\<^sup>@a\\<^bold>|\\<close>, of thesis]"], ["proof (prove)\nusing this:\n  (\\<And>t.\n      \\<lbrakk>x \\<^sup>@ a' \\<cdot> t = z;\n       t \\<cdot> z = x \\<cdot> y \\<^sup>@ b\\<rbrakk>\n      \\<Longrightarrow> thesis) \\<Longrightarrow>\n  thesis\n  (\\<And>t.\n      \\<lbrakk>z \\<cdot> t = x \\<^sup>@ a;\n       t \\<cdot> y \\<^sup>@ b = z\\<rbrakk>\n      \\<Longrightarrow> thesis) \\<Longrightarrow>\n  thesis\n\ngoal (1 subgoal):\n 1. (\\<And>u w.\n        \\<lbrakk>x \\<^sup>@ a' \\<cdot> u = z;\n         w \\<cdot> y \\<^sup>@ b = z\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by fast"], ["proof (state)\nthis:\n  x \\<^sup>@ a' \\<cdot> u = z\n  w \\<cdot> y \\<^sup>@ b = z\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have \"x\\<^sup>@a'\\<cdot>x\\<cdot>y\\<^sup>@b = x\\<^sup>@a'\\<cdot>u\\<cdot>w\\<cdot>y\\<^sup>@b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b =\n    x \\<^sup>@ a' \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b", "unfolding lassoc  \\<open>x \\<^sup>@ a' \\<cdot> u = z\\<close> \\<open>w \\<cdot> y\\<^sup>@b = z\\<close> aa' cancel eq2"], ["proof (prove)\ngoal (1 subgoal):\n 1. z = z", "by simp"], ["proof (state)\nthis:\n  x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a' \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"u\\<cdot>w=x\""], ["proof (prove)\nusing this:\n  x \\<^sup>@ a' \\<cdot> x \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a' \\<cdot> u \\<cdot> w \\<cdot> y \\<^sup>@ b\n\ngoal (1 subgoal):\n 1. u \\<cdot> w = x", "by auto"], ["proof (state)\nthis:\n  u \\<cdot> w = x\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"\\<^bold>|w\\<cdot>u\\<^bold>| = \\<^bold>|x\\<^bold>|\""], ["proof (prove)\nusing this:\n  u \\<cdot> w = x\n\ngoal (1 subgoal):\n 1. \\<^bold>|w \\<cdot> u\\<^bold>| = \\<^bold>|x\\<^bold>|", "using swap_len"], ["proof (prove)\nusing this:\n  u \\<cdot> w = x\n  \\<^bold>|?u \\<cdot> ?v\\<^bold>| = \\<^bold>|?v \\<cdot> ?u\\<^bold>|\n\ngoal (1 subgoal):\n 1. \\<^bold>|w \\<cdot> u\\<^bold>| = \\<^bold>|x\\<^bold>|", "by blast\n\n\\<comment> \\<open>Induction step: new equation with shorter z\\<close>"], ["proof (state)\nthis:\n  \\<^bold>|w \\<cdot> u\\<^bold>| = \\<^bold>|x\\<^bold>|\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have \"w\\<^sup>@2\\<cdot>y\\<^sup>@b = (w\\<cdot>u)\\<^sup>@a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. CoWBasic.power2 w \\<cdot> y \\<^sup>@ b = (w \\<cdot> u) \\<^sup>@ a", "unfolding pow2_list"], ["proof (prove)\ngoal (1 subgoal):\n 1. (w \\<cdot> w) \\<cdot> y \\<^sup>@ b = (w \\<cdot> u) \\<^sup>@ a", "using \\<open>w \\<cdot> y \\<^sup>@ b = z\\<close> \\<open>x \\<^sup>@ a' \\<cdot> u = z\\<close> \\<open>u\\<cdot>w=x\\<close> pow_slide[of w u a', unfolded \\<open>Suc a' = a\\<close>]"], ["proof (prove)\nusing this:\n  w \\<cdot> y \\<^sup>@ b = z\n  x \\<^sup>@ a' \\<cdot> u = z\n  u \\<cdot> w = x\n  w \\<cdot> (u \\<cdot> w) \\<^sup>@ a' \\<cdot> u = (w \\<cdot> u) \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. (w \\<cdot> w) \\<cdot> y \\<^sup>@ b = (w \\<cdot> u) \\<^sup>@ a", "by simp"], ["proof (state)\nthis:\n  CoWBasic.power2 w \\<cdot> y \\<^sup>@ b = (w \\<cdot> u) \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from \"less.hyps\"[OF _ this _ b a, unfolded \\<open>\\<^bold>|w\\<cdot>u\\<^bold>| = \\<^bold>|x\\<^bold>|\\<close>]"], ["proof (chain)\npicking this:\n  \\<lbrakk>\\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n           < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n   2 \\<le> 2\\<rbrakk>\n  \\<Longrightarrow> w \\<cdot> y = y \\<cdot> w", "have \"y\\<cdot>w = w\\<cdot>y\""], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n           < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n   2 \\<le> 2\\<rbrakk>\n  \\<Longrightarrow> w \\<cdot> y = y \\<cdot> w\n\ngoal (1 subgoal):\n 1. y \\<cdot> w = w \\<cdot> y", "using  \\<open>\\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\\<close>"], ["proof (prove)\nusing this:\n  \\<lbrakk>\\<^bold>|x\\<^bold>| + b * \\<^bold>|y\\<^bold>|\n           < \\<^bold>|z\\<^bold>| + b * \\<^bold>|y\\<^bold>|;\n   2 \\<le> 2\\<rbrakk>\n  \\<Longrightarrow> w \\<cdot> y = y \\<cdot> w\n  \\<^bold>|x\\<^bold>| < \\<^bold>|z\\<^bold>|\n\ngoal (1 subgoal):\n 1. y \\<cdot> w = w \\<cdot> y", "by force"], ["proof (state)\nthis:\n  y \\<cdot> w = w \\<cdot> y\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "have \"y \\<cdot> z = z \\<cdot> y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. y \\<cdot> z = z \\<cdot> y", "unfolding \\<open>w \\<cdot> y\\<^sup>@b = z\\<close>[symmetric] lassoc \\<open>y\\<cdot>w = w\\<cdot>y\\<close>"], ["proof (prove)\ngoal (1 subgoal):\n 1. (w \\<cdot> y) \\<cdot> y \\<^sup>@ b = (w \\<cdot> y \\<^sup>@ b) \\<cdot> y", "by (simp add: pow_commutes_list)"], ["proof (state)\nthis:\n  y \\<cdot> z = z \\<cdot> y\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "hence \"z\\<^sup>@c\\<cdot>y\\<^sup>@b = y\\<^sup>@b\\<cdot>z\\<^sup>@c\""], ["proof (prove)\nusing this:\n  y \\<cdot> z = z \\<cdot> y\n\ngoal (1 subgoal):\n 1. z \\<^sup>@ c \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> z \\<^sup>@ c", "by (simp add: comm_add_exps)"], ["proof (state)\nthis:\n  z \\<^sup>@ c \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> z \\<^sup>@ c\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from this[folded eq, unfolded lassoc]"], ["proof (chain)\npicking this:\n  (x \\<^sup>@ a \\<cdot> y \\<^sup>@ b) \\<cdot> y \\<^sup>@ b =\n  (y \\<^sup>@ b \\<cdot> x \\<^sup>@ a) \\<cdot> y \\<^sup>@ b", "have \"x\\<^sup>@a\\<cdot>y\\<^sup>@b = y\\<^sup>@b\\<cdot>x\\<^sup>@a\""], ["proof (prove)\nusing this:\n  (x \\<^sup>@ a \\<cdot> y \\<^sup>@ b) \\<cdot> y \\<^sup>@ b =\n  (y \\<^sup>@ b \\<cdot> x \\<^sup>@ a) \\<cdot> y \\<^sup>@ b\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a", "using cancel_right"], ["proof (prove)\nusing this:\n  (x \\<^sup>@ a \\<cdot> y \\<^sup>@ b) \\<cdot> y \\<^sup>@ b =\n  (y \\<^sup>@ b \\<cdot> x \\<^sup>@ a) \\<cdot> y \\<^sup>@ b\n  (?ys \\<cdot> ?xs = ?zs \\<cdot> ?xs) = (?ys = ?zs)\n\ngoal (1 subgoal):\n 1. x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a", "by blast"], ["proof (state)\nthis:\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b = y \\<^sup>@ b \\<cdot> x \\<^sup>@ a\n\ngoal (1 subgoal):\n 1. c = 2 \\<Longrightarrow> x \\<cdot> y = y \\<cdot> x", "from this[unfolded comm_pow_roots[OF \\<open>a\\<noteq>0\\<close> \\<open>b \\<noteq> 0\\<close>]]"], ["proof (chain)\npicking this:\n  x \\<cdot> y = y \\<cdot> x", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\nusing this:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "."], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal:\nNo subgoals!", "qed"], ["", "theorem Lyndon_Schutzenberger:\n  assumes \"x\\<^sup>@a\\<cdot>y\\<^sup>@b = z\\<^sup>@c\" and  \"2 \\<le> a\"  and \"2 \\<le> b\" and \"2 \\<le> c\"\n  shows  \"x\\<cdot>y = y\\<cdot>x\" and \"x\\<cdot>z = z\\<cdot>x\" and \"y\\<cdot>z = z\\<cdot>y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x &&&\n    x \\<cdot> z = z \\<cdot> x &&& y \\<cdot> z = z \\<cdot> y", "proof-"], ["proof (state)\ngoal (3 subgoals):\n 1. x \\<cdot> y = y \\<cdot> x\n 2. x \\<cdot> z = z \\<cdot> x\n 3. y \\<cdot> z = z \\<cdot> y", "show \"x \\<cdot> y = y \\<cdot> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "using Lyndon_Schutzenberger'[OF assms]"], ["proof (prove)\nusing this:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (1 subgoal):\n 1. x \\<cdot> y = y \\<cdot> x", "."], ["proof (state)\nthis:\n  x \\<cdot> y = y \\<cdot> x\n\ngoal (2 subgoals):\n 1. x \\<cdot> z = z \\<cdot> x\n 2. y \\<cdot> z = z \\<cdot> y", "have \"c \\<noteq> 0\" and  \"b \\<noteq> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c \\<noteq> 0 &&& b \\<noteq> 0", "using  \\<open>2 \\<le> c\\<close> \\<open>2 \\<le> b\\<close>"], ["proof (prove)\nusing this:\n  2 \\<le> c\n  2 \\<le> b\n\ngoal (1 subgoal):\n 1. c \\<noteq> 0 &&& b \\<noteq> 0", "by auto"], ["proof (state)\nthis:\n  c \\<noteq> 0\n  b \\<noteq> 0\n\ngoal (2 subgoals):\n 1. x \\<cdot> z = z \\<cdot> x\n 2. y \\<cdot> z = z \\<cdot> y", "have \"x \\<cdot> x\\<^sup>@a \\<cdot> y\\<^sup>@b = x\\<^sup>@a \\<cdot> y\\<^sup>@b \\<cdot> x\" and \"y \\<cdot> x\\<^sup>@a \\<cdot> y\\<^sup>@b = x\\<^sup>@a \\<cdot> y\\<^sup>@b \\<cdot> y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n    x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> x &&&\n    y \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n    x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> y", "unfolding comm_add_exp[OF \\<open>x \\<cdot> y = y \\<cdot> x\\<close>[symmetric], of b] comm_add_exp[OF \\<open>x \\<cdot> y = y \\<cdot> x\\<close>, symmetric, of a]\n    lassoc power_commutes"], ["proof (prove)\ngoal (1 subgoal):\n 1. (x \\<cdot> x \\<^sup>@ a) \\<cdot> y \\<^sup>@ b =\n    (x \\<cdot> x \\<^sup>@ a) \\<cdot> y \\<^sup>@ b &&&\n    (x \\<^sup>@ a \\<cdot> y) \\<cdot> y \\<^sup>@ b =\n    (x \\<^sup>@ a \\<cdot> y) \\<cdot> y \\<^sup>@ b", "by blast+"], ["proof (state)\nthis:\n  x \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> x\n  y \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> y\n\ngoal (2 subgoals):\n 1. x \\<cdot> z = z \\<cdot> x\n 2. y \\<cdot> z = z \\<cdot> y", "thus \"x\\<cdot>z = z\\<cdot>x\" and \"y\\<cdot>z = z\\<cdot>y\""], ["proof (prove)\nusing this:\n  x \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> x\n  y \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> y\n\ngoal (1 subgoal):\n 1. x \\<cdot> z = z \\<cdot> x &&& y \\<cdot> z = z \\<cdot> y", "using comm_drop_exp[OF \\<open>c \\<noteq> 0\\<close>]"], ["proof (prove)\nusing this:\n  x \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> x\n  y \\<cdot> x \\<^sup>@ a \\<cdot> y \\<^sup>@ b =\n  x \\<^sup>@ a \\<cdot> y \\<^sup>@ b \\<cdot> y\n  ?u \\<cdot> ?r \\<^sup>@ c = ?r \\<^sup>@ c \\<cdot> ?u \\<Longrightarrow>\n  ?r \\<cdot> ?u = ?u \\<cdot> ?r\n\ngoal (1 subgoal):\n 1. x \\<cdot> z = z \\<cdot> x &&& y \\<cdot> z = z \\<cdot> y", "unfolding lassoc \\<open>x\\<^sup>@a\\<cdot>y\\<^sup>@b = z\\<^sup>@c\\<close>"], ["proof (prove)\nusing this:\n  x \\<cdot> z \\<^sup>@ c = z \\<^sup>@ c \\<cdot> x\n  y \\<cdot> z \\<^sup>@ c = z \\<^sup>@ c \\<cdot> y\n  ?u \\<cdot> ?r \\<^sup>@ c = ?r \\<^sup>@ c \\<cdot> ?u \\<Longrightarrow>\n  ?r \\<cdot> ?u = ?u \\<cdot> ?r\n\ngoal (1 subgoal):\n 1. x \\<cdot> z = z \\<cdot> x &&& y \\<cdot> z = z \\<cdot> y", "by force+"], ["proof (state)\nthis:\n  x \\<cdot> z = z \\<cdot> x\n  y \\<cdot> z = z \\<cdot> y\n\ngoal:\nNo subgoals!", "qed"], ["", "end"]]}