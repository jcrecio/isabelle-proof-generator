{"file_name": "/home/qj213/afp-2021-10-22/thys/Isabelle_Marries_Dirac/Deutsch_Jozsa.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Isabelle_Marries_Dirac", "problem_names": ["lemma is_balanced_inter: \n  fixes A B:: \"nat set\"\n  assumes \"\\<forall>x \\<in> A. f x = 0\" and \"\\<forall>x \\<in> B. f x = 1\" \n  shows \"A \\<inter> B = {}\"", "lemma is_balanced_union:\n  fixes A B:: \"nat set\"\n  assumes \"A \\<subseteq> {i::nat. i < 2^n}\" and \"B \\<subseteq> {i::nat. i < 2^n}\" \n      and \"card A = 2^(n-1)\" and \"card B = 2^(n-1)\" \n      and \"A \\<inter> B = {}\"\n  shows \"A \\<union> B = {i::nat. i < 2^n}\"", "lemma f_ge_0: \"\\<forall>x. f x \\<ge> 0\"", "lemma f_dom_not_zero: \n  shows \"f \\<in> ({i::nat. n \\<ge> 1 \\<and> i < 2^n} \\<rightarrow>\\<^sub>E {0,1})\"", "lemma f_values: \"\\<forall>x \\<in> {(i::nat). i < 2^n} . f x = 0 \\<or> f x = 1\"", "lemma disj_four_cases:\n  assumes \"A \\<or> B \\<or> C \\<or> D\" and \"A \\<Longrightarrow> P\" and \"B \\<Longrightarrow> P\" and \"C \\<Longrightarrow> P\" and \"D \\<Longrightarrow> P\"\n  shows \"P\"", "lemma (in jozsa) jozsa_transform_dim [simp]:\n  shows \"dim_row U\\<^sub>f = 2^(n+1)\" and \"dim_col U\\<^sub>f = 2^(n+1)\"", "lemma (in jozsa) jozsa_transform_coeff_is_zero [simp]:\n  assumes \"i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\"\n  shows \"(i\\<noteq>j \\<and> \\<not>(i=j+1 \\<and> odd i) \\<and> \\<not> (i=j-1 \\<and> even i \\<and> j\\<ge>1)) \\<longrightarrow> U\\<^sub>f $$ (i,j) = 0\"", "lemma (in jozsa) jozsa_transform_coeff [simp]: \n  assumes \"i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\"\n  shows \"i = j \\<longrightarrow> U\\<^sub>f $$ (i,j) = 1 - f (i div 2)\"\n  and \"i = j + 1 \\<and> odd i \\<longrightarrow> U\\<^sub>f $$ (i,j) = f (i div 2)\"\n  and \"j \\<ge> 1 \\<and> i = j - 1 \\<and> even i \\<longrightarrow> U\\<^sub>f $$ (i,j) = f (i div 2)\"", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_sum_even:\n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"even i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(\\<Sum>k\\<in>{0..< dim_row A}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) =(\\<Sum>k\\<in>{i,i+1}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\"", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_even: \n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"even i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(U\\<^sub>f * A) $$ (i,j) = (\\<Sum>k \\<in> {i,i+1}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\"", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_sum_odd:\n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"odd i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(\\<Sum>k\\<in>{0..< dim_row A}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) =(\\<Sum>k\\<in>{i-1,i}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\"", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_odd: \n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"odd i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(U\\<^sub>f * A) $$ (i,j) = (\\<Sum>k \\<in> {i-1,i}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) \"", "lemma (in jozsa) transpose_of_jozsa_transform:\n  shows \"(U\\<^sub>f)\\<^sup>t = U\\<^sub>f\"", "lemma (in jozsa) adjoint_of_jozsa_transform: \n  shows \"(U\\<^sub>f)\\<^sup>\\<dagger> = U\\<^sub>f\"", "lemma (in jozsa) jozsa_transform_is_unitary_index_even:\n  fixes i j:: nat\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col U\\<^sub>f\" and \"even i\"\n  shows \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\"", "lemma (in jozsa) jozsa_transform_is_unitary_index_odd:\n  fixes i j:: nat\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col U\\<^sub>f\" and \"odd i\"\n  shows \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\"", "lemma (in jozsa) jozsa_transform_is_gate:\n  shows \"gate (n+1) U\\<^sub>f\"", "lemma one_tensor_is_id [simp]:\n  fixes A\n  shows \"A \\<otimes>\\<^bsup>1\\<^esup> = A\"", "lemma iter_tensor_suc: \n  fixes n\n  assumes \"n \\<ge> 1\"\n  shows \" A \\<otimes>\\<^bsup>(Suc n)\\<^esup> = A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>)\"", "lemma dim_row_of_iter_tensor [simp]:\n  fixes A n\n  assumes \"n \\<ge> 1\"\n  shows \"dim_row(A \\<otimes>\\<^bsup>n\\<^esup>) = (dim_row A)^n\"", "lemma dim_col_of_iter_tensor [simp]:\n  fixes A n\n  assumes \"n \\<ge> 1\"\n  shows \"dim_col(A \\<otimes>\\<^bsup>n\\<^esup>) = (dim_col A)^n\"", "lemma iter_tensor_values:\n  fixes A n i j\n  assumes \"n \\<ge> 1\" and \"i < dim_row (A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>))\" and \"j < dim_col (A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>))\"\n  shows \"(A \\<otimes>\\<^bsup>(Suc n)\\<^esup>) $$ (i,j) = (A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>)) $$ (i,j)\"", "lemma iter_tensor_mult_distr:\n  assumes \"n \\<ge> 1\" and \"dim_col A = dim_row B\" and \"dim_col A > 0\" and \"dim_col B > 0\"\n  shows \"(A \\<otimes>\\<^bsup>(Suc n)\\<^esup>) * (B \\<otimes>\\<^bsup>(Suc n)\\<^esup>) = (A * B) \\<Otimes> ((A \\<otimes>\\<^bsup>n\\<^esup>) * (B \\<otimes>\\<^bsup>n\\<^esup>))\"", "lemma index_tensor_mat_with_vec2_row_cond:\n  fixes A B:: \"complex Matrix.mat\" and i:: \"nat\" \n  assumes \"i < 2 * (dim_row B)\" and \"i \\<ge> dim_row B\" and \"dim_col B > 0\"\nand \"dim_row A = 2\" and \"dim_col A = 1\"\n  shows \"(A \\<Otimes> B) $$ (i,0) = (A $$ (1,0)) * (B $$ (i-dim_row B,0))\"", "lemma iter_tensor_of_gate_is_gate:\n  fixes A:: \"complex Matrix.mat\" and n m:: \"nat\" \n  assumes \"gate m A\" and \"n \\<ge> 1\" \n  shows \"gate (m*n) (A \\<otimes>\\<^bsup>n\\<^esup>)\"", "lemma iter_tensor_of_state_is_state:\n  fixes A:: \"complex Matrix.mat\" and n m:: \"nat\" \n  assumes \"state m A\" and \"n\\<ge>1\" \n  shows \"state (m*n) (A \\<otimes>\\<^bsup>n\\<^esup>)\"", "lemma \\<psi>\\<^sub>1\\<^sub>0_values:\n  fixes i j n\n  assumes \"i < dim_row (\\<psi>\\<^sub>1\\<^sub>0 n)\" and \"j < dim_col (\\<psi>\\<^sub>1\\<^sub>0 n)\" \n  shows \"(\\<psi>\\<^sub>1\\<^sub>0 n) $$ (i,j) = 1/(sqrt 2)^n\"", "lemma H_on_ket_zero: \n  shows \"(H * |zero\\<rangle>) = \\<psi>\\<^sub>1\\<^sub>0 1\"", "lemma \\<psi>\\<^sub>1\\<^sub>0_tensor: \n  assumes \"n \\<ge> 1\"\n  shows \"(\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n) = (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\"", "lemma \\<psi>\\<^sub>1\\<^sub>0_tensor_is_state:\n  assumes \"n \\<ge> 1\"\n  shows \"state n ( |zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>)\"", "lemma iter_tensor_of_H_is_gate:\n  assumes \"n \\<ge> 1\"\n  shows \"gate n (H \\<otimes>\\<^bsup>n\\<^esup>)\"", "lemma iter_tensor_of_H_on_zero_tensor: \n  assumes \"n \\<ge> 1\"\n  shows \"(H \\<otimes>\\<^bsup>n\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>) = \\<psi>\\<^sub>1\\<^sub>0 n\"", "lemma \\<psi>\\<^sub>1\\<^sub>0_is_state:\n  assumes \"n \\<ge> 1\"\n  shows \"state n (\\<psi>\\<^sub>1\\<^sub>0 n)\"", "lemma H_on_ket_one_is_\\<psi>\\<^sub>1\\<^sub>1: \n  shows \"(H * |one\\<rangle>) = \\<psi>\\<^sub>1\\<^sub>1\"", "lemma \\<psi>\\<^sub>1_values_even[simp]:\n  fixes i j n\n  assumes \"i < dim_row (\\<psi>\\<^sub>1 n)\" and \"j < dim_col (\\<psi>\\<^sub>1 n)\" and \"even i\"\n  shows \"(\\<psi>\\<^sub>1 n) $$ (i,j) = 1/(sqrt 2)^(n+1)\"", "lemma \\<psi>\\<^sub>1_values_odd [simp]:\n  fixes i j n\n  assumes \"i < dim_row (\\<psi>\\<^sub>1 n)\" and \"j < dim_col (\\<psi>\\<^sub>1 n)\" and \"odd i\"\n  shows \"(\\<psi>\\<^sub>1 n) $$ (i,j) = -1/(sqrt 2)^(n+1)\"", "lemma \"\\<psi>\\<^sub>1\\<^sub>0_tensor_\\<psi>\\<^sub>1\\<^sub>1_is_\\<psi>\\<^sub>1\":\n  assumes \"n \\<ge> 1\"\n  shows \"(\\<psi>\\<^sub>1\\<^sub>0 n) \\<Otimes> \\<psi>\\<^sub>1\\<^sub>1 = \\<psi>\\<^sub>1 n\"", "lemma \\<psi>\\<^sub>1_is_state:\n  assumes \"n \\<ge> 1\"\n  shows \"state (n+1) (\\<psi>\\<^sub>1 n)\"", "lemma (in jozsa) \\<psi>\\<^sub>2_values_even [simp]:\n  fixes i j \n  assumes \"i < dim_row \\<psi>\\<^sub>2 \" and \"j < dim_col \\<psi>\\<^sub>2\" and \"even i\"\n  shows \"\\<psi>\\<^sub>2 $$ (i,j) = (-1)^f(i div 2)/(sqrt 2)^(n+1)\"", "lemma (in jozsa) \\<psi>\\<^sub>2_values_odd [simp]:\n  fixes i j \n  assumes \"i < dim_row \\<psi>\\<^sub>2\" and \"j < dim_col \\<psi>\\<^sub>2\" and \"odd i\"\n  shows \"\\<psi>\\<^sub>2 $$ (i,j) = (-1)^(f(i div 2)+1)/(sqrt 2)^(n+1)\"", "lemma (in jozsa) \\<psi>\\<^sub>2_values_odd_hidden [simp]:\n  assumes \"2*k+1 < dim_row \\<psi>\\<^sub>2\" and \"j < dim_col \\<psi>\\<^sub>2\" \n  shows \"\\<psi>\\<^sub>2 $$ (2*k+1,j) = ((-1)^(f((2*k+1) div 2)+1))/(sqrt 2)^(n+1)\"", "lemma (in jozsa) snd_rep_of_\\<psi>\\<^sub>2:\n  assumes \"i < dim_row \\<psi>\\<^sub>2\"\n  shows \"((1-f(i div 2)) + -f(i div 2)) * 1/(sqrt 2)^(n+1) = (-1)^f(i div 2)/(sqrt 2)^(n+1)\"\n    and \"(-(1-f(i div 2))+(f(i div 2)))* 1/(sqrt 2)^(n+1) = (-1)^(f(i div 2)+1)/(sqrt 2)^(n+1)\"", "lemma (in jozsa) jozsa_transform_times_\\<psi>\\<^sub>1_is_\\<psi>\\<^sub>2:\n  shows \"U\\<^sub>f * (\\<psi>\\<^sub>1 n) = \\<psi>\\<^sub>2\"", "lemma (in jozsa) \\<psi>\\<^sub>2_is_state:\n  shows \"state (n+1) \\<psi>\\<^sub>2\"", "lemma tensor_of_H_values [simp]:\n  fixes n i j:: nat\n  assumes \"i < dim_row (H^\\<^sub>\\<otimes> n)\" and \"j < dim_col (H^\\<^sub>\\<otimes> n)\"\n  shows \"(H^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^(i \\<cdot>\\<^bsub>n\\<^esub> j)/(sqrt 2)^n\"", "lemma dim_row_of_iter_tensor_of_H [simp]:\n  assumes \"n \\<ge> 1\"\n  shows \"1 < dim_row (H^\\<^sub>\\<otimes> n)\"", "lemma iter_tensor_of_H_fst_pos:\n  fixes n i j:: nat\n  assumes \"i < 2^n \\<or> j < 2^n\" and \"i < 2^(n+1) \\<and> j < 2^(n+1)\"\n  shows \"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = 1/sqrt(2) * ((H^\\<^sub>\\<otimes> n) $$ (i mod 2^n, j mod 2^n))\"", "lemma iter_tensor_of_H_fst_neg:\n  fixes n i j:: nat\n  assumes \"i \\<ge> 2^n \\<and> j \\<ge> 2^n\" and \"i < 2^(n+1) \\<and> j < 2^(n+1)\"\n  shows \"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = -1/sqrt(2) * (H^\\<^sub>\\<otimes> n) $$ (i mod 2^n, j mod 2^n)\"", "lemma H_tensor_iter_tensor_of_H:   \n  fixes n:: nat\n  shows  \"(H \\<Otimes> H^\\<^sub>\\<otimes> n) = H^\\<^sub>\\<otimes> (Suc n)\"", "lemma one_tensor_of_H_is_H:\n  shows \"(H^\\<^sub>\\<otimes> 1) = H\"", "lemma iter_tensor_of_H_rep_is_correct:\n  fixes n:: nat\n  assumes \"n \\<ge> 1\"\n  shows \"(H \\<otimes>\\<^bsup>n\\<^esup>) = H^\\<^sub>\\<otimes> n\"", "lemma mod_2_is_both_even_or_odd:\n  \"((even i \\<and> even j) \\<or> (odd i \\<and> odd j)) \\<longleftrightarrow> (i mod 2 = j mod 2)\"", "lemma HId_values [simp]:\n  assumes \"n \\<ge> 1\" and \"i < dim_row (HId^\\<^sub>\\<otimes> n)\" and \"j < dim_col (HId^\\<^sub>\\<otimes> n)\"\n  shows \"even i \\<and> even j \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (j div 2))/(sqrt 2)^n\"\nand \"odd i \\<and> odd j \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (j div 2))/(sqrt 2)^n\"\nand \"(i mod 2 = j mod 2) \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (j div 2))/(sqrt 2)^n\"\nand \"\\<not>(i mod 2 = j mod 2) \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = 0\"", "lemma iter_tensor_of_H_tensor_Id_is_HId:\n  shows \"(H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1 = HId^\\<^sub>\\<otimes> n\"", "lemma HId_is_gate:\n  assumes \"n \\<ge> 1\"\n  shows \"gate (n+1) (HId^\\<^sub>\\<otimes> n)\"", "lemma (in jozsa) \\<psi>\\<^sub>3_values:\n  assumes \"i < dim_row \\<psi>\\<^sub>3\"\n  shows \"odd i \\<longrightarrow> \\<psi>\\<^sub>3 $$ (i,0) = (\\<Sum>k<2^n. (-1)^(f(k) + 1 + ((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/((sqrt 2)^n * (sqrt 2)^(n+1)))\"", "lemma (in jozsa) \\<psi>\\<^sub>3_dim [simp]:\n  shows \"1 < dim_row \\<psi>\\<^sub>3\"", "lemma sum_every_odd_summand_is_zero:\n  fixes n:: nat \n  assumes \"n \\<ge> 1\"\n  shows \"\\<forall>f::(nat \\<Rightarrow> complex).(\\<forall>i. i<2^(n+1) \\<and> odd i \\<longrightarrow> f i = 0) \\<longrightarrow> \n            (\\<Sum>k\\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k\\<in>{0..<2^n}. f (2*k))\"", "lemma sum_every_even_summand_is_zero:\n  fixes n:: nat \n  assumes \"n \\<ge> 1\"\n  shows \"\\<forall>f::(nat \\<Rightarrow> complex).(\\<forall>i. i<2^(n+1) \\<and> even i \\<longrightarrow> f i = 0) \\<longrightarrow> \n            (\\<Sum>k\\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^n}. f (2*k+1))\"", "lemma (in jozsa) iter_tensor_of_H_times_\\<psi>\\<^sub>2_is_\\<psi>\\<^sub>3:\n  shows \"((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) * \\<psi>\\<^sub>2 = \\<psi>\\<^sub>3\"", "lemma (in jozsa) \\<psi>\\<^sub>3_is_state:\n  shows \"state (n+1) \\<psi>\\<^sub>3\"", "lemma (in jozsa) jozsa_algo_result [simp]: \n  shows \"jozsa_algo = \\<psi>\\<^sub>3\"", "lemma (in jozsa) jozsa_algo_result_is_state: \n  shows \"state (n+1) jozsa_algo\"", "lemma (in jozsa) prob0_fst_qubits_of_jozsa_algo: \n  shows \"(prob0_fst_qubits n jozsa_algo) = (\\<Sum>j\\<in>{0,1}. (cmod(jozsa_algo $$ (j,0)))\\<^sup>2)\"", "lemma aux_comp_with_sqrt2:\n  shows \"(sqrt 2)^n * (sqrt 2)^n = 2^n\"", "lemma aux_comp_with_sqrt2_bis [simp]:\n  shows \"2^n/(sqrt(2)^n * sqrt(2)^(n+1)) = 1/sqrt 2\"", "lemma aux_ineq_with_card: \n  fixes g:: \"nat \\<Rightarrow> nat\" and A:: \"nat set\"\n  assumes \"finite A\" \n  shows \"(\\<Sum>k\\<in>A. (-1)^(g k)) \\<le> card A\" and \"(\\<Sum>k\\<in>A. (-1)^(g k)) \\<ge> -card A\"", "lemma aux_comp_with_cmod:\n  fixes g:: \"nat \\<Rightarrow> nat\"\n  assumes \"(\\<forall>x<2^n. g x = 0) \\<or> (\\<forall>x<2^n. g x = 1)\"\n  shows \"(cmod (\\<Sum>k<2^n. (-1)^(g k)))\\<^sup>2  = 2^(2*n)\"", "lemma cmod_less:\n  fixes a n:: int\n  assumes \"a < n\" and \"a > -n\"\n  shows \"cmod a < n\"", "lemma square_less:\n  fixes a n:: real\n  assumes \"a < n\" and \"a > -n\" \n  shows \"a\\<^sup>2 < n\\<^sup>2\"", "lemma cmod_square_real [simp]:\n  fixes n:: real\n  shows \"(cmod n)\\<^sup>2 = n\\<^sup>2\"", "lemma aux_comp_sum_divide_cmod:\n  fixes n:: nat and g:: \"nat \\<Rightarrow> int\" and a:: real\n  shows \"(cmod(complex_of_real(\\<Sum>k<n. g k / a)))\\<^sup>2 = (cmod (\\<Sum>k<n. g k) / a)\\<^sup>2\"", "lemma (in jozsa) prob0_jozsa_algo_of_const_0:\n  assumes \"const 0\"\n  shows \"prob0_fst_qubits n jozsa_algo = 1\"", "lemma (in jozsa) prob0_jozsa_algo_of_const_1:\n  assumes \"const 1\"\n  shows \"prob0_fst_qubits n jozsa_algo = 1\"", "lemma (in jozsa) max_value_of_not_const_less:\n  assumes \"\\<not> const 0\" and \"\\<not> const 1\"\n  shows \"(cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k)))\\<^sup>2 < (2::nat)^(2*n)\"", "lemma (in jozsa) max_value_of_not_const_less_bis:\n  assumes \"\\<not> const 0\" and \"\\<not> const 1\"\n  shows \"(cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)))\\<^sup>2 < (2::nat)^(2*n)\"", "lemma (in jozsa) f_const_has_max_value: \n  assumes \"const 0 \\<or> const 1\"\n  shows \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 = (2::nat)^(2*n)\" \n  and \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 = (2::nat)^(2*n)\"", "lemma (in jozsa) prob0_fst_qubits_leq:\n  shows \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 \\<le> (2::nat)^(2*n)\" \n    and \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 \\<le> (2::nat)^(2*n)\"", "lemma (in jozsa) prob0_jozsa_algo_1_is_const:\n  assumes \"prob0_fst_qubits n jozsa_algo = 1\"\n  shows \"const 0 \\<or> const 1\"", "lemma sum_union_disjoint_finite_set:\n  fixes C::\"nat set\" and g::\"nat \\<Rightarrow> int\"\n  assumes \"finite C\"\n  shows \"\\<forall>A B. A \\<inter> B = {} \\<and> A \\<union> B = C \\<longrightarrow> (\\<Sum>k\\<in>C. g k) = (\\<Sum>k\\<in>A. g k) + (\\<Sum>k\\<in>B. g k)\"", "lemma (in jozsa) balanced_pos_and_neg_terms_cancel_out1:\n  assumes \"is_balanced\" \n  shows \"(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k)) = 0\"", "lemma (in jozsa) balanced_pos_and_neg_terms_cancel_out2:\n  assumes \"is_balanced\" \n  shows \"(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + 1)) = 0\"", "lemma (in jozsa) prob0_jozsa_algo_of_balanced:\nassumes \"is_balanced\"\n  shows \"prob0_fst_qubits n jozsa_algo = 0\"", "lemma (in jozsa) balanced_prob0_jozsa_algo:\n  assumes \"prob0_fst_qubits n jozsa_algo = 0\"\n  shows \"is_balanced\"", "theorem (in jozsa) jozsa_algo_is_correct:\n  shows \"jozsa_algo_eval = 1 \\<longleftrightarrow> is_const\" \n    and \"jozsa_algo_eval = 0 \\<longleftrightarrow> is_balanced\""], "translations": [["", "lemma is_balanced_inter: \n  fixes A B:: \"nat set\"\n  assumes \"\\<forall>x \\<in> A. f x = 0\" and \"\\<forall>x \\<in> B. f x = 1\" \n  shows \"A \\<inter> B = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> B = {}", "using assms"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>A. f x = 0\n  \\<forall>x\\<in>B. f x = 1\n\ngoal (1 subgoal):\n 1. A \\<inter> B = {}", "by auto"], ["", "lemma is_balanced_union:\n  fixes A B:: \"nat set\"\n  assumes \"A \\<subseteq> {i::nat. i < 2^n}\" and \"B \\<subseteq> {i::nat. i < 2^n}\" \n      and \"card A = 2^(n-1)\" and \"card B = 2^(n-1)\" \n      and \"A \\<inter> B = {}\"\n  shows \"A \\<union> B = {i::nat. i < 2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "have \"finite A\" and \"finite B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite A &&& finite B", "by (simp add: assms(3) card_ge_0_finite)\n      (simp add: assms(4) card_ge_0_finite)"], ["proof (state)\nthis:\n  finite A\n  finite B\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "then"], ["proof (chain)\npicking this:\n  finite A\n  finite B", "have \"card(A \\<union> B) = 2 * 2^(n-1)\""], ["proof (prove)\nusing this:\n  finite A\n  finite B\n\ngoal (1 subgoal):\n 1. card (A \\<union> B) = 2 * 2 ^ (n - 1)", "using assms(3-5)"], ["proof (prove)\nusing this:\n  finite A\n  finite B\n  card A = 2 ^ (n - 1)\n  card B = 2 ^ (n - 1)\n  A \\<inter> B = {}\n\ngoal (1 subgoal):\n 1. card (A \\<union> B) = 2 * 2 ^ (n - 1)", "by (simp add: card_Un_disjoint)"], ["proof (state)\nthis:\n  card (A \\<union> B) = 2 * 2 ^ (n - 1)\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "then"], ["proof (chain)\npicking this:\n  card (A \\<union> B) = 2 * 2 ^ (n - 1)", "have \"card(A \\<union> B) = 2^n\""], ["proof (prove)\nusing this:\n  card (A \\<union> B) = 2 * 2 ^ (n - 1)\n\ngoal (1 subgoal):\n 1. card (A \\<union> B) = 2 ^ n", "by (metis Nat.nat.simps(3) One_nat_def dim le_0_eq power_eq_if)"], ["proof (state)\nthis:\n  card (A \\<union> B) = 2 ^ n\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "moreover"], ["proof (state)\nthis:\n  card (A \\<union> B) = 2 ^ n\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "have \"\\<dots> = card({i::nat. i < 2^n})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 ^ n = card {i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  2 ^ n = card {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "moreover"], ["proof (state)\nthis:\n  2 ^ n = card {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "have \"A \\<union> B \\<subseteq> {i::nat. i < 2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<union> B \\<subseteq> {i. i < 2 ^ n}", "using assms(1,2)"], ["proof (prove)\nusing this:\n  A \\<subseteq> {i. i < 2 ^ n}\n  B \\<subseteq> {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B \\<subseteq> {i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  A \\<union> B \\<subseteq> {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "moreover"], ["proof (state)\nthis:\n  A \\<union> B \\<subseteq> {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "have \"finite ({i::nat. i < 2^n})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  finite {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "ultimately"], ["proof (chain)\npicking this:\n  card (A \\<union> B) = 2 ^ n\n  2 ^ n = card {i. i < 2 ^ n}\n  A \\<union> B \\<subseteq> {i. i < 2 ^ n}\n  finite {i. i < 2 ^ n}", "show ?thesis"], ["proof (prove)\nusing this:\n  card (A \\<union> B) = 2 ^ n\n  2 ^ n = card {i. i < 2 ^ n}\n  A \\<union> B \\<subseteq> {i. i < 2 ^ n}\n  finite {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "using card_subset_eq[of \"{i::nat. i < 2^n}\" \"A \\<union> B\"]"], ["proof (prove)\nusing this:\n  card (A \\<union> B) = 2 ^ n\n  2 ^ n = card {i. i < 2 ^ n}\n  A \\<union> B \\<subseteq> {i. i < 2 ^ n}\n  finite {i. i < 2 ^ n}\n  \\<lbrakk>finite {i. i < 2 ^ n}; A \\<union> B \\<subseteq> {i. i < 2 ^ n};\n   card (A \\<union> B) = card {i. i < 2 ^ n}\\<rbrakk>\n  \\<Longrightarrow> A \\<union> B = {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. A \\<union> B = {i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  A \\<union> B = {i. i < 2 ^ n}\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma f_ge_0: \"\\<forall>x. f x \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x. 0 \\<le> f x", "by simp"], ["", "lemma f_dom_not_zero: \n  shows \"f \\<in> ({i::nat. n \\<ge> 1 \\<and> i < 2^n} \\<rightarrow>\\<^sub>E {0,1})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> {i. 1 \\<le> n \\<and> i < 2 ^ n} \\<rightarrow>\\<^sub>E {0, 1}", "using dim dom"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  f \\<in> {i. i < 2 ^ n} \\<rightarrow>\\<^sub>E {0, 1}\n\ngoal (1 subgoal):\n 1. f \\<in> {i. 1 \\<le> n \\<and> i < 2 ^ n} \\<rightarrow>\\<^sub>E {0, 1}", "by simp"], ["", "lemma f_values: \"\\<forall>x \\<in> {(i::nat). i < 2^n} . f x = 0 \\<or> f x = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1", "using dom"], ["proof (prove)\nusing this:\n  f \\<in> {i. i < 2 ^ n} \\<rightarrow>\\<^sub>E {0, 1}\n\ngoal (1 subgoal):\n 1. \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1", "by auto"], ["", "end"], ["", "(* bob_fun *)"], ["", "text \\<open>The input function has to be constant or balanced.\\<close>"], ["", "locale jozsa = bob_fun +\n  assumes const_or_balanced: \"is_const \\<or> is_balanced \""], ["", "text \\<open>\nIntroduce two customised rules: disjunctions with four disjuncts and induction starting from one \ninstead of zero.\n\\<close>"], ["", "(* To deal with Uf it is often necessary to do a case distinction with four different cases.*)"], ["", "lemma disj_four_cases:\n  assumes \"A \\<or> B \\<or> C \\<or> D\" and \"A \\<Longrightarrow> P\" and \"B \\<Longrightarrow> P\" and \"C \\<Longrightarrow> P\" and \"D \\<Longrightarrow> P\"\n  shows \"P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. P", "using assms"], ["proof (prove)\nusing this:\n  A \\<or> B \\<or> C \\<or> D\n  A \\<Longrightarrow> P\n  B \\<Longrightarrow> P\n  C \\<Longrightarrow> P\n  D \\<Longrightarrow> P\n\ngoal (1 subgoal):\n 1. P", "by auto"], ["", "text \\<open>The unitary transform @{term U\\<^sub>f}.\\<close>"], ["", "definition (in jozsa) jozsa_transform:: \"complex Matrix.mat\" (\"U\\<^sub>f\") where \n\"U\\<^sub>f \\<equiv> Matrix.mat (2^(n+1)) (2^(n+1)) (\\<lambda>(i,j). \n  if i = j then (1-f(i div 2)) else \n    if i = j + 1 \\<and> odd i then f(i div 2) else\n      if i = j - 1 \\<and> even i \\<and> j\\<ge>1 then f(i div 2) else 0)\""], ["", "lemma (in jozsa) jozsa_transform_dim [simp]:\n  shows \"dim_row U\\<^sub>f = 2^(n+1)\" and \"dim_col U\\<^sub>f = 2^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row U\\<^sub>f = 2 ^ (n + 1) &&& dim_col U\\<^sub>f = 2 ^ (n + 1)", "by (auto simp add: jozsa_transform_def)"], ["", "lemma (in jozsa) jozsa_transform_coeff_is_zero [simp]:\n  assumes \"i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\"\n  shows \"(i\\<noteq>j \\<and> \\<not>(i=j+1 \\<and> odd i) \\<and> \\<not> (i=j-1 \\<and> even i \\<and> j\\<ge>1)) \\<longrightarrow> U\\<^sub>f $$ (i,j) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<and>\n    \\<not> (i = j + 1 \\<and> odd i) \\<and>\n    \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j) \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = 0", "using jozsa_transform_def assms"], ["proof (prove)\nusing this:\n  U\\<^sub>f \\<equiv>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       of_nat\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i = j then 1 - f (i div 2)\n           else if i = j + 1 \\<and> odd i then f (i div 2)\n                else if i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n                     then f (i div 2) else 0))\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<and>\n    \\<not> (i = j + 1 \\<and> odd i) \\<and>\n    \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j) \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = 0", "by auto"], ["", "lemma (in jozsa) jozsa_transform_coeff [simp]: \n  assumes \"i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\"\n  shows \"i = j \\<longrightarrow> U\\<^sub>f $$ (i,j) = 1 - f (i div 2)\"\n  and \"i = j + 1 \\<and> odd i \\<longrightarrow> U\\<^sub>f $$ (i,j) = f (i div 2)\"\n  and \"j \\<ge> 1 \\<and> i = j - 1 \\<and> even i \\<longrightarrow> U\\<^sub>f $$ (i,j) = f (i div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i = j \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2)) &&&\n    i = j + 1 \\<and> odd i \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = of_nat (f (i div 2)) &&&\n    1 \\<le> j \\<and> i = j - 1 \\<and> even i \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "using jozsa_transform_def assms"], ["proof (prove)\nusing this:\n  U\\<^sub>f \\<equiv>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       of_nat\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i = j then 1 - f (i div 2)\n           else if i = j + 1 \\<and> odd i then f (i div 2)\n                else if i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n                     then f (i div 2) else 0))\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. i = j \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2)) &&&\n    i = j + 1 \\<and> odd i \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = of_nat (f (i div 2)) &&&\n    1 \\<le> j \\<and> i = j - 1 \\<and> even i \\<longrightarrow>\n    U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "by auto"], ["", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_sum_even:\n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"even i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(\\<Sum>k\\<in>{0..< dim_row A}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) =(\\<Sum>k\\<in>{i,i+1}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(\\<Sum>k \\<in> {0..< 2^(n+1)}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) = \n             (\\<Sum>k \\<in> {0..<i}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) +\n             (\\<Sum>k \\<in> {i,i+1}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) +\n             (\\<Sum>k \\<in> {(i+2)..< 2^(n+1)}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"{0..< 2^(n+1)} = {0..<i} \\<union> {i..< 2^(n+1)} \n          \\<and> {i..< 2^(n+1)} = {i,i+1} \\<union> {(i+2)..<2^(n+1)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0..<2 ^ (n + 1)} = {0..<i} \\<union> {i..<2 ^ (n + 1)} \\<and>\n    {i..<2 ^ (n + 1)} = {i, i + 1} \\<union> {i + 2..<2 ^ (n + 1)}", "using assms(1-3)"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  even i\n\ngoal (1 subgoal):\n 1. {0..<2 ^ (n + 1)} = {0..<i} \\<union> {i..<2 ^ (n + 1)} \\<and>\n    {i..<2 ^ (n + 1)} = {i, i + 1} \\<union> {i + 2..<2 ^ (n + 1)}", "by auto"], ["proof (state)\nthis:\n  {0..<2 ^ (n + 1)} = {0..<i} \\<union> {i..<2 ^ (n + 1)} \\<and>\n  {i..<2 ^ (n + 1)} = {i, i + 1} \\<union> {i + 2..<2 ^ (n + 1)}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  {0..<2 ^ (n + 1)} = {0..<i} \\<union> {i..<2 ^ (n + 1)} \\<and>\n  {i..<2 ^ (n + 1)} = {i, i + 1} \\<union> {i + 2..<2 ^ (n + 1)}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"{0..<i} \\<inter> {i,i+1} = {} \n                  \\<and> {i,i+1} \\<inter> {(i+2)..< 2^(n+1)} = {} \n                  \\<and> {0..<i} \\<inter> {(i+2)..< 2^(n+1)} = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0..<i} \\<inter> {i, i + 1} = {} \\<and>\n    {i, i + 1} \\<inter> {i + 2..<2 ^ (n + 1)} = {} \\<and>\n    {0..<i} \\<inter> {i + 2..<2 ^ (n + 1)} = {}", "using assms"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  even i\n  dim_col U\\<^sub>f = dim_row A\n\ngoal (1 subgoal):\n 1. {0..<i} \\<inter> {i, i + 1} = {} \\<and>\n    {i, i + 1} \\<inter> {i + 2..<2 ^ (n + 1)} = {} \\<and>\n    {0..<i} \\<inter> {i + 2..<2 ^ (n + 1)} = {}", "by simp"], ["proof (state)\nthis:\n  {0..<i} \\<inter> {i, i + 1} = {} \\<and>\n  {i, i + 1} \\<inter> {i + 2..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i} \\<inter> {i + 2..<2 ^ (n + 1)} = {}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "ultimately"], ["proof (chain)\npicking this:\n  {0..<2 ^ (n + 1)} = {0..<i} \\<union> {i..<2 ^ (n + 1)} \\<and>\n  {i..<2 ^ (n + 1)} = {i, i + 1} \\<union> {i + 2..<2 ^ (n + 1)}\n  {0..<i} \\<inter> {i, i + 1} = {} \\<and>\n  {i, i + 1} \\<inter> {i + 2..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i} \\<inter> {i + 2..<2 ^ (n + 1)} = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  {0..<2 ^ (n + 1)} = {0..<i} \\<union> {i..<2 ^ (n + 1)} \\<and>\n  {i..<2 ^ (n + 1)} = {i, i + 1} \\<union> {i + 2..<2 ^ (n + 1)}\n  {0..<i} \\<inter> {i, i + 1} = {} \\<and>\n  {i, i + 1} \\<inter> {i + 2..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i} \\<inter> {i + 2..<2 ^ (n + 1)} = {}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "using sum.union_disjoint"], ["proof (prove)\nusing this:\n  {0..<2 ^ (n + 1)} = {0..<i} \\<union> {i..<2 ^ (n + 1)} \\<and>\n  {i..<2 ^ (n + 1)} = {i, i + 1} \\<union> {i + 2..<2 ^ (n + 1)}\n  {0..<i} \\<inter> {i, i + 1} = {} \\<and>\n  {i, i + 1} \\<inter> {i + 2..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i} \\<inter> {i + 2..<2 ^ (n + 1)} = {}\n  \\<lbrakk>finite ?A; finite ?B; ?A \\<inter> ?B = {}\\<rbrakk>\n  \\<Longrightarrow> sum ?g (?A \\<union> ?B) = sum ?g ?A + sum ?g ?B\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by (metis (no_types, lifting) finite_Un finite_atLeastLessThan is_num_normalize(1) ivl_disj_int_two(3))"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(\\<Sum>k \\<in> {0..<i}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "have \"k \\<in> {0..<i} \\<longrightarrow> (i\\<noteq>k \\<and> \\<not>(i=k+1 \\<and> odd i) \\<and> \\<not> (i=k-1 \\<and> even i \\<and> k\\<ge>1))\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. k \\<in> {0..<i} \\<longrightarrow>\n    i \\<noteq> k \\<and>\n    \\<not> (i = k + 1 \\<and> odd i) \\<and>\n    \\<not> (i = k - 1 \\<and> even i \\<and> 1 \\<le> k)", "using assms"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  even i\n  dim_col U\\<^sub>f = dim_row A\n\ngoal (1 subgoal):\n 1. k \\<in> {0..<i} \\<longrightarrow>\n    i \\<noteq> k \\<and>\n    \\<not> (i = k + 1 \\<and> odd i) \\<and>\n    \\<not> (i = k - 1 \\<and> even i \\<and> 1 \\<le> k)", "by auto"], ["proof (state)\nthis:\n  ?k \\<in> {0..<i} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "then"], ["proof (chain)\npicking this:\n  ?k \\<in> {0..<i} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)", "have \"k \\<in> {0..<i} \\<longrightarrow> U\\<^sub>f $$ (i,k) = 0\" for k"], ["proof (prove)\nusing this:\n  ?k \\<in> {0..<i} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n\ngoal (1 subgoal):\n 1. k \\<in> {0..<i} \\<longrightarrow> U\\<^sub>f $$ (i, k) = 0", "using assms(1)"], ["proof (prove)\nusing this:\n  ?k \\<in> {0..<i} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n  i < dim_row U\\<^sub>f\n\ngoal (1 subgoal):\n 1. k \\<in> {0..<i} \\<longrightarrow> U\\<^sub>f $$ (i, k) = 0", "by auto"], ["proof (state)\nthis:\n  ?k \\<in> {0..<i} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "then"], ["proof (chain)\npicking this:\n  ?k \\<in> {0..<i} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  ?k \\<in> {0..<i} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(\\<Sum>k \\<in> {(i+2)..< 2^(n+1)}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "have \"k\\<in>{(i+2)..< 2^(n+1)} \\<longrightarrow> (i\\<noteq>k \\<and> \\<not>(i=k+1 \\<and> odd i) \\<and> \\<not> (i=k-1 \\<and> even i \\<and> k\\<ge>1))\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow>\n    i \\<noteq> k \\<and>\n    \\<not> (i = k + 1 \\<and> odd i) \\<and>\n    \\<not> (i = k - 1 \\<and> even i \\<and> 1 \\<le> k)", "by auto"], ["proof (state)\nthis:\n  ?k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "then"], ["proof (chain)\npicking this:\n  ?k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)", "have \"k \\<in> {(i+2)..< 2^(n+1)}\\<longrightarrow> U\\<^sub>f $$ (i,k) = 0\" for k"], ["proof (prove)\nusing this:\n  ?k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n\ngoal (1 subgoal):\n 1. k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow> U\\<^sub>f $$ (i, k) = 0", "using assms(1)"], ["proof (prove)\nusing this:\n  ?k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n  i < dim_row U\\<^sub>f\n\ngoal (1 subgoal):\n 1. k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow> U\\<^sub>f $$ (i, k) = 0", "by auto"], ["proof (state)\nthis:\n  ?k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "then"], ["proof (chain)\npicking this:\n  ?k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  ?k \\<in> {i + 2..<2 ^ (n + 1)} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have  \"dim_row A = 2^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row A = 2 ^ (n + 1)", "using assms(4)"], ["proof (prove)\nusing this:\n  dim_col U\\<^sub>f = dim_row A\n\ngoal (1 subgoal):\n 1. dim_row A = 2 ^ (n + 1)", "by simp"], ["proof (state)\nthis:\n  dim_row A = 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  dim_row A = 2 ^ (n + 1)", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n  (\\<Sum>k = 0..<i. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  (\\<Sum>k = i + 2..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  dim_row A = 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by(metis (no_types, lifting) add.left_neutral add.right_neutral)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_even: \n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"even i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(U\\<^sub>f * A) $$ (i,j) = (\\<Sum>k \\<in> {i,i+1}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(U\\<^sub>f * A) $$ (i,j) = (\\<Sum> k\\<in>{0..< dim_row A}. (U\\<^sub>f $$ (i,k)) * (A $$ (k,j)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "using assms(1,2,4) index_matrix_prod"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  dim_col U\\<^sub>f = dim_row A\n  \\<lbrakk>?i < dim_row ?A; ?j < dim_col ?B;\n   dim_col ?A = dim_row ?B\\<rbrakk>\n  \\<Longrightarrow> (?A * ?B) $$ (?i, ?j) =\n                    (\\<Sum>k<dim_row ?B. ?A $$ (?i, k) * ?B $$ (k, ?j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by (simp add: atLeast0LessThan)"], ["proof (state)\nthis:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "then"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "show ?thesis"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "using assms U\\<^sub>f_mult_without_empty_summands_sum_even"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  even i\n  dim_col U\\<^sub>f = dim_row A\n  \\<lbrakk>?i < dim_row U\\<^sub>f; ?j < dim_col ?A; even ?i;\n   dim_col U\\<^sub>f = dim_row ?A\\<rbrakk>\n  \\<Longrightarrow> (\\<Sum>k = 0..<dim_row ?A.\n                        U\\<^sub>f $$ (?i, k) * ?A $$ (k, ?j)) =\n                    (\\<Sum>k\\<in>{?i, ?i + 1}.\n                       U\\<^sub>f $$ (?i, k) * ?A $$ (k, ?j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_sum_odd:\n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"odd i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(\\<Sum>k\\<in>{0..< dim_row A}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) =(\\<Sum>k\\<in>{i-1,i}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(\\<Sum>k\\<in>{0..< 2^(n+1)}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) = \n             (\\<Sum>k \\<in> {0..<i-1}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) +\n             (\\<Sum>k \\<in> {i-1,i}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) +\n             (\\<Sum>k \\<in> {i+1..< 2^(n+1)}. U\\<^sub>f $$ (i,k) * A $$ (k,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"{0..< 2^(n+1)} = {0..<i-1} \\<union> {i-1..< 2^(n+1)} \n          \\<and> {i-1..< 2^(n+1)} = {i-1,i} \\<union> {i+1..<2^(n+1)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0..<2 ^ (n + 1)} = {0..<i - 1} \\<union> {i - 1..<2 ^ (n + 1)} \\<and>\n    {i - 1..<2 ^ (n + 1)} = {i - 1, i} \\<union> {i + 1..<2 ^ (n + 1)}", "using assms(1-3)"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  odd i\n\ngoal (1 subgoal):\n 1. {0..<2 ^ (n + 1)} = {0..<i - 1} \\<union> {i - 1..<2 ^ (n + 1)} \\<and>\n    {i - 1..<2 ^ (n + 1)} = {i - 1, i} \\<union> {i + 1..<2 ^ (n + 1)}", "by auto"], ["proof (state)\nthis:\n  {0..<2 ^ (n + 1)} = {0..<i - 1} \\<union> {i - 1..<2 ^ (n + 1)} \\<and>\n  {i - 1..<2 ^ (n + 1)} = {i - 1, i} \\<union> {i + 1..<2 ^ (n + 1)}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  {0..<2 ^ (n + 1)} = {0..<i - 1} \\<union> {i - 1..<2 ^ (n + 1)} \\<and>\n  {i - 1..<2 ^ (n + 1)} = {i - 1, i} \\<union> {i + 1..<2 ^ (n + 1)}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"{0..<i-1} \\<inter> {i-1,i} = {} \n                  \\<and> {i-1,i} \\<inter> {i+1..< 2^(n+1)} = {} \n                  \\<and> {0..<i-1} \\<inter> {i+1..< 2^(n+1)} = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. {0..<i - 1} \\<inter> {i - 1, i} = {} \\<and>\n    {i - 1, i} \\<inter> {i + 1..<2 ^ (n + 1)} = {} \\<and>\n    {0..<i - 1} \\<inter> {i + 1..<2 ^ (n + 1)} = {}", "using assms"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  odd i\n  dim_col U\\<^sub>f = dim_row A\n\ngoal (1 subgoal):\n 1. {0..<i - 1} \\<inter> {i - 1, i} = {} \\<and>\n    {i - 1, i} \\<inter> {i + 1..<2 ^ (n + 1)} = {} \\<and>\n    {0..<i - 1} \\<inter> {i + 1..<2 ^ (n + 1)} = {}", "by simp"], ["proof (state)\nthis:\n  {0..<i - 1} \\<inter> {i - 1, i} = {} \\<and>\n  {i - 1, i} \\<inter> {i + 1..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i - 1} \\<inter> {i + 1..<2 ^ (n + 1)} = {}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "ultimately"], ["proof (chain)\npicking this:\n  {0..<2 ^ (n + 1)} = {0..<i - 1} \\<union> {i - 1..<2 ^ (n + 1)} \\<and>\n  {i - 1..<2 ^ (n + 1)} = {i - 1, i} \\<union> {i + 1..<2 ^ (n + 1)}\n  {0..<i - 1} \\<inter> {i - 1, i} = {} \\<and>\n  {i - 1, i} \\<inter> {i + 1..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i - 1} \\<inter> {i + 1..<2 ^ (n + 1)} = {}", "show ?thesis"], ["proof (prove)\nusing this:\n  {0..<2 ^ (n + 1)} = {0..<i - 1} \\<union> {i - 1..<2 ^ (n + 1)} \\<and>\n  {i - 1..<2 ^ (n + 1)} = {i - 1, i} \\<union> {i + 1..<2 ^ (n + 1)}\n  {0..<i - 1} \\<inter> {i - 1, i} = {} \\<and>\n  {i - 1, i} \\<inter> {i + 1..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i - 1} \\<inter> {i + 1..<2 ^ (n + 1)} = {}\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "using sum.union_disjoint"], ["proof (prove)\nusing this:\n  {0..<2 ^ (n + 1)} = {0..<i - 1} \\<union> {i - 1..<2 ^ (n + 1)} \\<and>\n  {i - 1..<2 ^ (n + 1)} = {i - 1, i} \\<union> {i + 1..<2 ^ (n + 1)}\n  {0..<i - 1} \\<inter> {i - 1, i} = {} \\<and>\n  {i - 1, i} \\<inter> {i + 1..<2 ^ (n + 1)} = {} \\<and>\n  {0..<i - 1} \\<inter> {i + 1..<2 ^ (n + 1)} = {}\n  \\<lbrakk>finite ?A; finite ?B; ?A \\<inter> ?B = {}\\<rbrakk>\n  \\<Longrightarrow> sum ?g (?A \\<union> ?B) = sum ?g ?A + sum ?g ?B\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n    (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by(metis (no_types, lifting) finite_Un finite_atLeastLessThan is_num_normalize(1) ivl_disj_int_two(3))"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(\\<Sum>k \\<in> {0..<i-1}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "have \"k \\<in> {0..<i-1} \\<longrightarrow> (i\\<noteq>k \\<and> \\<not>(i=k+1 \\<and> odd i) \\<and> \\<not> (i=k-1 \\<and> even i \\<and> k\\<ge>1))\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. k \\<in> {0..<i - 1} \\<longrightarrow>\n    i \\<noteq> k \\<and>\n    \\<not> (i = k + 1 \\<and> odd i) \\<and>\n    \\<not> (i = k - 1 \\<and> even i \\<and> 1 \\<le> k)", "by auto"], ["proof (state)\nthis:\n  ?k \\<in> {0..<i - 1} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "then"], ["proof (chain)\npicking this:\n  ?k \\<in> {0..<i - 1} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)", "have \"k \\<in> {0..<i-1} \\<longrightarrow> U\\<^sub>f $$ (i,k) = 0\" for k"], ["proof (prove)\nusing this:\n  ?k \\<in> {0..<i - 1} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n\ngoal (1 subgoal):\n 1. k \\<in> {0..<i - 1} \\<longrightarrow> U\\<^sub>f $$ (i, k) = 0", "using assms(1)"], ["proof (prove)\nusing this:\n  ?k \\<in> {0..<i - 1} \\<longrightarrow>\n  i \\<noteq> ?k \\<and>\n  \\<not> (i = ?k + 1 \\<and> odd i) \\<and>\n  \\<not> (i = ?k - 1 \\<and> even i \\<and> 1 \\<le> ?k)\n  i < dim_row U\\<^sub>f\n\ngoal (1 subgoal):\n 1. k \\<in> {0..<i - 1} \\<longrightarrow> U\\<^sub>f $$ (i, k) = 0", "by auto"], ["proof (state)\nthis:\n  ?k \\<in> {0..<i - 1} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "then"], ["proof (chain)\npicking this:\n  ?k \\<in> {0..<i - 1} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  ?k \\<in> {0..<i - 1} \\<longrightarrow> U\\<^sub>f $$ (i, ?k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(\\<Sum>k \\<in> {i+1..< 2^(n+1)}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "using assms(3)"], ["proof (prove)\nusing this:\n  odd i\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have  \"dim_row A = 2^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row A = 2 ^ (n + 1)", "using assms(4)"], ["proof (prove)\nusing this:\n  dim_col U\\<^sub>f = dim_row A\n\ngoal (1 subgoal):\n 1. dim_row A = 2 ^ (n + 1)", "by simp"], ["proof (state)\nthis:\n  dim_row A = 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  dim_row A = 2 ^ (n + 1)", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j)) +\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j))\n  (\\<Sum>k = 0..<i - 1. U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  (\\<Sum>k = i + 1..<2 ^ (n + 1). U\\<^sub>f $$ (i, k) * A $$ (k, j)) = 0\n  dim_row A = 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by(metis (no_types, lifting) add.left_neutral add.right_neutral)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j)) =\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) U\\<^sub>f_mult_without_empty_summands_odd: \n  fixes i j A\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col A\" and \"odd i\" and \"dim_col U\\<^sub>f = dim_row A\"\n  shows \"(U\\<^sub>f * A) $$ (i,j) = (\\<Sum>k \\<in> {i-1,i}. U\\<^sub>f $$ (i,k) * A $$ (k,j)) \""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "have \"(U\\<^sub>f * A) $$ (i,j) = (\\<Sum>k \\<in> {0 ..< dim_row A}. (U\\<^sub>f $$ (i,k)) * (A $$ (k,j)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "using assms(1,2,4) index_matrix_prod"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  dim_col U\\<^sub>f = dim_row A\n  \\<lbrakk>?i < dim_row ?A; ?j < dim_col ?B;\n   dim_col ?A = dim_row ?B\\<rbrakk>\n  \\<Longrightarrow> (?A * ?B) $$ (?i, ?j) =\n                    (\\<Sum>k<dim_row ?B. ?A $$ (?i, k) * ?B $$ (k, ?j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by (simp add: atLeast0LessThan)"], ["proof (state)\nthis:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "then"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "using assms U\\<^sub>f_mult_without_empty_summands_sum_odd"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k = 0..<dim_row A. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n  i < dim_row U\\<^sub>f\n  j < dim_col A\n  odd i\n  dim_col U\\<^sub>f = dim_row A\n  \\<lbrakk>?i < dim_row U\\<^sub>f; ?j < dim_col ?A; odd ?i;\n   dim_col U\\<^sub>f = dim_row ?A\\<rbrakk>\n  \\<Longrightarrow> (\\<Sum>k = 0..<dim_row ?A.\n                        U\\<^sub>f $$ (?i, k) * ?A $$ (k, ?j)) =\n                    (\\<Sum>k\\<in>{?i - 1, ?i}.\n                       U\\<^sub>f $$ (?i, k) * ?A $$ (k, ?j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * A) $$ (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))", "by auto"], ["proof (state)\nthis:\n  (U\\<^sub>f * A) $$ (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * A $$ (k, j))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>@{term U\\<^sub>f} is a gate.\\<close>"], ["", "lemma (in jozsa) transpose_of_jozsa_transform:\n  shows \"(U\\<^sub>f)\\<^sup>t = U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t = U\\<^sub>f", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. dim_row U\\<^sub>f\\<^sup>t = dim_row U\\<^sub>f\n 3. dim_col U\\<^sub>f\\<^sup>t = dim_col U\\<^sub>f", "show \"dim_row (U\\<^sub>f\\<^sup>t) = dim_row U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row U\\<^sub>f\\<^sup>t = dim_row U\\<^sub>f", "by simp"], ["proof (state)\nthis:\n  dim_row U\\<^sub>f\\<^sup>t = dim_row U\\<^sub>f\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. dim_col U\\<^sub>f\\<^sup>t = dim_col U\\<^sub>f", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. dim_col U\\<^sub>f\\<^sup>t = dim_col U\\<^sub>f", "show \"dim_col (U\\<^sub>f\\<^sup>t) = dim_col U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col U\\<^sub>f\\<^sup>t = dim_col U\\<^sub>f", "by simp"], ["proof (state)\nthis:\n  dim_col U\\<^sub>f\\<^sup>t = dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "fix i j:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "assume a0: \"i < dim_row U\\<^sub>f\" and a1: \"j < dim_col U\\<^sub>f\""], ["proof (state)\nthis:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f", "show \"U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\""], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "proof (induct rule: disj_four_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. ?A4 \\<or> ?B4 \\<or> ?C4 \\<or> ?D4\n 2. \\<lbrakk>?A4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>?B4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>?C4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 5. \\<lbrakk>?D4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "show \"i=j \\<or> (i=j+1 \\<and> odd i) \\<or> (i=j-1 \\<and> even i \\<and> j\\<ge>1) \\<or> (i\\<noteq>j \\<and> \\<not>(i=j+1 \\<and> odd i) \\<and> \\<not> (i=j-1 \\<and> even i \\<and> j\\<ge>1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i = j \\<or>\n    i = j + 1 \\<and> odd i \\<or>\n    i = j - 1 \\<and> even i \\<and> 1 \\<le> j \\<or>\n    i \\<noteq> j \\<and>\n    \\<not> (i = j + 1 \\<and> odd i) \\<and>\n    \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)", "by linarith"], ["proof (state)\nthis:\n  i = j \\<or>\n  i = j + 1 \\<and> odd i \\<or>\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j \\<or>\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (4 subgoals):\n 1. \\<lbrakk>i = j; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<lbrakk>i = j; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "assume \"i = j\""], ["proof (state)\nthis:\n  i = j\n\ngoal (4 subgoals):\n 1. \\<lbrakk>i = j; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i = j", "show \"U\\<^sub>f\\<^sup>t $$ (i,j) = U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  i = j\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "using a0"], ["proof (prove)\nusing this:\n  i = j\n  i < dim_row U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "assume \"(i=j+1 \\<and> odd i)\""], ["proof (state)\nthis:\n  i = j + 1 \\<and> odd i\n\ngoal (3 subgoals):\n 1. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i = j + 1 \\<and> odd i", "show \"U\\<^sub>f\\<^sup>t $$ (i,j) = U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  i = j + 1 \\<and> odd i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "using transpose_mat_def a0 a1"], ["proof (prove)\nusing this:\n  i = j + 1 \\<and> odd i\n  ?A\\<^sup>t \\<equiv>\n  Matrix.mat (dim_col ?A) (dim_row ?A) (\\<lambda>(i, j). ?A $$ (j, i))\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "assume a2:\"(i=j-1 \\<and> even i \\<and> j\\<ge>1)\""], ["proof (state)\nthis:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j", "have \"U\\<^sub>f $$ (i,j) = f (i div 2)\""], ["proof (prove)\nusing this:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "using a0 a1 jozsa_transform_coeff"], ["proof (prove)\nusing this:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (1 - f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j + 1 \\<and> odd ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  1 \\<le> ?j \\<and> ?i = ?j - 1 \\<and> even ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "have \"U\\<^sub>f $$ (j,i) = f (i div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (j, i) = of_nat (f (i div 2))", "using a0 a1 a2 jozsa_transform_coeff"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (1 - f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j + 1 \\<and> odd ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  1 \\<le> ?j \\<and> ?i = ?j - 1 \\<and> even ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (j, i) = of_nat (f (i div 2))", "by (metis add_diff_assoc2 diff_add_inverse2 even_plus_one_iff even_succ_div_two jozsa_transform_dim)"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (j, i) = of_nat (f (i div 2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f $$ (j, i) = of_nat (f (i div 2))", "show \"?thesis\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f $$ (j, i) = of_nat (f (i div 2))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "using transpose_mat_def a0 a1"], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f $$ (j, i) = of_nat (f (i div 2))\n  ?A\\<^sup>t \\<equiv>\n  Matrix.mat (dim_col ?A) (dim_row ?A) (\\<lambda>(i, j). ?A $$ (j, i))\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "assume a2:\"(i\\<noteq>j \\<and> \\<not>(i=j+1 \\<and> odd i) \\<and> \\<not> (i=j-1 \\<and> even i \\<and> j\\<ge>1))\""], ["proof (state)\nthis:\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)", "have \"(j\\<noteq>i \\<and> \\<not>(j=i+1 \\<and> odd j) \\<and> \\<not> (j=i-1 \\<and> even j \\<and> i\\<ge>1))\""], ["proof (prove)\nusing this:\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (1 subgoal):\n 1. j \\<noteq> i \\<and>\n    \\<not> (j = i + 1 \\<and> odd j) \\<and>\n    \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "by (metis le_imp_diff_is_add diff_add_inverse even_plus_one_iff le_add1)"], ["proof (state)\nthis:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "have \"U\\<^sub>f $$ (j,i) = 0\""], ["proof (prove)\nusing this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (j, i) = 0", "using jozsa_transform_coeff_is_zero a0 a1"], ["proof (prove)\nusing this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i \\<noteq> ?j \\<and>\n  \\<not> (?i = ?j + 1 \\<and> odd ?i) \\<and>\n  \\<not> (?i = ?j - 1 \\<and> even ?i \\<and> 1 \\<le> ?j) \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = 0\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (j, i) = 0", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (j, i) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (j, i) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "have \"U\\<^sub>f $$ (i,j) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = 0", "using jozsa_transform_coeff_is_zero a0 a1 a2"], ["proof (prove)\nusing this:\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i \\<noteq> ?j \\<and>\n  \\<not> (?i = ?j + 1 \\<and> odd ?i) \\<and>\n  \\<not> (?i = ?j - 1 \\<and> even ?i \\<and> 1 \\<le> ?j) \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = 0\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = 0", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (j, i) = 0\n  U\\<^sub>f $$ (i, j) = 0", "show \"U\\<^sub>f\\<^sup>t $$ (i,j) = U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (j, i) = 0\n  U\\<^sub>f $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "using transpose_mat_def a0 a1"], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (j, i) = 0\n  U\\<^sub>f $$ (i, j) = 0\n  ?A\\<^sup>t \\<equiv>\n  Matrix.mat (dim_col ?A) (dim_row ?A) (\\<lambda>(i, j). ?A $$ (j, i))\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>t $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) adjoint_of_jozsa_transform: \n  shows \"(U\\<^sub>f)\\<^sup>\\<dagger> = U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> = U\\<^sub>f", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                         U\\<^sub>f $$ (i, j)\n 2. dim_row U\\<^sub>f\\<^sup>\\<dagger> = dim_row U\\<^sub>f\n 3. dim_col U\\<^sub>f\\<^sup>\\<dagger> = dim_col U\\<^sub>f", "show \"dim_row (U\\<^sub>f\\<^sup>\\<dagger>) = dim_row U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row U\\<^sub>f\\<^sup>\\<dagger> = dim_row U\\<^sub>f", "by simp"], ["proof (state)\nthis:\n  dim_row U\\<^sub>f\\<^sup>\\<dagger> = dim_row U\\<^sub>f\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                         U\\<^sub>f $$ (i, j)\n 2. dim_col U\\<^sub>f\\<^sup>\\<dagger> = dim_col U\\<^sub>f", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                         U\\<^sub>f $$ (i, j)\n 2. dim_col U\\<^sub>f\\<^sup>\\<dagger> = dim_col U\\<^sub>f", "show \"dim_col (U\\<^sub>f\\<^sup>\\<dagger>) = dim_col U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col U\\<^sub>f\\<^sup>\\<dagger> = dim_col U\\<^sub>f", "by simp"], ["proof (state)\nthis:\n  dim_col U\\<^sub>f\\<^sup>\\<dagger> = dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                         U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                         U\\<^sub>f $$ (i, j)", "fix i j:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                         U\\<^sub>f $$ (i, j)", "assume a0: \"i < dim_row U\\<^sub>f\" and a1: \"j < dim_col U\\<^sub>f\""], ["proof (state)\nthis:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n       \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                         U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f", "show \"U\\<^sub>f\\<^sup>\\<dagger> $$ (i,j) = U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "proof (induct rule: disj_four_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. ?A4 \\<or> ?B4 \\<or> ?C4 \\<or> ?D4\n 2. \\<lbrakk>?A4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>?B4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>?C4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 5. \\<lbrakk>?D4; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "show \"i=j \\<or> (i=j+1 \\<and> odd i) \\<or> (i=j-1 \\<and> even i \\<and> j\\<ge>1) \\<or> (i\\<noteq>j \\<and> \\<not>(i=j+1 \\<and> odd i) \\<and> \\<not> (i=j-1 \\<and> even i \\<and> j\\<ge>1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i = j \\<or>\n    i = j + 1 \\<and> odd i \\<or>\n    i = j - 1 \\<and> even i \\<and> 1 \\<le> j \\<or>\n    i \\<noteq> j \\<and>\n    \\<not> (i = j + 1 \\<and> odd i) \\<and>\n    \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)", "by linarith"], ["proof (state)\nthis:\n  i = j \\<or>\n  i = j + 1 \\<and> odd i \\<or>\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j \\<or>\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (4 subgoals):\n 1. \\<lbrakk>i = j; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<lbrakk>i = j; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "assume \"i=j\""], ["proof (state)\nthis:\n  i = j\n\ngoal (4 subgoals):\n 1. \\<lbrakk>i = j; i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 4. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i = j", "show \"U\\<^sub>f\\<^sup>\\<dagger> $$ (i,j) = U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  i = j\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "using a0 dagger_def"], ["proof (prove)\nusing this:\n  i = j\n  i < dim_row U\\<^sub>f\n  ?M\\<^sup>\\<dagger> \\<equiv>\n  Matrix.mat (dim_col ?M) (dim_row ?M) (\\<lambda>(i, j). cnj (?M $$ (j, i)))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "assume \"(i=j+1 \\<and> odd i)\""], ["proof (state)\nthis:\n  i = j + 1 \\<and> odd i\n\ngoal (3 subgoals):\n 1. \\<lbrakk>i = j + 1 \\<and> odd i; i < dim_row U\\<^sub>f;\n     j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 3. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i = j + 1 \\<and> odd i", "show \"U\\<^sub>f\\<^sup>\\<dagger> $$ (i,j) = U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  i = j + 1 \\<and> odd i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "using a0 dagger_def"], ["proof (prove)\nusing this:\n  i = j + 1 \\<and> odd i\n  i < dim_row U\\<^sub>f\n  ?M\\<^sup>\\<dagger> \\<equiv>\n  Matrix.mat (dim_col ?M) (dim_row ?M) (\\<lambda>(i, j). cnj (?M $$ (j, i)))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "assume a2:\"(i=j-1 \\<and> even i \\<and> j\\<ge>1)\""], ["proof (state)\nthis:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j", "have \"U\\<^sub>f $$ (i,j) = f (i div 2)\""], ["proof (prove)\nusing this:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "using a0 a1 jozsa_transform_coeff"], ["proof (prove)\nusing this:\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (1 - f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j + 1 \\<and> odd ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  1 \\<le> ?j \\<and> ?i = ?j - 1 \\<and> even ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "have \"U\\<^sub>f\\<^sup>\\<dagger>  $$ (j,i) = f (i div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (j, i) = of_nat (f (i div 2))", "using a1 a2 jozsa_transform_coeff dagger_def"], ["proof (prove)\nusing this:\n  j < dim_col U\\<^sub>f\n  i = j - 1 \\<and> even i \\<and> 1 \\<le> j\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (1 - f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i = ?j + 1 \\<and> odd ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  1 \\<le> ?j \\<and> ?i = ?j - 1 \\<and> even ?i \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = of_nat (f (?i div 2))\n  ?M\\<^sup>\\<dagger> \\<equiv>\n  Matrix.mat (dim_col ?M) (dim_row ?M) (\\<lambda>(i, j). cnj (?M $$ (j, i)))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (j, i) = of_nat (f (i div 2))", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (j, i) = of_nat (f (i div 2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>i = j - 1 \\<and> even i \\<and> 1 \\<le> j;\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)\n 2. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (j, i) = of_nat (f (i div 2))", "show \"U\\<^sub>f\\<^sup>\\<dagger> $$ (i,j) = U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (j, i) = of_nat (f (i div 2))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "by(metis a0 a1 cnj_transpose_is_dagger dim_row_of_dagger index_transpose_mat dagger_of_transpose_is_cnj transpose_of_jozsa_transform)"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "assume a2: \"(i\\<noteq>j \\<and> \\<not>(i=j+1 \\<and> odd i) \\<and> \\<not> (i=j-1 \\<and> even i \\<and> j\\<ge>1))\""], ["proof (state)\nthis:\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)", "have f0:\"(i\\<noteq>j \\<and> \\<not>(j=i+1 \\<and> odd j) \\<and> \\<not> (j=i-1 \\<and> even j \\<and> i\\<ge>1))\""], ["proof (prove)\nusing this:\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (1 subgoal):\n 1. i \\<noteq> j \\<and>\n    \\<not> (j = i + 1 \\<and> odd j) \\<and>\n    \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "by (metis le_imp_diff_is_add diff_add_inverse even_plus_one_iff le_add1)"], ["proof (state)\nthis:\n  i \\<noteq> j \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i \\<noteq> j \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "have \"U\\<^sub>f $$ (j,i) = 0\" and \"cnj 0 = 0\""], ["proof (prove)\nusing this:\n  i \\<noteq> j \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (j, i) = 0 &&& cnj 0 = 0", "using jozsa_transform_coeff_is_zero a0 a1 a2"], ["proof (prove)\nusing this:\n  i \\<noteq> j \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i \\<noteq> ?j \\<and>\n  \\<not> (?i = ?j + 1 \\<and> odd ?i) \\<and>\n  \\<not> (?i = ?j - 1 \\<and> even ?i \\<and> 1 \\<le> ?j) \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = 0\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (j, i) = 0 &&& cnj 0 = 0", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (j, i) = 0\n  cnj 0 = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (j, i) = 0\n  cnj 0 = 0", "have \"U\\<^sub>f\\<^sup>\\<dagger> $$ (i,j) = 0\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (j, i) = 0\n  cnj 0 = 0\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = 0", "using a0 a1 dagger_def"], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (j, i) = 0\n  cnj 0 = 0\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  ?M\\<^sup>\\<dagger> \\<equiv>\n  Matrix.mat (dim_col ?M) (dim_row ?M) (\\<lambda>(i, j). cnj (?M $$ (j, i)))\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = 0", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<noteq> j \\<and>\n             \\<not> (i = j + 1 \\<and> odd i) \\<and>\n             \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j);\n     i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f\\<rbrakk>\n    \\<Longrightarrow> U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) =\n                      U\\<^sub>f $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = 0", "show \"U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)\""], ["proof (prove)\nusing this:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "using a0 a1 a2 jozsa_transform_coeff_is_zero"], ["proof (prove)\nusing this:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = 0\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  i \\<noteq> j \\<and>\n  \\<not> (i = j + 1 \\<and> odd i) \\<and>\n  \\<not> (i = j - 1 \\<and> even i \\<and> 1 \\<le> j)\n  ?i < dim_row U\\<^sub>f \\<and> ?j < dim_col U\\<^sub>f \\<Longrightarrow>\n  ?i \\<noteq> ?j \\<and>\n  \\<not> (?i = ?j + 1 \\<and> odd ?i) \\<and>\n  \\<not> (?i = ?j - 1 \\<and> even ?i \\<and> 1 \\<le> ?j) \\<longrightarrow>\n  U\\<^sub>f $$ (?i, ?j) = 0\n\ngoal (1 subgoal):\n 1. U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  U\\<^sub>f\\<^sup>\\<dagger> $$ (i, j) = U\\<^sub>f $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) jozsa_transform_is_unitary_index_even:\n  fixes i j:: nat\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col U\\<^sub>f\" and \"even i\"\n  shows \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = (\\<Sum>k \\<in> {i,i+1}. U\\<^sub>f $$ (i,k) * U\\<^sub>f $$ (k,j)) \""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))", "using U\\<^sub>f_mult_without_empty_summands_even[of i j U\\<^sub>f ] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f; even i;\n   dim_col U\\<^sub>f = dim_row U\\<^sub>f\\<rbrakk>\n  \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                    (\\<Sum>k\\<in>{i, i + 1}.\n                       U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  even i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"U\\<^sub>f $$ (i,i) * U\\<^sub>f $$ (i,j) = (1-f(i div 2)) * U\\<^sub>f $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n    of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)", "using assms(1,3)"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  even i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n    of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have f0: \"U\\<^sub>f $$ (i,i+1) * U\\<^sub>f $$ (i+1,j) = f(i div 2) * U\\<^sub>f $$ (i+1,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i + 1) * U\\<^sub>f $$ (i + 1, j) =\n    of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)", "by (metis One_nat_def Suc_leI add.right_neutral add_Suc_right assms(1) assms(3) diff_add_inverse2 \neven_add even_mult_iff jozsa_transform_coeff(3) jozsa_transform_dim le_add2 le_eq_less_or_eq odd_one \none_add_one power.simps(2))"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i + 1) * U\\<^sub>f $$ (i + 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n  U\\<^sub>f $$ (i, i + 1) * U\\<^sub>f $$ (i + 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)", "have f1: \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = (1-f(i div 2)) * U\\<^sub>f $$ (i,j) +  f(i div 2) * U\\<^sub>f $$ (i+1,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n  U\\<^sub>f $$ (i, i + 1) * U\\<^sub>f $$ (i + 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n    of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)", "by auto"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "thus ?thesis"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "proof (induct rule: disj_four_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. ?A2 \\<or> ?B2 \\<or> ?C2 \\<or> ?D2\n 2. \\<lbrakk>?A2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>?B2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>?C2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 5. \\<lbrakk>?D2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "show \"j=i \\<or> (j=i+1 \\<and> odd j) \\<or> (j=i-1 \\<and> even j \\<and> i\\<ge>1) \\<or> (j\\<noteq>i \\<and> \\<not>(j=i+1 \\<and> odd j) \\<and> \\<not> (j=i-1 \\<and> even j \\<and> i\\<ge>1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. j = i \\<or>\n    j = i + 1 \\<and> odd j \\<or>\n    j = i - 1 \\<and> even j \\<and> 1 \\<le> i \\<or>\n    j \\<noteq> i \\<and>\n    \\<not> (j = i + 1 \\<and> odd j) \\<and>\n    \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "by linarith"], ["proof (state)\nthis:\n  j = i \\<or>\n  j = i + 1 \\<and> odd j \\<or>\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i \\<or>\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume a0:\"j=i\""], ["proof (state)\nthis:\n  j = i\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j = i", "have \"U\\<^sub>f $$ (i,j) = (1-f(i div 2))\""], ["proof (prove)\nusing this:\n  j = i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))", "using assms(1,2) a0"], ["proof (prove)\nusing this:\n  j = i\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  j = i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"U\\<^sub>f $$ (i+1,j) = f(i div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i + 1, j) = of_nat (f (i div 2))", "using assms(1,3) a0"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  even i\n  j = i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i + 1, j) = of_nat (f (i div 2))", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i + 1, j) = of_nat (f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n  U\\<^sub>f $$ (i + 1, j) = of_nat (f (i div 2))", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = (1-f(i div 2)) * (1-f(i div 2)) +  f(i div 2) * f(i div 2)\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n  U\\<^sub>f $$ (i + 1, j) = of_nat (f (i div 2))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     ((1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2))", "using f1"], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n  U\\<^sub>f $$ (i + 1, j) = of_nat (f (i div 2))\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     ((1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"(1-f(i div 2)) * (1-f(i div 2)) + f(i div 2) * f(i div 2) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2) = 1", "using f_values assms(1)"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n  i < dim_row U\\<^sub>f\n\ngoal (1 subgoal):\n 1. (1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2) = 1", "by (metis (no_types, lifting) Nat.minus_nat.diff_0 diff_add_0 diff_add_inverse jozsa_transform_dim(1) \n          less_power_add_imp_div_less mem_Collect_eq mult_eq_if one_power2 power2_eq_square power_one_right)"], ["proof (state)\nthis:\n  (1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2) = 1\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2))\n  (1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2) = 1", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2))\n  (1 - f (i div 2)) * (1 - f (i div 2)) + f (i div 2) * f (i div 2) = 1\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by(metis assms(2) a0 index_one_mat(1) of_nat_1)"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume a0: \"(j=i+1 \\<and> odd j)\""], ["proof (state)\nthis:\n  j = i + 1 \\<and> odd j\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j = i + 1 \\<and> odd j", "have \"U\\<^sub>f $$ (i,j) = f(i div 2)\""], ["proof (prove)\nusing this:\n  j = i + 1 \\<and> odd j\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "using assms(1,2) a0"], ["proof (prove)\nusing this:\n  j = i + 1 \\<and> odd j\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  j = i + 1 \\<and> odd j\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"U\\<^sub>f $$ (i+1,j) = (1-f(i div 2))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i + 1, j) = of_nat (1 - f (i div 2))", "using assms(2,3) a0"], ["proof (prove)\nusing this:\n  j < dim_col U\\<^sub>f\n  even i\n  j = i + 1 \\<and> odd j\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i + 1, j) = of_nat (1 - f (i div 2))", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i + 1, j) = of_nat (1 - f (i div 2))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f $$ (i + 1, j) = of_nat (1 - f (i div 2))", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = (1-f(i div 2)) * f(i div 2) + f(i div 2) * (1-f(i div 2))\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f $$ (i + 1, j) = of_nat (1 - f (i div 2))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     ((1 - f (i div 2)) * f (i div 2) + f (i div 2) * (1 - f (i div 2)))", "using f0 f1 assms"], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (f (i div 2))\n  U\\<^sub>f $$ (i + 1, j) = of_nat (1 - f (i div 2))\n  U\\<^sub>f $$ (i, i + 1) * U\\<^sub>f $$ (i + 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  even i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     ((1 - f (i div 2)) * f (i div 2) + f (i div 2) * (1 - f (i div 2)))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * f (i div 2) + f (i div 2) * (1 - f (i div 2)))\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * f (i div 2) + f (i div 2) * (1 - f (i div 2)))", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * f (i div 2) + f (i div 2) * (1 - f (i div 2)))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "using assms(1,2) a0"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * f (i div 2) + f (i div 2) * (1 - f (i div 2)))\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  j = i + 1 \\<and> odd j\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by auto"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume \"(j=i-1 \\<and> even j \\<and> i\\<ge>1)\""], ["proof (state)\nthis:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i\n\ngoal (2 subgoals):\n 1. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "using assms(3) dvd_diffD1 odd_one"], ["proof (prove)\nusing this:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i\n  even i\n  \\<lbrakk>?k dvd ?m - ?n; ?k dvd ?m; ?n \\<le> ?m\\<rbrakk>\n  \\<Longrightarrow> ?k dvd ?n\n  odd (1::?'a)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by blast"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume a0:\"(j\\<noteq>i \\<and> \\<not>(j=i+1 \\<and> odd j) \\<and> \\<not> (j=i-1 \\<and> even j \\<and> i\\<ge>1))\""], ["proof (state)\nthis:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "have \"U\\<^sub>f $$ (i,j) = 0\""], ["proof (prove)\nusing this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = 0", "using assms(1,2)"], ["proof (prove)\nusing this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = 0", "by(metis index_transpose_mat(1) jozsa_transform_coeff_is_zero jozsa_transform_dim transpose_of_jozsa_transform)"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"U\\<^sub>f $$ (i+1,j) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i + 1, j) = 0", "using assms a0"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  even i\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i + 1, j) = 0", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i + 1, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (i, j) = 0\n  U\\<^sub>f $$ (i + 1, j) = 0", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = (1-f(i div 2)) * 0 +  f(i div 2) * 0\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = 0\n  U\\<^sub>f $$ (i + 1, j) = 0\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)", "by (simp add: f1)"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j) +\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i + 1, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "using a0 assms(1,2)"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by(metis add.left_neutral index_one_mat(1) jozsa_transform_dim mult_0_right of_nat_0)"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) jozsa_transform_is_unitary_index_odd:\n  fixes i j:: nat\n  assumes \"i < dim_row U\\<^sub>f\" and \"j < dim_col U\\<^sub>f\" and \"odd i\"\n  shows \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have f0: \"i \\<ge> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 \\<le> i", "using linorder_not_less assms(3)"], ["proof (prove)\nusing this:\n  (\\<not> ?x < ?y) = (?y \\<le> ?x)\n  odd i\n\ngoal (1 subgoal):\n 1. 1 \\<le> i", "by auto"], ["proof (state)\nthis:\n  1 \\<le> i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = (\\<Sum>k \\<in> {i-1,i}. U\\<^sub>f $$ (i,k) * U\\<^sub>f $$ (k,j)) \""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))", "using U\\<^sub>f_mult_without_empty_summands_odd[of i j U\\<^sub>f ] assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>i < dim_row U\\<^sub>f; j < dim_col U\\<^sub>f; odd i;\n   dim_col U\\<^sub>f = dim_row U\\<^sub>f\\<rbrakk>\n  \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                    (\\<Sum>k\\<in>{i - 1, i}.\n                       U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  odd i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"(\\<Sum>k \\<in> {i-1,i}. U\\<^sub>f $$ (i,k) * U\\<^sub>f $$ (k,j)) \n                 = U\\<^sub>f $$ (i,i-1) * U\\<^sub>f $$ (i-1,j) +  U\\<^sub>f $$ (i,i) * U\\<^sub>f $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j)) =\n    U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) +\n    U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j)", "using f0"], ["proof (prove)\nusing this:\n  1 \\<le> i\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j)) =\n    U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) +\n    U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) +\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) +\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"U\\<^sub>f $$ (i,i) * U\\<^sub>f $$ (i,j) = (1-f(i div 2)) * U\\<^sub>f $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n    of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)", "using assms(1,2)"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n    of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have f1: \"U\\<^sub>f $$ (i,i-1) * U\\<^sub>f $$ (i-1,j) = f(i div 2) * U\\<^sub>f $$ (i-1,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) =\n    of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j)", "using assms(1) assms(3)"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  odd i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) =\n    of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j)", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) +\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j)\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j)", "have f2: \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = f(i div 2) * U\\<^sub>f $$ (i-1,j) + (1-f(i div 2)) * U\\<^sub>f $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j))\n  (\\<Sum>k\\<in>{i - 1, i}. U\\<^sub>f $$ (i, k) * U\\<^sub>f $$ (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) +\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j)\n  U\\<^sub>f $$ (i, i) * U\\<^sub>f $$ (i, j) =\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n    of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "proof (induct rule: disj_four_cases)"], ["proof (state)\ngoal (5 subgoals):\n 1. ?A2 \\<or> ?B2 \\<or> ?C2 \\<or> ?D2\n 2. \\<lbrakk>?A2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>?B2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>?C2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 5. \\<lbrakk>?D2;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "show \"j=i \\<or> (j=i+1 \\<and> odd j) \\<or> (j=i-1 \\<and> even j \\<and> i\\<ge>1) \\<or> (j\\<noteq>i \\<and> \\<not>(j=i+1 \\<and> odd j) \\<and> \\<not> (j=i-1 \\<and> even j \\<and> i\\<ge>1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. j = i \\<or>\n    j = i + 1 \\<and> odd j \\<or>\n    j = i - 1 \\<and> even j \\<and> 1 \\<le> i \\<or>\n    j \\<noteq> i \\<and>\n    \\<not> (j = i + 1 \\<and> odd j) \\<and>\n    \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "by linarith"], ["proof (state)\nthis:\n  j = i \\<or>\n  j = i + 1 \\<and> odd j \\<or>\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i \\<or>\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume a0:\"j=i\""], ["proof (state)\nthis:\n  j = i\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j = i", "have \"U\\<^sub>f $$ (i,j) = (1-f(i div 2))\""], ["proof (prove)\nusing this:\n  j = i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))", "using assms(1,2)"], ["proof (prove)\nusing this:\n  j = i\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"U\\<^sub>f $$ (i-1,j) = f(i div 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i - 1, j) = of_nat (f (i div 2))", "using a0 assms"], ["proof (prove)\nusing this:\n  j = i\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  odd i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i - 1, j) = of_nat (f (i div 2))", "by (metis index_transpose_mat(1) jozsa_transform_coeff(2) less_imp_diff_less odd_two_times_div_two_nat \n          odd_two_times_div_two_succ transpose_of_jozsa_transform)"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i - 1, j) = of_nat (f (i div 2))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n  U\\<^sub>f $$ (i - 1, j) = of_nat (f (i div 2))", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = f(i div 2) * f(i div 2) + (1-f(i div 2)) * (1-f(i div 2))\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n  U\\<^sub>f $$ (i - 1, j) = of_nat (f (i div 2))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     (f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)))", "using f2"], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = of_nat (1 - f (i div 2))\n  U\\<^sub>f $$ (i - 1, j) = of_nat (f (i div 2))\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     (f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)))\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"f(i div 2) * f(i div 2) + (1-f(i div 2)) * (1-f(i div 2)) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)) = 1", "using f_values assms(1)"], ["proof (prove)\nusing this:\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n  i < dim_row U\\<^sub>f\n\ngoal (1 subgoal):\n 1. f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)) = 1", "by (metis (no_types, lifting) Nat.minus_nat.diff_0 diff_add_0 diff_add_inverse jozsa_transform_dim(1) \n          less_power_add_imp_div_less mem_Collect_eq mult_eq_if one_power2 power2_eq_square power_one_right)"], ["proof (state)\nthis:\n  f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)) = 1\n\ngoal (4 subgoals):\n 1. \\<lbrakk>j = i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 4. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)))\n  f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)) = 1", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)))\n  f (i div 2) * f (i div 2) + (1 - f (i div 2)) * (1 - f (i div 2)) = 1\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by(metis assms(2) a0 index_one_mat(1) of_nat_1)"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume a0:\"(j=i+1 \\<and> odd j)\""], ["proof (state)\nthis:\n  j = i + 1 \\<and> odd j\n\ngoal (3 subgoals):\n 1. \\<lbrakk>j = i + 1 \\<and> odd j;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 3. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j = i + 1 \\<and> odd j", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  j = i + 1 \\<and> odd j\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "using assms(3) dvd_diffD1 odd_one even_plus_one_iff"], ["proof (prove)\nusing this:\n  j = i + 1 \\<and> odd j\n  odd i\n  \\<lbrakk>?k dvd ?m - ?n; ?k dvd ?m; ?n \\<le> ?m\\<rbrakk>\n  \\<Longrightarrow> ?k dvd ?n\n  odd (1::?'a)\n  even (?a + (1::?'a)) = odd ?a\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by blast"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal (2 subgoals):\n 1. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume a0:\"(j=i-1 \\<and> even j \\<and> i\\<ge>1)\""], ["proof (state)\nthis:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i\n\ngoal (2 subgoals):\n 1. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = f(i div 2) * (1-f(i div 2)) + (1-f(i div 2)) * f(i div 2)\""], ["proof (prove)\nusing this:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     (f (i div 2) * (1 - f (i div 2)) + (1 - f (i div 2)) * f (i div 2))", "using f0 f1 f2 assms"], ["proof (prove)\nusing this:\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i\n  1 \\<le> i\n  U\\<^sub>f $$ (i, i - 1) * U\\<^sub>f $$ (i - 1, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j)\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  odd i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat\n     (f (i div 2) * (1 - f (i div 2)) + (1 - f (i div 2)) * f (i div 2))", "by (metis jozsa_transform_coeff(1) Groups.ab_semigroup_mult_class.mult.commute even_succ_div_two f2 \n          jozsa_transform_dim odd_two_times_div_two_nat odd_two_times_div_two_succ of_nat_add of_nat_mult)"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * (1 - f (i div 2)) + (1 - f (i div 2)) * f (i div 2))\n\ngoal (2 subgoals):\n 1. \\<lbrakk>j = i - 1 \\<and> even j \\<and> 1 \\<le> i;\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * (1 - f (i div 2)) + (1 - f (i div 2)) * f (i div 2))", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * (1 - f (i div 2)) + (1 - f (i div 2)) * f (i div 2))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "using assms(1) a0"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2) * (1 - f (i div 2)) + (1 - f (i div 2)) * f (i div 2))\n  i < dim_row U\\<^sub>f\n  j = i - 1 \\<and> even j \\<and> 1 \\<le> i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by auto"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume a0:\"j\\<noteq>i \\<and> \\<not>(j=i+1 \\<and> odd j) \\<and> \\<not> (j=i-1 \\<and> even j \\<and> i\\<ge>1)\""], ["proof (state)\nthis:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)", "have \"U\\<^sub>f $$ (i,j) = 0\""], ["proof (prove)\nusing this:\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, j) = 0", "by (metis assms(1,2) index_transpose_mat(1) jozsa_transform_coeff_is_zero jozsa_transform_dim transpose_of_jozsa_transform)"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "have \"U\\<^sub>f $$ (i-1,j) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i - 1, j) = 0", "using assms a0 f0"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  odd i\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n  1 \\<le> i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i - 1, j) = 0", "by auto (smt One_nat_def Suc_n_not_le_n add_diff_inverse_nat assms(1) assms(2) diff_Suc_less even_add \njozsa_transform_coeff_is_zero jozsa_axioms less_imp_le less_le_trans less_one odd_one)"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i - 1, j) = 0\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  U\\<^sub>f $$ (i, j) = 0\n  U\\<^sub>f $$ (i - 1, j) = 0", "have \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = (1-f(i div 2)) * 0 +  f(i div 2) * 0\""], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = 0\n  U\\<^sub>f $$ (i - 1, j) = 0\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)", "using f2"], ["proof (prove)\nusing this:\n  U\\<^sub>f $$ (i, j) = 0\n  U\\<^sub>f $$ (i - 1, j) = 0\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n  of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>j \\<noteq> i \\<and>\n             \\<not> (j = i + 1 \\<and> odd j) \\<and>\n             \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i);\n     (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n     of_nat (f (i div 2)) * U\\<^sub>f $$ (i - 1, j) +\n     of_nat (1 - f (i div 2)) * U\\<^sub>f $$ (i, j)\\<rbrakk>\n    \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                      1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "using a0 assms"], ["proof (prove)\nusing this:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  of_nat ((1 - f (i div 2)) * 0 + f (i div 2) * 0)\n  j \\<noteq> i \\<and>\n  \\<not> (j = i + 1 \\<and> odd j) \\<and>\n  \\<not> (j = i - 1 \\<and> even j \\<and> 1 \\<le> i)\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  odd i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by (metis add.left_neutral index_one_mat(1) jozsa_transform_dim mult_0_right of_nat_0)"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) jozsa_transform_is_gate:\n  shows \"gate (n+1) U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate (n + 1) U\\<^sub>f", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. dim_row U\\<^sub>f = 2 ^ (n + 1)\n 2. square_mat U\\<^sub>f\n 3. unitary U\\<^sub>f", "show \"dim_row U\\<^sub>f = 2^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row U\\<^sub>f = 2 ^ (n + 1)", "by simp"], ["proof (state)\nthis:\n  dim_row U\\<^sub>f = 2 ^ (n + 1)\n\ngoal (2 subgoals):\n 1. square_mat U\\<^sub>f\n 2. unitary U\\<^sub>f", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. square_mat U\\<^sub>f\n 2. unitary U\\<^sub>f", "show \"square_mat U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. square_mat U\\<^sub>f", "by simp"], ["proof (state)\nthis:\n  square_mat U\\<^sub>f\n\ngoal (1 subgoal):\n 1. unitary U\\<^sub>f", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. unitary U\\<^sub>f", "show \"unitary U\\<^sub>f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. unitary U\\<^sub>f", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. unitary U\\<^sub>f", "have \"U\\<^sub>f * U\\<^sub>f = 1\\<^sub>m (dim_col U\\<^sub>f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f * U\\<^sub>f = 1\\<^sub>m (dim_col U\\<^sub>f)", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f));\n        j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                         1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. dim_row (U\\<^sub>f * U\\<^sub>f) =\n    dim_row (1\\<^sub>m (dim_col U\\<^sub>f))\n 3. dim_col (U\\<^sub>f * U\\<^sub>f) =\n    dim_col (1\\<^sub>m (dim_col U\\<^sub>f))", "show \"dim_row (U\\<^sub>f * U\\<^sub>f) = dim_row (1\\<^sub>m (dim_col U\\<^sub>f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row (U\\<^sub>f * U\\<^sub>f) =\n    dim_row (1\\<^sub>m (dim_col U\\<^sub>f))", "by simp"], ["proof (state)\nthis:\n  dim_row (U\\<^sub>f * U\\<^sub>f) = dim_row (1\\<^sub>m (dim_col U\\<^sub>f))\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f));\n        j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                         1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n 2. dim_col (U\\<^sub>f * U\\<^sub>f) =\n    dim_col (1\\<^sub>m (dim_col U\\<^sub>f))", "show \"dim_col (U\\<^sub>f * U\\<^sub>f) = dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col (U\\<^sub>f * U\\<^sub>f) =\n    dim_col (1\\<^sub>m (dim_col U\\<^sub>f))", "by simp"], ["proof (state)\nthis:\n  dim_col (U\\<^sub>f * U\\<^sub>f) = dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f));\n        j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                         1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "fix i j:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f));\n        j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                         1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "assume \"i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f))\" and \"j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\""], ["proof (state)\nthis:\n  i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f))\n  j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f));\n        j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                         1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f))\n  j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))", "have \"i < dim_row U\\<^sub>f\" and \"j < dim_col U\\<^sub>f\""], ["proof (prove)\nusing this:\n  i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f))\n  j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\n\ngoal (1 subgoal):\n 1. i < dim_row U\\<^sub>f &&& j < dim_col U\\<^sub>f", "by auto"], ["proof (state)\nthis:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row (1\\<^sub>m (dim_col U\\<^sub>f));\n        j < dim_col (1\\<^sub>m (dim_col U\\<^sub>f))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n                         1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f", "show \"(U\\<^sub>f * U\\<^sub>f) $$ (i,j) = 1\\<^sub>m (dim_col U\\<^sub>f) $$ (i,j)\""], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "using jozsa_transform_is_unitary_index_odd jozsa_transform_is_unitary_index_even"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f\n  j < dim_col U\\<^sub>f\n  \\<lbrakk>?i < dim_row U\\<^sub>f; ?j < dim_col U\\<^sub>f; odd ?i\\<rbrakk>\n  \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (?i, ?j) =\n                    1\\<^sub>m (dim_col U\\<^sub>f) $$ (?i, ?j)\n  \\<lbrakk>?i < dim_row U\\<^sub>f; ?j < dim_col U\\<^sub>f; even ?i\\<rbrakk>\n  \\<Longrightarrow> (U\\<^sub>f * U\\<^sub>f) $$ (?i, ?j) =\n                    1\\<^sub>m (dim_col U\\<^sub>f) $$ (?i, ?j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n    1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)", "by blast"], ["proof (state)\nthis:\n  (U\\<^sub>f * U\\<^sub>f) $$ (i, j) =\n  1\\<^sub>m (dim_col U\\<^sub>f) $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  U\\<^sub>f * U\\<^sub>f = 1\\<^sub>m (dim_col U\\<^sub>f)\n\ngoal (1 subgoal):\n 1. unitary U\\<^sub>f", "thus ?thesis"], ["proof (prove)\nusing this:\n  U\\<^sub>f * U\\<^sub>f = 1\\<^sub>m (dim_col U\\<^sub>f)\n\ngoal (1 subgoal):\n 1. unitary U\\<^sub>f", "by (simp add: adjoint_of_jozsa_transform unitary_def)"], ["proof (state)\nthis:\n  unitary U\\<^sub>f\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  unitary U\\<^sub>f\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>N-fold application of the tensor product\\<close>"], ["", "fun iter_tensor:: \"complex Matrix.mat \\<Rightarrow> nat \\<Rightarrow> complex Matrix.mat\" (\"_ \\<otimes>\\<^bsup>_\\<^esup>\" 75)  where\n  \"A \\<otimes>\\<^bsup>(Suc 0)\\<^esup> = A\"  \n| \"A \\<otimes>\\<^bsup>(Suc k)\\<^esup> = A \\<Otimes> (A \\<otimes>\\<^bsup>k\\<^esup>)\""], ["", "lemma one_tensor_is_id [simp]:\n  fixes A\n  shows \"A \\<otimes>\\<^bsup>1\\<^esup> = A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>1\\<^esup> = A", "using one_mat_def"], ["proof (prove)\nusing this:\n  1\\<^sub>m ?n \\<equiv>\n  Matrix.mat ?n ?n (\\<lambda>(i, j). if i = j then 1::?'a else (0::?'a))\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>1\\<^esup> = A", "by simp"], ["", "lemma iter_tensor_suc: \n  fixes n\n  assumes \"n \\<ge> 1\"\n  shows \" A \\<otimes>\\<^bsup>(Suc n)\\<^esup> = A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>", "by (metis Deutsch_Jozsa.iter_tensor.simps(2) One_nat_def Suc_le_D)"], ["", "lemma dim_row_of_iter_tensor [simp]:\n  fixes A n\n  assumes \"n \\<ge> 1\"\n  shows \"dim_row(A \\<otimes>\\<^bsup>n\\<^esup>) = (dim_row A)^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n", "proof (rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. dim_row (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_row A ^ 1\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_row A ^ Suc n", "show \"dim_row (A \\<otimes>\\<^bsup>1\\<^esup>) = (dim_row A)^1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_row A ^ 1", "using one_tensor_is_id"], ["proof (prove)\nusing this:\n  ?A \\<otimes>\\<^bsup>1\\<^esup> = ?A\n\ngoal (1 subgoal):\n 1. dim_row (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_row A ^ 1", "by simp"], ["proof (state)\nthis:\n  dim_row (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_row A ^ 1\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_row A ^ Suc n", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_row A ^ Suc n", "assume \"n \\<ge> 1\" and \"dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = (dim_row A)^n\""], ["proof (state)\nthis:\n  1 \\<le> n\n  dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_row A ^ Suc n", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n\n  dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n", "show \"dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = (dim_row A)^Suc n\""], ["proof (prove)\nusing this:\n  1 \\<le> n\n  dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n\n\ngoal (1 subgoal):\n 1. dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = dim_row A ^ Suc n", "using iter_tensor_suc assms dim_row_tensor_mat"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  dim_row (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_row A ^ n\n  1 \\<le> ?n \\<Longrightarrow>\n  ?A \\<otimes>\\<^bsup>Suc ?n\\<^esup> =\n  ?A \\<Otimes> ?A \\<otimes>\\<^bsup>?n\\<^esup>\n  1 \\<le> n\n  dim_row (?A \\<Otimes> ?B) = dim_row ?A * dim_row ?B\n\ngoal (1 subgoal):\n 1. dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = dim_row A ^ Suc n", "by simp"], ["proof (state)\nthis:\n  dim_row (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = dim_row A ^ Suc n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma dim_col_of_iter_tensor [simp]:\n  fixes A n\n  assumes \"n \\<ge> 1\"\n  shows \"dim_col(A \\<otimes>\\<^bsup>n\\<^esup>) = (dim_col A)^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n", "proof (rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. dim_col (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_col A ^ 1\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_col A ^ Suc n", "show \"dim_col (A \\<otimes>\\<^bsup>1\\<^esup>) = (dim_col A)^1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_col A ^ 1", "using one_tensor_is_id"], ["proof (prove)\nusing this:\n  ?A \\<otimes>\\<^bsup>1\\<^esup> = ?A\n\ngoal (1 subgoal):\n 1. dim_col (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_col A ^ 1", "by simp"], ["proof (state)\nthis:\n  dim_col (A \\<otimes>\\<^bsup>1\\<^esup>) = dim_col A ^ 1\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_col A ^ Suc n", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_col A ^ Suc n", "assume \"n \\<ge> 1\" and \"dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = (dim_col A)^n\""], ["proof (state)\nthis:\n  1 \\<le> n\n  dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n\\<rbrakk>\n       \\<Longrightarrow> dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) =\n                         dim_col A ^ Suc n", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n\n  dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n", "show \"dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = (dim_col A)^Suc n\""], ["proof (prove)\nusing this:\n  1 \\<le> n\n  dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n\n\ngoal (1 subgoal):\n 1. dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = dim_col A ^ Suc n", "using iter_tensor_suc assms dim_col_tensor_mat"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) = dim_col A ^ n\n  1 \\<le> ?n \\<Longrightarrow>\n  ?A \\<otimes>\\<^bsup>Suc ?n\\<^esup> =\n  ?A \\<Otimes> ?A \\<otimes>\\<^bsup>?n\\<^esup>\n  1 \\<le> n\n  dim_col (?A \\<Otimes> ?B) = dim_col ?A * dim_col ?B\n\ngoal (1 subgoal):\n 1. dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = dim_col A ^ Suc n", "by simp"], ["proof (state)\nthis:\n  dim_col (A \\<otimes>\\<^bsup>Suc n\\<^esup>) = dim_col A ^ Suc n\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma iter_tensor_values:\n  fixes A n i j\n  assumes \"n \\<ge> 1\" and \"i < dim_row (A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>))\" and \"j < dim_col (A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>))\"\n  shows \"(A \\<otimes>\\<^bsup>(Suc n)\\<^esup>) $$ (i,j) = (A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>)) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (A \\<otimes>\\<^bsup>Suc n\\<^esup>) $$ (i, j) =\n    (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) $$ (i, j)", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  i < dim_row (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>)\n  j < dim_col (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>)\n\ngoal (1 subgoal):\n 1. (A \\<otimes>\\<^bsup>Suc n\\<^esup>) $$ (i, j) =\n    (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) $$ (i, j)", "by (metis One_nat_def le_0_eq not0_implies_Suc iter_tensor.simps(2))"], ["", "lemma iter_tensor_mult_distr:\n  assumes \"n \\<ge> 1\" and \"dim_col A = dim_row B\" and \"dim_col A > 0\" and \"dim_col B > 0\"\n  shows \"(A \\<otimes>\\<^bsup>(Suc n)\\<^esup>) * (B \\<otimes>\\<^bsup>(Suc n)\\<^esup>) = (A * B) \\<Otimes> ((A \\<otimes>\\<^bsup>n\\<^esup>) * (B \\<otimes>\\<^bsup>n\\<^esup>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A * B \\<Otimes>\n    A \\<otimes>\\<^bsup>n\\<^esup> * B \\<otimes>\\<^bsup>n\\<^esup>", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A * B \\<Otimes>\n    A \\<otimes>\\<^bsup>n\\<^esup> * B \\<otimes>\\<^bsup>n\\<^esup>", "have \"(A \\<otimes>\\<^bsup>(Suc n)\\<^esup>) * (B \\<otimes>\\<^bsup>(Suc n)\\<^esup>) = (A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>)) * (B \\<Otimes> (B \\<otimes>\\<^bsup>n\\<^esup>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) *\n    (B \\<Otimes> B \\<otimes>\\<^bsup>n\\<^esup>)", "using Suc_le_D assms(1)"], ["proof (prove)\nusing this:\n  Suc ?n \\<le> ?m' \\<Longrightarrow> \\<exists>m. ?m' = Suc m\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) *\n    (B \\<Otimes> B \\<otimes>\\<^bsup>n\\<^esup>)", "by fastforce"], ["proof (state)\nthis:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) *\n  (B \\<Otimes> B \\<otimes>\\<^bsup>n\\<^esup>)\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A * B \\<Otimes>\n    A \\<otimes>\\<^bsup>n\\<^esup> * B \\<otimes>\\<^bsup>n\\<^esup>", "then"], ["proof (chain)\npicking this:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) *\n  (B \\<Otimes> B \\<otimes>\\<^bsup>n\\<^esup>)", "show \"?thesis\""], ["proof (prove)\nusing this:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) *\n  (B \\<Otimes> B \\<otimes>\\<^bsup>n\\<^esup>)\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A * B \\<Otimes>\n    A \\<otimes>\\<^bsup>n\\<^esup> * B \\<otimes>\\<^bsup>n\\<^esup>", "using mult_distr_tensor[of \"A\" \"B\" \"(iter_tensor A n)\" \"(iter_tensor B n)\"] assms"], ["proof (prove)\nusing this:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) *\n  (B \\<Otimes> B \\<otimes>\\<^bsup>n\\<^esup>)\n  \\<lbrakk>dim_col A = dim_row B;\n   dim_col (A \\<otimes>\\<^bsup>n\\<^esup>) =\n   dim_row (B \\<otimes>\\<^bsup>n\\<^esup>);\n   0 < dim_col A; 0 < dim_col B; 0 < dim_col (A \\<otimes>\\<^bsup>n\\<^esup>);\n   0 < dim_col (B \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n  \\<Longrightarrow> A * B \\<Otimes>\n                    A \\<otimes>\\<^bsup>n\\<^esup> *\n                    B \\<otimes>\\<^bsup>n\\<^esup> =\n                    (A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>) *\n                    (B \\<Otimes> B \\<otimes>\\<^bsup>n\\<^esup>)\n  1 \\<le> n\n  dim_col A = dim_row B\n  0 < dim_col A\n  0 < dim_col B\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A * B \\<Otimes>\n    A \\<otimes>\\<^bsup>n\\<^esup> * B \\<otimes>\\<^bsup>n\\<^esup>", "by simp"], ["proof (state)\nthis:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> * B \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  A * B \\<Otimes>\n  A \\<otimes>\\<^bsup>n\\<^esup> * B \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma index_tensor_mat_with_vec2_row_cond:\n  fixes A B:: \"complex Matrix.mat\" and i:: \"nat\" \n  assumes \"i < 2 * (dim_row B)\" and \"i \\<ge> dim_row B\" and \"dim_col B > 0\"\nand \"dim_row A = 2\" and \"dim_col A = 1\"\n  shows \"(A \\<Otimes> B) $$ (i,0) = (A $$ (1,0)) * (B $$ (i-dim_row B,0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)", "have \"(A \\<Otimes> B) $$ (i,0) = A $$ (i div (dim_row B),0) * B $$ (i mod (dim_row B),0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) =\n    A $$ (i div dim_row B, 0) * B $$ (i mod dim_row B, 0)", "using assms index_tensor_mat[of A \"dim_row A\" \"dim_col A\" B \"dim_row B\" \"dim_col B\" i 0]"], ["proof (prove)\nusing this:\n  i < 2 * dim_row B\n  dim_row B \\<le> i\n  0 < dim_col B\n  dim_row A = 2\n  dim_col A = 1\n  \\<lbrakk>dim_row A = dim_row A; dim_col A = dim_col A;\n   dim_row B = dim_row B; dim_col B = dim_col B; i < dim_row A * dim_row B;\n   0 < dim_col A * dim_col B; 0 < dim_col A; 0 < dim_col B\\<rbrakk>\n  \\<Longrightarrow> (A \\<Otimes> B) $$ (i, 0) =\n                    A $$ (i div dim_row B, 0 div dim_col B) *\n                    B $$ (i mod dim_row B, 0 mod dim_col B)\n\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) =\n    A $$ (i div dim_row B, 0) * B $$ (i mod dim_row B, 0)", "by simp"], ["proof (state)\nthis:\n  (A \\<Otimes> B) $$ (i, 0) =\n  A $$ (i div dim_row B, 0) * B $$ (i mod dim_row B, 0)\n\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)", "moreover"], ["proof (state)\nthis:\n  (A \\<Otimes> B) $$ (i, 0) =\n  A $$ (i div dim_row B, 0) * B $$ (i mod dim_row B, 0)\n\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)", "have \"i div (dim_row B) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i div dim_row B = 1", "using assms(1,2,4)"], ["proof (prove)\nusing this:\n  i < 2 * dim_row B\n  dim_row B \\<le> i\n  dim_row A = 2\n\ngoal (1 subgoal):\n 1. i div dim_row B = 1", "by simp"], ["proof (state)\nthis:\n  i div dim_row B = 1\n\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)", "then"], ["proof (chain)\npicking this:\n  i div dim_row B = 1", "have \"i mod (dim_row B) = i - (dim_row B)\""], ["proof (prove)\nusing this:\n  i div dim_row B = 1\n\ngoal (1 subgoal):\n 1. i mod dim_row B = i - dim_row B", "by (simp add: modulo_nat_def)"], ["proof (state)\nthis:\n  i mod dim_row B = i - dim_row B\n\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)", "ultimately"], ["proof (chain)\npicking this:\n  (A \\<Otimes> B) $$ (i, 0) =\n  A $$ (i div dim_row B, 0) * B $$ (i mod dim_row B, 0)\n  i mod dim_row B = i - dim_row B", "show \"(A \\<Otimes> B) $$ (i,0) = (A $$ (1,0)) * (B $$ (i-dim_row B,0))\""], ["proof (prove)\nusing this:\n  (A \\<Otimes> B) $$ (i, 0) =\n  A $$ (i div dim_row B, 0) * B $$ (i mod dim_row B, 0)\n  i mod dim_row B = i - dim_row B\n\ngoal (1 subgoal):\n 1. (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)", "by (simp add: \\<open>i div dim_row B = 1\\<close>)"], ["proof (state)\nthis:\n  (A \\<Otimes> B) $$ (i, 0) = A $$ (1, 0) * B $$ (i - dim_row B, 0)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma iter_tensor_of_gate_is_gate:\n  fixes A:: \"complex Matrix.mat\" and n m:: \"nat\" \n  assumes \"gate m A\" and \"n \\<ge> 1\" \n  shows \"gate (m*n) (A \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)", "using assms(2)"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)", "proof(rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. gate (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "show \"gate (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)", "using assms(1)"], ["proof (prove)\nusing this:\n  gate m A\n\ngoal (1 subgoal):\n 1. gate (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)", "by simp"], ["proof (state)\nthis:\n  gate (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "assume \"n \\<ge> 1\" and IH:\"gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (state)\nthis:\n  1 \\<le> n\n  gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n\n  gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)", "have \"A \\<otimes>\\<^bsup>(Suc n)\\<^esup> = A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\nusing this:\n  1 \\<le> n\n  gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>", "by (simp add: iter_tensor_suc)"], ["proof (state)\nthis:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "moreover"], ["proof (state)\nthis:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "have \"gate (m*n + m) (A \\<otimes>\\<^bsup>(Suc n)\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "using tensor_gate assms(1)"], ["proof (prove)\nusing this:\n  \\<lbrakk>gate ?m ?G1.0; gate ?n ?G2.0\\<rbrakk>\n  \\<Longrightarrow> gate (?m + ?n) (?G1.0 \\<Otimes> ?G2.0)\n  gate m A\n\ngoal (1 subgoal):\n 1. gate (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "by (simp add: IH add.commute calculation(1))"], ["proof (state)\nthis:\n  gate (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        gate (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "then"], ["proof (chain)\npicking this:\n  gate (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "show \"gate (m*(Suc n)) (A \\<otimes>\\<^bsup>(Suc n)\\<^esup>)\""], ["proof (prove)\nusing this:\n  gate (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)\n\ngoal (1 subgoal):\n 1. gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "by (simp add: add.commute)"], ["proof (state)\nthis:\n  gate (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma iter_tensor_of_state_is_state:\n  fixes A:: \"complex Matrix.mat\" and n m:: \"nat\" \n  assumes \"state m A\" and \"n\\<ge>1\" \n  shows \"state (m*n) (A \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)", "using assms(2)"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)", "proof(rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. state (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> state (m * Suc n)\n                          (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "show \"state (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)", "using one_tensor_is_id assms(1)"], ["proof (prove)\nusing this:\n  ?A \\<otimes>\\<^bsup>1\\<^esup> = ?A\n  state m A\n\ngoal (1 subgoal):\n 1. state (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)", "by simp"], ["proof (state)\nthis:\n  state (m * 1) (A \\<otimes>\\<^bsup>1\\<^esup>)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> state (m * Suc n)\n                          (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> state (m * Suc n)\n                          (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "assume \"n \\<ge> 1\" and IH:\"state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (state)\nthis:\n  1 \\<le> n\n  state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> state (m * Suc n)\n                          (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n\n  state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)", "have \"A \\<otimes>\\<^bsup>(Suc n)\\<^esup> = A \\<Otimes> (A \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\nusing this:\n  1 \\<le> n\n  state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\n\ngoal (1 subgoal):\n 1. A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>", "by (simp add: iter_tensor_suc)"], ["proof (state)\nthis:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> state (m * Suc n)\n                          (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "moreover"], ["proof (state)\nthis:\n  A \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  A \\<Otimes> A \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> state (m * Suc n)\n                          (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "have \"state (m*n + m) (A \\<otimes>\\<^bsup>(Suc n)\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "using tensor_gate assms(1)"], ["proof (prove)\nusing this:\n  \\<lbrakk>gate ?m ?G1.0; gate ?n ?G2.0\\<rbrakk>\n  \\<Longrightarrow> gate (?m + ?n) (?G1.0 \\<Otimes> ?G2.0)\n  state m A\n\ngoal (1 subgoal):\n 1. state (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "by (simp add: IH add.commute calculation)"], ["proof (state)\nthis:\n  state (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        state (m * n) (A \\<otimes>\\<^bsup>n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> state (m * Suc n)\n                          (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "then"], ["proof (chain)\npicking this:\n  state (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "show \"state (m*(Suc n)) (A \\<otimes>\\<^bsup>(Suc n)\\<^esup>)\""], ["proof (prove)\nusing this:\n  state (m * n + m) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)\n\ngoal (1 subgoal):\n 1. state (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)", "by (simp add: add.commute)"], ["proof (state)\nthis:\n  state (m * Suc n) (A \\<otimes>\\<^bsup>Suc n\\<^esup>)\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\nWe prepare n+1 qubits. The first n qubits in the state $|0\\rangle$, the last one in the state \n$|1\\rangle$.\n\\<close>"], ["", "abbreviation \\<psi>\\<^sub>1\\<^sub>0:: \"nat \\<Rightarrow> complex Matrix.mat\" where\n\"\\<psi>\\<^sub>1\\<^sub>0 n \\<equiv> Matrix.mat (2^n) 1 (\\<lambda>(i,j). 1/(sqrt 2)^n)\""], ["", "lemma \\<psi>\\<^sub>1\\<^sub>0_values:\n  fixes i j n\n  assumes \"i < dim_row (\\<psi>\\<^sub>1\\<^sub>0 n)\" and \"j < dim_col (\\<psi>\\<^sub>1\\<^sub>0 n)\" \n  shows \"(\\<psi>\\<^sub>1\\<^sub>0 n) $$ (i,j) = 1/(sqrt 2)^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ n)", "using assms case_prod_conv"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  j < dim_col\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  (case (?a, ?b) of (c, d) \\<Rightarrow> ?f c d) = ?f ?a ?b\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ n)", "by simp"], ["", "text \\<open>$H^{\\otimes n}$ is applied to $|0\\rangle^{\\otimes n}$.\\<close>"], ["", "lemma H_on_ket_zero: \n  shows \"(H * |zero\\<rangle>) = \\<psi>\\<^sub>1\\<^sub>0 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H * |Deutsch.zero\\<rangle> =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ 1) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)));\n        j < dim_col\n             (Matrix.mat (2 ^ 1) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.zero\\<rangle>) $$ (i, j) =\n                         Matrix.mat (2 ^ 1) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.zero\\<rangle>) =\n    dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n 3. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "fix i j:: nat"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ 1) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)));\n        j < dim_col\n             (Matrix.mat (2 ^ 1) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.zero\\<rangle>) $$ (i, j) =\n                         Matrix.mat (2 ^ 1) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.zero\\<rangle>) =\n    dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n 3. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "assume \"i < dim_row (\\<psi>\\<^sub>1\\<^sub>0 1)\" and \"j < dim_col (\\<psi>\\<^sub>1\\<^sub>0 1)\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ 1) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n  j < dim_col\n       (Matrix.mat (2 ^ 1) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ 1) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)));\n        j < dim_col\n             (Matrix.mat (2 ^ 1) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.zero\\<rangle>) $$ (i, j) =\n                         Matrix.mat (2 ^ 1) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.zero\\<rangle>) =\n    dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n 3. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ 1) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n  j < dim_col\n       (Matrix.mat (2 ^ 1) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "have f1: \"i \\<in> {0,1} \\<and> j = 0\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ 1) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n  j < dim_col\n       (Matrix.mat (2 ^ 1) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n\ngoal (1 subgoal):\n 1. i \\<in> {0, 1} \\<and> j = 0", "by (simp add: less_2_cases)"], ["proof (state)\nthis:\n  i \\<in> {0, 1} \\<and> j = 0\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ 1) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)));\n        j < dim_col\n             (Matrix.mat (2 ^ 1) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.zero\\<rangle>) $$ (i, j) =\n                         Matrix.mat (2 ^ 1) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.zero\\<rangle>) =\n    dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n 3. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "then"], ["proof (chain)\npicking this:\n  i \\<in> {0, 1} \\<and> j = 0", "show \"(H * |zero\\<rangle>) $$ (i,j) = (\\<psi>\\<^sub>1\\<^sub>0 1) $$ (i,j)\""], ["proof (prove)\nusing this:\n  i \\<in> {0, 1} \\<and> j = 0\n\ngoal (1 subgoal):\n 1. (H * |Deutsch.zero\\<rangle>) $$ (i, j) =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n    (i, j)", "by (auto simp add: times_mat_def scalar_prod_def H_def ket_vec_def)"], ["proof (state)\nthis:\n  (H * |Deutsch.zero\\<rangle>) $$ (i, j) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (i, j)\n\ngoal (2 subgoals):\n 1. dim_row (H * |Deutsch.zero\\<rangle>) =\n    dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n 2. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. dim_row (H * |Deutsch.zero\\<rangle>) =\n    dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n 2. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "show \"dim_row (H * |zero\\<rangle>) = dim_row (\\<psi>\\<^sub>1\\<^sub>0 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row (H * |Deutsch.zero\\<rangle>) =\n    dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "by (simp add: H_def)"], ["proof (state)\nthis:\n  dim_row (H * |Deutsch.zero\\<rangle>) =\n  dim_row\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n\ngoal (1 subgoal):\n 1. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "show \"dim_col (H * |zero\\<rangle>) = dim_col (\\<psi>\\<^sub>1\\<^sub>0 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "using H_def"], ["proof (prove)\nusing this:\n  H \\<equiv>\n  complex_of_real (1 / sqrt 2) \\<cdot>\\<^sub>m\n  Matrix.mat 2 2\n   (\\<lambda>(i, j). if i \\<noteq> j then 1 else if i = 0 then 1 else - 1)\n\ngoal (1 subgoal):\n 1. dim_col (H * |Deutsch.zero\\<rangle>) =\n    dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))", "by (simp add: ket_vec_def)"], ["proof (state)\nthis:\n  dim_col (H * |Deutsch.zero\\<rangle>) =\n  dim_col\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma \\<psi>\\<^sub>1\\<^sub>0_tensor: \n  assumes \"n \\<ge> 1\"\n  shows \"(\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n) = (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n 3. dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))", "have \"dim_row (\\<psi>\\<^sub>1\\<^sub>0 1) * dim_row (\\<psi>\\<^sub>1\\<^sub>0 n) = 2^(Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n    dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    2 ^ Suc n", "by simp"], ["proof (state)\nthis:\n  dim_row\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  2 ^ Suc n\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n 3. dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))", "then"], ["proof (chain)\npicking this:\n  dim_row\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  2 ^ Suc n", "show \"dim_row ((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) = dim_row (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\""], ["proof (prove)\nusing this:\n  dim_row\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  2 ^ Suc n\n\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))", "by simp"], ["proof (state)\nthis:\n  dim_row\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  dim_row\n   (Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))", "have \"dim_col (\\<psi>\\<^sub>1\\<^sub>0 1) * dim_col (\\<psi>\\<^sub>1\\<^sub>0 n) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n    dim_col\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    1", "by simp"], ["proof (state)\nthis:\n  dim_col\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n  dim_col\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  1\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))", "then"], ["proof (chain)\npicking this:\n  dim_col\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n  dim_col\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  1", "show \"dim_col ((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) = dim_col (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\""], ["proof (prove)\nusing this:\n  dim_col\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) *\n  dim_col\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  1\n\ngoal (1 subgoal):\n 1. dim_col\n     (Matrix.mat (2 ^ 1) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n      Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))", "by simp"], ["proof (state)\nthis:\n  dim_col\n   (Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n  dim_col\n   (Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)", "fix i j:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)", "assume a0: \"i < dim_row (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\" and a1: \"j < dim_col (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))", "have f0: \"j = 0\" and f1: \"i < 2^(Suc n)\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. j = 0 &&& i < 2 ^ Suc n", "by auto"], ["proof (state)\nthis:\n  j = 0\n  i < 2 ^ Suc n\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  j = 0\n  i < 2 ^ Suc n", "have f2:\"(\\<psi>\\<^sub>1\\<^sub>0 (Suc n)) $$ (i,j) = 1/(sqrt 2)^(Suc n)\""], ["proof (prove)\nusing this:\n  j = 0\n  i < 2 ^ Suc n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ Suc n)", "using \\<psi>\\<^sub>1\\<^sub>0_values[of \"i\" \"(Suc n)\" \"j\"] a0 a1"], ["proof (prove)\nusing this:\n  j = 0\n  i < 2 ^ Suc n\n  \\<lbrakk>i < dim_row\n                (Matrix.mat (2 ^ Suc n) 1\n                  (\\<lambda>x.\n                      complex_of_real\n                       (case x of\n                        (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n   j < dim_col\n        (Matrix.mat (2 ^ Suc n) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ Suc n) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                    (i, j) =\n                    complex_of_real (1 / sqrt 2 ^ Suc n)\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ Suc n)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2 ^ Suc n)\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ 1) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ 1)) \\<Otimes>\n                          Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n                         (i, j)", "show \"((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) $$ (i,j) = (\\<psi>\\<^sub>1\\<^sub>0 (Suc n)) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "proof (rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 3. ?Q \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "(*case distinction*)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 3. ?Q \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "show \"i < dim_row (\\<psi>\\<^sub>1\\<^sub>0 n) \\<or> i \\<ge> dim_row (\\<psi>\\<^sub>1\\<^sub>0 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<or>\n    dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i", "by linarith"], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<or>\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  \\<le> i\n\ngoal (2 subgoals):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "(* case i < dim_row (\\<psi>\\<^sub>1\\<^sub>0 n) *)"], ["proof (state)\ngoal (2 subgoals):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "assume a2: \"i < dim_row (\\<psi>\\<^sub>1\\<^sub>0 n)\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n\ngoal (2 subgoals):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))", "have \"((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) $$ (i,j) = (\\<psi>\\<^sub>1\\<^sub>0 1) $$ (0,0) * (\\<psi>\\<^sub>1\\<^sub>0 n) $$ (i,0)\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n    (0, 0) *\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i, 0)", "using index_tensor_mat f0 assms"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  \\<lbrakk>dim_row ?A = ?rA; dim_col ?A = ?cA; dim_row ?B = ?rB;\n   dim_col ?B = ?cB; ?i < ?rA * ?rB; ?j < ?cA * ?cB; 0 < ?cA;\n   0 < ?cB\\<rbrakk>\n  \\<Longrightarrow> (?A \\<Otimes> ?B) $$ (?i, ?j) =\n                    ?A $$ (?i div ?rB, ?j div ?cB) *\n                    ?B $$ (?i mod ?rB, ?j mod ?cB)\n  j = 0\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n    (0, 0) *\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i, 0)", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (0, 0) *\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n  (i, 0)\n\ngoal (2 subgoals):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "also"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (0, 0) *\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n  (i, 0)\n\ngoal (2 subgoals):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "have \"... = 1/sqrt(2) * 1/(sqrt(2)^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n    (0, 0) *\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i, 0) =\n    complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)", "using \\<psi>\\<^sub>1\\<^sub>0_values a2 assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>?i < dim_row\n                 (Matrix.mat (2 ^ ?n) 1\n                   (\\<lambda>x.\n                       complex_of_real\n                        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n)));\n   ?j < dim_col\n         (Matrix.mat (2 ^ ?n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n)))\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ ?n) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n)) $$\n                    (?i, ?j) =\n                    complex_of_real (1 / sqrt 2 ^ ?n)\n  i < dim_row\n       (Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n    (0, 0) *\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i, 0) =\n    complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (0, 0) *\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n  (i, 0) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)\n\ngoal (2 subgoals):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "finally"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)", "show \"((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) $$ (i,j) = (\\<psi>\\<^sub>1\\<^sub>0 (Suc n)) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "using f2 divide_divide_eq_left power_Suc"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2 ^ Suc n)\n  ?a / ?b / ?c = ?a / (?b * ?c)\n  ?a ^ Suc ?n = ?a * ?a ^ ?n\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "(* case i \\<ge> dim_row (\\<psi>\\<^sub>1\\<^sub>0 n) *)"], ["proof (state)\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "assume \"i \\<ge> dim_row (\\<psi>\\<^sub>1\\<^sub>0 n)\""], ["proof (state)\nthis:\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  \\<le> i\n\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  \\<le> i", "have \"((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) $$ (i,0) = ((\\<psi>\\<^sub>1\\<^sub>0 1) $$ (1, 0)) * ((\\<psi>\\<^sub>1\\<^sub>0 n) $$ ( i -dim_row (\\<psi>\\<^sub>1\\<^sub>0 n),0))\""], ["proof (prove)\nusing this:\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  \\<le> i\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, 0) =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n    (1, 0) *\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i -\n     dim_row\n      (Matrix.mat (2 ^ n) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))),\n     0)", "using index_tensor_mat_with_vec2_row_cond[of i \"(\\<psi>\\<^sub>1\\<^sub>0 1)\" \"(\\<psi>\\<^sub>1\\<^sub>0 n)\" ] a0 a1 f0"], ["proof (prove)\nusing this:\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n  \\<le> i\n  \\<lbrakk>i < 2 *\n               dim_row\n                (Matrix.mat (2 ^ 1) 1\n                  (\\<lambda>x.\n                      complex_of_real\n                       (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)));\n   dim_row\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)))\n   \\<le> i;\n   0 < dim_col\n        (Matrix.mat (2 ^ 1) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)));\n   dim_row\n    (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n   2;\n   dim_col\n    (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) =\n   1\\<rbrakk>\n  \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                      (\\<lambda>x.\n                          complex_of_real\n                           (case x of\n                            (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n                     Matrix.mat (2 ^ 1) 1\n                      (\\<lambda>x.\n                          complex_of_real\n                           (case x of\n                            (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))) $$\n                    (i, 0) =\n                    Matrix.mat (2 ^ n) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n                    (1, 0) *\n                    Matrix.mat (2 ^ 1) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n                    (i -\n                     dim_row\n                      (Matrix.mat (2 ^ 1) 1\n                        (\\<lambda>x.\n                            complex_of_real\n                             (case x of\n                              (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))),\n                     0)\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n  j = 0\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, 0) =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n    (1, 0) *\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n    (i -\n     dim_row\n      (Matrix.mat (2 ^ n) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))),\n     0)", "by (metis dim_col_mat(1) dim_row_mat(1) index_tensor_mat_with_vec2_row_cond power_Suc power_one_right)"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (1, 0) *\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n  (i -\n   dim_row\n    (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))),\n   0)\n\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (1, 0) *\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n  (i -\n   dim_row\n    (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))),\n   0)", "have \"((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) $$ (i,0) = 1/sqrt(2) * 1/(sqrt 2)^n\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (1, 0) *\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n  (i -\n   dim_row\n    (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))),\n   0)\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, 0) =\n    complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)", "using \\<psi>\\<^sub>1\\<^sub>0_values[of \"i -dim_row (\\<psi>\\<^sub>1\\<^sub>0 n)\" \"n\" \"j\"] a0 a1"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) $$\n  (1, 0) *\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n  (i -\n   dim_row\n    (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))),\n   0)\n  \\<lbrakk>i -\n           dim_row\n            (Matrix.mat (2 ^ n) 1\n              (\\<lambda>x.\n                  complex_of_real\n                   (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n           < dim_row\n              (Matrix.mat (2 ^ n) 1\n                (\\<lambda>x.\n                    complex_of_real\n                     (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)));\n   j < dim_col\n        (Matrix.mat (2 ^ n) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ n) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n                    (i -\n                     dim_row\n                      (Matrix.mat (2 ^ n) 1\n                        (\\<lambda>x.\n                            complex_of_real\n                             (case x of\n                              (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))),\n                     j) =\n                    complex_of_real (1 / sqrt 2 ^ n)\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, 0) =\n    complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\n    \\<le> i \\<Longrightarrow>\n    (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)", "show  \"((\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)) $$ (i,j) = (\\<psi>\\<^sub>1\\<^sub>0 (Suc n)) $$ (i,j)\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "using f0 f1 divide_divide_eq_left power_Suc"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, 0) =\n  complex_of_real (1 / sqrt 2 * 1 / sqrt 2 ^ n)\n  j = 0\n  i < 2 ^ Suc n\n  ?a / ?b / ?c = ?a / (?b * ?c)\n  ?a ^ Suc ?n = ?a * ?a ^ ?n\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ 1) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n     Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ 1) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n   Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n)) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma \\<psi>\\<^sub>1\\<^sub>0_tensor_is_state:\n  assumes \"n \\<ge> 1\"\n  shows \"state n ( |zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state n (|Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>)", "using iter_tensor_of_state_is_state ket_zero_is_state assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>state ?m ?A; 1 \\<le> ?n\\<rbrakk>\n  \\<Longrightarrow> state (?m * ?n) (?A \\<otimes>\\<^bsup>?n\\<^esup>)\n  state 1 |Deutsch.zero\\<rangle>\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. state n (|Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>)", "by fastforce"], ["", "lemma iter_tensor_of_H_is_gate:\n  assumes \"n \\<ge> 1\"\n  shows \"gate n (H \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate n (H \\<otimes>\\<^bsup>n\\<^esup>)", "using iter_tensor_of_gate_is_gate H_is_gate assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>gate ?m ?A; 1 \\<le> ?n\\<rbrakk>\n  \\<Longrightarrow> gate (?m * ?n) (?A \\<otimes>\\<^bsup>?n\\<^esup>)\n  gate 1 H\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. gate n (H \\<otimes>\\<^bsup>n\\<^esup>)", "by fastforce"], ["", "lemma iter_tensor_of_H_on_zero_tensor: \n  assumes \"n \\<ge> 1\"\n  shows \"(H \\<otimes>\\<^bsup>n\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>) = \\<psi>\\<^sub>1\\<^sub>0 n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))", "proof(rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. H \\<otimes>\\<^bsup>1\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>1\\<^esup> =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "show \"(H \\<otimes>\\<^bsup>1\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>1\\<^esup>) = \\<psi>\\<^sub>1\\<^sub>0 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>1\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>1\\<^esup> =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))", "using H_on_ket_zero"], ["proof (prove)\nusing this:\n  H * |Deutsch.zero\\<rangle> =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>1\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>1\\<^esup> =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))", "by simp"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>1\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>1\\<^esup> =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "assume a0: \"n \\<ge> 1\" and IH: \"(H \\<otimes>\\<^bsup>n\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>) = \\<psi>\\<^sub>1\\<^sub>0 n\""], ["proof (state)\nthis:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))", "have \"(H \\<otimes>\\<^bsup>(Suc n)\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>(Suc n)\\<^esup>) = (H * |zero\\<rangle>) \\<Otimes> ((H \\<otimes>\\<^bsup>n\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>))\""], ["proof (prove)\nusing this:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    H * |Deutsch.zero\\<rangle> \\<Otimes>\n    H \\<otimes>\\<^bsup>n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>", "using iter_tensor_mult_distr[of \"n\" \"H\" \"|zero\\<rangle>\"] a0 ket_vec_def H_def"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n  \\<lbrakk>1 \\<le> n; dim_col H = dim_row |Deutsch.zero\\<rangle>;\n   0 < dim_col H; 0 < dim_col |Deutsch.zero\\<rangle>\\<rbrakk>\n  \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                    H * |Deutsch.zero\\<rangle> \\<Otimes>\n                    H \\<otimes>\\<^bsup>n\\<^esup> *\n                    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>\n  1 \\<le> n\n  |?v\\<rangle> \\<equiv> Matrix.mat (dim_vec ?v) 1 (\\<lambda>(i, j). ?v $ i)\n  H \\<equiv>\n  complex_of_real (1 / sqrt 2) \\<cdot>\\<^sub>m\n  Matrix.mat 2 2\n   (\\<lambda>(i, j). if i \\<noteq> j then 1 else if i = 0 then 1 else - 1)\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    H * |Deutsch.zero\\<rangle> \\<Otimes>\n    H \\<otimes>\\<^bsup>n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>", "by(simp add: H_def)"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "also"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "have  \"... = (H * |zero\\<rangle>) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H * |Deutsch.zero\\<rangle> \\<Otimes>\n    H \\<otimes>\\<^bsup>n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n    H * |Deutsch.zero\\<rangle> \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))", "using IH"], ["proof (prove)\nusing this:\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. H * |Deutsch.zero\\<rangle> \\<Otimes>\n    H \\<otimes>\\<^bsup>n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n    H * |Deutsch.zero\\<rangle> \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))", "by simp"], ["proof (state)\nthis:\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "also"], ["proof (state)\nthis:\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  H \\<otimes>\\<^bsup>n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "have \"... = (\\<psi>\\<^sub>1\\<^sub>0 1) \\<Otimes> (\\<psi>\\<^sub>1\\<^sub>0 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H * |Deutsch.zero\\<rangle> \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))", "using H_on_ket_zero"], ["proof (prove)\nusing this:\n  H * |Deutsch.zero\\<rangle> =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1))\n\ngoal (1 subgoal):\n 1. H * |Deutsch.zero\\<rangle> \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))", "by simp"], ["proof (state)\nthis:\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "also"], ["proof (state)\nthis:\n  H * |Deutsch.zero\\<rangle> \\<Otimes>\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "have \"... = (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "using \\<psi>\\<^sub>1\\<^sub>0_tensor a0"], ["proof (prove)\nusing this:\n  1 \\<le> ?n \\<Longrightarrow>\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n  Matrix.mat (2 ^ ?n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n)) =\n  Matrix.mat (2 ^ Suc ?n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc ?n))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n    Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ 1)) \\<Otimes>\n  Matrix.mat (2 ^ n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) =\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> *\n        |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n                         |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc\n                            n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "finally"], ["proof (chain)\npicking this:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "show \"(H \\<otimes>\\<^bsup>(Suc n)\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>(Suc n)\\<^esup>) = (\\<psi>\\<^sub>1\\<^sub>0 (Suc n))\""], ["proof (prove)\nusing this:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    Matrix.mat (2 ^ Suc n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))", "by simp"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  Matrix.mat (2 ^ Suc n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ Suc n))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma \\<psi>\\<^sub>1\\<^sub>0_is_state:\n  assumes \"n \\<ge> 1\"\n  shows \"state n (\\<psi>\\<^sub>1\\<^sub>0 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state n\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))", "using iter_tensor_of_H_is_gate \\<psi>\\<^sub>1\\<^sub>0_tensor_is_state assms gate_on_state_is_state iter_tensor_of_H_on_zero_tensor assms"], ["proof (prove)\nusing this:\n  1 \\<le> ?n \\<Longrightarrow> gate ?n (H \\<otimes>\\<^bsup>?n\\<^esup>)\n  1 \\<le> ?n \\<Longrightarrow>\n  state ?n (|Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>?n\\<^esup>)\n  1 \\<le> n\n  \\<lbrakk>gate ?n ?A; state ?n ?v\\<rbrakk>\n  \\<Longrightarrow> state ?n (?A * ?v)\n  1 \\<le> ?n \\<Longrightarrow>\n  H \\<otimes>\\<^bsup>?n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>?n\\<^esup> =\n  Matrix.mat (2 ^ ?n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. state n\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))", "by metis"], ["", "abbreviation \\<psi>\\<^sub>1\\<^sub>1:: \"complex Matrix.mat\" where\n\"\\<psi>\\<^sub>1\\<^sub>1 \\<equiv> Matrix.mat 2 1 (\\<lambda>(i,j). if i=0 then 1/sqrt(2) else -1/sqrt(2))\""], ["", "lemma H_on_ket_one_is_\\<psi>\\<^sub>1\\<^sub>1: \n  shows \"(H * |one\\<rangle>) = \\<psi>\\<^sub>1\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H * |Deutsch.one\\<rangle> =\n    Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow> if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat 2 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i = 0 then 1 / sqrt 2\n                               else - 1 / sqrt 2)));\n        j < dim_col\n             (Matrix.mat 2 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i = 0 then 1 / sqrt 2\n                       else - 1 / sqrt 2)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.one\\<rangle>) $$ (i, j) =\n                         Matrix.mat 2 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i = 0 then 1 / sqrt 2\n                                  else - 1 / sqrt 2)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.one\\<rangle>) =\n    dim_row\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n 3. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "fix i j:: nat"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat 2 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i = 0 then 1 / sqrt 2\n                               else - 1 / sqrt 2)));\n        j < dim_col\n             (Matrix.mat 2 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i = 0 then 1 / sqrt 2\n                       else - 1 / sqrt 2)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.one\\<rangle>) $$ (i, j) =\n                         Matrix.mat 2 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i = 0 then 1 / sqrt 2\n                                  else - 1 / sqrt 2)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.one\\<rangle>) =\n    dim_row\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n 3. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "assume \"i < dim_row \\<psi>\\<^sub>1\\<^sub>1\" and \"j < dim_col \\<psi>\\<^sub>1\\<^sub>1\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat 2 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n  j < dim_col\n       (Matrix.mat 2 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat 2 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i = 0 then 1 / sqrt 2\n                               else - 1 / sqrt 2)));\n        j < dim_col\n             (Matrix.mat 2 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i = 0 then 1 / sqrt 2\n                       else - 1 / sqrt 2)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.one\\<rangle>) $$ (i, j) =\n                         Matrix.mat 2 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i = 0 then 1 / sqrt 2\n                                  else - 1 / sqrt 2)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.one\\<rangle>) =\n    dim_row\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n 3. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat 2 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n  j < dim_col\n       (Matrix.mat 2 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "have \"i \\<in> {0,1} \\<and> j = 0\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat 2 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n  j < dim_col\n       (Matrix.mat 2 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n\ngoal (1 subgoal):\n 1. i \\<in> {0, 1} \\<and> j = 0", "by (simp add: less_2_cases)"], ["proof (state)\nthis:\n  i \\<in> {0, 1} \\<and> j = 0\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat 2 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i = 0 then 1 / sqrt 2\n                               else - 1 / sqrt 2)));\n        j < dim_col\n             (Matrix.mat 2 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i = 0 then 1 / sqrt 2\n                       else - 1 / sqrt 2)))\\<rbrakk>\n       \\<Longrightarrow> (H * |Deutsch.one\\<rangle>) $$ (i, j) =\n                         Matrix.mat 2 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i = 0 then 1 / sqrt 2\n                                  else - 1 / sqrt 2)) $$\n                         (i, j)\n 2. dim_row (H * |Deutsch.one\\<rangle>) =\n    dim_row\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n 3. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "then"], ["proof (chain)\npicking this:\n  i \\<in> {0, 1} \\<and> j = 0", "show \"(H * |one\\<rangle>) $$ (i,j) = \\<psi>\\<^sub>1\\<^sub>1 $$ (i,j)\""], ["proof (prove)\nusing this:\n  i \\<in> {0, 1} \\<and> j = 0\n\ngoal (1 subgoal):\n 1. (H * |Deutsch.one\\<rangle>) $$ (i, j) =\n    Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) $$\n    (i, j)", "by (auto simp add: times_mat_def scalar_prod_def H_def ket_vec_def)"], ["proof (state)\nthis:\n  (H * |Deutsch.one\\<rangle>) $$ (i, j) =\n  Matrix.mat 2 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) $$\n  (i, j)\n\ngoal (2 subgoals):\n 1. dim_row (H * |Deutsch.one\\<rangle>) =\n    dim_row\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n 2. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. dim_row (H * |Deutsch.one\\<rangle>) =\n    dim_row\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n 2. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "show \"dim_row (H * |one\\<rangle>) = dim_row \\<psi>\\<^sub>1\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row (H * |Deutsch.one\\<rangle>) =\n    dim_row\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "by (simp add: H_def)"], ["proof (state)\nthis:\n  dim_row (H * |Deutsch.one\\<rangle>) =\n  dim_row\n   (Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n\ngoal (1 subgoal):\n 1. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "show \"dim_col (H * |one\\<rangle>) = dim_col \\<psi>\\<^sub>1\\<^sub>1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col (H * |Deutsch.one\\<rangle>) =\n    dim_col\n     (Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))", "by (simp add: H_def ket_vec_def)"], ["proof (state)\nthis:\n  dim_col (H * |Deutsch.one\\<rangle>) =\n  dim_col\n   (Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)))\n\ngoal:\nNo subgoals!", "qed"], ["", "abbreviation \\<psi>\\<^sub>1:: \"nat \\<Rightarrow> complex Matrix.mat\" where\n\"\\<psi>\\<^sub>1 n \\<equiv> Matrix.mat (2^(n+1)) 1 (\\<lambda>(i,j). if even i then 1/(sqrt 2)^(n+1) else -1/(sqrt 2)^(n+1))\""], ["", "lemma \\<psi>\\<^sub>1_values_even[simp]:\n  fixes i j n\n  assumes \"i < dim_row (\\<psi>\\<^sub>1 n)\" and \"j < dim_col (\\<psi>\\<^sub>1 n)\" and \"even i\"\n  shows \"(\\<psi>\\<^sub>1 n) $$ (i,j) = 1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ (n + 1))", "using assms case_prod_conv"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  even i\n  (case (?a, ?b) of (c, d) \\<Rightarrow> ?f c d) = ?f ?a ?b\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ (n + 1))", "by simp"], ["", "lemma \\<psi>\\<^sub>1_values_odd [simp]:\n  fixes i j n\n  assumes \"i < dim_row (\\<psi>\\<^sub>1 n)\" and \"j < dim_col (\\<psi>\\<^sub>1 n)\" and \"odd i\"\n  shows \"(\\<psi>\\<^sub>1 n) $$ (i,j) = -1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2 ^ (n + 1))", "using assms case_prod_conv"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  odd i\n  (case (?a, ?b) of (c, d) \\<Rightarrow> ?f c d) = ?f ?a ?b\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2 ^ (n + 1))", "by simp"], ["", "lemma \"\\<psi>\\<^sub>1\\<^sub>0_tensor_\\<psi>\\<^sub>1\\<^sub>1_is_\\<psi>\\<^sub>1\":\n  assumes \"n \\<ge> 1\"\n  shows \"(\\<psi>\\<^sub>1\\<^sub>0 n) \\<Otimes> \\<psi>\\<^sub>1\\<^sub>1 = \\<psi>\\<^sub>1 n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n    Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1)))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n      Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))\n 3. dim_col\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n      Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))", "show \"dim_col ((\\<psi>\\<^sub>1\\<^sub>0 n) \\<Otimes> \\<psi>\\<^sub>1\\<^sub>1) = dim_col (\\<psi>\\<^sub>1 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n      Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))", "by simp"], ["proof (state)\nthis:\n  dim_col\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n    Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n  dim_col\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))))\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n      Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n      Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))", "show \"dim_row ((\\<psi>\\<^sub>1\\<^sub>0 n) \\<Otimes> \\<psi>\\<^sub>1\\<^sub>1) = dim_row (\\<psi>\\<^sub>1 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n      Matrix.mat 2 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))", "by simp"], ["proof (state)\nthis:\n  dim_row\n   (Matrix.mat (2 ^ n) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n    Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) =\n  dim_row\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "fix i j:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "assume a0: \"i < dim_row (\\<psi>\\<^sub>1 n)\" and a1: \"j < dim_col (\\<psi>\\<^sub>1 n)\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))", "have \"i < 2^(n+1)\" and \"j = 0\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. i < 2 ^ (n + 1) &&& j = 0", "by auto"], ["proof (state)\nthis:\n  i < 2 ^ (n + 1)\n  j = 0\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  i < 2 ^ (n + 1)\n  j = 0", "have f0: \"((\\<psi>\\<^sub>1\\<^sub>0 n) \\<Otimes> \\<psi>\\<^sub>1\\<^sub>1) $$ (i,j) = 1/(sqrt 2)^n * \\<psi>\\<^sub>1\\<^sub>1 $$ (i mod 2, j)\""], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1)\n  j = 0\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n     Matrix.mat 2 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ n) *\n    Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) $$\n    (i mod 2, j)", "using \\<psi>\\<^sub>1\\<^sub>0_values[of \"i div 2\" n \"j div 1\"] a0 a1"], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1)\n  j = 0\n  \\<lbrakk>i div 2\n           < dim_row\n              (Matrix.mat (2 ^ n) 1\n                (\\<lambda>x.\n                    complex_of_real\n                     (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)));\n   j div 1\n   < dim_col\n      (Matrix.mat (2 ^ n) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)))\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ n) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) $$\n                    (i div 2, j div 1) =\n                    complex_of_real (1 / sqrt 2 ^ n)\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n     Matrix.mat 2 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2 ^ n) *\n    Matrix.mat 2 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) $$\n    (i mod 2, j)", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n   Matrix.mat 2 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2 ^ n) *\n  Matrix.mat 2 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) $$\n  (i mod 2, j)\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i then 1 / sqrt 2 ^ (n + 1)\n                               else - 1 / sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then 1 / sqrt 2 ^ (n + 1)\n                       else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   1 / sqrt 2 ^ n)) \\<Otimes>\n                          Matrix.mat 2 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if i = 0 then 1 / sqrt 2\n                                   else - 1 / sqrt 2))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i then 1 / sqrt 2 ^ (n + 1)\n                                  else - 1 / sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "show \"((\\<psi>\\<^sub>1\\<^sub>0 n) \\<Otimes> \\<psi>\\<^sub>1\\<^sub>1) $$ (i,j) = (\\<psi>\\<^sub>1 n) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n     Matrix.mat 2 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "using f0 \\<psi>\\<^sub>1_values_even \\<psi>\\<^sub>1_values_odd a0 a1"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n   Matrix.mat 2 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2 ^ n) *\n  Matrix.mat 2 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) $$\n  (i mod 2, j)\n  \\<lbrakk>?i < dim_row\n                 (Matrix.mat (2 ^ (?n + 1)) 1\n                   (\\<lambda>x.\n                       complex_of_real\n                        (case x of\n                         (i, j) \\<Rightarrow>\n                           if even i then 1 / sqrt 2 ^ (?n + 1)\n                           else - 1 / sqrt 2 ^ (?n + 1))));\n   ?j < dim_col\n         (Matrix.mat (2 ^ (?n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then 1 / sqrt 2 ^ (?n + 1)\n                   else - 1 / sqrt 2 ^ (?n + 1))));\n   even ?i\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ (?n + 1)) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             if even i then 1 / sqrt 2 ^ (?n + 1)\n                             else - 1 / sqrt 2 ^ (?n + 1))) $$\n                    (?i, ?j) =\n                    complex_of_real (1 / sqrt 2 ^ (?n + 1))\n  \\<lbrakk>?i < dim_row\n                 (Matrix.mat (2 ^ (?n + 1)) 1\n                   (\\<lambda>x.\n                       complex_of_real\n                        (case x of\n                         (i, j) \\<Rightarrow>\n                           if even i then 1 / sqrt 2 ^ (?n + 1)\n                           else - 1 / sqrt 2 ^ (?n + 1))));\n   ?j < dim_col\n         (Matrix.mat (2 ^ (?n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then 1 / sqrt 2 ^ (?n + 1)\n                   else - 1 / sqrt 2 ^ (?n + 1))));\n   odd ?i\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ (?n + 1)) 1\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             if even i then 1 / sqrt 2 ^ (?n + 1)\n                             else - 1 / sqrt 2 ^ (?n + 1))) $$\n                    (?i, ?j) =\n                    complex_of_real (- 1 / sqrt 2 ^ (?n + 1))\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n     Matrix.mat 2 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "by auto"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ n)) \\<Otimes>\n   Matrix.mat 2 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma \\<psi>\\<^sub>1_is_state:\n  assumes \"n \\<ge> 1\"\n  shows \"state (n+1) (\\<psi>\\<^sub>1 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))", "using assms \\<psi>\\<^sub>1\\<^sub>0_tensor_\\<psi>\\<^sub>1\\<^sub>1_is_\\<psi>\\<^sub>1 \\<psi>\\<^sub>1\\<^sub>0_is_state H_on_ket_one_is_state H_on_ket_one_is_\\<psi>\\<^sub>1\\<^sub>1 tensor_state"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  1 \\<le> ?n \\<Longrightarrow>\n  Matrix.mat (2 ^ ?n) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n)) \\<Otimes>\n  Matrix.mat 2 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow> if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) =\n  Matrix.mat (2 ^ (?n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (?n + 1)\n           else - 1 / sqrt 2 ^ (?n + 1)))\n  1 \\<le> ?n \\<Longrightarrow>\n  state ?n\n   (Matrix.mat (2 ^ ?n) 1\n     (\\<lambda>x.\n         complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n)))\n  state 1 (H * |Deutsch.one\\<rangle>)\n  H * |Deutsch.one\\<rangle> =\n  Matrix.mat 2 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow> if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))\n  \\<lbrakk>state ?m ?u; state ?n ?v\\<rbrakk>\n  \\<Longrightarrow> state (?m + ?n) (?u \\<Otimes> ?v)\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1))))", "by metis"], ["", "abbreviation (in jozsa) \\<psi>\\<^sub>2:: \"complex Matrix.mat\" where\n\"\\<psi>\\<^sub>2 \\<equiv> Matrix.mat (2^(n+1)) 1 (\\<lambda>(i,j). if even i then (-1)^f(i div 2)/(sqrt 2)^(n+1) \n                                        else (-1)^(f(i div 2)+1)/(sqrt 2)^(n+1))\""], ["", "lemma (in jozsa) \\<psi>\\<^sub>2_values_even [simp]:\n  fixes i j \n  assumes \"i < dim_row \\<psi>\\<^sub>2 \" and \"j < dim_col \\<psi>\\<^sub>2\" and \"even i\"\n  shows \"\\<psi>\\<^sub>2 $$ (i,j) = (-1)^f(i div 2)/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real ((- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1))", "using assms case_prod_conv"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  even i\n  (case (?a, ?b) of (c, d) \\<Rightarrow> ?f c d) = ?f ?a ?b\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real ((- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1))", "by simp"], ["", "lemma (in jozsa) \\<psi>\\<^sub>2_values_odd [simp]:\n  fixes i j \n  assumes \"i < dim_row \\<psi>\\<^sub>2\" and \"j < dim_col \\<psi>\\<^sub>2\" and \"odd i\"\n  shows \"\\<psi>\\<^sub>2 $$ (i,j) = (-1)^(f(i div 2)+1)/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))", "using assms case_prod_conv"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  odd i\n  (case (?a, ?b) of (c, d) \\<Rightarrow> ?f c d) = ?f ?a ?b\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))", "by simp"], ["", "lemma (in jozsa) \\<psi>\\<^sub>2_values_odd_hidden [simp]:\n  assumes \"2*k+1 < dim_row \\<psi>\\<^sub>2\" and \"j < dim_col \\<psi>\\<^sub>2\" \n  shows \"\\<psi>\\<^sub>2 $$ (2*k+1,j) = ((-1)^(f((2*k+1) div 2)+1))/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (2 * k + 1, j) =\n    complex_of_real ((- 1) ^ (f ((2 * k + 1) div 2) + 1) / sqrt 2 ^ (n + 1))", "using assms"], ["proof (prove)\nusing this:\n  2 * k + 1\n  < dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (2 * k + 1, j) =\n    complex_of_real ((- 1) ^ (f ((2 * k + 1) div 2) + 1) / sqrt 2 ^ (n + 1))", "by simp"], ["", "lemma (in jozsa) snd_rep_of_\\<psi>\\<^sub>2:\n  assumes \"i < dim_row \\<psi>\\<^sub>2\"\n  shows \"((1-f(i div 2)) + -f(i div 2)) * 1/(sqrt 2)^(n+1) = (-1)^f(i div 2)/(sqrt 2)^(n+1)\"\n    and \"(-(1-f(i div 2))+(f(i div 2)))* 1/(sqrt 2)^(n+1) = (-1)^(f(i div 2)+1)/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1) &&&\n    real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "proof-"], ["proof (state)\ngoal (2 subgoals):\n 1. real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n 2. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "have \"i div 2 \\<in> {i. i < 2 ^ n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i div 2 \\<in> {i. i < 2 ^ n}", "using assms"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. i div 2 \\<in> {i. i < 2 ^ n}", "by auto"], ["proof (state)\nthis:\n  i div 2 \\<in> {i. i < 2 ^ n}\n\ngoal (2 subgoals):\n 1. real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n 2. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "then"], ["proof (chain)\npicking this:\n  i div 2 \\<in> {i. i < 2 ^ n}", "have \"real (Suc 0 - f (i div 2)) - real (f (i div 2)) = (- 1) ^ f (i div 2)\""], ["proof (prove)\nusing this:\n  i div 2 \\<in> {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. real (Suc 0 - f (i div 2)) - real (f (i div 2)) = (- 1) ^ f (i div 2)", "using assms f_values"], ["proof (prove)\nusing this:\n  i div 2 \\<in> {i. i < 2 ^ n}\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n\ngoal (1 subgoal):\n 1. real (Suc 0 - f (i div 2)) - real (f (i div 2)) = (- 1) ^ f (i div 2)", "by auto"], ["proof (state)\nthis:\n  real (Suc 0 - f (i div 2)) - real (f (i div 2)) = (- 1) ^ f (i div 2)\n\ngoal (2 subgoals):\n 1. real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n 2. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "thus \"((1-f(i div 2)) + -f(i div 2)) * 1/(sqrt 2)^(n+1) = (-1)^f(i div 2)/(sqrt 2)^(n+1)\""], ["proof (prove)\nusing this:\n  real (Suc 0 - f (i div 2)) - real (f (i div 2)) = (- 1) ^ f (i div 2)\n\ngoal (1 subgoal):\n 1. real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)", "by auto"], ["proof (state)\nthis:\n  real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n  sqrt 2 ^ (n + 1) =\n  (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "have \"i div 2 \\<in> {i. i < 2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i div 2 \\<in> {i. i < 2 ^ n}", "using assms"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. i div 2 \\<in> {i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  i div 2 \\<in> {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "then"], ["proof (chain)\npicking this:\n  i div 2 \\<in> {i. i < 2 ^ n}", "have \"(real (f (i div 2)) - real (Suc 0 - f (i div 2))) / (sqrt 2 ^ (n+1)) =\n           - ((- 1) ^ f (i div 2) / (sqrt 2 ^ (n+1)))\""], ["proof (prove)\nusing this:\n  i div 2 \\<in> {i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. (real (f (i div 2)) - real (Suc 0 - f (i div 2))) / sqrt 2 ^ (n + 1) =\n    - ((- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1))", "using assms f_values"], ["proof (prove)\nusing this:\n  i div 2 \\<in> {i. i < 2 ^ n}\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n\ngoal (1 subgoal):\n 1. (real (f (i div 2)) - real (Suc 0 - f (i div 2))) / sqrt 2 ^ (n + 1) =\n    - ((- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1))", "by fastforce"], ["proof (state)\nthis:\n  (real (f (i div 2)) - real (Suc 0 - f (i div 2))) / sqrt 2 ^ (n + 1) =\n  - ((- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "then"], ["proof (chain)\npicking this:\n  (real (f (i div 2)) - real (Suc 0 - f (i div 2))) / sqrt 2 ^ (n + 1) =\n  - ((- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1))", "show \"(-(1-f(i div 2))+(f(i div 2)))* 1/(sqrt 2)^(n+1) = (-1)^(f(i div 2)+1)/(sqrt 2)^(n+1)\""], ["proof (prove)\nusing this:\n  (real (f (i div 2)) - real (Suc 0 - f (i div 2))) / sqrt 2 ^ (n + 1) =\n  - ((- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1) =\n    (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)", "by simp"], ["proof (state)\nthis:\n  real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n  sqrt 2 ^ (n + 1) =\n  (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) jozsa_transform_times_\\<psi>\\<^sub>1_is_\\<psi>\\<^sub>2:\n  shows \"U\\<^sub>f * (\\<psi>\\<^sub>1 n) = \\<psi>\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)\n 2. dim_row\n     (U\\<^sub>f *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n 3. dim_col\n     (U\\<^sub>f *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "show \"dim_row (U\\<^sub>f * (\\<psi>\\<^sub>1 n)) = dim_row \\<psi>\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row\n     (U\\<^sub>f *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "by simp"], ["proof (state)\nthis:\n  dim_row\n   (U\\<^sub>f *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1)))) =\n  dim_row\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)\n 2. dim_col\n     (U\\<^sub>f *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)\n 2. dim_col\n     (U\\<^sub>f *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "show \"dim_col (U\\<^sub>f * (\\<psi>\\<^sub>1 n)) = dim_col \\<psi>\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col\n     (U\\<^sub>f *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then 1 / sqrt 2 ^ (n + 1)\n               else - 1 / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "by simp"], ["proof (state)\nthis:\n  dim_col\n   (U\\<^sub>f *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1)))) =\n  dim_col\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "fix i j ::nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "assume a0: \"i < dim_row \\<psi>\\<^sub>2\" and a1: \"j < dim_col \\<psi>\\<^sub>2\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "have f0:\"i \\<in> {0..2^(n+1)} \\<and> j=0\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. i \\<in> {0..2 ^ (n + 1)} \\<and> j = 0", "by simp"], ["proof (state)\nthis:\n  i \\<in> {0..2 ^ (n + 1)} \\<and> j = 0\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  i \\<in> {0..2 ^ (n + 1)} \\<and> j = 0", "have f1: \"i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f \""], ["proof (prove)\nusing this:\n  i \\<in> {0..2 ^ (n + 1)} \\<and> j = 0\n\ngoal (1 subgoal):\n 1. i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f", "using a0"], ["proof (prove)\nusing this:\n  i \\<in> {0..2 ^ (n + 1)} \\<and> j = 0\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f", "by simp"], ["proof (state)\nthis:\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "have f2: \"i < dim_row (\\<psi>\\<^sub>1 n) \\<and> j < dim_col (\\<psi>\\<^sub>1 n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then 1 / sqrt 2 ^ (n + 1)\n                   else - 1 / sqrt 2 ^ (n + 1)))) \\<and>\n    j < dim_col\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then 1 / sqrt 2 ^ (n + 1)\n                   else - 1 / sqrt 2 ^ (n + 1))))", "using a0 a1"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. i < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then 1 / sqrt 2 ^ (n + 1)\n                   else - 1 / sqrt 2 ^ (n + 1)))) \\<and>\n    j < dim_col\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then 1 / sqrt 2 ^ (n + 1)\n                   else - 1 / sqrt 2 ^ (n + 1))))", "by simp"], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1)))) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                               else (- 1) ^ (f (i div 2) + 1) /\n                                    sqrt 2 ^ (n + 1))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                       else (- 1) ^ (f (i div 2) + 1) /\n                            sqrt 2 ^ (n + 1))))\\<rbrakk>\n       \\<Longrightarrow> (U\\<^sub>f *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i then 1 / sqrt 2 ^ (n + 1)\n                                   else - 1 / sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then (- 1) ^ f (i div 2) /\n sqrt 2 ^ (n + 1)\n                                  else (- 1) ^ (f (i div 2) + 1) /\n sqrt 2 ^ (n + 1))) $$\n                         (i, j)", "show \"(U\\<^sub>f * (\\<psi>\\<^sub>1 n)) $$ (i,j) = \\<psi>\\<^sub>2 $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "proof (rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 3. ?Q \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "show \"even i \\<or> odd i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. even i \\<or> odd i", "by auto"], ["proof (state)\nthis:\n  even i \\<or> odd i\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "assume a2: \"even i\""], ["proof (state)\nthis:\n  even i\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  even i", "have \"(U\\<^sub>f * (\\<psi>\\<^sub>1 n)) $$ (i,j) = (\\<Sum>k \\<in> {i,i+1}. U\\<^sub>f $$ (i,k) * (\\<psi>\\<^sub>1 n) $$ (k,j))\""], ["proof (prove)\nusing this:\n  even i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}.\n       U\\<^sub>f $$ (i, k) *\n       Matrix.mat (2 ^ (n + 1)) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                if even i then 1 / sqrt 2 ^ (n + 1)\n                else - 1 / sqrt 2 ^ (n + 1))) $$\n       (k, j))", "using f1 f2 U\\<^sub>f_mult_without_empty_summands_even[of i j \"(\\<psi>\\<^sub>1 n)\"]"], ["proof (prove)\nusing this:\n  even i\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1)))) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  \\<lbrakk>i < dim_row U\\<^sub>f;\n   j < dim_col\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then 1 / sqrt 2 ^ (n + 1)\n                  else - 1 / sqrt 2 ^ (n + 1))));\n   even i;\n   dim_col U\\<^sub>f =\n   dim_row\n    (Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n  \\<Longrightarrow> (U\\<^sub>f *\n                     Matrix.mat (2 ^ (n + 1)) 1\n                      (\\<lambda>x.\n                          complex_of_real\n                           (case x of\n                            (i, j) \\<Rightarrow>\n                              if even i then 1 / sqrt 2 ^ (n + 1)\n                              else - 1 / sqrt 2 ^ (n + 1)))) $$\n                    (i, j) =\n                    (\\<Sum>k\\<in>{i, i + 1}.\n                       U\\<^sub>f $$ (i, k) *\n                       Matrix.mat (2 ^ (n + 1)) 1\n                        (\\<lambda>x.\n                            complex_of_real\n                             (case x of\n                              (i, j) \\<Rightarrow>\n                                if even i then 1 / sqrt 2 ^ (n + 1)\n                                else - 1 / sqrt 2 ^ (n + 1))) $$\n                       (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    (\\<Sum>k\\<in>{i, i + 1}.\n       U\\<^sub>f $$ (i, k) *\n       Matrix.mat (2 ^ (n + 1)) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                if even i then 1 / sqrt 2 ^ (n + 1)\n                else - 1 / sqrt 2 ^ (n + 1))) $$\n       (k, j))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"U\\<^sub>f $$ (i,i) * (\\<psi>\\<^sub>1 n) $$ (i,j) = (1-f(i div 2))* 1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1))", "using f0 f1 a2"], ["proof (prove)\nusing this:\n  i \\<in> {0..2 ^ (n + 1)} \\<and> j = 0\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n  even i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"U\\<^sub>f $$ (i,i+1) * (\\<psi>\\<^sub>1 n) $$ (i+1,j) = (-f(i div 2))* 1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i + 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i + 1, j) =\n    complex_of_real\n     (real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))", "using f0 f1 a2"], ["proof (prove)\nusing this:\n  i \\<in> {0..2 ^ (n + 1)} \\<and> j = 0\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n  even i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i + 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i + 1, j) =\n    complex_of_real\n     (real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))", "by auto"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i + 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i + 1, j) =\n  complex_of_real (real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n  U\\<^sub>f $$ (i, i + 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i + 1, j) =\n  complex_of_real (real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))", "have \"(U\\<^sub>f * (\\<psi>\\<^sub>1 n)) $$ (i,j) = (1-f(i div 2))* 1/(sqrt 2)^(n+1) + (-f(i div 2))* 1/(sqrt 2)^(n+1)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i, i + 1}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n  U\\<^sub>f $$ (i, i + 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i + 1, j) =\n  complex_of_real (real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1) +\n      real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1) +\n    real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "also"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1) +\n    real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"... = ((1-f(i div 2))+-f(i div 2)) * 1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1) +\n      real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1)) =\n    complex_of_real\n     (real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n      sqrt 2 ^ (n + 1))", "using add_divide_distrib"], ["proof (prove)\nusing this:\n  (?a + ?b) / ?c = ?a / ?c + ?b / ?c\n\ngoal (1 subgoal):\n 1. complex_of_real\n     (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1) +\n      real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1)) =\n    complex_of_real\n     (real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n      sqrt 2 ^ (n + 1))", "by (metis (no_types, hide_lams) mult.right_neutral of_int_add of_int_of_nat_eq)"], ["proof (state)\nthis:\n  complex_of_real\n   (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1) +\n    real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1)) =\n  complex_of_real\n   (real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "also"], ["proof (state)\nthis:\n  complex_of_real\n   (real ((1 - f (i div 2)) * 1) / sqrt 2 ^ (n + 1) +\n    real_of_int (- int (f (i div 2)) * 1) / sqrt 2 ^ (n + 1)) =\n  complex_of_real\n   (real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"... = \\<psi>\\<^sub>2 $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n      sqrt 2 ^ (n + 1)) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "using a0 a1 a2 snd_rep_of_\\<psi>\\<^sub>2"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  even i\n  ?i < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<Longrightarrow>\n  real_of_int ((int (1 - f (?i div 2)) + - int (f (?i div 2))) * 1) /\n  sqrt 2 ^ (n + 1) =\n  (- 1) ^ f (?i div 2) / sqrt 2 ^ (n + 1)\n  ?i < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<Longrightarrow>\n  real_of_int ((- int (1 - f (?i div 2)) + int (f (?i div 2))) * 1) /\n  sqrt 2 ^ (n + 1) =\n  (- 1) ^ (f (?i div 2) + 1) / sqrt 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. complex_of_real\n     (real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n      sqrt 2 ^ (n + 1)) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  complex_of_real\n   (real_of_int ((int (1 - f (i div 2)) + - int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1)) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "finally"], ["proof (chain)\npicking this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (i, j)", "show \"(U\\<^sub>f * (\\<psi>\\<^sub>1 n)) $$ (i,j) = \\<psi>\\<^sub>2 $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "assume a2: \"odd i\""], ["proof (state)\nthis:\n  odd i\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  odd i", "have f6: \"i\\<ge>1\""], ["proof (prove)\nusing this:\n  odd i\n\ngoal (1 subgoal):\n 1. 1 \\<le> i", "using linorder_not_less"], ["proof (prove)\nusing this:\n  odd i\n  (\\<not> ?x < ?y) = (?y \\<le> ?x)\n\ngoal (1 subgoal):\n 1. 1 \\<le> i", "by auto"], ["proof (state)\nthis:\n  1 \\<le> i\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"(U\\<^sub>f * (\\<psi>\\<^sub>1 n)) $$ (i,j) = (\\<Sum>k \\<in> {i-1,i}. U\\<^sub>f $$ (i,k) * (\\<psi>\\<^sub>1 n) $$ (k,j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}.\n       U\\<^sub>f $$ (i, k) *\n       Matrix.mat (2 ^ (n + 1)) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                if even i then 1 / sqrt 2 ^ (n + 1)\n                else - 1 / sqrt 2 ^ (n + 1))) $$\n       (k, j))", "using f1 f2 a2 U\\<^sub>f_mult_without_empty_summands_odd[of i j \"(\\<psi>\\<^sub>1 n)\"]"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1)))) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  odd i\n  \\<lbrakk>i < dim_row U\\<^sub>f;\n   j < dim_col\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then 1 / sqrt 2 ^ (n + 1)\n                  else - 1 / sqrt 2 ^ (n + 1))));\n   odd i;\n   dim_col U\\<^sub>f =\n   dim_row\n    (Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))))\\<rbrakk>\n  \\<Longrightarrow> (U\\<^sub>f *\n                     Matrix.mat (2 ^ (n + 1)) 1\n                      (\\<lambda>x.\n                          complex_of_real\n                           (case x of\n                            (i, j) \\<Rightarrow>\n                              if even i then 1 / sqrt 2 ^ (n + 1)\n                              else - 1 / sqrt 2 ^ (n + 1)))) $$\n                    (i, j) =\n                    (\\<Sum>k\\<in>{i - 1, i}.\n                       U\\<^sub>f $$ (i, k) *\n                       Matrix.mat (2 ^ (n + 1)) 1\n                        (\\<lambda>x.\n                            complex_of_real\n                             (case x of\n                              (i, j) \\<Rightarrow>\n                                if even i then 1 / sqrt 2 ^ (n + 1)\n                                else - 1 / sqrt 2 ^ (n + 1))) $$\n                       (k, j))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    (\\<Sum>k\\<in>{i - 1, i}.\n       U\\<^sub>f $$ (i, k) *\n       Matrix.mat (2 ^ (n + 1)) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                if even i then 1 / sqrt 2 ^ (n + 1)\n                else - 1 / sqrt 2 ^ (n + 1))) $$\n       (k, j))", "by (metis dim_row_mat(1) jozsa_transform_dim(2))"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"(\\<Sum>k \\<in> {i-1,i}. U\\<^sub>f $$ (i,k) * (\\<psi>\\<^sub>1 n) $$ (k,j)) \n                 = U\\<^sub>f $$ (i,i-1) * (\\<psi>\\<^sub>1 n) $$ (i-1,j) +  U\\<^sub>f $$ (i,i) * (\\<psi>\\<^sub>1 n) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i - 1, i}.\n       U\\<^sub>f $$ (i, k) *\n       Matrix.mat (2 ^ (n + 1)) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                if even i then 1 / sqrt 2 ^ (n + 1)\n                else - 1 / sqrt 2 ^ (n + 1))) $$\n       (k, j)) =\n    U\\<^sub>f $$ (i, i - 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i - 1, j) +\n    U\\<^sub>f $$ (i, i) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "using a2 f6"], ["proof (prove)\nusing this:\n  odd i\n  1 \\<le> i\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i - 1, i}.\n       U\\<^sub>f $$ (i, k) *\n       Matrix.mat (2 ^ (n + 1)) 1\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                if even i then 1 / sqrt 2 ^ (n + 1)\n                else - 1 / sqrt 2 ^ (n + 1))) $$\n       (k, j)) =\n    U\\<^sub>f $$ (i, i - 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i - 1, j) +\n    U\\<^sub>f $$ (i, i) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) +\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) +\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have  \"U\\<^sub>f $$ (i,i) * (\\<psi>\\<^sub>1 n) $$ (i,j) = (1-f(i div 2))* -1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real\n     (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1))", "using f1 f2 a2"], ["proof (prove)\nusing this:\n  i < dim_row U\\<^sub>f \\<and> j < dim_col U\\<^sub>f\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1)))) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then 1 / sqrt 2 ^ (n + 1)\n                 else - 1 / sqrt 2 ^ (n + 1))))\n  odd i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i, j) =\n    complex_of_real\n     (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"U\\<^sub>f $$ (i,i-1) * (\\<psi>\\<^sub>1 n) $$ (i-1,j) = f(i div 2)* 1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i - 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i - 1, j) =\n    complex_of_real (real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))", "using a0 a1 a2"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  odd i\n\ngoal (1 subgoal):\n 1. U\\<^sub>f $$ (i, i - 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (n + 1)\n             else - 1 / sqrt 2 ^ (n + 1))) $$\n    (i - 1, j) =\n    complex_of_real (real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) =\n  complex_of_real (real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) +\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1))\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) =\n  complex_of_real (real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))", "have \"(U\\<^sub>f * (\\<psi>\\<^sub>1 n)) $$ (i,j) = (1-f(i div 2))* -1/(sqrt 2)^(n+1) +(f(i div 2))* 1/(sqrt 2)^(n+1)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) +\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1))\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) =\n  complex_of_real (real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1) +\n      real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))", "using of_real_add"], ["proof (prove)\nusing this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j))\n  (\\<Sum>k\\<in>{i - 1, i}.\n     U\\<^sub>f $$ (i, k) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1))) $$\n     (k, j)) =\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) +\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n  U\\<^sub>f $$ (i, i) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i, j) =\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1))\n  U\\<^sub>f $$ (i, i - 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) $$\n  (i - 1, j) =\n  complex_of_real (real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))\n  of_real (?x + ?y) = of_real ?x + of_real ?y\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1) +\n      real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1) +\n    real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "also"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1) +\n    real (f (i div 2) * 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"... = (-(1-f(i div 2)) + (f(i div 2))) * 1/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1) +\n      real (f (i div 2) * 1) / sqrt 2 ^ (n + 1)) =\n    complex_of_real\n     (real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n      sqrt 2 ^ (n + 1))", "by (metis (no_types, hide_lams) mult.right_neutral add_divide_distrib mult_minus1_right \n          of_int_add of_int_of_nat_eq)"], ["proof (state)\nthis:\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1) +\n    real (f (i div 2) * 1) / sqrt 2 ^ (n + 1)) =\n  complex_of_real\n   (real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "also"], ["proof (state)\nthis:\n  complex_of_real\n   (real_of_int (int (1 - f (i div 2)) * - 1) / sqrt 2 ^ (n + 1) +\n    real (f (i div 2) * 1) / sqrt 2 ^ (n + 1)) =\n  complex_of_real\n   (real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "have \"... = (-1)^(f(i div 2)+1)/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n      sqrt 2 ^ (n + 1)) =\n    complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))", "using a0 a1 a2 snd_rep_of_\\<psi>\\<^sub>2"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  odd i\n  ?i < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<Longrightarrow>\n  real_of_int ((int (1 - f (?i div 2)) + - int (f (?i div 2))) * 1) /\n  sqrt 2 ^ (n + 1) =\n  (- 1) ^ f (?i div 2) / sqrt 2 ^ (n + 1)\n  ?i < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<Longrightarrow>\n  real_of_int ((- int (1 - f (?i div 2)) + int (f (?i div 2))) * 1) /\n  sqrt 2 ^ (n + 1) =\n  (- 1) ^ (f (?i div 2) + 1) / sqrt 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. complex_of_real\n     (real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n      sqrt 2 ^ (n + 1)) =\n    complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  complex_of_real\n   (real_of_int ((- int (1 - f (i div 2)) + int (f (i div 2))) * 1) /\n    sqrt 2 ^ (n + 1)) =\n  complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "finally"], ["proof (chain)\npicking this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))", "show \"(U\\<^sub>f * (\\<psi>\\<^sub>1 n)) $$ (i,j) = \\<psi>\\<^sub>2 $$ (i,j)\""], ["proof (prove)\nusing this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "using a0 a1 a2"], ["proof (prove)\nusing this:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real ((- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  odd i\n\ngoal (1 subgoal):\n 1. (U\\<^sub>f *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then 1 / sqrt 2 ^ (n + 1)\n              else - 1 / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (U\\<^sub>f *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then 1 / sqrt 2 ^ (n + 1)\n            else - 1 / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) \\<psi>\\<^sub>2_is_state:\n  shows \"state (n+1) \\<psi>\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "using jozsa_transform_times_\\<psi>\\<^sub>1_is_\\<psi>\\<^sub>2 jozsa_transform_is_gate \\<psi>\\<^sub>1_is_state dim gate_on_state_is_state"], ["proof (prove)\nusing this:\n  U\\<^sub>f *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))\n  gate (n + 1) U\\<^sub>f\n  1 \\<le> ?n \\<Longrightarrow>\n  state (?n + 1)\n   (Matrix.mat (2 ^ (?n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then 1 / sqrt 2 ^ (?n + 1)\n             else - 1 / sqrt 2 ^ (?n + 1))))\n  1 \\<le> n\n  \\<lbrakk>gate ?n ?A; state ?n ?v\\<rbrakk>\n  \\<Longrightarrow> state ?n (?A * ?v)\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "by fastforce"], ["", "text \\<open>@{text \"H^\\<^sub>\\<otimes> n\"} is the result of taking the nth tensor product of H\\<close>"], ["", "abbreviation iter_tensor_of_H_rep:: \"nat \\<Rightarrow> complex Matrix.mat\" (\"H^\\<^sub>\\<otimes> _\") where\n\"iter_tensor_of_H_rep n \\<equiv> Matrix.mat (2^n) (2^n) (\\<lambda>(i,j).(-1)^(i \\<cdot>\\<^bsub>n\\<^esub> j)/(sqrt 2)^n)\""], ["", "lemma tensor_of_H_values [simp]:\n  fixes n i j:: nat\n  assumes \"i < dim_row (H^\\<^sub>\\<otimes> n)\" and \"j < dim_col (H^\\<^sub>\\<otimes> n)\"\n  shows \"(H^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^(i \\<cdot>\\<^bsub>n\\<^esub> j)/(sqrt 2)^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i, j) =\n    complex_of_real ((- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)", "using assms"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))\n  j < dim_col\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i, j) =\n    complex_of_real ((- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)", "by simp"], ["", "lemma dim_row_of_iter_tensor_of_H [simp]:\n  assumes \"n \\<ge> 1\"\n  shows \"1 < dim_row (H^\\<^sub>\\<otimes> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < dim_row\n         (Matrix.mat (2 ^ n) (2 ^ n)\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. 1 < dim_row\n         (Matrix.mat (2 ^ n) (2 ^ n)\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))", "by(metis One_nat_def Suc_1 dim_row_mat(1) le_trans lessI linorder_not_less one_less_power)"], ["", "lemma iter_tensor_of_H_fst_pos:\n  fixes n i j:: nat\n  assumes \"i < 2^n \\<or> j < 2^n\" and \"i < 2^(n+1) \\<and> j < 2^(n+1)\"\n  shows \"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = 1/sqrt(2) * ((H^\\<^sub>\\<otimes> n) $$ (i mod 2^n, j mod 2^n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "have \"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = (-1)^(bip i (Suc n) j)/(sqrt 2)^(Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real\n     ((- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)", "using assms"], ["proof (prove)\nusing this:\n  i < 2 ^ n \\<or> j < 2 ^ n\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real\n     ((- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "moreover"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "have \"bip i (Suc n) j = bip (i mod 2^n) n (j mod 2^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i \\<cdot>\\<^bsub>Suc n\\<^esub>  j =\n    i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n", "using bitwise_inner_prod_fst_el_0 assms(1)"], ["proof (prove)\nusing this:\n  ?i < 2 ^ ?n \\<or> ?j < 2 ^ ?n \\<Longrightarrow>\n  ?i \\<cdot>\\<^bsub>Suc ?n\\<^esub>  ?j =\n  ?i mod 2 ^ ?n \\<cdot>\\<^bsub>?n\\<^esub>  ?j mod 2 ^ ?n\n  i < 2 ^ n \\<or> j < 2 ^ n\n\ngoal (1 subgoal):\n 1. i \\<cdot>\\<^bsub>Suc n\\<^esub>  j =\n    i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n", "by simp"], ["proof (state)\nthis:\n  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j =\n  i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "ultimately"], ["proof (chain)\npicking this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)\n  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j =\n  i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n", "show ?thesis"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)\n  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j =\n  i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "using bitwise_inner_prod_def"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)\n  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j =\n  i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n\n  ?i \\<cdot>\\<^bsub>?n\\<^esub>  ?j =\n  (\\<Sum>k = 0..<?n. bin_rep ?n ?i ! k * bin_rep ?n ?j ! k)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma iter_tensor_of_H_fst_neg:\n  fixes n i j:: nat\n  assumes \"i \\<ge> 2^n \\<and> j \\<ge> 2^n\" and \"i < 2^(n+1) \\<and> j < 2^(n+1)\"\n  shows \"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = -1/sqrt(2) * (H^\\<^sub>\\<otimes> n) $$ (i mod 2^n, j mod 2^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "have \"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = (-1)^(bip i (n+1) j)/(sqrt 2)^(n+1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real\n     ((- 1) ^ i \\<cdot>\\<^bsub>n + 1\\<^esub>  j / sqrt 2 ^ (n + 1))", "using assms(2)"], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real\n     ((- 1) ^ i \\<cdot>\\<^bsub>n + 1\\<^esub>  j / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>n + 1\\<^esub>  j / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "moreover"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>n + 1\\<^esub>  j / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "have \"bip i (n+1) j = 1 + bip (i mod 2^n) n (j mod 2^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i \\<cdot>\\<^bsub>n + 1\\<^esub>  j =\n    1 + i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n", "using bitwise_inner_prod_fst_el_is_1 assms"], ["proof (prove)\nusing this:\n  \\<lbrakk>2 ^ ?n \\<le> ?i \\<and> 2 ^ ?n \\<le> ?j;\n   ?i < 2 ^ (?n + 1) \\<and> ?j < 2 ^ (?n + 1)\\<rbrakk>\n  \\<Longrightarrow> ?i \\<cdot>\\<^bsub>?n + 1\\<^esub>  ?j =\n                    1 +\n                    ?i mod 2 ^ ?n \\<cdot>\\<^bsub>?n\\<^esub>  ?j mod 2 ^ ?n\n  2 ^ n \\<le> i \\<and> 2 ^ n \\<le> j\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. i \\<cdot>\\<^bsub>n + 1\\<^esub>  j =\n    1 + i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n", "by simp"], ["proof (state)\nthis:\n  i \\<cdot>\\<^bsub>n + 1\\<^esub>  j =\n  1 + i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "ultimately"], ["proof (chain)\npicking this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>n + 1\\<^esub>  j / sqrt 2 ^ (n + 1))\n  i \\<cdot>\\<^bsub>n + 1\\<^esub>  j =\n  1 + i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n", "show ?thesis"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real\n   ((- 1) ^ i \\<cdot>\\<^bsub>n + 1\\<^esub>  j / sqrt 2 ^ (n + 1))\n  i \\<cdot>\\<^bsub>n + 1\\<^esub>  j =\n  1 + i mod 2 ^ n \\<cdot>\\<^bsub>n\\<^esub>  j mod 2 ^ n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (- 1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma H_tensor_iter_tensor_of_H:   \n  fixes n:: nat\n  shows  \"(H \\<Otimes> H^\\<^sub>\\<otimes> n) = H^\\<^sub>\\<otimes> (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<Otimes>\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                               sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                       sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (H \\<Otimes>\n                          Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n 3. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "fix i j:: nat"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                               sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                       sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (H \\<Otimes>\n                          Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n 3. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "assume a0: \"i < dim_row (H^\\<^sub>\\<otimes> (Suc n))\" and a1: \"j < dim_col (H^\\<^sub>\\<otimes> (Suc n))\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                               sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                       sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (H \\<Otimes>\n                          Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n 3. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))", "have f0: \"i \\<in> {0..<2^(n+1)} \\<and> j \\<in> {0..<2^(n+1)}\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}", "by simp"], ["proof (state)\nthis:\n  i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                               sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                       sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (H \\<Otimes>\n                          Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n 3. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "then"], ["proof (chain)\npicking this:\n  i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}", "have f1: \"(H \\<Otimes> H^\\<^sub>\\<otimes> n) $$ (i,j) = H $$ (i div (dim_row (H^\\<^sub>\\<otimes> n)),j div (dim_col (H^\\<^sub>\\<otimes> n))) \n                                       * (H^\\<^sub>\\<otimes> n) $$ (i mod (dim_row (H^\\<^sub>\\<otimes> n)),j mod (dim_col (H^\\<^sub>\\<otimes> n)))\""], ["proof (prove)\nusing this:\n  i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}\n\ngoal (1 subgoal):\n 1. (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    H $$\n    (i div\n     dim_row\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n     j div\n     dim_col\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod\n     dim_row\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n     j mod\n     dim_col\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))))", "by (simp add: H_without_scalar_prod)"], ["proof (state)\nthis:\n  (H \\<Otimes>\n   Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n  (i, j) =\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j mod\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))))\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                               sqrt 2 ^ Suc n)));\n        j < dim_col\n             (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                       sqrt 2 ^ Suc n)))\\<rbrakk>\n       \\<Longrightarrow> (H \\<Otimes>\n                          Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n)) $$\n                         (i, j)\n 2. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n 3. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "show \"(H \\<Otimes> H^\\<^sub>\\<otimes> n) $$ (i,j) = (H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "proof (rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 3. ?Q \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "show \"(i < 2^n \\<or> j < 2^n) \\<or> \\<not>(i < 2^n \\<or> j < 2^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (i < 2 ^ n \\<or> j < 2 ^ n) \\<or> \\<not> (i < 2 ^ n \\<or> j < 2 ^ n)", "by auto"], ["proof (state)\nthis:\n  (i < 2 ^ n \\<or> j < 2 ^ n) \\<or> \\<not> (i < 2 ^ n \\<or> j < 2 ^ n)\n\ngoal (2 subgoals):\n 1. i < 2 ^ n \\<or> j < 2 ^ n \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. i < 2 ^ n \\<or> j < 2 ^ n \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "assume a2: \"(i < 2^n \\<or> j < 2^n)\""], ["proof (state)\nthis:\n  i < 2 ^ n \\<or> j < 2 ^ n\n\ngoal (2 subgoals):\n 1. i < 2 ^ n \\<or> j < 2 ^ n \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  i < 2 ^ n \\<or> j < 2 ^ n", "have \"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = 1/sqrt(2) * ((H^\\<^sub>\\<otimes> n) $$ (i mod 2^n, j mod 2^n))\""], ["proof (prove)\nusing this:\n  i < 2 ^ n \\<or> j < 2 ^ n\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "using a0 a1 f0 iter_tensor_of_H_fst_pos"], ["proof (prove)\nusing this:\n  i < 2 ^ n \\<or> j < 2 ^ n\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}\n  \\<lbrakk>?i < 2 ^ ?n \\<or> ?j < 2 ^ ?n;\n   ?i < 2 ^ (?n + 1) \\<and> ?j < 2 ^ (?n + 1)\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ Suc ?n) (2 ^ Suc ?n)\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             (- 1) ^ i \\<cdot>\\<^bsub>Suc ?n\\<^esub>  j /\n                             sqrt 2 ^ Suc ?n)) $$\n                    (?i, ?j) =\n                    complex_of_real (1 / sqrt 2) *\n                    Matrix.mat (2 ^ ?n) (2 ^ ?n)\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j /\n                             sqrt 2 ^ ?n)) $$\n                    (?i mod 2 ^ ?n, ?j mod 2 ^ ?n)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "by (metis (mono_tags, lifting) atLeastLessThan_iff)"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n\ngoal (2 subgoals):\n 1. i < 2 ^ n \\<or> j < 2 ^ n \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n\ngoal (2 subgoals):\n 1. i < 2 ^ n \\<or> j < 2 ^ n \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "have \"H $$ (i div (dim_row (H^\\<^sub>\\<otimes> n)),j div (dim_col (H^\\<^sub>\\<otimes> n))) = 1/sqrt 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H $$\n    (i div\n     dim_row\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n     j div\n     dim_col\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n    complex_of_real (1 / sqrt 2)", "using a0 a1 f0 H_without_scalar_prod H_values a2"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}\n  H =\n  Matrix.mat 2 2\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i \\<noteq> j then 1 / sqrt 2\n           else if i = 0 then 1 / sqrt 2 else - (1 / sqrt 2)))\n  \\<lbrakk>?i < dim_row H; ?j < dim_col H;\n   ?i \\<noteq> 1 \\<or> ?j \\<noteq> 1\\<rbrakk>\n  \\<Longrightarrow> H $$ (?i, ?j) = complex_of_real (1 / sqrt 2)\n  i < 2 ^ n \\<or> j < 2 ^ n\n\ngoal (1 subgoal):\n 1. H $$\n    (i div\n     dim_row\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n     j div\n     dim_col\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n    complex_of_real (1 / sqrt 2)", "by (metis (no_types, lifting) dim_col_mat(1) dim_row_mat(1) div_less le_eq_less_or_eq \n          le_numeral_extra(2) less_power_add_imp_div_less plus_1_eq_Suc power_one_right)"], ["proof (state)\nthis:\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (2 subgoals):\n 1. i < 2 ^ n \\<or> j < 2 ^ n \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)\n 2. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (1 / sqrt 2)", "show \"(H \\<Otimes> H^\\<^sub>\\<otimes> n) $$ (i,j) = (H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j)\""], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "using f1"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (1 / sqrt 2)\n  (H \\<Otimes>\n   Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n  (i, j) =\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j mod\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))))\n\ngoal (1 subgoal):\n 1. (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (H \\<Otimes>\n   Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "assume a2: \"\\<not>(i < 2^n \\<or> j < 2^n)\""], ["proof (state)\nthis:\n  \\<not> (i < 2 ^ n \\<or> j < 2 ^ n)\n\ngoal (1 subgoal):\n 1. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  \\<not> (i < 2 ^ n \\<or> j < 2 ^ n)", "have \"i \\<ge> 2^n \\<and> j \\<ge> 2^n\""], ["proof (prove)\nusing this:\n  \\<not> (i < 2 ^ n \\<or> j < 2 ^ n)\n\ngoal (1 subgoal):\n 1. 2 ^ n \\<le> i \\<and> 2 ^ n \\<le> j", "by simp"], ["proof (state)\nthis:\n  2 ^ n \\<le> i \\<and> 2 ^ n \\<le> j\n\ngoal (1 subgoal):\n 1. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  2 ^ n \\<le> i \\<and> 2 ^ n \\<le> j", "have f2:\"(H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j) = -1/sqrt(2) * ((H^\\<^sub>\\<otimes> n) $$ (i mod 2^n, j mod 2^n))\""], ["proof (prove)\nusing this:\n  2 ^ n \\<le> i \\<and> 2 ^ n \\<le> j\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "using a0 a1 f0 iter_tensor_of_H_fst_neg"], ["proof (prove)\nusing this:\n  2 ^ n \\<le> i \\<and> 2 ^ n \\<le> j\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}\n  \\<lbrakk>2 ^ ?n \\<le> ?i \\<and> 2 ^ ?n \\<le> ?j;\n   ?i < 2 ^ (?n + 1) \\<and> ?j < 2 ^ (?n + 1)\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ Suc ?n) (2 ^ Suc ?n)\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             (- 1) ^ i \\<cdot>\\<^bsub>Suc ?n\\<^esub>  j /\n                             sqrt 2 ^ Suc ?n)) $$\n                    (?i, ?j) =\n                    complex_of_real (- 1 / sqrt 2) *\n                    Matrix.mat (2 ^ ?n) (2 ^ ?n)\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j /\n                             sqrt 2 ^ ?n)) $$\n                    (?i mod 2 ^ ?n, ?j mod 2 ^ ?n)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j) =\n    complex_of_real (- 1 / sqrt 2) *\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i mod 2 ^ n, j mod 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (- 1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n\ngoal (1 subgoal):\n 1. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "have \"i div (dim_row (H^\\<^sub>\\<otimes> n)) =1\" and \"j div (dim_row (H^\\<^sub>\\<otimes> n)) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i div\n    dim_row\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    1 &&&\n    j div\n    dim_row\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    1", "using a2 a0 a1"], ["proof (prove)\nusing this:\n  \\<not> (i < 2 ^ n \\<or> j < 2 ^ n)\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. i div\n    dim_row\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    1 &&&\n    j div\n    dim_row\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    1", "by auto"], ["proof (state)\nthis:\n  i div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1\n  j div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1\n\ngoal (1 subgoal):\n 1. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  i div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1\n  j div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1", "have \"H $$ (i div (dim_row (H^\\<^sub>\\<otimes> n)),j div (dim_col (H^\\<^sub>\\<otimes> n))) = -1/sqrt 2\""], ["proof (prove)\nusing this:\n  i div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1\n  j div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1\n\ngoal (1 subgoal):\n 1. H $$\n    (i div\n     dim_row\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n     j div\n     dim_col\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n    complex_of_real (- 1 / sqrt 2)", "using a0 a1 f0 H_values_right_bottom[of \"i div (dim_row (H^\\<^sub>\\<otimes> n))\" \"j div (dim_col (H^\\<^sub>\\<otimes> n))\"] a2"], ["proof (prove)\nusing this:\n  i div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1\n  j div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1\n  i < dim_row\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  j < dim_col\n       (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                 sqrt 2 ^ Suc n)))\n  i \\<in> {0..<2 ^ (n + 1)} \\<and> j \\<in> {0..<2 ^ (n + 1)}\n  i div\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1 \\<and>\n  j div\n  dim_col\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  1 \\<Longrightarrow>\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (- 1 / sqrt 2)\n  \\<not> (i < 2 ^ n \\<or> j < 2 ^ n)\n\ngoal (1 subgoal):\n 1. H $$\n    (i div\n     dim_row\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n     j div\n     dim_col\n      (Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n    complex_of_real (- 1 / sqrt 2)", "by fastforce"], ["proof (state)\nthis:\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (- 1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<not> (i < 2 ^ n \\<or> j < 2 ^ n) \\<Longrightarrow>\n    (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (- 1 / sqrt 2)", "show \"(H \\<Otimes> H^\\<^sub>\\<otimes> n) $$ (i,j) = (H^\\<^sub>\\<otimes> (Suc n)) $$ (i,j)\""], ["proof (prove)\nusing this:\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (- 1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "using f1 f2"], ["proof (prove)\nusing this:\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) =\n  complex_of_real (- 1 / sqrt 2)\n  (H \\<Otimes>\n   Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n  (i, j) =\n  H $$\n  (i div\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j div\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod\n   dim_row\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))),\n   j mod\n   dim_col\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))))\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j) =\n  complex_of_real (- 1 / sqrt 2) *\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i mod 2 ^ n, j mod 2 ^ n)\n\ngoal (1 subgoal):\n 1. (H \\<Otimes>\n     Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n    (i, j) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (H \\<Otimes>\n   Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (H \\<Otimes>\n   Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) $$\n  (i, j) =\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)) $$\n  (i, j)\n\ngoal (2 subgoals):\n 1. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n 2. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n 2. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "show \"dim_row (H \\<Otimes> H^\\<^sub>\\<otimes> n) = dim_row (H^\\<^sub>\\<otimes> (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_row\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "by (simp add: H_without_scalar_prod)"], ["proof (state)\nthis:\n  dim_row\n   (H \\<Otimes>\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  dim_row\n   (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n\ngoal (1 subgoal):\n 1. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "show \"dim_col (H \\<Otimes> H^\\<^sub>\\<otimes> n) = dim_col (H^\\<^sub>\\<otimes> (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col\n     (H \\<Otimes>\n      Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n    dim_col\n     (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))", "by (simp add: H_without_scalar_prod)"], ["proof (state)\nthis:\n  dim_col\n   (H \\<Otimes>\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) =\n  dim_col\n   (Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n)))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\nWe prove that @{term \"H^\\<^sub>\\<otimes> n\"} is indeed the matrix representation of @{term \"H \\<otimes>\\<^bsup>n\\<^esup>\"}, the iterated \ntensor product of the Hadamard gate H.\n\\<close>"], ["", "lemma one_tensor_of_H_is_H:\n  shows \"(H^\\<^sub>\\<otimes> 1) = H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) =\n    H", "proof(rule eq_matI)"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n       \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                                  sqrt 2 ^ 1)) $$\n                         (i, j) =\n                         H $$ (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ 1) (2 ^ 1)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))) =\n    dim_row H\n 3. dim_col\n     (Matrix.mat (2 ^ 1) (2 ^ 1)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))) =\n    dim_col H", "show \"dim_row (H^\\<^sub>\\<otimes> 1) = dim_row H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ 1) (2 ^ 1)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))) =\n    dim_row H", "by (simp add: H_without_scalar_prod)"], ["proof (state)\nthis:\n  dim_row\n   (Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))) =\n  dim_row H\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n       \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                                  sqrt 2 ^ 1)) $$\n                         (i, j) =\n                         H $$ (i, j)\n 2. dim_col\n     (Matrix.mat (2 ^ 1) (2 ^ 1)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))) =\n    dim_col H", "show \"dim_col (H^\\<^sub>\\<otimes> 1) = dim_col H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col\n     (Matrix.mat (2 ^ 1) (2 ^ 1)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))) =\n    dim_col H", "by (simp add: H_without_scalar_prod)"], ["proof (state)\nthis:\n  dim_col\n   (Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))) =\n  dim_col H\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n       \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                                  sqrt 2 ^ 1)) $$\n                         (i, j) =\n                         H $$ (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n       \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                                  sqrt 2 ^ 1)) $$\n                         (i, j) =\n                         H $$ (i, j)", "fix i j:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n       \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                                  sqrt 2 ^ 1)) $$\n                         (i, j) =\n                         H $$ (i, j)", "assume a0:\"i < dim_row H\" and a1:\"j < dim_col H\""], ["proof (state)\nthis:\n  i < dim_row H\n  j < dim_col H\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n       \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                                  sqrt 2 ^ 1)) $$\n                         (i, j) =\n                         H $$ (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row H\n  j < dim_col H", "show \"(H^\\<^sub>\\<otimes> 1) $$ (i,j) = H $$ (i,j)\""], ["proof (prove)\nusing this:\n  i < dim_row H\n  j < dim_col H\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (i, j) =\n    H $$ (i, j)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "have \"(H^\\<^sub>\\<otimes> 1) $$ (0, 0) = 1/sqrt(2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (0, 0) =\n    complex_of_real (1 / sqrt 2)", "using bitwise_inner_prod_def bin_rep_def"], ["proof (prove)\nusing this:\n  ?i \\<cdot>\\<^bsub>?n\\<^esub>  ?j =\n  (\\<Sum>k = 0..<?n. bin_rep ?n ?i ! k * bin_rep ?n ?j ! k)\n  bin_rep ?n ?m = butlast (bin_rep_aux ?n ?m)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (0, 0) =\n    complex_of_real (1 / sqrt 2)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 0) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 0) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "have \"(H^\\<^sub>\\<otimes> 1) $$ (0,1) = 1/sqrt(2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (0, 1) =\n    complex_of_real (1 / sqrt 2)", "using bitwise_inner_prod_def bin_rep_def"], ["proof (prove)\nusing this:\n  ?i \\<cdot>\\<^bsub>?n\\<^esub>  ?j =\n  (\\<Sum>k = 0..<?n. bin_rep ?n ?i ! k * bin_rep ?n ?j ! k)\n  bin_rep ?n ?m = butlast (bin_rep_aux ?n ?m)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (0, 1) =\n    complex_of_real (1 / sqrt 2)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 1) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 1) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "have \"(H^\\<^sub>\\<otimes> 1) $$ (1,0) = 1/sqrt(2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (1, 0) =\n    complex_of_real (1 / sqrt 2)", "using bitwise_inner_prod_def bin_rep_def"], ["proof (prove)\nusing this:\n  ?i \\<cdot>\\<^bsub>?n\\<^esub>  ?j =\n  (\\<Sum>k = 0..<?n. bin_rep ?n ?i ! k * bin_rep ?n ?j ! k)\n  bin_rep ?n ?m = butlast (bin_rep_aux ?n ?m)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (1, 0) =\n    complex_of_real (1 / sqrt 2)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 0) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "moreover"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 0) =\n  complex_of_real (1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "have \"(H^\\<^sub>\\<otimes> 1) $$ (1,1) = -1/sqrt(2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (1, 1) =\n    complex_of_real (- 1 / sqrt 2)", "using bitwise_inner_prod_def bin_rep_def"], ["proof (prove)\nusing this:\n  ?i \\<cdot>\\<^bsub>?n\\<^esub>  ?j =\n  (\\<Sum>k = 0..<?n. bin_rep ?n ?i ! k * bin_rep ?n ?j ! k)\n  bin_rep ?n ?m = butlast (bin_rep_aux ?n ?m)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (1, 1) =\n    complex_of_real (- 1 / sqrt 2)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 1) =\n  complex_of_real (- 1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>i < dim_row H; j < dim_col H\\<rbrakk>\n    \\<Longrightarrow> Matrix.mat (2 ^ 1) (2 ^ 1)\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j /\n                               sqrt 2 ^ 1)) $$\n                      (i, j) =\n                      H $$ (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 0) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 1) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 0) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 1) =\n  complex_of_real (- 1 / sqrt 2)", "show \"(H^\\<^sub>\\<otimes> 1) $$ (i,j) = H $$ (i,j)\""], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 0) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 1) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 0) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 1) =\n  complex_of_real (- 1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (i, j) =\n    H $$ (i, j)", "using a0 a1 H_values H_values_right_bottom"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 0) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (0, 1) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 0) =\n  complex_of_real (1 / sqrt 2)\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (1, 1) =\n  complex_of_real (- 1 / sqrt 2)\n  i < dim_row H\n  j < dim_col H\n  \\<lbrakk>?i < dim_row H; ?j < dim_col H;\n   ?i \\<noteq> 1 \\<or> ?j \\<noteq> 1\\<rbrakk>\n  \\<Longrightarrow> H $$ (?i, ?j) = complex_of_real (1 / sqrt 2)\n  ?i = 1 \\<and> ?j = 1 \\<Longrightarrow>\n  H $$ (?i, ?j) = complex_of_real (- 1 / sqrt 2)\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n    (i, j) =\n    H $$ (i, j)", "by (metis (no_types, lifting) H_without_scalar_prod One_nat_def dim_col_mat(1) dim_row_mat(1) \ndivide_minus_left less_2_cases)"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (i, j) =\n  H $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) $$\n  (i, j) =\n  H $$ (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma iter_tensor_of_H_rep_is_correct:\n  fixes n:: nat\n  assumes \"n \\<ge> 1\"\n  shows \"(H \\<otimes>\\<^bsup>n\\<^esup>) = H^\\<^sub>\\<otimes> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>n\\<^esup> =\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>n\\<^esup> =\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))", "proof(rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. H \\<otimes>\\<^bsup>1\\<^esup> =\n    Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "show \"(H \\<otimes>\\<^bsup>1\\<^esup>) = H^\\<^sub>\\<otimes> 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>1\\<^esup> =\n    Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))", "using one_tensor_is_id one_tensor_of_H_is_H"], ["proof (prove)\nusing this:\n  ?A \\<otimes>\\<^bsup>1\\<^esup> = ?A\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1)) =\n  H\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>1\\<^esup> =\n    Matrix.mat (2 ^ 1) (2 ^ 1)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))", "by simp"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>1\\<^esup> =\n  Matrix.mat (2 ^ 1) (2 ^ 1)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>1\\<^esub>  j / sqrt 2 ^ 1))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "assume a0:\"n \\<ge> 1\" and IH:\"(H \\<otimes>\\<^bsup>n\\<^esup>) = H^\\<^sub>\\<otimes> n\""], ["proof (state)\nthis:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "then"], ["proof (chain)\npicking this:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))", "have \"(H \\<otimes>\\<^bsup>(Suc n)\\<^esup>) = H \\<Otimes> (H \\<otimes>\\<^bsup>n\\<^esup>)\""], ["proof (prove)\nusing this:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup>", "using iter_tensor_suc Nat.Suc_eq_plus1"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  H \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))\n  1 \\<le> ?n \\<Longrightarrow>\n  ?A \\<otimes>\\<^bsup>Suc ?n\\<^esup> =\n  ?A \\<Otimes> ?A \\<otimes>\\<^bsup>?n\\<^esup>\n  Suc ?n = ?n + 1\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup>", "by metis"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "also"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup>\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "have \"... = H \\<Otimes> (H^\\<^sub>\\<otimes> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup> =\n    H \\<Otimes>\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))", "using IH"], ["proof (prove)\nusing this:\n  H \\<otimes>\\<^bsup>n\\<^esup> =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup> =\n    H \\<Otimes>\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))", "by simp"], ["proof (state)\nthis:\n  H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup> =\n  H \\<Otimes>\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "also"], ["proof (state)\nthis:\n  H \\<Otimes> H \\<otimes>\\<^bsup>n\\<^esup> =\n  H \\<Otimes>\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "have \"... = H^\\<^sub>\\<otimes> (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. H \\<Otimes>\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))", "using a0 H_tensor_iter_tensor_of_H"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  H \\<Otimes>\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n)) =\n  Matrix.mat (2 ^ Suc ?n) (2 ^ Suc ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc ?n\\<^esub>  j / sqrt 2 ^ Suc ?n))\n\ngoal (1 subgoal):\n 1. H \\<Otimes>\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))", "by simp"], ["proof (state)\nthis:\n  H \\<Otimes>\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) =\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        H \\<otimes>\\<^bsup>n\\<^esup> =\n        Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                 sqrt 2 ^ n))\\<rbrakk>\n       \\<Longrightarrow> H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n                         Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  (- 1) ^\n                                  i \\<cdot>\\<^bsub>Suc n\\<^esub>  j /\n                                  sqrt 2 ^ Suc n))", "finally"], ["proof (chain)\npicking this:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))", "show \"(H \\<otimes>\\<^bsup>(Suc n)\\<^esup>) = H^\\<^sub>\\<otimes> (Suc n)\""], ["proof (prove)\nusing this:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))\n\ngoal (1 subgoal):\n 1. H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n    Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))", "by simp"], ["proof (state)\nthis:\n  H \\<otimes>\\<^bsup>Suc n\\<^esup> =\n  Matrix.mat (2 ^ Suc n) (2 ^ Suc n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>Suc n\\<^esub>  j / sqrt 2 ^ Suc n))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>@{text \"HId^\\<^sub>\\<otimes> 1\"} is the result of taking the tensor product of the nth tensor of H and Id 1 \\<close>"], ["", "abbreviation tensor_of_H_tensor_Id:: \"nat \\<Rightarrow> complex Matrix.mat\" (\"HId^\\<^sub>\\<otimes> _\") where\n\"tensor_of_H_tensor_Id n \\<equiv> Matrix.mat (2^(n+1)) (2^(n+1)) (\\<lambda>(i,j).\n  if (i mod 2 = j mod 2) then (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (j div 2))/(sqrt 2)^n else 0)\""], ["", "lemma mod_2_is_both_even_or_odd:\n  \"((even i \\<and> even j) \\<or> (odd i \\<and> odd j)) \\<longleftrightarrow> (i mod 2 = j mod 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (even i \\<and> even j \\<or> odd i \\<and> odd j) =\n    (i mod (2::'a) = j mod (2::'a))", "by (metis even_iff_mod_2_eq_zero odd_iff_mod_2_eq_one)"], ["", "lemma HId_values [simp]:\n  assumes \"n \\<ge> 1\" and \"i < dim_row (HId^\\<^sub>\\<otimes> n)\" and \"j < dim_col (HId^\\<^sub>\\<otimes> n)\"\n  shows \"even i \\<and> even j \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (j div 2))/(sqrt 2)^n\"\nand \"odd i \\<and> odd j \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (j div 2))/(sqrt 2)^n\"\nand \"(i mod 2 = j mod 2) \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (j div 2))/(sqrt 2)^n\"\nand \"\\<not>(i mod 2 = j mod 2) \\<longrightarrow> (HId^\\<^sub>\\<otimes> n) $$ (i,j) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (even i \\<and> even j \\<longrightarrow>\n     Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) $$\n     (i, j) =\n     complex_of_real\n      ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 / sqrt 2 ^ n) &&&\n     odd i \\<and> odd j \\<longrightarrow>\n     Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) $$\n     (i, j) =\n     complex_of_real\n      ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 / sqrt 2 ^ n)) &&&\n    i mod 2 = j mod 2 \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 / sqrt 2 ^ n) &&&\n    i mod 2 \\<noteq> j mod 2 \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j) =\n    0", "using assms mod_2_is_both_even_or_odd"], ["proof (prove)\nusing this:\n  1 \\<le> n\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n  (even ?i \\<and> even ?j \\<or> odd ?i \\<and> odd ?j) =\n  (?i mod (2::?'a) = ?j mod (2::?'a))\n\ngoal (1 subgoal):\n 1. (even i \\<and> even j \\<longrightarrow>\n     Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) $$\n     (i, j) =\n     complex_of_real\n      ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 / sqrt 2 ^ n) &&&\n     odd i \\<and> odd j \\<longrightarrow>\n     Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) $$\n     (i, j) =\n     complex_of_real\n      ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 / sqrt 2 ^ n)) &&&\n    i mod 2 = j mod 2 \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 / sqrt 2 ^ n) &&&\n    i mod 2 \\<noteq> j mod 2 \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j) =\n    0", "by auto"], ["", "lemma iter_tensor_of_H_tensor_Id_is_HId:\n  shows \"(H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1 = HId^\\<^sub>\\<otimes> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1 =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)\n 2. dim_row\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))\n 3. dim_col\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "show \"dim_row ((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) = dim_row (HId^\\<^sub>\\<otimes> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "by (simp add: Quantum.Id_def)"], ["proof (state)\nthis:\n  dim_row\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1) =\n  dim_row\n   (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)))\n\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)\n 2. dim_col\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "show \"dim_col ((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) = dim_col (HId^\\<^sub>\\<otimes> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "by (simp add: Quantum.Id_def)"], ["proof (state)\nthis:\n  dim_col\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1) =\n  dim_col\n   (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "fix i j:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "assume a0: \"i < dim_row (HId^\\<^sub>\\<otimes> n)\" and a1: \"j < dim_col (HId^\\<^sub>\\<otimes> n)\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))", "have f0: \"i < (2^(n+1)) \\<and> j < (2^(n+1))\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n\ngoal (1 subgoal):\n 1. i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)", "by simp"], ["proof (state)\nthis:\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "then"], ["proof (chain)\npicking this:\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)", "have \"i < dim_row (H^\\<^sub>\\<otimes> n) * dim_row (Id 1) \\<and> j < dim_col (H^\\<^sub>\\<otimes> n) * dim_col (Id 1)\""], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n\ngoal (1 subgoal):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) (2 ^ n)\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n        dim_row (Quantum.Id 1) \\<and>\n    j < dim_col\n         (Matrix.mat (2 ^ n) (2 ^ n)\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n        dim_col (Quantum.Id 1)", "using Id_def"], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n  Quantum.Id ?n \\<equiv> 1\\<^sub>m (2 ^ ?n)\n\ngoal (1 subgoal):\n 1. i < dim_row\n         (Matrix.mat (2 ^ n) (2 ^ n)\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n        dim_row (Quantum.Id 1) \\<and>\n    j < dim_col\n         (Matrix.mat (2 ^ n) (2 ^ n)\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n        dim_col (Quantum.Id 1)", "by simp"], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_row (Quantum.Id 1) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_col (Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "moreover"], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_row (Quantum.Id 1) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_col (Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "have \"dim_col (H^\\<^sub>\\<otimes> n) \\<ge> 0 \\<and> dim_col (Id 1) \\<ge> 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 \\<le> dim_col\n             (Matrix.mat (2 ^ n) (2 ^ n)\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                       sqrt 2 ^ n))) \\<and>\n    0 \\<le> dim_col (Quantum.Id 1)", "using Id_def"], ["proof (prove)\nusing this:\n  Quantum.Id ?n \\<equiv> 1\\<^sub>m (2 ^ ?n)\n\ngoal (1 subgoal):\n 1. 0 \\<le> dim_col\n             (Matrix.mat (2 ^ n) (2 ^ n)\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                       sqrt 2 ^ n))) \\<and>\n    0 \\<le> dim_col (Quantum.Id 1)", "by simp"], ["proof (state)\nthis:\n  0 \\<le> dim_col\n           (Matrix.mat (2 ^ n) (2 ^ n)\n             (\\<lambda>x.\n                 complex_of_real\n                  (case x of\n                   (i, j) \\<Rightarrow>\n                     (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                     sqrt 2 ^ n))) \\<and>\n  0 \\<le> dim_col (Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_row (Quantum.Id 1) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_col (Quantum.Id 1)\n  0 \\<le> dim_col\n           (Matrix.mat (2 ^ n) (2 ^ n)\n             (\\<lambda>x.\n                 complex_of_real\n                  (case x of\n                   (i, j) \\<Rightarrow>\n                     (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                     sqrt 2 ^ n))) \\<and>\n  0 \\<le> dim_col (Quantum.Id 1)", "have f1: \"((H^\\<^sub>\\<otimes> n) \\<Otimes> (Id 1)) $$ (i,j) \n    = (H^\\<^sub>\\<otimes> n) $$ (i div (dim_row (Id 1)),j div (dim_col (Id 1))) * \n      (Id 1) $$ (i mod (dim_row (Id 1)),j mod (dim_col (Id 1)))\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_row (Quantum.Id 1) \\<and>\n  j < dim_col\n       (Matrix.mat (2 ^ n) (2 ^ n)\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n))) *\n      dim_col (Quantum.Id 1)\n  0 \\<le> dim_col\n           (Matrix.mat (2 ^ n) (2 ^ n)\n             (\\<lambda>x.\n                 complex_of_real\n                  (case x of\n                   (i, j) \\<Rightarrow>\n                     (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                     sqrt 2 ^ n))) \\<and>\n  0 \\<le> dim_col (Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) *\n    Quantum.Id 1 $$\n    (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1))", "by (simp add: Quantum.Id_def)"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) $$\n  (i, j) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) *\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1))\n\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if i mod 2 = j mod 2\n                               then (- 1) ^\n                                    i div\n                                    2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                                    sqrt 2 ^ n\n                               else 0)));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if i mod 2 = j mod 2\n                       then (- 1) ^\n                            i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                            sqrt 2 ^ n\n                       else 0)))\\<rbrakk>\n       \\<Longrightarrow> (Matrix.mat (2 ^ n) (2 ^ n)\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                   sqrt 2 ^ n)) \\<Otimes>\n                          Quantum.Id 1) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if i mod 2 = j mod 2\n                                  then (- 1) ^\n i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n sqrt 2 ^ n\n                                  else 0)) $$\n                         (i, j)", "show \"((H^\\<^sub>\\<otimes> n)\\<Otimes>Id 1) $$ (i,j) = (HId^\\<^sub>\\<otimes> n) $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "proof (rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)\n 3. ?Q \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "show \"(i mod 2 = j mod 2) \\<or> \\<not> (i mod 2 = j mod 2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i mod 2 = j mod 2 \\<or> i mod 2 \\<noteq> j mod 2", "by simp"], ["proof (state)\nthis:\n  i mod 2 = j mod 2 \\<or> i mod 2 \\<noteq> j mod 2\n\ngoal (2 subgoals):\n 1. i mod 2 = j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)\n 2. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. i mod 2 = j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)\n 2. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "assume a2:\"(i mod 2 = j mod 2)\""], ["proof (state)\nthis:\n  i mod 2 = j mod 2\n\ngoal (2 subgoals):\n 1. i mod 2 = j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)\n 2. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  i mod 2 = j mod 2", "have \"(Id 1) $$ (i mod (dim_row (Id 1)),j mod (dim_col (Id 1))) = 1\""], ["proof (prove)\nusing this:\n  i mod 2 = j mod 2\n\ngoal (1 subgoal):\n 1. Quantum.Id 1 $$\n    (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n    1", "by (simp add: Quantum.Id_def)"], ["proof (state)\nthis:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  1\n\ngoal (2 subgoals):\n 1. i mod 2 = j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)\n 2. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  1\n\ngoal (2 subgoals):\n 1. i mod 2 = j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)\n 2. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "have \"(H^\\<^sub>\\<otimes> n) $$ (i div (dim_row (Id 1)), j div (dim_col (Id 1))) \n                    = (-1)^((i div (dim_row (Id 1))) \\<cdot>\\<^bsub>n\\<^esub> (j div (dim_col (Id 1))))/(sqrt 2)^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) =\n    complex_of_real\n     ((- 1) ^\n      i div\n      dim_row\n       (Quantum.Id\n         1) \\<cdot>\\<^bsub>n\\<^esub>  j div dim_col (Quantum.Id 1) /\n      sqrt 2 ^ n)", "using tensor_of_H_values Id_def f0 less_mult_imp_div_less"], ["proof (prove)\nusing this:\n  \\<lbrakk>?i < dim_row\n                 (Matrix.mat (2 ^ ?n) (2 ^ ?n)\n                   (\\<lambda>x.\n                       complex_of_real\n                        (case x of\n                         (i, j) \\<Rightarrow>\n                           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j /\n                           sqrt 2 ^ ?n)));\n   ?j < dim_col\n         (Matrix.mat (2 ^ ?n) (2 ^ ?n)\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j /\n                   sqrt 2 ^ ?n)))\\<rbrakk>\n  \\<Longrightarrow> Matrix.mat (2 ^ ?n) (2 ^ ?n)\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j /\n                             sqrt 2 ^ ?n)) $$\n                    (?i, ?j) =\n                    complex_of_real\n                     ((- 1) ^ ?i \\<cdot>\\<^bsub>?n\\<^esub>  ?j /\n                      sqrt 2 ^ ?n)\n  Quantum.Id ?n \\<equiv> 1\\<^sub>m (2 ^ ?n)\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n  ?m < ?i * ?n \\<Longrightarrow> ?m div ?n < ?i\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n    (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) =\n    complex_of_real\n     ((- 1) ^\n      i div\n      dim_row\n       (Quantum.Id\n         1) \\<cdot>\\<^bsub>n\\<^esub>  j div dim_col (Quantum.Id 1) /\n      sqrt 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) =\n  complex_of_real\n   ((- 1) ^\n    i div\n    dim_row\n     (Quantum.Id 1) \\<cdot>\\<^bsub>n\\<^esub>  j div dim_col (Quantum.Id 1) /\n    sqrt 2 ^ n)\n\ngoal (2 subgoals):\n 1. i mod 2 = j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)\n 2. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  1\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) =\n  complex_of_real\n   ((- 1) ^\n    i div\n    dim_row\n     (Quantum.Id 1) \\<cdot>\\<^bsub>n\\<^esub>  j div dim_col (Quantum.Id 1) /\n    sqrt 2 ^ n)", "show \"((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) $$ (i,j) = (HId^\\<^sub>\\<otimes> n) $$ (i,j)\""], ["proof (prove)\nusing this:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  1\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) =\n  complex_of_real\n   ((- 1) ^\n    i div\n    dim_row\n     (Quantum.Id 1) \\<cdot>\\<^bsub>n\\<^esub>  j div dim_col (Quantum.Id 1) /\n    sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "using a2 f0 f1 Id_def"], ["proof (prove)\nusing this:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  1\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) =\n  complex_of_real\n   ((- 1) ^\n    i div\n    dim_row\n     (Quantum.Id 1) \\<cdot>\\<^bsub>n\\<^esub>  j div dim_col (Quantum.Id 1) /\n    sqrt 2 ^ n)\n  i mod 2 = j mod 2\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) $$\n  (i, j) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) *\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1))\n  Quantum.Id ?n \\<equiv> 1\\<^sub>m (2 ^ ?n)\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "assume a2: \"\\<not>(i mod 2 = j mod 2)\""], ["proof (state)\nthis:\n  i mod 2 \\<noteq> j mod 2\n\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  i mod 2 \\<noteq> j mod 2", "have \"(Id 1) $$ (i mod (dim_row (Id 1)),j mod (dim_col (Id 1))) = 0\""], ["proof (prove)\nusing this:\n  i mod 2 \\<noteq> j mod 2\n\ngoal (1 subgoal):\n 1. Quantum.Id 1 $$\n    (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n    0", "by (simp add: Quantum.Id_def)"], ["proof (state)\nthis:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  0\n\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> j mod 2 \\<Longrightarrow>\n    (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  0", "show \"((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) $$ (i,j) = (HId^\\<^sub>\\<otimes> n) $$ (i,j)\""], ["proof (prove)\nusing this:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  0\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "using a2 f0 f1"], ["proof (prove)\nusing this:\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1)) =\n  0\n  i mod 2 \\<noteq> j mod 2\n  i < 2 ^ (n + 1) \\<and> j < 2 ^ (n + 1)\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) $$\n  (i, j) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) $$\n  (i div dim_row (Quantum.Id 1), j div dim_col (Quantum.Id 1)) *\n  Quantum.Id 1 $$\n  (i mod dim_row (Quantum.Id 1), j mod dim_col (Quantum.Id 1))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma HId_is_gate:\n  assumes \"n \\<ge> 1\"\n  shows \"gate (n+1) (HId^\\<^sub>\\<otimes> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "have \"(HId^\\<^sub>\\<otimes> n) = (H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) =\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1", "using iter_tensor_of_H_tensor_Id_is_HId"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n)) \\<Otimes>\n  Quantum.Id 1 =\n  Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                sqrt 2 ^ ?n\n           else 0))\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) =\n    Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n  Quantum.Id 1\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "moreover"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n  Quantum.Id 1\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "have \"gate 1 (Id 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate 1 (Quantum.Id 1)", "using id_is_gate"], ["proof (prove)\nusing this:\n  gate ?n (Quantum.Id ?n)\n\ngoal (1 subgoal):\n 1. gate 1 (Quantum.Id 1)", "by simp"], ["proof (state)\nthis:\n  gate 1 (Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "moreover"], ["proof (state)\nthis:\n  gate 1 (Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "have \"gate n (H^\\<^sub>\\<otimes> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate n\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))", "using H_is_gate iter_tensor_of_gate_is_gate[of 1 H n] assms"], ["proof (prove)\nusing this:\n  gate 1 H\n  \\<lbrakk>gate 1 H; 1 \\<le> n\\<rbrakk>\n  \\<Longrightarrow> gate (1 * n) (H \\<otimes>\\<^bsup>n\\<^esup>)\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. gate n\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))", "by(simp add: iter_tensor_of_H_rep_is_correct)"], ["proof (state)\nthis:\n  gate n\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "ultimately"], ["proof (chain)\npicking this:\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n  Quantum.Id 1\n  gate 1 (Quantum.Id 1)\n  gate n\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))", "show \"gate (n+1) (HId^\\<^sub>\\<otimes> n)\""], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n  Quantum.Id 1\n  gate 1 (Quantum.Id 1)\n  gate n\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "using tensor_gate"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) =\n  Matrix.mat (2 ^ n) (2 ^ n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n  Quantum.Id 1\n  gate 1 (Quantum.Id 1)\n  gate n\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)))\n  \\<lbrakk>gate ?m ?G1.0; gate ?n ?G2.0\\<rbrakk>\n  \\<Longrightarrow> gate (?m + ?n) (?G1.0 \\<Otimes> ?G2.0)\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)))", "by presburger"], ["proof (state)\nthis:\n  gate (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>State @{term \"\\<psi>\\<^sub>3\"} is obtained by the multiplication of @{term \"HId^\\<^sub>\\<otimes> n\"} and @{term \"\\<psi>\\<^sub>2\"}\\<close>"], ["", "abbreviation (in jozsa) \\<psi>\\<^sub>3:: \"complex Matrix.mat\" where\n\"\\<psi>\\<^sub>3 \\<equiv> Matrix.mat (2^(n+1)) 1 (\\<lambda>(i,j). \nif even i \n  then (\\<Sum>k<2^n. (-1)^(f(k) + ((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/((sqrt 2)^n * (sqrt 2)^(n+1))) \n    else  (\\<Sum>k<2^n. (-1)^(f(k)+ 1 + ((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k)) /((sqrt 2)^n * (sqrt 2)^(n+1))))\""], ["", "lemma (in jozsa) \\<psi>\\<^sub>3_values:\n  assumes \"i < dim_row \\<psi>\\<^sub>3\"\n  shows \"odd i \\<longrightarrow> \\<psi>\\<^sub>3 $$ (i,0) = (\\<Sum>k<2^n. (-1)^(f(k) + 1 + ((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/((sqrt 2)^n * (sqrt 2)^(n+1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. odd i \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, 0) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "using assms"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. odd i \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, 0) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "by simp"], ["", "lemma (in jozsa) \\<psi>\\<^sub>3_dim [simp]:\n  shows \"1 < dim_row \\<psi>\\<^sub>3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i\n                   then \\<Sum>k<2 ^ n.\n                           (- 1) ^\n                           (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                           (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                   else \\<Sum>k<2 ^ n.\n                           (- 1) ^\n                           (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                           (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "using dim_row_mat(1) nat_neq_iff"], ["proof (prove)\nusing this:\n  dim_row (Matrix.mat ?nr ?nc ?f) = ?nr\n  (?m \\<noteq> ?n) = (?m < ?n \\<or> ?n < ?m)\n\ngoal (1 subgoal):\n 1. 1 < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i\n                   then \\<Sum>k<2 ^ n.\n                           (- 1) ^\n                           (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                           (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                   else \\<Sum>k<2 ^ n.\n                           (- 1) ^\n                           (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                           (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "by fastforce"], ["", "lemma sum_every_odd_summand_is_zero:\n  fixes n:: nat \n  assumes \"n \\<ge> 1\"\n  shows \"\\<forall>f::(nat \\<Rightarrow> complex).(\\<forall>i. i<2^(n+1) \\<and> odd i \\<longrightarrow> f i = 0) \\<longrightarrow> \n            (\\<Sum>k\\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k\\<in>{0..<2^n}. f (2*k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))", "proof(rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                odd i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "show \"\\<forall>f::(nat \\<Rightarrow> complex).(\\<forall>i. i<2^(1+1) \\<and> odd i \\<longrightarrow> f i = 0) \\<longrightarrow>\n            (\\<Sum>k\\<in>{0..<2^(1+1)}. f k) = (\\<Sum>k \\<in> {0..<2^1}. f (2*k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "proof(rule allI,rule impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "fix f:: \"(nat \\<Rightarrow> complex)\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "assume asm: \"(\\<forall>i. i<2^(1+1) \\<and> odd i \\<longrightarrow> f i = 0)\""], ["proof (state)\nthis:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "moreover"], ["proof (state)\nthis:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "have \"(\\<Sum>k\\<in>{0..<4}. f k) = f 0 + f 1 + f 2 + f 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<4} = f 0 + f 1 + f 2 + f 3", "by (simp add: add.commute add.left_commute)"], ["proof (state)\nthis:\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "moreover"], ["proof (state)\nthis:\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "have \"f 1 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f 1 = 0", "using asm"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. f 1 = 0", "by simp"], ["proof (state)\nthis:\n  f 1 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "moreover"], ["proof (state)\nthis:\n  f 1 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "have \"f 3 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f 3 = 0", "using asm"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. f 3 = 0", "by simp"], ["proof (state)\nthis:\n  f 3 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "moreover"], ["proof (state)\nthis:\n  f 3 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "have \"(\\<Sum>k\\<in>{0..<2^1}. f (2*k)) = f 0 + f 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ 1. f (2 * k)) = f 0 + f 2", "using add.commute add.left_commute"], ["proof (prove)\nusing this:\n  ?a + ?b = ?b + ?a\n  ?b + (?a + ?c) = ?a + (?b + ?c)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ 1. f (2 * k)) = f 0 + f 2", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ 1. f (2 * k)) = f 0 + f 2\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow> f i = 0\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n  f 1 = 0\n  f 3 = 0\n  (\\<Sum>k = 0..<2 ^ 1. f (2 * k)) = f 0 + f 2", "show \"(\\<Sum>k\\<in>{0..<2^(1+1)}. f k) = (\\<Sum>k\\<in>{0..<2^1}. f (2*k))\""], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow> f i = 0\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n  f 1 = 0\n  f 3 = 0\n  (\\<Sum>k = 0..<2 ^ 1. f (2 * k)) = f 0 + f 2\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))", "by simp"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (1 + 1) \\<and> odd i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                odd i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                odd i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                odd i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "assume \"n \\<ge> 1\"\n  and IH: \"\\<forall>f::(nat \\<Rightarrow>complex).(\\<forall>i. i<2^(n+1) \\<and> odd i \\<longrightarrow> f i = 0) \\<longrightarrow>\n(\\<Sum>k\\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k\\<in>{0..<2^n}. f (2*k))\""], ["proof (state)\nthis:\n  1 \\<le> n\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                odd i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "show \"\\<forall>f::(nat \\<Rightarrow>complex).(\\<forall>i. i<2^(Suc n +1) \\<and> odd i \\<longrightarrow> f i = 0) \\<longrightarrow>\n(\\<Sum>k\\<in>{0..<2^(Suc n +1)}. f k) = (\\<Sum>k\\<in>{0..< 2^(Suc n)}. f (2*k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "proof (rule allI,rule impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "fix f::\"nat \\<Rightarrow> complex\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "assume asm: \"(\\<forall>i. i<2^(Suc n +1) \\<and> odd i \\<longrightarrow> f i = 0)\""], ["proof (state)\nthis:\n  \\<forall>i. i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have f0: \"(\\<Sum>k\\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k\\<in>{0..<2^n}. f (2*k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))", "using asm IH"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow> f i = 0\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))", "by simp"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have f1: \"(\\<Sum>k\\<in>{0..<2^(n+1)}. (\\<lambda>x. f (x+2^(n+1))) k) = (\\<Sum>k\\<in>{0..< 2^n}. (\\<lambda>x. f (x+2^(n+1))) (2*k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))", "using asm IH"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow> f i = 0\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (n + 1) \\<and> odd i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have \"(\\<Sum>k\\<in>{0..<2^(n+2)}. f k) = (\\<Sum>k\\<in>{0..<2^(n+1)}. f k) + (\\<Sum>k\\<in>{2^(n+1)..<2^(n+2)}. f k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 2)} =\n    sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}", "by (simp add: sum.atLeastLessThan_concat)"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 2)} =\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "also"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 2)} =\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have \"... = (\\<Sum>k\\<in>{0..<2^n}. f (2*k)) + (\\<Sum>k\\<in>{2^(n+1)..<2^(n+2)}. f k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}", "using f0"], ["proof (prove)\nusing this:\n  sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k))\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}", "by simp"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "also"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have \"... = (\\<Sum>k\\<in>{0..<2^n}. f (2*k)) + (\\<Sum>k\\<in>{0..<2^(n+1)}. f (k+2^(n+1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))", "using sum.shift_bounds_nat_ivl[of \"f\" \"0\" \"2^(n+1)\" \"2^(n+1)\"]"], ["proof (prove)\nusing this:\n  sum f {0 + 2 ^ (n + 1)..<2 ^ (n + 1) + 2 ^ (n + 1)} =\n  (\\<Sum>i = 0..<2 ^ (n + 1). f (i + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "also"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have \"... = (\\<Sum>k\\<in>{0..<2^n}. f (2*k)) + (\\<Sum>k\\<in>{0..< 2^n}. (\\<lambda>x. f (x+2^(n+1))) (2*k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))", "using f1"], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "also"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have \"... = (\\<Sum>k\\<in>{0..<2^n}. f (2*k)) + (\\<Sum>k\\<in>{2^n..< 2^(n+1)}. f (2 *k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k))", "using sum.shift_bounds_nat_ivl[of \"\\<lambda>x. (f::nat\\<Rightarrow>complex) (2*(x-2^n)+2^(n+1))\" \"0\" \"2^n\" \"2^n\"]"], ["proof (prove)\nusing this:\n  (\\<Sum>x = 0 + 2 ^ n..<2 ^ n + 2 ^ n. f (2 * (x - 2 ^ n) + 2 ^ (n + 1))) =\n  (\\<Sum>i = 0..<2 ^ n. f (2 * (i + 2 ^ n - 2 ^ n) + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k))", "by (simp add: mult_2)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "also"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "have \"... = (\\<Sum>k \\<in> {0..<2^(n+1)}. f (2*k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n    (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k)) =\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k))", "by (metis Suc_eq_plus1 lessI less_imp_le_nat one_le_numeral power_increasing sum.atLeastLessThan_concat zero_le)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k)) +\n  (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k)) =\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "finally"], ["proof (chain)\npicking this:\n  sum f {0..<2 ^ (n + 2)} = (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k))", "show \"(\\<Sum>k\\<in>{0..<2^((Suc n)+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^(Suc n)}. f (2*k))\""], ["proof (prove)\nusing this:\n  sum f {0..<2 ^ (n + 2)} = (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k))\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))", "by (metis Suc_eq_plus1 add_2_eq_Suc')"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (Suc n + 1) \\<and> odd i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma sum_every_even_summand_is_zero:\n  fixes n:: nat \n  assumes \"n \\<ge> 1\"\n  shows \"\\<forall>f::(nat \\<Rightarrow> complex).(\\<forall>i. i<2^(n+1) \\<and> even i \\<longrightarrow> f i = 0) \\<longrightarrow> \n            (\\<Sum>k\\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^n}. f (2*k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))", "using assms"], ["proof (prove)\nusing this:\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))", "proof(rule nat_induct_at_least)"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))\n 2. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                even i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "show \"\\<forall>f::(nat \\<Rightarrow> complex).(\\<forall>i. i<2^(1+1) \\<and> even i \\<longrightarrow> f i = 0) \\<longrightarrow> \n            (\\<Sum>k\\<in>{0..<2^(1+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^1}. f (2*k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "proof(rule allI,rule impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "fix f:: \"nat \\<Rightarrow>complex\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "assume asm: \"(\\<forall>i. i<2^(1+1) \\<and> even i \\<longrightarrow> f i = 0)\""], ["proof (state)\nthis:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "moreover"], ["proof (state)\nthis:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "have \"(\\<Sum>k\\<in>{0..<4}. f k) = f 0 + f 1 + f 2 + f 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<4} = f 0 + f 1 + f 2 + f 3", "by (simp add: add.commute add.left_commute)"], ["proof (state)\nthis:\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "moreover"], ["proof (state)\nthis:\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "have \"f 0 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f 0 = 0", "using asm"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. f 0 = 0", "by simp"], ["proof (state)\nthis:\n  f 0 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "moreover"], ["proof (state)\nthis:\n  f 0 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "have \"f 2 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f 2 = 0", "using asm"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. f 2 = 0", "by simp"], ["proof (state)\nthis:\n  f 2 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "moreover"], ["proof (state)\nthis:\n  f 2 = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "have \"(\\<Sum>k \\<in> {0..< 2^1}. f (2*k+1)) = f 1 + f 3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1)) = f 1 + f 3", "using add.commute add.left_commute"], ["proof (prove)\nusing this:\n  ?a + ?b = ?b + ?a\n  ?b + (?a + ?c) = ?a + (?b + ?c)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1)) = f 1 + f 3", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1)) = f 1 + f 3\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "ultimately"], ["proof (chain)\npicking this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow> f i = 0\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n  f 0 = 0\n  f 2 = 0\n  (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1)) = f 1 + f 3", "show \"(\\<Sum>k\\<in>{0..<2^(1+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^1}. f (2*k+1))\""], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow> f i = 0\n  sum f {0..<4} = f 0 + f 1 + f 2 + f 3\n  f 0 = 0\n  f 2 = 0\n  (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1)) = f 1 + f 3\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))", "by simp"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (1 + 1) \\<and> even i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (1 + 1)} = (\\<Sum>k = 0..<2 ^ 1. f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                even i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                even i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "fix n:: nat"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                even i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "assume \"n \\<ge> 1\"\n  and IH: \"\\<forall>f::(nat \\<Rightarrow>complex).(\\<forall>i. i<2^(n+1) \\<and> even i \\<longrightarrow> f i = 0) \\<longrightarrow>\n(\\<Sum>k\\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^n}. f (2*k+1))\""], ["proof (state)\nthis:\n  1 \\<le> n\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>1 \\<le> n;\n        \\<forall>f.\n           (\\<forall>i.\n               i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n               f i = 0) \\<longrightarrow>\n           sum f {0..<2 ^ (n + 1)} =\n           (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>i.\n                                i < 2 ^ (Suc n + 1) \\<and>\n                                even i \\<longrightarrow>\n                                f i = 0) \\<longrightarrow>\n                            sum f {0..<2 ^ (Suc n + 1)} =\n                            (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "show \"\\<forall>f::(nat \\<Rightarrow>complex).(\\<forall>i. i<2^((Suc n)+1) \\<and> even i \\<longrightarrow> f i = 0) \\<longrightarrow>\n(\\<Sum>k\\<in>{0..<2^((Suc n)+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^(Suc n)}. f (2*k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>i.\n           i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n           f i = 0) \\<longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "proof (rule allI,rule impI)"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "fix f::\"nat \\<Rightarrow>complex\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "assume asm: \"(\\<forall>i. i<2^((Suc n)+1) \\<and> even i \\<longrightarrow> f i = 0)\""], ["proof (state)\nthis:\n  \\<forall>i. i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow> f i = 0\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have f0: \"(\\<Sum>k \\<in>{0..<2^(n+1)}. f k) = (\\<Sum>k \\<in> {0..< 2^n}. f (2*k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))", "using asm IH"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow> f i = 0\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))", "by simp"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have f1: \"(\\<Sum>k\\<in>{0..<2^(n+1)}. (\\<lambda>x. f (x+2^(n+1))) k) \n              = (\\<Sum>k\\<in>{0..< 2^n}. (\\<lambda>x. f (x+2^(n+1))) (2*k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))", "using asm IH"], ["proof (prove)\nusing this:\n  \\<forall>i. i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow> f i = 0\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (n + 1) \\<and> even i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have \"(\\<Sum>k\\<in>{0..<2^(n+2)}. f k) \n               = (\\<Sum>k\\<in>{0..<2^(n+1)}. f k) + (\\<Sum>k\\<in>{2^(n+1)..<2^(n+2)}. f k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 2)} =\n    sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}", "by (simp add: sum.atLeastLessThan_concat)"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 2)} =\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "also"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 2)} =\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have \"... = (\\<Sum>k\\<in>{0..< 2^n}. f (2*k+1)) + (\\<Sum>k\\<in>{2^(n+1)..<2^(n+2)}. f k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}", "using f0"], ["proof (prove)\nusing this:\n  sum f {0..<2 ^ (n + 1)} = (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}", "by simp"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "also"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (n + 1)} + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)}\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have \"... = (\\<Sum>k\\<in>{0..< 2^n}. f (2*k+1)) + (\\<Sum>k\\<in>{0..<2^(n+1)}. f (k+(2^(n+1))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))", "using sum.shift_bounds_nat_ivl[of \"f\" \"0\" \"2^(n+1)\" \"2^(n+1)\"]"], ["proof (prove)\nusing this:\n  sum f {0 + 2 ^ (n + 1)..<2 ^ (n + 1) + 2 ^ (n + 1)} =\n  (\\<Sum>i = 0..<2 ^ (n + 1). f (i + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) + sum f {2 ^ (n + 1)..<2 ^ (n + 2)} =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have \"... = (\\<Sum>k\\<in>{0..< 2^n}. f (2*k+1)) + (\\<Sum>k\\<in>{0..< 2^n}. (\\<lambda>x. f (x+2^(n+1))) (2*k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))", "using f1"], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (k + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have \"... = (\\<Sum>k\\<in>{0..< 2^n}. f (2*k+1)) + (\\<Sum>k\\<in>{2^n..< 2^(n+1)}. f (2 *k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k + 1))", "using sum.shift_bounds_nat_ivl[of \"\\<lambda>x. (f::nat\\<Rightarrow>complex) (2*(x-2^n)+1+2^(n+1))\" \"0\" \"2^n\" \"2^n\"]"], ["proof (prove)\nusing this:\n  (\\<Sum>x = 0 + 2 ^ n..<2 ^ n + 2 ^ n.\n      f (2 * (x - 2 ^ n) + 1 + 2 ^ (n + 1))) =\n  (\\<Sum>i = 0..<2 ^ n. f (2 * (i + 2 ^ n - 2 ^ n) + 1 + 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1))) =\n    (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k + 1))", "by (simp add: mult_2)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "also"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1 + 2 ^ (n + 1))) =\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "have \"... = (\\<Sum>k\\<in>{0..< 2^(n+1)}. f (2*k+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n    (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k + 1)) =\n    (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k + 1))", "by (metis Suc_eq_plus1 lessI less_imp_le_nat one_le_numeral power_increasing sum.atLeastLessThan_concat zero_le)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. f (2 * k + 1)) +\n  (\\<Sum>k = 2 ^ n..<2 ^ (n + 1). f (2 * k + 1)) =\n  (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>f.\n       \\<forall>i.\n          i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n          f i = 0 \\<Longrightarrow>\n       sum f {0..<2 ^ (Suc n + 1)} =\n       (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "finally"], ["proof (chain)\npicking this:\n  sum f {0..<2 ^ (n + 2)} = (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k + 1))", "show \"(\\<Sum>k\\<in>{0..<2^((Suc n)+1)}. f k) = (\\<Sum>k\\<in>{0..< 2^(Suc n)}. f (2*k+1))\""], ["proof (prove)\nusing this:\n  sum f {0..<2 ^ (n + 2)} = (\\<Sum>k = 0..<2 ^ (n + 1). f (2 * k + 1))\n\ngoal (1 subgoal):\n 1. sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))", "by (metis Suc_eq_plus1 add_2_eq_Suc')"], ["proof (state)\nthis:\n  sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (Suc n + 1) \\<and> even i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (Suc n + 1)} = (\\<Sum>k = 0..<2 ^ Suc n. f (2 * k + 1))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) iter_tensor_of_H_times_\\<psi>\\<^sub>2_is_\\<psi>\\<^sub>3:\n  shows \"((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) * \\<psi>\\<^sub>2 = \\<psi>\\<^sub>3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))", "proof"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                               else \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i\n                       then \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                       else \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + 1 +\n                                i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<rbrakk>\n       \\<Longrightarrow> ((Matrix.mat (2 ^ n) (2 ^ n)\n                            (\\<lambda>x.\n                                complex_of_real\n                                 (case x of\n                                  (i, j) \\<Rightarrow>\n                                    (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                    sqrt 2 ^ n)) \\<Otimes>\n                           Quantum.Id 1) *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i\n                                   then (- 1) ^ f (i div 2) /\n  sqrt 2 ^ (n + 1)\n                                   else (- 1) ^ (f (i div 2) + 1) /\n  sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                                  else \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n                         (i, j)\n 2. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n 3. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "fix i j"], ["proof (state)\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                               else \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i\n                       then \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                       else \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + 1 +\n                                i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<rbrakk>\n       \\<Longrightarrow> ((Matrix.mat (2 ^ n) (2 ^ n)\n                            (\\<lambda>x.\n                                complex_of_real\n                                 (case x of\n                                  (i, j) \\<Rightarrow>\n                                    (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                    sqrt 2 ^ n)) \\<Otimes>\n                           Quantum.Id 1) *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i\n                                   then (- 1) ^ f (i div 2) /\n  sqrt 2 ^ (n + 1)\n                                   else (- 1) ^ (f (i div 2) + 1) /\n  sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                                  else \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n                         (i, j)\n 2. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n 3. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "assume a0:\"i < dim_row \\<psi>\\<^sub>3\" and a1:\"j < dim_col \\<psi>\\<^sub>3\""], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                               else \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i\n                       then \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                       else \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + 1 +\n                                i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<rbrakk>\n       \\<Longrightarrow> ((Matrix.mat (2 ^ n) (2 ^ n)\n                            (\\<lambda>x.\n                                complex_of_real\n                                 (case x of\n                                  (i, j) \\<Rightarrow>\n                                    (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                    sqrt 2 ^ n)) \\<Otimes>\n                           Quantum.Id 1) *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i\n                                   then (- 1) ^ f (i div 2) /\n  sqrt 2 ^ (n + 1)\n                                   else (- 1) ^ (f (i div 2) + 1) /\n  sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                                  else \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n                         (i, j)\n 2. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n 3. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "have f0: \"i < (2^(n+1)) \\<and> j = 0\""], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. i < 2 ^ (n + 1) \\<and> j = 0", "by simp"], ["proof (state)\nthis:\n  i < 2 ^ (n + 1) \\<and> j = 0\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                               else \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i\n                       then \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                       else \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + 1 +\n                                i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<rbrakk>\n       \\<Longrightarrow> ((Matrix.mat (2 ^ n) (2 ^ n)\n                            (\\<lambda>x.\n                                complex_of_real\n                                 (case x of\n                                  (i, j) \\<Rightarrow>\n                                    (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                    sqrt 2 ^ n)) \\<Otimes>\n                           Quantum.Id 1) *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i\n                                   then (- 1) ^ f (i div 2) /\n  sqrt 2 ^ (n + 1)\n                                   else (- 1) ^ (f (i div 2) + 1) /\n  sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                                  else \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n                         (i, j)\n 2. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n 3. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "have f1: \"((HId^\\<^sub>\\<otimes> n)* \\<psi>\\<^sub>2) $$ (i,j) = (\\<Sum>k<(2^(n+1)). ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) * (\\<psi>\\<^sub>2 $$ (k,j)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    (\\<Sum>k<2 ^ (n + 1).\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (k, j))", "using a1 f0"], ["proof (prove)\nusing this:\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  i < 2 ^ (n + 1) \\<and> j = 0\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    (\\<Sum>k<2 ^ (n + 1).\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (k, j))", "by (simp add: atLeast0LessThan)"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j))\n\ngoal (3 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>i < dim_row\n                     (Matrix.mat (2 ^ (n + 1)) 1\n                       (\\<lambda>x.\n                           complex_of_real\n                            (case x of\n                             (i, j) \\<Rightarrow>\n                               if even i\n                               then \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                               else \\<Sum>k<2 ^ n.\n (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))));\n        j < dim_col\n             (Matrix.mat (2 ^ (n + 1)) 1\n               (\\<lambda>x.\n                   complex_of_real\n                    (case x of\n                     (i, j) \\<Rightarrow>\n                       if even i\n                       then \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                       else \\<Sum>k<2 ^ n.\n                               (- 1) ^\n                               (f k + 1 +\n                                i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                               (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<rbrakk>\n       \\<Longrightarrow> ((Matrix.mat (2 ^ n) (2 ^ n)\n                            (\\<lambda>x.\n                                complex_of_real\n                                 (case x of\n                                  (i, j) \\<Rightarrow>\n                                    (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                                    sqrt 2 ^ n)) \\<Otimes>\n                           Quantum.Id 1) *\n                          Matrix.mat (2 ^ (n + 1)) 1\n                           (\\<lambda>x.\n                               complex_of_real\n                                (case x of\n                                 (i, j) \\<Rightarrow>\n                                   if even i\n                                   then (- 1) ^ f (i div 2) /\n  sqrt 2 ^ (n + 1)\n                                   else (- 1) ^ (f (i div 2) + 1) /\n  sqrt 2 ^ (n + 1)))) $$\n                         (i, j) =\n                         Matrix.mat (2 ^ (n + 1)) 1\n                          (\\<lambda>x.\n                              complex_of_real\n                               (case x of\n                                (i, j) \\<Rightarrow>\n                                  if even i\n                                  then \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                                  else \\<Sum>k<2 ^ n.\n    (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n                         (i, j)\n 2. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n 3. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "show \"(((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) * \\<psi>\\<^sub>2) $$ (i,j) = \\<psi>\\<^sub>3 $$ (i,j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "proof(rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 3. ?Q \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "show \"even i \\<or> odd i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. even i \\<or> odd i", "by simp"], ["proof (state)\nthis:\n  even i \\<or> odd i\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "assume a2: \"even i\""], ["proof (state)\nthis:\n  even i\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "have \"(\\<not>(i mod 2 = k mod 2) \\<and> k<dim_col (HId^\\<^sub>\\<otimes> n)) \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) * (\\<psi>\\<^sub>2 $$ (k,j)) = 0\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> k mod 2 \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "using f0"], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1) \\<and> j = 0\n\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> k mod 2 \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "by simp"], ["proof (state)\nthis:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0", "have \"k<(2^(n+1)) \\<and> odd k \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) * (\\<psi>\\<^sub>2 $$ (k,j)) = 0\" for k"], ["proof (prove)\nusing this:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (1 subgoal):\n 1. k < 2 ^ (n + 1) \\<and> odd k \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "using a2 mod_2_is_both_even_or_odd f0"], ["proof (prove)\nusing this:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n  even i\n  (even ?i \\<and> even ?j \\<or> odd ?i \\<and> odd ?j) =\n  (?i mod (2::?'a) = ?j mod (2::?'a))\n  i < 2 ^ (n + 1) \\<and> j = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ (n + 1) \\<and> odd k \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "by (metis (no_types, lifting) dim_col_mat(1))"], ["proof (state)\nthis:\n  ?k < 2 ^ (n + 1) \\<and> odd ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ (n + 1) \\<and> odd ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0", "have \"(\\<Sum>k\\<in>{(0::nat)..<(2^(n+1))}. ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) * (\\<psi>\\<^sub>2 $$ (k,j)))\n             = (\\<Sum>k\\<in>{(0::nat)..< (2^n)}. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k)) * (\\<psi>\\<^sub>2 $$ (2*k,j)))\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ (n + 1) \\<and> odd ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1).\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (k, j)) =\n    (\\<Sum>k = 0..<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j))", "using sum_every_odd_summand_is_zero dim"], ["proof (prove)\nusing this:\n  ?k < 2 ^ (n + 1) \\<and> odd ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n  1 \\<le> ?n \\<Longrightarrow>\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (?n + 1) \\<and> odd i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (?n + 1)} = (\\<Sum>k = 0..<2 ^ ?n. f (2 * k))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1).\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (k, j)) =\n    (\\<Sum>k = 0..<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "have \"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k)) * (\\<psi>\\<^sub>2 $$ (2*k,j))) \n                 = (\\<Sum>k<2^n.(-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k)/(sqrt(2)^n) *((-1)^f(k))/(sqrt(2)^(n+1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "have \"(even k \\<and> k<dim_row \\<psi>\\<^sub>2) \\<longrightarrow> (\\<psi>\\<^sub>2 $$ (k,j)) = ((-1)^f(k div 2))/(sqrt(2)^(n+1))\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. even k \\<and>\n    k < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                   else (- 1) ^ (f (i div 2) + 1) /\n                        sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    complex_of_real ((- 1) ^ f (k div 2) / sqrt 2 ^ (n + 1))", "using a0 a1"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. even k \\<and>\n    k < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                   else (- 1) ^ (f (i div 2) + 1) /\n                        sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    complex_of_real ((- 1) ^ f (k div 2) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  even ?k \\<and>\n  ?k < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  complex_of_real ((- 1) ^ f (?k div 2) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "then"], ["proof (chain)\npicking this:\n  even ?k \\<and>\n  ?k < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  complex_of_real ((- 1) ^ f (?k div 2) / sqrt 2 ^ (n + 1))", "have \"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k)) * (\\<psi>\\<^sub>2 $$ (2*k,j))) \n               = (\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k)) *((-1)^f((2*k) div 2))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  even ?k \\<and>\n  ?k < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  complex_of_real ((- 1) ^ f (?k div 2) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        (- 1) ^ f (2 * k div 2) /\n        complex_of_real (sqrt 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      (- 1) ^ f (2 * k div 2) /\n      complex_of_real (sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      (- 1) ^ f (2 * k div 2) /\n      complex_of_real (sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "have \"(even k \\<and> k<dim_col (HId^\\<^sub>\\<otimes> n))\n                 \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) = (-1)^ ((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (k div 2))/(sqrt(2)^n)\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. even k \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k div 2 / sqrt 2 ^ n)", "using a2 a0 a1"], ["proof (prove)\nusing this:\n  even i\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. even k \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k div 2 / sqrt 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  even ?k \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      (- 1) ^ f (2 * k div 2) /\n      complex_of_real (sqrt 2 ^ (n + 1)))\n  even ?k \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)", "have \"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k)) * (\\<psi>\\<^sub>2 $$ (2*k,j))) \n                     = (\\<Sum>k<2^n. (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub>  ((2*k) div 2))/(sqrt(2)^n) * \n                                   ((-1)^f((2*k) div 2))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      (- 1) ^ f (2 * k div 2) /\n      complex_of_real (sqrt 2 ^ (n + 1)))\n  even ?k \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  2 * k div 2 /\n         sqrt 2 ^ n *\n         (- 1) ^ f (2 * k div 2) /\n         sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  2 * k div 2 / sqrt 2 ^ n *\n       (- 1) ^ f (2 * k div 2) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "then"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  2 * k div 2 / sqrt 2 ^ n *\n       (- 1) ^ f (2 * k div 2) /\n       sqrt 2 ^ (n + 1))", "show \"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k)) * (\\<psi>\\<^sub>2 $$ (2*k,j))) \n               = (\\<Sum>k<2^n. (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub>  k)/(sqrt(2)^n) *((-1)^f(k))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  2 * k div 2 / sqrt 2 ^ n *\n       (- 1) ^ f (2 * k div 2) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j))\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1))", "have \"((HId^\\<^sub>\\<otimes> n)* \\<psi>\\<^sub>2) $$ (i,j) = (\\<Sum>k<2^n. (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k)/(sqrt(2)^n) \n                                                        * ((-1)^f(k))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j))\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "using f1"], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j))\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1))\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1))", "by (metis atLeast0LessThan)"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "also"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "have \"... =  (\\<Sum>k<2^n. (-1)^(f(k)+((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/((sqrt(2)^n)*(sqrt(2)^(n+1))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ f k /\n         sqrt 2 ^ (n + 1)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "by (simp add: power_add mult.commute)"], ["proof (state)\nthis:\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ f k /\n       sqrt 2 ^ (n + 1)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "finally"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "have \"((HId^\\<^sub>\\<otimes> n)* \\<psi>\\<^sub>2) $$ (i,j) = (\\<Sum>k<2^n. (-1)^(f(k)+((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/((sqrt(2)^n)*(sqrt(2)^(n+1))))\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "have \"\\<psi>\\<^sub>3 $$ (i,j) = (\\<Sum>k<2^n. (-1)^(f(k) + ((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/(sqrt(2)^n * sqrt(2)^(n+1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "using a0 a1 a2"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  even i\n\ngoal (1 subgoal):\n 1. Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (2 subgoals):\n 1. even i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)\n 2. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "show \"(((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1)* \\<psi>\\<^sub>2) $$ (i,j) = \\<psi>\\<^sub>3 $$ (i,j)\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "using iter_tensor_of_H_tensor_Id_is_HId dim"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n)) \\<Otimes>\n  Quantum.Id 1 =\n  Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                sqrt 2 ^ ?n\n           else 0))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  ((Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (i, j)\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "assume a2: \"odd i\""], ["proof (state)\nthis:\n  odd i\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "have \"(\\<not>(i mod 2 = k mod 2) \\<and> k<dim_col (HId^\\<^sub>\\<otimes> n)) \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) * (\\<psi>\\<^sub>2 $$ (k,j)) = 0\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> k mod 2 \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "using f0"], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1) \\<and> j = 0\n\ngoal (1 subgoal):\n 1. i mod 2 \\<noteq> k mod 2 \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "by simp"], ["proof (state)\nthis:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0", "have \"k<(2^(n+1)) \\<and> even k \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) * (\\<psi>\\<^sub>2 $$ (k,j)) = 0\" for k"], ["proof (prove)\nusing this:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (1 subgoal):\n 1. k < 2 ^ (n + 1) \\<and> even k \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "using a2 mod_2_is_both_even_or_odd f0"], ["proof (prove)\nusing this:\n  i mod 2 \\<noteq> ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n  odd i\n  (even ?i \\<and> even ?j \\<or> odd ?i \\<and> odd ?j) =\n  (?i mod (2::?'a) = ?j mod (2::?'a))\n  i < 2 ^ (n + 1) \\<and> j = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ (n + 1) \\<and> even k \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    0", "by (metis (no_types, lifting) dim_col_mat(1))"], ["proof (state)\nthis:\n  ?k < 2 ^ (n + 1) \\<and> even ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ (n + 1) \\<and> even ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0", "have \"(\\<Sum>k\\<in>{0..<2^(n+1)}. ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) * (\\<psi>\\<^sub>2 $$ (k,j)))\n             = (\\<Sum>k\\<in>{0..<2^n}. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k+1)) * (\\<psi>\\<^sub>2 $$ (2*k+1,j)))\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ (n + 1) \\<and> even ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1).\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (k, j)) =\n    (\\<Sum>k = 0..<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j))", "using sum_every_even_summand_is_zero dim"], ["proof (prove)\nusing this:\n  ?k < 2 ^ (n + 1) \\<and> even ?k \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  0\n  1 \\<le> ?n \\<Longrightarrow>\n  \\<forall>f.\n     (\\<forall>i.\n         i < 2 ^ (?n + 1) \\<and> even i \\<longrightarrow>\n         f i = 0) \\<longrightarrow>\n     sum f {0..<2 ^ (?n + 1)} = (\\<Sum>k = 0..<2 ^ ?n. f (2 * k + 1))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ (n + 1).\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, k) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (k, j)) =\n    (\\<Sum>k = 0..<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "have \"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k+1)) * (\\<psi>\\<^sub>2 $$ (2*k+1,j))) \n                 = (\\<Sum> k<2^n. (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k)/(sqrt(2)^n) * ((-1)^(f(k)+1))/(sqrt(2)^(n+1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "have \"(odd k \\<and> k<dim_row \\<psi>\\<^sub>2) \\<longrightarrow> (\\<psi>\\<^sub>2 $$ (k,j)) = ((-1)^(f(k div 2)+1))/(sqrt(2)^(n+1))\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. odd k \\<and>\n    k < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                   else (- 1) ^ (f (i div 2) + 1) /\n                        sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    complex_of_real ((- 1) ^ (f (k div 2) + 1) / sqrt 2 ^ (n + 1))", "using a0 a1 a2"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  odd i\n\ngoal (1 subgoal):\n 1. odd k \\<and>\n    k < dim_row\n         (Matrix.mat (2 ^ (n + 1)) 1\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                   else (- 1) ^ (f (i div 2) + 1) /\n                        sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n    (k, j) =\n    complex_of_real ((- 1) ^ (f (k div 2) + 1) / sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  odd ?k \\<and>\n  ?k < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  complex_of_real ((- 1) ^ (f (?k div 2) + 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "then"], ["proof (chain)\npicking this:\n  odd ?k \\<and>\n  ?k < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  complex_of_real ((- 1) ^ (f (?k div 2) + 1) / sqrt 2 ^ (n + 1))", "have f2:\"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k+1)) * (\\<psi>\\<^sub>2 $$ (2*k+1,j))) \n                  = (\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k+1)) * ((-1)^(f((2*k+1) div 2)+1))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  odd ?k \\<and>\n  ?k < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                  else (- 1) ^ (f (i div 2) + 1) /\n                       sqrt 2 ^ (n + 1)))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n  (?k, j) =\n  complex_of_real ((- 1) ^ (f (?k div 2) + 1) / sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n        complex_of_real (sqrt 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n      complex_of_real (sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "have \"i < dim_row (HId^\\<^sub>\\<otimes> n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. i < dim_row\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0)))", "using f0 a2 mod_2_is_both_even_or_odd"], ["proof (prove)\nusing this:\n  i < 2 ^ (n + 1) \\<and> j = 0\n  odd i\n  (even ?i \\<and> even ?j \\<or> odd ?i \\<and> odd ?j) =\n  (?i mod (2::?'a) = ?j mod (2::?'a))\n\ngoal (1 subgoal):\n 1. i < dim_row\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0)))", "by simp"], ["proof (state)\nthis:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "then"], ["proof (chain)\npicking this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))", "have \"((i mod 2 = k mod 2) \\<and> k<dim_col (HId^\\<^sub>\\<otimes> n))\n                 \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (k div 2))/(sqrt(2)^n) \" for k"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n\ngoal (1 subgoal):\n 1. i mod 2 = k mod 2 \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k div 2 / sqrt 2 ^ n)", "using a2 a0 a1 f0 dim HId_values"], ["proof (prove)\nusing this:\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)))\n  odd i\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  i < 2 ^ (n + 1) \\<and> j = 0\n  1 \\<le> n\n  \\<lbrakk>1 \\<le> ?n;\n   ?i < dim_row\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)));\n   ?j < dim_col\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)))\\<rbrakk>\n  \\<Longrightarrow> even ?i \\<and> even ?j \\<longrightarrow>\n                    Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             if i mod 2 = j mod 2\n                             then (- 1) ^\n                                  i div\n                                  2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                                  sqrt 2 ^ ?n\n                             else 0)) $$\n                    (?i, ?j) =\n                    complex_of_real\n                     ((- 1) ^ ?i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  ?j div 2 /\n                      sqrt 2 ^ ?n)\n  \\<lbrakk>1 \\<le> ?n;\n   ?i < dim_row\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)));\n   ?j < dim_col\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)))\\<rbrakk>\n  \\<Longrightarrow> odd ?i \\<and> odd ?j \\<longrightarrow>\n                    Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             if i mod 2 = j mod 2\n                             then (- 1) ^\n                                  i div\n                                  2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                                  sqrt 2 ^ ?n\n                             else 0)) $$\n                    (?i, ?j) =\n                    complex_of_real\n                     ((- 1) ^ ?i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  ?j div 2 /\n                      sqrt 2 ^ ?n)\n  \\<lbrakk>1 \\<le> ?n;\n   ?i < dim_row\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)));\n   ?j < dim_col\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)))\\<rbrakk>\n  \\<Longrightarrow> ?i mod 2 = ?j mod 2 \\<longrightarrow>\n                    Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             if i mod 2 = j mod 2\n                             then (- 1) ^\n                                  i div\n                                  2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                                  sqrt 2 ^ ?n\n                             else 0)) $$\n                    (?i, ?j) =\n                    complex_of_real\n                     ((- 1) ^ ?i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  ?j div 2 /\n                      sqrt 2 ^ ?n)\n  \\<lbrakk>1 \\<le> ?n;\n   ?i < dim_row\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)));\n   ?j < dim_col\n         (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                        sqrt 2 ^ ?n\n                   else 0)))\\<rbrakk>\n  \\<Longrightarrow> ?i mod 2 \\<noteq> ?j mod 2 \\<longrightarrow>\n                    Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n                     (\\<lambda>x.\n                         complex_of_real\n                          (case x of\n                           (i, j) \\<Rightarrow>\n                             if i mod 2 = j mod 2\n                             then (- 1) ^\n                                  i div\n                                  2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                                  sqrt 2 ^ ?n\n                             else 0)) $$\n                    (?i, ?j) =\n                    0\n\ngoal (1 subgoal):\n 1. i mod 2 = k mod 2 \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k div 2 / sqrt 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  i mod 2 = ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "moreover"], ["proof (state)\nthis:\n  i mod 2 = ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "have \"odd k \\<longrightarrow> (i mod 2 = k mod 2)\" for k"], ["proof (prove)\ngoal (1 subgoal):\n 1. odd k \\<longrightarrow> i mod 2 = k mod 2", "using a2 mod_2_is_both_even_or_odd"], ["proof (prove)\nusing this:\n  odd i\n  (even ?i \\<and> even ?j \\<or> odd ?i \\<and> odd ?j) =\n  (?i mod (2::?'a) = ?j mod (2::?'a))\n\ngoal (1 subgoal):\n 1. odd k \\<longrightarrow> i mod 2 = k mod 2", "by auto"], ["proof (state)\nthis:\n  odd ?k \\<longrightarrow> i mod 2 = ?k mod 2\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "ultimately"], ["proof (chain)\npicking this:\n  i mod 2 = ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n  odd ?k \\<longrightarrow> i mod 2 = ?k mod 2", "have \"(odd k \\<and> k<dim_col (HId^\\<^sub>\\<otimes> n))\n                 \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,k)) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> (k div 2))/(sqrt(2)^n)\" for k"], ["proof (prove)\nusing this:\n  i mod 2 = ?k mod 2 \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n  odd ?k \\<longrightarrow> i mod 2 = ?k mod 2\n\ngoal (1 subgoal):\n 1. odd k \\<and>\n    k < dim_col\n         (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n           (\\<lambda>x.\n               complex_of_real\n                (case x of\n                 (i, j) \\<Rightarrow>\n                   if i mod 2 = j mod 2\n                   then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                        sqrt 2 ^ n\n                   else 0))) \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, k) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k div 2 / sqrt 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  odd ?k \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "then"], ["proof (chain)\npicking this:\n  odd ?k \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)", "have \"k<2^n \\<longrightarrow> ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k+1)) = (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> ((2*k+1) div 2))/(sqrt(2)^n) \" for k"], ["proof (prove)\nusing this:\n  odd ?k \\<and>\n  ?k < dim_col\n        (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if i mod 2 = j mod 2\n                  then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                       sqrt 2 ^ n\n                  else 0))) \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, ?k) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k div 2 / sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow>\n    Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                  sqrt 2 ^ n\n             else 0)) $$\n    (i, 2 * k + 1) =\n    complex_of_real\n     ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * k + 1) div 2 /\n      sqrt 2 ^ n)", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, 2 * ?k + 1) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * ?k + 1) div 2 /\n    sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, 2 * ?k + 1) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * ?k + 1) div 2 /\n    sqrt 2 ^ n)", "have \"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k+1)) * (\\<psi>\\<^sub>2 $$ (2*k+1,j))) \n               = (\\<Sum>k<2^n. (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> ((2*k+1) div 2))/(sqrt(2)^n) \n                             * ((-1)^(f((2*k+1) div 2)+1))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, 2 * ?k + 1) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * ?k + 1) div 2 /\n    sqrt 2 ^ n)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * k + 1) div 2 /\n         sqrt 2 ^ n *\n         (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n         sqrt 2 ^ (n + 1))", "using f2"], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                sqrt 2 ^ n\n           else 0)) $$\n  (i, 2 * ?k + 1) =\n  complex_of_real\n   ((- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * ?k + 1) div 2 /\n    sqrt 2 ^ n)\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n      complex_of_real (sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * k + 1) div 2 /\n         sqrt 2 ^ n *\n         (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n         sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * k + 1) div 2 /\n       sqrt 2 ^ n *\n       (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "then"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * k + 1) div 2 /\n       sqrt 2 ^ n *\n       (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n       sqrt 2 ^ (n + 1))", "show \"(\\<Sum>k<2^n. ((HId^\\<^sub>\\<otimes> n) $$ (i,2*k+1)) * (\\<psi>\\<^sub>2 $$ (2*k+1,j))) \n               = (\\<Sum>k<2^n. (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k)/(sqrt(2)^n) *((-1)^(f(k)+1))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  (2 * k + 1) div 2 /\n       sqrt 2 ^ n *\n       (- 1) ^ (f ((2 * k + 1) div 2) + 1) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if i mod 2 = j mod 2\n                 then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                      sqrt 2 ^ n\n                 else 0)) $$\n        (i, 2 * k + 1) *\n        Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n                 else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n        (2 * k + 1, j)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j))\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1))", "have \"((HId^\\<^sub>\\<otimes> n)* \\<psi>\\<^sub>2) $$ (i,j) = (\\<Sum>k<2^n. (-1)^((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k)/(sqrt(2)^n) \n                * ((-1)^(f(k)+1))/(sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j))\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "using f1"], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j)) =\n  (\\<Sum>k = 0..<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j))\n  (\\<Sum>k<2 ^ n.\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, 2 * k + 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (2 * k + 1, j)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1))\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  (\\<Sum>k<2 ^ (n + 1).\n      Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if i mod 2 = j mod 2\n               then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                    sqrt 2 ^ n\n               else 0)) $$\n      (i, k) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) $$\n      (k, j))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1))", "by (metis atLeast0LessThan)"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "also"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "have \"... = (\\<Sum>k<2^n. (-1)^(f(k)+1+((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/((sqrt(2)^n)*(sqrt(2)^(n+1))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n         (- 1) ^ (f k + 1) /\n         sqrt 2 ^ (n + 1)) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "by (simp add: mult.commute power_add)"], ["proof (state)\nthis:\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k / sqrt 2 ^ n *\n       (- 1) ^ (f k + 1) /\n       sqrt 2 ^ (n + 1)) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "finally"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "have \"((HId^\\<^sub>\\<otimes> n)* \\<psi>\\<^sub>2) $$ (i,j) \n                = (\\<Sum>k< 2^n. (-1)^(f(k)+1+((i div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/((sqrt(2)^n)*(sqrt(2)^(n+1))))\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if i mod 2 = j mod 2\n              then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                   sqrt 2 ^ n\n              else 0)) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    complex_of_real\n     (\\<Sum>k<2 ^ n.\n         (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. odd i \\<Longrightarrow>\n    ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "then"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "show \"(((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1)* \\<psi>\\<^sub>2) $$ (i,j) = \\<psi>\\<^sub>3 $$ (i,j)\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "using iter_tensor_of_H_tensor_Id_is_HId dim a2 a0 a1"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ (n + 1)) (2 ^ (n + 1))\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if i mod 2 = j mod 2\n            then (- 1) ^ i div 2 \\<cdot>\\<^bsub>n\\<^esub>  j div 2 /\n                 sqrt 2 ^ n\n            else 0)) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n)) \\<Otimes>\n  Quantum.Id 1 =\n  Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                sqrt 2 ^ ?n\n           else 0))\n  1 \\<le> n\n  odd i\n  i < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n  j < dim_col\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. ((Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1) *\n     Matrix.mat (2 ^ (n + 1)) 1\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n              else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n    (i, j) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n    (i, j)", "by simp"], ["proof (state)\nthis:\n  ((Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (i, j)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ((Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1) *\n   Matrix.mat (2 ^ (n + 1)) 1\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n            else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) $$\n  (i, j) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (i, j)\n\ngoal (2 subgoals):\n 1. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n 2. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n 2. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "show \"dim_row (((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) * \\<psi>\\<^sub>2) = dim_row \\<psi>\\<^sub>3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "using iter_tensor_of_H_tensor_Id_is_HId dim"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n)) \\<Otimes>\n  Quantum.Id 1 =\n  Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                sqrt 2 ^ ?n\n           else 0))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. dim_row\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_row\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "by simp"], ["proof (state)\nthis:\n  dim_row\n   ((Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n  dim_row\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "show \"dim_col (((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1)* \\<psi>\\<^sub>2) = dim_col \\<psi>\\<^sub>3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "using iter_tensor_of_H_tensor_Id_is_HId dim"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n)) \\<Otimes>\n  Quantum.Id 1 =\n  Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                sqrt 2 ^ ?n\n           else 0))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. dim_col\n     ((Matrix.mat (2 ^ n) (2 ^ n)\n        (\\<lambda>x.\n            complex_of_real\n             (case x of\n              (i, j) \\<Rightarrow>\n                (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n                sqrt 2 ^ n)) \\<Otimes>\n       Quantum.Id 1) *\n      Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n    dim_col\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "by simp"], ["proof (state)\nthis:\n  dim_col\n   ((Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))) =\n  dim_col\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) \\<psi>\\<^sub>3_is_state:\n  shows \"state (n+1) \\<psi>\\<^sub>3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "have \"((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1) * \\<psi>\\<^sub>2 = \\<psi>\\<^sub>3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))", "using iter_tensor_of_H_times_\\<psi>\\<^sub>2_is_\\<psi>\\<^sub>3"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. (Matrix.mat (2 ^ n) (2 ^ n)\n      (\\<lambda>x.\n          complex_of_real\n           (case x of\n            (i, j) \\<Rightarrow>\n              (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n     Quantum.Id 1) *\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))", "by simp"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "moreover"], ["proof (state)\nthis:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "have \"gate (n+1) ((H^\\<^sub>\\<otimes> n) \\<Otimes> Id 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1)", "using iter_tensor_of_H_tensor_Id_is_HId HId_is_gate dim"], ["proof (prove)\nusing this:\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n)) \\<Otimes>\n  Quantum.Id 1 =\n  Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if i mod 2 = j mod 2\n           then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                sqrt 2 ^ ?n\n           else 0))\n  1 \\<le> ?n \\<Longrightarrow>\n  gate (?n + 1)\n   (Matrix.mat (2 ^ (?n + 1)) (2 ^ (?n + 1))\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if i mod 2 = j mod 2\n             then (- 1) ^ i div 2 \\<cdot>\\<^bsub>?n\\<^esub>  j div 2 /\n                  sqrt 2 ^ ?n\n             else 0)))\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. gate (n + 1)\n     (Matrix.mat (2 ^ n) (2 ^ n)\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j /\n               sqrt 2 ^ n)) \\<Otimes>\n      Quantum.Id 1)", "by simp"], ["proof (state)\nthis:\n  gate (n + 1)\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "moreover"], ["proof (state)\nthis:\n  gate (n + 1)\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1)\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "have \"state (n+1) \\<psi>\\<^sub>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "using \\<psi>\\<^sub>2_is_state"], ["proof (prove)\nusing this:\n  state (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n               else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "by simp"], ["proof (state)\nthis:\n  state (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "ultimately"], ["proof (chain)\npicking this:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n  gate (n + 1)\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1)\n  state (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))", "show \"state (n+1) \\<psi>\\<^sub>3\""], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n  gate (n + 1)\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1)\n  state (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "using gate_on_state_is_state dim"], ["proof (prove)\nusing this:\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n  gate (n + 1)\n   (Matrix.mat (2 ^ n) (2 ^ n)\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n    Quantum.Id 1)\n  state (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n             else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))))\n  \\<lbrakk>gate ?n ?A; state ?n ?v\\<rbrakk>\n  \\<Longrightarrow> state ?n (?A * ?v)\n  1 \\<le> n\n\ngoal (1 subgoal):\n 1. state (n + 1)\n     (Matrix.mat (2 ^ (n + 1)) 1\n       (\\<lambda>x.\n           complex_of_real\n            (case x of\n             (i, j) \\<Rightarrow>\n               if even i\n               then \\<Sum>k<2 ^ n.\n                       (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n               else \\<Sum>k<2 ^ n.\n                       (- 1) ^\n                       (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))", "by (metis (no_types, lifting))"], ["proof (state)\nthis:\n  state (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\nFinally, all steps are put together. The result depends on the function f. If f is constant\nthe first n qubits are 0, if f is balanced there is at least one qubit in state 1 among the \nfirst n qubits. \nThe algorithm only uses one evaluation of f(x) and will always succeed. \n\\<close>"], ["", "definition (in jozsa) jozsa_algo:: \"complex Matrix.mat\" where \n\"jozsa_algo \\<equiv> ((H \\<otimes>\\<^bsup>n\\<^esup>) \\<Otimes> Id 1) * (U\\<^sub>f * (((H \\<otimes>\\<^bsup>n\\<^esup>) * ( |zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup>)) \\<Otimes> (H * |one\\<rangle>)))\""], ["", "lemma (in jozsa) jozsa_algo_result [simp]: \n  shows \"jozsa_algo = \\<psi>\\<^sub>3\""], ["proof (prove)\ngoal (1 subgoal):\n 1. jozsa_algo =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))", "using jozsa_algo_def H_on_ket_one_is_\\<psi>\\<^sub>1\\<^sub>1 iter_tensor_of_H_on_zero_tensor \\<psi>\\<^sub>1\\<^sub>0_tensor_\\<psi>\\<^sub>1\\<^sub>1_is_\\<psi>\\<^sub>1\n  jozsa_transform_times_\\<psi>\\<^sub>1_is_\\<psi>\\<^sub>2 iter_tensor_of_H_times_\\<psi>\\<^sub>2_is_\\<psi>\\<^sub>3 dim iter_tensor_of_H_rep_is_correct"], ["proof (prove)\nusing this:\n  jozsa_algo \\<equiv>\n  (H \\<otimes>\\<^bsup>n\\<^esup> \\<Otimes> Quantum.Id 1) *\n  (U\\<^sub>f *\n   (H \\<otimes>\\<^bsup>n\\<^esup> *\n    |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>n\\<^esup> \\<Otimes>\n    H * |Deutsch.one\\<rangle>))\n  H * |Deutsch.one\\<rangle> =\n  Matrix.mat 2 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow> if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2))\n  1 \\<le> ?n \\<Longrightarrow>\n  H \\<otimes>\\<^bsup>?n\\<^esup> *\n  |Deutsch.zero\\<rangle> \\<otimes>\\<^bsup>?n\\<^esup> =\n  Matrix.mat (2 ^ ?n) 1\n   (\\<lambda>x.\n       complex_of_real (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n))\n  1 \\<le> ?n \\<Longrightarrow>\n  Matrix.mat (2 ^ ?n) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of (i, j) \\<Rightarrow> 1 / sqrt 2 ^ ?n)) \\<Otimes>\n  Matrix.mat 2 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow> if i = 0 then 1 / sqrt 2 else - 1 / sqrt 2)) =\n  Matrix.mat (2 ^ (?n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (?n + 1)\n           else - 1 / sqrt 2 ^ (?n + 1)))\n  U\\<^sub>f *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then 1 / sqrt 2 ^ (n + 1)\n           else - 1 / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1)))\n  (Matrix.mat (2 ^ n) (2 ^ n)\n    (\\<lambda>x.\n        complex_of_real\n         (case x of\n          (i, j) \\<Rightarrow>\n            (- 1) ^ i \\<cdot>\\<^bsub>n\\<^esub>  j / sqrt 2 ^ n)) \\<Otimes>\n   Quantum.Id 1) *\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i then (- 1) ^ f (i div 2) / sqrt 2 ^ (n + 1)\n           else (- 1) ^ (f (i div 2) + 1) / sqrt 2 ^ (n + 1))) =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n  1 \\<le> n\n  1 \\<le> ?n \\<Longrightarrow>\n  H \\<otimes>\\<^bsup>?n\\<^esup> =\n  Matrix.mat (2 ^ ?n) (2 ^ ?n)\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           (- 1) ^ i \\<cdot>\\<^bsub>?n\\<^esub>  j / sqrt 2 ^ ?n))\n\ngoal (1 subgoal):\n 1. jozsa_algo =\n    Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))", "by simp"], ["", "lemma (in jozsa) jozsa_algo_result_is_state: \n  shows \"state (n+1) jozsa_algo\""], ["proof (prove)\ngoal (1 subgoal):\n 1. state (n + 1) jozsa_algo", "using \\<psi>\\<^sub>3_is_state"], ["proof (prove)\nusing this:\n  state (n + 1)\n   (Matrix.mat (2 ^ (n + 1)) 1\n     (\\<lambda>x.\n         complex_of_real\n          (case x of\n           (i, j) \\<Rightarrow>\n             if even i\n             then \\<Sum>k<2 ^ n.\n                     (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n             else \\<Sum>k<2 ^ n.\n                     (- 1) ^\n                     (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. state (n + 1) jozsa_algo", "by simp"], ["", "lemma (in jozsa) prob0_fst_qubits_of_jozsa_algo: \n  shows \"(prob0_fst_qubits n jozsa_algo) = (\\<Sum>j\\<in>{0,1}. (cmod(jozsa_algo $$ (j,0)))\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "using prob0_fst_qubits_eq"], ["proof (prove)\nusing this:\n  prob0_fst_qubits ?n ?v =\n  (cmod (?v $$ (0, 0)))\\<^sup>2 + (cmod (?v $$ (1, 0)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "by simp"], ["", "text \\<open>General lemmata required to compute probabilities.\\<close>"], ["", "lemma aux_comp_with_sqrt2:\n  shows \"(sqrt 2)^n * (sqrt 2)^n = 2^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sqrt 2 ^ n * sqrt 2 ^ n = 2 ^ n", "by (smt power_mult_distrib real_sqrt_mult_self)"], ["", "lemma aux_comp_with_sqrt2_bis [simp]:\n  shows \"2^n/(sqrt(2)^n * sqrt(2)^(n+1)) = 1/sqrt 2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 ^ n / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)) = 1 / sqrt 2", "using aux_comp_with_sqrt2"], ["proof (prove)\nusing this:\n  sqrt 2 ^ ?n * sqrt 2 ^ ?n = 2 ^ ?n\n\ngoal (1 subgoal):\n 1. 2 ^ n / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)) = 1 / sqrt 2", "by (simp add: mult.left_commute)"], ["", "lemma aux_ineq_with_card: \n  fixes g:: \"nat \\<Rightarrow> nat\" and A:: \"nat set\"\n  assumes \"finite A\" \n  shows \"(\\<Sum>k\\<in>A. (-1)^(g k)) \\<le> card A\" and \"(\\<Sum>k\\<in>A. (-1)^(g k)) \\<ge> -card A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>A. (- 1) ^ g k) \\<le> int (card A) &&&\n    - int (card A) \\<le> (\\<Sum>k\\<in>A. (- 1) ^ g k)", "apply (smt assms neg_one_even_power neg_one_odd_power card_eq_sum of_nat_1 of_nat_sum sum_mono)"], ["proof (prove)\ngoal (1 subgoal):\n 1. - int (card A) \\<le> (\\<Sum>k\\<in>A. (- 1) ^ g k)", "apply (smt assms neg_one_even_power neg_one_odd_power card_eq_sum of_nat_1 of_nat_sum sum_mono sum_negf)"], ["proof (prove)\ngoal:\nNo subgoals!", "."], ["", "lemma aux_comp_with_cmod:\n  fixes g:: \"nat \\<Rightarrow> nat\"\n  assumes \"(\\<forall>x<2^n. g x = 0) \\<or> (\\<forall>x<2^n. g x = 1)\"\n  shows \"(cmod (\\<Sum>k<2^n. (-1)^(g k)))\\<^sup>2  = 2^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "proof(rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)\n 3. ?Q \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "show \"(\\<forall>x<2^n. g x = 0) \\<or> (\\<forall>x<2^n. g x = 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>x<2 ^ n. g x = 0) \\<or> (\\<forall>x<2 ^ n. g x = 1)", "using assms"], ["proof (prove)\nusing this:\n  (\\<forall>x<2 ^ n. g x = 0) \\<or> (\\<forall>x<2 ^ n. g x = 1)\n\ngoal (1 subgoal):\n 1. (\\<forall>x<2 ^ n. g x = 0) \\<or> (\\<forall>x<2 ^ n. g x = 1)", "by simp"], ["proof (state)\nthis:\n  (\\<forall>x<2 ^ n. g x = 0) \\<or> (\\<forall>x<2 ^ n. g x = 1)\n\ngoal (2 subgoals):\n 1. \\<forall>x<2 ^ n. g x = 0 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)\n 2. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. \\<forall>x<2 ^ n. g x = 0 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)\n 2. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "assume \"\\<forall>x<2^n. g x = 0\""], ["proof (state)\nthis:\n  \\<forall>x<2 ^ n. g x = 0\n\ngoal (2 subgoals):\n 1. \\<forall>x<2 ^ n. g x = 0 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)\n 2. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "then"], ["proof (chain)\npicking this:\n  \\<forall>x<2 ^ n. g x = 0", "have \"(cmod (\\<Sum>k<2^n. (-1)^(g k)))\\<^sup>2 = (2^n)\\<^sup>2\""], ["proof (prove)\nusing this:\n  \\<forall>x<2 ^ n. g x = 0\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2", "by (simp add: norm_power)"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2\n\ngoal (2 subgoals):\n 1. \\<forall>x<2 ^ n. g x = 0 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)\n 2. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "then"], ["proof (chain)\npicking this:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "by (simp add: power_even_eq)"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)\n\ngoal (1 subgoal):\n 1. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "assume \"\\<forall>x<2^n. g x = 1\""], ["proof (state)\nthis:\n  \\<forall>x<2 ^ n. g x = 1\n\ngoal (1 subgoal):\n 1. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "then"], ["proof (chain)\npicking this:\n  \\<forall>x<2 ^ n. g x = 1", "have \"(cmod (\\<Sum>k<2^n. (-1)^(g k)))\\<^sup>2 = (2^n)\\<^sup>2\""], ["proof (prove)\nusing this:\n  \\<forall>x<2 ^ n. g x = 1\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2", "by (simp add: norm_power)"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2\n\ngoal (1 subgoal):\n 1. \\<forall>x<2 ^ n. g x = 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "then"], ["proof (chain)\npicking this:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = (2 ^ n)\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)", "by (simp add: power_even_eq)"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ g k))\\<^sup>2 = 2 ^ (2 * n)\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma cmod_less:\n  fixes a n:: int\n  assumes \"a < n\" and \"a > -n\"\n  shows \"cmod a < n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (of_int a) < real_of_int n", "using assms"], ["proof (prove)\nusing this:\n  a < n\n  - n < a\n\ngoal (1 subgoal):\n 1. cmod (of_int a) < real_of_int n", "by simp"], ["", "lemma square_less:\n  fixes a n:: real\n  assumes \"a < n\" and \"a > -n\" \n  shows \"a\\<^sup>2 < n\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a\\<^sup>2 < n\\<^sup>2", "using assms"], ["proof (prove)\nusing this:\n  a < n\n  - n < a\n\ngoal (1 subgoal):\n 1. a\\<^sup>2 < n\\<^sup>2", "by (smt power2_eq_iff power2_minus power_less_imp_less_base)"], ["", "lemma cmod_square_real [simp]:\n  fixes n:: real\n  shows \"(cmod n)\\<^sup>2 = n\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (complex_of_real n))\\<^sup>2 = n\\<^sup>2", "by simp"], ["", "lemma aux_comp_sum_divide_cmod:\n  fixes n:: nat and g:: \"nat \\<Rightarrow> int\" and a:: real\n  shows \"(cmod(complex_of_real(\\<Sum>k<n. g k / a)))\\<^sup>2 = (cmod (\\<Sum>k<n. g k) / a)\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (complex_of_real (\\<Sum>k<n. real_of_int (g k) / a)))\\<^sup>2 =\n    (cmod (of_int (sum g {..<n})) / a)\\<^sup>2", "by (metis cmod_square_real of_int_sum of_real_of_int_eq power_divide sum_divide_distrib)"], ["", "text \\<open>\nThe function is constant if and only if the first n qubits are 0. So, if the function is constant, \nthen the probability of measuring 0 for the first n qubits is 1.\n\\<close>"], ["", "lemma (in jozsa) prob0_jozsa_algo_of_const_0:\n  assumes \"const 0\"\n  shows \"prob0_fst_qubits n jozsa_algo = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "have \"prob0_fst_qubits n jozsa_algo = (\\<Sum>j\\<in>{0,1}. (cmod(jozsa_algo $$ (j,0)))\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "using prob0_fst_qubits_of_jozsa_algo"], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "moreover"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "have \"(cmod(jozsa_algo $$ (0,0)))\\<^sup>2 = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "have \"k<2^n \\<longrightarrow> ((0 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0", "have \"(cmod(jozsa_algo $$ (0,0)))\\<^sup>2 = (cmod(\\<Sum>k::nat<2^n. 1/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using jozsa_algo_result const_def assms"], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  jozsa_algo =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  const 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "have \"... = (cmod((2::nat)^n/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (real (2 ^ n) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (real (2 ^ n) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (real (2 ^ n) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "have \"... = (cmod(1/(sqrt(2))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (real (2 ^ n) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2", "using aux_comp_with_sqrt2_bis"], ["proof (prove)\nusing this:\n  2 ^ ?n / (sqrt 2 ^ ?n * sqrt 2 ^ (?n + 1)) = 1 / sqrt 2\n\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (real (2 ^ n) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (real (2 ^ n) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (real (2 ^ n) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "have \"... = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2 = 1 / 2", "by (simp add: norm_divide power2_eq_square)"], ["proof (state)\nthis:\n  (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "finally"], ["proof (chain)\npicking this:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "moreover"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"k<2^n \\<longrightarrow> ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k:: nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0", "have \"k<2^n \\<longrightarrow> f k + 1 + ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 1\" for k::nat"], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow>\n    f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 1", "using const_def assms"], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  const 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow>\n    f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 1", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow>\n  f ?k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 1\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "moreover"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow>\n  f ?k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 1\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 \n    = (cmod (\\<Sum>k::nat<2^n. (-1)^(f k + 1 + ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub> k))/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using \\<psi>\\<^sub>3_dim"], ["proof (prove)\nusing this:\n  1 < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "ultimately"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow>\n  f ?k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 1\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 = (cmod(\\<Sum>k::nat<2^n. -1/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow>\n  f ?k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 1\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. - 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by (smt lessThan_iff power_one_right sum.cong)"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. - 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. - 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"... = (cmod(-1/(sqrt(2))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. - 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2", "using aux_comp_with_sqrt2_bis"], ["proof (prove)\nusing this:\n  2 ^ ?n / (sqrt 2 ^ ?n * sqrt 2 ^ (?n + 1)) = 1 / sqrt 2\n\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. - 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. - 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. - 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"... = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2 = 1 / 2", "by (simp add: norm_divide power2_eq_square)"], ["proof (state)\nthis:\n  (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "finally"], ["proof (chain)\npicking this:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "ultimately"], ["proof (chain)\npicking this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"prob0_fst_qubits n jozsa_algo = 1/2 + 1/2\""], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "then"], ["proof (chain)\npicking this:\n  prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2", "show  \"?thesis\""], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo = 1\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) prob0_jozsa_algo_of_const_1:\n  assumes \"const 1\"\n  shows \"prob0_fst_qubits n jozsa_algo = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "have \"prob0_fst_qubits n jozsa_algo = (\\<Sum>j\\<in>{0,1}. (cmod(jozsa_algo $$ (j,0)))\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "using prob0_fst_qubits_of_jozsa_algo"], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "moreover"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "have \"(cmod(jozsa_algo $$ (0,0)))\\<^sup>2 = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "have \"k<2^n \\<longrightarrow> ((0 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0", "have \"(cmod(jozsa_algo $$ (0,0)))\\<^sup>2 = (cmod(\\<Sum>k::nat<2^n. 1/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using jozsa_algo_result const_def assms"], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  jozsa_algo =\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))))\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  const 1\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "have \"... = (cmod((-1)/(sqrt(2))))\\<^sup>2 \""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2", "using aux_comp_with_sqrt2_bis"], ["proof (prove)\nusing this:\n  2 ^ ?n / (sqrt 2 ^ ?n * sqrt 2 ^ (?n + 1)) = 1 / sqrt 2\n\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "have \"... = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2 = 1 / 2", "by (simp add: norm_divide power2_eq_square)"], ["proof (state)\nthis:\n  (cmod (complex_of_real (- 1 / sqrt 2)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "finally"], ["proof (chain)\npicking this:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "moreover"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"k<2^n \\<longrightarrow> ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0", "have \"(\\<Sum>k::nat<2^n. (-1)^(f k +1 + ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k))/(sqrt(2)^n * sqrt(2)^(n+1)))\n             = (\\<Sum>k::nat<2^n. 1/(sqrt(2)^n * sqrt(2)^(n+1)))\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n        (sqrt 2 ^ n * sqrt 2 ^ (n + 1))) =\n    (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "using const_def assms"], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  const 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n.\n        (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n        (sqrt 2 ^ n * sqrt 2 ^ (n + 1))) =\n    (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n      (sqrt 2 ^ n * sqrt 2 ^ (n + 1))) =\n  (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n.\n      (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n      (sqrt 2 ^ n * sqrt 2 ^ (n + 1))) =\n  (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 \n    = (cmod (\\<Sum>k::nat<2^n. (-1)^(f k + 1 + ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k))/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using  \\<psi>\\<^sub>3_dim"], ["proof (prove)\nusing this:\n  1 < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n.\n      (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n      (sqrt 2 ^ n * sqrt 2 ^ (n + 1))) =\n  (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 = (cmod(\\<Sum>k::nat<2^n. 1/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n.\n      (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n      (sqrt 2 ^ n * sqrt 2 ^ (n + 1))) =\n  (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"... = (cmod(1/(sqrt(2))))\\<^sup>2 \""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2", "using aux_comp_with_sqrt2_bis"], ["proof (prove)\nusing this:\n  2 ^ ?n / (sqrt 2 ^ ?n * sqrt 2 ^ (?n + 1)) = 1 / sqrt 2\n\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n. 1 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"... = 1/2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2 = 1 / 2", "by (simp add: norm_divide power2_eq_square)"], ["proof (state)\nthis:\n  (cmod (complex_of_real (1 / sqrt 2)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "finally"], ["proof (chain)\npicking this:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "show \"?thesis\""], ["proof (prove)\nusing this:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "ultimately"], ["proof (chain)\npicking this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2", "have \"prob0_fst_qubits n jozsa_algo = 1/2 + 1/2\""], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 1 / 2\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "then"], ["proof (chain)\npicking this:\n  prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2", "show  \"?thesis\""], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo = 1 / 2 + 1 / 2\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 1", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo = 1\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If the probability of measuring 0 for the first n qubits is 1, then the function is constant.\\<close>"], ["", "lemma (in jozsa) max_value_of_not_const_less:\n  assumes \"\\<not> const 0\" and \"\\<not> const 1\"\n  shows \"(cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k)))\\<^sup>2 < (2::nat)^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n    < real (2 ^ (2 * n))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n    < real (2 ^ (2 * n))", "have \"cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k)) < 2^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k)) < 2^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n", "obtain x where f0:\"x < 2^n\" and f1:\"f x = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(1) const_def f_values"], ["proof (prove)\nusing this:\n  \\<not> const 0\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x < 2 ^ n\n  f x = 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n", "then"], ["proof (chain)\npicking this:\n  x < 2 ^ n\n  f x = 1", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k)) < (\\<Sum>k\\<in>{i| i:: nat. i < 2^n}-{x}. (-(1::nat))^(f k))\""], ["proof (prove)\nusing this:\n  x < 2 ^ n\n  f x = 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "have \"(-(1::nat))^ f x = -1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (- int 1) ^ f x = - 1", "using f1"], ["proof (prove)\nusing this:\n  f x = 1\n\ngoal (1 subgoal):\n 1. (- int 1) ^ f x = - 1", "by simp"], ["proof (state)\nthis:\n  (- int 1) ^ f x = - 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "moreover"], ["proof (state)\nthis:\n  (- int 1) ^ f x = - 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "have \"x\\<in>{i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "using f0"], ["proof (prove)\nusing this:\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "moreover"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "have \"finite {i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "moreover"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "have \"(\\<Sum>k\\<in>{i| i::nat. i<2^n}. (-(1::nat))^(f k)) < \n(\\<Sum>k\\<in>{i| i:: nat. i<2^n}-{x}. (-(1::nat))^(f k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "using calculation(1,2,3) sum_diff1"], ["proof (prove)\nusing this:\n  (- int 1) ^ f x = - 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  finite ?A \\<Longrightarrow>\n  sum ?f (?A - {?a}) =\n  (if ?a \\<in> ?A then sum ?f ?A - ?f ?a else sum ?f ?A)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "by (simp add: sum_diff1)"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ f k)", "ultimately"], ["proof (chain)\npicking this:\n  (- int 1) ^ f x = - 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "show ?thesis"], ["proof (prove)\nusing this:\n  (- int 1) ^ f x = - 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "by (metis Collect_cong Collect_mem_eq lessThan_iff)"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n", "have \"\\<dots> \\<le> int (2^n - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n    \\<le> int (2 ^ n - 1)", "using aux_ineq_with_card(1)[of \"{i| i:: nat. i<2^n}-{x}\"] f0"], ["proof (prove)\nusing this:\n  finite ({i |i. i < 2 ^ n} - {x}) \\<Longrightarrow>\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- 1) ^ ?g k)\n  \\<le> int (card ({i |i. i < 2 ^ n} - {x}))\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n    \\<le> int (2 ^ n - 1)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  \\<le> int (2 ^ n - 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  \\<le> int (2 ^ n - 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  \\<le> int (2 ^ n - 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n", "by (meson diff_le_self less_le_trans of_nat_le_numeral_power_cancel_iff)"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k)) > - (2^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "obtain x where f0:\"x < 2^n\" and f1:\"f x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(2) const_def f_values"], ["proof (prove)\nusing this:\n  \\<not> const 1\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x < 2 ^ n\n  f x = 0\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "then"], ["proof (chain)\npicking this:\n  x < 2 ^ n\n  f x = 0", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k)) > (\\<Sum>k\\<in>{i| i:: nat. i < 2^n}-{x}. (-(1::nat))^(f k))\""], ["proof (prove)\nusing this:\n  x < 2 ^ n\n  f x = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n    < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "have \"(-(1::nat))^ f x = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (- int 1) ^ f x = 1", "using f1"], ["proof (prove)\nusing this:\n  f x = 0\n\ngoal (1 subgoal):\n 1. (- int 1) ^ f x = 1", "by simp"], ["proof (state)\nthis:\n  (- int 1) ^ f x = 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "moreover"], ["proof (state)\nthis:\n  (- int 1) ^ f x = 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "have \"x\\<in>{i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "using f0"], ["proof (prove)\nusing this:\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "moreover"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "have \"finite {i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "moreover"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "have \"(\\<Sum>k\\<in>{i| i::nat. i<2^n}. (-(1::nat))^(f k)) > \n(\\<Sum>k\\<in>{i| i:: nat. i<2^n}-{x}. (-(1::nat))^(f k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)", "using calculation(1,2,3) sum_diff1"], ["proof (prove)\nusing this:\n  (- int 1) ^ f x = 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  finite ?A \\<Longrightarrow>\n  sum ?f (?A - {?a}) =\n  (if ?a \\<in> ?A then sum ?f ?A - ?f ?a else sum ?f ?A)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)", "by (simp add: sum_diff1)"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "ultimately"], ["proof (chain)\npicking this:\n  (- int 1) ^ f x = 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)", "show ?thesis"], ["proof (prove)\nusing this:\n  (- int 1) ^ f x = 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n    < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "by (metis Collect_cong Collect_mem_eq lessThan_iff)"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "have \"- int (2^n - 1) \\<le> (\\<Sum>k\\<in>{i| i:: nat. i < 2^n}-{x}. (-(1::nat))^(f k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - int (2 ^ n - 1)\n    \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "using aux_ineq_with_card(2)[of \"{i| i:: nat. i<2^n}-{x}\"] f0"], ["proof (prove)\nusing this:\n  finite ({i |i. i < 2 ^ n} - {x}) \\<Longrightarrow>\n  - int (card ({i |i. i < 2 ^ n} - {x}))\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- 1) ^ ?g k)\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. - int (2 ^ n - 1)\n    \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "by simp"], ["proof (state)\nthis:\n  - int (2 ^ n - 1)\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  - int (2 ^ n - 1)\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  - int (2 ^ n - 1)\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "by (smt diff_le_self of_nat_1 of_nat_add of_nat_power_le_of_nat_cancel_iff one_add_one)"], ["proof (state)\nthis:\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "using cmod_less of_int_of_nat_eq of_nat_numeral of_nat_power"], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) < 2 ^ n\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ f k)\n  \\<lbrakk>?a < ?n; - ?n < ?a\\<rbrakk>\n  \\<Longrightarrow> cmod (of_int ?a) < real_of_int ?n\n  of_int (int ?n) = of_nat ?n\n  of_nat (numeral ?n) = numeral ?n\n  of_nat (?m ^ ?n) = of_nat ?m ^ ?n\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "by (metis (no_types, lifting))"], ["proof (state)\nthis:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n    < real (2 ^ (2 * n))", "then"], ["proof (chain)\npicking this:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n", "have \"(cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k)))\\<^sup>2 < (2^n)\\<^sup>2\""], ["proof (prove)\nusing this:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n    < (2 ^ n)\\<^sup>2", "using square_less norm_ge_zero"], ["proof (prove)\nusing this:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) < 2 ^ n\n  \\<lbrakk>?a < ?n; - ?n < ?a\\<rbrakk>\n  \\<Longrightarrow> ?a\\<^sup>2 < ?n\\<^sup>2\n  0 \\<le> norm ?x\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n    < (2 ^ n)\\<^sup>2", "by smt"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2 < (2 ^ n)\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n    < real (2 ^ (2 * n))", "thus ?thesis"], ["proof (prove)\nusing this:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2 < (2 ^ n)\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n    < real (2 ^ (2 * n))", "by (simp add: power_even_eq)"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n  < real (2 ^ (2 * n))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) max_value_of_not_const_less_bis:\n  assumes \"\\<not> const 0\" and \"\\<not> const 1\"\n  shows \"(cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)))\\<^sup>2 < (2::nat)^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n    < real (2 ^ (2 * n))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n    < real (2 ^ (2 * n))", "have \"cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)) < 2^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)) < 2^n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n", "obtain x where f0:\"x < 2^n\" and f1:\"f x = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(2) const_def f_values"], ["proof (prove)\nusing this:\n  \\<not> const 1\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x < 2 ^ n\n  f x = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n", "then"], ["proof (chain)\npicking this:\n  x < 2 ^ n\n  f x = 0", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)) < (\\<Sum>k\\<in>{i| i:: nat. i < 2^n}-{x}. (-(1::nat))^(f k + 1))\""], ["proof (prove)\nusing this:\n  x < 2 ^ n\n  f x = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "have \"(-(1::nat))^ (f x + 1) = -1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (- int 1) ^ (f x + 1) = - 1", "using f1"], ["proof (prove)\nusing this:\n  f x = 0\n\ngoal (1 subgoal):\n 1. (- int 1) ^ (f x + 1) = - 1", "by simp"], ["proof (state)\nthis:\n  (- int 1) ^ (f x + 1) = - 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "moreover"], ["proof (state)\nthis:\n  (- int 1) ^ (f x + 1) = - 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "have \"x\\<in>{i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "using f0"], ["proof (prove)\nusing this:\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "moreover"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "have \"finite {i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "moreover"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "have \"(\\<Sum>k\\<in>{i| i::nat. i<2^n}. (-(1::nat))^(f k + 1)) < \n(\\<Sum>k\\<in>{i| i:: nat. i<2^n}-{x}. (-(1::nat))^(f k + 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "using calculation(1,2,3) sum_diff1"], ["proof (prove)\nusing this:\n  (- int 1) ^ (f x + 1) = - 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  finite ?A \\<Longrightarrow>\n  sum ?f (?A - {?a}) =\n  (if ?a \\<in> ?A then sum ?f ?A - ?f ?a else sum ?f ?A)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "by (simp add: sum_diff1)"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 0\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                           (- int 1) ^ (f k + 1))", "ultimately"], ["proof (chain)\npicking this:\n  (- int 1) ^ (f x + 1) = - 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "show ?thesis"], ["proof (prove)\nusing this:\n  (- int 1) ^ (f x + 1) = - 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "by (metis Collect_cong Collect_mem_eq lessThan_iff)"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n", "have \"\\<dots> \\<le> int (2^n - 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n    \\<le> int (2 ^ n - 1)", "using aux_ineq_with_card(1)[of \"{i| i:: nat. i<2^n}-{x}\" \"\\<lambda>k. f k + 1\"] f0"], ["proof (prove)\nusing this:\n  finite ({i |i. i < 2 ^ n} - {x}) \\<Longrightarrow>\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- 1) ^ (f k + 1))\n  \\<le> int (card ({i |i. i < 2 ^ n} - {x}))\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n    \\<le> int (2 ^ n - 1)", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  \\<le> int (2 ^ n - 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  \\<le> int (2 ^ n - 1)", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  \\<le> int (2 ^ n - 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n", "by (meson diff_le_self less_le_trans of_nat_le_numeral_power_cancel_iff)"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)) > - (2^n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "obtain x where f0:\"x < 2^n\" and f1:\"f x = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "using assms(1) const_def f_values"], ["proof (prove)\nusing this:\n  \\<not> const 0\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  \\<forall>x\\<in>{i. i < 2 ^ n}. f x = 0 \\<or> f x = 1\n\ngoal (1 subgoal):\n 1. (\\<And>x.\n        \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n        \\<Longrightarrow> thesis) \\<Longrightarrow>\n    thesis", "by auto"], ["proof (state)\nthis:\n  x < 2 ^ n\n  f x = 1\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "then"], ["proof (chain)\npicking this:\n  x < 2 ^ n\n  f x = 1", "have \"(\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)) > (\\<Sum>k\\<in>{i| i:: nat. i < 2^n}-{x}. (-(1::nat))^(f k + 1))\""], ["proof (prove)\nusing this:\n  x < 2 ^ n\n  f x = 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "have \"(-(1::nat))^ (f x + 1) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (- int 1) ^ (f x + 1) = 1", "using f1"], ["proof (prove)\nusing this:\n  f x = 1\n\ngoal (1 subgoal):\n 1. (- int 1) ^ (f x + 1) = 1", "by simp"], ["proof (state)\nthis:\n  (- int 1) ^ (f x + 1) = 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "moreover"], ["proof (state)\nthis:\n  (- int 1) ^ (f x + 1) = 1\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "have \"x\\<in>{i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "using f0"], ["proof (prove)\nusing this:\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. x \\<in> {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "moreover"], ["proof (state)\nthis:\n  x \\<in> {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "have \"finite {i| i::nat. i<2^n}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. finite {i |i. i < 2 ^ n}", "by simp"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "moreover"], ["proof (state)\nthis:\n  finite {i |i. i < 2 ^ n}\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "have \"(\\<Sum>k\\<in>{i| i::nat. i<2^n}. (-(1::nat))^(f k + 1)) > \n(\\<Sum>k\\<in>{i| i:: nat. i<2^n}-{x}. (-(1::nat))^(f k + 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))", "using calculation(1,2,3) sum_diff1"], ["proof (prove)\nusing this:\n  (- int 1) ^ (f x + 1) = 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  finite ?A \\<Longrightarrow>\n  sum ?f (?A - {?a}) =\n  (if ?a \\<in> ?A then sum ?f ?A - ?f ?a else sum ?f ?A)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))", "by (simp add: sum_diff1)"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. \\<lbrakk>x < 2 ^ n; f x = 1\\<rbrakk>\n    \\<Longrightarrow> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}.\n                         (- int 1) ^ (f k + 1))\n                      < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "ultimately"], ["proof (chain)\npicking this:\n  (- int 1) ^ (f x + 1) = 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))", "show ?thesis"], ["proof (prove)\nusing this:\n  (- int 1) ^ (f x + 1) = 1\n  x \\<in> {i |i. i < 2 ^ n}\n  finite {i |i. i < 2 ^ n}\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k\\<in>{i |i. i < 2 ^ n}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n    < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "by (metis Collect_cong Collect_mem_eq lessThan_iff)"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "have \"- int (2^n - 1) \\<le> (\\<Sum>k\\<in>{i| i:: nat. i < 2^n}-{x}. (-(1::nat))^(f k + 1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. - int (2 ^ n - 1)\n    \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "using aux_ineq_with_card(2)[of \"{i| i:: nat. i<2^n}-{x}\" \"\\<lambda>k. f k + 1\"] f0"], ["proof (prove)\nusing this:\n  finite ({i |i. i < 2 ^ n} - {x}) \\<Longrightarrow>\n  - int (card ({i |i. i < 2 ^ n} - {x}))\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- 1) ^ (f k + 1))\n  x < 2 ^ n\n\ngoal (1 subgoal):\n 1. - int (2 ^ n - 1)\n    \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "by simp"], ["proof (state)\nthis:\n  - int (2 ^ n - 1)\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  - int (2 ^ n - 1)\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n  < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  - int (2 ^ n - 1)\n  \\<le> (\\<Sum>k\\<in>{i |i. i < 2 ^ n} - {x}. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "by (smt diff_le_self of_nat_1 of_nat_add of_nat_power_le_of_nat_cancel_iff one_add_one)"], ["proof (state)\nthis:\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))", "show ?thesis"], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "using cmod_less of_int_of_nat_eq of_nat_numeral of_nat_power"], ["proof (prove)\nusing this:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) < 2 ^ n\n  - (2 ^ n) < (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))\n  \\<lbrakk>?a < ?n; - ?n < ?a\\<rbrakk>\n  \\<Longrightarrow> cmod (of_int ?a) < real_of_int ?n\n  of_int (int ?n) = of_nat ?n\n  of_nat (numeral ?n) = numeral ?n\n  of_nat (?m ^ ?n) = of_nat ?m ^ ?n\n\ngoal (1 subgoal):\n 1. cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "by (metis (no_types, lifting))"], ["proof (state)\nthis:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n    < real (2 ^ (2 * n))", "then"], ["proof (chain)\npicking this:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n", "have \"(cmod (\\<Sum>k::nat<2^n. (-(1::nat))^(f k + 1)))\\<^sup>2 < (2^n)\\<^sup>2\""], ["proof (prove)\nusing this:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n    < (2 ^ n)\\<^sup>2", "using square_less norm_ge_zero"], ["proof (prove)\nusing this:\n  cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) < 2 ^ n\n  \\<lbrakk>?a < ?n; - ?n < ?a\\<rbrakk>\n  \\<Longrightarrow> ?a\\<^sup>2 < ?n\\<^sup>2\n  0 \\<le> norm ?x\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n    < (2 ^ n)\\<^sup>2", "by smt"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n  < (2 ^ n)\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n    < real (2 ^ (2 * n))", "thus ?thesis"], ["proof (prove)\nusing this:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n  < (2 ^ n)\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n    < real (2 ^ (2 * n))", "by (simp add: power_even_eq)"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n  < real (2 ^ (2 * n))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) f_const_has_max_value: \n  assumes \"const 0 \\<or> const 1\"\n  shows \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 = (2::nat)^(2*n)\" \n  and \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 = (2::nat)^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 = real (2 ^ (2 * n)) &&&\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 = real (2 ^ (2 * n))", "using aux_comp_with_cmod[of n \"\\<lambda>k. f k\"] aux_comp_with_cmod[of n \"\\<lambda>k. f k + 1\"] const_def assms"], ["proof (prove)\nusing this:\n  (\\<forall>x<2 ^ n. f x = 0) \\<or>\n  (\\<forall>x<2 ^ n. f x = 1) \\<Longrightarrow>\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 = 2 ^ (2 * n)\n  (\\<forall>x<2 ^ n. f x + 1 = 0) \\<or>\n  (\\<forall>x<2 ^ n. f x + 1 = 1) \\<Longrightarrow>\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 = 2 ^ (2 * n)\n  const ?c = (\\<forall>x\\<in>{i. i < 2 ^ n}. f x = ?c)\n  const 0 \\<or> const 1\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 = real (2 ^ (2 * n)) &&&\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 = real (2 ^ (2 * n))", "by auto"], ["", "lemma (in jozsa) prob0_fst_qubits_leq:\n  shows \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 \\<le> (2::nat)^(2*n)\" \n    and \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 \\<le> (2::nat)^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n)) &&&\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "proof-"], ["proof (state)\ngoal (2 subgoals):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n 2. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "show \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 \\<le> (2::nat)^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "proof(rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n 3. ?Q \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "show \"(const 0 \\<or> const 1) \\<or> (\\<not> const 0 \\<and> \\<not> const 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (const 0 \\<or> const 1) \\<or> \\<not> const 0 \\<and> \\<not> const 1", "by auto"], ["proof (state)\nthis:\n  (const 0 \\<or> const 1) \\<or> \\<not> const 0 \\<and> \\<not> const 1\n\ngoal (2 subgoals):\n 1. const 0 \\<or> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n 2. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. const 0 \\<or> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n 2. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "assume \"const 0 \\<or> const 1\""], ["proof (state)\nthis:\n  const 0 \\<or> const 1\n\ngoal (2 subgoals):\n 1. const 0 \\<or> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n 2. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "then"], ["proof (chain)\npicking this:\n  const 0 \\<or> const 1", "show \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 \\<le> (2::nat)^(2*n)\""], ["proof (prove)\nusing this:\n  const 0 \\<or> const 1\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "using f_const_has_max_value"], ["proof (prove)\nusing this:\n  const 0 \\<or> const 1\n  const 0 \\<or> const 1 \\<Longrightarrow>\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 = real (2 ^ (2 * n))\n  const 0 \\<or> const 1 \\<Longrightarrow>\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 = real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "by simp"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "assume \"\\<not> const 0 \\<and> \\<not> const 1\""], ["proof (state)\nthis:\n  \\<not> const 0 \\<and> \\<not> const 1\n\ngoal (1 subgoal):\n 1. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "then"], ["proof (chain)\npicking this:\n  \\<not> const 0 \\<and> \\<not> const 1", "show \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 \\<le> (2::nat)^(2*n)\""], ["proof (prove)\nusing this:\n  \\<not> const 0 \\<and> \\<not> const 1\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "using max_value_of_not_const_less"], ["proof (prove)\nusing this:\n  \\<not> const 0 \\<and> \\<not> const 1\n  \\<lbrakk>\\<not> const 0; \\<not> const 1\\<rbrakk>\n  \\<Longrightarrow> (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n                    < real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))", "by simp"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "show \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 \\<le> (2::nat)^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "proof(rule disjE)"], ["proof (state)\ngoal (3 subgoals):\n 1. ?P \\<or> ?Q\n 2. ?P \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))\n 3. ?Q \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "show \"(const 0 \\<or> const 1) \\<or> (\\<not> const 0 \\<and> \\<not> const 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (const 0 \\<or> const 1) \\<or> \\<not> const 0 \\<and> \\<not> const 1", "by auto"], ["proof (state)\nthis:\n  (const 0 \\<or> const 1) \\<or> \\<not> const 0 \\<and> \\<not> const 1\n\ngoal (2 subgoals):\n 1. const 0 \\<or> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))\n 2. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "next"], ["proof (state)\ngoal (2 subgoals):\n 1. const 0 \\<or> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))\n 2. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "assume \"const 0 \\<or> const 1\""], ["proof (state)\nthis:\n  const 0 \\<or> const 1\n\ngoal (2 subgoals):\n 1. const 0 \\<or> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))\n 2. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "then"], ["proof (chain)\npicking this:\n  const 0 \\<or> const 1", "show \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 \\<le> (2::nat)^(2*n)\""], ["proof (prove)\nusing this:\n  const 0 \\<or> const 1\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "using f_const_has_max_value"], ["proof (prove)\nusing this:\n  const 0 \\<or> const 1\n  const 0 \\<or> const 1 \\<Longrightarrow>\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 = real (2 ^ (2 * n))\n  const 0 \\<or> const 1 \\<Longrightarrow>\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 = real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "by simp"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "next"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "assume \"\\<not> const 0 \\<and> \\<not> const 1\""], ["proof (state)\nthis:\n  \\<not> const 0 \\<and> \\<not> const 1\n\ngoal (1 subgoal):\n 1. \\<not> const 0 \\<and> \\<not> const 1 \\<Longrightarrow>\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "then"], ["proof (chain)\npicking this:\n  \\<not> const 0 \\<and> \\<not> const 1", "show \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 \\<le> (2::nat)^(2*n)\""], ["proof (prove)\nusing this:\n  \\<not> const 0 \\<and> \\<not> const 1\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "using max_value_of_not_const_less_bis"], ["proof (prove)\nusing this:\n  \\<not> const 0 \\<and> \\<not> const 1\n  \\<lbrakk>\\<not> const 0; \\<not> const 1\\<rbrakk>\n  \\<Longrightarrow> (cmod\n                      (of_int\n                        (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))))\\<^sup>2\n                    < real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n    \\<le> real (2 ^ (2 * n))", "by simp"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) prob0_jozsa_algo_1_is_const:\n  assumes \"prob0_fst_qubits n jozsa_algo = 1\"\n  shows \"const 0 \\<or> const 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have f0: \"(\\<Sum>j\\<in>{0,1}. (cmod(jozsa_algo $$ (j,0)))\\<^sup>2) = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2) = 1", "using prob0_fst_qubits_of_jozsa_algo assms"], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n  prob0_fst_qubits n jozsa_algo = 1\n\ngoal (1 subgoal):\n 1. (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2) = 1", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2) = 1\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"k < 2^n\\<longrightarrow>((0 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0", "have f1: \"(cmod(jozsa_algo $$ (0,0)))\\<^sup>2 = (cmod(\\<Sum>k<(2::nat)^n. (-1)^(f k)/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 0 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"k < 2^n\\<longrightarrow>((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "moreover"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 \n               = (cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k+ 1 + ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k))/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using \\<psi>\\<^sub>3_dim"], ["proof (prove)\nusing this:\n  1 < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "ultimately"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "have f2: \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 \n                     = (cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have f3: \"1 = (cmod(\\<Sum>k::nat<(2::nat)^n.(-1)^(f k)/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\n        + (cmod (\\<Sum>k::nat<(2::nat)^n. (-1)^(f k + 1)/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using f0 f1 f2"], ["proof (prove)\nusing this:\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2) = 1\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. 1 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  1 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "also"], ["proof (state)\nthis:\n  1 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"... = ((cmod (\\<Sum>k::nat<(2::nat)^n. (-1)^(f k)) ) /(sqrt(2)^n * sqrt(2)^(n+1)))\\<^sup>2\n                 + ((cmod(\\<Sum>k::nat<(2::nat)^n. (-1)^(f k + 1))) /(sqrt(2)^n * sqrt(2)^(n+1)))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2", "using aux_comp_sum_divide_cmod[of \"\\<lambda>k. (-1)^(f k)\" \"(sqrt(2)^n * sqrt(2)^(n+1))\" \"(2::nat)^n\"] \n          aux_comp_sum_divide_cmod[of \"\\<lambda>k. (-1)^(f k + 1)\" \"(sqrt(2)^n * sqrt(2)^(n+1))\" \"(2::nat)^n\"]"], ["proof (prove)\nusing this:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- 1) ^ f k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- 1) ^ f k)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- 1) ^ (f k + 1)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1))) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 +\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ (f k + 1) / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"... = ((cmod (\\<Sum>k::nat<(2::nat)^n. (-1)^(f k))))\\<^sup>2 /((sqrt(2)^n * sqrt(2)^(n+1)))\\<^sup>2\n                 + ((cmod(\\<Sum>k::nat<(2::nat)^n. (-1)^(f k +1))))\\<^sup>2 /((sqrt(2)^n * sqrt(2)^(n+1)))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2", "by (simp add: power_divide)"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "also"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"... = ((cmod (\\<Sum>k::nat<(2::nat)^n. (-1)^(f k)) ) )\\<^sup>2/(2^(2*n+1))\n                 + ((cmod(\\<Sum>k::nat<(2::nat)^n. (-1)^(f k + 1))))\\<^sup>2 /(2^(2*n+1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 /\n    (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 =\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 / 2 ^ (2 * n + 1) +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 / 2 ^ (2 * n + 1)", "by (smt left_add_twice power2_eq_square power_add power_mult_distrib real_sqrt_pow2)"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 / 2 ^ (2 * n + 1) +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 / 2 ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "also"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 /\n  (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\\<^sup>2 =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 / 2 ^ (2 * n + 1) +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 / 2 ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"... = (((cmod (\\<Sum>k::nat<(2::nat)^n. (-1)^(f k))))\\<^sup>2 \n                 + ((cmod(\\<Sum>k::nat<(2::nat)^n. (-1)^(f k + 1))))\\<^sup>2)/(2^(2*n+1)) \""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 / 2 ^ (2 * n + 1) +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 / 2 ^ (2 * n + 1) =\n    ((cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n     (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2) /\n    2 ^ (2 * n + 1)", "by (simp add: add_divide_distrib)"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 / 2 ^ (2 * n + 1) +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 / 2 ^ (2 * n + 1) =\n  ((cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n   (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2) /\n  2 ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "finally"], ["proof (chain)\npicking this:\n  1 =\n  ((cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n   (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2) /\n  2 ^ (2 * n + 1)", "have \"((2::nat)^(2*n+1)) = (((cmod (\\<Sum>k::nat<(2::nat)^n. (-1)^(f k))))\\<^sup>2 \n                 + ((cmod(\\<Sum>k::nat<(2::nat)^n. (-1)^(f k + 1))))\\<^sup>2)\""], ["proof (prove)\nusing this:\n  1 =\n  ((cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n   (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2) /\n  2 ^ (2 * n + 1)\n\ngoal (1 subgoal):\n 1. real (2 ^ (2 * n + 1)) =\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n    (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  real (2 ^ (2 * n + 1)) =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "moreover"], ["proof (state)\nthis:\n  real (2 ^ (2 * n + 1)) =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"((2::nat)^(2*n+1)) = 2^(2*n) + 2^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 2 ^ (2 * n + 1) = 2 ^ (2 * n) + 2 ^ (2 * n)", "by auto"], ["proof (state)\nthis:\n  2 ^ (2 * n + 1) = 2 ^ (2 * n) + 2 ^ (2 * n)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "moreover"], ["proof (state)\nthis:\n  2 ^ (2 * n + 1) = 2 ^ (2 * n) + 2 ^ (2 * n)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k)))\\<^sup>2 \\<le> 2^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> 2 ^ (2 * n)", "using prob0_fst_qubits_leq"], ["proof (prove)\nusing this:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> 2 ^ (2 * n)", "by simp"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> 2 ^ (2 * n)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "moreover"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> 2 ^ (2 * n)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "have \"(cmod (\\<Sum>k<(2::nat)^n. (-1)^(f k + 1)))\\<^sup>2 \\<le> 2^(2*n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> 2 ^ (2 * n)", "using prob0_fst_qubits_leq"], ["proof (prove)\nusing this:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> 2 ^ (2 * n)", "by simp"], ["proof (state)\nthis:\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> 2 ^ (2 * n)\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "ultimately"], ["proof (chain)\npicking this:\n  real (2 ^ (2 * n + 1)) =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n  2 ^ (2 * n + 1) = 2 ^ (2 * n) + 2 ^ (2 * n)\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> 2 ^ (2 * n)\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> 2 ^ (2 * n)", "have \"2^(2*n) = ((cmod (\\<Sum>k::nat<(2::nat)^n. (-1)^(f k))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  real (2 ^ (2 * n + 1)) =\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 +\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2\n  2 ^ (2 * n + 1) = 2 ^ (2 * n) + 2 ^ (2 * n)\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2 \\<le> 2 ^ (2 * n)\n  (cmod (\\<Sum>k<2 ^ n. (- 1) ^ (f k + 1)))\\<^sup>2 \\<le> 2 ^ (2 * n)\n\ngoal (1 subgoal):\n 1. 2 ^ (2 * n) = (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  2 ^ (2 * n) = (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "then"], ["proof (chain)\npicking this:\n  2 ^ (2 * n) = (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2", "show ?thesis"], ["proof (prove)\nusing this:\n  2 ^ (2 * n) = (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "using  max_value_of_not_const_less"], ["proof (prove)\nusing this:\n  2 ^ (2 * n) = (cmod (\\<Sum>k<2 ^ n. (- 1) ^ f k))\\<^sup>2\n  \\<lbrakk>\\<not> const 0; \\<not> const 1\\<rbrakk>\n  \\<Longrightarrow> (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)))\\<^sup>2\n                    < real (2 ^ (2 * n))\n\ngoal (1 subgoal):\n 1. const 0 \\<or> const 1", "by auto"], ["proof (state)\nthis:\n  const 0 \\<or> const 1\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>\nThe function is balanced if and only if at least one qubit among the first n qubits is not zero.\nSo, if the function is balanced then the probability of measuring 0 for the first n qubits is 0.\n\\<close>"], ["", "lemma sum_union_disjoint_finite_set:\n  fixes C::\"nat set\" and g::\"nat \\<Rightarrow> int\"\n  assumes \"finite C\"\n  shows \"\\<forall>A B. A \\<inter> B = {} \\<and> A \\<union> B = C \\<longrightarrow> (\\<Sum>k\\<in>C. g k) = (\\<Sum>k\\<in>A. g k) + (\\<Sum>k\\<in>B. g k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>A B.\n       A \\<inter> B = {} \\<and> A \\<union> B = C \\<longrightarrow>\n       sum g C = sum g A + sum g B", "using assms sum.union_disjoint"], ["proof (prove)\nusing this:\n  finite C\n  \\<lbrakk>finite ?A; finite ?B; ?A \\<inter> ?B = {}\\<rbrakk>\n  \\<Longrightarrow> sum ?g (?A \\<union> ?B) = sum ?g ?A + sum ?g ?B\n\ngoal (1 subgoal):\n 1. \\<forall>A B.\n       A \\<inter> B = {} \\<and> A \\<union> B = C \\<longrightarrow>\n       sum g C = sum g A + sum g B", "by auto"], ["", "lemma (in jozsa) balanced_pos_and_neg_terms_cancel_out1:\n  assumes \"is_balanced\" \n  shows \"(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "have \"\\<And>A B. A \\<subseteq> {i::nat. i < (2::nat)^n} \\<and> B \\<subseteq> {i::nat. i < (2::nat)^n}\n             \\<and> card A = ((2::nat)^(n-1)) \\<and> card B = ((2::nat)^(n-1))  \n             \\<and> (\\<forall>(x::nat) \\<in> A. f x = (0::nat))  \\<and> (\\<forall>(x::nat) \\<in> B. f x = 1)\n        \\<longrightarrow> (\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "fix A B::\"nat set\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "assume asm: \"A \\<subseteq> {i::nat. i < (2::nat)^n} \\<and> B \\<subseteq> {i::nat. i < (2::nat)^n}\n             \\<and> card A = ((2::nat)^(n-1)) \\<and> card B = ((2::nat)^(n-1))  \n             \\<and> (\\<forall>(x::nat) \\<in> A. f x = (0::nat))  \\<and> (\\<forall>(x::nat) \\<in> B. f x = 1)\""], ["proof (state)\nthis:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "then"], ["proof (chain)\npicking this:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)", "have \" A \\<inter> B = {}\" and \"{0..<(2::nat)^n} = A \\<union> B\""], ["proof (prove)\nusing this:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. A \\<inter> B = {} &&& {0..<2 ^ n} = A \\<union> B", "using is_balanced_union is_balanced_inter"], ["proof (prove)\nusing this:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n  \\<lbrakk>?A \\<subseteq> {i. i < 2 ^ n}; ?B \\<subseteq> {i. i < 2 ^ n};\n   card ?A = 2 ^ (n - 1); card ?B = 2 ^ (n - 1);\n   ?A \\<inter> ?B = {}\\<rbrakk>\n  \\<Longrightarrow> ?A \\<union> ?B = {i. i < 2 ^ n}\n  \\<lbrakk>\\<forall>x\\<in>?A. f x = 0; \\<forall>x\\<in>?B. f x = 1\\<rbrakk>\n  \\<Longrightarrow> ?A \\<inter> ?B = {}\n\ngoal (1 subgoal):\n 1. A \\<inter> B = {} &&& {0..<2 ^ n} = A \\<union> B", "by auto"], ["proof (state)\nthis:\n  A \\<inter> B = {}\n  {0..<2 ^ n} = A \\<union> B\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "then"], ["proof (chain)\npicking this:\n  A \\<inter> B = {}\n  {0..<2 ^ n} = A \\<union> B", "have \"(\\<Sum>k\\<in>{0..<(2::nat)^n}. (-(1::nat))^(f k)) =\n               (\\<Sum>k\\<in>A. (-(1::nat))^(f k)) \n             + (\\<Sum>k\\<in>B. (-(1::nat))^(f k))\""], ["proof (prove)\nusing this:\n  A \\<inter> B = {}\n  {0..<2 ^ n} = A \\<union> B\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) =\n    (\\<Sum>k\\<in>A. (- int 1) ^ f k) + (\\<Sum>k\\<in>B. (- int 1) ^ f k)", "by (metis finite_atLeastLessThan sum_union_disjoint_finite_set)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ f k) + (\\<Sum>k\\<in>B. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ f k) + (\\<Sum>k\\<in>B. (- int 1) ^ f k)\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "have \"(\\<Sum>k\\<in>A. (-1)^(f k)) = ((2::nat)^(n-1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>A. (- 1) ^ f k) = int (2 ^ (n - 1))", "using asm"], ["proof (prove)\nusing this:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>A. (- 1) ^ f k) = int (2 ^ (n - 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>A. (- 1) ^ f k) = int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>A. (- 1) ^ f k) = int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "have \"(\\<Sum>k\\<in>B. (-1)^(f k)) = -((2::nat)^(n-1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>B. (- 1) ^ f k) = - int (2 ^ (n - 1))", "using asm"], ["proof (prove)\nusing this:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>B. (- 1) ^ f k) = - int (2 ^ (n - 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>B. (- 1) ^ f k) = - int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ f k) + (\\<Sum>k\\<in>B. (- int 1) ^ f k)\n  (\\<Sum>k\\<in>A. (- 1) ^ f k) = int (2 ^ (n - 1))\n  (\\<Sum>k\\<in>B. (- 1) ^ f k) = - int (2 ^ (n - 1))", "have \"(\\<Sum>k\\<in> {0..<(2::nat)^n}. (-(1::nat))^(f k)) = 0\""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ f k) + (\\<Sum>k\\<in>B. (- int 1) ^ f k)\n  (\\<Sum>k\\<in>A. (- 1) ^ f k) = int (2 ^ (n - 1))\n  (\\<Sum>k\\<in>B. (- 1) ^ f k) = - int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) = 0", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) = 0\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "then"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) = 0", "show \"(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k)) = 0\""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ f k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "by (simp add: lessThan_atLeast0)"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "then"], ["proof (chain)\npicking this:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "using assms is_balanced_def"], ["proof (prove)\nusing this:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0\n  is_balanced\n  is_balanced \\<equiv>\n  \\<exists>A B.\n     A \\<subseteq> {i. i < 2 ^ n} \\<and>\n     B \\<subseteq> {i. i < 2 ^ n} \\<and>\n     card A = 2 ^ (n - 1) \\<and>\n     card B = 2 ^ (n - 1) \\<and>\n     (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) balanced_pos_and_neg_terms_cancel_out2:\n  assumes \"is_balanced\" \n  shows \"(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + 1)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "have \"\\<And>A B. A \\<subseteq> {i::nat. i < (2::nat)^n} \\<and> B \\<subseteq> {i::nat. i < (2::nat)^n}\n             \\<and> card A = ((2::nat)^(n-1)) \\<and> card B = ((2::nat)^(n-1))  \n             \\<and> (\\<forall>(x::nat)\\<in>A. f x = (0::nat))  \\<and> (\\<forall>(x::nat)\\<in>B. f x = 1)\n        \\<longrightarrow> (\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + 1)) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "proof"], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "fix A B::\"nat set\""], ["proof (state)\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "assume asm: \"A \\<subseteq> {i::nat. i < (2::nat)^n} \\<and> B \\<subseteq> {i::nat. i < (2::nat)^n}\n             \\<and> card A = ((2::nat)^(n-1)) \\<and> card B = ((2::nat)^(n-1))  \n             \\<and> (\\<forall>(x::nat) \\<in> A. f x = (0::nat))  \\<and> (\\<forall>(x::nat) \\<in> B. f x = 1)\""], ["proof (state)\nthis:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "have \"A \\<inter> B = {}\" and \"{0..<(2::nat)^n} = A \\<union> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A \\<inter> B = {} &&& {0..<2 ^ n} = A \\<union> B", "using is_balanced_union is_balanced_inter asm"], ["proof (prove)\nusing this:\n  \\<lbrakk>?A \\<subseteq> {i. i < 2 ^ n}; ?B \\<subseteq> {i. i < 2 ^ n};\n   card ?A = 2 ^ (n - 1); card ?B = 2 ^ (n - 1);\n   ?A \\<inter> ?B = {}\\<rbrakk>\n  \\<Longrightarrow> ?A \\<union> ?B = {i. i < 2 ^ n}\n  \\<lbrakk>\\<forall>x\\<in>?A. f x = 0; \\<forall>x\\<in>?B. f x = 1\\<rbrakk>\n  \\<Longrightarrow> ?A \\<inter> ?B = {}\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. A \\<inter> B = {} &&& {0..<2 ^ n} = A \\<union> B", "by auto"], ["proof (state)\nthis:\n  A \\<inter> B = {}\n  {0..<2 ^ n} = A \\<union> B\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "then"], ["proof (chain)\npicking this:\n  A \\<inter> B = {}\n  {0..<2 ^ n} = A \\<union> B", "have \"(\\<Sum>k\\<in>{0..<(2::nat)^n}. (-(1::nat))^(f k + 1)) =\n               (\\<Sum>k\\<in>A. (-(1::nat))^(f k + 1)) \n             + (\\<Sum>k\\<in>B. (-(1::nat))^(f k + 1))\""], ["proof (prove)\nusing this:\n  A \\<inter> B = {}\n  {0..<2 ^ n} = A \\<union> B\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) =\n    (\\<Sum>k\\<in>A. (- int 1) ^ (f k + 1)) +\n    (\\<Sum>k\\<in>B. (- int 1) ^ (f k + 1))", "by (metis finite_atLeastLessThan sum_union_disjoint_finite_set)"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ (f k + 1)) +\n  (\\<Sum>k\\<in>B. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ (f k + 1)) +\n  (\\<Sum>k\\<in>B. (- int 1) ^ (f k + 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "have \"(\\<Sum>k\\<in>A. (-1)^(f k + 1)) = -((2::nat)^(n-1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>A. (- 1) ^ (f k + 1)) = - int (2 ^ (n - 1))", "using asm"], ["proof (prove)\nusing this:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>A. (- 1) ^ (f k + 1)) = - int (2 ^ (n - 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>A. (- 1) ^ (f k + 1)) = - int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "moreover"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>A. (- 1) ^ (f k + 1)) = - int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "have \"(\\<Sum>k\\<in>B. (-1)^(f k + 1)) = ((2::nat)^(n-1))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>B. (- 1) ^ (f k + 1)) = int (2 ^ (n - 1))", "using asm"], ["proof (prove)\nusing this:\n  A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card A = 2 ^ (n - 1) \\<and>\n  card B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k\\<in>B. (- 1) ^ (f k + 1)) = int (2 ^ (n - 1))", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k\\<in>B. (- 1) ^ (f k + 1)) = int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "ultimately"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ (f k + 1)) +\n  (\\<Sum>k\\<in>B. (- int 1) ^ (f k + 1))\n  (\\<Sum>k\\<in>A. (- 1) ^ (f k + 1)) = - int (2 ^ (n - 1))\n  (\\<Sum>k\\<in>B. (- 1) ^ (f k + 1)) = int (2 ^ (n - 1))", "have \"(\\<Sum>k\\<in>{0..<(2::nat)^n}. (-(1::nat))^(f k + 1)) = 0 \""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) =\n  (\\<Sum>k\\<in>A. (- int 1) ^ (f k + 1)) +\n  (\\<Sum>k\\<in>B. (- int 1) ^ (f k + 1))\n  (\\<Sum>k\\<in>A. (- 1) ^ (f k + 1)) = - int (2 ^ (n - 1))\n  (\\<Sum>k\\<in>B. (- 1) ^ (f k + 1)) = int (2 ^ (n - 1))\n\ngoal (1 subgoal):\n 1. (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "by simp"], ["proof (state)\nthis:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n\ngoal (1 subgoal):\n 1. \\<And>A B.\n       A \\<subseteq> {i. i < 2 ^ n} \\<and>\n       B \\<subseteq> {i. i < 2 ^ n} \\<and>\n       card A = 2 ^ (n - 1) \\<and>\n       card B = 2 ^ (n - 1) \\<and>\n       (\\<forall>x\\<in>A. f x = 0) \\<and>\n       (\\<forall>x\\<in>B. f x = 1) \\<Longrightarrow>\n       (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "then"], ["proof (chain)\npicking this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "show \"(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + 1)) = 0\""], ["proof (prove)\nusing this:\n  (\\<Sum>k = 0..<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "by (simp add: lessThan_atLeast0)"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "then"], ["proof (chain)\npicking this:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "show \"(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + 1)) = 0\""], ["proof (prove)\nusing this:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "using assms is_balanced_def"], ["proof (prove)\nusing this:\n  ?A \\<subseteq> {i. i < 2 ^ n} \\<and>\n  ?B \\<subseteq> {i. i < 2 ^ n} \\<and>\n  card ?A = 2 ^ (n - 1) \\<and>\n  card ?B = 2 ^ (n - 1) \\<and>\n  (\\<forall>x\\<in>?A. f x = 0) \\<and>\n  (\\<forall>x\\<in>?B. f x = 1) \\<longrightarrow>\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n  is_balanced\n  is_balanced \\<equiv>\n  \\<exists>A B.\n     A \\<subseteq> {i. i < 2 ^ n} \\<and>\n     B \\<subseteq> {i. i < 2 ^ n} \\<and>\n     card A = 2 ^ (n - 1) \\<and>\n     card B = 2 ^ (n - 1) \\<and>\n     (\\<forall>x\\<in>A. f x = 0) \\<and> (\\<forall>x\\<in>B. f x = 1)\n\ngoal (1 subgoal):\n 1. (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0", "by auto"], ["proof (state)\nthis:\n  (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n\ngoal:\nNo subgoals!", "qed"], ["", "lemma (in jozsa) prob0_jozsa_algo_of_balanced:\nassumes \"is_balanced\"\n  shows \"prob0_fst_qubits n jozsa_algo = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "have \"prob0_fst_qubits n jozsa_algo = (\\<Sum>j\\<in>{0,1}. (cmod(jozsa_algo $$ (j,0)))\\<^sup>2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "using prob0_fst_qubits_of_jozsa_algo"], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo =\n    (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "moreover"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "have \"(cmod(jozsa_algo $$ (0,0)))\\<^sup>2 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "have \"k < 2^n\\<longrightarrow>((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by simp"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "then"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0", "have \"(cmod(jozsa_algo $$ (0,0)))\\<^sup>2 = (cmod(\\<Sum> k < (2::nat)^n. (-1)^(f k)/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using \\<psi>\\<^sub>3_values"], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  ?i < dim_row\n        (Matrix.mat (2 ^ (n + 1)) 1\n          (\\<lambda>x.\n              complex_of_real\n               (case x of\n                (i, j) \\<Rightarrow>\n                  if even i\n                  then \\<Sum>k<2 ^ n.\n                          (- 1) ^\n                          (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                          (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                  else \\<Sum>k<2 ^ n.\n                          (- 1) ^\n                          (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                          (sqrt 2 ^ n *\n                           sqrt 2 ^ (n + 1))))) \\<Longrightarrow>\n  odd ?i \\<longrightarrow>\n  Matrix.mat (2 ^ (n + 1)) 1\n   (\\<lambda>x.\n       complex_of_real\n        (case x of\n         (i, j) \\<Rightarrow>\n           if even i\n           then \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n           else \\<Sum>k<2 ^ n.\n                   (- 1) ^ (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))) $$\n  (?i, 0) =\n  complex_of_real\n   (\\<Sum>k<2 ^ n.\n       (- 1) ^ (f k + 1 + ?i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n       (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "also"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "have \"... = (cmod(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k))/(sqrt(2)^n * sqrt(2)^(n+1)))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2", "using aux_comp_sum_divide_cmod[of \"\\<lambda>k.(-(1::nat))^(f k)\" \"(sqrt(2)^n * sqrt(2)^(n+1))\" \"2^n\"]"], ["proof (prove)\nusing this:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- int 1) ^ f k) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          (- 1) ^ f k / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "have \"... = (cmod ((0::int)/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using balanced_pos_and_neg_terms_cancel_out1 assms"], ["proof (prove)\nusing this:\n  is_balanced \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ f k) = 0\n  is_balanced\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by (simp add: bob_fun_axioms)"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "also"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ f k)) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "have \"... = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    0", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "finally"], ["proof (chain)\npicking this:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "moreover"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "have \"k < 2^n \\<longrightarrow> (((1::nat) div 2) \\<cdot>\\<^bsub>n\\<^esub>  k) = 0\" for k::nat"], ["proof (prove)\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "using bitwise_inner_prod_with_zero"], ["proof (prove)\nusing this:\n  ?m < 2 ^ ?n \\<Longrightarrow> 0 \\<cdot>\\<^bsub>?n\\<^esub>  ?m = 0\n\ngoal (1 subgoal):\n 1. k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k = 0", "by auto"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "moreover"], ["proof (state)\nthis:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 \n     = (cmod (\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + (1::nat) + ((1 div 2) \\<cdot>\\<^bsub>n\\<^esub>  k))/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            real_of_int\n             ((- int 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k)) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using \\<psi>\\<^sub>3_dim"], ["proof (prove)\nusing this:\n  1 < dim_row\n       (Matrix.mat (2 ^ (n + 1)) 1\n         (\\<lambda>x.\n             complex_of_real\n              (case x of\n               (i, j) \\<Rightarrow>\n                 if even i\n                 then \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1))\n                 else \\<Sum>k<2 ^ n.\n                         (- 1) ^\n                         (f k + 1 + i div 2 \\<cdot>\\<^bsub>n\\<^esub>  k) /\n                         (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            real_of_int\n             ((- int 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k)) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int\n           ((- int 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "ultimately"], ["proof (chain)\npicking this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int\n           ((- int 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "have \"(cmod(jozsa_algo $$ (1,0)))\\<^sup>2 \n    = (cmod(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + (1::nat))/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\nusing this:\n  ?k < 2 ^ n \\<longrightarrow> 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  ?k = 0\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int\n           ((- int 1) ^ (f k + 1 + 1 div 2 \\<cdot>\\<^bsub>n\\<^esub>  k)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            real_of_int ((- int 1) ^ (f k + 1)) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- int 1) ^ (f k + 1)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "also"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- int 1) ^ (f k + 1)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "have \"... = (cmod(\\<Sum>k<(2::nat)^n. (-(1::nat))^(f k + 1))/(sqrt(2)^n * sqrt(2)^(n+1)))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            real_of_int ((- int 1) ^ (f k + 1)) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2", "using aux_comp_sum_divide_cmod[of \"\\<lambda>k.(-(1::nat))^(f k + 1)\" \"(sqrt(2)^n * sqrt(2)^(n+1))\" \"2^n\"]"], ["proof (prove)\nusing this:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- int 1) ^ (f k + 1)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (\\<Sum>k<2 ^ n.\n            real_of_int ((- int 1) ^ (f k + 1)) /\n            (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- int 1) ^ (f k + 1)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "also"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (\\<Sum>k<2 ^ n.\n          real_of_int ((- int 1) ^ (f k + 1)) /\n          (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "have \"... = (cmod ((0::int)/(sqrt(2)^n * sqrt(2)^(n+1))))\\<^sup>2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "using balanced_pos_and_neg_terms_cancel_out2 assms"], ["proof (prove)\nusing this:\n  is_balanced \\<Longrightarrow> (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1)) = 0\n  is_balanced\n\ngoal (1 subgoal):\n 1. (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n     (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n    (cmod\n      (complex_of_real\n        (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2", "by (simp add: bob_fun_axioms)"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "also"], ["proof (state)\nthis:\n  (cmod (of_int (\\<Sum>k<2 ^ n. (- int 1) ^ (f k + 1))) /\n   (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))\\<^sup>2 =\n  (cmod\n    (complex_of_real\n      (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "have \"... = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (cmod\n      (complex_of_real\n        (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n    0", "by simp"], ["proof (state)\nthis:\n  (cmod\n    (complex_of_real\n      (real_of_int 0 / (sqrt 2 ^ n * sqrt 2 ^ (n + 1)))))\\<^sup>2 =\n  0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "finally"], ["proof (chain)\npicking this:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "show ?thesis"], ["proof (prove)\nusing this:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0\n\ngoal (1 subgoal):\n 1. (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "by simp"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0\n\ngoal:\nNo subgoals!", "qed"], ["proof (state)\nthis:\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "ultimately"], ["proof (chain)\npicking this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0", "have \"prob0_fst_qubits n jozsa_algo = 0 + 0\""], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo =\n  (\\<Sum>j\\<in>{0, 1}. (cmod (jozsa_algo $$ (j, 0)))\\<^sup>2)\n  (cmod (jozsa_algo $$ (0, 0)))\\<^sup>2 = 0\n  (cmod (jozsa_algo $$ (1, 0)))\\<^sup>2 = 0\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0 + 0", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo = 0 + 0\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "then"], ["proof (chain)\npicking this:\n  prob0_fst_qubits n jozsa_algo = 0 + 0", "show  ?thesis"], ["proof (prove)\nusing this:\n  prob0_fst_qubits n jozsa_algo = 0 + 0\n\ngoal (1 subgoal):\n 1. prob0_fst_qubits n jozsa_algo = 0", "by simp"], ["proof (state)\nthis:\n  prob0_fst_qubits n jozsa_algo = 0\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>If the probability that the first n qubits are 0 is 0, then the function is balanced.\\<close>"], ["", "lemma (in jozsa) balanced_prob0_jozsa_algo:\n  assumes \"prob0_fst_qubits n jozsa_algo = 0\"\n  shows \"is_balanced\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_balanced", "proof-"], ["proof (state)\ngoal (1 subgoal):\n 1. is_balanced", "have \"is_const \\<or> is_balanced\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_const \\<or> is_balanced", "using const_or_balanced"], ["proof (prove)\nusing this:\n  is_const \\<or> is_balanced\n\ngoal (1 subgoal):\n 1. is_const \\<or> is_balanced", "by simp"], ["proof (state)\nthis:\n  is_const \\<or> is_balanced\n\ngoal (1 subgoal):\n 1. is_balanced", "moreover"], ["proof (state)\nthis:\n  is_const \\<or> is_balanced\n\ngoal (1 subgoal):\n 1. is_balanced", "have \"is_const \\<longrightarrow> \\<not> prob0_fst_qubits n jozsa_algo = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. is_const \\<longrightarrow> prob0_fst_qubits n jozsa_algo \\<noteq> 0", "using is_const_def prob0_jozsa_algo_of_const_0 prob0_jozsa_algo_of_const_1"], ["proof (prove)\nusing this:\n  is_const \\<equiv> const 0 \\<or> const 1\n  const 0 \\<Longrightarrow> prob0_fst_qubits n jozsa_algo = 1\n  const 1 \\<Longrightarrow> prob0_fst_qubits n jozsa_algo = 1\n\ngoal (1 subgoal):\n 1. is_const \\<longrightarrow> prob0_fst_qubits n jozsa_algo \\<noteq> 0", "by simp"], ["proof (state)\nthis:\n  is_const \\<longrightarrow> prob0_fst_qubits n jozsa_algo \\<noteq> 0\n\ngoal (1 subgoal):\n 1. is_balanced", "ultimately"], ["proof (chain)\npicking this:\n  is_const \\<or> is_balanced\n  is_const \\<longrightarrow> prob0_fst_qubits n jozsa_algo \\<noteq> 0", "show ?thesis"], ["proof (prove)\nusing this:\n  is_const \\<or> is_balanced\n  is_const \\<longrightarrow> prob0_fst_qubits n jozsa_algo \\<noteq> 0\n\ngoal (1 subgoal):\n 1. is_balanced", "using assms"], ["proof (prove)\nusing this:\n  is_const \\<or> is_balanced\n  is_const \\<longrightarrow> prob0_fst_qubits n jozsa_algo \\<noteq> 0\n  prob0_fst_qubits n jozsa_algo = 0\n\ngoal (1 subgoal):\n 1. is_balanced", "by simp"], ["proof (state)\nthis:\n  is_balanced\n\ngoal:\nNo subgoals!", "qed"], ["", "text \\<open>We prove the correctness of the algorithm.\\<close>"], ["", "definition (in jozsa) jozsa_algo_eval:: \"real\" where\n\"jozsa_algo_eval \\<equiv> prob0_fst_qubits n jozsa_algo\""], ["", "theorem (in jozsa) jozsa_algo_is_correct:\n  shows \"jozsa_algo_eval = 1 \\<longleftrightarrow> is_const\" \n    and \"jozsa_algo_eval = 0 \\<longleftrightarrow> is_balanced\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (jozsa_algo_eval = 1) = is_const &&& (jozsa_algo_eval = 0) = is_balanced", "using prob0_jozsa_algo_of_const_1 prob0_jozsa_algo_of_const_0 jozsa_algo_eval_def\nprob0_jozsa_algo_1_is_const is_const_def balanced_prob0_jozsa_algo prob0_jozsa_algo_of_balanced"], ["proof (prove)\nusing this:\n  const 1 \\<Longrightarrow> prob0_fst_qubits n jozsa_algo = 1\n  const 0 \\<Longrightarrow> prob0_fst_qubits n jozsa_algo = 1\n  jozsa_algo_eval \\<equiv> prob0_fst_qubits n jozsa_algo\n  prob0_fst_qubits n jozsa_algo = 1 \\<Longrightarrow> const 0 \\<or> const 1\n  is_const \\<equiv> const 0 \\<or> const 1\n  prob0_fst_qubits n jozsa_algo = 0 \\<Longrightarrow> is_balanced\n  is_balanced \\<Longrightarrow> prob0_fst_qubits n jozsa_algo = 0\n\ngoal (1 subgoal):\n 1. (jozsa_algo_eval = 1) = is_const &&& (jozsa_algo_eval = 0) = is_balanced", "by auto"], ["", "end"]]}