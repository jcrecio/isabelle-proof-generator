{"file_name": "/home/qj213/afp-2021-10-22/thys/LLL_Factorization/Modern_Computer_Algebra_Problem.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/LLL_Factorization", "problem_names": ["lemma \"let f = [:1,1:] * [:1,1,0,1:];\n   p = suitable_prime_bz f;\n   b = lead_coeff f;\n   A = linf_norm_poly f; n = degree f; B = sqrt_int_ceiling (n+1) * 2^n * A;\n   Bnd = 2^(n^2 div 2) * B^(2*n); l = log_ceiling p Bnd;\n   (_, fs) = finite_field_factorization_int p f;\n   gs = hensel_lifting p l f fs;\n   u = choose_u gs;\n   d = degree u;\n   g_star = [:2,2,0,2 :: int :];\n   (gs',hs') = List.partition (\\<lambda>gi. poly_mod.dvdm p gi g_star) gs;\n   h_star = smult b (prod_list hs');\n   f_star = primitive_part h_star\n  in (hs' = [] \\<and> f_star = 1)\"", "lemma \"let f = input_poly;\n   p = suitable_prime_bz f;\n   b = lead_coeff f;\n   A = linf_norm_poly f; n = degree f; B = sqrt_int_ceiling (n+1) * 2^n * A;\n   Bnd = 2^(n^2 div 2) * B^(2*n); l = log_ceiling p Bnd;\n   (_, fs) = finite_field_factorization_int p f;\n   gs = hensel_lifting p l f fs;\n   u = choose_u gs;\n   pl = p^l;\n   pl2 = pl div 2;  \n   u' = poly_mod.inv_Mp2 pl pl2 (poly_mod.Mp pl (smult b u))\n  in sqrt_int_floor (sq_norm u') > pl\"", "lemma \"let g2 = [:-984,1:];\n           g3 = [:-72,1:];\n           g4 = [:-6828,1:];\n           rhs = [:-1728,-840,-420,6:]\n  in \\<not> poly_mod.eq_m (5^6) (smult 6 (g2*g3*g4)) (rhs)\""], "translations": [["", "lemma \"let f = [:1,1:] * [:1,1,0,1:];\n   p = suitable_prime_bz f;\n   b = lead_coeff f;\n   A = linf_norm_poly f; n = degree f; B = sqrt_int_ceiling (n+1) * 2^n * A;\n   Bnd = 2^(n^2 div 2) * B^(2*n); l = log_ceiling p Bnd;\n   (_, fs) = finite_field_factorization_int p f;\n   gs = hensel_lifting p l f fs;\n   u = choose_u gs;\n   d = degree u;\n   g_star = [:2,2,0,2 :: int :];\n   (gs',hs') = List.partition (\\<lambda>gi. poly_mod.dvdm p gi g_star) gs;\n   h_star = smult b (prod_list hs');\n   f_star = primitive_part h_star\n  in (hs' = [] \\<and> f_star = 1)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. let f = [:1, 1:] * [:1, 1, 0, 1:]; p = suitable_prime_bz f;\n        b = lead_coeff f; A = \\<parallel>f\\<parallel>\\<^sub>\\<infinity>;\n        n = degree f; B = sqrt_int_ceiling (int (n + 1)) * 2 ^ n * A;\n        Bnd = 2 ^ (n\\<^sup>2 div 2) * B ^ (2 * n); l = log_ceiling p Bnd;\n        (uu_, fs) = finite_field_factorization_int p f;\n        gs = hensel_lifting p l f fs;\n        u = Modern_Computer_Algebra_Problem.choose_u gs; d = degree u;\n        g_star = [:2, 2, 0, 2:];\n        (gs', hs') =\n          List.partition (\\<lambda>gi. poly_mod.dvdm p gi g_star) gs;\n        h_star = smult b (prod_list hs'); f_star = primitive_part h_star\n    in hs' = [] \\<and> f_star = 1", "by eval"], ["", "subsection \\<open>Another potential problem of Algorithm 16.22\\<close>"], ["", "text \\<open>\n  Suppose that $g^*$ is $p^l$. (It is is not yet clear whether lattices exists \n  where this $g^*$ is short enough).\n  Then $pp(g^*) = 1$ is detected as \\emph{irreducible} factor and the algorithm stops.\n\\<close>"], ["", "definition \"input_poly = [: 1,0,0,0,1,1,0,0,1,0,1,0,1 :: int :]\""], ["", "text \\<open>For @{const input_poly} the factorization will result in a lattice where\n  each initial basis element has a Euclidean norm of at least $p^l$ (since the\n  input polynomial $u$ has a norm larger than $p^l$.)\n  So, just from the norm of the basis one cannot infer that the lattice contains small vectors.\\<close>"], ["", "lemma \"let f = input_poly;\n   p = suitable_prime_bz f;\n   b = lead_coeff f;\n   A = linf_norm_poly f; n = degree f; B = sqrt_int_ceiling (n+1) * 2^n * A;\n   Bnd = 2^(n^2 div 2) * B^(2*n); l = log_ceiling p Bnd;\n   (_, fs) = finite_field_factorization_int p f;\n   gs = hensel_lifting p l f fs;\n   u = choose_u gs;\n   pl = p^l;\n   pl2 = pl div 2;  \n   u' = poly_mod.inv_Mp2 pl pl2 (poly_mod.Mp pl (smult b u))\n  in sqrt_int_floor (sq_norm u') > pl\""], ["proof (prove)\ngoal (1 subgoal):\n 1. let f = input_poly; p = suitable_prime_bz f; b = lead_coeff f;\n        A = \\<parallel>f\\<parallel>\\<^sub>\\<infinity>; n = degree f;\n        B = sqrt_int_ceiling (int (n + 1)) * 2 ^ n * A;\n        Bnd = 2 ^ (n\\<^sup>2 div 2) * B ^ (2 * n); l = log_ceiling p Bnd;\n        (uu_, fs) = finite_field_factorization_int p f;\n        gs = hensel_lifting p l f fs;\n        u = Modern_Computer_Algebra_Problem.choose_u gs; pl = p ^ l;\n        pl2 = pl div 2;\n        u' = poly_mod.inv_Mp2 pl pl2 (poly_mod.Mp pl (smult b u))\n    in pl < sqrt_int_floor \\<parallel>u'\\<parallel>\\<^sup>2", "by eval"], ["", "text \\<open>The following calculation will show that the norm of $g^*$ is not that much\n  shorter than $p^l$ which is an indication that it is not obvious that in general\n  $p^l$ cannot be chosen as short polynomial.\\<close>"], ["", "definition \"compute_norms = (let f = input_poly;\n   p = suitable_prime_bz f;\n   b = lead_coeff f;\n   A = linf_norm_poly f; n = degree f; B = sqrt_int_ceiling (n+1) * 2^n * A;\n   Bnd = 2^(n^2 div 2) * B^(2*n); l = log_ceiling p Bnd;\n   (_, fs) = finite_field_factorization_int p f;\n   gs = hensel_lifting p l f fs;\n   u = choose_u gs;\n   pl = p^l;\n   pl2 = pl div 2;  \n   u' = poly_mod.inv_Mp2 pl pl2 (poly_mod.Mp pl (smult b u));\n   d = degree u;\n   pl = p^l;\n   L = factorization_lattice u' 1 pl;\n   g_star = short_vector 2 L \n  in (\n     ''p^l:         '' @ show pl @ shows_nl [] @ \n     ''norm u:      '' @ show (sqrt_int_floor (sq_norm_poly u')) @ shows_nl [] @\n     ''norm g_star: '' @ show (sqrt_int_floor (sq_norm_vec g_star)) @ shows_nl [] @ shows_nl [] \n))\""], ["", "export_code compute_norms in Haskell"], ["", "text \\<open>\n\\<^item> @{term \"p^l\"}:         $\\approx 6.61056 \\cdot 10^{122}$, namely 661055968790248598951915308032771039828404682964281219284648795274405791236311345825189210439715284847591212025023358304256\n\\<^item> @{term \"norm u\"}:      $\\approx 6.67555 \\cdot 10^{122}$, namely 667555058938127908386141559707490406617756492853269306735125739182352318769782701477339940304992057299993307341153235059302\n\\<^item> @{term \"norm g_star\"}: $\\approx 5.02568 \\cdot 10^{110}$, namely 502567871888893789258107599397950338997348731386301514804539180088146716526330518979464688385872213886910747667\n\\<close>"], ["", "subsection \\<open>Verified wrong results\\<close>"], ["", "text \\<open>An equality in example 16.24 of the textbook which is not valid.\\<close>"], ["", "lemma \"let g2 = [:-984,1:];\n           g3 = [:-72,1:];\n           g4 = [:-6828,1:];\n           rhs = [:-1728,-840,-420,6:]\n  in \\<not> poly_mod.eq_m (5^6) (smult 6 (g2*g3*g4)) (rhs)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. let g2 = [:- 984, 1:]; g3 = [:- 72, 1:]; g4 = [:- 6828, 1:];\n        rhs = [:- 1728, - 840, - 420, 6:]\n    in poly_mod.Mp (5 ^ 6) (smult 6 (g2 * g3 * g4)) \\<noteq>\n       poly_mod.Mp (5 ^ 6) rhs", "by eval"], ["", "end"]]}